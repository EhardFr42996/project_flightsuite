<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: simulation_object.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">simulation_object.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../db/dec/simulation__object_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00004"></a>00004 <span class="comment">/******************************************************************************</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * El&#39;Beem - Free Surface Fluid Simulation with the Lattice Boltzmann Method</span>
<a name="l00007"></a>00007 <span class="comment"> * Copyright 2003-2006 Nils Thuerey</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * Basic interface for all simulation modules</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *****************************************************************************/</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/db9/simulation__object_8h.html">simulation_object.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d3c/solver__interface_8h.html">solver_interface.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d3d/ntl__bsptree_8h.html">ntl_bsptree.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/dbe/ntl__ray_8h.html">ntl_ray.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d8d/ntl__world_8h.html">ntl_world.h</a>&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d3c/solver__interface_8h.html">solver_interface.h</a>&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d69/particletracer_8h.html">particletracer.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d00/elbeem_8h.html">elbeem.h</a>&quot;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#ifdef _WIN32</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/time.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#endif</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a>00027 
<a name="l00029"></a>00029 <a class="code" href="../../db/dff/classLbmSolverInterface.html">LbmSolverInterface</a>* <a class="code" href="../../db/dec/simulation__object_8cpp.html#aea741e5546295d779197aabd21ce4d0f" title="lbm factory functions">createSolver</a>();
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment">/******************************************************************************</span>
<a name="l00033"></a>00033 <span class="comment"> * Constructor</span>
<a name="l00034"></a>00034 <span class="comment"> *****************************************************************************/</span>
<a name="l00035"></a><a class="code" href="../../da/df3/classSimulationObject.html#aaf7df4ca4c3b5cc00ff66be2954102ce">00035</a> <a class="code" href="../../da/df3/classSimulationObject.html#aaf7df4ca4c3b5cc00ff66be2954102ce">SimulationObject::SimulationObject</a>() :
<a name="l00036"></a>00036     <a class="code" href="../../de/d7b/classntlGeometryShader.html">ntlGeometryShader</a>(),
<a name="l00037"></a>00037     mGeoStart(-100.0), mGeoEnd(100.0),
<a name="l00038"></a>00038     mpGiTree(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), mpGiObjects(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00039"></a>00039     mpGlob(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00040"></a>00040     mPanic( false ),
<a name="l00041"></a>00041     mDebugType( 1 <span class="comment">/* =FLUIDDISPNothing*/</span> ),
<a name="l00042"></a>00042     mpLbm(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), mpParam( <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ),
<a name="l00043"></a>00043     mShowSurface(true), mShowParticles(false),
<a name="l00044"></a>00044     mSelectedCid( <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ),
<a name="l00045"></a>00045     mpElbeemSettings( <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 {
<a name="l00048"></a>00048     <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a> = <span class="keyword">new</span> <a class="code" href="../../d1/d7f/classParametrizer.html" title="output parameter debug message?">Parametrizer</a>();
<a name="l00049"></a>00049     <span class="comment">//for(int i=0; i&lt;MAX_DEBDISPSET; i++) { mDebDispSet[i].type  = (i); mDebDispSet[i].on    = false; mDebDispSet[i].scale = 1.0; }</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <span class="comment">// reset time</span>
<a name="l00052"></a>00052     <a class="code" href="../../da/df3/classSimulationObject.html#ac7eed6c3491ab380b4b92a9434071cfd">mTime</a>                       = 0.0;
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">/******************************************************************************</span>
<a name="l00057"></a>00057 <span class="comment"> * Destructor</span>
<a name="l00058"></a>00058 <span class="comment"> *****************************************************************************/</span>
<a name="l00059"></a><a class="code" href="../../da/df3/classSimulationObject.html#a210671e4d27dbfc78217db97e5d96d18">00059</a> <a class="code" href="../../da/df3/classSimulationObject.html#a210671e4d27dbfc78217db97e5d96d18">SimulationObject::~SimulationObject</a>()
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a1641f964945e5beddaf76ce55ffbf0fb">mpGiTree</a>)         <span class="keyword">delete</span> <a class="code" href="../../da/df3/classSimulationObject.html#a1641f964945e5beddaf76ce55ffbf0fb">mpGiTree</a>;
<a name="l00062"></a>00062     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>) <span class="keyword">delete</span> <a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>;
<a name="l00063"></a>00063     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>)            <span class="keyword">delete</span> <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>;
<a name="l00064"></a>00064     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>)          <span class="keyword">delete</span> <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>;
<a name="l00065"></a>00065     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#ac0fa0289822849107d4503ad94146833">mpParts</a>)          <span class="keyword">delete</span> <a class="code" href="../../da/df3/classSimulationObject.html#ac0fa0289822849107d4503ad94146833">mpParts</a>;
<a name="l00066"></a>00066     <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot;El&#39;Beem Done!\n&quot;</span>,10);
<a name="l00067"></a>00067 }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">/*****************************************************************************/</span>
<a name="l00073"></a>00073 <span class="comment">/*****************************************************************************/</span>
<a name="l00074"></a><a class="code" href="../../da/df3/classSimulationObject.html#a2eab9134860a74b04bcecacf675ac838">00074</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a2eab9134860a74b04bcecacf675ac838">SimulationObject::initGeoTree</a>() {
<a name="l00075"></a>00075     <span class="comment">// unused!! overriden by solver interface   </span>
<a name="l00076"></a>00076     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#abe94ff9dad7e149a54a12ae166b4f6ae">mpGlob</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) { 
<a name="l00077"></a>00077         <a class="code" href="../../de/df0/utilities_8h.html#abbf67626aa468b4301520b9f6f292e1c">errFatal</a>(<span class="stringliteral">&quot;SimulationObject::initGeoTree error&quot;</span>,<span class="stringliteral">&quot;Requires globals!&quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#a74894721e682bda2c22d5dacda988cad">SIMWORLD_INITERROR</a>); 
<a name="l00078"></a>00078         <span class="keywordflow">return</span>;
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080     <a class="code" href="../../dd/d46/classntlScene.html">ntlScene</a> *scene = <a class="code" href="../../da/df3/classSimulationObject.html#abe94ff9dad7e149a54a12ae166b4f6ae">mpGlob</a>-&gt;<a class="code" href="../../d0/d95/classntlRenderGlobals.html#ab16c773967908534c9861b39951d11f2" title="Returns the simulation scene manager (static scene with sim objects)">getSimScene</a>();
<a name="l00081"></a>00081     <a class="code" href="../../da/df3/classSimulationObject.html#a66fdab4f20b3eb5e661fd69c17115044">mpGiObjects</a> = scene-&gt;<a class="code" href="../../dd/d46/classntlScene.html#afef8f7a55c866715aa5ad22c0281999d">getObjects</a>();
<a name="l00082"></a>00082 
<a name="l00083"></a>00083     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a1641f964945e5beddaf76ce55ffbf0fb">mpGiTree</a> != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keyword">delete</span> <a class="code" href="../../da/df3/classSimulationObject.html#a1641f964945e5beddaf76ce55ffbf0fb">mpGiTree</a>;
<a name="l00084"></a>00084     <span class="keywordtype">char</span> treeFlag = (1&lt;&lt;(<a class="code" href="../../dd/dcf/classntlGeometryClass.html#aba1827bd65bf930e57d1b00d2445e911">mGeoInitId</a>+4));
<a name="l00085"></a>00085     <a class="code" href="../../da/df3/classSimulationObject.html#a1641f964945e5beddaf76ce55ffbf0fb">mpGiTree</a> = <span class="keyword">new</span> <a class="code" href="../../d7/d9b/classntlTree.html" title="Class for a bsp tree for triangles.">ntlTree</a>( 20, 4, <span class="comment">// warning - fixed values for depth &amp; maxtriangles here...</span>
<a name="l00086"></a>00086                                                 scene, treeFlag );
<a name="l00087"></a>00087     <span class="comment">// unused!! overriden by solver interface   </span>
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">/*****************************************************************************/</span>
<a name="l00092"></a>00092 <span class="comment">/*****************************************************************************/</span>
<a name="l00093"></a><a class="code" href="../../da/df3/classSimulationObject.html#a3b2146be9574d48c822dd915aaeff3f9">00093</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a3b2146be9574d48c822dd915aaeff3f9">SimulationObject::freeGeoTree</a>() {
<a name="l00094"></a>00094     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a1641f964945e5beddaf76ce55ffbf0fb">mpGiTree</a> != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keyword">delete</span> <a class="code" href="../../da/df3/classSimulationObject.html#a1641f964945e5beddaf76ce55ffbf0fb">mpGiTree</a>;
<a name="l00095"></a>00095 }
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="comment">// copy &amp; remember settings for later use</span>
<a name="l00100"></a><a class="code" href="../../da/df3/classSimulationObject.html#a7bc4ce699220c58d67e004cbf5a0e24c">00100</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a7bc4ce699220c58d67e004cbf5a0e24c">SimulationObject::copyElbeemSettings</a>(<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html">elbeemSimulationSettings</a> *settings) {
<a name="l00101"></a>00101     <a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a> = <span class="keyword">new</span> <a class="code" href="../../d8/d00/elbeem_8h.html#a8e1c5968978cff7561208b2e59ca64eb">elbeemSimulationSettings</a>;
<a name="l00102"></a>00102     *<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a> = *settings;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     <a class="code" href="../../dd/dcf/classntlGeometryClass.html#aba1827bd65bf930e57d1b00d2445e911">mGeoInitId</a> = settings-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a7079d17803243e8ef1c6a9ec66d3b178">domainId</a>+1;
<a name="l00105"></a>00105     <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot;mGeoInitId=&quot;</span>&lt;&lt;<a class="code" href="../../dd/dcf/classntlGeometryClass.html#aba1827bd65bf930e57d1b00d2445e911">mGeoInitId</a>&lt;&lt;<span class="stringliteral">&quot;, domainId=&quot;</span>&lt;&lt;settings-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a7079d17803243e8ef1c6a9ec66d3b178">domainId</a>, 8);
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 <span class="comment">/******************************************************************************</span>
<a name="l00109"></a>00109 <span class="comment"> * simluation interface: initialize simulation using the given configuration file </span>
<a name="l00110"></a>00110 <span class="comment"> *****************************************************************************/</span>
<a name="l00111"></a>00111 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d97/ntl__blenderdumper_8cpp.html#ab6ff78cb4ce2a353f47a92a3c21018f8">glob_mpnum</a>;
<a name="l00112"></a><a class="code" href="../../da/df3/classSimulationObject.html#ab219d904c60842bd36987ae18f3484ae">00112</a> <span class="keywordtype">int</span> <a class="code" href="../../da/df3/classSimulationObject.html#ab219d904c60842bd36987ae18f3484ae">SimulationObject::initializeLbmSimulation</a>(<a class="code" href="../../d0/d95/classntlRenderGlobals.html" title="Class that handles global rendering parameters.">ntlRenderGlobals</a> *glob)
<a name="l00113"></a>00113 {
<a name="l00114"></a>00114     <span class="keywordflow">if</span>(! <a class="code" href="../../de/da5/utilities_8cpp.html#af3e89e0e3df33a7bf12fb4903a18f79b">isSimworldOk</a>() ) <span class="keywordflow">return</span> 1;
<a name="l00115"></a>00115     
<a name="l00116"></a>00116     <span class="comment">// already inited?</span>
<a name="l00117"></a>00117     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>) <span class="keywordflow">return</span> 0;
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <a class="code" href="../../da/df3/classSimulationObject.html#abe94ff9dad7e149a54a12ae166b4f6ae">mpGlob</a> = glob;
<a name="l00120"></a>00120     <span class="keywordflow">if</span>(!<a class="code" href="../../dd/dcf/classntlGeometryClass.html#ad0558ea884fc049a12e55dc8643da897">getVisible</a>()) {
<a name="l00121"></a>00121         <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a09536ca99dbf9d387827bfdc64503812">mpAttrs</a>-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#a1603961a26c32964cdaa18e5712ca84b">setAllUsed</a>();
<a name="l00122"></a>00122         <span class="keywordflow">return</span> 0;
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <a class="code" href="../../dd/dcf/classntlGeometryClass.html#aba1827bd65bf930e57d1b00d2445e911">mGeoInitId</a> = <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a09536ca99dbf9d387827bfdc64503812">mpAttrs</a>-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#ae95fe48278d28112a7b0fac13139f315">readInt</a>(<span class="stringliteral">&quot;geoinitid&quot;</span>, <a class="code" href="../../dd/dcf/classntlGeometryClass.html#aba1827bd65bf930e57d1b00d2445e911">mGeoInitId</a>,<span class="stringliteral">&quot;LbmSolverInterface&quot;</span>, <span class="stringliteral">&quot;mGeoInitId&quot;</span>, <span class="keyword">false</span>);
<a name="l00127"></a>00127     <span class="comment">//mDimension, mSolverType are deprecated</span>
<a name="l00128"></a>00128     <span class="keywordtype">string</span> mSolverType(<span class="stringliteral">&quot;&quot;</span>); 
<a name="l00129"></a>00129     mSolverType = <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a09536ca99dbf9d387827bfdc64503812">mpAttrs</a>-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#a3ca411f70b712bec3d4dd4e81229e2cb">readString</a>(<span class="stringliteral">&quot;solver&quot;</span>, mSolverType, <span class="stringliteral">&quot;SimulationObject&quot;</span>,<span class="stringliteral">&quot;mSolverType&quot;</span>, <span class="keyword">false</span> ); 
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a> = <a class="code" href="../../db/dec/simulation__object_8cpp.html#aea741e5546295d779197aabd21ce4d0f" title="lbm factory functions">createSolver</a>(); 
<a name="l00132"></a>00132   <span class="comment">/* check lbm pointer */</span>
<a name="l00133"></a>00133     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00134"></a>00134         <a class="code" href="../../de/df0/utilities_8h.html#abbf67626aa468b4301520b9f6f292e1c">errFatal</a>(<span class="stringliteral">&quot;SimulationObject::initializeLbmSimulation&quot;</span>,<span class="stringliteral">&quot;Unable to init LBM solver! &quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#a74894721e682bda2c22d5dacda988cad">SIMWORLD_INITERROR</a>);
<a name="l00135"></a>00135         <span class="keywordflow">return</span> 2;
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137     <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject::initialized&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot;IdStr:&quot;</span>&lt;&lt;<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a51e17c0e687c66c1ff98e095072e9747" title="id string of solver">getIdString</a>() &lt;&lt;<span class="stringliteral">&quot; LBM solver! &quot;</span>, 2);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <a class="code" href="../../da/df3/classSimulationObject.html#ac0fa0289822849107d4503ad94146833">mpParts</a> = <span class="keyword">new</span> <a class="code" href="../../de/db7/classParticleTracer.html" title="A whole particle array.">ParticleTracer</a>();
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <span class="comment">// for non-param simulations</span>
<a name="l00142"></a>00142     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#acbb1eebeb92abd84404f3c06f5dc8cf9">setParametrizer</a>( <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a> );
<a name="l00143"></a>00143     <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#ac67320b673b444c3f8e47c0c8749169d">setAttrList</a>( <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a059eba2cf640c1ba262c8ef5932ca2af">getAttributeList</a>() );
<a name="l00144"></a>00144     <span class="comment">// not needed.. done in solver_init: mpParam-&gt;setSize ... in solver_interface</span>
<a name="l00145"></a>00145     <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#a2d89e0b7af73394f266040046e13064a">parseAttrList</a>();
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a5b1d60c1bbf20551bbb371f875a86cd5">setAttrList</a>( <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a059eba2cf640c1ba262c8ef5932ca2af">getAttributeList</a>() );
<a name="l00148"></a>00148     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a7bbfea001d966ea0bae9fe7befa7690b">setSwsAttrList</a>( <a class="code" href="../../dd/dcf/classntlGeometryClass.html#abd04378b05228bbc4039c20ad3ed11a4">getSwsAttributeList</a>() );
<a name="l00149"></a>00149     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#acd0e72e8ca8e8b164a69d1d716d2c3d2">parseAttrList</a>();
<a name="l00150"></a>00150     mpParts-&gt;parseAttrList( <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a059eba2cf640c1ba262c8ef5932ca2af">getAttributeList</a>() );
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="keywordflow">if</span>(! <a class="code" href="../../de/da5/utilities_8cpp.html#af3e89e0e3df33a7bf12fb4903a18f79b">isSimworldOk</a>() ) <span class="keywordflow">return</span> 3;
<a name="l00153"></a>00153     mpParts-&gt;setName( <a class="code" href="../../dd/dcf/classntlGeometryClass.html#aa0433486901f2f913b7ca5c80a0de218">getName</a>() + <span class="stringliteral">&quot;_part&quot;</span> );
<a name="l00154"></a>00154     mpParts-&gt;initialize( glob );
<a name="l00155"></a>00155     <span class="keywordflow">if</span>(! <a class="code" href="../../de/da5/utilities_8cpp.html#af3e89e0e3df33a7bf12fb4903a18f79b">isSimworldOk</a>() ) <span class="keywordflow">return</span> 4;
<a name="l00156"></a>00156     
<a name="l00157"></a>00157     <span class="comment">// init material settings</span>
<a name="l00158"></a>00158     <span class="keywordtype">string</span> matMc(<span class="stringliteral">&quot;default&quot;</span>);
<a name="l00159"></a>00159     matMc = <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a09536ca99dbf9d387827bfdc64503812">mpAttrs</a>-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#a3ca411f70b712bec3d4dd4e81229e2cb">readString</a>(<span class="stringliteral">&quot;material_surf&quot;</span>, matMc, <span class="stringliteral">&quot;SimulationObject&quot;</span>,<span class="stringliteral">&quot;matMc&quot;</span>, <span class="keyword">false</span> );
<a name="l00160"></a>00160     <a class="code" href="../../da/df3/classSimulationObject.html#af2f736f1e3a346e695a875bfd87407d4">mShowSurface</a>   = <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a09536ca99dbf9d387827bfdc64503812">mpAttrs</a>-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#ae95fe48278d28112a7b0fac13139f315">readInt</a>(<span class="stringliteral">&quot;showsurface&quot;</span>, <a class="code" href="../../da/df3/classSimulationObject.html#af2f736f1e3a346e695a875bfd87407d4">mShowSurface</a>, <span class="stringliteral">&quot;SimulationObject&quot;</span>,<span class="stringliteral">&quot;mShowSurface&quot;</span>, <span class="keyword">false</span> ); 
<a name="l00161"></a>00161     <a class="code" href="../../da/df3/classSimulationObject.html#a98c0b09d1afedb56c199c244c5f5e91a">mShowParticles</a> = <a class="code" href="../../dd/dcf/classntlGeometryClass.html#a09536ca99dbf9d387827bfdc64503812">mpAttrs</a>-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#ae95fe48278d28112a7b0fac13139f315">readInt</a>(<span class="stringliteral">&quot;showparticles&quot;</span>, <a class="code" href="../../da/df3/classSimulationObject.html#a98c0b09d1afedb56c199c244c5f5e91a">mShowParticles</a>, <span class="stringliteral">&quot;SimulationObject&quot;</span>,<span class="stringliteral">&quot;mShowParticles&quot;</span>, <span class="keyword">false</span> ); 
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <a class="code" href="../../de/da5/utilities_8cpp.html#a3a85a47ef5b7f08b7490fad711fc9b85" title="helper to check if a bounding box was specified in the right way">checkBoundingBox</a>( <a class="code" href="../../da/df3/classSimulationObject.html#a03558a6a8cc72cf27d385b09adade25e">mGeoStart</a>, <a class="code" href="../../da/df3/classSimulationObject.html#a1d11952649e96aa38652e8c5668c1258">mGeoEnd</a>, <span class="stringliteral">&quot;SimulationObject::initializeSimulation&quot;</span> );
<a name="l00164"></a>00164     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ac0809a6921826bed25469d2e1fc781fe">setLbmInitId</a>( <a class="code" href="../../dd/dcf/classntlGeometryClass.html#aba1827bd65bf930e57d1b00d2445e911">mGeoInitId</a> );
<a name="l00165"></a>00165     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#aeaed0c5fd31985a8d13ae59b9d9fbf0c">setGeoStart</a>( <a class="code" href="../../da/df3/classSimulationObject.html#a03558a6a8cc72cf27d385b09adade25e">mGeoStart</a> );
<a name="l00166"></a>00166     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#af72e555249961bf13830e2df3f51cbb7">setGeoEnd</a>( <a class="code" href="../../da/df3/classSimulationObject.html#a1d11952649e96aa38652e8c5668c1258">mGeoEnd</a> );
<a name="l00167"></a>00167     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#afc6f45c072e7433de7daf47cc131dee2">setRenderGlobals</a>( <a class="code" href="../../da/df3/classSimulationObject.html#abe94ff9dad7e149a54a12ae166b4f6ae">mpGlob</a> );
<a name="l00168"></a>00168     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#acea442e36b29088971d63c54d0a98bc9">setName</a>( <a class="code" href="../../dd/dcf/classntlGeometryClass.html#aa0433486901f2f913b7ca5c80a0de218">getName</a>() + <span class="stringliteral">&quot;_lbm&quot;</span> );
<a name="l00169"></a>00169     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a5fd301cdb6a3cd3b6d68bb46c7846735">setParticleTracer</a>( mpParts );
<a name="l00170"></a>00170     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>) {
<a name="l00171"></a>00171         <span class="comment">// set further settings from API struct init</span>
<a name="l00172"></a>00172         <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a80c082ac97031e941539c2abd04c5848">outputPath</a>) this-&gt;<a class="code" href="../../de/d7b/classntlGeometryShader.html#a6895178412f83e668d7f306956c54cce">mOutFilename</a> = string(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a80c082ac97031e941539c2abd04c5848">outputPath</a>);
<a name="l00173"></a>00173         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#aca6d975941c419e4ea3095fe8354d4ba">initDomainTrafo</a>( <a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a5c63cd6fa71fd5b7cd1cb618812ce4a1">surfaceTrafo</a> );
<a name="l00174"></a>00174         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a3c24d2da2be0afae96646b5db407139c" title="set amount of surface/normal smoothing">setSmoothing</a>(1.0 * <a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a57259f9450c2cb3bec2c1922ef59a94d">surfaceSmoothing</a>, 1.0 * <a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a57259f9450c2cb3bec2c1922ef59a94d">surfaceSmoothing</a>);
<a name="l00175"></a>00175         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#aab735b83dad0afac84bc40982ff632c8" title="set amount of iso subdivisions">setIsoSubdivs</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a87fc076b93bdf22e53051cf46ca292c3">surfaceSubdivs</a>);
<a name="l00176"></a>00176         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ad79cf89693721c14a2850a504e86d7e6">setSizeX</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#ad3889f49d9cbb6605d366a4161c8857b">resolutionxyz</a>);
<a name="l00177"></a>00177         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a0f3e7eb264ac53037429a3dbd167591e">setSizeY</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#ad3889f49d9cbb6605d366a4161c8857b">resolutionxyz</a>);
<a name="l00178"></a>00178         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a5192290ce5f3070e2fe9015a3b04ee20">setSizeZ</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#ad3889f49d9cbb6605d366a4161c8857b">resolutionxyz</a>);
<a name="l00179"></a>00179         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a6ca0cb2e0402fe1b556edbf7841032bb" title="set desired refinement">setPreviewSize</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a758208b11c683a0448704ad48709d8ac">previewresxyz</a>);
<a name="l00180"></a>00180         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a8f3e3334d2a9603ac5d7f9fd3dc93f16" title="set desired refinement">setRefinementDesired</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a77ab5c61a00f8e65fe7b0abdf0e51196">maxRefine</a>);
<a name="l00181"></a>00181         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a3db9c09aa7e2e7fa842314efbed17317" title="set/get particle generation prob.">setGenerateParticles</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#aeb59eeb8dc95ccdae1fca090ad927f26">generateParticles</a>);
<a name="l00182"></a>00182         <span class="comment">// set initial particles</span>
<a name="l00183"></a>00183         mpParts-&gt;setNumInitialParticles(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#ae3fc4a0a9f553aa0728347e19117ee87">numTracerParticles</a>);
<a name="l00184"></a>00184         
<a name="l00185"></a>00185         <span class="comment">// surface generation flag</span>
<a name="l00186"></a>00186         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a1f94b574b93986f384942de7e2220a26">setSurfGenSettings</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#af59dd3aeb9fde2a848247de8bdbf678e">mFsSurfGenSetting</a>);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188         <span class="keywordtype">string</span> dinitType = string(<span class="stringliteral">&quot;no&quot;</span>);
<a name="l00189"></a>00189         <span class="keywordflow">if</span>     (<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#ac576032106143d0b159b0313615a58bd">domainobsType</a>==<a class="code" href="../../d8/d00/elbeem_8h.html#add9f864fbe2637ae205b5d229596a441">FLUIDSIM_OBSTACLE_PARTSLIP</a>) dinitType = string(<span class="stringliteral">&quot;part&quot;</span>); 
<a name="l00190"></a>00190         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#ac576032106143d0b159b0313615a58bd">domainobsType</a>==<a class="code" href="../../d8/d00/elbeem_8h.html#a43074590bb0f68b1c6220f578de2758a">FLUIDSIM_OBSTACLE_FREESLIP</a>) dinitType = string(<span class="stringliteral">&quot;free&quot;</span>); 
<a name="l00191"></a>00191         <span class="keywordflow">else</span> <span class="comment">/*if(mpElbeemSettings-&gt;domainobsType==FLUIDSIM_OBSTACLE_NOSLIP)*/</span> dinitType = string(<span class="stringliteral">&quot;no&quot;</span>); 
<a name="l00192"></a>00192         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#aa01c0446e3a9a0031ee80f27fb380f15" title="set/get dump velocities flag">setDomainBound</a>(dinitType);
<a name="l00193"></a>00193         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ae03071eedf9bf02b175e927548bb63cf" title="set/get dump velocities flag">setDomainPartSlip</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a521050c37bece4fb09acf0ce70468c90">domainobsPartslip</a>);
<a name="l00194"></a>00194         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a9556259967ebc15dee4ecf4f7f40efc9" title="set/get dump velocities flag">setDumpVelocities</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a1ae68216d87095afdfcfa28391dfb1e1">generateVertexVectors</a>);
<a name="l00195"></a>00195         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a9d67e5884252e1196736e1a08e2c8a21" title="set/get far field size">setFarFieldSize</a>(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a0314c0f91cbfc7a937753f02ca70ae2c">farFieldSize</a>);
<a name="l00196"></a>00196         <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot;Added domain bound: &quot;</span>&lt;&lt;dinitType&lt;&lt;<span class="stringliteral">&quot; ps=&quot;</span>&lt;&lt;<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a521050c37bece4fb09acf0ce70468c90">domainobsPartslip</a>&lt;&lt;<span class="stringliteral">&quot; vv&quot;</span>&lt;&lt;<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a1ae68216d87095afdfcfa28391dfb1e1">generateVertexVectors</a>&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a3a172e908468980c5d092a510711b10e">getDumpVelocities</a>(), 9 );
<a name="l00197"></a>00197 
<a name="l00198"></a>00198         <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot;Set ElbeemSettings values &quot;</span>&lt;&lt;<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ae3c25d65a1da936f06ffe0217e265045">getGenerateParticles</a>(),10);
<a name="l00199"></a>00199     }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     <span class="keywordflow">if</span>(! <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a58a924f6de427e962a0d34dd74f40903">initializeSolverMemory</a>()   )         { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<span class="stringliteral">&quot;initializeSolverMemory failed&quot;</span>); <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a>=<span class="keyword">true</span>; <span class="keywordflow">return</span> 10; }
<a name="l00202"></a>00202     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a1af42dc865b5b70297562850612769aa">checkCallerStatus</a>(<a class="code" href="../../d8/d00/elbeem_8h.html#ab6678d281fc1a20116640b8884c4dd8c">FLUIDSIM_CBSTATUS_STEP</a>, 0)) { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<span class="stringliteral">&quot;initializeSolverMemory status&quot;</span>); <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a>=<span class="keyword">true</span>; <span class="keywordflow">return</span> 11; } 
<a name="l00203"></a>00203     <span class="keywordflow">if</span>(! <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a31236269fc5e68252bed8d9f6fcf7919">initializeSolverGrids</a>()    )         { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<span class="stringliteral">&quot;initializeSolverGrids  failed&quot;</span>); <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a>=<span class="keyword">true</span>; <span class="keywordflow">return</span> 12; }
<a name="l00204"></a>00204     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a1af42dc865b5b70297562850612769aa">checkCallerStatus</a>(<a class="code" href="../../d8/d00/elbeem_8h.html#ab6678d281fc1a20116640b8884c4dd8c">FLUIDSIM_CBSTATUS_STEP</a>, 0)) { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<span class="stringliteral">&quot;initializeSolverGrids  status&quot;</span>); <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a>=<span class="keyword">true</span>; <span class="keywordflow">return</span> 13; } 
<a name="l00205"></a>00205     <span class="keywordflow">if</span>(! <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a9a9835def04b2476e102006ab57d3a94">initializeSolverPostinit</a>() )         { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<span class="stringliteral">&quot;initializeSolverPostin failed&quot;</span>); <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a>=<span class="keyword">true</span>; <span class="keywordflow">return</span> 14; }
<a name="l00206"></a>00206     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a1af42dc865b5b70297562850612769aa">checkCallerStatus</a>(<a class="code" href="../../d8/d00/elbeem_8h.html#ab6678d281fc1a20116640b8884c4dd8c">FLUIDSIM_CBSTATUS_STEP</a>, 0)) { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;SimulationObject::initialize&quot;</span>,<span class="stringliteral">&quot;initializeSolverPostin status&quot;</span>); <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a>=<span class="keyword">true</span>; <span class="keywordflow">return</span> 15; } 
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <span class="comment">// print cell type stats</span>
<a name="l00209"></a>00209     <span class="keywordtype">bool</span> printStats = <span class="keyword">true</span>;
<a name="l00210"></a>00210     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d97/ntl__blenderdumper_8cpp.html#ab6ff78cb4ce2a353f47a92a3c21018f8">glob_mpnum</a>&gt;0) printStats=<span class="keyword">false</span>; <span class="comment">// skip in this case</span>
<a name="l00211"></a>00211     <span class="keywordflow">if</span>(printStats) {
<a name="l00212"></a>00212         <span class="keyword">const</span> <span class="keywordtype">int</span> jmax = <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3c/solver__interface_8h.html#a94930675ea85a64cef414f52b22917ff">CellFlagType</a>)*8;
<a name="l00213"></a>00213         <span class="keywordtype">int</span> totalCells = 0;
<a name="l00214"></a>00214         <span class="keywordtype">int</span> flagCount[jmax];
<a name="l00215"></a>00215         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;jmax ; j++) flagCount[j] = 0;
<a name="l00216"></a>00216         <span class="keywordtype">int</span> diffInits = 0;
<a name="l00217"></a>00217         <a class="code" href="../../dd/dba/classCellIdentifierInterface.html" title="cell identifier interface">LbmSolverInterface::CellIdentifier</a> cid = <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a6bc7afb302ad6cf7fc89daca1894c2df" title="cell iteration methods">getFirstCell</a>();
<a name="l00218"></a>00218         <span class="keywordflow">for</span>(; <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#aad9a057ddd834becbc39647c4f582449">noEndCell</a>( cid );
<a name="l00219"></a>00219                     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ae045a8ecc906fb493817e315ce571f21">advanceCell</a>( cid ) ) {
<a name="l00220"></a>00220             <span class="keywordtype">int</span> flag = <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#adfcd95a3761c7a3b7a514d6101006d34">getCellFlag</a>(cid,0);
<a name="l00221"></a>00221             <span class="keywordtype">int</span> flag2 = <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#adfcd95a3761c7a3b7a514d6101006d34">getCellFlag</a>(cid,1);
<a name="l00222"></a>00222             <span class="keywordflow">if</span>(flag != flag2) {
<a name="l00223"></a>00223                 diffInits++;
<a name="l00224"></a>00224             }
<a name="l00225"></a>00225             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;jmax ; j++) {
<a name="l00226"></a>00226                 <span class="keywordflow">if</span>( flag&amp;(1&lt;&lt;j) ) flagCount[j]++;
<a name="l00227"></a>00227             }
<a name="l00228"></a>00228             totalCells++;
<a name="l00229"></a>00229         }
<a name="l00230"></a>00230         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a0e341c1b7a8bc418745548d33907965d" title="clean up iteration, this should be called, when the iteration is not completely finished">deleteCellIterator</a>( &amp;cid );
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         <span class="keywordtype">char</span> charNl = <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00233"></a>00233         <a class="code" href="../../de/df0/utilities_8h.html#a85fc70c873680bf1b4cab6fd52485c55">debugOutNnl</a>(<span class="stringliteral">&quot;SimulationObject::initializeLbmSimulation celltype stats: &quot;</span> &lt;&lt;charNl, 5);
<a name="l00234"></a>00234         <a class="code" href="../../de/df0/utilities_8h.html#a85fc70c873680bf1b4cab6fd52485c55">debugOutNnl</a>(<span class="stringliteral">&quot;no. of cells = &quot;</span>&lt;&lt;totalCells&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;charNl ,5);
<a name="l00235"></a>00235         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;jmax ; j++) {
<a name="l00236"></a>00236             std::ostringstream out;
<a name="l00237"></a>00237             <span class="keywordflow">if</span>(flagCount[j]&gt;0) {
<a name="l00238"></a>00238                 out&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; flagCount[j] &lt;&lt;<span class="stringliteral">&quot; x &quot;</span>&lt;&lt; <a class="code" href="../../da/d9f/solver__interface_8cpp.html#a232a0b36030169b0250e3e21814fcb23" title="helper function to convert flag to string (for debuggin)">convertCellFlagType2String</a>( (<a class="code" href="../../d2/d3c/solver__interface_8h.html#a94930675ea85a64cef414f52b22917ff">CellFlagType</a>)(1&lt;&lt;j) ) &lt;&lt;<span class="stringliteral">&quot;, &quot;</span> &lt;&lt; charNl;
<a name="l00239"></a>00239                 <a class="code" href="../../de/df0/utilities_8h.html#a85fc70c873680bf1b4cab6fd52485c55">debugOutNnl</a>(out.str(), 5);
<a name="l00240"></a>00240             }
<a name="l00241"></a>00241         }
<a name="l00242"></a>00242         <span class="comment">// compute dist. of empty/bnd - fluid - if</span>
<a name="l00243"></a>00243         <span class="comment">// cfEmpty   = (1&lt;&lt;0), cfBnd  = (1&lt;&lt; 2), cfFluid   = (1&lt;&lt;10), cfInter   = (1&lt;&lt;11),</span>
<a name="l00244"></a>00244         <span class="keywordflow">if</span>(1){
<a name="l00245"></a>00245             std::ostringstream out;
<a name="l00246"></a>00246             out.precision(2); out.width(4);
<a name="l00247"></a>00247             <span class="keywordtype">int</span> totNum = flagCount[1]+flagCount[2]+flagCount[7]+flagCount[8];
<a name="l00248"></a>00248             <span class="keywordtype">double</span> ebFrac = (double)(flagCount[1]+flagCount[2]) / totNum;
<a name="l00249"></a>00249             <span class="keywordtype">double</span> flFrac = (double)(flagCount[7]) / totNum;
<a name="l00250"></a>00250             <span class="keywordtype">double</span> ifFrac = (double)(flagCount[8]) / totNum;
<a name="l00251"></a>00251             <span class="comment">//???</span>
<a name="l00252"></a>00252             out&lt;&lt;<span class="stringliteral">&quot;\tFractions: [empty/bnd - fluid - interface - ext. if]  =  [&quot;</span> &lt;&lt; ebFrac&lt;&lt;<span class="stringliteral">&quot; - &quot;</span> &lt;&lt; flFrac&lt;&lt;<span class="stringliteral">&quot; - &quot;</span> &lt;&lt; ifFrac&lt;&lt;<span class="stringliteral">&quot;] &quot;</span>&lt;&lt; charNl;
<a name="l00253"></a>00253 
<a name="l00254"></a>00254             <span class="keywordflow">if</span>(diffInits &gt; 0) {
<a name="l00255"></a>00255                 <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject::initializeLbmSimulation&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot;celltype Warning: Diffinits=&quot;</span>&lt;&lt;diffInits&lt;&lt;<span class="stringliteral">&quot;!&quot;</span> , 5);
<a name="l00256"></a>00256             }
<a name="l00257"></a>00257             <a class="code" href="../../de/df0/utilities_8h.html#a85fc70c873680bf1b4cab6fd52485c55">debugOutNnl</a>(out.str(), 5);
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259     } <span class="comment">// cellstats</span>
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="comment">// might be modified by mpLbm</span>
<a name="l00262"></a>00262     <span class="comment">//mpParts-&gt;setStart( mGeoStart );?  mpParts-&gt;setEnd( mGeoEnd );?</span>
<a name="l00263"></a>00263     mpParts-&gt;setStart( <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a9ddde8e7f82e0ec3da9cc9a9f68a8d17">getGeoStart</a>() );
<a name="l00264"></a>00264     mpParts-&gt;setEnd(   <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ab131dab72f8e39c64090cd69bda2c7d3">getGeoEnd</a>()   );
<a name="l00265"></a>00265     mpParts-&gt;setCastShadows( <span class="keyword">false</span> );
<a name="l00266"></a>00266     mpParts-&gt;setReceiveShadows( <span class="keyword">false</span> );
<a name="l00267"></a>00267     mpParts-&gt;searchMaterial( glob-&gt;<a class="code" href="../../d0/d95/classntlRenderGlobals.html#a84d31b05d957e34c82f47526d3600cf5" title="Returns the property object list.">getMaterials</a>() );
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     <span class="comment">// this has to be inited here - before, the values might be unknown</span>
<a name="l00270"></a>00270     <a class="code" href="../../db/db9/classIsoSurface.html" title="class to triangulate a scalar field, e.g. for">IsoSurface</a> *surf = <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a8c9424462c786fffda1a70eeef708d5d">getSurfaceGeoObj</a>();
<a name="l00271"></a>00271     <span class="keywordflow">if</span>(surf) {
<a name="l00272"></a>00272         surf-&gt;<a class="code" href="../../dd/dcf/classntlGeometryClass.html#a444f6bbccaccf40d4ebb882ca9ef5889">setName</a>( <span class="stringliteral">&quot;final&quot;</span> ); <span class="comment">// final surface mesh </span>
<a name="l00273"></a>00273         <span class="comment">// warning - this might cause overwriting effects for multiple sims and geom dump...</span>
<a name="l00274"></a>00274         surf-&gt;<a class="code" href="../../df/dc9/classntlGeometryObject.html#ae510cb69a3aaa5af703414b3d75a68bc">setCastShadows</a>( <span class="keyword">true</span> );
<a name="l00275"></a>00275         surf-&gt;<a class="code" href="../../df/dc9/classntlGeometryObject.html#ac7cb82afc6f51a9afdb32a3f3c5555c8">setReceiveShadows</a>( <span class="keyword">false</span> );
<a name="l00276"></a>00276         surf-&gt;<a class="code" href="../../df/dc9/classntlGeometryObject.html#a8f3258e45ebb6663e3bce898a61b75d5">searchMaterial</a>( glob-&gt;<a class="code" href="../../d0/d95/classntlRenderGlobals.html#a84d31b05d957e34c82f47526d3600cf5" title="Returns the property object list.">getMaterials</a>() );
<a name="l00277"></a>00277         <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#af2f736f1e3a346e695a875bfd87407d4">mShowSurface</a>) <a class="code" href="../../de/d7b/classntlGeometryShader.html#ad764ab9ce6d1dde02c01375d94efab3d" title="vector for the objects">mObjects</a>.push_back( surf );
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279     
<a name="l00280"></a>00280 <span class="preprocessor">#ifdef ELBEEM_PLUGIN</span>
<a name="l00281"></a>00281 <span class="preprocessor"></span>    <a class="code" href="../../da/df3/classSimulationObject.html#a98c0b09d1afedb56c199c244c5f5e91a">mShowParticles</a>=1; <span class="comment">// for e.g. dumping</span>
<a name="l00282"></a>00282 <span class="preprocessor">#endif // ELBEEM_PLUGIN</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span>    <span class="keywordflow">if</span>((<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ae3c25d65a1da936f06ffe0217e265045">getGenerateParticles</a>()&gt;0.0)||(mpParts-&gt;getNumInitialParticles()&gt;0)) {
<a name="l00284"></a>00284         <a class="code" href="../../da/df3/classSimulationObject.html#a98c0b09d1afedb56c199c244c5f5e91a">mShowParticles</a>=1;
<a name="l00285"></a>00285         mpParts-&gt;setDumpParts(<span class="keyword">true</span>);
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287         <span class="comment">//debMsgStd(&quot;SimulationObject::init&quot;,DM_NOTIFY,&quot;Using envvar ELBEEM_DUMPPARTICLE to set mShowParticles, DEBUG!&quot;,1);</span>
<a name="l00288"></a>00288     <span class="comment">//}  // DEBUG ENABLE!!!!!!!!!!</span>
<a name="l00289"></a>00289     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a98c0b09d1afedb56c199c244c5f5e91a">mShowParticles</a>) {
<a name="l00290"></a>00290         <a class="code" href="../../de/d7b/classntlGeometryShader.html#ad764ab9ce6d1dde02c01375d94efab3d" title="vector for the objects">mObjects</a>.push_back(mpParts);
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293     <span class="comment">// add objects to display for debugging (e.g. levelset particles)</span>
<a name="l00294"></a>00294     vector&lt;ntlGeometryObject *&gt; debugObjs = <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a4cb0ddc612b9865582c392fac511486b">getDebugObjects</a>();
<a name="l00295"></a>00295     <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;debugObjs.size(); <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00296"></a>00296         debugObjs[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;setCastShadows( <span class="keyword">false</span> );
<a name="l00297"></a>00297         debugObjs[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;setReceiveShadows( <span class="keyword">false</span> );
<a name="l00298"></a>00298         debugObjs[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;searchMaterial( glob-&gt;<a class="code" href="../../d0/d95/classntlRenderGlobals.html#a84d31b05d957e34c82f47526d3600cf5" title="Returns the property object list.">getMaterials</a>() );
<a name="l00299"></a>00299         <a class="code" href="../../de/d7b/classntlGeometryShader.html#ad764ab9ce6d1dde02c01375d94efab3d" title="vector for the objects">mObjects</a>.push_back( debugObjs[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] );
<a name="l00300"></a>00300         <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject::init&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a49b416ae327829b9acf505a5f627a272">DM_NOTIFY</a>,<span class="stringliteral">&quot;Added debug obj &quot;</span>&lt;&lt;debugObjs[i]-&gt;<a class="code" href="../../dd/dcf/classntlGeometryClass.html#aa0433486901f2f913b7ca5c80a0de218">getName</a>(), 10 );
<a name="l00301"></a>00301     }
<a name="l00302"></a>00302     <span class="keywordflow">return</span> 0;
<a name="l00303"></a>00303 }
<a name="l00304"></a>00304 
<a name="l00306"></a><a class="code" href="../../da/df3/classSimulationObject.html#a31b1fe399e8a7adf2831bfcec6230e68">00306</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a31b1fe399e8a7adf2831bfcec6230e68">SimulationObject::setFrameNum</a>(<span class="keywordtype">int</span> num) {
<a name="l00307"></a>00307     <span class="comment">// advance parametrizer</span>
<a name="l00308"></a>00308     <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#af94fe286cc274336da311a2dde5c660b">setFrameNum</a>(num);
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">/******************************************************************************</span>
<a name="l00312"></a>00312 <span class="comment"> * simluation interface: advance simulation another step (whatever delta time that might be) </span>
<a name="l00313"></a>00313 <span class="comment"> *****************************************************************************/</span>
<a name="l00314"></a><a class="code" href="../../da/df3/classSimulationObject.html#a023911a8bb9617f2929f1d4ecd22295d">00314</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a023911a8bb9617f2929f1d4ecd22295d">SimulationObject::step</a>( <span class="keywordtype">void</span> )
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#a57f309e675f4d1307f346c2f5e0fde3e">getCurrentAniFrameTime</a>()&gt;0.0) {
<a name="l00317"></a>00317         <span class="comment">// dont advance for stopped time</span>
<a name="l00318"></a>00318         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a395d05abf14eadce0fcf7c8a44a2c8c7">step</a>();
<a name="l00319"></a>00319         <a class="code" href="../../da/df3/classSimulationObject.html#ac7eed6c3491ab380b4b92a9434071cfd">mTime</a> += <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#ad6481f27613af196314d262f662a5c61">getTimestep</a>();
<a name="l00320"></a>00320         <span class="comment">//if(mTime&gt;0.001) { errMsg(&quot;DEBUG!!!!!!!!&quot;,&quot;quit mlsu...&quot;); xit(1); } // PROFILE DEBUG TEST!</span>
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a650dc3d37dcc4d1516d2efd806a967f1">getPanic</a>()) <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a> = <span class="keyword">true</span>;
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     <a class="code" href="../../da/df3/classSimulationObject.html#a1af42dc865b5b70297562850612769aa">checkCallerStatus</a>(<a class="code" href="../../d8/d00/elbeem_8h.html#ab6678d281fc1a20116640b8884c4dd8c">FLUIDSIM_CBSTATUS_STEP</a>, 0);
<a name="l00325"></a>00325     <span class="comment">//if((mpElbeemSettings)&amp;&amp;(mpElbeemSettings-&gt;runsimCallback)) {</span>
<a name="l00326"></a>00326         <span class="comment">//int ret = (mpElbeemSettings-&gt;runsimCallback)(mpElbeemSettings-&gt;runsimUserData, FLUIDSIM_CBSTATUS_STEP, 0);</span>
<a name="l00327"></a>00327         <span class="comment">//errMsg(&quot;runSimulationCallback cbtest1&quot;,&quot; &quot;&lt;&lt;this-&gt;getName()&lt;&lt;&quot; ret=&quot;&lt;&lt;ret);</span>
<a name="l00328"></a>00328     <span class="comment">//}</span>
<a name="l00329"></a>00329   <span class="comment">//debMsgStd(&quot;SimulationObject::step&quot;,DM_MSG,&quot; Sim &#39;&quot;&lt;&lt;mName&lt;&lt;&quot;&#39; stepped to &quot;&lt;&lt;mTime&lt;&lt;&quot; (stept=&quot;&lt;&lt;(mpParam-&gt;getTimestep())&lt;&lt;&quot;, framet=&quot;&lt;&lt;getFrameTime()&lt;&lt;&quot;) &quot;, 10);</span>
<a name="l00330"></a>00330 }
<a name="l00332"></a><a class="code" href="../../da/df3/classSimulationObject.html#a37a88a8e2e45a308bcf33d322c262400">00332</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a37a88a8e2e45a308bcf33d322c262400">SimulationObject::prepareVisualization</a>( <span class="keywordtype">void</span> ) {
<a name="l00333"></a>00333     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a>) <span class="keywordflow">return</span>;
<a name="l00334"></a>00334     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#af621d92cfd46a2cd623fcfc67246a184">prepareVisualization</a>();
<a name="l00335"></a>00335 }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="comment">/******************************************************************************/</span>
<a name="l00339"></a>00339 <span class="comment">/* get current start simulation time */</span>
<a name="l00340"></a><a class="code" href="../../da/df3/classSimulationObject.html#ac2bfcaed7318b2b55e61497de68ee856">00340</a> <span class="keywordtype">double</span> <a class="code" href="../../da/df3/classSimulationObject.html#ac2bfcaed7318b2b55e61497de68ee856">SimulationObject::getStartTime</a>( <span class="keywordtype">void</span> ) {
<a name="l00341"></a>00341     <span class="comment">//return mpParam-&gt;calculateAniStart();</span>
<a name="l00342"></a>00342     <span class="keywordflow">return</span> <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#a9febabc0ac769c37ee1ac8116f58ea70">getAniStart</a>();
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 <span class="comment">/* get time for a single animation frame */</span>
<a name="l00345"></a><a class="code" href="../../da/df3/classSimulationObject.html#adea02bc9801086a71adc47309bc952f9">00345</a> <span class="keywordtype">double</span> <a class="code" href="../../da/df3/classSimulationObject.html#adea02bc9801086a71adc47309bc952f9">SimulationObject::getFrameTime</a>( <span class="keywordtype">int</span> frame ) {
<a name="l00346"></a>00346     <span class="keywordflow">return</span> <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#a75babdb6b7ad7ec90a308d24b6063280">getAniFrameTime</a>(frame);
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 <span class="comment">/* get time for a single time step  */</span>
<a name="l00349"></a><a class="code" href="../../da/df3/classSimulationObject.html#a235d647f4b0382710fa7be1d1d13ede9">00349</a> <span class="keywordtype">double</span> <a class="code" href="../../da/df3/classSimulationObject.html#a235d647f4b0382710fa7be1d1d13ede9">SimulationObject::getTimestep</a>( <span class="keywordtype">void</span> ) {
<a name="l00350"></a>00350     <span class="keywordflow">return</span> <a class="code" href="../../da/df3/classSimulationObject.html#ad484fd222ce245199ed4912deb3e13f2">mpParam</a>-&gt;<a class="code" href="../../d1/d7f/classParametrizer.html#ad6481f27613af196314d262f662a5c61">getTimestep</a>();
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="comment">/******************************************************************************</span>
<a name="l00355"></a>00355 <span class="comment"> * return a pointer to the geometry object of this simulation </span>
<a name="l00356"></a>00356 <span class="comment"> *****************************************************************************/</span>
<a name="l00357"></a>00357 <span class="comment">//ntlGeometryObject *SimulationObject::getGeometry() { return mpMC; }</span>
<a name="l00358"></a>00358 vector&lt;ntlGeometryObject *&gt;::iterator 
<a name="l00359"></a><a class="code" href="../../da/df3/classSimulationObject.html#ae7ae7ac3b8bb359b74ec359cd956c2c4">00359</a> <a class="code" href="../../da/df3/classSimulationObject.html#ae7ae7ac3b8bb359b74ec359cd956c2c4">SimulationObject::getObjectsBegin</a>()
<a name="l00360"></a>00360 {
<a name="l00361"></a>00361     <span class="keywordflow">return</span> <a class="code" href="../../de/d7b/classntlGeometryShader.html#ad764ab9ce6d1dde02c01375d94efab3d" title="vector for the objects">mObjects</a>.begin();
<a name="l00362"></a>00362 }
<a name="l00363"></a>00363 vector&lt;ntlGeometryObject *&gt;::iterator 
<a name="l00364"></a><a class="code" href="../../da/df3/classSimulationObject.html#aae3a62e58eeb6bd7d1e8b87c04928cb2">00364</a> <a class="code" href="../../da/df3/classSimulationObject.html#aae3a62e58eeb6bd7d1e8b87c04928cb2">SimulationObject::getObjectsEnd</a>()
<a name="l00365"></a>00365 {
<a name="l00366"></a>00366     <span class="keywordflow">return</span> <a class="code" href="../../de/d7b/classntlGeometryShader.html#ad764ab9ce6d1dde02c01375d94efab3d" title="vector for the objects">mObjects</a>.end();
<a name="l00367"></a>00367 }
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 <span class="comment">/******************************************************************************</span>
<a name="l00374"></a>00374 <span class="comment"> * GUI - display debug info </span>
<a name="l00375"></a>00375 <span class="comment"> *****************************************************************************/</span>
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="../../da/df3/classSimulationObject.html#aa5dfd65d62fcc16bd8d66a8174d4f239">00377</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#aa5dfd65d62fcc16bd8d66a8174d4f239">SimulationObject::drawDebugDisplay</a>() {
<a name="l00378"></a>00378 <span class="preprocessor">#ifndef NOGUI</span>
<a name="l00379"></a>00379 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(!<a class="code" href="../../dd/dcf/classntlGeometryClass.html#ad0558ea884fc049a12e55dc8643da897">getVisible</a>()) <span class="keywordflow">return</span>;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381     <span class="comment">//if( mDebugType &gt; (MAX_DEBDISPSET-1) ){ errFatal(&quot;SimulationObject::drawDebugDisplay&quot;,&quot;Invalid debug type!&quot;, SIMWORLD_GENERICERROR); return; }</span>
<a name="l00382"></a>00382     <span class="comment">//mDebDispSet[ mDebugType ].on = true;</span>
<a name="l00383"></a>00383     <span class="comment">//errorOut( mDebugType &lt;&lt;&quot;//&quot;&lt;&lt; mDebDispSet[mDebugType].type );</span>
<a name="l00384"></a>00384     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a1dea6c6dd661aa0c2837c7ce2bdc7108">debugDisplay</a>( <a class="code" href="../../da/df3/classSimulationObject.html#a6fd4135fa863a552a36eeb006a7002c1">mDebugType</a> );
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <span class="comment">//::lbmMarkedCellDisplay&lt;&gt;( mpLbm );</span>
<a name="l00387"></a>00387     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a3f825296aec0c1069c8ef053b3b1b4c3">lbmMarkedCellDisplay</a>();
<a name="l00388"></a>00388 <span class="preprocessor">#endif</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span>}
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="comment">/* GUI - display interactive info  */</span>
<a name="l00392"></a><a class="code" href="../../da/df3/classSimulationObject.html#a734437601fac29a4309c1282f3e57620">00392</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a734437601fac29a4309c1282f3e57620">SimulationObject::drawInteractiveDisplay</a>()
<a name="l00393"></a>00393 {
<a name="l00394"></a>00394 <span class="preprocessor">#ifndef NOGUI</span>
<a name="l00395"></a>00395 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(!<a class="code" href="../../dd/dcf/classntlGeometryClass.html#ad0558ea884fc049a12e55dc8643da897">getVisible</a>()) <span class="keywordflow">return</span>;
<a name="l00396"></a>00396     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a020d9170ce642327954334b7f3377de7">mSelectedCid</a>) {
<a name="l00397"></a>00397         <span class="comment">// in debugDisplayNode if dispset is on is ignored...</span>
<a name="l00398"></a>00398         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a257bc81b04549232a9620b685a03f1f0">debugDisplayNode</a>( <a class="code" href="../../d2/d3c/solver__interface_8h.html#ac4014e1b7878ea60a3726672d3f6bd76">FLUIDDISPGrid</a>, <a class="code" href="../../da/df3/classSimulationObject.html#a020d9170ce642327954334b7f3377de7">mSelectedCid</a> );
<a name="l00399"></a>00399     }
<a name="l00400"></a>00400 <span class="preprocessor">#endif</span>
<a name="l00401"></a>00401 <span class="preprocessor"></span>}
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 <span class="comment">/*******************************************************************************/</span>
<a name="l00405"></a>00405 <span class="comment">// GUI - handle mouse movement for selection </span>
<a name="l00406"></a>00406 <span class="comment">/*******************************************************************************/</span>
<a name="l00407"></a><a class="code" href="../../da/df3/classSimulationObject.html#a9887ebb4fa0fd32f34ebfbdfab5d8fcf">00407</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a9887ebb4fa0fd32f34ebfbdfab5d8fcf">SimulationObject::setMousePos</a>(<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y, <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ntlVec3Gfx</a> org, <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ntlVec3Gfx</a> dir)
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409     <a class="code" href="../../d1/d22/stdosl_8h.html#a03960008c09030a58b2c79672320cb3f">normalize</a>( dir );
<a name="l00410"></a>00410     <span class="comment">// assume 2D sim is in XY plane...</span>
<a name="l00411"></a>00411     
<a name="l00412"></a>00412     <span class="keywordtype">double</span> zplane = (<a class="code" href="../../da/df3/classSimulationObject.html#a1d11952649e96aa38652e8c5668c1258">mGeoEnd</a>[2]-<a class="code" href="../../da/df3/classSimulationObject.html#a03558a6a8cc72cf27d385b09adade25e">mGeoStart</a>[2])*0.5;
<a name="l00413"></a>00413     <span class="keywordtype">double</span> zt = (zplane-org[2]) / dir[2];
<a name="l00414"></a>00414     <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ntlVec3Gfx</a> pos(
<a name="l00415"></a>00415             org[0]+ dir[0] * zt,
<a name="l00416"></a>00416             org[1]+ dir[1] * zt, 0.0);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418     <a class="code" href="../../da/df3/classSimulationObject.html#a020d9170ce642327954334b7f3377de7">mSelectedCid</a> = <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#ab884ca11cdb03b5b28c41ad60dbd41aa" title="find cell at a given position (returns NULL if not in domain)">getCellAt</a>( pos );
<a name="l00419"></a>00419     <span class="comment">//errMsg(&quot;SMP &quot;, mName&lt;&lt; x&lt;&lt;&quot; &quot;&lt;&lt;y&lt;&lt;&quot; - &quot;&lt;&lt;dir );</span>
<a name="l00420"></a>00420     x = y = 0; <span class="comment">// remove warning</span>
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422             
<a name="l00423"></a>00423 
<a name="l00424"></a><a class="code" href="../../da/df3/classSimulationObject.html#a571ba0fb8423a8a4bc21e95159fe1bda">00424</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a571ba0fb8423a8a4bc21e95159fe1bda">SimulationObject::setMouseClick</a>()
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426     <span class="keywordflow">if</span>(<a class="code" href="../../da/df3/classSimulationObject.html#a020d9170ce642327954334b7f3377de7">mSelectedCid</a>) {
<a name="l00427"></a>00427         <span class="comment">//::debugPrintNodeInfo&lt;&gt;( mpLbm, mSelectedCid, mpLbm-&gt;getNodeInfoString() );</span>
<a name="l00428"></a>00428         <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#afeb573253aa84976a552ca2bbefede00">debugPrintNodeInfo</a>( <a class="code" href="../../da/df3/classSimulationObject.html#a020d9170ce642327954334b7f3377de7">mSelectedCid</a> );
<a name="l00429"></a>00429     }
<a name="l00430"></a>00430 }
<a name="l00431"></a>00431 
<a name="l00433"></a><a class="code" href="../../da/df3/classSimulationObject.html#a2615a1b50d12773e4965b325dd99b694">00433</a> <span class="keywordtype">void</span> <a class="code" href="../../da/df3/classSimulationObject.html#a2615a1b50d12773e4965b325dd99b694">SimulationObject::notifyShaderOfDump</a>(<span class="keywordtype">int</span> dumptype, <span class="keywordtype">int</span> frameNr,<span class="keywordtype">char</span> *frameNrStr,<span class="keywordtype">string</span> outfilename) {
<a name="l00434"></a>00434     <span class="keywordflow">if</span>(!<a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>) <span class="keywordflow">return</span>;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <a class="code" href="../../da/df3/classSimulationObject.html#ac7b47926e25bf542e489a380e1d5fbdf">mpLbm</a>-&gt;<a class="code" href="../../db/dff/classLbmSolverInterface.html#a19a3358a5944eed0f6d22da293ab3386">notifySolverOfDump</a>(dumptype, frameNr,frameNrStr,outfilename);
<a name="l00437"></a>00437     <a class="code" href="../../da/df3/classSimulationObject.html#a1af42dc865b5b70297562850612769aa">checkCallerStatus</a>(<a class="code" href="../../d8/d00/elbeem_8h.html#a5672810bf857fc96e76a66b0bde66f09">FLUIDSIM_CBSTATUS_NEWFRAME</a>, frameNr);
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00441"></a><a class="code" href="../../da/df3/classSimulationObject.html#a1af42dc865b5b70297562850612769aa">00441</a> <span class="keywordtype">int</span> <a class="code" href="../../da/df3/classSimulationObject.html#a1af42dc865b5b70297562850612769aa">SimulationObject::checkCallerStatus</a>(<span class="keywordtype">int</span> status, <span class="keywordtype">int</span> frame) {
<a name="l00442"></a>00442     <span class="comment">//return 0; // DEBUG</span>
<a name="l00443"></a>00443     <span class="keywordtype">int</span> ret = 0;
<a name="l00444"></a>00444     <span class="keywordflow">if</span>((<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>)&amp;&amp;(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a763e235978764c2cbc268af674731652">runsimCallback</a>)) {
<a name="l00445"></a>00445         ret = (<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a763e235978764c2cbc268af674731652">runsimCallback</a>)(<a class="code" href="../../da/df3/classSimulationObject.html#af8f2376c3f68a0b2b1192a94a4fab9d3">mpElbeemSettings</a>-&gt;<a class="code" href="../../d3/d14/structelbeemSimulationSettings.html#a3f02301d3d2de00a8519079c2bc2d2b5">runsimUserData</a>, status,frame);
<a name="l00446"></a>00446         <span class="keywordflow">if</span>(ret!=<a class="code" href="../../d8/d00/elbeem_8h.html#ad71ec863a8a9b953281b5145ea91c263">FLUIDSIM_CBRET_CONTINUE</a>) {
<a name="l00447"></a>00447             <span class="keywordflow">if</span>(ret==<a class="code" href="../../d8/d00/elbeem_8h.html#a072eba852f03ab5ea2d0131348ce27ef">FLUIDSIM_CBRET_STOP</a>) {
<a name="l00448"></a>00448                 <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;SimulationObject::notifySolverOfDump&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a49b416ae327829b9acf505a5f627a272">DM_NOTIFY</a>,<span class="stringliteral">&quot;Got stop signal from caller&quot;</span>,1);
<a name="l00449"></a>00449                 <a class="code" href="../../de/da5/utilities_8cpp.html#a4cb779c77c9d3b803fa9076c8f38e945">setElbeemState</a>( <a class="code" href="../../de/df0/utilities_8h.html#a7e6c8a9b196c6e8ad8c6009c7650ab40">SIMWORLD_STOP</a> );
<a name="l00450"></a>00450             }
<a name="l00451"></a>00451             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ret==<a class="code" href="../../d8/d00/elbeem_8h.html#a48c508319c934a028145ee0bd0a13f1e">FLUIDSIM_CBRET_ABORT</a>) {
<a name="l00452"></a>00452                 <a class="code" href="../../de/df0/utilities_8h.html#abbf67626aa468b4301520b9f6f292e1c">errFatal</a>(<span class="stringliteral">&quot;SimulationObject::notifySolverOfDump&quot;</span>,<span class="stringliteral">&quot;Got abort signal from caller, aborting...&quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#af2f6eab59be57681799dbee88ff4c4a7">SIMWORLD_GENERICERROR</a> );
<a name="l00453"></a>00453                 <a class="code" href="../../da/df3/classSimulationObject.html#a06878d776c05802ebfbdb135287bc42b">mPanic</a> = 1;
<a name="l00454"></a>00454             }
<a name="l00455"></a>00455             <span class="keywordflow">else</span> {
<a name="l00456"></a>00456                 <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;SimulationObject::notifySolverOfDump&quot;</span>,<span class="stringliteral">&quot;Invalid callback return value: &quot;</span>&lt;&lt;ret&lt;&lt;<span class="stringliteral">&quot;, ignoring... &quot;</span>);
<a name="l00457"></a>00457             }
<a name="l00458"></a>00458         }
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <span class="comment">//debMsgStd(&quot;SimulationObject::checkCallerStatus&quot;,DM_MSG, &quot;s=&quot;&lt;&lt;status&lt;&lt;&quot;,f=&quot;&lt;&lt;frame&lt;&lt;&quot; &quot;&lt;&lt;this-&gt;getName()&lt;&lt;&quot; ret=&quot;&lt;&lt;ret);</span>
<a name="l00462"></a>00462     <span class="keywordflow">if</span>(<a class="code" href="../../de/da5/utilities_8cpp.html#af3e89e0e3df33a7bf12fb4903a18f79b">isSimworldOk</a>()) <span class="keywordflow">return</span> 0;
<a name="l00463"></a>00463     <span class="keywordflow">return</span> 1;
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:55 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
