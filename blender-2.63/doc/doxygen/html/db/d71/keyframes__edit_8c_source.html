<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: keyframes_edit.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">keyframes_edit.c</div>  </div>
</div>
<div class="contents">
<a href="../../db/d71/keyframes__edit_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2008 Blender Foundation</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * Contributor(s): Joshua Leung</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00023"></a>00023 <span class="comment"> */</span>
<a name="l00024"></a>00024 
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;float.h&gt;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html">DNA_anim_types.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d93/DNA__armature__types_8h.html">DNA_armature_types.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d3b/DNA__camera__types_8h.html">DNA_camera_types.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d41/DNA__key__types_8h.html">DNA_key_types.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html">DNA_lamp_types.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2f/DNA__lattice__types_8h.html">DNA_lattice_types.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d96/DNA__mesh__types_8h.html">DNA_mesh_types.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../de/db2/DNA__material__types_8h.html">DNA_material_types.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d40/DNA__meta__types_8h.html">DNA_meta_types.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d27/DNA__node__types_8h.html">DNA_node_types.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d5a/DNA__particle__types_8h.html">DNA_particle_types.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5d/DNA__space__types_8h.html">DNA_space_types.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d3b/DNA__world__types_8h.html">DNA_world_types.h</a>&quot;</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dba/BKE__fcurve_8h.html">BKE_fcurve.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d17/BKE__key_8h.html">BKE_key.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d0f/BKE__material_8h.html" title="General operations, lookup, etc. for materials.">BKE_material.h</a>&quot;</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d6f/ED__anim__api_8h.html">ED_anim_api.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html">ED_keyframes_edit.h</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/da6/ED__markers_8h.html">ED_markers.h</a>&quot;</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="comment">/* This file defines an API and set of callback-operators for non-destructive editing of keyframe data.</span>
<a name="l00067"></a>00067 <span class="comment"> *</span>
<a name="l00068"></a>00068 <span class="comment"> * Two API functions are defined for actually performing the operations on the data:</span>
<a name="l00069"></a>00069 <span class="comment"> *          ANIM_fcurve_keyframes_loop()</span>
<a name="l00070"></a>00070 <span class="comment"> * which take the data they operate on, a few callbacks defining what operations to perform.</span>
<a name="l00071"></a>00071 <span class="comment"> *</span>
<a name="l00072"></a>00072 <span class="comment"> * As operators which work on keyframes usually apply the same operation on all BezTriples in </span>
<a name="l00073"></a>00073 <span class="comment"> * every channel, the code has been optimized providing a set of functions which will get the </span>
<a name="l00074"></a>00074 <span class="comment"> * appropriate bezier-modify function to set. These functions (ANIM_editkeyframes_*) will need</span>
<a name="l00075"></a>00075 <span class="comment"> * to be called before getting any channels.</span>
<a name="l00076"></a>00076 <span class="comment"> * </span>
<a name="l00077"></a>00077 <span class="comment"> * A set of &#39;validation&#39; callbacks are provided for checking if a BezTriple should be operated on.</span>
<a name="l00078"></a>00078 <span class="comment"> * These should only be used when using a &#39;general&#39; BezTriple editor (i.e. selection setters which </span>
<a name="l00079"></a>00079 <span class="comment"> * don&#39;t check existing selection status).</span>
<a name="l00080"></a>00080 <span class="comment"> * </span>
<a name="l00081"></a>00081 <span class="comment"> * - Joshua Leung, Dec 2008</span>
<a name="l00082"></a>00082 <span class="comment"> */</span>
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">/* ************************************************************************** */</span>
<a name="l00085"></a>00085 <span class="comment">/* Keyframe Editing Loops - Exposed API */</span>
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">/* --------------------------- Base Functions ------------------------------------ */</span>
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="comment">/* This function is used to loop over BezTriples in the given F-Curve, applying a given </span>
<a name="l00090"></a>00090 <span class="comment"> * operation on them, and optionally applies an F-Curve validation function afterwards.</span>
<a name="l00091"></a>00091 <span class="comment"> */</span>
<a name="l00092"></a>00092 <span class="comment">// TODO: make this function work on samples too...</span>
<a name="l00093"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#af0d57eb43247c7da03c064d2f0bc5a66">00093</a> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb) 
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095     <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt;
<a name="l00096"></a>00096     <span class="keywordtype">short</span> ok = 0;
<a name="l00097"></a>00097     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="comment">/* sanity check */</span>
<a name="l00100"></a>00100     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, fcu, fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a799ab2725f85e5ee19e9ef88a8d6b006">bezt</a>))
<a name="l00101"></a>00101         <span class="keywordflow">return</span> 0;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="comment">/* set the F-Curve into the editdata so that it can be accessed */</span>
<a name="l00104"></a>00104     <span class="keywordflow">if</span> (ked) {
<a name="l00105"></a>00105         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a0dc5a03e9718b99cf5dfb1caf3218c09">fcu</a>= fcu;
<a name="l00106"></a>00106         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac37b9c3a8de77ef6688c8f972c2c432d">curIndex</a>= 0;
<a name="l00107"></a>00107         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a>= ok;
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="comment">/* if function to apply to bezier curves is set, then loop through executing it on beztriples */</span>
<a name="l00111"></a>00111     <span class="keywordflow">if</span> (key_cb) {
<a name="l00112"></a>00112         <span class="comment">/* if there&#39;s a validation func, include that check in the loop </span>
<a name="l00113"></a>00113 <span class="comment">         * (this is should be more efficient than checking for it in every loop)</span>
<a name="l00114"></a>00114 <span class="comment">         */</span>
<a name="l00115"></a>00115         <span class="keywordflow">if</span> (key_ok) {
<a name="l00116"></a>00116             <span class="keywordflow">for</span> (bezt=fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a799ab2725f85e5ee19e9ef88a8d6b006">bezt</a>, i=0; i &lt; fcu-&gt;totvert; bezt++, i++) {
<a name="l00117"></a>00117                 <span class="keywordflow">if</span> (ked) {
<a name="l00118"></a>00118                     <span class="comment">/* advance the index, and reset the ok flags (to not influence the result) */</span>
<a name="l00119"></a>00119                     ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac37b9c3a8de77ef6688c8f972c2c432d">curIndex</a>= <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00120"></a>00120                     ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a>= 0;
<a name="l00121"></a>00121                 }
<a name="l00122"></a>00122                 
<a name="l00123"></a>00123                 <span class="comment">/* Only operate on this BezTriple if it fullfills the criteria of the validation func */</span>
<a name="l00124"></a>00124                 <span class="keywordflow">if</span> ( (ok = key_ok(ked, bezt)) ) {
<a name="l00125"></a>00125                     <span class="keywordflow">if</span> (ked) ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a>= ok;
<a name="l00126"></a>00126                     
<a name="l00127"></a>00127                     <span class="comment">/* Exit with return-code &#39;1&#39; if function returns positive</span>
<a name="l00128"></a>00128 <span class="comment">                     * This is useful if finding if some BezTriple satisfies a condition.</span>
<a name="l00129"></a>00129 <span class="comment">                     */</span>
<a name="l00130"></a>00130                     <span class="keywordflow">if</span> (key_cb(ked, bezt)) <span class="keywordflow">return</span> 1;
<a name="l00131"></a>00131                 }
<a name="l00132"></a>00132             }
<a name="l00133"></a>00133         }
<a name="l00134"></a>00134         <span class="keywordflow">else</span> {
<a name="l00135"></a>00135             <span class="keywordflow">for</span> (bezt=fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a799ab2725f85e5ee19e9ef88a8d6b006">bezt</a>, i=0; i &lt; fcu-&gt;totvert; bezt++, i++) {
<a name="l00136"></a>00136                 <span class="keywordflow">if</span> (ked) ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac37b9c3a8de77ef6688c8f972c2c432d">curIndex</a>= <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00137"></a>00137                 
<a name="l00138"></a>00138                 <span class="comment">/* Exit with return-code &#39;1&#39; if function returns positive</span>
<a name="l00139"></a>00139 <span class="comment">                 * This is useful if finding if some BezTriple satisfies a condition.</span>
<a name="l00140"></a>00140 <span class="comment">                 */</span>
<a name="l00141"></a>00141                 <span class="keywordflow">if</span> (key_cb(ked, bezt)) <span class="keywordflow">return</span> 1;
<a name="l00142"></a>00142             }
<a name="l00143"></a>00143         }
<a name="l00144"></a>00144     }
<a name="l00145"></a>00145     
<a name="l00146"></a>00146     <span class="comment">/* unset the F-Curve from the editdata now that it&#39;s done */</span>
<a name="l00147"></a>00147     <span class="keywordflow">if</span> (ked) {
<a name="l00148"></a>00148         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a0dc5a03e9718b99cf5dfb1caf3218c09">fcu</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00149"></a>00149         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac37b9c3a8de77ef6688c8f972c2c432d">curIndex</a>= 0;
<a name="l00150"></a>00150         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a>= 0;
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     <span class="comment">/* if fcu_cb (F-Curve post-editing callback) has been specified then execute it */</span>
<a name="l00154"></a>00154     <span class="keywordflow">if</span> (fcu_cb)
<a name="l00155"></a>00155         fcu_cb(fcu);
<a name="l00156"></a>00156     
<a name="l00157"></a>00157     <span class="comment">/* done */</span>  
<a name="l00158"></a>00158     <span class="keywordflow">return</span> 0;
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">/* -------------------------------- Further Abstracted (Not Exposed Directly) ----------------------------- */</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">/* This function is used to loop over the keyframe data in an Action Group */</span>
<a name="l00164"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#abead8a46857208fdbf265a267c323460">00164</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#abead8a46857208fdbf265a267c323460">agrp_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d9/dcf/structbActionGroup.html">bActionGroup</a> *agrp, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb)
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166     <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu;
<a name="l00167"></a>00167     
<a name="l00168"></a>00168     <span class="comment">/* sanity check */</span>
<a name="l00169"></a>00169     <span class="keywordflow">if</span> (agrp == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00170"></a>00170         <span class="keywordflow">return</span> 0;
<a name="l00171"></a>00171     
<a name="l00172"></a>00172     <span class="comment">/* only iterate over the F-Curves that are in this group */</span>
<a name="l00173"></a>00173     <span class="keywordflow">for</span> (fcu= agrp-&gt;<a class="code" href="../../d9/dcf/structbActionGroup.html#ad0e1909ae82afb9b3ece50be1e3d9915">channels</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; fcu &amp;&amp; fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a3e312bcc15bdf7b83ce03a842044350a">grp</a>==agrp; fcu= fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a381b65464374cad861b80c44b9ae0759">next</a>) {
<a name="l00174"></a>00174         <span class="keywordflow">if</span> (<a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(ked, fcu, key_ok, key_cb, fcu_cb))
<a name="l00175"></a>00175             <span class="keywordflow">return</span> 1;
<a name="l00176"></a>00176     }
<a name="l00177"></a>00177     
<a name="l00178"></a>00178     <span class="keywordflow">return</span> 0;
<a name="l00179"></a>00179 }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="comment">/* This function is used to loop over the keyframe data in an Action */</span>
<a name="l00182"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#ade9c9049139397a7aede48a0e3e493b8">00182</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ade9c9049139397a7aede48a0e3e493b8">act_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *act, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb)
<a name="l00183"></a>00183 {
<a name="l00184"></a>00184     <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu;
<a name="l00185"></a>00185     
<a name="l00186"></a>00186     <span class="comment">/* sanity check */</span>
<a name="l00187"></a>00187     <span class="keywordflow">if</span> (act == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00188"></a>00188         <span class="keywordflow">return</span> 0;
<a name="l00189"></a>00189     
<a name="l00190"></a>00190     <span class="comment">/* just loop through all F-Curves */</span>
<a name="l00191"></a>00191     <span class="keywordflow">for</span> (fcu= act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; fcu; fcu= fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a381b65464374cad861b80c44b9ae0759">next</a>) {
<a name="l00192"></a>00192         <span class="keywordflow">if</span> (<a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(ked, fcu, key_ok, key_cb, fcu_cb))
<a name="l00193"></a>00193             <span class="keywordflow">return</span> 1;
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195     
<a name="l00196"></a>00196     <span class="keywordflow">return</span> 0;
<a name="l00197"></a>00197 }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="comment">/* This function is used to loop over the keyframe data in an Object */</span>
<a name="l00200"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#ae1b5b2d957d77f0e9754ff1c51edf4c5">00200</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ae1b5b2d957d77f0e9754ff1c51edf4c5">ob_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../df/de9/structbDopeSheet.html">bDopeSheet</a> *ads, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb)
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202     <a class="code" href="../../d6/dca/structbAnimContext.html">bAnimContext</a> ac = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00203"></a>00203     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> anim_data = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00204"></a>00204     <a class="code" href="../../d6/dfc/structbAnimListElem.html">bAnimListElem</a> *ale;
<a name="l00205"></a>00205     <span class="keywordtype">int</span> <a class="code" href="../../dc/d53/implicit_8c.html#a5085563b3b926cbcce0bef0946da311e">filter</a>;
<a name="l00206"></a>00206     <span class="keywordtype">int</span> ret=0;
<a name="l00207"></a>00207     
<a name="l00208"></a>00208     <a class="code" href="../../d6/dfc/structbAnimListElem.html">bAnimListElem</a> dummychan = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00209"></a>00209     <a class="code" href="../../d3/da9/structBase.html">Base</a> dummybase = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00210"></a>00210     
<a name="l00211"></a>00211     <span class="keywordflow">if</span> (ob == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00212"></a>00212         <span class="keywordflow">return</span> 0;
<a name="l00213"></a>00213     
<a name="l00214"></a>00214     <span class="comment">/* create a dummy wrapper data to work with */</span>
<a name="l00215"></a>00215     dummybase.<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a> = ob;
<a name="l00216"></a>00216     
<a name="l00217"></a>00217     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#a5441225f529822c4d371c0de8bf8151f">type</a> = <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a1f9698bef8587ea2fa6522d0299e70b7ae2343c6cd206c77f666c41a9fdd2d9b5">ANIMTYPE_OBJECT</a>;
<a name="l00218"></a>00218     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a> = &amp;dummybase;
<a name="l00219"></a>00219     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#ad2686a20c9c11e9889e3f4d9a60b8b8c">id</a> = &amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>;
<a name="l00220"></a>00220     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#ab7b41d9d9780a114a3ef17efbda67444">adt</a> = ob-&gt;<a class="code" href="../../de/de7/structObject.html#ac096321d973976369c05cef4b2a9565b">adt</a>;
<a name="l00221"></a>00221     
<a name="l00222"></a>00222     ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a58e9368e226140c365269be25d531a8c">ads</a> = ads;
<a name="l00223"></a>00223     ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a6746afe77831350347f788f226a9320a">data</a> = &amp;dummychan;
<a name="l00224"></a>00224     ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a5a52c7e6c531f78a79d7d8b92a887700">datatype</a> = <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a7a050140c42c915acc0ce08d5028df86af8ca1fd6d55bcbb90f6061abb699334f">ANIMCONT_CHANNEL</a>;
<a name="l00225"></a>00225     
<a name="l00226"></a>00226     <span class="comment">/* get F-Curves to take keyframes from */</span>
<a name="l00227"></a>00227     filter= <a class="code" href="../../df/d6f/ED__anim__api_8h.html#aeb469b1e009f7669ddacedd695291045a584f2145e984f8afb13e6cdeb4c0ac31">ANIMFILTER_DATA_VISIBLE</a>; <span class="comment">// curves only</span>
<a name="l00228"></a>00228     <a class="code" href="../../dc/d01/anim__filter_8c.html#a13681020f63c886ca5bfc9a2ff39620b">ANIM_animdata_filter</a>(&amp;ac, &amp;anim_data, filter, ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a6746afe77831350347f788f226a9320a">data</a>, ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a5a52c7e6c531f78a79d7d8b92a887700">datatype</a>);
<a name="l00229"></a>00229     
<a name="l00230"></a>00230     <span class="comment">/* loop through each F-Curve, applying the operation as required, but stopping on the first one */</span>
<a name="l00231"></a>00231     <span class="keywordflow">for</span> (ale= anim_data.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ale; ale= ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a5ccf2b36d14379524140d1c18942a2ef">next</a>) {
<a name="l00232"></a>00232         <span class="keywordflow">if</span> (<a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(ked, (<a class="code" href="../../d6/df2/structFCurve.html">FCurve</a>*)ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a>, key_ok, key_cb, fcu_cb)) {
<a name="l00233"></a>00233             ret = 1;
<a name="l00234"></a>00234             <span class="keywordflow">break</span>;
<a name="l00235"></a>00235         }
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     
<a name="l00238"></a>00238     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;anim_data);
<a name="l00239"></a>00239     
<a name="l00240"></a>00240     <span class="comment">/* return return code - defaults to zero if nothing happened */</span>
<a name="l00241"></a>00241     <span class="keywordflow">return</span> ret;
<a name="l00242"></a>00242 }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="comment">/* This function is used to loop over the keyframe data in a Scene */</span>
<a name="l00245"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a69cc66e0398a1d21370163c455238bb7">00245</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a69cc66e0398a1d21370163c455238bb7">scene_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../df/de9/structbDopeSheet.html">bDopeSheet</a> *ads, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb)
<a name="l00246"></a>00246 {
<a name="l00247"></a>00247     <a class="code" href="../../d6/dca/structbAnimContext.html">bAnimContext</a> ac = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00248"></a>00248     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> anim_data = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00249"></a>00249     <a class="code" href="../../d6/dfc/structbAnimListElem.html">bAnimListElem</a> *ale;
<a name="l00250"></a>00250     <span class="keywordtype">int</span> <a class="code" href="../../dc/d53/implicit_8c.html#a5085563b3b926cbcce0bef0946da311e">filter</a>;
<a name="l00251"></a>00251     <span class="keywordtype">int</span> ret=0;
<a name="l00252"></a>00252     
<a name="l00253"></a>00253     <a class="code" href="../../d6/dfc/structbAnimListElem.html">bAnimListElem</a> dummychan = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00254"></a>00254     
<a name="l00255"></a>00255     <span class="keywordflow">if</span> (sce == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00256"></a>00256         <span class="keywordflow">return</span> 0;
<a name="l00257"></a>00257     
<a name="l00258"></a>00258     <span class="comment">/* create a dummy wrapper data to work with */</span>
<a name="l00259"></a>00259     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#a5441225f529822c4d371c0de8bf8151f">type</a> = <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a1f9698bef8587ea2fa6522d0299e70b7a6beea10df4db5286f40a857d7d837f17">ANIMTYPE_SCENE</a>;
<a name="l00260"></a>00260     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a> = sce;
<a name="l00261"></a>00261     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#ad2686a20c9c11e9889e3f4d9a60b8b8c">id</a> = &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>;
<a name="l00262"></a>00262     dummychan.<a class="code" href="../../d6/dfc/structbAnimListElem.html#ab7b41d9d9780a114a3ef17efbda67444">adt</a> = sce-&gt;<a class="code" href="../../d9/d27/structScene.html#abdea91c45720e729d4fd49b37fee664e">adt</a>;
<a name="l00263"></a>00263     
<a name="l00264"></a>00264     ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a58e9368e226140c365269be25d531a8c">ads</a> = ads;
<a name="l00265"></a>00265     ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a6746afe77831350347f788f226a9320a">data</a> = &amp;dummychan;
<a name="l00266"></a>00266     ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a5a52c7e6c531f78a79d7d8b92a887700">datatype</a> = <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a7a050140c42c915acc0ce08d5028df86af8ca1fd6d55bcbb90f6061abb699334f">ANIMCONT_CHANNEL</a>;
<a name="l00267"></a>00267     
<a name="l00268"></a>00268     <span class="comment">/* get F-Curves to take keyframes from */</span>
<a name="l00269"></a>00269     filter= <a class="code" href="../../df/d6f/ED__anim__api_8h.html#aeb469b1e009f7669ddacedd695291045a584f2145e984f8afb13e6cdeb4c0ac31">ANIMFILTER_DATA_VISIBLE</a>; <span class="comment">// curves only</span>
<a name="l00270"></a>00270     <a class="code" href="../../dc/d01/anim__filter_8c.html#a13681020f63c886ca5bfc9a2ff39620b">ANIM_animdata_filter</a>(&amp;ac, &amp;anim_data, filter, ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a6746afe77831350347f788f226a9320a">data</a>, ac.<a class="code" href="../../d6/dca/structbAnimContext.html#a5a52c7e6c531f78a79d7d8b92a887700">datatype</a>);
<a name="l00271"></a>00271     
<a name="l00272"></a>00272     <span class="comment">/* loop through each F-Curve, applying the operation as required, but stopping on the first one */</span>
<a name="l00273"></a>00273     <span class="keywordflow">for</span> (ale= anim_data.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ale; ale= ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a5ccf2b36d14379524140d1c18942a2ef">next</a>) {
<a name="l00274"></a>00274         <span class="keywordflow">if</span> (<a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(ked, (<a class="code" href="../../d6/df2/structFCurve.html">FCurve</a>*)ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a>, key_ok, key_cb, fcu_cb)) {
<a name="l00275"></a>00275             ret = 1;
<a name="l00276"></a>00276             <span class="keywordflow">break</span>;
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279     
<a name="l00280"></a>00280     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;anim_data);
<a name="l00281"></a>00281     
<a name="l00282"></a>00282     <span class="comment">/* return return code - defaults to zero if nothing happened */</span>
<a name="l00283"></a>00283     <span class="keywordflow">return</span> ret;
<a name="l00284"></a>00284 }
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="comment">/* This function is used to loop over the keyframe data in a DopeSheet summary */</span>
<a name="l00287"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a08302291884133336c95de36006960cd">00287</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a08302291884133336c95de36006960cd">summary_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d6/dca/structbAnimContext.html">bAnimContext</a> *ac, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb)
<a name="l00288"></a>00288 {
<a name="l00289"></a>00289     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> anim_data = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00290"></a>00290     <a class="code" href="../../d6/dfc/structbAnimListElem.html">bAnimListElem</a> *ale;
<a name="l00291"></a>00291     <span class="keywordtype">int</span> <a class="code" href="../../dc/d53/implicit_8c.html#a5085563b3b926cbcce0bef0946da311e">filter</a>, ret_code=0;
<a name="l00292"></a>00292     
<a name="l00293"></a>00293     <span class="comment">/* sanity check */</span>
<a name="l00294"></a>00294     <span class="keywordflow">if</span> (ac == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00295"></a>00295         <span class="keywordflow">return</span> 0;
<a name="l00296"></a>00296     
<a name="l00297"></a>00297     <span class="comment">/* get F-Curves to take keyframes from */</span>
<a name="l00298"></a>00298     filter= <a class="code" href="../../df/d6f/ED__anim__api_8h.html#aeb469b1e009f7669ddacedd695291045a584f2145e984f8afb13e6cdeb4c0ac31">ANIMFILTER_DATA_VISIBLE</a>;
<a name="l00299"></a>00299     <a class="code" href="../../dc/d01/anim__filter_8c.html#a13681020f63c886ca5bfc9a2ff39620b">ANIM_animdata_filter</a>(ac, &amp;anim_data, filter, ac-&gt;<a class="code" href="../../d6/dca/structbAnimContext.html#a6746afe77831350347f788f226a9320a">data</a>, ac-&gt;<a class="code" href="../../d6/dca/structbAnimContext.html#a5a52c7e6c531f78a79d7d8b92a887700">datatype</a>);
<a name="l00300"></a>00300     
<a name="l00301"></a>00301     <span class="comment">/* loop through each F-Curve, working on the keyframes until the first curve aborts */</span>
<a name="l00302"></a>00302     <span class="keywordflow">for</span> (ale= anim_data.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ale; ale= ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a5ccf2b36d14379524140d1c18942a2ef">next</a>) {
<a name="l00303"></a>00303         ret_code= <a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(ked, ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a>, key_ok, key_cb, fcu_cb);
<a name="l00304"></a>00304         
<a name="l00305"></a>00305         <span class="keywordflow">if</span> (ret_code)
<a name="l00306"></a>00306             <span class="keywordflow">break</span>;
<a name="l00307"></a>00307     }
<a name="l00308"></a>00308     
<a name="l00309"></a>00309     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;anim_data);
<a name="l00310"></a>00310     
<a name="l00311"></a>00311     <span class="keywordflow">return</span> ret_code;
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="comment">/* --- */</span>
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 <span class="comment">/* This function is used to apply operation to all keyframes, regardless of the type */</span>
<a name="l00317"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#adc285e8a7dc7dae690b7795a9aaeb3df">00317</a> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ac3c68ea095bf4e030872ea4a46ab99d9">ANIM_animchannel_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../df/de9/structbDopeSheet.html">bDopeSheet</a> *ads, <a class="code" href="../../d6/dfc/structbAnimListElem.html">bAnimListElem</a> *ale, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb)
<a name="l00318"></a>00318 {
<a name="l00319"></a>00319     <span class="comment">/* sanity checks */</span>
<a name="l00320"></a>00320     <span class="keywordflow">if</span> (ale == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00321"></a>00321         <span class="keywordflow">return</span> 0;
<a name="l00322"></a>00322     
<a name="l00323"></a>00323     <span class="comment">/* method to use depends on the type of keyframe data */</span>
<a name="l00324"></a>00324     <span class="keywordflow">switch</span> (ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#aec6f7b3ac92e3d6d50d03ecdc587dd7d">datatype</a>) {
<a name="l00325"></a>00325         <span class="comment">/* direct keyframe data (these loops are exposed) */</span>
<a name="l00326"></a>00326         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85a6072750eace5e2e8e8a0b0350df28b61">ALE_FCURVE</a>: <span class="comment">/* F-Curve */</span>
<a name="l00327"></a>00327             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(ked, ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a829149ba40390f68b20ac1d2649b0078">key_data</a>, key_ok, key_cb, fcu_cb);
<a name="l00328"></a>00328         
<a name="l00329"></a>00329         <span class="comment">/* indirect &#39;summaries&#39; (these are not exposed directly) </span>
<a name="l00330"></a>00330 <span class="comment">         * NOTE: must keep this code in sync with the drawing code and also the filtering code!</span>
<a name="l00331"></a>00331 <span class="comment">         */</span>
<a name="l00332"></a>00332         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85af04cee4c040a8676be97daed83bdb599">ALE_GROUP</a>: <span class="comment">/* action group */</span>
<a name="l00333"></a>00333             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#abead8a46857208fdbf265a267c323460">agrp_keyframes_loop</a>(ked, (<a class="code" href="../../d9/dcf/structbActionGroup.html">bActionGroup</a> *)ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a>, key_ok, key_cb, fcu_cb);
<a name="l00334"></a>00334         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85ac1aa151cfcc7fa642d7c4c2fca27855b">ALE_ACT</a>: <span class="comment">/* action */</span>
<a name="l00335"></a>00335             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ade9c9049139397a7aede48a0e3e493b8">act_keyframes_loop</a>(ked, (<a class="code" href="../../d1/d48/structbAction.html">bAction</a> *)ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a829149ba40390f68b20ac1d2649b0078">key_data</a>, key_ok, key_cb, fcu_cb);
<a name="l00336"></a>00336             
<a name="l00337"></a>00337         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85adfd4f425b01285d4b196357e67b805b0">ALE_OB</a>: <span class="comment">/* object */</span>
<a name="l00338"></a>00338             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ae1b5b2d957d77f0e9754ff1c51edf4c5">ob_keyframes_loop</a>(ked, ads, (<a class="code" href="../../de/de7/structObject.html">Object</a> *)ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a829149ba40390f68b20ac1d2649b0078">key_data</a>, key_ok, key_cb, fcu_cb);
<a name="l00339"></a>00339         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85a2e534455c996f92c6e4c07f747001038">ALE_SCE</a>: <span class="comment">/* scene */</span>
<a name="l00340"></a>00340             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a69cc66e0398a1d21370163c455238bb7">scene_keyframes_loop</a>(ked, ads, (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a>, key_ok, key_cb, fcu_cb);
<a name="l00341"></a>00341         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85aa2d55329bc607873bc513fca9cbdccd8">ALE_ALL</a>: <span class="comment">/* &#39;all&#39; (DopeSheet summary) */</span>
<a name="l00342"></a>00342             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a08302291884133336c95de36006960cd">summary_keyframes_loop</a>(ked, (<a class="code" href="../../d6/dca/structbAnimContext.html">bAnimContext</a> *)ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a954a70adedee38f0fe952eda8c704fff">data</a>, key_ok, key_cb, fcu_cb);
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344     
<a name="l00345"></a>00345     <span class="keywordflow">return</span> 0;
<a name="l00346"></a>00346 }
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 <span class="comment">/* This function is used to apply operation to all keyframes, regardless of the type without needed an AnimListElem wrapper */</span>
<a name="l00349"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#af32d26d8049900bdbe0e264394cd2f24">00349</a> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#abde7bdbcee8cc1f72c1cf797a755f698">ANIM_animchanneldata_keyframes_loop</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../df/de9/structbDopeSheet.html">bDopeSheet</a> *ads, <span class="keywordtype">void</span> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>, <span class="keywordtype">int</span> keytype, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_ok, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> key_cb, <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad0c04c78d0aef1491eadf74400b30240">FcuEditFunc</a> fcu_cb)
<a name="l00350"></a>00350 {
<a name="l00351"></a>00351     <span class="comment">/* sanity checks */</span>
<a name="l00352"></a>00352     <span class="keywordflow">if</span> (data == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00353"></a>00353         <span class="keywordflow">return</span> 0;
<a name="l00354"></a>00354     
<a name="l00355"></a>00355     <span class="comment">/* method to use depends on the type of keyframe data */</span>
<a name="l00356"></a>00356     <span class="keywordflow">switch</span> (keytype) {
<a name="l00357"></a>00357         <span class="comment">/* direct keyframe data (these loops are exposed) */</span>
<a name="l00358"></a>00358         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85a6072750eace5e2e8e8a0b0350df28b61">ALE_FCURVE</a>: <span class="comment">/* F-Curve */</span>
<a name="l00359"></a>00359             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#acc5f398b98ef3107626e8c507091d544">ANIM_fcurve_keyframes_loop</a>(ked, data, key_ok, key_cb, fcu_cb);
<a name="l00360"></a>00360         
<a name="l00361"></a>00361         <span class="comment">/* indirect &#39;summaries&#39; (these are not exposed directly) </span>
<a name="l00362"></a>00362 <span class="comment">         * NOTE: must keep this code in sync with the drawing code and also the filtering code!</span>
<a name="l00363"></a>00363 <span class="comment">         */</span>
<a name="l00364"></a>00364         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85af04cee4c040a8676be97daed83bdb599">ALE_GROUP</a>: <span class="comment">/* action group */</span>
<a name="l00365"></a>00365             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#abead8a46857208fdbf265a267c323460">agrp_keyframes_loop</a>(ked, (<a class="code" href="../../d9/dcf/structbActionGroup.html">bActionGroup</a> *)data, key_ok, key_cb, fcu_cb);
<a name="l00366"></a>00366         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85ac1aa151cfcc7fa642d7c4c2fca27855b">ALE_ACT</a>: <span class="comment">/* action */</span>
<a name="l00367"></a>00367             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ade9c9049139397a7aede48a0e3e493b8">act_keyframes_loop</a>(ked, (<a class="code" href="../../d1/d48/structbAction.html">bAction</a> *)data, key_ok, key_cb, fcu_cb);
<a name="l00368"></a>00368             
<a name="l00369"></a>00369         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85adfd4f425b01285d4b196357e67b805b0">ALE_OB</a>: <span class="comment">/* object */</span>
<a name="l00370"></a>00370             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ae1b5b2d957d77f0e9754ff1c51edf4c5">ob_keyframes_loop</a>(ked, ads, (<a class="code" href="../../de/de7/structObject.html">Object</a> *)data, key_ok, key_cb, fcu_cb);
<a name="l00371"></a>00371         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85a2e534455c996f92c6e4c07f747001038">ALE_SCE</a>: <span class="comment">/* scene */</span>
<a name="l00372"></a>00372             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a69cc66e0398a1d21370163c455238bb7">scene_keyframes_loop</a>(ked, ads, (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)data, key_ok, key_cb, fcu_cb);
<a name="l00373"></a>00373         <span class="keywordflow">case</span> <a class="code" href="../../df/d6f/ED__anim__api_8h.html#a697a9efd0371fe4203c3627cbcdbad85aa2d55329bc607873bc513fca9cbdccd8">ALE_ALL</a>: <span class="comment">/* &#39;all&#39; (DopeSheet summary) */</span>
<a name="l00374"></a>00374             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a08302291884133336c95de36006960cd">summary_keyframes_loop</a>(ked, (<a class="code" href="../../d6/dca/structbAnimContext.html">bAnimContext</a> *)data, key_ok, key_cb, fcu_cb);
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376     
<a name="l00377"></a>00377     <span class="keywordflow">return</span> 0;
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">/* ************************************************************************** */</span>
<a name="l00381"></a>00381 <span class="comment">/* Keyframe Integrity Tools */</span>
<a name="l00382"></a>00382 
<a name="l00383"></a>00383 <span class="comment">/* Rearrange keyframes if some are out of order */</span>
<a name="l00384"></a>00384 <span class="comment">// used to be recalc_*_ipos() where * was object or action</span>
<a name="l00385"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1e69d04550706ffb40cc69990b9ffef4">00385</a> <span class="keywordtype">void</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a3674716b592ffe7198ea9ee213e77d73">ANIM_editkeyframes_refresh</a>(<a class="code" href="../../d6/dca/structbAnimContext.html">bAnimContext</a> *ac)
<a name="l00386"></a>00386 {
<a name="l00387"></a>00387     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> anim_data = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l00388"></a>00388     <a class="code" href="../../d6/dfc/structbAnimListElem.html">bAnimListElem</a> *ale;
<a name="l00389"></a>00389     <span class="keywordtype">int</span> <a class="code" href="../../dc/d53/implicit_8c.html#a5085563b3b926cbcce0bef0946da311e">filter</a>;
<a name="l00390"></a>00390     <span class="comment">/* when not in graph view, don&#39;t use handles */</span>
<a name="l00391"></a>00391     <a class="code" href="../../d1/d53/structSpaceIpo.html">SpaceIpo</a> *sipo= (ac-&gt;<a class="code" href="../../d6/dca/structbAnimContext.html#a526ad3411cc520d80945ccd256711f40">spacetype</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca67184420c844bcef0dd50660142cede6">SPACE_IPO</a>) ? (<a class="code" href="../../d1/d53/structSpaceIpo.html">SpaceIpo</a> *)ac-&gt;<a class="code" href="../../d6/dca/structbAnimContext.html#ace702244f50216d9ca6d1112f6a45c77">sl</a> : <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00392"></a>00392     <span class="keyword">const</span> <span class="keywordtype">short</span> use_handle = sipo ? !(sipo-&gt;<a class="code" href="../../d1/d53/structSpaceIpo.html#afb3a36cb2d2bf16fbe5787baa810e4ea">flag</a> &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a1c8d4978dc9d97d9e9921d916b9af6dd">SIPO_NOHANDLES</a>) : <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00393"></a>00393     
<a name="l00394"></a>00394     <span class="comment">/* filter animation data */</span>
<a name="l00395"></a>00395     filter= <a class="code" href="../../df/d6f/ED__anim__api_8h.html#aeb469b1e009f7669ddacedd695291045a584f2145e984f8afb13e6cdeb4c0ac31">ANIMFILTER_DATA_VISIBLE</a>; 
<a name="l00396"></a>00396     <a class="code" href="../../dc/d01/anim__filter_8c.html#a13681020f63c886ca5bfc9a2ff39620b">ANIM_animdata_filter</a>(ac, &amp;anim_data, filter, ac-&gt;<a class="code" href="../../d6/dca/structbAnimContext.html#a6746afe77831350347f788f226a9320a">data</a>, ac-&gt;<a class="code" href="../../d6/dca/structbAnimContext.html#a5a52c7e6c531f78a79d7d8b92a887700">datatype</a>);
<a name="l00397"></a>00397     
<a name="l00398"></a>00398     <span class="comment">/* loop over F-Curves that are likely to have been edited, and check them */</span>
<a name="l00399"></a>00399     <span class="keywordflow">for</span> (ale= anim_data.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ale; ale= ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a5ccf2b36d14379524140d1c18942a2ef">next</a>) {
<a name="l00400"></a>00400         <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu= ale-&gt;<a class="code" href="../../d6/dfc/structbAnimListElem.html#a829149ba40390f68b20ac1d2649b0078">key_data</a>;
<a name="l00401"></a>00401         
<a name="l00402"></a>00402         <span class="comment">/* make sure keyframes in F-Curve are all in order, and handles are in valid positions */</span>
<a name="l00403"></a>00403         <a class="code" href="../../da/dba/BKE__fcurve_8h.html#ab62b2de349c531a4c12bc371ba85344c">sort_time_fcurve</a>(fcu);
<a name="l00404"></a>00404         <a class="code" href="../../da/dba/BKE__fcurve_8h.html#abad77ca653f43c257d897dd681f7ec33">testhandles_fcurve</a>(fcu, use_handle);
<a name="l00405"></a>00405     }
<a name="l00406"></a>00406     
<a name="l00407"></a>00407     <span class="comment">/* free temp data */</span>
<a name="l00408"></a>00408     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;anim_data);
<a name="l00409"></a>00409 }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="comment">/* ************************************************************************** */</span>
<a name="l00412"></a>00412 <span class="comment">/* BezTriple Validation Callbacks */</span>
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="comment">/* ------------------------ */</span>
<a name="l00415"></a>00415 <span class="comment">/* Some macros to make this easier... */</span>
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="comment">/* run the given check on the 3 handles </span>
<a name="l00418"></a>00418 <span class="comment"> *  - check should be a macro, which takes the handle index as its single arg, which it substitutes later</span>
<a name="l00419"></a>00419 <span class="comment"> *  - requires that a var, of type short, is named &#39;ok&#39;, and has been initialized to 0</span>
<a name="l00420"></a>00420 <span class="comment"> */</span>
<a name="l00421"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a64bbd0ba2a414584e6c9b75d824587ec">00421</a> <span class="preprocessor">#define KEYFRAME_OK_CHECKS(check) \</span>
<a name="l00422"></a>00422 <span class="preprocessor">    { \</span>
<a name="l00423"></a>00423 <span class="preprocessor">        if (check(1)) \</span>
<a name="l00424"></a>00424 <span class="preprocessor">            ok |= KEYFRAME_OK_KEY; \</span>
<a name="l00425"></a>00425 <span class="preprocessor">         \</span>
<a name="l00426"></a>00426 <span class="preprocessor">        if (ked &amp;&amp; (ked-&gt;iterflags &amp; KEYFRAME_ITER_INCL_HANDLES)) { \</span>
<a name="l00427"></a>00427 <span class="preprocessor">            if (check(0)) \</span>
<a name="l00428"></a>00428 <span class="preprocessor">                ok |= KEYFRAME_OK_H1; \</span>
<a name="l00429"></a>00429 <span class="preprocessor">            if (check(2)) \</span>
<a name="l00430"></a>00430 <span class="preprocessor">                ok |= KEYFRAME_OK_H2; \</span>
<a name="l00431"></a>00431 <span class="preprocessor">        } \</span>
<a name="l00432"></a>00432 <span class="preprocessor">    }   </span>
<a name="l00433"></a>00433 <span class="preprocessor"></span> 
<a name="l00434"></a>00434 <span class="comment">/* ------------------------ */</span>
<a name="l00435"></a>00435  
<a name="l00436"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#aa4b7e92a2b649a01c3ad8d3bc9d1ada0">00436</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aa4b7e92a2b649a01c3ad8d3bc9d1ada0">ok_bezier_frame</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438     <span class="keywordtype">short</span> ok = 0;
<a name="l00439"></a>00439     
<a name="l00440"></a>00440     <span class="comment">/* frame is stored in f1 property (this float accuracy check may need to be dropped?) */</span>
<a name="l00441"></a>00441 <span class="preprocessor">    #define KEY_CHECK_OK(_index) IS_EQF(bezt-&gt;vec[_index][0], ked-&gt;f1)</span>
<a name="l00442"></a>00442 <span class="preprocessor"></span>        <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64bbd0ba2a414584e6c9b75d824587ec">KEYFRAME_OK_CHECKS</a>(<a class="code" href="../../db/d71/keyframes__edit_8c.html#a26c0ee5810ea1b4fb55f0814296d64a2">KEY_CHECK_OK</a>);
<a name="l00443"></a>00443 <span class="preprocessor">    #undef KEY_CHECK_OK</span>
<a name="l00444"></a>00444 <span class="preprocessor"></span>    
<a name="l00445"></a>00445     <span class="comment">/* return ok flags */</span>
<a name="l00446"></a>00446     <span class="keywordflow">return</span> ok;
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00449"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a14ad87d74af266d4163d6383c5efc806">00449</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a14ad87d74af266d4163d6383c5efc806">ok_bezier_framerange</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00450"></a>00450 {
<a name="l00451"></a>00451     <span class="keywordtype">short</span> ok = 0;
<a name="l00452"></a>00452     
<a name="l00453"></a>00453     <span class="comment">/* frame range is stored in float properties */</span>
<a name="l00454"></a>00454 <span class="preprocessor">    #define KEY_CHECK_OK(_index) ((bezt-&gt;vec[_index][0] &gt; ked-&gt;f1) &amp;&amp; (bezt-&gt;vec[_index][0] &lt; ked-&gt;f2))</span>
<a name="l00455"></a>00455 <span class="preprocessor"></span>        <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64bbd0ba2a414584e6c9b75d824587ec">KEYFRAME_OK_CHECKS</a>(<a class="code" href="../../db/d71/keyframes__edit_8c.html#a26c0ee5810ea1b4fb55f0814296d64a2">KEY_CHECK_OK</a>);
<a name="l00456"></a>00456 <span class="preprocessor">    #undef KEY_CHECK_OK</span>
<a name="l00457"></a>00457 <span class="preprocessor"></span>    
<a name="l00458"></a>00458     <span class="comment">/* return ok flags */</span>
<a name="l00459"></a>00459     <span class="keywordflow">return</span> ok;
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00462"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#af4575faf66082e8732c895acdfc9d2cc">00462</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#af4575faf66082e8732c895acdfc9d2cc">ok_bezier_selected</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00463"></a>00463 {
<a name="l00464"></a>00464     <span class="comment">/* this macro checks all beztriple handles for selection... </span>
<a name="l00465"></a>00465 <span class="comment">     *  only one of the verts has to be selected for this to be ok...</span>
<a name="l00466"></a>00466 <span class="comment">     */</span>
<a name="l00467"></a>00467     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#a30e90c4df6243a5254d5a1b61c5c8a9c">BEZSELECTED</a>(bezt))
<a name="l00468"></a>00468         <span class="keywordflow">return</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a686d7d446ff46366a35157350d717b9fafa99e7eed056ab106856574f38736ea9">KEYFRAME_OK_ALL</a>;
<a name="l00469"></a>00469     <span class="keywordflow">else</span>
<a name="l00470"></a>00470         <span class="keywordflow">return</span> 0;
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#afe244b54b88c3239288500ebee195d40">00473</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#afe244b54b88c3239288500ebee195d40">ok_bezier_value</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00474"></a>00474 {   
<a name="l00475"></a>00475     <span class="keywordtype">short</span> ok = 0;
<a name="l00476"></a>00476     
<a name="l00477"></a>00477     <span class="comment">/* value is stored in f1 property </span>
<a name="l00478"></a>00478 <span class="comment">     *  - this float accuracy check may need to be dropped?</span>
<a name="l00479"></a>00479 <span class="comment">     *  - should value be stored in f2 instead so that we won&#39;t have conflicts when using f1 for frames too?</span>
<a name="l00480"></a>00480 <span class="comment">     */</span>
<a name="l00481"></a>00481 <span class="preprocessor">    #define KEY_CHECK_OK(_index) IS_EQF(bezt-&gt;vec[_index][1], ked-&gt;f1)</span>
<a name="l00482"></a>00482 <span class="preprocessor"></span>        <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64bbd0ba2a414584e6c9b75d824587ec">KEYFRAME_OK_CHECKS</a>(<a class="code" href="../../db/d71/keyframes__edit_8c.html#a26c0ee5810ea1b4fb55f0814296d64a2">KEY_CHECK_OK</a>);
<a name="l00483"></a>00483 <span class="preprocessor">    #undef KEY_CHECK_OK</span>
<a name="l00484"></a>00484 <span class="preprocessor"></span>    
<a name="l00485"></a>00485     <span class="comment">/* return ok flags */</span>
<a name="l00486"></a>00486     <span class="keywordflow">return</span> ok;
<a name="l00487"></a>00487 }
<a name="l00488"></a>00488 
<a name="l00489"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#af5ade64c333a076c3ffcd28237716c64">00489</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#af5ade64c333a076c3ffcd28237716c64">ok_bezier_valuerange</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00490"></a>00490 {
<a name="l00491"></a>00491     <span class="keywordtype">short</span> ok = 0;
<a name="l00492"></a>00492     
<a name="l00493"></a>00493     <span class="comment">/* value range is stored in float properties */</span>
<a name="l00494"></a>00494 <span class="preprocessor">    #define KEY_CHECK_OK(_index) ((bezt-&gt;vec[_index][1] &gt; ked-&gt;f1) &amp;&amp; (bezt-&gt;vec[_index][1] &lt; ked-&gt;f2))</span>
<a name="l00495"></a>00495 <span class="preprocessor"></span>        <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64bbd0ba2a414584e6c9b75d824587ec">KEYFRAME_OK_CHECKS</a>(<a class="code" href="../../db/d71/keyframes__edit_8c.html#a26c0ee5810ea1b4fb55f0814296d64a2">KEY_CHECK_OK</a>);
<a name="l00496"></a>00496 <span class="preprocessor">    #undef KEY_CHECK_OK</span>
<a name="l00497"></a>00497 <span class="preprocessor"></span>    
<a name="l00498"></a>00498     <span class="comment">/* return ok flags */</span>
<a name="l00499"></a>00499     <span class="keywordflow">return</span> ok;
<a name="l00500"></a>00500 }
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#aebbc37864ed4d2cdcccde5cc5f72a42c">00502</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aebbc37864ed4d2cdcccde5cc5f72a42c">ok_bezier_region</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00503"></a>00503 {
<a name="l00504"></a>00504     <span class="comment">/* rect is stored in data property (it&#39;s of type rectf, but may not be set) */</span>
<a name="l00505"></a>00505     <span class="keywordflow">if</span> (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a501b1376c86503e0138fcd41e59df925">data</a>) {
<a name="l00506"></a>00506         <span class="keywordtype">short</span> ok = 0;
<a name="l00507"></a>00507         
<a name="l00508"></a>00508 <span class="preprocessor">        #define KEY_CHECK_OK(_index) BLI_in_rctf(ked-&gt;data, bezt-&gt;vec[_index][0], bezt-&gt;vec[_index][1])</span>
<a name="l00509"></a>00509 <span class="preprocessor"></span>            <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64bbd0ba2a414584e6c9b75d824587ec">KEYFRAME_OK_CHECKS</a>(<a class="code" href="../../db/d71/keyframes__edit_8c.html#a26c0ee5810ea1b4fb55f0814296d64a2">KEY_CHECK_OK</a>);
<a name="l00510"></a>00510 <span class="preprocessor">        #undef KEY_CHECK_OK</span>
<a name="l00511"></a>00511 <span class="preprocessor"></span>        
<a name="l00512"></a>00512         <span class="comment">/* return ok flags */</span>
<a name="l00513"></a>00513         <span class="keywordflow">return</span> ok;
<a name="l00514"></a>00514     }
<a name="l00515"></a>00515     <span class="keywordflow">else</span> 
<a name="l00516"></a>00516         <span class="keywordflow">return</span> 0;
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 
<a name="l00520"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad8d50a9387bd9e246565328e381e1026">00520</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ad8d50a9387bd9e246565328e381e1026">ANIM_editkeyframes_ok</a>(<span class="keywordtype">short</span> mode)
<a name="l00521"></a>00521 {
<a name="l00522"></a>00522     <span class="comment">/* eEditKeyframes_Validate */</span>
<a name="l00523"></a>00523     <span class="keywordflow">switch</span> (mode) {
<a name="l00524"></a>00524         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a8e98b37d6c08d1ff6782cda85ede7f39a4a09064815ad73e482e1293530e146cd">BEZT_OK_FRAME</a>: <span class="comment">/* only if bezt falls on the right frame (float) */</span>
<a name="l00525"></a>00525             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aa4b7e92a2b649a01c3ad8d3bc9d1ada0">ok_bezier_frame</a>;
<a name="l00526"></a>00526         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a8e98b37d6c08d1ff6782cda85ede7f39a2cb87e66a2560d4e0d141bbb4dddd837">BEZT_OK_FRAMERANGE</a>: <span class="comment">/* only if bezt falls within the specified frame range (floats) */</span>
<a name="l00527"></a>00527             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a14ad87d74af266d4163d6383c5efc806">ok_bezier_framerange</a>;
<a name="l00528"></a>00528         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a8e98b37d6c08d1ff6782cda85ede7f39aa3a47676c0cdcc866536e24fe737afdb">BEZT_OK_SELECTED</a>:  <span class="comment">/* only if bezt is selected (self) */</span>
<a name="l00529"></a>00529             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#af4575faf66082e8732c895acdfc9d2cc">ok_bezier_selected</a>;
<a name="l00530"></a>00530         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a8e98b37d6c08d1ff6782cda85ede7f39ab1dd27899af4466785d1e99c9d72576b">BEZT_OK_VALUE</a>: <span class="comment">/* only if bezt value matches (float) */</span>
<a name="l00531"></a>00531             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#afe244b54b88c3239288500ebee195d40">ok_bezier_value</a>;
<a name="l00532"></a>00532         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a8e98b37d6c08d1ff6782cda85ede7f39a9d5dccb95515d359d186bf514938cf14">BEZT_OK_VALUERANGE</a>: <span class="comment">/* only if bezier falls within the specified value range (floats) */</span>
<a name="l00533"></a>00533             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#af5ade64c333a076c3ffcd28237716c64">ok_bezier_valuerange</a>;
<a name="l00534"></a>00534         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a8e98b37d6c08d1ff6782cda85ede7f39ae409d5673da844a7819ae2fb741b2114">BEZT_OK_REGION</a>: <span class="comment">/* only if bezier falls within the specified rect (data -&gt; rectf) */</span>
<a name="l00535"></a>00535             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aebbc37864ed4d2cdcccde5cc5f72a42c">ok_bezier_region</a>;
<a name="l00536"></a>00536         <span class="keywordflow">default</span>: <span class="comment">/* nothing was ok */</span>
<a name="l00537"></a>00537             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00538"></a>00538     }
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="comment">/* ******************************************* */</span>
<a name="l00542"></a>00542 <span class="comment">/* Assorted Utility Functions */</span>
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="comment">/* helper callback for &lt;animeditor&gt;_cfrasnap_exec() -&gt; used to help get the average time of all selected beztriples */</span>
<a name="l00545"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a99095c3b778c62835a57f409e58d3efe">00545</a> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aefa62c7dca2d9fdf8642ecaed0b61249">bezt_calc_average</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00546"></a>00546 {
<a name="l00547"></a>00547     <span class="comment">/* only if selected */</span>
<a name="l00548"></a>00548     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00549"></a>00549         <span class="comment">/* store average time in float 1 (only do rounding at last step) */</span>
<a name="l00550"></a>00550         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1444ccfbecc1ce0317e003838ccc261d">f1</a> += bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0];
<a name="l00551"></a>00551         
<a name="l00552"></a>00552         <span class="comment">/* store average value in float 2 (only do rounding at last step) </span>
<a name="l00553"></a>00553 <span class="comment">         *  - this isn&#39;t always needed, but some operators may also require this</span>
<a name="l00554"></a>00554 <span class="comment">         */</span>
<a name="l00555"></a>00555         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1bb18ae755c595cc9b7d45e49fd6666a">f2</a> += bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1];
<a name="l00556"></a>00556         
<a name="l00557"></a>00557         <span class="comment">/* increment number of items */</span>
<a name="l00558"></a>00558         ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ae7333f659ba9d2b9924524225d64a27a">i1</a>++;
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560     
<a name="l00561"></a>00561     <span class="keywordflow">return</span> 0;
<a name="l00562"></a>00562 }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 <span class="comment">/* helper callback for columnselect_&lt;animeditor&gt;_keys() -&gt; populate list CfraElems with frame numbers from selected beztriples */</span>
<a name="l00565"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a398f509fe6bf9ed400ae0c34375a2a22">00565</a> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ab01a4640feb02d522fa94fe1b06328cb">bezt_to_cfraelem</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00566"></a>00566 {
<a name="l00567"></a>00567     <span class="comment">/* only if selected */</span>
<a name="l00568"></a>00568     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00569"></a>00569         <a class="code" href="../../db/d00/structCfraElem.html">CfraElem</a> *ce= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../db/d00/structCfraElem.html">CfraElem</a>), <span class="stringliteral">&quot;cfraElem&quot;</span>);
<a name="l00570"></a>00570         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a2348e0effff022a6ba66371076556163">list</a>, ce);
<a name="l00571"></a>00571         
<a name="l00572"></a>00572         ce-&gt;<a class="code" href="../../db/d00/structCfraElem.html#a021a2c83db7f2b1bfc3b9d425e646522">cfra</a>= bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0];
<a name="l00573"></a>00573     }
<a name="l00574"></a>00574     
<a name="l00575"></a>00575     <span class="keywordflow">return</span> 0;
<a name="l00576"></a>00576 }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578 <span class="comment">/* used to remap times from one range to another</span>
<a name="l00579"></a>00579 <span class="comment"> * requires:  ked-&gt;data = KeyframeEditCD_Remap  </span>
<a name="l00580"></a>00580 <span class="comment"> */</span>
<a name="l00581"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a0dbcf65c1a414c9c5916b706e3609879">00581</a> <span class="keywordtype">void</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ac9ff517bd9e384e6c5e01181c1b0bb91">bezt_remap_times</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00582"></a>00582 {
<a name="l00583"></a>00583     <a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html">KeyframeEditCD_Remap</a> *rmap= (<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html">KeyframeEditCD_Remap</a>*)ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a501b1376c86503e0138fcd41e59df925">data</a>;
<a name="l00584"></a>00584     <span class="keyword">const</span> <span class="keywordtype">float</span> scale = (rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#a5818fb93f44e0cc3209a3305addfc52c">newMax</a> - rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#ab70c8b7ae5d3fba7228decf4a530f7e2">newMin</a>) / (rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#aace95e233938859fca5c8ac5b13669e3">oldMax</a> - rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#abe1b6231c9a38e29c3203369b2ac5b80">oldMin</a>);
<a name="l00585"></a>00585     
<a name="l00586"></a>00586     <span class="comment">/* perform transform on all three handles unless indicated otherwise */</span>
<a name="l00587"></a>00587     <span class="comment">// TODO: need to include some checks for that</span>
<a name="l00588"></a>00588     
<a name="l00589"></a>00589     bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][0]= scale*(bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][0] - rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#abe1b6231c9a38e29c3203369b2ac5b80">oldMin</a>) + rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#ab70c8b7ae5d3fba7228decf4a530f7e2">newMin</a>;
<a name="l00590"></a>00590     bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= scale*(bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0] - rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#abe1b6231c9a38e29c3203369b2ac5b80">oldMin</a>) + rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#ab70c8b7ae5d3fba7228decf4a530f7e2">newMin</a>;
<a name="l00591"></a>00591     bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][0]= scale*(bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][0] - rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#abe1b6231c9a38e29c3203369b2ac5b80">oldMin</a>) + rmap-&gt;<a class="code" href="../../df/d12/structKeyframeEditCD__Remap.html#ab70c8b7ae5d3fba7228decf4a530f7e2">newMin</a>;
<a name="l00592"></a>00592 }
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 <span class="comment">/* ******************************************* */</span>
<a name="l00595"></a>00595 <span class="comment">/* Transform */</span>
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 <span class="comment">/* snaps the keyframe to the nearest frame */</span>
<a name="l00598"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#af9c52f099111d5f4ff81abe43a1d0a9c">00598</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#af9c52f099111d5f4ff81abe43a1d0a9c">snap_bezier_nearest</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00599"></a>00599 {
<a name="l00600"></a>00600     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l00601"></a>00601         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= (float)(<a class="code" href="../../dd/d06/BLI__math__base_8h.html#addfa7d645df6e3c96924f253d8fb9b48">floorf</a>(bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]+0.5f));
<a name="l00602"></a>00602     <span class="keywordflow">return</span> 0;
<a name="l00603"></a>00603 }
<a name="l00604"></a>00604 
<a name="l00605"></a>00605 <span class="comment">/* snaps the keyframe to the neares second */</span>
<a name="l00606"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#ae1bb67475deb430f7693e1368f4dfd04">00606</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ae1bb67475deb430f7693e1368f4dfd04">snap_bezier_nearestsec</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00607"></a>00607 {
<a name="l00608"></a>00608     <span class="keyword">const</span> <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ae92b25f59272e31e000b38273ef9d30b">scene</a>;
<a name="l00609"></a>00609     <span class="keyword">const</span> <span class="keywordtype">float</span> secf = (float)<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac92ca5ab87034a348decad7ee8d4bd1b">FPS</a>;
<a name="l00610"></a>00610     
<a name="l00611"></a>00611     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l00612"></a>00612         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= ((float)floor(bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]/secf + 0.5f) * secf);
<a name="l00613"></a>00613     <span class="keywordflow">return</span> 0;
<a name="l00614"></a>00614 }
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 <span class="comment">/* snaps the keyframe to the current frame */</span>
<a name="l00617"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#ab39fb8ef6ce92dd699f7db2861141f64">00617</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ab39fb8ef6ce92dd699f7db2861141f64">snap_bezier_cframe</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00618"></a>00618 {
<a name="l00619"></a>00619     <span class="keyword">const</span> <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ae92b25f59272e31e000b38273ef9d30b">scene</a>;
<a name="l00620"></a>00620     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l00621"></a>00621         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= (float)<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>;
<a name="l00622"></a>00622     <span class="keywordflow">return</span> 0;
<a name="l00623"></a>00623 }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 <span class="comment">/* snaps the keyframe time to the nearest marker&#39;s frame */</span>
<a name="l00626"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a68c4fffaea7c4928a54f6ac7f530845e">00626</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a68c4fffaea7c4928a54f6ac7f530845e">snap_bezier_nearmarker</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00627"></a>00627 {
<a name="l00628"></a>00628     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l00629"></a>00629         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= (float)<a class="code" href="../../df/d12/anim__markers_8c.html#a7797c7d360bcb81e2d2c66f49fe6ac8a">ED_markers_find_nearest_marker_time</a>(&amp;ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a2348e0effff022a6ba66371076556163">list</a>, bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]);
<a name="l00630"></a>00630     <span class="keywordflow">return</span> 0;
<a name="l00631"></a>00631 }
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 <span class="comment">/* make the handles have the same value as the key */</span>
<a name="l00634"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a4bbd5b57a7a3530db44839e0f4425b60">00634</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a4bbd5b57a7a3530db44839e0f4425b60">snap_bezier_horizontal</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00635"></a>00635 {
<a name="l00636"></a>00636     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00637"></a>00637         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][1]= bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][1]= bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1];
<a name="l00638"></a>00638         
<a name="l00639"></a>00639         <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>, <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>, <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>, <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca1e9cb5ecc39a3c74be445d1c4d151d04">HD_VECT</a>)) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45ecacf967643ac26269318a51fe281992051">HD_ALIGN</a>;
<a name="l00640"></a>00640         <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>, <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>, <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>, <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca1e9cb5ecc39a3c74be445d1c4d151d04">HD_VECT</a>)) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45ecacf967643ac26269318a51fe281992051">HD_ALIGN</a>;
<a name="l00641"></a>00641     }
<a name="l00642"></a>00642     <span class="keywordflow">return</span> 0;   
<a name="l00643"></a>00643 }
<a name="l00644"></a>00644 
<a name="l00645"></a>00645 <span class="comment">/* value to snap to is stored in the custom data -&gt; first float value slot */</span>
<a name="l00646"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a51a92c34eb6935db5c63f0e511fd2fa4">00646</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a51a92c34eb6935db5c63f0e511fd2fa4">snap_bezier_value</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00647"></a>00647 {
<a name="l00648"></a>00648     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l00649"></a>00649         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1]= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1444ccfbecc1ce0317e003838ccc261d">f1</a>;
<a name="l00650"></a>00650     <span class="keywordflow">return</span> 0;
<a name="l00651"></a>00651 }
<a name="l00652"></a>00652 
<a name="l00653"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ade1eb0910a7670bc6f751ce84763f19f">00653</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ada6692e8aa0dc0363b9d7ec88638bbf1">ANIM_editkeyframes_snap</a>(<span class="keywordtype">short</span> type)
<a name="l00654"></a>00654 {
<a name="l00655"></a>00655     <span class="comment">/* eEditKeyframes_Snap */</span>
<a name="l00656"></a>00656     <span class="keywordflow">switch</span> (type) {
<a name="l00657"></a>00657         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#abad77a39e02b4fc977eeab12ddb48cdea24757cb849e0776b49160fabb997f6f9">SNAP_KEYS_NEARFRAME</a>: <span class="comment">/* snap to nearest frame */</span>
<a name="l00658"></a>00658             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#af9c52f099111d5f4ff81abe43a1d0a9c">snap_bezier_nearest</a>;
<a name="l00659"></a>00659         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#abad77a39e02b4fc977eeab12ddb48cdea09b1cb3ec77388ac7be2990cf2812a68">SNAP_KEYS_CURFRAME</a>: <span class="comment">/* snap to current frame */</span>
<a name="l00660"></a>00660             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ab39fb8ef6ce92dd699f7db2861141f64">snap_bezier_cframe</a>;
<a name="l00661"></a>00661         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#abad77a39e02b4fc977eeab12ddb48cdea63399a2804a1a9d4f2bf286d107ad755">SNAP_KEYS_NEARMARKER</a>: <span class="comment">/* snap to nearest marker */</span>
<a name="l00662"></a>00662             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a68c4fffaea7c4928a54f6ac7f530845e">snap_bezier_nearmarker</a>;
<a name="l00663"></a>00663         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#abad77a39e02b4fc977eeab12ddb48cdea91e489885cfab8c1c5b5b45dc8f52b4f">SNAP_KEYS_NEARSEC</a>: <span class="comment">/* snap to nearest second */</span>
<a name="l00664"></a>00664             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ae1bb67475deb430f7693e1368f4dfd04">snap_bezier_nearestsec</a>;
<a name="l00665"></a>00665         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#abad77a39e02b4fc977eeab12ddb48cdea9242dd16603a9e5da9f9baba8cd4a599">SNAP_KEYS_HORIZONTAL</a>: <span class="comment">/* snap handles to same value */</span>
<a name="l00666"></a>00666             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a4bbd5b57a7a3530db44839e0f4425b60">snap_bezier_horizontal</a>;
<a name="l00667"></a>00667         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#abad77a39e02b4fc977eeab12ddb48cdeabb112aad8fcae21f5532cbfd16b44960">SNAP_KEYS_VALUE</a>: <span class="comment">/* snap to given value */</span>
<a name="l00668"></a>00668             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a51a92c34eb6935db5c63f0e511fd2fa4">snap_bezier_value</a>;
<a name="l00669"></a>00669         <span class="keywordflow">default</span>: <span class="comment">/* just in case */</span>
<a name="l00670"></a>00670             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#af9c52f099111d5f4ff81abe43a1d0a9c">snap_bezier_nearest</a>;
<a name="l00671"></a>00671     }
<a name="l00672"></a>00672 }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674 <span class="comment">/* --------- */</span>
<a name="l00675"></a>00675 
<a name="l00676"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#ac0f23e9ab149029f690e5a4365c7c240">00676</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ac0f23e9ab149029f690e5a4365c7c240">mirror_bezier_cframe</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00677"></a>00677 {
<a name="l00678"></a>00678     <span class="keyword">const</span> <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ae92b25f59272e31e000b38273ef9d30b">scene</a>;
<a name="l00679"></a>00679     <span class="keywordtype">float</span> <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>;
<a name="l00680"></a>00680     
<a name="l00681"></a>00681     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00682"></a>00682         diff= ((float)<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a> - bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]);
<a name="l00683"></a>00683         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= ((float)<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a> + diff);
<a name="l00684"></a>00684     }
<a name="l00685"></a>00685     
<a name="l00686"></a>00686     <span class="keywordflow">return</span> 0;
<a name="l00687"></a>00687 }
<a name="l00688"></a>00688 
<a name="l00689"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#abfc7757e19552208f17c87bd145606de">00689</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#abfc7757e19552208f17c87bd145606de">mirror_bezier_yaxis</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00690"></a>00690 {
<a name="l00691"></a>00691     <span class="keywordtype">float</span> <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>;
<a name="l00692"></a>00692     
<a name="l00693"></a>00693     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00694"></a>00694         diff= (0.0f - bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]);
<a name="l00695"></a>00695         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= (0.0f + <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>);
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697     
<a name="l00698"></a>00698     <span class="keywordflow">return</span> 0;
<a name="l00699"></a>00699 }
<a name="l00700"></a>00700 
<a name="l00701"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a0c5e2118666b3c5d8dbe8cca53c543c2">00701</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a0c5e2118666b3c5d8dbe8cca53c543c2">mirror_bezier_xaxis</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00702"></a>00702 {
<a name="l00703"></a>00703     <span class="keywordtype">float</span> <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>;
<a name="l00704"></a>00704     
<a name="l00705"></a>00705     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00706"></a>00706         diff= (0.0f - bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1]);
<a name="l00707"></a>00707         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1]= (0.0f + <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>);
<a name="l00708"></a>00708     }
<a name="l00709"></a>00709     
<a name="l00710"></a>00710     <span class="keywordflow">return</span> 0;
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#ae98076443b3157f763f8985c503a7344">00713</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ae98076443b3157f763f8985c503a7344">mirror_bezier_marker</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00714"></a>00714 {
<a name="l00715"></a>00715     <span class="comment">/* mirroring time stored in f1 */</span>
<a name="l00716"></a>00716     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00717"></a>00717         <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>= (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1444ccfbecc1ce0317e003838ccc261d">f1</a> - bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]);
<a name="l00718"></a>00718         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0]= (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1444ccfbecc1ce0317e003838ccc261d">f1</a> + <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>);
<a name="l00719"></a>00719     }
<a name="l00720"></a>00720     
<a name="l00721"></a>00721     <span class="keywordflow">return</span> 0;
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00724"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a56c50781003ff56a09b5a9a88c90d097">00724</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a56c50781003ff56a09b5a9a88c90d097">mirror_bezier_value</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l00725"></a>00725 {
<a name="l00726"></a>00726     <span class="keywordtype">float</span> <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>;
<a name="l00727"></a>00727     
<a name="l00728"></a>00728     <span class="comment">/* value to mirror over is stored in the custom data -&gt; first float value slot */</span>
<a name="l00729"></a>00729     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00730"></a>00730         diff= (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1444ccfbecc1ce0317e003838ccc261d">f1</a> - bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1]);
<a name="l00731"></a>00731         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1]= (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1444ccfbecc1ce0317e003838ccc261d">f1</a> + <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>);
<a name="l00732"></a>00732     }
<a name="l00733"></a>00733     
<a name="l00734"></a>00734     <span class="keywordflow">return</span> 0;
<a name="l00735"></a>00735 }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 <span class="comment">/* Note: for markers and &#39;value&#39;, the values to use must be supplied as the first float value */</span>
<a name="l00738"></a>00738 <span class="comment">// calchandles_fcurve</span>
<a name="l00739"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a195b0a650d6f087b6daf604e5c549966">00739</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a4ba8a011811cb5c89c6ce928c7e43181">ANIM_editkeyframes_mirror</a>(<span class="keywordtype">short</span> type)
<a name="l00740"></a>00740 {
<a name="l00741"></a>00741     <span class="keywordflow">switch</span> (type) {
<a name="l00742"></a>00742         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a04a71be2bd0ad79a09967e0954281cc8a88b2cbe6d09ab7a6c31848d9905d6e90">MIRROR_KEYS_CURFRAME</a>: <span class="comment">/* mirror over current frame */</span>
<a name="l00743"></a>00743             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ac0f23e9ab149029f690e5a4365c7c240">mirror_bezier_cframe</a>;
<a name="l00744"></a>00744         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a04a71be2bd0ad79a09967e0954281cc8a813201598b4f99dd36eaa01973a8ec86">MIRROR_KEYS_YAXIS</a>: <span class="comment">/* mirror over frame 0 */</span>
<a name="l00745"></a>00745             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#abfc7757e19552208f17c87bd145606de">mirror_bezier_yaxis</a>;
<a name="l00746"></a>00746         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a04a71be2bd0ad79a09967e0954281cc8abad1283f5ab6757700e379047c9a760d">MIRROR_KEYS_XAXIS</a>: <span class="comment">/* mirror over value 0 */</span>
<a name="l00747"></a>00747             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a0c5e2118666b3c5d8dbe8cca53c543c2">mirror_bezier_xaxis</a>;
<a name="l00748"></a>00748         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a04a71be2bd0ad79a09967e0954281cc8a81f940b830e312a2a03127ca2f76d421">MIRROR_KEYS_MARKER</a>: <span class="comment">/* mirror over marker */</span>
<a name="l00749"></a>00749             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ae98076443b3157f763f8985c503a7344">mirror_bezier_marker</a>; 
<a name="l00750"></a>00750         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a04a71be2bd0ad79a09967e0954281cc8a784cff9bd48e68576e6dbff082207f41">MIRROR_KEYS_VALUE</a>: <span class="comment">/* mirror over given value */</span>
<a name="l00751"></a>00751             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a56c50781003ff56a09b5a9a88c90d097">mirror_bezier_value</a>;
<a name="l00752"></a>00752         <span class="keywordflow">default</span>: <span class="comment">/* just in case */</span>
<a name="l00753"></a>00753             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#abfc7757e19552208f17c87bd145606de">mirror_bezier_yaxis</a>;
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755 }
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 <span class="comment">/* ******************************************* */</span>
<a name="l00758"></a>00758 <span class="comment">/* Settings */</span>
<a name="l00759"></a>00759 
<a name="l00760"></a>00760 <span class="comment">/* standard validation step for a few of these (implemented as macro for inlining without fn-call overhead):</span>
<a name="l00761"></a>00761 <span class="comment"> *  &quot;if the handles are not of the same type, set them to type free&quot;</span>
<a name="l00762"></a>00762 <span class="comment"> */</span>
<a name="l00763"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a32b68e61d998e0bc4e2191ab4826d3fe">00763</a> <span class="preprocessor">#define ENSURE_HANDLES_MATCH(bezt)                                            \</span>
<a name="l00764"></a>00764 <span class="preprocessor">    if (bezt-&gt;h1 != bezt-&gt;h2) {                                               \</span>
<a name="l00765"></a>00765 <span class="preprocessor">        if (ELEM3(bezt-&gt;h1, HD_ALIGN, HD_AUTO, HD_AUTO_ANIM))                 \</span>
<a name="l00766"></a>00766 <span class="preprocessor">            bezt-&gt;h1= HD_FREE;                                                \</span>
<a name="l00767"></a>00767 <span class="preprocessor">        if (ELEM3(bezt-&gt;h2, HD_ALIGN, HD_AUTO, HD_AUTO_ANIM))                 \</span>
<a name="l00768"></a>00768 <span class="preprocessor">        bezt-&gt;h2= HD_FREE;                                                    \</span>
<a name="l00769"></a>00769 <span class="preprocessor">    }</span>
<a name="l00770"></a>00770 <span class="preprocessor"></span>
<a name="l00771"></a>00771 <span class="comment">/* Sets the selected bezier handles to type &#39;auto&#39; */</span>
<a name="l00772"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#ac16b884bfcf5b089004724baf49792c4">00772</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ac16b884bfcf5b089004724baf49792c4">set_bezier_auto</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00773"></a>00773 {
<a name="l00774"></a>00774     <span class="keywordflow">if</span> ((bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) || (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) {
<a name="l00775"></a>00775         <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>;
<a name="l00776"></a>00776         <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>;
<a name="l00777"></a>00777         
<a name="l00778"></a>00778         <a class="code" href="../../db/d71/keyframes__edit_8c.html#a32b68e61d998e0bc4e2191ab4826d3fe">ENSURE_HANDLES_MATCH</a>(bezt);
<a name="l00779"></a>00779     }
<a name="l00780"></a>00780     <span class="keywordflow">return</span> 0;
<a name="l00781"></a>00781 }
<a name="l00782"></a>00782 
<a name="l00783"></a>00783 <span class="comment">/* Sets the selected bezier handles to type &#39;auto-clamped&#39;</span>
<a name="l00784"></a>00784 <span class="comment"> * NOTE: this is like auto above, but they&#39;re handled a bit different</span>
<a name="l00785"></a>00785 <span class="comment"> */</span>
<a name="l00786"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a82c545a3db4ad10933456adb61937623">00786</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a82c545a3db4ad10933456adb61937623">set_bezier_auto_clamped</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00787"></a>00787 {
<a name="l00788"></a>00788     <span class="keywordflow">if</span> ((bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) || (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) {
<a name="l00789"></a>00789         <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>;
<a name="l00790"></a>00790         <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>;
<a name="l00791"></a>00791         
<a name="l00792"></a>00792         <a class="code" href="../../db/d71/keyframes__edit_8c.html#a32b68e61d998e0bc4e2191ab4826d3fe">ENSURE_HANDLES_MATCH</a>(bezt);
<a name="l00793"></a>00793     }
<a name="l00794"></a>00794     <span class="keywordflow">return</span> 0;
<a name="l00795"></a>00795 }
<a name="l00796"></a>00796 
<a name="l00797"></a>00797 <span class="comment">/* Sets the selected bezier handles to type &#39;vector&#39;  */</span>
<a name="l00798"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a05844df0041b53bff6ac35e38504d880">00798</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a05844df0041b53bff6ac35e38504d880">set_bezier_vector</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00799"></a>00799 {
<a name="l00800"></a>00800     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca1e9cb5ecc39a3c74be445d1c4d151d04">HD_VECT</a>;
<a name="l00801"></a>00801     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca1e9cb5ecc39a3c74be445d1c4d151d04">HD_VECT</a>;
<a name="l00802"></a>00802     <span class="keywordflow">return</span> 0;
<a name="l00803"></a>00803 }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 <span class="comment">/* Queries if the handle should be set to &#39;free&#39; or &#39;align&#39; */</span>
<a name="l00806"></a>00806 <span class="comment">// NOTE: this was used for the &#39;toggle free/align&#39; option</span>
<a name="l00807"></a>00807 <span class="comment">//      currently this isn&#39;t used, but may be restored later</span>
<a name="l00808"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a0c54e21d9e12e4010f1fde1e1a828607">00808</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a0c54e21d9e12e4010f1fde1e1a828607">bezier_isfree</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00809"></a>00809 {
<a name="l00810"></a>00810     <span class="keywordflow">if</span> ((bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) &amp;&amp; (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>)) <span class="keywordflow">return</span> 1;
<a name="l00811"></a>00811     <span class="keywordflow">if</span> ((bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) &amp;&amp; (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>)) <span class="keywordflow">return</span> 1;
<a name="l00812"></a>00812     <span class="keywordflow">return</span> 0;
<a name="l00813"></a>00813 }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815 <span class="comment">/* Sets selected bezier handles to type &#39;align&#39; */</span>
<a name="l00816"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a437adff1662a1621c0aa348353fd5027">00816</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a437adff1662a1621c0aa348353fd5027">set_bezier_align</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00817"></a>00817 {   
<a name="l00818"></a>00818     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45ecacf967643ac26269318a51fe281992051">HD_ALIGN</a>;
<a name="l00819"></a>00819     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45ecacf967643ac26269318a51fe281992051">HD_ALIGN</a>;
<a name="l00820"></a>00820     <span class="keywordflow">return</span> 0;
<a name="l00821"></a>00821 }
<a name="l00822"></a>00822 
<a name="l00823"></a>00823 <span class="comment">/* Sets selected bezier handles to type &#39;free&#39;  */</span>
<a name="l00824"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#aad569f13598f279a0896f1ce986d02b5">00824</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aad569f13598f279a0896f1ce986d02b5">set_bezier_free</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00825"></a>00825 {
<a name="l00826"></a>00826     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca36fb837b87ff289ecff74a12cc6161ad">HD_FREE</a>;
<a name="l00827"></a>00827     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca36fb837b87ff289ecff74a12cc6161ad">HD_FREE</a>;
<a name="l00828"></a>00828     <span class="keywordflow">return</span> 0;
<a name="l00829"></a>00829 }
<a name="l00830"></a>00830 
<a name="l00831"></a>00831 <span class="comment">/* Set all selected Bezier Handles to a single type */</span>
<a name="l00832"></a>00832 <span class="comment">// calchandles_fcurve</span>
<a name="l00833"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#affe04b972ea84ddf0f562a79609fb2b7">00833</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a1806034e52d545f8b82fc41891e5a63a">ANIM_editkeyframes_handles</a>(<span class="keywordtype">short</span> code)
<a name="l00834"></a>00834 {
<a name="l00835"></a>00835     <span class="keywordflow">switch</span> (code) {
<a name="l00836"></a>00836         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>: <span class="comment">/* auto */</span>
<a name="l00837"></a>00837             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ac16b884bfcf5b089004724baf49792c4">set_bezier_auto</a>;
<a name="l00838"></a>00838         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>: <span class="comment">/* auto clamped */</span>
<a name="l00839"></a>00839             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a82c545a3db4ad10933456adb61937623">set_bezier_auto_clamped</a>;
<a name="l00840"></a>00840             
<a name="l00841"></a>00841         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca1e9cb5ecc39a3c74be445d1c4d151d04">HD_VECT</a>: <span class="comment">/* vector */</span>
<a name="l00842"></a>00842             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a05844df0041b53bff6ac35e38504d880">set_bezier_vector</a>;
<a name="l00843"></a>00843         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca36fb837b87ff289ecff74a12cc6161ad">HD_FREE</a>: <span class="comment">/* free */</span>
<a name="l00844"></a>00844             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aad569f13598f279a0896f1ce986d02b5">set_bezier_free</a>;
<a name="l00845"></a>00845         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45ecacf967643ac26269318a51fe281992051">HD_ALIGN</a>: <span class="comment">/* align */</span>
<a name="l00846"></a>00846             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a437adff1662a1621c0aa348353fd5027">set_bezier_align</a>;
<a name="l00847"></a>00847         
<a name="l00848"></a>00848         <span class="keywordflow">default</span>: <span class="comment">/* check for toggle free or align? */</span>
<a name="l00849"></a>00849             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a0c54e21d9e12e4010f1fde1e1a828607">bezier_isfree</a>;
<a name="l00850"></a>00850     }
<a name="l00851"></a>00851 }
<a name="l00852"></a>00852 
<a name="l00853"></a>00853 <span class="comment">/* ------- */</span>
<a name="l00854"></a>00854 
<a name="l00855"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#aeb180dcfd2b5bd026e48f2cda17b8c0c">00855</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aeb180dcfd2b5bd026e48f2cda17b8c0c">set_bezt_constant</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00856"></a>00856 {
<a name="l00857"></a>00857     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) 
<a name="l00858"></a>00858         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a2b20e9a54cf1f1637920ae56f75d0926">ipo</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#ad74346e6c15814750cc9c5eb6369fda5a8a7c4acc7a8382a9c8e1f88c9688254d">BEZT_IPO_CONST</a>;
<a name="l00859"></a>00859     <span class="keywordflow">return</span> 0;
<a name="l00860"></a>00860 }
<a name="l00861"></a>00861 
<a name="l00862"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a6b62a99e3653b6acc73d05c6723450d3">00862</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a6b62a99e3653b6acc73d05c6723450d3">set_bezt_linear</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00863"></a>00863 {
<a name="l00864"></a>00864     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) 
<a name="l00865"></a>00865         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a2b20e9a54cf1f1637920ae56f75d0926">ipo</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#ad74346e6c15814750cc9c5eb6369fda5aa1cd3be3b402e1401033731c66a1613b">BEZT_IPO_LIN</a>;
<a name="l00866"></a>00866     <span class="keywordflow">return</span> 0;
<a name="l00867"></a>00867 }
<a name="l00868"></a>00868 
<a name="l00869"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a66a3af2bf1e08755f72acc96fd06379e">00869</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a66a3af2bf1e08755f72acc96fd06379e">set_bezt_bezier</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00870"></a>00870 {
<a name="l00871"></a>00871     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) 
<a name="l00872"></a>00872         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a2b20e9a54cf1f1637920ae56f75d0926">ipo</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#ad74346e6c15814750cc9c5eb6369fda5a9163255a4d331348a32c994ea1b191ce">BEZT_IPO_BEZ</a>;
<a name="l00873"></a>00873     <span class="keywordflow">return</span> 0;
<a name="l00874"></a>00874 }
<a name="l00875"></a>00875 
<a name="l00876"></a>00876 <span class="comment">/* Set the interpolation type of the selected BezTriples in each F-Curve to the specified one */</span>
<a name="l00877"></a>00877 <span class="comment">// ANIM_editkeyframes_ipocurve_ipotype() !</span>
<a name="l00878"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a538de363c9a5eab628ab3627d6d6a774">00878</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ab86fce43e4f66eeeac7df54c03deaae9">ANIM_editkeyframes_ipo</a>(<span class="keywordtype">short</span> code)
<a name="l00879"></a>00879 {
<a name="l00880"></a>00880     <span class="keywordflow">switch</span> (code) {
<a name="l00881"></a>00881         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#ad74346e6c15814750cc9c5eb6369fda5a8a7c4acc7a8382a9c8e1f88c9688254d">BEZT_IPO_CONST</a>: <span class="comment">/* constant */</span>
<a name="l00882"></a>00882             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aeb180dcfd2b5bd026e48f2cda17b8c0c">set_bezt_constant</a>;
<a name="l00883"></a>00883         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#ad74346e6c15814750cc9c5eb6369fda5aa1cd3be3b402e1401033731c66a1613b">BEZT_IPO_LIN</a>: <span class="comment">/* linear */</span> 
<a name="l00884"></a>00884             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a6b62a99e3653b6acc73d05c6723450d3">set_bezt_linear</a>;
<a name="l00885"></a>00885         <span class="keywordflow">default</span>: <span class="comment">/* bezier */</span>
<a name="l00886"></a>00886             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a66a3af2bf1e08755f72acc96fd06379e">set_bezt_bezier</a>;
<a name="l00887"></a>00887     }
<a name="l00888"></a>00888 }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890 <span class="comment">/* ------- */</span>
<a name="l00891"></a>00891 
<a name="l00892"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a4a5cf0a0674a5ad62d2db776e8fe38a9">00892</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a4a5cf0a0674a5ad62d2db776e8fe38a9">set_keytype_keyframe</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00893"></a>00893 {
<a name="l00894"></a>00894     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) 
<a name="l00895"></a>00895         <a class="code" href="../../df/d6f/ED__anim__api_8h.html#ad3cf875682066b37d752bb1b50e6c288">BEZKEYTYPE</a>(bezt)= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335cad5591000922bff58bafed40c0ab9a6e5">BEZT_KEYTYPE_KEYFRAME</a>;
<a name="l00896"></a>00896     <span class="keywordflow">return</span> 0;
<a name="l00897"></a>00897 }
<a name="l00898"></a>00898 
<a name="l00899"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a9a9cb2956c76b95acee1f254f2312d04">00899</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a9a9cb2956c76b95acee1f254f2312d04">set_keytype_breakdown</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00900"></a>00900 {
<a name="l00901"></a>00901     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) 
<a name="l00902"></a>00902         <a class="code" href="../../df/d6f/ED__anim__api_8h.html#ad3cf875682066b37d752bb1b50e6c288">BEZKEYTYPE</a>(bezt)= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335ca5edf24362a6bb0dc2337ff1f06a43051">BEZT_KEYTYPE_BREAKDOWN</a>;
<a name="l00903"></a>00903     <span class="keywordflow">return</span> 0;
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00906"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a98a1ee0cbe5647b7feb8526ed8a47610">00906</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a98a1ee0cbe5647b7feb8526ed8a47610">set_keytype_extreme</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00907"></a>00907 {
<a name="l00908"></a>00908     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) 
<a name="l00909"></a>00909         <a class="code" href="../../df/d6f/ED__anim__api_8h.html#ad3cf875682066b37d752bb1b50e6c288">BEZKEYTYPE</a>(bezt)= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335ca0dd6a0c6434a7a7e72a4450439d6b180">BEZT_KEYTYPE_EXTREME</a>;
<a name="l00910"></a>00910     <span class="keywordflow">return</span> 0;
<a name="l00911"></a>00911 }
<a name="l00912"></a>00912 
<a name="l00913"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a91c8db8bd805147dc77734a83c5a807d">00913</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a91c8db8bd805147dc77734a83c5a807d">set_keytype_jitter</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00914"></a>00914 {
<a name="l00915"></a>00915     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) 
<a name="l00916"></a>00916         <a class="code" href="../../df/d6f/ED__anim__api_8h.html#ad3cf875682066b37d752bb1b50e6c288">BEZKEYTYPE</a>(bezt)= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335ca2dd0cca26344251717f8b0b3a847366a">BEZT_KEYTYPE_JITTER</a>;
<a name="l00917"></a>00917     <span class="keywordflow">return</span> 0;
<a name="l00918"></a>00918 }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 <span class="comment">/* Set the interpolation type of the selected BezTriples in each F-Curve to the specified one */</span>
<a name="l00921"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a2d41c3b130b8a3765d00d2eff7a4cf91">00921</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a7ffa96d7c2ede27fc7ea077a32faf4ea">ANIM_editkeyframes_keytype</a>(<span class="keywordtype">short</span> code)
<a name="l00922"></a>00922 {
<a name="l00923"></a>00923     <span class="keywordflow">switch</span> (code) {
<a name="l00924"></a>00924         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335ca5edf24362a6bb0dc2337ff1f06a43051">BEZT_KEYTYPE_BREAKDOWN</a>: <span class="comment">/* breakdown */</span>
<a name="l00925"></a>00925             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a9a9cb2956c76b95acee1f254f2312d04">set_keytype_breakdown</a>;
<a name="l00926"></a>00926             
<a name="l00927"></a>00927         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335ca0dd6a0c6434a7a7e72a4450439d6b180">BEZT_KEYTYPE_EXTREME</a>: <span class="comment">/* extreme keyframe */</span>
<a name="l00928"></a>00928             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a98a1ee0cbe5647b7feb8526ed8a47610">set_keytype_extreme</a>;
<a name="l00929"></a>00929             
<a name="l00930"></a>00930         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335ca2dd0cca26344251717f8b0b3a847366a">BEZT_KEYTYPE_JITTER</a>: <span class="comment">/* jitter keyframe */</span>
<a name="l00931"></a>00931             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a91c8db8bd805147dc77734a83c5a807d">set_keytype_jitter</a>;
<a name="l00932"></a>00932             
<a name="l00933"></a>00933         <span class="keywordflow">case</span> <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335cad5591000922bff58bafed40c0ab9a6e5">BEZT_KEYTYPE_KEYFRAME</a>: <span class="comment">/* proper keyframe */</span>   
<a name="l00934"></a>00934         <span class="keywordflow">default</span>:
<a name="l00935"></a>00935             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a4a5cf0a0674a5ad62d2db776e8fe38a9">set_keytype_keyframe</a>;
<a name="l00936"></a>00936     }
<a name="l00937"></a>00937 }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 <span class="comment">/* ******************************************* */</span>
<a name="l00940"></a>00940 <span class="comment">/* Selection */</span>
<a name="l00941"></a>00941 
<a name="l00942"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a64ef7c681665edd3b5a87416af30c4e1">00942</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64ef7c681665edd3b5a87416af30c4e1">select_bezier_add</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00943"></a>00943 {
<a name="l00944"></a>00944     <span class="comment">/* if we&#39;ve got info on what to select, use it, otherwise select all */</span>
<a name="l00945"></a>00945     <span class="keywordflow">if</span> ((ked) &amp;&amp; (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1c891e0d530bc74468980208b5bfd4af">iterflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a9e1c008140b5006a231f0665e6272037a89ea7422d97ecfb17b72fdaac253c5a2">KEYFRAME_ITER_INCL_HANDLES</a>)) {
<a name="l00946"></a>00946         <span class="keywordflow">if</span> (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a686d7d446ff46366a35157350d717b9fa4fbb38a4a6d3fc2912cfc00d95c90b54">KEYFRAME_OK_KEY</a>)
<a name="l00947"></a>00947             bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00948"></a>00948         <span class="keywordflow">if</span> (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a686d7d446ff46366a35157350d717b9fab0dc044d2c430229a99c5a37a1c857d2">KEYFRAME_OK_H1</a>)
<a name="l00949"></a>00949             bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00950"></a>00950         <span class="keywordflow">if</span> (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a686d7d446ff46366a35157350d717b9faf5d695cdc4cd88bfcb756434f1086539">KEYFRAME_OK_H2</a>)
<a name="l00951"></a>00951             bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00952"></a>00952     }
<a name="l00953"></a>00953     <span class="keywordflow">else</span> {
<a name="l00954"></a>00954         <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a243e99ba94633b9581fb4a6e7b6375d0">BEZ_SEL</a>(bezt);
<a name="l00955"></a>00955     }
<a name="l00956"></a>00956     
<a name="l00957"></a>00957     <span class="keywordflow">return</span> 0;
<a name="l00958"></a>00958 }
<a name="l00959"></a>00959 
<a name="l00960"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a4ff59ac23050b6bb3da1faa261cc80c8">00960</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a4ff59ac23050b6bb3da1faa261cc80c8">select_bezier_subtract</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00961"></a>00961 {
<a name="l00962"></a>00962     <span class="comment">/* if we&#39;ve got info on what to deselect, use it, otherwise deselect all */</span>
<a name="l00963"></a>00963     <span class="keywordflow">if</span> ((ked) &amp;&amp; (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a1c891e0d530bc74468980208b5bfd4af">iterflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a9e1c008140b5006a231f0665e6272037a89ea7422d97ecfb17b72fdaac253c5a2">KEYFRAME_ITER_INCL_HANDLES</a>)) {
<a name="l00964"></a>00964         <span class="keywordflow">if</span> (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a686d7d446ff46366a35157350d717b9fa4fbb38a4a6d3fc2912cfc00d95c90b54">KEYFRAME_OK_KEY</a>)
<a name="l00965"></a>00965             bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00966"></a>00966         <span class="keywordflow">if</span> (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a686d7d446ff46366a35157350d717b9fab0dc044d2c430229a99c5a37a1c857d2">KEYFRAME_OK_H1</a>)
<a name="l00967"></a>00967             bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00968"></a>00968         <span class="keywordflow">if</span> (ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac06bb15b3711a5e584405492a0d24cd7">curflags</a> &amp; <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a686d7d446ff46366a35157350d717b9faf5d695cdc4cd88bfcb756434f1086539">KEYFRAME_OK_H2</a>)
<a name="l00969"></a>00969             bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00970"></a>00970     }
<a name="l00971"></a>00971     <span class="keywordflow">else</span> {
<a name="l00972"></a>00972         <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a93dcc657832994a8d1c2768bc2e19fa6">BEZ_DESEL</a>(bezt);
<a name="l00973"></a>00973     }
<a name="l00974"></a>00974     
<a name="l00975"></a>00975     <span class="keywordflow">return</span> 0;
<a name="l00976"></a>00976 }
<a name="l00977"></a>00977 
<a name="l00978"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#aa0ede2c39c974b6098726643f4c9ea28">00978</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aa0ede2c39c974b6098726643f4c9ea28">select_bezier_invert</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ked), <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt) 
<a name="l00979"></a>00979 {
<a name="l00980"></a>00980     <span class="comment">/* Invert the selection for the whole bezier triple */</span>
<a name="l00981"></a>00981     bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> ^= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00982"></a>00982     <span class="keywordflow">if</span> (bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a6589749668d64ba3a1182a17bb0e5d89">f2</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00983"></a>00983         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00984"></a>00984         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00985"></a>00985     }
<a name="l00986"></a>00986     <span class="keywordflow">else</span> {
<a name="l00987"></a>00987         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad1188a435612de53bc858987af3c7acd">f1</a> &amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00988"></a>00988         bezt-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a426bd73dcd72de3539ed00b02646bac1">f3</a> &amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00989"></a>00989     }
<a name="l00990"></a>00990     <span class="keywordflow">return</span> 0;
<a name="l00991"></a>00991 }
<a name="l00992"></a>00992 
<a name="l00993"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a0940ca54a6c0ea58b21c4f8973ee4118">00993</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aa3e4b477e4fa097f19f20000c6ada48c">ANIM_editkeyframes_select</a>(<span class="keywordtype">short</span> selectmode)
<a name="l00994"></a>00994 {
<a name="l00995"></a>00995     <span class="keywordflow">switch</span> (selectmode) {
<a name="l00996"></a>00996         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad482afe81f1047e2b4d6bc85a221c804acbee6125d220eb0638f284e310ed7dd2">SELECT_ADD</a>: <span class="comment">/* add */</span>
<a name="l00997"></a>00997             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64ef7c681665edd3b5a87416af30c4e1">select_bezier_add</a>;
<a name="l00998"></a>00998         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad482afe81f1047e2b4d6bc85a221c804ab7419accdf73227e0606e04a38313ab9">SELECT_SUBTRACT</a>: <span class="comment">/* subtract */</span>
<a name="l00999"></a>00999             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a4ff59ac23050b6bb3da1faa261cc80c8">select_bezier_subtract</a>;
<a name="l01000"></a>01000         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ad482afe81f1047e2b4d6bc85a221c804a162baf509d3532338823464402c56433">SELECT_INVERT</a>: <span class="comment">/* invert */</span>
<a name="l01001"></a>01001             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aa0ede2c39c974b6098726643f4c9ea28">select_bezier_invert</a>;
<a name="l01002"></a>01002         <span class="keywordflow">default</span>: <span class="comment">/* replace (need to clear all, then add) */</span>
<a name="l01003"></a>01003             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a64ef7c681665edd3b5a87416af30c4e1">select_bezier_add</a>;
<a name="l01004"></a>01004     }
<a name="l01005"></a>01005 }
<a name="l01006"></a>01006 
<a name="l01007"></a>01007 <span class="comment">/* ******************************************* */</span>
<a name="l01008"></a>01008 <span class="comment">/* Selection Maps */</span>
<a name="l01009"></a>01009 
<a name="l01010"></a>01010 <span class="comment">/* Selection maps are simply fancy names for char arrays that store on/off</span>
<a name="l01011"></a>01011 <span class="comment"> * info for whether the selection status. The main purpose for these is to</span>
<a name="l01012"></a>01012 <span class="comment"> * allow extra info to be tagged to the keyframes without influencing their</span>
<a name="l01013"></a>01013 <span class="comment"> * values or having to be removed later.</span>
<a name="l01014"></a>01014 <span class="comment"> */</span>
<a name="l01015"></a>01015 
<a name="l01016"></a>01016 <span class="comment">/* ----------- */</span>
<a name="l01017"></a>01017 
<a name="l01018"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#a59e484431b0971f8e0763fe2736e9d96">01018</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a59e484431b0971f8e0763fe2736e9d96">selmap_build_bezier_more</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l01019"></a>01019 {
<a name="l01020"></a>01020     <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a0dc5a03e9718b99cf5dfb1caf3218c09">fcu</a>;
<a name="l01021"></a>01021     <span class="keywordtype">char</span> *map= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a501b1376c86503e0138fcd41e59df925">data</a>;
<a name="l01022"></a>01022     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac37b9c3a8de77ef6688c8f972c2c432d">curIndex</a>;
<a name="l01023"></a>01023     
<a name="l01024"></a>01024     <span class="comment">/* if current is selected, just make sure it stays this way */</span>
<a name="l01025"></a>01025     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#a30e90c4df6243a5254d5a1b61c5c8a9c">BEZSELECTED</a>(bezt)) {
<a name="l01026"></a>01026         map[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]= 1;
<a name="l01027"></a>01027         <span class="keywordflow">return</span> 0;
<a name="l01028"></a>01028     }
<a name="l01029"></a>01029     
<a name="l01030"></a>01030     <span class="comment">/* if previous is selected, that means that selection should extend across */</span>
<a name="l01031"></a>01031     <span class="keywordflow">if</span> (i &gt; 0) {
<a name="l01032"></a>01032         <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *<a class="code" href="../../d5/db2/structActBeztColumn.html#acb52a8a103376aec5881e01830eabee3">prev</a>= bezt - 1;
<a name="l01033"></a>01033         
<a name="l01034"></a>01034         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#a30e90c4df6243a5254d5a1b61c5c8a9c">BEZSELECTED</a>(prev)) {
<a name="l01035"></a>01035             map[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]= 1;
<a name="l01036"></a>01036             <span class="keywordflow">return</span> 0;
<a name="l01037"></a>01037         }
<a name="l01038"></a>01038     }
<a name="l01039"></a>01039     
<a name="l01040"></a>01040     <span class="comment">/* if next is selected, that means that selection should extend across */</span>
<a name="l01041"></a>01041     <span class="keywordflow">if</span> (i &lt; (fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#adec915e7ed4f2b66b12313566bf5c33f">totvert</a>-1)) {
<a name="l01042"></a>01042         <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *<a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>= bezt + 1;
<a name="l01043"></a>01043         
<a name="l01044"></a>01044         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#a30e90c4df6243a5254d5a1b61c5c8a9c">BEZSELECTED</a>(next)) {
<a name="l01045"></a>01045             map[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]= 1;
<a name="l01046"></a>01046             <span class="keywordflow">return</span> 0;
<a name="l01047"></a>01047         }
<a name="l01048"></a>01048     }
<a name="l01049"></a>01049     
<a name="l01050"></a>01050     <span class="keywordflow">return</span> 0;
<a name="l01051"></a>01051 }
<a name="l01052"></a>01052 
<a name="l01053"></a><a class="code" href="../../db/d71/keyframes__edit_8c.html#aeb26d6c3d053bf69f83781a8cfd83bdc">01053</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aeb26d6c3d053bf69f83781a8cfd83bdc">selmap_build_bezier_less</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l01054"></a>01054 {
<a name="l01055"></a>01055     <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a0dc5a03e9718b99cf5dfb1caf3218c09">fcu</a>;
<a name="l01056"></a>01056     <span class="keywordtype">char</span> *map= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a501b1376c86503e0138fcd41e59df925">data</a>;
<a name="l01057"></a>01057     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac37b9c3a8de77ef6688c8f972c2c432d">curIndex</a>;
<a name="l01058"></a>01058     
<a name="l01059"></a>01059     <span class="comment">/* if current is selected, check the left/right keyframes</span>
<a name="l01060"></a>01060 <span class="comment">     * since it might need to be deselected (but otherwise no)</span>
<a name="l01061"></a>01061 <span class="comment">     */</span>
<a name="l01062"></a>01062     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#a30e90c4df6243a5254d5a1b61c5c8a9c">BEZSELECTED</a>(bezt)) {
<a name="l01063"></a>01063         <span class="comment">/* if previous is not selected, we&#39;re on the tip of an iceberg */</span>
<a name="l01064"></a>01064         <span class="keywordflow">if</span> (i &gt; 0) {
<a name="l01065"></a>01065             <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *<a class="code" href="../../d5/db2/structActBeztColumn.html#acb52a8a103376aec5881e01830eabee3">prev</a>= bezt - 1;
<a name="l01066"></a>01066             
<a name="l01067"></a>01067             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#a30e90c4df6243a5254d5a1b61c5c8a9c">BEZSELECTED</a>(prev) == 0)
<a name="l01068"></a>01068                 <span class="keywordflow">return</span> 0;
<a name="l01069"></a>01069         }
<a name="l01070"></a>01070         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 0) {
<a name="l01071"></a>01071             <span class="comment">/* current keyframe is selected at an endpoint, so should get deselected */</span>
<a name="l01072"></a>01072             <span class="keywordflow">return</span> 0;
<a name="l01073"></a>01073         }
<a name="l01074"></a>01074         
<a name="l01075"></a>01075         <span class="comment">/* if next is not selected, we&#39;re on the tip of an iceberg */</span>
<a name="l01076"></a>01076         <span class="keywordflow">if</span> (i &lt; (fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#adec915e7ed4f2b66b12313566bf5c33f">totvert</a>-1)) {
<a name="l01077"></a>01077             <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *<a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>= bezt + 1;
<a name="l01078"></a>01078             
<a name="l01079"></a>01079             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#a30e90c4df6243a5254d5a1b61c5c8a9c">BEZSELECTED</a>(next) == 0)
<a name="l01080"></a>01080                 <span class="keywordflow">return</span> 0;
<a name="l01081"></a>01081         }
<a name="l01082"></a>01082         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == (fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#adec915e7ed4f2b66b12313566bf5c33f">totvert</a>-1)) {
<a name="l01083"></a>01083             <span class="comment">/* current keyframe is selected at an endpoint, so should get deselected */</span>
<a name="l01084"></a>01084             <span class="keywordflow">return</span> 0;
<a name="l01085"></a>01085         }
<a name="l01086"></a>01086         
<a name="l01087"></a>01087         <span class="comment">/* if we&#39;re still here, that means that keyframe should remain untouched */</span>
<a name="l01088"></a>01088         map[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]= 1;
<a name="l01089"></a>01089     }
<a name="l01090"></a>01090     
<a name="l01091"></a>01091     <span class="keywordflow">return</span> 0;
<a name="l01092"></a>01092 }
<a name="l01093"></a>01093 
<a name="l01094"></a>01094 <span class="comment">/* Get callback for building selection map */</span>
<a name="l01095"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ab471bd100d29dc73ad9a9756de7d8575">01095</a> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a1de51656b7a1d10c00977eefd746cb44">KeyframeEditFunc</a> <a class="code" href="../../db/d71/keyframes__edit_8c.html#ab471bd100d29dc73ad9a9756de7d8575">ANIM_editkeyframes_buildselmap</a>(<span class="keywordtype">short</span> mode)
<a name="l01096"></a>01096 {
<a name="l01097"></a>01097     <span class="keywordflow">switch</span> (mode) {
<a name="l01098"></a>01098         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ace2d6e55f37527adb63d403141ec9cf4add3f60ed8b19160a4f0ab471ddcf83a0">SELMAP_LESS</a>: <span class="comment">/* less */</span>
<a name="l01099"></a>01099             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#aeb26d6c3d053bf69f83781a8cfd83bdc">selmap_build_bezier_less</a>;
<a name="l01100"></a>01100         
<a name="l01101"></a>01101         <span class="keywordflow">case</span> <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ace2d6e55f37527adb63d403141ec9cf4a3964dfb75cae2ecc21cde2d532fd952c">SELMAP_MORE</a>: <span class="comment">/* more */</span>
<a name="l01102"></a>01102         <span class="keywordflow">default</span>:
<a name="l01103"></a>01103             <span class="keywordflow">return</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a59e484431b0971f8e0763fe2736e9d96">selmap_build_bezier_more</a>;
<a name="l01104"></a>01104     }
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 <span class="comment">/* ----------- */</span>
<a name="l01108"></a>01108 
<a name="l01109"></a>01109 <span class="comment">/* flush selection map values to the given beztriple */</span>
<a name="l01110"></a><a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#ab57f14bf7190dd1c249e1cce8487a439">01110</a> <span class="keywordtype">short</span> <a class="code" href="../../db/d71/keyframes__edit_8c.html#a23529aac61a04e34f494fb916ff3687d">bezt_selmap_flush</a>(<a class="code" href="../../d5/d01/structKeyframeEditData.html">KeyframeEditData</a> *ked, <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *bezt)
<a name="l01111"></a>01111 {
<a name="l01112"></a>01112     <span class="keywordtype">char</span> *map= ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#a501b1376c86503e0138fcd41e59df925">data</a>;
<a name="l01113"></a>01113     <span class="keywordtype">short</span> on= map[ked-&gt;<a class="code" href="../../d5/d01/structKeyframeEditData.html#ac37b9c3a8de77ef6688c8f972c2c432d">curIndex</a>];
<a name="l01114"></a>01114     
<a name="l01115"></a>01115     <span class="comment">/* select or deselect based on whether the map allows it or not */</span>
<a name="l01116"></a>01116     <span class="keywordflow">if</span> (on) {
<a name="l01117"></a>01117         <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a243e99ba94633b9581fb4a6e7b6375d0">BEZ_SEL</a>(bezt);
<a name="l01118"></a>01118     }
<a name="l01119"></a>01119     <span class="keywordflow">else</span> {
<a name="l01120"></a>01120         <a class="code" href="../../d7/d10/ED__keyframes__edit_8h.html#a93dcc657832994a8d1c2768bc2e19fa6">BEZ_DESEL</a>(bezt);
<a name="l01121"></a>01121     }
<a name="l01122"></a>01122     
<a name="l01123"></a>01123     <span class="keywordflow">return</span> 0;
<a name="l01124"></a>01124 }
<a name="l01125"></a>01125 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:27 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
