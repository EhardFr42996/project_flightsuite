<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: GHOST_SystemCocoa.mm Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">GHOST_SystemCocoa.mm</div>  </div>
</div>
<div class="contents">
<a href="../../d1/def/GHOST__SystemCocoa_8mm.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2001-2002 by NaN Holding BV.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * The Original Code is: all of this file.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * Contributors: Maarten Gribnau 05/2001</span>
<a name="l00024"></a>00024 <span class="comment"> *               Damien Plisson 09/2009</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00027"></a>00027 <span class="comment"> */</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#import &lt;Cocoa/Cocoa.h&gt;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="comment">/*For the currently not ported to Cocoa keyboard layout functions (64bit &amp; 10.6 compatible)*/</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;Carbon/Carbon.h&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;sys/time.h&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;sys/sysctl.h&gt;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d1b/GHOST__SystemCocoa_8h.html">GHOST_SystemCocoa.h</a>&quot;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d33/GHOST__DisplayManagerCocoa_8h.html">GHOST_DisplayManagerCocoa.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/da8/GHOST__EventKey_8h.html">GHOST_EventKey.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d6c/GHOST__EventButton_8h.html">GHOST_EventButton.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d04/GHOST__EventCursor_8h.html">GHOST_EventCursor.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d46/GHOST__EventWheel_8h.html">GHOST_EventWheel.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d6c/GHOST__EventTrackpad_8h.html">GHOST_EventTrackpad.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d2a/GHOST__EventDragnDrop_8h.html">GHOST_EventDragnDrop.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d13/GHOST__EventString_8h.html">GHOST_EventString.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d5b/GHOST__TimerManager_8h.html">GHOST_TimerManager.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d8c/GHOST__TimerTask_8h.html">GHOST_TimerTask.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d7c/GHOST__WindowManager_8h.html">GHOST_WindowManager.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d94/GHOST__WindowCocoa_8h.html">GHOST_WindowCocoa.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#ifdef WITH_INPUT_NDOF</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="../../dc/da5/GHOST__NDOFManagerCocoa_8h.html">GHOST_NDOFManagerCocoa.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#endif</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;AssertMacros.h&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#pragma mark KeyMap, mouse converters</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="preprocessor">#if MAC_OS_X_VERSION_MIN_REQUIRED &lt;= MAC_OS_X_VERSION_10_4</span>
<a name="l00060"></a>00060 <span class="preprocessor"></span><span class="comment">/* Keycodes not defined in Tiger */</span>
<a name="l00061"></a>00061 <span class="comment">/*  </span>
<a name="l00062"></a>00062 <span class="comment"> *  Summary:</span>
<a name="l00063"></a>00063 <span class="comment"> *    Virtual keycodes</span>
<a name="l00064"></a>00064 <span class="comment"> *  </span>
<a name="l00065"></a>00065 <span class="comment"> *  Discussion:</span>
<a name="l00066"></a>00066 <span class="comment"> *    These constants are the virtual keycodes defined originally in</span>
<a name="l00067"></a>00067 <span class="comment"> *    Inside Mac Volume V, pg. V-191. They identify physical keys on a</span>
<a name="l00068"></a>00068 <span class="comment"> *    keyboard. Those constants with &quot;ANSI&quot; in the name are labeled</span>
<a name="l00069"></a>00069 <span class="comment"> *    according to the key position on an ANSI-standard US keyboard.</span>
<a name="l00070"></a>00070 <span class="comment"> *    For example, kVK_ANSI_A indicates the virtual keycode for the key</span>
<a name="l00071"></a>00071 <span class="comment"> *    with the letter &#39;A&#39; in the US keyboard layout. Other keyboard</span>
<a name="l00072"></a>00072 <span class="comment"> *    layouts may have the &#39;A&#39; key label on a different physical key;</span>
<a name="l00073"></a>00073 <span class="comment"> *    in this case, pressing &#39;A&#39; will generate a different virtual</span>
<a name="l00074"></a>00074 <span class="comment"> *    keycode.</span>
<a name="l00075"></a>00075 <span class="comment"> */</span>
<a name="l00076"></a>00076 <span class="keyword">enum</span> {
<a name="l00077"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aec22aadf10a6e015006e00584296b5e1">00077</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aec22aadf10a6e015006e00584296b5e1">kVK_ANSI_A</a>                    = 0x00,
<a name="l00078"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a2df96ed4166bda29c8cf34214b4f55a1">00078</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a2df96ed4166bda29c8cf34214b4f55a1">kVK_ANSI_S</a>                    = 0x01,
<a name="l00079"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9d6c37d9c80cbea53ba3684acd9484cd">00079</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9d6c37d9c80cbea53ba3684acd9484cd">kVK_ANSI_D</a>                    = 0x02,
<a name="l00080"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a24fac391289fc98de3474590de525f99">00080</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a24fac391289fc98de3474590de525f99">kVK_ANSI_F</a>                    = 0x03,
<a name="l00081"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af4493e2cf756c067f59d2b1f8b453fb7">00081</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af4493e2cf756c067f59d2b1f8b453fb7">kVK_ANSI_H</a>                    = 0x04,
<a name="l00082"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad044522f2d0511d925917a6825790816">00082</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad044522f2d0511d925917a6825790816">kVK_ANSI_G</a>                    = 0x05,
<a name="l00083"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae59378ed9a94970ae9eddacbef05d971">00083</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae59378ed9a94970ae9eddacbef05d971">kVK_ANSI_Z</a>                    = 0x06,
<a name="l00084"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae57e441595345c249f4a5b506b649e6e">00084</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae57e441595345c249f4a5b506b649e6e">kVK_ANSI_X</a>                    = 0x07,
<a name="l00085"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae5020617592a29e8d6b0acce4b93f90e">00085</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae5020617592a29e8d6b0acce4b93f90e">kVK_ANSI_C</a>                    = 0x08,
<a name="l00086"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a5891b3a408c8b274c55ab4ea5c82e849">00086</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a5891b3a408c8b274c55ab4ea5c82e849">kVK_ANSI_V</a>                    = 0x09,
<a name="l00087"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a193740f2f89cde23770e3d8800f84748">00087</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a193740f2f89cde23770e3d8800f84748">kVK_ANSI_B</a>                    = 0x0B,
<a name="l00088"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a15d3c65c1b4723e7c619acae01d83a9f">00088</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a15d3c65c1b4723e7c619acae01d83a9f">kVK_ANSI_Q</a>                    = 0x0C,
<a name="l00089"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9e7119a15be5bd9dfc2f8c2c0c31c268">00089</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9e7119a15be5bd9dfc2f8c2c0c31c268">kVK_ANSI_W</a>                    = 0x0D,
<a name="l00090"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a5abfc823914ddb2d564a4626ecde15d1">00090</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a5abfc823914ddb2d564a4626ecde15d1">kVK_ANSI_E</a>                    = 0x0E,
<a name="l00091"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a01fb26d94098f1cb6dfe0e81d30e180d">00091</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a01fb26d94098f1cb6dfe0e81d30e180d">kVK_ANSI_R</a>                    = 0x0F,
<a name="l00092"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a7ecafc4579ab4832cd54ac902ed3e10e">00092</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a7ecafc4579ab4832cd54ac902ed3e10e">kVK_ANSI_Y</a>                    = 0x10,
<a name="l00093"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a0c33a02917ab9bfa78e10b0a03c1ec25">00093</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a0c33a02917ab9bfa78e10b0a03c1ec25">kVK_ANSI_T</a>                    = 0x11,
<a name="l00094"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aafc7db2b790895d89d3c1055eb63a04d">00094</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aafc7db2b790895d89d3c1055eb63a04d">kVK_ANSI_1</a>                    = 0x12,
<a name="l00095"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a88c319c1f10c44fb7e8518edde8933ac">00095</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a88c319c1f10c44fb7e8518edde8933ac">kVK_ANSI_2</a>                    = 0x13,
<a name="l00096"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4adf71ae819fe94a97bafc3d9250256b46">00096</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4adf71ae819fe94a97bafc3d9250256b46">kVK_ANSI_3</a>                    = 0x14,
<a name="l00097"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9c1e668ac5989ff6a19c686b24eb99ef">00097</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9c1e668ac5989ff6a19c686b24eb99ef">kVK_ANSI_4</a>                    = 0x15,
<a name="l00098"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a4a2fdff813e816445cfc90fd647e283f">00098</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a4a2fdff813e816445cfc90fd647e283f">kVK_ANSI_6</a>                    = 0x16,
<a name="l00099"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aeb86a5a1a7b577f07cc33f4b63975e94">00099</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aeb86a5a1a7b577f07cc33f4b63975e94">kVK_ANSI_5</a>                    = 0x17,
<a name="l00100"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aeb8ef8f63c358044ac092df642073b45">00100</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aeb8ef8f63c358044ac092df642073b45">kVK_ANSI_Equal</a>                = 0x18,
<a name="l00101"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a910881659ffd1b2cf9fadb19c2a09c38">00101</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a910881659ffd1b2cf9fadb19c2a09c38">kVK_ANSI_9</a>                    = 0x19,
<a name="l00102"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a1a6dd1960a175b658dd3071d43df6569">00102</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a1a6dd1960a175b658dd3071d43df6569">kVK_ANSI_7</a>                    = 0x1A,
<a name="l00103"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af95348f2eb699094bf61aba83783338b">00103</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af95348f2eb699094bf61aba83783338b">kVK_ANSI_Minus</a>                = 0x1B,
<a name="l00104"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a13dfbebfcefe775e5a4e36d71149ed11">00104</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a13dfbebfcefe775e5a4e36d71149ed11">kVK_ANSI_8</a>                    = 0x1C,
<a name="l00105"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a37ae961bc0d6075be0ba30e7e63262db">00105</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a37ae961bc0d6075be0ba30e7e63262db">kVK_ANSI_0</a>                    = 0x1D,
<a name="l00106"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a356fc6bc7299357740c2797af3ae6d45">00106</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a356fc6bc7299357740c2797af3ae6d45">kVK_ANSI_RightBracket</a>         = 0x1E,
<a name="l00107"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af062ed1ea8901211291dc95ef412f011">00107</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af062ed1ea8901211291dc95ef412f011">kVK_ANSI_O</a>                    = 0x1F,
<a name="l00108"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a28d514601a007a5bfb43a003707e0d74">00108</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a28d514601a007a5bfb43a003707e0d74">kVK_ANSI_U</a>                    = 0x20,
<a name="l00109"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a6e7312635729b932347b72954a130e11">00109</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a6e7312635729b932347b72954a130e11">kVK_ANSI_LeftBracket</a>          = 0x21,
<a name="l00110"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a3ed117609d653bbbf43ada068d370aa9">00110</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a3ed117609d653bbbf43ada068d370aa9">kVK_ANSI_I</a>                    = 0x22,
<a name="l00111"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a57c5fe56675d413d464b575e5759c8f0">00111</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a57c5fe56675d413d464b575e5759c8f0">kVK_ANSI_P</a>                    = 0x23,
<a name="l00112"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af7573c0a47a9fdcbdf56c45e6276fbb8">00112</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af7573c0a47a9fdcbdf56c45e6276fbb8">kVK_ANSI_L</a>                    = 0x25,
<a name="l00113"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a263b4e1336b7864f6231fcdd9453e0bc">00113</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a263b4e1336b7864f6231fcdd9453e0bc">kVK_ANSI_J</a>                    = 0x26,
<a name="l00114"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac65e7edea9dd43f3a2892f073f10753d">00114</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac65e7edea9dd43f3a2892f073f10753d">kVK_ANSI_Quote</a>                = 0x27,
<a name="l00115"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad8b3b878b0383edd3b8554bad61c4b42">00115</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad8b3b878b0383edd3b8554bad61c4b42">kVK_ANSI_K</a>                    = 0x28,
<a name="l00116"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a3b8a28bf5fd804384986903744328392">00116</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a3b8a28bf5fd804384986903744328392">kVK_ANSI_Semicolon</a>            = 0x29,
<a name="l00117"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a2acc99aed0fecd7d72a85ec8a5e4b0b4">00117</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a2acc99aed0fecd7d72a85ec8a5e4b0b4">kVK_ANSI_Backslash</a>            = 0x2A,
<a name="l00118"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a0e8713ffe5d4b9b976ff6df319def03e">00118</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a0e8713ffe5d4b9b976ff6df319def03e">kVK_ANSI_Comma</a>                = 0x2B,
<a name="l00119"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9fb8cf2cfbbf5dc742e34f83f8649bed">00119</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9fb8cf2cfbbf5dc742e34f83f8649bed">kVK_ANSI_Slash</a>                = 0x2C,
<a name="l00120"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a3010ece5bd232408a47b2e7fed997e40">00120</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a3010ece5bd232408a47b2e7fed997e40">kVK_ANSI_N</a>                    = 0x2D,
<a name="l00121"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a291fa3b7101aad3f4c40008e8cebb70f">00121</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a291fa3b7101aad3f4c40008e8cebb70f">kVK_ANSI_M</a>                    = 0x2E,
<a name="l00122"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a47b4ee2045805c42cecc79a181981310">00122</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a47b4ee2045805c42cecc79a181981310">kVK_ANSI_Period</a>               = 0x2F,
<a name="l00123"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad427c8e9c4df0fd53e278e4f53f70814">00123</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad427c8e9c4df0fd53e278e4f53f70814">kVK_ANSI_Grave</a>                = 0x32,
<a name="l00124"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ab12be47bab2ad8b0c8e5c44e7be0483a">00124</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ab12be47bab2ad8b0c8e5c44e7be0483a">kVK_ANSI_KeypadDecimal</a>        = 0x41,
<a name="l00125"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a5e2de106381a0e31193ab22251dd570f">00125</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a5e2de106381a0e31193ab22251dd570f">kVK_ANSI_KeypadMultiply</a>       = 0x43,
<a name="l00126"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4acc14afc1ffa8519bc2acb148626343dd">00126</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4acc14afc1ffa8519bc2acb148626343dd">kVK_ANSI_KeypadPlus</a>           = 0x45,
<a name="l00127"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ab9a0fdd3d0f95d3488832289e747cfd0">00127</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ab9a0fdd3d0f95d3488832289e747cfd0">kVK_ANSI_KeypadClear</a>          = 0x47,
<a name="l00128"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a85af69bc9adce062644cc0ce4b89b256">00128</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a85af69bc9adce062644cc0ce4b89b256">kVK_ANSI_KeypadDivide</a>         = 0x4B,
<a name="l00129"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a2f5d6de5b11f424a2a31954a780aae5d">00129</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a2f5d6de5b11f424a2a31954a780aae5d">kVK_ANSI_KeypadEnter</a>          = 0x4C,
<a name="l00130"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac740e216bba797ce833fef57d996a754">00130</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac740e216bba797ce833fef57d996a754">kVK_ANSI_KeypadMinus</a>          = 0x4E,
<a name="l00131"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad9da2087e6fbbd73eb597484e4e43847">00131</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ad9da2087e6fbbd73eb597484e4e43847">kVK_ANSI_KeypadEquals</a>         = 0x51,
<a name="l00132"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a0e11a81ffbbb3daeac82d338112d696a">00132</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a0e11a81ffbbb3daeac82d338112d696a">kVK_ANSI_Keypad0</a>              = 0x52,
<a name="l00133"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af706a61f740ec87aca6fe082f274f2ee">00133</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af706a61f740ec87aca6fe082f274f2ee">kVK_ANSI_Keypad1</a>              = 0x53,
<a name="l00134"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae232ed3364e0109dbf882234a586bf46">00134</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae232ed3364e0109dbf882234a586bf46">kVK_ANSI_Keypad2</a>              = 0x54,
<a name="l00135"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a37051131548c99d8680a6c1adfb3cd7f">00135</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a37051131548c99d8680a6c1adfb3cd7f">kVK_ANSI_Keypad3</a>              = 0x55,
<a name="l00136"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a705376f8b20785cc9b325f12c8e44437">00136</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a705376f8b20785cc9b325f12c8e44437">kVK_ANSI_Keypad4</a>              = 0x56,
<a name="l00137"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a25ac6a60dc0cad8b285c1cd1fc6e43fc">00137</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a25ac6a60dc0cad8b285c1cd1fc6e43fc">kVK_ANSI_Keypad5</a>              = 0x57,
<a name="l00138"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a708f1148fe49d8878a11266f5c58620c">00138</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a708f1148fe49d8878a11266f5c58620c">kVK_ANSI_Keypad6</a>              = 0x58,
<a name="l00139"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4abb335d1101585e2a5cbfa4bc86e7320a">00139</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4abb335d1101585e2a5cbfa4bc86e7320a">kVK_ANSI_Keypad7</a>              = 0x59,
<a name="l00140"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a54b8ff369ea9542bfc4afe6686c7278d">00140</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a54b8ff369ea9542bfc4afe6686c7278d">kVK_ANSI_Keypad8</a>              = 0x5B,
<a name="l00141"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac35a47e563f107d418ddcfa06d7dfa66">00141</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac35a47e563f107d418ddcfa06d7dfa66">kVK_ANSI_Keypad9</a>              = 0x5C
<a name="l00142"></a>00142 };
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="comment">/* keycodes for keys that are independent of keyboard layout*/</span>
<a name="l00145"></a>00145 <span class="keyword">enum</span> {
<a name="l00146"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa011046db08aa0e244bd31e606e14c44b">00146</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa011046db08aa0e244bd31e606e14c44b">kVK_Return</a>                    = 0x24,
<a name="l00147"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fad0a96619b5831be272a0df1e6ab07f1f">00147</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fad0a96619b5831be272a0df1e6ab07f1f">kVK_Tab</a>                       = 0x30,
<a name="l00148"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa95f18ccb755fe48f4cc2bf987c923e07">00148</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa95f18ccb755fe48f4cc2bf987c923e07">kVK_Space</a>                     = 0x31,
<a name="l00149"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fab0a616ae91d6beab53c553aad20cc1ed">00149</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fab0a616ae91d6beab53c553aad20cc1ed">kVK_Delete</a>                    = 0x33,
<a name="l00150"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa080afb95dd48bca263f6a7d48325b640">00150</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa080afb95dd48bca263f6a7d48325b640">kVK_Escape</a>                    = 0x35,
<a name="l00151"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fac8927a2e96e48250208e9d14798353f5">00151</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fac8927a2e96e48250208e9d14798353f5">kVK_Command</a>                   = 0x37,
<a name="l00152"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faa8a4545c5a73d80f5f73e400d56ebff4">00152</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faa8a4545c5a73d80f5f73e400d56ebff4">kVK_Shift</a>                     = 0x38,
<a name="l00153"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf817c7d552840c3a0bec905a958e89d2">00153</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf817c7d552840c3a0bec905a958e89d2">kVK_CapsLock</a>                  = 0x39,
<a name="l00154"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5309ca78ecf5fa9b4feee39a6adaf905">00154</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5309ca78ecf5fa9b4feee39a6adaf905">kVK_Option</a>                    = 0x3A,
<a name="l00155"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa0c92ac9fcbd168773648972ff74233b3">00155</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa0c92ac9fcbd168773648972ff74233b3">kVK_Control</a>                   = 0x3B,
<a name="l00156"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa634959dfc01df8e12c6a1b037e5021ac">00156</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa634959dfc01df8e12c6a1b037e5021ac">kVK_RightShift</a>                = 0x3C,
<a name="l00157"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faaf24decd939ef76201c21d944f781be0">00157</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faaf24decd939ef76201c21d944f781be0">kVK_RightOption</a>               = 0x3D,
<a name="l00158"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa955ada116280c6979e767bbe62785f8f">00158</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa955ada116280c6979e767bbe62785f8f">kVK_RightControl</a>              = 0x3E,
<a name="l00159"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa594cab414c3998071bc008b92fc28dcb">00159</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa594cab414c3998071bc008b92fc28dcb">kVK_Function</a>                  = 0x3F,
<a name="l00160"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa25ec189955420f7c0fad2a51ff629016">00160</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa25ec189955420f7c0fad2a51ff629016">kVK_F17</a>                       = 0x40,
<a name="l00161"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3facde2649a03260f1d8b715f447784887c">00161</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3facde2649a03260f1d8b715f447784887c">kVK_VolumeUp</a>                  = 0x48,
<a name="l00162"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa3e2eddf3d095c6a3217452f37684a59f">00162</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa3e2eddf3d095c6a3217452f37684a59f">kVK_VolumeDown</a>                = 0x49,
<a name="l00163"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafcf478a05864e313d38ee7d038d08ac4">00163</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafcf478a05864e313d38ee7d038d08ac4">kVK_Mute</a>                      = 0x4A,
<a name="l00164"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fae53ac9a61f802fe14153a2b1296663d3">00164</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fae53ac9a61f802fe14153a2b1296663d3">kVK_F18</a>                       = 0x4F,
<a name="l00165"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa651ed24fc44a3bcd570bced8ecd9abcb">00165</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa651ed24fc44a3bcd570bced8ecd9abcb">kVK_F19</a>                       = 0x50,
<a name="l00166"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf4658144feeba98c7e65631d49b8b327">00166</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf4658144feeba98c7e65631d49b8b327">kVK_F20</a>                       = 0x5A,
<a name="l00167"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5098fb1a448b3e6037135d986a438b05">00167</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5098fb1a448b3e6037135d986a438b05">kVK_F5</a>                        = 0x60,
<a name="l00168"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa710aa343f44cc3ccd8f42a45e12902b4">00168</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa710aa343f44cc3ccd8f42a45e12902b4">kVK_F6</a>                        = 0x61,
<a name="l00169"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa305e266f0ff26c24add1f553dd61251c">00169</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa305e266f0ff26c24add1f553dd61251c">kVK_F7</a>                        = 0x62,
<a name="l00170"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa8e3fba29637690b5d39536ace39a5eb8">00170</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa8e3fba29637690b5d39536ace39a5eb8">kVK_F3</a>                        = 0x63,
<a name="l00171"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa875c48ad9a372f3830d59454cfd05353">00171</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa875c48ad9a372f3830d59454cfd05353">kVK_F8</a>                        = 0x64,
<a name="l00172"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa791b7ed7d649936afa0165116b10efb4">00172</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa791b7ed7d649936afa0165116b10efb4">kVK_F9</a>                        = 0x65,
<a name="l00173"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa45be9da91dc9df47c7d01164b9b13372">00173</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa45be9da91dc9df47c7d01164b9b13372">kVK_F11</a>                       = 0x67,
<a name="l00174"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa21f78ffbda11c768bfb72174073ad68a">00174</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa21f78ffbda11c768bfb72174073ad68a">kVK_F13</a>                       = 0x69,
<a name="l00175"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa4064b2b15799b6e5bc8e75cd1af29d55">00175</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa4064b2b15799b6e5bc8e75cd1af29d55">kVK_F16</a>                       = 0x6A,
<a name="l00176"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa8ab22b293cac94613930a54330400d53">00176</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa8ab22b293cac94613930a54330400d53">kVK_F14</a>                       = 0x6B,
<a name="l00177"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fac8a49f97dac9e2875be20bf4bf71e876">00177</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fac8a49f97dac9e2875be20bf4bf71e876">kVK_F10</a>                       = 0x6D,
<a name="l00178"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafa1ab5509cad8908658663ea470f4598">00178</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafa1ab5509cad8908658663ea470f4598">kVK_F12</a>                       = 0x6F,
<a name="l00179"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fae83b9e5a1ac0addd1f984df6ca08c8b0">00179</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fae83b9e5a1ac0addd1f984df6ca08c8b0">kVK_F15</a>                       = 0x71,
<a name="l00180"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa6ac8b555490705e1f90315625aec09a5">00180</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa6ac8b555490705e1f90315625aec09a5">kVK_Help</a>                      = 0x72,
<a name="l00181"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa83eaeb7b5ccce7474f53df658c4976bb">00181</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa83eaeb7b5ccce7474f53df658c4976bb">kVK_Home</a>                      = 0x73,
<a name="l00182"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa85f6779648b3153b259d7a84401f47b7">00182</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa85f6779648b3153b259d7a84401f47b7">kVK_PageUp</a>                    = 0x74,
<a name="l00183"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf65ea70cd849236c6b66edba1fd873df">00183</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf65ea70cd849236c6b66edba1fd873df">kVK_ForwardDelete</a>             = 0x75,
<a name="l00184"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa6afa8477ebcde18c9001511b445d9db9">00184</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa6afa8477ebcde18c9001511b445d9db9">kVK_F4</a>                        = 0x76,
<a name="l00185"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa0cbee532755557975ab3109ca8b99700">00185</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa0cbee532755557975ab3109ca8b99700">kVK_End</a>                       = 0x77,
<a name="l00186"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafdb9a0e424bd228df5d462c3cbe0ae11">00186</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafdb9a0e424bd228df5d462c3cbe0ae11">kVK_F2</a>                        = 0x78,
<a name="l00187"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa3ad7ddf850914b5bf266fac671fd3858">00187</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa3ad7ddf850914b5bf266fac671fd3858">kVK_PageDown</a>                  = 0x79,
<a name="l00188"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5ba91928b58e03dd98b8f930145f9bda">00188</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5ba91928b58e03dd98b8f930145f9bda">kVK_F1</a>                        = 0x7A,
<a name="l00189"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafb6d16c7d344a90c7e2d9a6751c308c2">00189</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafb6d16c7d344a90c7e2d9a6751c308c2">kVK_LeftArrow</a>                 = 0x7B,
<a name="l00190"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa91d95d86ec3b8e29ed9df71dc8fe434a">00190</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa91d95d86ec3b8e29ed9df71dc8fe434a">kVK_RightArrow</a>                = 0x7C,
<a name="l00191"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faa4d45e99669116137b2b6480aa6292c7">00191</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faa4d45e99669116137b2b6480aa6292c7">kVK_DownArrow</a>                 = 0x7D,
<a name="l00192"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa7cd6a91ea4d66f8ebc3753057b116df3">00192</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa7cd6a91ea4d66f8ebc3753057b116df3">kVK_UpArrow</a>                   = 0x7E
<a name="l00193"></a>00193 };
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="comment">/* ISO keyboards only*/</span>
<a name="l00196"></a>00196 <span class="keyword">enum</span> {
<a name="l00197"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3e279efabf854742684341c3e4f50d31a07c7dfbd65b47974b2aec6ada20bbb1b">00197</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3e279efabf854742684341c3e4f50d31a07c7dfbd65b47974b2aec6ada20bbb1b">kVK_ISO_Section</a>               = 0x0A
<a name="l00198"></a>00198 };
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="comment">/* JIS keyboards only*/</span>
<a name="l00201"></a>00201 <span class="keyword">enum</span> {
<a name="l00202"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12a767c35c5ea84ce240c19d1a26220dab6">00202</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12a767c35c5ea84ce240c19d1a26220dab6">kVK_JIS_Yen</a>                   = 0x5D,
<a name="l00203"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12a21c388abc958a9f2723667fd334a267a">00203</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12a21c388abc958a9f2723667fd334a267a">kVK_JIS_Underscore</a>            = 0x5E,
<a name="l00204"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12a9c3a21c1693f810cad3386cef42db551">00204</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12a9c3a21c1693f810cad3386cef42db551">kVK_JIS_KeypadComma</a>           = 0x5F,
<a name="l00205"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12ab9c177458cc39ba97ab7ad363f9094b1">00205</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12ab9c177458cc39ba97ab7ad363f9094b1">kVK_JIS_Eisu</a>                  = 0x66,
<a name="l00206"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12aa26d80ec48b4eeff7372444d9d6313c3">00206</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3d3667ada0f76359974e3bdb799ada12aa26d80ec48b4eeff7372444d9d6313c3">kVK_JIS_Kana</a>                  = 0x68
<a name="l00207"></a>00207 };
<a name="l00208"></a>00208 <span class="preprocessor">#endif</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>
<a name="l00210"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a26193f365720f04e3370da2808ea0e5a">00210</a> <span class="keyword">static</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260d">GHOST_TButtonMask</a> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a26193f365720f04e3370da2808ea0e5a">convertButton</a>(<span class="keywordtype">int</span> button)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212     <span class="keywordflow">switch</span> (button) {
<a name="l00213"></a>00213         <span class="keywordflow">case</span> 0:
<a name="l00214"></a>00214             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da62a24d5e11509c7de7c8a8344f779095">GHOST_kButtonMaskLeft</a>;
<a name="l00215"></a>00215         <span class="keywordflow">case</span> 1:
<a name="l00216"></a>00216             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da1747b8b44cf3420bf6c700c8ea82a29f">GHOST_kButtonMaskRight</a>;
<a name="l00217"></a>00217         <span class="keywordflow">case</span> 2:
<a name="l00218"></a>00218             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260dafb5eeabc12ff6497bbb6a2de840f5039">GHOST_kButtonMaskMiddle</a>;
<a name="l00219"></a>00219         <span class="keywordflow">case</span> 3:
<a name="l00220"></a>00220             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da291ea64b62e0472bc7df938ebc48da92">GHOST_kButtonMaskButton4</a>;
<a name="l00221"></a>00221         <span class="keywordflow">case</span> 4:
<a name="l00222"></a>00222             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260dad53c3f1929e96f38b815b0bd5b43dc2a">GHOST_kButtonMaskButton5</a>;
<a name="l00223"></a>00223         <span class="keywordflow">default</span>:
<a name="l00224"></a>00224             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da62a24d5e11509c7de7c8a8344f779095">GHOST_kButtonMaskLeft</a>;
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00235"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a4a094a504d1fcc42103167f4b83d2d02">00235</a> <span class="keyword">static</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7">GHOST_TKey</a> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a4a094a504d1fcc42103167f4b83d2d02">convertKey</a>(<span class="keywordtype">int</span> rawCode, unichar recvChar, UInt16 keyAction) 
<a name="l00236"></a>00236 {   
<a name="l00237"></a>00237     
<a name="l00238"></a>00238     <span class="comment">//printf(&quot;\nrecvchar %c 0x%x&quot;,recvChar,recvChar);</span>
<a name="l00239"></a>00239     <span class="keywordflow">switch</span> (rawCode) {
<a name="l00240"></a>00240         <span class="comment">/*Physical keycodes not used due to map changes in int&#39;l keyboards</span>
<a name="l00241"></a>00241 <span class="comment">        case kVK_ANSI_A:    return GHOST_kKeyA;</span>
<a name="l00242"></a>00242 <span class="comment">        case kVK_ANSI_B:    return GHOST_kKeyB;</span>
<a name="l00243"></a>00243 <span class="comment">        case kVK_ANSI_C:    return GHOST_kKeyC;</span>
<a name="l00244"></a>00244 <span class="comment">        case kVK_ANSI_D:    return GHOST_kKeyD;</span>
<a name="l00245"></a>00245 <span class="comment">        case kVK_ANSI_E:    return GHOST_kKeyE;</span>
<a name="l00246"></a>00246 <span class="comment">        case kVK_ANSI_F:    return GHOST_kKeyF;</span>
<a name="l00247"></a>00247 <span class="comment">        case kVK_ANSI_G:    return GHOST_kKeyG;</span>
<a name="l00248"></a>00248 <span class="comment">        case kVK_ANSI_H:    return GHOST_kKeyH;</span>
<a name="l00249"></a>00249 <span class="comment">        case kVK_ANSI_I:    return GHOST_kKeyI;</span>
<a name="l00250"></a>00250 <span class="comment">        case kVK_ANSI_J:    return GHOST_kKeyJ;</span>
<a name="l00251"></a>00251 <span class="comment">        case kVK_ANSI_K:    return GHOST_kKeyK;</span>
<a name="l00252"></a>00252 <span class="comment">        case kVK_ANSI_L:    return GHOST_kKeyL;</span>
<a name="l00253"></a>00253 <span class="comment">        case kVK_ANSI_M:    return GHOST_kKeyM;</span>
<a name="l00254"></a>00254 <span class="comment">        case kVK_ANSI_N:    return GHOST_kKeyN;</span>
<a name="l00255"></a>00255 <span class="comment">        case kVK_ANSI_O:    return GHOST_kKeyO;</span>
<a name="l00256"></a>00256 <span class="comment">        case kVK_ANSI_P:    return GHOST_kKeyP;</span>
<a name="l00257"></a>00257 <span class="comment">        case kVK_ANSI_Q:    return GHOST_kKeyQ;</span>
<a name="l00258"></a>00258 <span class="comment">        case kVK_ANSI_R:    return GHOST_kKeyR;</span>
<a name="l00259"></a>00259 <span class="comment">        case kVK_ANSI_S:    return GHOST_kKeyS;</span>
<a name="l00260"></a>00260 <span class="comment">        case kVK_ANSI_T:    return GHOST_kKeyT;</span>
<a name="l00261"></a>00261 <span class="comment">        case kVK_ANSI_U:    return GHOST_kKeyU;</span>
<a name="l00262"></a>00262 <span class="comment">        case kVK_ANSI_V:    return GHOST_kKeyV;</span>
<a name="l00263"></a>00263 <span class="comment">        case kVK_ANSI_W:    return GHOST_kKeyW;</span>
<a name="l00264"></a>00264 <span class="comment">        case kVK_ANSI_X:    return GHOST_kKeyX;</span>
<a name="l00265"></a>00265 <span class="comment">        case kVK_ANSI_Y:    return GHOST_kKeyY;</span>
<a name="l00266"></a>00266 <span class="comment">        case kVK_ANSI_Z:    return GHOST_kKeyZ;*/</span>
<a name="l00267"></a>00267         
<a name="l00268"></a>00268         <span class="comment">/* Numbers keys mapped to handle some int&#39;l keyboard (e.g. French)*/</span>
<a name="l00269"></a>00269         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3e279efabf854742684341c3e4f50d31a07c7dfbd65b47974b2aec6ada20bbb1b">kVK_ISO_Section</a>: <span class="keywordflow">return</span>    <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ad71952f1163a7812cdf06fa2dd20a081">GHOST_kKeyUnknown</a>;
<a name="l00270"></a>00270         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aafc7db2b790895d89d3c1055eb63a04d">kVK_ANSI_1</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a6fd4af9737bb6f50020530144e0b209f">GHOST_kKey1</a>;
<a name="l00271"></a>00271         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a88c319c1f10c44fb7e8518edde8933ac">kVK_ANSI_2</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aca1b9409628d610b08f8310d47196479">GHOST_kKey2</a>;
<a name="l00272"></a>00272         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4adf71ae819fe94a97bafc3d9250256b46">kVK_ANSI_3</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a22ffbc09df070f732530ca402bdcdd4b">GHOST_kKey3</a>;
<a name="l00273"></a>00273         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a9c1e668ac5989ff6a19c686b24eb99ef">kVK_ANSI_4</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a13029ac19b1dd635c0b1873e82196f35">GHOST_kKey4</a>;
<a name="l00274"></a>00274         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4aeb86a5a1a7b577f07cc33f4b63975e94">kVK_ANSI_5</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a0cd4a657449e3624bdcfd05000b23681">GHOST_kKey5</a>;
<a name="l00275"></a>00275         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a4a2fdff813e816445cfc90fd647e283f">kVK_ANSI_6</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a3e339551edfe56a5ccda38f63fd49d1a">GHOST_kKey6</a>;
<a name="l00276"></a>00276         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a1a6dd1960a175b658dd3071d43df6569">kVK_ANSI_7</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa5cd9b2a137445ced1d3594372f5c1ad">GHOST_kKey7</a>;
<a name="l00277"></a>00277         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a13dfbebfcefe775e5a4e36d71149ed11">kVK_ANSI_8</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a733cb0803aeb155463bab5d28775988c">GHOST_kKey8</a>;
<a name="l00278"></a>00278         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a910881659ffd1b2cf9fadb19c2a09c38">kVK_ANSI_9</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa1dfc9eff0a4ab08e831588557bec705">GHOST_kKey9</a>;
<a name="l00279"></a>00279         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a37ae961bc0d6075be0ba30e7e63262db">kVK_ANSI_0</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a46b468be9b573203e874789e3f976c5e">GHOST_kKey0</a>;
<a name="l00280"></a>00280     
<a name="l00281"></a>00281         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a0e11a81ffbbb3daeac82d338112d696a">kVK_ANSI_Keypad0</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7abc3c193ef98a03a520af67ed6ef353bc">GHOST_kKeyNumpad0</a>;
<a name="l00282"></a>00282         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4af706a61f740ec87aca6fe082f274f2ee">kVK_ANSI_Keypad1</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a177fb262f3b28b6b704bd247dbb82010">GHOST_kKeyNumpad1</a>;
<a name="l00283"></a>00283         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ae232ed3364e0109dbf882234a586bf46">kVK_ANSI_Keypad2</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a8900011ba32dcb7d6e87bd5552247bfe">GHOST_kKeyNumpad2</a>;
<a name="l00284"></a>00284         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a37051131548c99d8680a6c1adfb3cd7f">kVK_ANSI_Keypad3</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a149d30d9a06d0cc4bae808a72847676e">GHOST_kKeyNumpad3</a>;
<a name="l00285"></a>00285         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a705376f8b20785cc9b325f12c8e44437">kVK_ANSI_Keypad4</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a305b7bb137abe351641254354c3a7ff2">GHOST_kKeyNumpad4</a>;
<a name="l00286"></a>00286         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a25ac6a60dc0cad8b285c1cd1fc6e43fc">kVK_ANSI_Keypad5</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa303f953324b0a3d4e6bd13f857df868">GHOST_kKeyNumpad5</a>;
<a name="l00287"></a>00287         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a708f1148fe49d8878a11266f5c58620c">kVK_ANSI_Keypad6</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab149ecd604f253a9319dc2ba1ae1f13f">GHOST_kKeyNumpad6</a>;
<a name="l00288"></a>00288         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4abb335d1101585e2a5cbfa4bc86e7320a">kVK_ANSI_Keypad7</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aceb67e473e7ab511b607b0c8834f7fbe">GHOST_kKeyNumpad7</a>;
<a name="l00289"></a>00289         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a54b8ff369ea9542bfc4afe6686c7278d">kVK_ANSI_Keypad8</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab391ce367eda7ff2482b677282a26651">GHOST_kKeyNumpad8</a>;
<a name="l00290"></a>00290         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac35a47e563f107d418ddcfa06d7dfa66">kVK_ANSI_Keypad9</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab5668e32465452848cff1711931acc85">GHOST_kKeyNumpad9</a>;
<a name="l00291"></a>00291         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ab12be47bab2ad8b0c8e5c44e7be0483a">kVK_ANSI_KeypadDecimal</a>:    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a5bad1217530b7244fd5c62b79f0aaa04">GHOST_kKeyNumpadPeriod</a>;
<a name="l00292"></a>00292         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a2f5d6de5b11f424a2a31954a780aae5d">kVK_ANSI_KeypadEnter</a>:      <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aeab93db4f40c58eb7ba22d50aec6a24c">GHOST_kKeyNumpadEnter</a>;
<a name="l00293"></a>00293         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4acc14afc1ffa8519bc2acb148626343dd">kVK_ANSI_KeypadPlus</a>:       <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a9d3f8794e011f802893b0662c77b08bf">GHOST_kKeyNumpadPlus</a>;
<a name="l00294"></a>00294         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ac740e216bba797ce833fef57d996a754">kVK_ANSI_KeypadMinus</a>:      <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aeb4ea38d753dd07dbde1fe37a20dcc5b">GHOST_kKeyNumpadMinus</a>;
<a name="l00295"></a>00295         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a5e2de106381a0e31193ab22251dd570f">kVK_ANSI_KeypadMultiply</a>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a62c5d196b2633b2fbcd3600eec588587">GHOST_kKeyNumpadAsterisk</a>;
<a name="l00296"></a>00296         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4a85af69bc9adce062644cc0ce4b89b256">kVK_ANSI_KeypadDivide</a>:     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a2b3f1baa5e7df092004744e9de1ccff8">GHOST_kKeyNumpadSlash</a>;
<a name="l00297"></a>00297         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a87d22175c5de65fbe6a0b3b53305dee4ab9a0fdd3d0f95d3488832289e747cfd0">kVK_ANSI_KeypadClear</a>:      <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ad71952f1163a7812cdf06fa2dd20a081">GHOST_kKeyUnknown</a>;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5ba91928b58e03dd98b8f930145f9bda">kVK_F1</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a5fb355cab438db46ea799559234b8a98">GHOST_kKeyF1</a>;
<a name="l00300"></a>00300         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafdb9a0e424bd228df5d462c3cbe0ae11">kVK_F2</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7af03e83a1b25df4e9315039d7b68e0b23">GHOST_kKeyF2</a>;
<a name="l00301"></a>00301         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa8e3fba29637690b5d39536ace39a5eb8">kVK_F3</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aef621c437b58278415b129af3b3e9b08">GHOST_kKeyF3</a>;
<a name="l00302"></a>00302         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa6afa8477ebcde18c9001511b445d9db9">kVK_F4</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7af8620369ca381f0b136f262c0513f6c6">GHOST_kKeyF4</a>;
<a name="l00303"></a>00303         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa5098fb1a448b3e6037135d986a438b05">kVK_F5</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a47212828ed9e9679b383173b0b8d44cf">GHOST_kKeyF5</a>;
<a name="l00304"></a>00304         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa710aa343f44cc3ccd8f42a45e12902b4">kVK_F6</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a2ece30cdf7b0066793098bf07784c093">GHOST_kKeyF6</a>;
<a name="l00305"></a>00305         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa305e266f0ff26c24add1f553dd61251c">kVK_F7</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ae50dabee4970aa2a3cc26a6281a989f7">GHOST_kKeyF7</a>;
<a name="l00306"></a>00306         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa875c48ad9a372f3830d59454cfd05353">kVK_F8</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa95f0e7db1d0feca049343ab3d3d5d27">GHOST_kKeyF8</a>;
<a name="l00307"></a>00307         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa791b7ed7d649936afa0165116b10efb4">kVK_F9</a>:                <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a24e44e47c1038499725b5de72c465cfd">GHOST_kKeyF9</a>;
<a name="l00308"></a>00308         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fac8a49f97dac9e2875be20bf4bf71e876">kVK_F10</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aee76f8208b44cab5e311d03fbfd5e69f">GHOST_kKeyF10</a>;
<a name="l00309"></a>00309         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa45be9da91dc9df47c7d01164b9b13372">kVK_F11</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a308ac716a688eda4b36a9d88d8a3ce53">GHOST_kKeyF11</a>;
<a name="l00310"></a>00310         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafa1ab5509cad8908658663ea470f4598">kVK_F12</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a5f1c9b8723111a1ce5a74007a9add185">GHOST_kKeyF12</a>;
<a name="l00311"></a>00311         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa21f78ffbda11c768bfb72174073ad68a">kVK_F13</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a2e077340acbb790a804ef9fb7a2397a1">GHOST_kKeyF13</a>;
<a name="l00312"></a>00312         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa8ab22b293cac94613930a54330400d53">kVK_F14</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab194132272ac374f6b4cd0651bf9155f">GHOST_kKeyF14</a>;
<a name="l00313"></a>00313         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fae83b9e5a1ac0addd1f984df6ca08c8b0">kVK_F15</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab7a10c1cfe7bd845ab0890b4685951b4">GHOST_kKeyF15</a>;
<a name="l00314"></a>00314         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa4064b2b15799b6e5bc8e75cd1af29d55">kVK_F16</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7abad5daa234897fcfcd19a4e036333b27">GHOST_kKeyF16</a>;
<a name="l00315"></a>00315         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa25ec189955420f7c0fad2a51ff629016">kVK_F17</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa3e8b2be98153424b3e4a54dccdcb511">GHOST_kKeyF17</a>;
<a name="l00316"></a>00316         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fae53ac9a61f802fe14153a2b1296663d3">kVK_F18</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aaef1e6efe54a4aedf25a34c32917806c">GHOST_kKeyF18</a>;
<a name="l00317"></a>00317         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa651ed24fc44a3bcd570bced8ecd9abcb">kVK_F19</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a479114f9f15b5442b84363d761b69e75">GHOST_kKeyF19</a>;
<a name="l00318"></a>00318         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf4658144feeba98c7e65631d49b8b327">kVK_F20</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a298a82af12571215e54ebde9b6b50c98">GHOST_kKeyF20</a>;
<a name="l00319"></a>00319             
<a name="l00320"></a>00320         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa7cd6a91ea4d66f8ebc3753057b116df3">kVK_UpArrow</a>:           <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab82065f2dffda9b9ca8cda6495c5e134">GHOST_kKeyUpArrow</a>;
<a name="l00321"></a>00321         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faa4d45e99669116137b2b6480aa6292c7">kVK_DownArrow</a>:         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a5187e67847a5cd7762c54f1cc12051b9">GHOST_kKeyDownArrow</a>;
<a name="l00322"></a>00322         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafb6d16c7d344a90c7e2d9a6751c308c2">kVK_LeftArrow</a>:         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa365d72dfc3dba0c8081455a57d372ac">GHOST_kKeyLeftArrow</a>;
<a name="l00323"></a>00323         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa91d95d86ec3b8e29ed9df71dc8fe434a">kVK_RightArrow</a>:        <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a2c62a62f8ae33d172a47eb1be9e15c96">GHOST_kKeyRightArrow</a>;
<a name="l00324"></a>00324             
<a name="l00325"></a>00325         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa011046db08aa0e244bd31e606e14c44b">kVK_Return</a>:            <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a28485b67cd039df93d9bb057e2f5882f">GHOST_kKeyEnter</a>;
<a name="l00326"></a>00326         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fab0a616ae91d6beab53c553aad20cc1ed">kVK_Delete</a>:            <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a459f5439691a6bb7f56352e660dc8520">GHOST_kKeyBackSpace</a>;
<a name="l00327"></a>00327         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3faf65ea70cd849236c6b66edba1fd873df">kVK_ForwardDelete</a>:     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab9d83696b88446c1ba09e33bf3cf22cd">GHOST_kKeyDelete</a>;
<a name="l00328"></a>00328         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa080afb95dd48bca263f6a7d48325b640">kVK_Escape</a>:            <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ad67892cf266ddee19b73cdba119b0bec">GHOST_kKeyEsc</a>;
<a name="l00329"></a>00329         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fad0a96619b5831be272a0df1e6ab07f1f">kVK_Tab</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a70f0adece896e1d47c451d92c055fac9">GHOST_kKeyTab</a>;
<a name="l00330"></a>00330         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa95f18ccb755fe48f4cc2bf987c923e07">kVK_Space</a>:             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7afd992670b632d231c5116190f1667b66">GHOST_kKeySpace</a>;
<a name="l00331"></a>00331             
<a name="l00332"></a>00332         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa83eaeb7b5ccce7474f53df658c4976bb">kVK_Home</a>:              <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab09623721e6989f5b9a1f46466309fb7">GHOST_kKeyHome</a>;
<a name="l00333"></a>00333         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa0cbee532755557975ab3109ca8b99700">kVK_End</a>:               <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ab813a21b41a284f7cec941d62715ee9e">GHOST_kKeyEnd</a>;
<a name="l00334"></a>00334         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa85f6779648b3153b259d7a84401f47b7">kVK_PageUp</a>:            <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa1c04a0e7bbd6662df4787ad0402e310">GHOST_kKeyUpPage</a>;
<a name="l00335"></a>00335         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa3ad7ddf850914b5bf266fac671fd3858">kVK_PageDown</a>:          <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a4dd8d9b10464b972802e0684cf36f214">GHOST_kKeyDownPage</a>;
<a name="l00336"></a>00336             
<a name="l00337"></a>00337         <span class="comment">/*case kVK_ANSI_Minus:      return GHOST_kKeyMinus;</span>
<a name="l00338"></a>00338 <span class="comment">        case kVK_ANSI_Equal:        return GHOST_kKeyEqual;</span>
<a name="l00339"></a>00339 <span class="comment">        case kVK_ANSI_Comma:        return GHOST_kKeyComma;</span>
<a name="l00340"></a>00340 <span class="comment">        case kVK_ANSI_Period:       return GHOST_kKeyPeriod;</span>
<a name="l00341"></a>00341 <span class="comment">        case kVK_ANSI_Slash:        return GHOST_kKeySlash;</span>
<a name="l00342"></a>00342 <span class="comment">        case kVK_ANSI_Semicolon:    return GHOST_kKeySemicolon;</span>
<a name="l00343"></a>00343 <span class="comment">        case kVK_ANSI_Quote:        return GHOST_kKeyQuote;</span>
<a name="l00344"></a>00344 <span class="comment">        case kVK_ANSI_Backslash:    return GHOST_kKeyBackslash;</span>
<a name="l00345"></a>00345 <span class="comment">        case kVK_ANSI_LeftBracket:  return GHOST_kKeyLeftBracket;</span>
<a name="l00346"></a>00346 <span class="comment">        case kVK_ANSI_RightBracket: return GHOST_kKeyRightBracket;</span>
<a name="l00347"></a>00347 <span class="comment">        case kVK_ANSI_Grave:        return GHOST_kKeyAccentGrave;*/</span>
<a name="l00348"></a>00348             
<a name="l00349"></a>00349         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3facde2649a03260f1d8b715f447784887c">kVK_VolumeUp</a>:
<a name="l00350"></a>00350         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fa3e2eddf3d095c6a3217452f37684a59f">kVK_VolumeDown</a>:
<a name="l00351"></a>00351         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a2ed332df4696233768771e93d4081c3fafcf478a05864e313d38ee7d038d08ac4">kVK_Mute</a>:
<a name="l00352"></a>00352             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ad71952f1163a7812cdf06fa2dd20a081">GHOST_kKeyUnknown</a>;
<a name="l00353"></a>00353             
<a name="l00354"></a>00354         <span class="keywordflow">default</span>:
<a name="l00355"></a>00355             <span class="comment">/* alphanumerical or punctuation key that is remappable in int&#39;l keyboards */</span>
<a name="l00356"></a>00356             <span class="keywordflow">if</span> ((recvChar &gt;= <span class="charliteral">&#39;A&#39;</span>) &amp;&amp; (recvChar &lt;= <span class="charliteral">&#39;Z&#39;</span>)) {
<a name="l00357"></a>00357                 <span class="keywordflow">return</span> (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7">GHOST_TKey</a>) (recvChar - <span class="charliteral">&#39;A&#39;</span> + <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ac738a848a1ce0727576895b6774f896c">GHOST_kKeyA</a>);
<a name="l00358"></a>00358             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((recvChar &gt;= <span class="charliteral">&#39;a&#39;</span>) &amp;&amp; (recvChar &lt;= <span class="charliteral">&#39;z&#39;</span>)) {
<a name="l00359"></a>00359                 <span class="keywordflow">return</span> (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7">GHOST_TKey</a>) (recvChar - <span class="charliteral">&#39;a&#39;</span> + <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ac738a848a1ce0727576895b6774f896c">GHOST_kKeyA</a>);
<a name="l00360"></a>00360             } <span class="keywordflow">else</span> {
<a name="l00361"></a>00361 <span class="preprocessor">#if MAC_OS_X_VERSION_MIN_REQUIRED &lt;= MAC_OS_X_VERSION_10_4</span>
<a name="l00362"></a>00362 <span class="preprocessor"></span>                KeyboardLayoutRef keyLayout;
<a name="l00363"></a>00363                 UCKeyboardLayout *uchrData;
<a name="l00364"></a>00364                 
<a name="l00365"></a>00365                 KLGetCurrentKeyboardLayout(&amp;keyLayout);
<a name="l00366"></a>00366                 KLGetKeyboardLayoutProperty(keyLayout, kKLuchrData, (<span class="keyword">const</span> <span class="keywordtype">void</span> **)
<a name="l00367"></a>00367                                             &amp;uchrData);
<a name="l00368"></a>00368                 <span class="comment">/*get actual character value of the &quot;remappable&quot; keys in int&#39;l keyboards,</span>
<a name="l00369"></a>00369 <span class="comment">                 if keyboard layout is not correctly reported (e.g. some non Apple keyboards in Tiger),</span>
<a name="l00370"></a>00370 <span class="comment">                 then fallback on using the received charactersIgnoringModifiers */</span>
<a name="l00371"></a>00371                 <span class="keywordflow">if</span> (uchrData)
<a name="l00372"></a>00372                 {
<a name="l00373"></a>00373                     UInt32 deadKeyState=0;
<a name="l00374"></a>00374                     UniCharCount actualStrLength=0;
<a name="l00375"></a>00375                     
<a name="l00376"></a>00376                     UCKeyTranslate(uchrData, rawCode, keyAction, 0,
<a name="l00377"></a>00377                                    LMGetKbdType(), kUCKeyTranslateNoDeadKeysBit, &amp;deadKeyState, 1, &amp;actualStrLength, &amp;recvChar);
<a name="l00378"></a>00378                     
<a name="l00379"></a>00379                 }               
<a name="l00380"></a>00380 <span class="preprocessor">#else</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span>                <span class="comment">/* Leopard and Snow Leopard 64bit compatible API*/</span>
<a name="l00382"></a>00382                 CFDataRef uchrHandle; <span class="comment">/*the keyboard layout*/</span>
<a name="l00383"></a>00383                 TISInputSourceRef kbdTISHandle;
<a name="l00384"></a>00384                 
<a name="l00385"></a>00385                 kbdTISHandle = TISCopyCurrentKeyboardLayoutInputSource();
<a name="l00386"></a>00386                 uchrHandle = (CFDataRef)TISGetInputSourceProperty(kbdTISHandle,kTISPropertyUnicodeKeyLayoutData);
<a name="l00387"></a>00387                 CFRelease(kbdTISHandle);
<a name="l00388"></a>00388                 
<a name="l00389"></a>00389                 <span class="comment">/*get actual character value of the &quot;remappable&quot; keys in int&#39;l keyboards,</span>
<a name="l00390"></a>00390 <span class="comment">                 if keyboard layout is not correctly reported (e.g. some non Apple keyboards in Tiger),</span>
<a name="l00391"></a>00391 <span class="comment">                 then fallback on using the received charactersIgnoringModifiers */</span>
<a name="l00392"></a>00392                 <span class="keywordflow">if</span> (uchrHandle)
<a name="l00393"></a>00393                 {
<a name="l00394"></a>00394                     UInt32 deadKeyState=0;
<a name="l00395"></a>00395                     UniCharCount actualStrLength=0;
<a name="l00396"></a>00396                     
<a name="l00397"></a>00397                     UCKeyTranslate((UCKeyboardLayout*)CFDataGetBytePtr(uchrHandle), rawCode, keyAction, 0,
<a name="l00398"></a>00398                                    LMGetKbdType(), kUCKeyTranslateNoDeadKeysBit, &amp;deadKeyState, 1, &amp;actualStrLength, &amp;recvChar);
<a name="l00399"></a>00399                     
<a name="l00400"></a>00400                 }
<a name="l00401"></a>00401 <span class="preprocessor">#endif</span>
<a name="l00402"></a>00402 <span class="preprocessor"></span>                <span class="keywordflow">switch</span> (recvChar) {
<a name="l00403"></a>00403                     <span class="keywordflow">case</span> <span class="charliteral">&#39;-&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a3d57ea96a7499d318d2edb8518b9d6e9">GHOST_kKeyMinus</a>;
<a name="l00404"></a>00404                     <span class="keywordflow">case</span> <span class="charliteral">&#39;=&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aa56e5e5ccc47f4c657810a3a464e44e7">GHOST_kKeyEqual</a>;
<a name="l00405"></a>00405                     <span class="keywordflow">case</span> <span class="charliteral">&#39;,&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a76fd6a1b4174261d6bb64e15216e386b">GHOST_kKeyComma</a>;
<a name="l00406"></a>00406                     <span class="keywordflow">case</span> <span class="charliteral">&#39;.&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a9582d50457a60ed40e15e98ba52e61d2">GHOST_kKeyPeriod</a>;
<a name="l00407"></a>00407                     <span class="keywordflow">case</span> <span class="charliteral">&#39;/&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ad992130897953745809794ecb6c9d0ff">GHOST_kKeySlash</a>;
<a name="l00408"></a>00408                     <span class="keywordflow">case</span> <span class="charliteral">&#39;;&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a0b476f2571b80839e3440a4679c2ac5e">GHOST_kKeySemicolon</a>;
<a name="l00409"></a>00409                     <span class="keywordflow">case</span> <span class="charliteral">&#39;\&#39;&#39;</span>:  <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a11537b3cb728b3ebd1e8cec05cbb3ee9">GHOST_kKeyQuote</a>;
<a name="l00410"></a>00410                     <span class="keywordflow">case</span> <span class="charliteral">&#39;\\&#39;</span>:  <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a7d24cc4f17540eb52342b48fe186c8da">GHOST_kKeyBackslash</a>;
<a name="l00411"></a>00411                     <span class="keywordflow">case</span> <span class="charliteral">&#39;[&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a6c4b5fae902552187eaa5c63ec3c1fb3">GHOST_kKeyLeftBracket</a>;
<a name="l00412"></a>00412                     <span class="keywordflow">case</span> <span class="charliteral">&#39;]&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a777cd013b4e20cdbb7890ae042452f4b">GHOST_kKeyRightBracket</a>;
<a name="l00413"></a>00413                     <span class="keywordflow">case</span> <span class="charliteral">&#39;`&#39;</span>:   <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a163051d941985a5d99fd8f441c140557">GHOST_kKeyAccentGrave</a>;
<a name="l00414"></a>00414                     <span class="keywordflow">default</span>:
<a name="l00415"></a>00415                         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ad71952f1163a7812cdf06fa2dd20a081">GHOST_kKeyUnknown</a>;
<a name="l00416"></a>00416                 }
<a name="l00417"></a>00417             }
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7ad71952f1163a7812cdf06fa2dd20a081">GHOST_kKeyUnknown</a>;
<a name="l00420"></a>00420 }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="preprocessor">#pragma mark defines for 10.6 api not documented in 10.5</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span><span class="preprocessor">#ifndef MAC_OS_X_VERSION_10_6</span>
<a name="l00425"></a>00425 <span class="preprocessor"></span><span class="keyword">enum</span> {
<a name="l00426"></a>00426     <span class="comment">/* The following event types are available on some hardware on 10.5.2 and later */</span>
<a name="l00427"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cda1b7c9ab865666ba51e6c7904c2afc720">00427</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cda1b7c9ab865666ba51e6c7904c2afc720">NSEventTypeGesture</a>          = 29,
<a name="l00428"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cda98944690b880bb02726e09ba70aca8b1">00428</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cda98944690b880bb02726e09ba70aca8b1">NSEventTypeMagnify</a>          = 30,
<a name="l00429"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdaca44c1bdebeb14ba3a1a7d742cb4e15c">00429</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdaca44c1bdebeb14ba3a1a7d742cb4e15c">NSEventTypeSwipe</a>            = 31,
<a name="l00430"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdabcaf3dd7ee365e2eb63669d2afcd9a5a">00430</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdabcaf3dd7ee365e2eb63669d2afcd9a5a">NSEventTypeRotate</a>           = 18,
<a name="l00431"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdaf01de0226d935ad525a3971752b11a55">00431</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdaf01de0226d935ad525a3971752b11a55">NSEventTypeBeginGesture</a>     = 19,
<a name="l00432"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdadf7499883a32bc332537d0fb424eabef">00432</a>     <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdadf7499883a32bc332537d0fb424eabef">NSEventTypeEndGesture</a>       = 20
<a name="l00433"></a>00433 };
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="../../d4/d4f/interfaceNSEvent_07GestureEvents_08.html">00435</a> <span class="keyword">@interface </span>NSEvent(GestureEvents)
<a name="l00436"></a>00436 <span class="comment">/* This message is valid for events of type NSEventTypeMagnify, on 10.5.2 or later */</span>
<a name="l00437"></a>00437 <span class="preprocessor">#if MAC_OS_X_VERSION_MIN_REQUIRED &lt;= MAC_OS_X_VERSION_10_4</span>
<a name="l00438"></a>00438 <span class="preprocessor"></span>- (float)magnification;       <span class="comment">// change in magnification.</span>
<a name="l00439"></a>00439 <span class="preprocessor">#else</span>
<a name="l00440"></a>00440 <span class="preprocessor"></span>- (CGFloat)magnification;       <span class="comment">// change in magnification.</span>
<a name="l00441"></a>00441 <span class="preprocessor">#endif</span>
<a name="l00442"></a>00442 <span class="preprocessor"></span><span class="keyword">@end</span> 
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 <span class="preprocessor">#endif</span>
<a name="l00445"></a>00445 <span class="preprocessor"></span>
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="preprocessor">#pragma mark Utility functions</span>
<a name="l00448"></a>00448 <span class="preprocessor"></span>
<a name="l00449"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a360ca365a016d742148266de002266bc">00449</a> <span class="preprocessor">#define FIRSTFILEBUFLG 512</span>
<a name="l00450"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a6620573a9065e5f965c1532fb414378a">00450</a> <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a6620573a9065e5f965c1532fb414378a">g_hasFirstFile</a> = <span class="keyword">false</span>;
<a name="l00451"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#aa540708d5ba58bd3979e4fdcea6a4f7c">00451</a> <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#aa540708d5ba58bd3979e4fdcea6a4f7c">g_firstFileBuf</a>[512];
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 <span class="comment">//TODO:Need to investigate this. Function called too early in creator.c to have g_hasFirstFile == true</span>
<a name="l00454"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a3a3602123a6de3c42bdc5a06507fa00e">00454</a> <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/d71/GPG__ghost_8cpp.html#a27a1d05b9252390a4e28af98e9ce3ec9">GHOST_HACK_getFirstFile</a>(<span class="keywordtype">char</span> buf[<a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a360ca365a016d742148266de002266bc">FIRSTFILEBUFLG</a>])
<a name="l00455"></a>00455 {
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (<a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a6620573a9065e5f965c1532fb414378a">g_hasFirstFile</a>) {
<a name="l00457"></a>00457         strncpy(buf, <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#aa540708d5ba58bd3979e4fdcea6a4f7c">g_firstFileBuf</a>, FIRSTFILEBUFLG - 1);
<a name="l00458"></a>00458         buf[FIRSTFILEBUFLG - 1] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00459"></a>00459         <span class="keywordflow">return</span> 1;
<a name="l00460"></a>00460     } <span class="keywordflow">else</span> {
<a name="l00461"></a>00461         <span class="keywordflow">return</span> 0; 
<a name="l00462"></a>00462     }
<a name="l00463"></a>00463 }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="preprocessor">#if defined(WITH_QUICKTIME) &amp;&amp; !defined(USE_QTKIT)</span>
<a name="l00466"></a>00466 <span class="preprocessor"></span><span class="comment">//Need to place this quicktime function in an ObjC file</span>
<a name="l00467"></a>00467 <span class="comment">//It is used to avoid memory leak when raising the quicktime &quot;compression settings&quot; standard dialog</span>
<a name="l00468"></a>00468 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00469"></a>00469     <span class="keyword">struct </span><a class="code" href="../../d5/df1/structbContext.html">bContext</a>;
<a name="l00470"></a>00470     <span class="keyword">struct </span><a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a>;
<a name="l00471"></a>00471     <span class="keyword">extern</span> <span class="keywordtype">int</span> fromcocoa_request_qtcodec_settings(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 
<a name="l00474"></a>00474 <span class="keywordtype">int</span> cocoa_request_qtcodec_settings(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00475"></a>00475 {
<a name="l00476"></a>00476     <span class="keywordtype">int</span> result;
<a name="l00477"></a>00477     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l00478"></a>00478     
<a name="l00479"></a>00479     result = fromcocoa_request_qtcodec_settings(C, op);
<a name="l00480"></a>00480     
<a name="l00481"></a>00481     [pool drain];
<a name="l00482"></a>00482     <span class="keywordflow">return</span> result;
<a name="l00483"></a>00483 }
<a name="l00484"></a>00484 };
<a name="l00485"></a>00485 <span class="preprocessor">#endif</span>
<a name="l00486"></a>00486 <span class="preprocessor"></span>
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 <span class="preprocessor">#pragma mark Cocoa objects</span>
<a name="l00489"></a>00489 <span class="preprocessor"></span>
<a name="l00494"></a><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html">00494</a> <span class="keyword">@interface </span><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html">CocoaAppDelegate</a> : NSObject {
<a name="l00495"></a><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a04a7daf50b1bf8325edfd8f058437e0f">00495</a>     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html">GHOST_SystemCocoa</a> *<a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a04a7daf50b1bf8325edfd8f058437e0f">systemCocoa</a>;
<a name="l00496"></a>00496 }
<a name="l00497"></a>00497 - (void)setSystemCocoa:(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html">GHOST_SystemCocoa</a> *)sysCocoa;
<a name="l00498"></a>00498 - (<a class="code" href="../../d8/d1d/GHOST__WindowWin32_8h.html#a3be13892ae7076009afcf121347dd319">BOOL</a>)application:(NSApplication *)theApplication openFile:(NSString *)filename;
<a name="l00499"></a>00499 - (NSApplicationTerminateReply)applicationShouldTerminate:(NSApplication *)sender;
<a name="l00500"></a>00500 - (void)applicationWillTerminate:(NSNotification *)aNotification;
<a name="l00501"></a>00501 - (void)applicationWillBecomeActive:(NSNotification *)aNotification;
<a name="l00502"></a>00502 <span class="keyword">@end</span>
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="keyword">@implementation </span><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html">CocoaAppDelegate</a> : NSObject
<a name="l00505"></a>00505 -(void)setSystemCocoa:(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html">GHOST_SystemCocoa</a> *)sysCocoa
<a name="l00506"></a>00506 {
<a name="l00507"></a><a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ab6f3c269fc46c9c1c0f81b3431240138">00507</a>     <a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a04a7daf50b1bf8325edfd8f058437e0f">systemCocoa</a> = sysCocoa;
<a name="l00508"></a>00508 }
<a name="l00509"></a>00509 
<a name="l00510"></a><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#aa3234b35d09ea7ccf763300125199084">00510</a> - (<a class="code" href="../../d8/d1d/GHOST__WindowWin32_8h.html#a3be13892ae7076009afcf121347dd319">BOOL</a>)application:(NSApplication *)theApplication openFile:(NSString *)filename
<a name="l00511"></a>00511 {
<a name="l00512"></a>00512     <span class="keywordflow">return</span> <a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a04a7daf50b1bf8325edfd8f058437e0f">systemCocoa</a>-&gt;<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa2706659c18ed84b83e40ae7c528ef74">handleOpenDocumentRequest</a>(filename);
<a name="l00513"></a>00513 }
<a name="l00514"></a>00514 
<a name="l00515"></a><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a37cf531ad3e7dffe702715429c11b2c5">00515</a> - (NSApplicationTerminateReply)applicationShouldTerminate:(NSApplication *)sender
<a name="l00516"></a>00516 {
<a name="l00517"></a>00517     <span class="comment">//TODO: implement graceful termination through Cocoa mechanism to avoid session log off to be cancelled</span>
<a name="l00518"></a>00518     <span class="comment">//Note that Cmd+Q is already handled by keyhandler</span>
<a name="l00519"></a>00519     <span class="keywordflow">if</span> (<a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a04a7daf50b1bf8325edfd8f058437e0f">systemCocoa</a>-&gt;<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a5e4e73b10ff4717dc039cb4dd754f16c">handleQuitRequest</a>() == <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8ce1eb213309d6a46760abc4eb48977ba45448b694216b4eb6b264d8167a80254">GHOST_kExitNow</a>)
<a name="l00520"></a>00520         <span class="keywordflow">return</span> NSTerminateCancel;<span class="comment">//NSTerminateNow;</span>
<a name="l00521"></a>00521     <span class="keywordflow">else</span>
<a name="l00522"></a>00522         <span class="keywordflow">return</span> NSTerminateCancel;
<a name="l00523"></a>00523 }
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <span class="comment">// To avoid cancelling a log off process, we must use Cocoa termination process</span>
<a name="l00526"></a>00526 <span class="comment">// And this function is the only chance to perform clean up</span>
<a name="l00527"></a>00527 <span class="comment">// So WM_exit needs to be called directly, as the event loop will never run before termination</span>
<a name="l00528"></a><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a7d1aceac9b124401ea122bbd489ad08b">00528</a> - (void)applicationWillTerminate:(NSNotification *)aNotification
<a name="l00529"></a>00529 {
<a name="l00530"></a>00530     <span class="comment">/*G.afbreek = 0; //Let Cocoa perform the termination at the end</span>
<a name="l00531"></a>00531 <span class="comment">    WM_exit(C);*/</span>
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00534"></a><a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#ac20202d79c660884c9b7859dc87c2997">00534</a> - (void)applicationWillBecomeActive:(NSNotification *)aNotification
<a name="l00535"></a>00535 {
<a name="l00536"></a>00536     <a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a04a7daf50b1bf8325edfd8f058437e0f">systemCocoa</a>-&gt;<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2db7703303cc10f7ab7eb8f916144a0b">handleApplicationBecomeActiveEvent</a>();
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 <span class="keyword">@end</span>
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 <span class="preprocessor">#pragma mark initialization/finalization</span>
<a name="l00543"></a>00543 <span class="preprocessor"></span>
<a name="l00544"></a>00544 
<a name="l00545"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae31291e6f4ca8dc70b0509fe7d0eff49">00545</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae31291e6f4ca8dc70b0509fe7d0eff49">GHOST_SystemCocoa::GHOST_SystemCocoa</a>()
<a name="l00546"></a>00546 {
<a name="l00547"></a>00547     <span class="keywordtype">int</span> mib[2];
<a name="l00548"></a>00548     <span class="keyword">struct </span>timeval boottime;
<a name="l00549"></a>00549     <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>;
<a name="l00550"></a>00550     <span class="keywordtype">char</span> *rstring = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00551"></a>00551     
<a name="l00552"></a>00552     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> =0;
<a name="l00553"></a>00553     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa83a1108307bcef408d9be35fb56e1f8">m_pressedMouseButtons</a> =0;
<a name="l00554"></a>00554     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a96278251df7640e6bfdc054e1ea3571c">m_isGestureInProgress</a> = <span class="keyword">false</span>;
<a name="l00555"></a>00555     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae1a4443722e903dc2adce06ab34bafa3">m_cursorDelta_x</a>=0;
<a name="l00556"></a>00556     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a3ec16b99b6460b7c8cce94febcb22bb6">m_cursorDelta_y</a>=0;
<a name="l00557"></a>00557     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">false</span>;
<a name="l00558"></a>00558     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2a8b2e92c7198864963e5dbf85061c05">m_needDelayedApplicationBecomeActiveEventProcessing</a> = <span class="keyword">false</span>;
<a name="l00559"></a>00559     <a class="code" href="../../db/d6d/classGHOST__System.html#ac115876847c49a084a85ae3998c8fdd5">m_displayManager</a> = <span class="keyword">new</span> <a class="code" href="../../df/d62/classGHOST__DisplayManagerCocoa.html">GHOST_DisplayManagerCocoa</a> ();
<a name="l00560"></a>00560     <a class="code" href="../../dc/d58/GHOST__Debug_8h.html#a89fb5ce08c9d3fabb619c1b864437746">GHOST_ASSERT</a>(<a class="code" href="../../db/d6d/classGHOST__System.html#ac115876847c49a084a85ae3998c8fdd5">m_displayManager</a>, <span class="stringliteral">&quot;GHOST_SystemCocoa::GHOST_SystemCocoa(): m_displayManager==0\n&quot;</span>);
<a name="l00561"></a>00561     <a class="code" href="../../db/d6d/classGHOST__System.html#ac115876847c49a084a85ae3998c8fdd5">m_displayManager</a>-&gt;<a class="code" href="../../d3/d88/classGHOST__DisplayManager.html#a8a8e3ebf3262155a80610873437da4fc">initialize</a>();
<a name="l00562"></a>00562 
<a name="l00563"></a>00563     <span class="comment">//NSEvent timeStamp is given in system uptime, state start date is boot time</span>
<a name="l00564"></a>00564     mib[0] = CTL_KERN;
<a name="l00565"></a>00565     mib[1] = KERN_BOOTTIME;
<a name="l00566"></a>00566     len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>timeval);
<a name="l00567"></a>00567     
<a name="l00568"></a>00568     sysctl(mib, 2, &amp;boottime, &amp;len, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);
<a name="l00569"></a>00569     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#acf7ba2683a89bff308826ff5c01becc9">m_start_time</a> = ((boottime.tv_sec*1000)+(boottime.tv_usec/1000));
<a name="l00570"></a>00570     
<a name="l00571"></a>00571     <span class="comment">//Detect multitouch trackpad</span>
<a name="l00572"></a>00572     mib[0] = CTL_HW;
<a name="l00573"></a>00573     mib[1] = HW_MODEL;
<a name="l00574"></a>00574     sysctl( mib, 2, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;len, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0 );
<a name="l00575"></a>00575     rstring = (<span class="keywordtype">char</span>*)malloc( len );
<a name="l00576"></a>00576     sysctl( mib, 2, rstring, &amp;len, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0 );
<a name="l00577"></a>00577     
<a name="l00578"></a>00578     <span class="comment">//Hack on MacBook revision, as multitouch avail. function missing</span>
<a name="l00579"></a>00579     <span class="keywordflow">if</span> (strstr(rstring,<span class="stringliteral">&quot;MacBookAir&quot;</span>) ||
<a name="l00580"></a>00580         (strstr(rstring,<span class="stringliteral">&quot;MacBook&quot;</span>) &amp;&amp; (rstring[<a class="code" href="../../d1/d22/stdosl_8h.html#af902ac638d8127503ad64a0eacb3a7e8">strlen</a>(rstring)-3]&gt;=<span class="charliteral">&#39;5&#39;</span>) &amp;&amp; (rstring[<a class="code" href="../../d1/d22/stdosl_8h.html#af902ac638d8127503ad64a0eacb3a7e8">strlen</a>(rstring)-3]&lt;=<span class="charliteral">&#39;9&#39;</span>)))
<a name="l00581"></a>00581         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#afe0af28b0b2df81a0011ddf6140fae27">m_hasMultiTouchTrackpad</a> = <span class="keyword">true</span>;
<a name="l00582"></a>00582     <span class="keywordflow">else</span> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#afe0af28b0b2df81a0011ddf6140fae27">m_hasMultiTouchTrackpad</a> = <span class="keyword">false</span>;
<a name="l00583"></a>00583     
<a name="l00584"></a>00584     free( rstring );
<a name="l00585"></a>00585     rstring = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00586"></a>00586     
<a name="l00587"></a>00587     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9e9ab050428805c435431123e9bb93d6">m_ignoreWindowSizedMessages</a> = <span class="keyword">false</span>;
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a94aed67bcb211176bede40ed8db7b0e1">00590</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a94aed67bcb211176bede40ed8db7b0e1">GHOST_SystemCocoa::~GHOST_SystemCocoa</a>()
<a name="l00591"></a>00591 {
<a name="l00592"></a>00592 }
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 
<a name="l00595"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#afc9216f99ad6dc3c22ee42317b8c8f8f">00595</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#afc9216f99ad6dc3c22ee42317b8c8f8f">GHOST_SystemCocoa::init</a>()
<a name="l00596"></a>00596 {
<a name="l00597"></a>00597     
<a name="l00598"></a>00598     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> success = <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#afc9216f99ad6dc3c22ee42317b8c8f8f">GHOST_System::init</a>();
<a name="l00599"></a>00599     <span class="keywordflow">if</span> (success) {
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 <span class="preprocessor">#ifdef WITH_INPUT_NDOF</span>
<a name="l00602"></a>00602 <span class="preprocessor"></span>        m_ndofManager = <span class="keyword">new</span> GHOST_NDOFManagerCocoa(*<span class="keyword">this</span>);
<a name="l00603"></a>00603 <span class="preprocessor">#endif</span>
<a name="l00604"></a>00604 <span class="preprocessor"></span>
<a name="l00605"></a>00605         <span class="comment">//ProcessSerialNumber psn;</span>
<a name="l00606"></a>00606         
<a name="l00607"></a>00607         <span class="comment">//Carbon stuff to move window &amp; menu to foreground</span>
<a name="l00608"></a>00608         <span class="comment">/*if (!GetCurrentProcess(&amp;psn)) {</span>
<a name="l00609"></a>00609 <span class="comment">            TransformProcessType(&amp;psn, kProcessTransformToForegroundApplication);</span>
<a name="l00610"></a>00610 <span class="comment">            SetFrontProcess(&amp;psn);</span>
<a name="l00611"></a>00611 <span class="comment">        }*/</span>
<a name="l00612"></a>00612         
<a name="l00613"></a>00613         NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l00614"></a>00614         <span class="keywordflow">if</span> (NSApp == nil) {
<a name="l00615"></a>00615             [NSApplication sharedApplication];
<a name="l00616"></a>00616             
<a name="l00617"></a>00617             <span class="keywordflow">if</span> ([NSApp mainMenu] == nil) {
<a name="l00618"></a>00618                 NSMenu *mainMenubar = [[NSMenu alloc] init];
<a name="l00619"></a>00619                 NSMenuItem *menuItem;
<a name="l00620"></a>00620                 NSMenu *windowMenu;
<a name="l00621"></a>00621                 NSMenu *appMenu;
<a name="l00622"></a>00622                 
<a name="l00623"></a>00623                 <span class="comment">//Create the application menu</span>
<a name="l00624"></a>00624                 appMenu = [[NSMenu alloc] initWithTitle:@&quot;Blender&quot;];
<a name="l00625"></a>00625                 
<a name="l00626"></a>00626                 [appMenu addItemWithTitle:@&quot;About Blender&quot; action:@selector(orderFrontStandardAboutPanel:) keyEquivalent:@&quot;&quot;];
<a name="l00627"></a>00627                 [appMenu addItem:[NSMenuItem separatorItem]];
<a name="l00628"></a>00628                 
<a name="l00629"></a>00629                 menuItem = [appMenu addItemWithTitle:@&quot;Hide Blender&quot; action:@selector(hide:) keyEquivalent:@&quot;h&quot;];
<a name="l00630"></a>00630                 [menuItem setKeyEquivalentModifierMask:NSCommandKeyMask];
<a name="l00631"></a>00631                  
<a name="l00632"></a>00632                 menuItem = [appMenu addItemWithTitle:@&quot;Hide others&quot; action:@selector(hideOtherApplications:) keyEquivalent:@&quot;h&quot;];
<a name="l00633"></a>00633                 [menuItem setKeyEquivalentModifierMask:(NSAlternateKeyMask | NSCommandKeyMask)];
<a name="l00634"></a>00634                 
<a name="l00635"></a>00635                 [appMenu addItemWithTitle:@&quot;Show All&quot; action:@selector(unhideAllApplications:) keyEquivalent:@&quot;&quot;];
<a name="l00636"></a>00636                 
<a name="l00637"></a>00637                 menuItem = [appMenu addItemWithTitle:@&quot;Quit Blender&quot; action:@selector(terminate:) keyEquivalent:@&quot;q&quot;];
<a name="l00638"></a>00638                 [menuItem setKeyEquivalentModifierMask:NSCommandKeyMask];
<a name="l00639"></a>00639                 
<a name="l00640"></a>00640                 menuItem = [[NSMenuItem alloc] init];
<a name="l00641"></a>00641                 [menuItem setSubmenu:appMenu];
<a name="l00642"></a>00642                 
<a name="l00643"></a>00643                 [mainMenubar addItem:menuItem];
<a name="l00644"></a>00644                 [menuItem release];
<a name="l00645"></a>00645                 [NSApp performSelector:@selector(setAppleMenu:) withObject:appMenu]; <span class="comment">//Needed for 10.5</span>
<a name="l00646"></a>00646                 [appMenu release];
<a name="l00647"></a>00647                 
<a name="l00648"></a>00648                 <span class="comment">//Create the window menu</span>
<a name="l00649"></a>00649                 windowMenu = [[NSMenu alloc] initWithTitle:@&quot;Window&quot;];
<a name="l00650"></a>00650                 
<a name="l00651"></a>00651                 menuItem = [windowMenu addItemWithTitle:@&quot;Minimize&quot; action:@selector(performMiniaturize:) keyEquivalent:@&quot;m&quot;];
<a name="l00652"></a>00652                 [menuItem setKeyEquivalentModifierMask:NSCommandKeyMask];
<a name="l00653"></a>00653                 
<a name="l00654"></a>00654                 [windowMenu addItemWithTitle:@&quot;Zoom&quot; action:@selector(performZoom:) keyEquivalent:@&quot;&quot;];
<a name="l00655"></a>00655                 
<a name="l00656"></a>00656                 menuItem = [windowMenu addItemWithTitle:@&quot;Close&quot; action:@selector(performClose:) keyEquivalent:@&quot;w&quot;];
<a name="l00657"></a>00657                 [menuItem setKeyEquivalentModifierMask:NSCommandKeyMask];
<a name="l00658"></a>00658                 
<a name="l00659"></a>00659                 menuItem = [[NSMenuItem alloc] init];
<a name="l00660"></a>00660                 [menuItem setSubmenu:windowMenu];
<a name="l00661"></a>00661                 
<a name="l00662"></a>00662                 [mainMenubar addItem:menuItem];
<a name="l00663"></a>00663                 [menuItem release];
<a name="l00664"></a>00664                 
<a name="l00665"></a>00665                 [NSApp setMainMenu:mainMenubar];
<a name="l00666"></a>00666                 [NSApp setWindowsMenu:windowMenu];
<a name="l00667"></a>00667                 [windowMenu release];
<a name="l00668"></a>00668             }
<a name="l00669"></a>00669         }
<a name="l00670"></a>00670         <span class="keywordflow">if</span> ([NSApp delegate] == nil) {
<a name="l00671"></a>00671             <a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html">CocoaAppDelegate</a> *appDelegate = [[<a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html">CocoaAppDelegate</a> alloc] init];
<a name="l00672"></a>00672             [appDelegate <a class="code" href="../../db/d87/interfaceCocoaAppDelegate.html#a48b9a6f139f58bf8f540b5b495956b58">setSystemCocoa</a>:this];
<a name="l00673"></a>00673             [NSApp setDelegate:appDelegate];
<a name="l00674"></a>00674         }
<a name="l00675"></a>00675         
<a name="l00676"></a>00676         [NSApp finishLaunching];
<a name="l00677"></a>00677         
<a name="l00678"></a>00678         [pool drain];
<a name="l00679"></a>00679     }
<a name="l00680"></a>00680     <span class="keywordflow">return</span> success;
<a name="l00681"></a>00681 }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 <span class="preprocessor">#pragma mark window management</span>
<a name="l00685"></a>00685 <span class="preprocessor"></span>
<a name="l00686"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">00686</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a2a48736e872af01983dd230e0cc19406">GHOST_TUns64</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">GHOST_SystemCocoa::getMilliSeconds</a>()<span class="keyword"> const</span>
<a name="l00687"></a>00687 <span class="keyword"></span>{
<a name="l00688"></a>00688     <span class="comment">//Cocoa equivalent exists in 10.6 ([[NSProcessInfo processInfo] systemUptime])</span>
<a name="l00689"></a>00689     <span class="keyword">struct </span>timeval currentTime;
<a name="l00690"></a>00690     
<a name="l00691"></a>00691     gettimeofday(&amp;currentTime, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00692"></a>00692     
<a name="l00693"></a>00693     <span class="comment">//Return timestamp of system uptime</span>
<a name="l00694"></a>00694     
<a name="l00695"></a>00695     <span class="keywordflow">return</span> ((currentTime.tv_sec*1000)+(currentTime.tv_usec/1000)-<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#acf7ba2683a89bff308826ff5c01becc9">m_start_time</a>);
<a name="l00696"></a>00696 }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698 
<a name="l00699"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae7ce42b01fdc6ed7ac50425e1dd3c9dc">00699</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae7ce42b01fdc6ed7ac50425e1dd3c9dc">GHOST_SystemCocoa::getNumDisplays</a>()<span class="keyword"> const</span>
<a name="l00700"></a>00700 <span class="keyword"></span>{
<a name="l00701"></a>00701     <span class="comment">//Note that OS X supports monitor hot plug</span>
<a name="l00702"></a>00702     <span class="comment">// We do not support multiple monitors at the moment</span>
<a name="l00703"></a>00703     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l00704"></a>00704 
<a name="l00705"></a>00705     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> count = [[NSScreen screens] count];
<a name="l00706"></a>00706 
<a name="l00707"></a>00707     [pool drain];
<a name="l00708"></a>00708     <span class="keywordflow">return</span> count;
<a name="l00709"></a>00709 }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711 
<a name="l00712"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a180b5882393230b57ba04b84a71fdb73">00712</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a180b5882393230b57ba04b84a71fdb73">GHOST_SystemCocoa::getMainDisplayDimensions</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a1f63f5e0e5ecc36b36ccd0377ed59d5d">GHOST_TUns32</a>&amp; width, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a1f63f5e0e5ecc36b36ccd0377ed59d5d">GHOST_TUns32</a>&amp; height)<span class="keyword"> const</span>
<a name="l00713"></a>00713 <span class="keyword"></span>{
<a name="l00714"></a>00714     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l00715"></a>00715     <span class="comment">//Get visible frame, that is frame excluding dock and top menu bar</span>
<a name="l00716"></a>00716     NSRect frame = [[NSScreen mainScreen] visibleFrame];
<a name="l00717"></a>00717     
<a name="l00718"></a>00718     <span class="comment">//Returns max window contents (excluding title bar...)</span>
<a name="l00719"></a>00719     NSRect contentRect = [NSWindow contentRectForFrameRect:frame
<a name="l00720"></a>00720                                                  styleMask:(NSTitledWindowMask | NSClosableWindowMask | NSMiniaturizableWindowMask)];
<a name="l00721"></a>00721     
<a name="l00722"></a>00722     width = contentRect.size.width;
<a name="l00723"></a>00723     height = contentRect.size.height;
<a name="l00724"></a>00724 
<a name="l00725"></a>00725     [pool drain];
<a name="l00726"></a>00726 }
<a name="l00727"></a>00727 
<a name="l00728"></a>00728 
<a name="l00729"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a7ca150f8a637131b4c08aaa102338312">00729</a> <a class="code" href="../../de/d3a/classGHOST__IWindow.html">GHOST_IWindow</a>* <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a7ca150f8a637131b4c08aaa102338312">GHOST_SystemCocoa::createWindow</a>(
<a name="l00730"></a>00730     <span class="keyword">const</span> <a class="code" href="../../d6/dce/classSTR__String.html">STR_String</a>&amp; title, 
<a name="l00731"></a>00731     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> <a class="code" href="../../db/d0f/navmesh__conversion_8c.html#a4d78fdbccaa4d42dc8599d58cdf0de96">left</a>,
<a name="l00732"></a>00732     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> top,
<a name="l00733"></a>00733     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a1f63f5e0e5ecc36b36ccd0377ed59d5d">GHOST_TUns32</a> width,
<a name="l00734"></a>00734     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a1f63f5e0e5ecc36b36ccd0377ed59d5d">GHOST_TUns32</a> height,
<a name="l00735"></a>00735     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a18a06d65ad2eecfbde897c30070ff546">GHOST_TWindowState</a> <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a1ac338c8291400e2f2785ef2cb7a5458">state</a>,
<a name="l00736"></a>00736     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8f446557ad991fa1e6b68d248d886b02">GHOST_TDrawingContextType</a> type,
<a name="l00737"></a>00737     <span class="keywordtype">bool</span> stereoVisual,
<a name="l00738"></a>00738     <span class="keyword">const</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a7ec606b4460e506e0be41a33415f2c6e">GHOST_TUns16</a> numOfAASamples,
<a name="l00739"></a>00739     <span class="keyword">const</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8b4e84f04dbc6b1b2e31c4841140fac9">GHOST_TEmbedderWindowID</a> parentWindow
<a name="l00740"></a>00740 )
<a name="l00741"></a>00741 {
<a name="l00742"></a>00742     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l00743"></a>00743     <a class="code" href="../../de/d3a/classGHOST__IWindow.html">GHOST_IWindow</a>* window = 0;
<a name="l00744"></a>00744     
<a name="l00745"></a>00745     <span class="comment">//Get the available rect for including window contents</span>
<a name="l00746"></a>00746     NSRect frame = [[NSScreen mainScreen] visibleFrame];
<a name="l00747"></a>00747     NSRect contentRect = [NSWindow contentRectForFrameRect:frame
<a name="l00748"></a>00748                                                  styleMask:(NSTitledWindowMask | NSClosableWindowMask | NSMiniaturizableWindowMask)];
<a name="l00749"></a>00749     
<a name="l00750"></a>00750     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> bottom = (contentRect.size.height - 1) - height - top;
<a name="l00751"></a>00751 
<a name="l00752"></a>00752     <span class="comment">//Ensures window top left is inside this available rect</span>
<a name="l00753"></a>00753     left = left &gt; contentRect.origin.x ? left : contentRect.origin.x;
<a name="l00754"></a>00754     bottom = bottom &gt; contentRect.origin.y ? bottom : contentRect.origin.y;
<a name="l00755"></a>00755 
<a name="l00756"></a>00756     window = <span class="keyword">new</span> GHOST_WindowCocoa (<span class="keyword">this</span>, title, left, bottom, width, height, state, type, stereoVisual, numOfAASamples);
<a name="l00757"></a>00757 
<a name="l00758"></a>00758     <span class="keywordflow">if</span> (window) {
<a name="l00759"></a>00759         <span class="keywordflow">if</span> (window-&gt;<a class="code" href="../../de/d3a/classGHOST__IWindow.html#abf33003ee4199f43f232bd84adcc6b9c">getValid</a>()) {
<a name="l00760"></a>00760             <span class="comment">// Store the pointer to the window </span>
<a name="l00761"></a>00761             <a class="code" href="../../dc/d58/GHOST__Debug_8h.html#a89fb5ce08c9d3fabb619c1b864437746">GHOST_ASSERT</a>(<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>, <span class="stringliteral">&quot;m_windowManager not initialized&quot;</span>);
<a name="l00762"></a>00762             <a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a2729db34c02e4ab1976c3968d1600351">addWindow</a>(window);
<a name="l00763"></a>00763             <a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#ae25bfa707f490156a203c61af6ca433c">setActiveWindow</a>(window);
<a name="l00764"></a>00764             <span class="comment">//Need to tell window manager the new window is the active one (Cocoa does not send the event activate upon window creation)</span>
<a name="l00765"></a>00765             <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a790819c28fcf5a4b800c6b663736ed4b">GHOST_kEventWindowActivate</a>, window));
<a name="l00766"></a>00766             <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a212393b39085dcac4c7f404becb547bd">GHOST_kEventWindowSize</a>, window));
<a name="l00767"></a>00767 
<a name="l00768"></a>00768         }
<a name="l00769"></a>00769         <span class="keywordflow">else</span> {
<a name="l00770"></a>00770             <a class="code" href="../../dc/d58/GHOST__Debug_8h.html#ae52ef493525d48d29cfe5d3e114d9f7a">GHOST_PRINT</a>(<span class="stringliteral">&quot;GHOST_SystemCocoa::createWindow(): window invalid\n&quot;</span>);
<a name="l00771"></a>00771             <span class="keyword">delete</span> window;
<a name="l00772"></a>00772             window = 0;
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774     }
<a name="l00775"></a>00775     <span class="keywordflow">else</span> {
<a name="l00776"></a>00776         <a class="code" href="../../dc/d58/GHOST__Debug_8h.html#ae52ef493525d48d29cfe5d3e114d9f7a">GHOST_PRINT</a>(<span class="stringliteral">&quot;GHOST_SystemCocoa::createWindow(): could not create window\n&quot;</span>);
<a name="l00777"></a>00777     }
<a name="l00778"></a>00778     [pool drain];
<a name="l00779"></a>00779     <span class="keywordflow">return</span> window;
<a name="l00780"></a>00780 }
<a name="l00781"></a>00781 
<a name="l00785"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ad4fe0a4fdaa30a06a93af5a6b5d57735">00785</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ad4fe0a4fdaa30a06a93af5a6b5d57735">GHOST_SystemCocoa::getCursorPosition</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a>&amp; x, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a>&amp; y)<span class="keyword"> const</span>
<a name="l00786"></a>00786 <span class="keyword"></span>{
<a name="l00787"></a>00787     NSPoint mouseLoc = [NSEvent mouseLocation];
<a name="l00788"></a>00788     
<a name="l00789"></a>00789     <span class="comment">// Returns the mouse location in screen coordinates</span>
<a name="l00790"></a>00790     x = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a>)mouseLoc.x;
<a name="l00791"></a>00791     y = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a>)mouseLoc.y;
<a name="l00792"></a>00792     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l00793"></a>00793 }
<a name="l00794"></a>00794 
<a name="l00798"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4a207363aa8ff6db6915aa4ca38fb4d9">00798</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4a207363aa8ff6db6915aa4ca38fb4d9">GHOST_SystemCocoa::setCursorPosition</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> y)
<a name="l00799"></a>00799 {
<a name="l00800"></a>00800     GHOST_WindowCocoa* window = (GHOST_WindowCocoa*)<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a8773add61fa04c4c5e594ba33ae3bf71">getActiveWindow</a>();
<a name="l00801"></a>00801     <span class="keywordflow">if</span> (!window) <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803     <span class="comment">//Cursor and mouse dissociation placed here not to interfere with continuous grab</span>
<a name="l00804"></a>00804     <span class="comment">// (in cont. grab setMouseCursorPosition is directly called)</span>
<a name="l00805"></a>00805     CGAssociateMouseAndMouseCursorPosition(<span class="keyword">false</span>);
<a name="l00806"></a>00806     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a04f105db4c542faab7f3f0e8752cbc9f">setMouseCursorPosition</a>(x, y);
<a name="l00807"></a>00807     CGAssociateMouseAndMouseCursorPosition(<span class="keyword">true</span>);
<a name="l00808"></a>00808     
<a name="l00809"></a>00809     <span class="comment">//Force mouse move event (not pushed by Cocoa)</span>
<a name="l00810"></a>00810     <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../db/dee/classGHOST__EventCursor.html">GHOST_EventCursor</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a5145e18bf4e32ba74fe5ef5e46d073b3">GHOST_kEventCursorMove</a>, window, x, y));
<a name="l00811"></a>00811     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">true</span>;
<a name="l00812"></a>00812     
<a name="l00813"></a>00813     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l00814"></a>00814 }
<a name="l00815"></a>00815 
<a name="l00816"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a04f105db4c542faab7f3f0e8752cbc9f">00816</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a04f105db4c542faab7f3f0e8752cbc9f">GHOST_SystemCocoa::setMouseCursorPosition</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> y)
<a name="l00817"></a>00817 {
<a name="l00818"></a>00818     <span class="keywordtype">float</span> xf=(float)x, yf=(<span class="keywordtype">float</span>)y;
<a name="l00819"></a>00819     GHOST_WindowCocoa* window = (GHOST_WindowCocoa*)<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a8773add61fa04c4c5e594ba33ae3bf71">getActiveWindow</a>();
<a name="l00820"></a>00820     <span class="keywordflow">if</span> (!window) <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l00821"></a>00821 
<a name="l00822"></a>00822     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l00823"></a>00823     NSScreen *windowScreen = window-&gt;getScreen();
<a name="l00824"></a>00824     NSRect screenRect = [windowScreen frame];
<a name="l00825"></a>00825     
<a name="l00826"></a>00826     <span class="comment">//Set position relative to current screen</span>
<a name="l00827"></a>00827     xf -= screenRect.origin.x;
<a name="l00828"></a>00828     yf -= screenRect.origin.y;
<a name="l00829"></a>00829     
<a name="l00830"></a>00830     <span class="comment">//Quartz Display Services uses the old coordinates (top left origin)</span>
<a name="l00831"></a>00831     yf = screenRect.size.height -yf;
<a name="l00832"></a>00832 
<a name="l00833"></a>00833     CGDisplayMoveCursorToPoint((CGDirectDisplayID)[[[windowScreen deviceDescription] objectForKey:<span class="stringliteral">@&quot;NSScreenNumber&quot;</span>] unsignedIntValue], CGPointMake(xf, yf));
<a name="l00834"></a>00834 
<a name="l00835"></a>00835     [pool drain];
<a name="l00836"></a>00836     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l00837"></a>00837 }
<a name="l00838"></a>00838 
<a name="l00839"></a>00839 
<a name="l00840"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a5d32f8c9bce78965a6edc555620d2db7">00840</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a5d32f8c9bce78965a6edc555620d2db7">GHOST_SystemCocoa::getModifierKeys</a>(<a class="code" href="../../d9/db4/structGHOST__ModifierKeys.html">GHOST_ModifierKeys</a>&amp; keys)<span class="keyword"> const</span>
<a name="l00841"></a>00841 <span class="keyword"></span>{
<a name="l00842"></a>00842     keys.<a class="code" href="../../d9/db4/structGHOST__ModifierKeys.html#aef1d86b1f169c3036c22d93c6213ccf8">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#aad759f87d56861f098b2151083b4d7eaa538303062d2d5126b2a0c1dab506c3aa">GHOST_kModifierKeyOS</a>, (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSCommandKeyMask) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l00843"></a>00843     keys.<a class="code" href="../../d9/db4/structGHOST__ModifierKeys.html#aef1d86b1f169c3036c22d93c6213ccf8">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#aad759f87d56861f098b2151083b4d7eaa761a2d54ce6f3f9689c61cef8c2e543d">GHOST_kModifierKeyLeftAlt</a>, (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSAlternateKeyMask) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l00844"></a>00844     keys.<a class="code" href="../../d9/db4/structGHOST__ModifierKeys.html#aef1d86b1f169c3036c22d93c6213ccf8">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#aad759f87d56861f098b2151083b4d7eaa82d52de3890f450e16d55b59d1883e55">GHOST_kModifierKeyLeftShift</a>, (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSShiftKeyMask) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l00845"></a>00845     keys.<a class="code" href="../../d9/db4/structGHOST__ModifierKeys.html#aef1d86b1f169c3036c22d93c6213ccf8">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#aad759f87d56861f098b2151083b4d7eaa2623408ce351079b505a04f68c25fe2f">GHOST_kModifierKeyLeftControl</a>, (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSControlKeyMask) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l00846"></a>00846     
<a name="l00847"></a>00847     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a7aaebc103aca647834e1b6ecc3276ca5">00850</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a7aaebc103aca647834e1b6ecc3276ca5">GHOST_SystemCocoa::getButtons</a>(<a class="code" href="../../d7/df1/structGHOST__Buttons.html">GHOST_Buttons</a>&amp; buttons)<span class="keyword"> const</span>
<a name="l00851"></a>00851 <span class="keyword"></span>{
<a name="l00852"></a>00852     buttons.<a class="code" href="../../d7/df1/structGHOST__Buttons.html#ad9d170240e94afb536887592230c88ab">clear</a>();
<a name="l00853"></a>00853     buttons.<a class="code" href="../../d7/df1/structGHOST__Buttons.html#aa6864f128265740a65978f724b1a19e4">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da62a24d5e11509c7de7c8a8344f779095">GHOST_kButtonMaskLeft</a>, <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa83a1108307bcef408d9be35fb56e1f8">m_pressedMouseButtons</a> &amp; <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da62a24d5e11509c7de7c8a8344f779095">GHOST_kButtonMaskLeft</a>);
<a name="l00854"></a>00854     buttons.<a class="code" href="../../d7/df1/structGHOST__Buttons.html#aa6864f128265740a65978f724b1a19e4">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da1747b8b44cf3420bf6c700c8ea82a29f">GHOST_kButtonMaskRight</a>, <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa83a1108307bcef408d9be35fb56e1f8">m_pressedMouseButtons</a> &amp; <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da1747b8b44cf3420bf6c700c8ea82a29f">GHOST_kButtonMaskRight</a>);
<a name="l00855"></a>00855     buttons.<a class="code" href="../../d7/df1/structGHOST__Buttons.html#aa6864f128265740a65978f724b1a19e4">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260dafb5eeabc12ff6497bbb6a2de840f5039">GHOST_kButtonMaskMiddle</a>, <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa83a1108307bcef408d9be35fb56e1f8">m_pressedMouseButtons</a> &amp; <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260dafb5eeabc12ff6497bbb6a2de840f5039">GHOST_kButtonMaskMiddle</a>);
<a name="l00856"></a>00856     buttons.<a class="code" href="../../d7/df1/structGHOST__Buttons.html#aa6864f128265740a65978f724b1a19e4">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da291ea64b62e0472bc7df938ebc48da92">GHOST_kButtonMaskButton4</a>, <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa83a1108307bcef408d9be35fb56e1f8">m_pressedMouseButtons</a> &amp; <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260da291ea64b62e0472bc7df938ebc48da92">GHOST_kButtonMaskButton4</a>);
<a name="l00857"></a>00857     buttons.<a class="code" href="../../d7/df1/structGHOST__Buttons.html#aa6864f128265740a65978f724b1a19e4">set</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260dad53c3f1929e96f38b815b0bd5b43dc2a">GHOST_kButtonMaskButton5</a>, <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa83a1108307bcef408d9be35fb56e1f8">m_pressedMouseButtons</a> &amp; <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91922f74fe0b8eb3c5e787ac2e62260dad53c3f1929e96f38b815b0bd5b43dc2a">GHOST_kButtonMaskButton5</a>);
<a name="l00858"></a>00858     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l00859"></a>00859 }
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 
<a name="l00863"></a>00863 <span class="preprocessor">#pragma mark Event handlers</span>
<a name="l00864"></a>00864 <span class="preprocessor"></span>
<a name="l00868"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a0453cb4264c087ce2bbed6b5c8ced620">00868</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a0453cb4264c087ce2bbed6b5c8ced620">GHOST_SystemCocoa::processEvents</a>(<span class="keywordtype">bool</span> waitForEvent)
<a name="l00869"></a>00869 {
<a name="l00870"></a>00870     <span class="keywordtype">bool</span> anyProcessed = <span class="keyword">false</span>;
<a name="l00871"></a>00871     NSEvent *event;
<a name="l00872"></a>00872     
<a name="l00873"></a>00873     <span class="comment">//  SetMouseCoalescingEnabled(false, NULL);</span>
<a name="l00874"></a>00874     <span class="comment">//TODO : implement timer ??</span>
<a name="l00875"></a>00875     
<a name="l00876"></a>00876     <span class="comment">/*do {</span>
<a name="l00877"></a>00877 <span class="comment">        GHOST_TimerManager* timerMgr = getTimerManager();</span>
<a name="l00878"></a>00878 <span class="comment">        </span>
<a name="l00879"></a>00879 <span class="comment">        if (waitForEvent) {</span>
<a name="l00880"></a>00880 <span class="comment">        GHOST_TUns64 next = timerMgr-&gt;nextFireTime();</span>
<a name="l00881"></a>00881 <span class="comment">        double timeOut;</span>
<a name="l00882"></a>00882 <span class="comment"></span>
<a name="l00883"></a>00883 <span class="comment">        if (next == GHOST_kFireTimeNever) {</span>
<a name="l00884"></a>00884 <span class="comment">        timeOut = kEventDurationForever;</span>
<a name="l00885"></a>00885 <span class="comment">        } else {</span>
<a name="l00886"></a>00886 <span class="comment">        timeOut = (double)(next - getMilliSeconds())/1000.0;</span>
<a name="l00887"></a>00887 <span class="comment">        if (timeOut &lt; 0.0)</span>
<a name="l00888"></a>00888 <span class="comment">        timeOut = 0.0;</span>
<a name="l00889"></a>00889 <span class="comment">        }</span>
<a name="l00890"></a>00890 <span class="comment"></span>
<a name="l00891"></a>00891 <span class="comment">        ::ReceiveNextEvent(0, NULL, timeOut, false, &amp;event);</span>
<a name="l00892"></a>00892 <span class="comment">        }</span>
<a name="l00893"></a>00893 <span class="comment"></span>
<a name="l00894"></a>00894 <span class="comment">        if (timerMgr-&gt;fireTimers(getMilliSeconds())) {</span>
<a name="l00895"></a>00895 <span class="comment">        anyProcessed = true;</span>
<a name="l00896"></a>00896 <span class="comment">        }</span>
<a name="l00897"></a>00897 <span class="comment">        */</span>
<a name="l00898"></a>00898         
<a name="l00899"></a>00899         <span class="keywordflow">do</span> {
<a name="l00900"></a>00900             NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
<a name="l00901"></a>00901             <span class="keyword">event</span> = [NSApp nextEventMatchingMask:NSAnyEventMask
<a name="l00902"></a>00902                                        untilDate:[NSDate distantPast]
<a name="l00903"></a>00903                                           inMode:NSDefaultRunLoopMode
<a name="l00904"></a>00904                                          dequeue:YES];
<a name="l00905"></a>00905             <span class="keywordflow">if</span> (event==nil) {
<a name="l00906"></a>00906                 [pool drain];
<a name="l00907"></a>00907                 <span class="keywordflow">break</span>;
<a name="l00908"></a>00908             }
<a name="l00909"></a>00909             
<a name="l00910"></a>00910             anyProcessed = <span class="keyword">true</span>;
<a name="l00911"></a>00911             
<a name="l00912"></a>00912             <span class="keywordflow">switch</span> ([event type]) {
<a name="l00913"></a>00913                 <span class="keywordflow">case</span> NSKeyDown:
<a name="l00914"></a>00914                 <span class="keywordflow">case</span> NSKeyUp:
<a name="l00915"></a>00915                 <span class="keywordflow">case</span> NSFlagsChanged:
<a name="l00916"></a>00916                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4ae669dfda845c41a4b39d27cc482391">handleKeyEvent</a>(event);
<a name="l00917"></a>00917                     
<a name="l00918"></a>00918                     <span class="comment">/* Support system-wide keyboard shortcuts, like Expos, ...) =&gt;included in always NSApp sendEvent */</span>
<a name="l00919"></a>00919                     <span class="comment">/*      if (([event modifierFlags] &amp; NSCommandKeyMask) || [event type] == NSFlagsChanged) {</span>
<a name="l00920"></a>00920 <span class="comment">                     [NSApp sendEvent:event];</span>
<a name="l00921"></a>00921 <span class="comment">                     }*/</span>
<a name="l00922"></a>00922                     <span class="keywordflow">break</span>;
<a name="l00923"></a>00923                     
<a name="l00924"></a>00924                 <span class="keywordflow">case</span> NSLeftMouseDown:
<a name="l00925"></a>00925                 <span class="keywordflow">case</span> NSLeftMouseUp:
<a name="l00926"></a>00926                 <span class="keywordflow">case</span> NSRightMouseDown:
<a name="l00927"></a>00927                 <span class="keywordflow">case</span> NSRightMouseUp:
<a name="l00928"></a>00928                 <span class="keywordflow">case</span> NSMouseMoved:
<a name="l00929"></a>00929                 <span class="keywordflow">case</span> NSLeftMouseDragged:
<a name="l00930"></a>00930                 <span class="keywordflow">case</span> NSRightMouseDragged:
<a name="l00931"></a>00931                 <span class="keywordflow">case</span> NSScrollWheel:
<a name="l00932"></a>00932                 <span class="keywordflow">case</span> NSOtherMouseDown:
<a name="l00933"></a>00933                 <span class="keywordflow">case</span> NSOtherMouseUp:
<a name="l00934"></a>00934                 <span class="keywordflow">case</span> NSOtherMouseDragged:
<a name="l00935"></a>00935                 <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cda98944690b880bb02726e09ba70aca8b1">NSEventTypeMagnify</a>:
<a name="l00936"></a>00936                 <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdabcaf3dd7ee365e2eb63669d2afcd9a5a">NSEventTypeRotate</a>:
<a name="l00937"></a>00937                 <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdaf01de0226d935ad525a3971752b11a55">NSEventTypeBeginGesture</a>:
<a name="l00938"></a>00938                 <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdadf7499883a32bc332537d0fb424eabef">NSEventTypeEndGesture</a>:
<a name="l00939"></a>00939                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4350bb9def729a299f5e0bcd1ef618dd">handleMouseEvent</a>(event);
<a name="l00940"></a>00940                     <span class="keywordflow">break</span>;
<a name="l00941"></a>00941                     
<a name="l00942"></a>00942                 <span class="keywordflow">case</span> NSTabletPoint:
<a name="l00943"></a>00943                 <span class="keywordflow">case</span> NSTabletProximity:
<a name="l00944"></a>00944                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">handleTabletEvent</a>(event,[event type]);
<a name="l00945"></a>00945                     <span class="keywordflow">break</span>;
<a name="l00946"></a>00946                     
<a name="l00947"></a>00947                     <span class="comment">/* Trackpad features, fired only from OS X 10.5.2</span>
<a name="l00948"></a>00948 <span class="comment">                     case NSEventTypeGesture:</span>
<a name="l00949"></a>00949 <span class="comment">                     case NSEventTypeSwipe:</span>
<a name="l00950"></a>00950 <span class="comment">                     break; */</span>
<a name="l00951"></a>00951                     
<a name="l00952"></a>00952                     <span class="comment">/*Unused events</span>
<a name="l00953"></a>00953 <span class="comment">                     NSMouseEntered       = 8,</span>
<a name="l00954"></a>00954 <span class="comment">                     NSMouseExited        = 9,</span>
<a name="l00955"></a>00955 <span class="comment">                     NSAppKitDefined      = 13,</span>
<a name="l00956"></a>00956 <span class="comment">                     NSSystemDefined      = 14,</span>
<a name="l00957"></a>00957 <span class="comment">                     NSApplicationDefined = 15,</span>
<a name="l00958"></a>00958 <span class="comment">                     NSPeriodic           = 16,</span>
<a name="l00959"></a>00959 <span class="comment">                     NSCursorUpdate       = 17,*/</span>
<a name="l00960"></a>00960                     
<a name="l00961"></a>00961                 <span class="keywordflow">default</span>:
<a name="l00962"></a>00962                     <span class="keywordflow">break</span>;
<a name="l00963"></a>00963             }
<a name="l00964"></a>00964             <span class="comment">//Resend event to NSApp to ensure Mac wide events are handled</span>
<a name="l00965"></a>00965             [NSApp sendEvent:event];
<a name="l00966"></a>00966             [pool drain];
<a name="l00967"></a>00967         } <span class="keywordflow">while</span> (event!= nil);      
<a name="l00968"></a>00968     <span class="comment">//} while (waitForEvent &amp;&amp; !anyProcessed); Needed only for timer implementation</span>
<a name="l00969"></a>00969     
<a name="l00970"></a>00970     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2a8b2e92c7198864963e5dbf85061c05">m_needDelayedApplicationBecomeActiveEventProcessing</a>) <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2db7703303cc10f7ab7eb8f916144a0b">handleApplicationBecomeActiveEvent</a>();
<a name="l00971"></a>00971     
<a name="l00972"></a>00972     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a>) {
<a name="l00973"></a>00973         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">false</span>;
<a name="l00974"></a>00974         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00975"></a>00975     }
<a name="l00976"></a>00976     
<a name="l00977"></a>00977     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9e9ab050428805c435431123e9bb93d6">m_ignoreWindowSizedMessages</a> = <span class="keyword">false</span>;
<a name="l00978"></a>00978     
<a name="l00979"></a>00979     <span class="keywordflow">return</span> anyProcessed;
<a name="l00980"></a>00980 }
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 <span class="comment">//Note: called from NSApplication delegate</span>
<a name="l00983"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2db7703303cc10f7ab7eb8f916144a0b">00983</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2db7703303cc10f7ab7eb8f916144a0b">GHOST_SystemCocoa::handleApplicationBecomeActiveEvent</a>()
<a name="l00984"></a>00984 {
<a name="l00985"></a>00985     <span class="comment">//Update the modifiers key mask, as its status may have changed when the application was not active</span>
<a name="l00986"></a>00986     <span class="comment">//(that is when update events are sent to another application)</span>
<a name="l00987"></a>00987     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> modifiers;
<a name="l00988"></a>00988     <a class="code" href="../../de/d3a/classGHOST__IWindow.html">GHOST_IWindow</a>* window = <a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a8773add61fa04c4c5e594ba33ae3bf71">getActiveWindow</a>();
<a name="l00989"></a>00989     
<a name="l00990"></a>00990     <span class="keywordflow">if</span> (!window) {
<a name="l00991"></a>00991         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2a8b2e92c7198864963e5dbf85061c05">m_needDelayedApplicationBecomeActiveEventProcessing</a> = <span class="keyword">true</span>;
<a name="l00992"></a>00992         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l00993"></a>00993     }
<a name="l00994"></a>00994     <span class="keywordflow">else</span> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2a8b2e92c7198864963e5dbf85061c05">m_needDelayedApplicationBecomeActiveEventProcessing</a> = <span class="keyword">false</span>;
<a name="l00995"></a>00995 
<a name="l00996"></a>00996     modifiers = [[[NSApplication sharedApplication] currentEvent] modifierFlags];
<a name="l00997"></a>00997     
<a name="l00998"></a>00998     <span class="keywordflow">if</span> ((modifiers &amp; NSShiftKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSShiftKeyMask)) {
<a name="l00999"></a>00999         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), (modifiers &amp; NSShiftKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aef2c01413fb34ea291b1786b3073cfe2">GHOST_kKeyLeftShift</a>) );
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001     <span class="keywordflow">if</span> ((modifiers &amp; NSControlKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSControlKeyMask)) {
<a name="l01002"></a>01002         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), (modifiers &amp; NSControlKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a6c1164e35e71efead55cb6d113ad664f">GHOST_kKeyLeftControl</a>) );
<a name="l01003"></a>01003     }
<a name="l01004"></a>01004     <span class="keywordflow">if</span> ((modifiers &amp; NSAlternateKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSAlternateKeyMask)) {
<a name="l01005"></a>01005         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), (modifiers &amp; NSAlternateKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a1ef1177814e1aed94435442820848278">GHOST_kKeyLeftAlt</a>) );
<a name="l01006"></a>01006     }
<a name="l01007"></a>01007     <span class="keywordflow">if</span> ((modifiers &amp; NSCommandKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSCommandKeyMask)) {
<a name="l01008"></a>01008         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), (modifiers &amp; NSCommandKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a7d8c22a7083c0cdad6e957882937b39f">GHOST_kKeyOS</a>) );
<a name="l01009"></a>01009     }
<a name="l01010"></a>01010     
<a name="l01011"></a>01011     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> = modifiers;
<a name="l01012"></a>01012     
<a name="l01013"></a>01013     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">true</span>;
<a name="l01014"></a>01014     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l01015"></a>01015 }
<a name="l01016"></a>01016 
<a name="l01017"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a498613362a3d26639e40bee26241c61d">01017</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a498613362a3d26639e40bee26241c61d">GHOST_SystemCocoa::notifyExternalEventProcessed</a>()
<a name="l01018"></a>01018 {
<a name="l01019"></a>01019     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">true</span>;
<a name="l01020"></a>01020 }
<a name="l01021"></a>01021 
<a name="l01022"></a>01022 <span class="comment">//Note: called from NSWindow delegate</span>
<a name="l01023"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a166a0754424eec6facc2ed26b2cb9f01">01023</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a166a0754424eec6facc2ed26b2cb9f01">GHOST_SystemCocoa::handleWindowEvent</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044">GHOST_TEventType</a> eventType, GHOST_WindowCocoa* window)
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d6d/classGHOST__System.html#aae3a0ffba1b0fc4cc87a1fdf12c534a3">validWindow</a>(window)) {
<a name="l01026"></a>01026         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028         <span class="keywordflow">switch</span>(eventType) 
<a name="l01029"></a>01029         {
<a name="l01030"></a>01030             <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a023b8d7867aed530d17fc10062e7812c">GHOST_kEventWindowClose</a>:
<a name="l01031"></a>01031                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a023b8d7867aed530d17fc10062e7812c">GHOST_kEventWindowClose</a>, window) );
<a name="l01032"></a>01032                 <span class="keywordflow">break</span>;
<a name="l01033"></a>01033             <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a790819c28fcf5a4b800c6b663736ed4b">GHOST_kEventWindowActivate</a>:
<a name="l01034"></a>01034                 <a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#ae25bfa707f490156a203c61af6ca433c">setActiveWindow</a>(window);
<a name="l01035"></a>01035                 window-&gt;loadCursor(window-&gt;getCursorVisibility(), window-&gt;getCursorShape());
<a name="l01036"></a>01036                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a790819c28fcf5a4b800c6b663736ed4b">GHOST_kEventWindowActivate</a>, window) );
<a name="l01037"></a>01037                 <span class="keywordflow">break</span>;
<a name="l01038"></a>01038             <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ab191770e1a2ec5901296f0c41c699aff">GHOST_kEventWindowDeactivate</a>:
<a name="l01039"></a>01039                 <a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#afe370f14515a9e13bf3879f91e31b8ac">setWindowInactive</a>(window);
<a name="l01040"></a>01040                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ab191770e1a2ec5901296f0c41c699aff">GHOST_kEventWindowDeactivate</a>, window) );
<a name="l01041"></a>01041                 <span class="keywordflow">break</span>;
<a name="l01042"></a>01042             <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a9760fbf53b9738b1853932f4c9442fff">GHOST_kEventWindowUpdate</a>:
<a name="l01043"></a>01043                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a9760fbf53b9738b1853932f4c9442fff">GHOST_kEventWindowUpdate</a>, window) );
<a name="l01044"></a>01044                 <span class="keywordflow">break</span>;
<a name="l01045"></a>01045             <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a122242252725946aa5627dd8c27719ae">GHOST_kEventWindowMove</a>:
<a name="l01046"></a>01046                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a122242252725946aa5627dd8c27719ae">GHOST_kEventWindowMove</a>, window) );
<a name="l01047"></a>01047                 <span class="keywordflow">break</span>;
<a name="l01048"></a>01048             <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a212393b39085dcac4c7f404becb547bd">GHOST_kEventWindowSize</a>:
<a name="l01049"></a>01049                 <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9e9ab050428805c435431123e9bb93d6">m_ignoreWindowSizedMessages</a>)
<a name="l01050"></a>01050                 {
<a name="l01051"></a>01051                     <span class="comment">//Enforce only one resize message per event loop (coalescing all the live resize messages)                  </span>
<a name="l01052"></a>01052                     window-&gt;updateDrawingContext();
<a name="l01053"></a>01053                     <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a212393b39085dcac4c7f404becb547bd">GHOST_kEventWindowSize</a>, window) );
<a name="l01054"></a>01054                     <span class="comment">//Mouse up event is trapped by the resizing event loop, so send it anyway to the window manager</span>
<a name="l01055"></a>01055                     <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../db/d37/classGHOST__EventButton.html">GHOST_EventButton</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a75edbc6f9ddd8ca9efe59af57f1855a1" title="Mouse button event.">GHOST_kEventButtonUp</a>, window, <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a26193f365720f04e3370da2808ea0e5a">convertButton</a>(0)));
<a name="l01056"></a>01056                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9e9ab050428805c435431123e9bb93d6">m_ignoreWindowSizedMessages</a> = <span class="keyword">true</span>;
<a name="l01057"></a>01057                 }
<a name="l01058"></a>01058                 <span class="keywordflow">break</span>;
<a name="l01059"></a>01059             <span class="keywordflow">default</span>:
<a name="l01060"></a>01060                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01061"></a>01061                 <span class="keywordflow">break</span>;
<a name="l01062"></a>01062         }
<a name="l01063"></a>01063     
<a name="l01064"></a>01064     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">true</span>;
<a name="l01065"></a>01065     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l01066"></a>01066 }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068 <span class="comment">//Note: called from NSWindow subclass</span>
<a name="l01069"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a1a6f0a68d3fa0154e09d2483e43a18de">01069</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a1a6f0a68d3fa0154e09d2483e43a18de">GHOST_SystemCocoa::handleDraggingEvent</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044">GHOST_TEventType</a> eventType, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac332d891d6f369071197870874d0ed40">GHOST_TDragnDropTypes</a> draggedObjectType,
<a name="l01070"></a>01070                                    GHOST_WindowCocoa* window, <span class="keywordtype">int</span> mouseX, <span class="keywordtype">int</span> mouseY, <span class="keywordtype">void</span>* <a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>)
<a name="l01071"></a>01071 {
<a name="l01072"></a>01072     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d6d/classGHOST__System.html#aae3a0ffba1b0fc4cc87a1fdf12c534a3">validWindow</a>(window)) {
<a name="l01073"></a>01073         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01074"></a>01074     }
<a name="l01075"></a>01075     <span class="keywordflow">switch</span>(eventType) 
<a name="l01076"></a>01076     {
<a name="l01077"></a>01077         <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a653db10e5e598ba2d3ce4778cc599ef7">GHOST_kEventDraggingEntered</a>:
<a name="l01078"></a>01078         <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a54b7cf1d4a7ec13d3e856477a20cc377">GHOST_kEventDraggingUpdated</a>:
<a name="l01079"></a>01079         <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a2ecd04310cddea009051261b402bfd26">GHOST_kEventDraggingExited</a>:
<a name="l01080"></a>01080             <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../da/dee/classGHOST__EventDragnDrop.html">GHOST_EventDragnDrop</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(),eventType,draggedObjectType,window,mouseX,mouseY,<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));
<a name="l01081"></a>01081             <span class="keywordflow">break</span>;
<a name="l01082"></a>01082             
<a name="l01083"></a>01083         <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a266db0bd27e72701af46d02be92787ea">GHOST_kEventDraggingDropDone</a>:
<a name="l01084"></a>01084         {
<a name="l01085"></a>01085             <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> * temp_buff;
<a name="l01086"></a>01086             <a class="code" href="../../d4/d12/structGHOST__TStringArray.html">GHOST_TStringArray</a> *strArray;
<a name="l01087"></a>01087             NSArray *droppedArray;
<a name="l01088"></a>01088             <span class="keywordtype">size_t</span> pastedTextSize;  
<a name="l01089"></a>01089             NSString *droppedStr;
<a name="l01090"></a>01090             <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8029e7130be71615b87eeee3439ae245">GHOST_TEventDataPtr</a> eventData;
<a name="l01091"></a>01091             <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l01092"></a>01092 
<a name="l01093"></a>01093             <span class="keywordflow">if</span> (!data) <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01094"></a>01094             
<a name="l01095"></a>01095             <span class="keywordflow">switch</span> (draggedObjectType) {
<a name="l01096"></a>01096                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac332d891d6f369071197870874d0ed40a3d54cdcdee16b522db2159d47232b67b">GHOST_kDragnDropTypeFilenames</a>:
<a name="l01097"></a>01097                     droppedArray = (NSArray*)data;
<a name="l01098"></a>01098                     
<a name="l01099"></a>01099                     strArray = (<a class="code" href="../../d4/d12/structGHOST__TStringArray.html">GHOST_TStringArray</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d12/structGHOST__TStringArray.html">GHOST_TStringArray</a>));
<a name="l01100"></a>01100                     <span class="keywordflow">if</span> (!strArray) <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01101"></a>01101                     
<a name="l01102"></a>01102                     strArray-&gt;<a class="code" href="../../d4/d12/structGHOST__TStringArray.html#afd2c1217f6c0922a446ce626ef75d339">count</a> = [droppedArray count];
<a name="l01103"></a>01103                     <span class="keywordflow">if</span> (strArray-&gt;<a class="code" href="../../d4/d12/structGHOST__TStringArray.html#afd2c1217f6c0922a446ce626ef75d339">count</a> == 0) <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01104"></a>01104                     
<a name="l01105"></a>01105                     strArray-&gt;<a class="code" href="../../d4/d12/structGHOST__TStringArray.html#a737dcf498abefcea7d8d58d75253721b">strings</a> = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>**) malloc(strArray-&gt;<a class="code" href="../../d4/d12/structGHOST__TStringArray.html#afd2c1217f6c0922a446ce626ef75d339">count</a>*<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*));
<a name="l01106"></a>01106                     
<a name="l01107"></a>01107                     <span class="keywordflow">for</span> (i=0;i&lt;strArray-&gt;<a class="code" href="../../d4/d12/structGHOST__TStringArray.html#afd2c1217f6c0922a446ce626ef75d339">count</a>;i++)
<a name="l01108"></a>01108                     {
<a name="l01109"></a>01109                         droppedStr = [droppedArray objectAtIndex:i];
<a name="l01110"></a>01110                         
<a name="l01111"></a>01111                         pastedTextSize = [droppedStr lengthOfBytesUsingEncoding:NSUTF8StringEncoding];
<a name="l01112"></a>01112                         temp_buff = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*) malloc(pastedTextSize+1); 
<a name="l01113"></a>01113                     
<a name="l01114"></a>01114                         <span class="keywordflow">if</span> (!temp_buff) {
<a name="l01115"></a>01115                             strArray-&gt;<a class="code" href="../../d4/d12/structGHOST__TStringArray.html#afd2c1217f6c0922a446ce626ef75d339">count</a> = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l01116"></a>01116                             <span class="keywordflow">break</span>;
<a name="l01117"></a>01117                         }
<a name="l01118"></a>01118                     
<a name="l01119"></a>01119                         strncpy((<span class="keywordtype">char</span>*)temp_buff, [droppedStr cStringUsingEncoding:NSUTF8StringEncoding], pastedTextSize);
<a name="l01120"></a>01120                         temp_buff[pastedTextSize] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01121"></a>01121                         
<a name="l01122"></a>01122                         strArray-&gt;<a class="code" href="../../d4/d12/structGHOST__TStringArray.html#a737dcf498abefcea7d8d58d75253721b">strings</a>[i] = temp_buff;
<a name="l01123"></a>01123                     }
<a name="l01124"></a>01124 
<a name="l01125"></a>01125                     eventData = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8029e7130be71615b87eeee3439ae245">GHOST_TEventDataPtr</a>) strArray; 
<a name="l01126"></a>01126                     <span class="keywordflow">break</span>;
<a name="l01127"></a>01127                     
<a name="l01128"></a>01128                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac332d891d6f369071197870874d0ed40a7de4d0c01556d9a4124d7648170d95da">GHOST_kDragnDropTypeString</a>:
<a name="l01129"></a>01129                     droppedStr = (NSString*)data;
<a name="l01130"></a>01130                     pastedTextSize = [droppedStr lengthOfBytesUsingEncoding:NSUTF8StringEncoding];
<a name="l01131"></a>01131                     
<a name="l01132"></a>01132                     temp_buff = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*) malloc(pastedTextSize+1); 
<a name="l01133"></a>01133                     
<a name="l01134"></a>01134                     <span class="keywordflow">if</span> (temp_buff == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01135"></a>01135                         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01136"></a>01136                     }
<a name="l01137"></a>01137                     
<a name="l01138"></a>01138                     strncpy((<span class="keywordtype">char</span>*)temp_buff, [droppedStr cStringUsingEncoding:NSUTF8StringEncoding], pastedTextSize);
<a name="l01139"></a>01139                     
<a name="l01140"></a>01140                     temp_buff[pastedTextSize] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01141"></a>01141                     
<a name="l01142"></a>01142                     eventData = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8029e7130be71615b87eeee3439ae245">GHOST_TEventDataPtr</a>) temp_buff;
<a name="l01143"></a>01143                     <span class="keywordflow">break</span>;
<a name="l01144"></a>01144                 
<a name="l01145"></a>01145                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac332d891d6f369071197870874d0ed40a6308ff58e313d6da6011f429274a1f02">GHOST_kDragnDropTypeBitmap</a>:
<a name="l01146"></a>01146                 {
<a name="l01147"></a>01147                     NSImage *droppedImg = (NSImage*)data;
<a name="l01148"></a>01148                     NSSize imgSize = [droppedImg size];
<a name="l01149"></a>01149                     <a class="code" href="../../d3/dd9/structImBuf.html">ImBuf</a> *ibuf = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01150"></a>01150                     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> *rasterRGB = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01151"></a>01151                     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> *rasterRGBA = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01152"></a>01152                     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> *toIBuf = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01153"></a>01153                     <span class="keywordtype">int</span> x, y, to_i, from_i;
<a name="l01154"></a>01154                     NSBitmapImageRep *blBitmapFormatImageRGB,*blBitmapFormatImageRGBA,*bitmapImage=nil;
<a name="l01155"></a>01155                     NSEnumerator *enumerator;
<a name="l01156"></a>01156                     NSImageRep *representation;
<a name="l01157"></a>01157                     
<a name="l01158"></a>01158                     ibuf = <a class="code" href="../../db/d49/IMB__imbuf_8h.html#a439680f7777db0973e76f25001cff0cd">IMB_allocImBuf</a> (imgSize.width , imgSize.height, 32, <a class="code" href="../../d7/dc9/IMB__imbuf__types_8h.html#aa49c3338a20e388ce6ade7af88a93d40" title="Flag defining the components of the ImBuf struct.">IB_rect</a>);
<a name="l01159"></a>01159                     <span class="keywordflow">if</span> (!ibuf) {
<a name="l01160"></a>01160                         [droppedImg release];
<a name="l01161"></a>01161                         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01162"></a>01162                     }
<a name="l01163"></a>01163                     
<a name="l01164"></a>01164                     <span class="comment">/*Get the bitmap of the image*/</span>
<a name="l01165"></a>01165                     enumerator = [[droppedImg representations] objectEnumerator];
<a name="l01166"></a>01166                     <span class="keywordflow">while</span> ((representation = [enumerator nextObject])) {
<a name="l01167"></a>01167                         <span class="keywordflow">if</span> ([representation isKindOfClass:[NSBitmapImageRep <span class="keyword">class</span>]]) {
<a name="l01168"></a>01168                             bitmapImage = (NSBitmapImageRep *)representation;
<a name="l01169"></a>01169                             <span class="keywordflow">break</span>;
<a name="l01170"></a>01170                         }
<a name="l01171"></a>01171                     }
<a name="l01172"></a>01172                     <span class="keywordflow">if</span> (bitmapImage == nil) <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01173"></a>01173                     
<a name="l01174"></a>01174                     <span class="keywordflow">if</span> (([bitmapImage bitsPerPixel] == 32) &amp;&amp; (([bitmapImage bitmapFormat] &amp; 0x5) == 0)
<a name="l01175"></a>01175                         &amp;&amp; ![bitmapImage isPlanar]) {
<a name="l01176"></a>01176                         <span class="comment">/* Try a fast copy if the image is a meshed RGBA 32bit bitmap*/</span>
<a name="l01177"></a>01177                         toIBuf = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*)ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ade8b2f05559e57840af8d3657817f8c8">rect</a>;
<a name="l01178"></a>01178                         rasterRGB = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*)[bitmapImage bitmapData];
<a name="l01179"></a>01179                         <span class="keywordflow">for</span> (y = 0; y &lt; imgSize.height; y++) {
<a name="l01180"></a>01180                             to_i = (imgSize.height-y-1)*imgSize.width;
<a name="l01181"></a>01181                             from_i = y*imgSize.width;
<a name="l01182"></a>01182                             memcpy(toIBuf+4*to_i, rasterRGB+4*from_i, 4*imgSize.width);
<a name="l01183"></a>01183                         }
<a name="l01184"></a>01184                     }
<a name="l01185"></a>01185                     <span class="keywordflow">else</span> {
<a name="l01186"></a>01186                         <span class="comment">/* Tell cocoa image resolution is same as current system one */</span>
<a name="l01187"></a>01187                         [bitmapImage setSize:imgSize];
<a name="l01188"></a>01188                         
<a name="l01189"></a>01189                         <span class="comment">/* Convert the image in a RGBA 32bit format */</span>
<a name="l01190"></a>01190                         <span class="comment">/* As Core Graphics does not support contextes with non premutliplied alpha,</span>
<a name="l01191"></a>01191 <span class="comment">                         we need to get alpha key values in a separate batch */</span>
<a name="l01192"></a>01192                         
<a name="l01193"></a>01193                         <span class="comment">/* First get RGB values w/o Alpha to avoid pre-multiplication, 32bit but last byte is unused */</span>
<a name="l01194"></a>01194                         blBitmapFormatImageRGB = <span class="comment">/*RGB format padded to 32bits*/</span>[[NSBitmapImageRep alloc] initWithBitmapDataPlanes:NULL
<a name="l01195"></a>01195                                                                                          pixelsWide:imgSize.width 
<a name="l01196"></a>01196                                                                                          pixelsHigh:imgSize.height
<a name="l01197"></a>01197                                                                                       bitsPerSample:8 samplesPerPixel:3 hasAlpha:NO isPlanar:NO
<a name="l01198"></a>01198                                                                                      colorSpaceName:NSDeviceRGBColorSpace 
<a name="l01199"></a>01199                                                                                        bitmapFormat:(NSBitmapFormat)0
<a name="l01200"></a>01200                                                                                         bytesPerRow:4*imgSize.width
<a name="l01201"></a>01201                                                                                        bitsPerPixel:32];
<a name="l01202"></a>01202                         
<a name="l01203"></a>01203                         [NSGraphicsContext saveGraphicsState];
<a name="l01204"></a>01204                         [NSGraphicsContext setCurrentContext:[NSGraphicsContext graphicsContextWithBitmapImageRep:blBitmapFormatImageRGB]];
<a name="l01205"></a>01205                         [bitmapImage draw];
<a name="l01206"></a>01206                         [NSGraphicsContext restoreGraphicsState];
<a name="l01207"></a>01207                         
<a name="l01208"></a>01208                         rasterRGB = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*)[blBitmapFormatImageRGB bitmapData];
<a name="l01209"></a>01209                         <span class="keywordflow">if</span> (rasterRGB == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01210"></a>01210                             [bitmapImage release];
<a name="l01211"></a>01211                             [blBitmapFormatImageRGB release];
<a name="l01212"></a>01212                             [droppedImg release];
<a name="l01213"></a>01213                             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01214"></a>01214                         }
<a name="l01215"></a>01215                         
<a name="l01216"></a>01216                         <span class="comment">/* Then get Alpha values by getting the RGBA image (that is premultiplied btw) */</span>
<a name="l01217"></a>01217                         blBitmapFormatImageRGBA = <span class="comment">/* RGBA */</span>[[NSBitmapImageRep alloc] initWithBitmapDataPlanes:NULL
<a name="l01218"></a>01218                                                                                           pixelsWide:imgSize.width
<a name="l01219"></a>01219                                                                                           pixelsHigh:imgSize.height
<a name="l01220"></a>01220                                                                                        bitsPerSample:8 samplesPerPixel:4 hasAlpha:YES isPlanar:NO
<a name="l01221"></a>01221                                                                                       colorSpaceName:NSDeviceRGBColorSpace
<a name="l01222"></a>01222                                                                                         bitmapFormat:(NSBitmapFormat)0
<a name="l01223"></a>01223                                                                                          bytesPerRow:4*imgSize.width
<a name="l01224"></a>01224                                                                                         bitsPerPixel:32];
<a name="l01225"></a>01225                         
<a name="l01226"></a>01226                         [NSGraphicsContext saveGraphicsState];
<a name="l01227"></a>01227                         [NSGraphicsContext setCurrentContext:[NSGraphicsContext graphicsContextWithBitmapImageRep:blBitmapFormatImageRGBA]];
<a name="l01228"></a>01228                         [bitmapImage draw];
<a name="l01229"></a>01229                         [NSGraphicsContext restoreGraphicsState];
<a name="l01230"></a>01230                         
<a name="l01231"></a>01231                         rasterRGBA = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*)[blBitmapFormatImageRGBA bitmapData];
<a name="l01232"></a>01232                         <span class="keywordflow">if</span> (rasterRGBA == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01233"></a>01233                             [bitmapImage release];
<a name="l01234"></a>01234                             [blBitmapFormatImageRGB release];
<a name="l01235"></a>01235                             [blBitmapFormatImageRGBA release];
<a name="l01236"></a>01236                             [droppedImg release];
<a name="l01237"></a>01237                             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01238"></a>01238                         }
<a name="l01239"></a>01239                         
<a name="l01240"></a>01240                         <span class="comment">/*Copy the image to ibuf, flipping it vertically*/</span>
<a name="l01241"></a>01241                         toIBuf = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*)ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ade8b2f05559e57840af8d3657817f8c8">rect</a>;
<a name="l01242"></a>01242                         for (y = 0; y &lt; imgSize.height; y++) {
<a name="l01243"></a>01243                             <span class="keywordflow">for</span> (x = 0; x &lt; imgSize.width; x++) {
<a name="l01244"></a>01244                                 to_i = (imgSize.height-y-1)*imgSize.width + x;
<a name="l01245"></a>01245                                 from_i = y*imgSize.width + x;
<a name="l01246"></a>01246                                 
<a name="l01247"></a>01247                                 toIBuf[4*to_i] = rasterRGB[4*from_i]; <span class="comment">/* R */</span>
<a name="l01248"></a>01248                                 toIBuf[4*to_i+1] = rasterRGB[4*from_i+1]; <span class="comment">/* G */</span>
<a name="l01249"></a>01249                                 toIBuf[4*to_i+2] = rasterRGB[4*from_i+2]; <span class="comment">/* B */</span>
<a name="l01250"></a>01250                                 toIBuf[4*to_i+3] = rasterRGBA[4*from_i+3]; <span class="comment">/* A */</span>
<a name="l01251"></a>01251                             }
<a name="l01252"></a>01252                         }
<a name="l01253"></a>01253                         
<a name="l01254"></a>01254                         [blBitmapFormatImageRGB release];
<a name="l01255"></a>01255                         [blBitmapFormatImageRGBA release];
<a name="l01256"></a>01256                         [droppedImg release];
<a name="l01257"></a>01257                     }
<a name="l01258"></a>01258                     
<a name="l01259"></a>01259                     eventData = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8029e7130be71615b87eeee3439ae245">GHOST_TEventDataPtr</a>) ibuf;
<a name="l01260"></a>01260                 }
<a name="l01261"></a>01261                     <span class="keywordflow">break</span>;
<a name="l01262"></a>01262                     
<a name="l01263"></a>01263                 <span class="keywordflow">default</span>:
<a name="l01264"></a>01264                     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01265"></a>01265                     <span class="keywordflow">break</span>;
<a name="l01266"></a>01266             }
<a name="l01267"></a>01267             <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../da/dee/classGHOST__EventDragnDrop.html">GHOST_EventDragnDrop</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(),eventType,draggedObjectType,window,mouseX,mouseY,eventData));
<a name="l01268"></a>01268         }
<a name="l01269"></a>01269             <span class="keywordflow">break</span>;
<a name="l01270"></a>01270         <span class="keywordflow">default</span>:
<a name="l01271"></a>01271             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01272"></a>01272     }
<a name="l01273"></a>01273     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">true</span>;
<a name="l01274"></a>01274     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l01275"></a>01275 }
<a name="l01276"></a>01276 
<a name="l01277"></a>01277 
<a name="l01278"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a5e4e73b10ff4717dc039cb4dd754f16c">01278</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a5e4e73b10ff4717dc039cb4dd754f16c">GHOST_SystemCocoa::handleQuitRequest</a>()
<a name="l01279"></a>01279 {
<a name="l01280"></a>01280     <a class="code" href="../../de/db8/classGHOST__Window.html">GHOST_Window</a>* window = (<a class="code" href="../../de/db8/classGHOST__Window.html">GHOST_Window</a>*)<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a8773add61fa04c4c5e594ba33ae3bf71">getActiveWindow</a>();
<a name="l01281"></a>01281     
<a name="l01282"></a>01282     <span class="comment">//Discard quit event if we are in cursor grab sequence</span>
<a name="l01283"></a>01283     <span class="keywordflow">if</span> (window &amp;&amp; (window-&gt;<a class="code" href="../../de/db8/classGHOST__Window.html#a9a6b5d8b555fb02945daf3fa14646b68">getCursorGrabMode</a>() != <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ab7d992d3f8a0de5dd5a41d24f47106bba24da2708acbd111f3e4f284e2378af89">GHOST_kGrabDisable</a>) &amp;&amp; (window-&gt;<a class="code" href="../../de/db8/classGHOST__Window.html#a9a6b5d8b555fb02945daf3fa14646b68">getCursorGrabMode</a>() != <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ab7d992d3f8a0de5dd5a41d24f47106bbac90161cefc4f9b522cd11d3a30b61957">GHOST_kGrabNormal</a>))
<a name="l01284"></a>01284         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8ce1eb213309d6a46760abc4eb48977ba9267a67649c903e4892516f96ea64701">GHOST_kExitCancel</a>;
<a name="l01285"></a>01285     
<a name="l01286"></a>01286     <span class="comment">//Check open windows if some changes are not saved</span>
<a name="l01287"></a>01287     <span class="keywordflow">if</span> (<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a2c4ea4bbcc14181296cdc9ab19b5df70">getAnyModifiedState</a>())
<a name="l01288"></a>01288     {
<a name="l01289"></a>01289         <span class="keywordtype">int</span> shouldQuit = NSRunAlertPanel(<span class="stringliteral">@&quot;Exit Blender&quot;</span>, <span class="stringliteral">@&quot;Some changes have not been saved.\nDo you really want to quit ?&quot;</span>,
<a name="l01290"></a>01290                                          <span class="stringliteral">@&quot;Cancel&quot;</span>, <span class="stringliteral">@&quot;Quit Anyway&quot;</span>, nil);
<a name="l01291"></a>01291         <span class="keywordflow">if</span> (shouldQuit == NSAlertAlternateReturn)
<a name="l01292"></a>01292         {
<a name="l01293"></a>01293             <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a34f4e99e8cfece543126b34626fcc78c">GHOST_kEventQuit</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) );
<a name="l01294"></a>01294             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8ce1eb213309d6a46760abc4eb48977ba45448b694216b4eb6b264d8167a80254">GHOST_kExitNow</a>;
<a name="l01295"></a>01295         } <span class="keywordflow">else</span> {
<a name="l01296"></a>01296             <span class="comment">//Give back focus to the blender window if user selected cancel quit</span>
<a name="l01297"></a>01297             NSArray *windowsList = [NSApp orderedWindows];
<a name="l01298"></a>01298             <span class="keywordflow">if</span> ([windowsList count]) {
<a name="l01299"></a>01299                 [[windowsList objectAtIndex:0] makeKeyAndOrderFront:nil];
<a name="l01300"></a>01300                 <span class="comment">//Handle the modifiers keyes changed state issue</span>
<a name="l01301"></a>01301                 <span class="comment">//as recovering from the quit dialog is like application</span>
<a name="l01302"></a>01302                 <span class="comment">//gaining focus back.</span>
<a name="l01303"></a>01303                 <span class="comment">//Main issue fixed is Cmd modifier not being cleared</span>
<a name="l01304"></a>01304                 <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a2db7703303cc10f7ab7eb8f916144a0b">handleApplicationBecomeActiveEvent</a>();
<a name="l01305"></a>01305             }
<a name="l01306"></a>01306         }
<a name="l01307"></a>01307 
<a name="l01308"></a>01308     }
<a name="l01309"></a>01309     <span class="keywordflow">else</span> {
<a name="l01310"></a>01310         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../d6/d44/classGHOST__Event.html">GHOST_Event</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(), <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a34f4e99e8cfece543126b34626fcc78c">GHOST_kEventQuit</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) );
<a name="l01311"></a>01311         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ab4b776a5c887188ab1d247026aff5e13">m_outsideLoopEventProcessed</a> = <span class="keyword">true</span>;
<a name="l01312"></a>01312         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8ce1eb213309d6a46760abc4eb48977ba45448b694216b4eb6b264d8167a80254">GHOST_kExitNow</a>;
<a name="l01313"></a>01313     }
<a name="l01314"></a>01314     
<a name="l01315"></a>01315     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8ce1eb213309d6a46760abc4eb48977ba9267a67649c903e4892516f96ea64701">GHOST_kExitCancel</a>;
<a name="l01316"></a>01316 }
<a name="l01317"></a>01317 
<a name="l01318"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa2706659c18ed84b83e40ae7c528ef74">01318</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#aa2706659c18ed84b83e40ae7c528ef74">GHOST_SystemCocoa::handleOpenDocumentRequest</a>(<span class="keywordtype">void</span> *filepathStr)
<a name="l01319"></a>01319 {
<a name="l01320"></a>01320     NSString *filepath = (NSString*)filepathStr;
<a name="l01321"></a>01321     <span class="keywordtype">int</span> confirmOpen = NSAlertAlternateReturn;
<a name="l01322"></a>01322     NSArray *windowsList;
<a name="l01323"></a>01323     <span class="keywordtype">char</span> * temp_buff;
<a name="l01324"></a>01324     <span class="keywordtype">size_t</span> filenameTextSize;    
<a name="l01325"></a>01325     <a class="code" href="../../de/db8/classGHOST__Window.html">GHOST_Window</a>* window= (<a class="code" href="../../de/db8/classGHOST__Window.html">GHOST_Window</a>*)<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a8773add61fa04c4c5e594ba33ae3bf71">getActiveWindow</a>();
<a name="l01326"></a>01326     
<a name="l01327"></a>01327     <span class="keywordflow">if</span> (!window) {
<a name="l01328"></a>01328         <span class="keywordflow">return</span> <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#ae6553118ce91b9c08f9376941ae1536fa0d077f5b932ce05e5b9f30c6087a2f31">NO</a>;
<a name="l01329"></a>01329     }   
<a name="l01330"></a>01330     
<a name="l01331"></a>01331     <span class="comment">//Discard event if we are in cursor grab sequence, it&#39;ll lead to &quot;stuck cursor&quot; situation if the alert panel is raised</span>
<a name="l01332"></a>01332     <span class="keywordflow">if</span> (window &amp;&amp; (window-&gt;<a class="code" href="../../de/db8/classGHOST__Window.html#a9a6b5d8b555fb02945daf3fa14646b68">getCursorGrabMode</a>() != <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ab7d992d3f8a0de5dd5a41d24f47106bba24da2708acbd111f3e4f284e2378af89">GHOST_kGrabDisable</a>) &amp;&amp; (window-&gt;<a class="code" href="../../de/db8/classGHOST__Window.html#a9a6b5d8b555fb02945daf3fa14646b68">getCursorGrabMode</a>() != <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ab7d992d3f8a0de5dd5a41d24f47106bbac90161cefc4f9b522cd11d3a30b61957">GHOST_kGrabNormal</a>))
<a name="l01333"></a>01333         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8ce1eb213309d6a46760abc4eb48977ba9267a67649c903e4892516f96ea64701">GHOST_kExitCancel</a>;
<a name="l01334"></a>01334 
<a name="l01335"></a>01335     <span class="comment">//Check open windows if some changes are not saved</span>
<a name="l01336"></a>01336     <span class="keywordflow">if</span> (<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a2c4ea4bbcc14181296cdc9ab19b5df70">getAnyModifiedState</a>())
<a name="l01337"></a>01337     {
<a name="l01338"></a>01338         confirmOpen = NSRunAlertPanel([NSString stringWithFormat:<span class="stringliteral">@&quot;Opening %@&quot;</span>,[filepath lastPathComponent]],
<a name="l01339"></a>01339                                          <span class="stringliteral">@&quot;Current document has not been saved.\nDo you really want to proceed?&quot;</span>,
<a name="l01340"></a>01340                                          <span class="stringliteral">@&quot;Cancel&quot;</span>, <span class="stringliteral">@&quot;Open&quot;</span>, nil);
<a name="l01341"></a>01341     }
<a name="l01342"></a>01342 
<a name="l01343"></a>01343     <span class="comment">//Give back focus to the blender window</span>
<a name="l01344"></a>01344     windowsList = [NSApp orderedWindows];
<a name="l01345"></a>01345     <span class="keywordflow">if</span> ([windowsList count]) {
<a name="l01346"></a>01346         [[windowsList objectAtIndex:0] makeKeyAndOrderFront:nil];
<a name="l01347"></a>01347     }
<a name="l01348"></a>01348 
<a name="l01349"></a>01349     <span class="keywordflow">if</span> (confirmOpen == NSAlertAlternateReturn)
<a name="l01350"></a>01350     {
<a name="l01351"></a>01351         filenameTextSize = [filepath lengthOfBytesUsingEncoding:NSUTF8StringEncoding];
<a name="l01352"></a>01352         
<a name="l01353"></a>01353         temp_buff = (<span class="keywordtype">char</span>*) malloc(filenameTextSize+1); 
<a name="l01354"></a>01354         
<a name="l01355"></a>01355         <span class="keywordflow">if</span> (temp_buff == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01356"></a>01356             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01357"></a>01357         }
<a name="l01358"></a>01358         
<a name="l01359"></a>01359         strncpy(temp_buff, [filepath cStringUsingEncoding:NSUTF8StringEncoding], filenameTextSize);
<a name="l01360"></a>01360         
<a name="l01361"></a>01361         temp_buff[filenameTextSize] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01362"></a>01362 
<a name="l01363"></a>01363         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../d0/d31/classGHOST__EventString.html">GHOST_EventString</a>(<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a88839ba1644eac4af1e5b08635445e0a">getMilliSeconds</a>(),<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a606b98b013260989e9eaf6f3f84f3c55">GHOST_kEventOpenMainFile</a>,window,(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a8029e7130be71615b87eeee3439ae245">GHOST_TEventDataPtr</a>) temp_buff));
<a name="l01364"></a>01364 
<a name="l01365"></a>01365         <span class="keywordflow">return</span> <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#ae6553118ce91b9c08f9376941ae1536fa99f136a862ba5c7d16967231c29f09d6">YES</a>;
<a name="l01366"></a>01366     }
<a name="l01367"></a>01367     <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#ae6553118ce91b9c08f9376941ae1536fa0d077f5b932ce05e5b9f30c6087a2f31">NO</a>;
<a name="l01368"></a>01368 }
<a name="l01369"></a>01369 
<a name="l01370"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">01370</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">GHOST_SystemCocoa::handleTabletEvent</a>(<span class="keywordtype">void</span> *eventPtr, <span class="keywordtype">short</span> eventType)
<a name="l01371"></a>01371 {
<a name="l01372"></a>01372     NSEvent *<span class="keyword">event</span> = (NSEvent *)eventPtr;
<a name="l01373"></a>01373     <a class="code" href="../../de/d3a/classGHOST__IWindow.html">GHOST_IWindow</a>* window;
<a name="l01374"></a>01374     
<a name="l01375"></a>01375     window = <a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a9078e2ad35337a10f03a79fb3fe416ef">getWindowAssociatedWithOSWindow</a>((<span class="keywordtype">void</span>*)[event window]);
<a name="l01376"></a>01376     <span class="keywordflow">if</span> (!window) {
<a name="l01377"></a>01377         <span class="comment">//printf(&quot;\nW failure for event 0x%x&quot;,[event type]);</span>
<a name="l01378"></a>01378         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01379"></a>01379     }
<a name="l01380"></a>01380     
<a name="l01381"></a>01381     <a class="code" href="../../d6/da4/structGHOST__TabletData.html">GHOST_TabletData</a>&amp; ct=((GHOST_WindowCocoa*)window)-&gt;GetCocoaTabletData();
<a name="l01382"></a>01382     
<a name="l01383"></a>01383     <span class="keywordflow">switch</span> (eventType) {
<a name="l01384"></a>01384         <span class="keywordflow">case</span> NSTabletPoint:
<a name="l01385"></a>01385             ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a901ed84334874122d01cceed78a7c276">Pressure</a> = [event pressure];
<a name="l01386"></a>01386             ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a727105dd178d62d1945c3bcf1d7a1ced">Xtilt</a> = [event tilt].x;
<a name="l01387"></a>01387             ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#acf15dee6213e645b1fbf17c9d9aaf880">Ytilt</a> = [event tilt].y;
<a name="l01388"></a>01388             <span class="keywordflow">break</span>;
<a name="l01389"></a>01389         
<a name="l01390"></a>01390         <span class="keywordflow">case</span> NSTabletProximity:
<a name="l01391"></a>01391             ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a901ed84334874122d01cceed78a7c276">Pressure</a> = 0;
<a name="l01392"></a>01392             ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a727105dd178d62d1945c3bcf1d7a1ced">Xtilt</a> = 0;
<a name="l01393"></a>01393             ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#acf15dee6213e645b1fbf17c9d9aaf880">Ytilt</a> = 0;
<a name="l01394"></a>01394             <span class="keywordflow">if</span> ([event isEnteringProximity])
<a name="l01395"></a>01395             {
<a name="l01396"></a>01396                 <span class="comment">//pointer is entering tablet area proximity</span>
<a name="l01397"></a>01397                 <span class="keywordflow">switch</span> ([event pointingDeviceType]) {
<a name="l01398"></a>01398                     <span class="keywordflow">case</span> NSPenPointingDevice:
<a name="l01399"></a>01399                         ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a0b7ade8195901e1fdbec7785e8b10ee6">Active</a> = <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a57004bc9c30cdaaee1e4cd968aacb2b9a028c1c84632a63f11b65894e09cc5887">GHOST_kTabletModeStylus</a>;
<a name="l01400"></a>01400                         <span class="keywordflow">break</span>;
<a name="l01401"></a>01401                     <span class="keywordflow">case</span> NSEraserPointingDevice:
<a name="l01402"></a>01402                         ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a0b7ade8195901e1fdbec7785e8b10ee6">Active</a> = <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a57004bc9c30cdaaee1e4cd968aacb2b9a005291fe3a5aafd394eec0675e747629">GHOST_kTabletModeEraser</a>;
<a name="l01403"></a>01403                         <span class="keywordflow">break</span>;
<a name="l01404"></a>01404                     <span class="keywordflow">case</span> NSCursorPointingDevice:
<a name="l01405"></a>01405                     <span class="keywordflow">case</span> NSUnknownPointingDevice:
<a name="l01406"></a>01406                     <span class="keywordflow">default</span>:
<a name="l01407"></a>01407                         ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a0b7ade8195901e1fdbec7785e8b10ee6">Active</a> = <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a57004bc9c30cdaaee1e4cd968aacb2b9a45103b9e5bb871499bcc83acfdd7191f">GHOST_kTabletModeNone</a>;
<a name="l01408"></a>01408                         <span class="keywordflow">break</span>;
<a name="l01409"></a>01409                 }
<a name="l01410"></a>01410             } <span class="keywordflow">else</span> {
<a name="l01411"></a>01411                 <span class="comment">// pointer is leaving - return to mouse</span>
<a name="l01412"></a>01412                 ct.<a class="code" href="../../d6/da4/structGHOST__TabletData.html#a0b7ade8195901e1fdbec7785e8b10ee6">Active</a> = <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a57004bc9c30cdaaee1e4cd968aacb2b9a45103b9e5bb871499bcc83acfdd7191f">GHOST_kTabletModeNone</a>;
<a name="l01413"></a>01413             }
<a name="l01414"></a>01414             <span class="keywordflow">break</span>;
<a name="l01415"></a>01415         
<a name="l01416"></a>01416         <span class="keywordflow">default</span>:
<a name="l01417"></a>01417             <a class="code" href="../../dc/d58/GHOST__Debug_8h.html#a89fb5ce08c9d3fabb619c1b864437746">GHOST_ASSERT</a>(<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,<span class="stringliteral">&quot;GHOST_SystemCocoa::handleTabletEvent : unknown event received&quot;</span>);
<a name="l01418"></a>01418             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01419"></a>01419             <span class="keywordflow">break</span>;
<a name="l01420"></a>01420     }
<a name="l01421"></a>01421     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l01422"></a>01422 }
<a name="l01423"></a>01423 
<a name="l01424"></a>01424 
<a name="l01425"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4350bb9def729a299f5e0bcd1ef618dd">01425</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4350bb9def729a299f5e0bcd1ef618dd">GHOST_SystemCocoa::handleMouseEvent</a>(<span class="keywordtype">void</span> *eventPtr)
<a name="l01426"></a>01426 {
<a name="l01427"></a>01427     NSEvent *<span class="keyword">event</span> = (NSEvent *)eventPtr;
<a name="l01428"></a>01428     GHOST_WindowCocoa* window;
<a name="l01429"></a>01429     
<a name="l01430"></a>01430     window = (GHOST_WindowCocoa*)<a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a9078e2ad35337a10f03a79fb3fe416ef">getWindowAssociatedWithOSWindow</a>((<span class="keywordtype">void</span>*)[event window]);
<a name="l01431"></a>01431     <span class="keywordflow">if</span> (!window) {
<a name="l01432"></a>01432         <span class="comment">//printf(&quot;\nW failure for event 0x%x&quot;,[event type]);</span>
<a name="l01433"></a>01433         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01434"></a>01434     }
<a name="l01435"></a>01435     
<a name="l01436"></a>01436     <span class="keywordflow">switch</span> ([event type])
<a name="l01437"></a>01437     {
<a name="l01438"></a>01438         <span class="keywordflow">case</span> NSLeftMouseDown:
<a name="l01439"></a>01439         <span class="keywordflow">case</span> NSRightMouseDown:
<a name="l01440"></a>01440         <span class="keywordflow">case</span> NSOtherMouseDown:
<a name="l01441"></a>01441             <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../db/d37/classGHOST__EventButton.html">GHOST_EventButton</a>([event timestamp]*1000, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ab52b565c614eec0ab7ce45df7e0ff947" title="Mouse move event.">GHOST_kEventButtonDown</a>, window, <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a26193f365720f04e3370da2808ea0e5a">convertButton</a>([event buttonNumber])));
<a name="l01442"></a>01442             <span class="comment">//Handle tablet events combined with mouse events</span>
<a name="l01443"></a>01443             <span class="keywordflow">switch</span> ([event subtype]) {
<a name="l01444"></a>01444                 <span class="keywordflow">case</span> NX_SUBTYPE_TABLET_POINT:
<a name="l01445"></a>01445                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">handleTabletEvent</a>(eventPtr, NSTabletPoint);
<a name="l01446"></a>01446                     <span class="keywordflow">break</span>;
<a name="l01447"></a>01447                 <span class="keywordflow">case</span> NX_SUBTYPE_TABLET_PROXIMITY:
<a name="l01448"></a>01448                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">handleTabletEvent</a>(eventPtr, NSTabletProximity);
<a name="l01449"></a>01449                     <span class="keywordflow">break</span>;
<a name="l01450"></a>01450                 <span class="keywordflow">default</span>:
<a name="l01451"></a>01451                     <span class="comment">//No tablet event included : do nothing</span>
<a name="l01452"></a>01452                     <span class="keywordflow">break</span>;
<a name="l01453"></a>01453             }
<a name="l01454"></a>01454             <span class="keywordflow">break</span>;
<a name="l01455"></a>01455                         
<a name="l01456"></a>01456         <span class="keywordflow">case</span> NSLeftMouseUp:
<a name="l01457"></a>01457         <span class="keywordflow">case</span> NSRightMouseUp:
<a name="l01458"></a>01458         <span class="keywordflow">case</span> NSOtherMouseUp:
<a name="l01459"></a>01459             <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../db/d37/classGHOST__EventButton.html">GHOST_EventButton</a>([event timestamp]*1000, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a75edbc6f9ddd8ca9efe59af57f1855a1" title="Mouse button event.">GHOST_kEventButtonUp</a>, window, <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a26193f365720f04e3370da2808ea0e5a">convertButton</a>([event buttonNumber])));
<a name="l01460"></a>01460             <span class="comment">//Handle tablet events combined with mouse events</span>
<a name="l01461"></a>01461             <span class="keywordflow">switch</span> ([event subtype]) {
<a name="l01462"></a>01462                 <span class="keywordflow">case</span> NX_SUBTYPE_TABLET_POINT:
<a name="l01463"></a>01463                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">handleTabletEvent</a>(eventPtr, NSTabletPoint);
<a name="l01464"></a>01464                     <span class="keywordflow">break</span>;
<a name="l01465"></a>01465                 <span class="keywordflow">case</span> NX_SUBTYPE_TABLET_PROXIMITY:
<a name="l01466"></a>01466                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">handleTabletEvent</a>(eventPtr, NSTabletProximity);
<a name="l01467"></a>01467                     <span class="keywordflow">break</span>;
<a name="l01468"></a>01468                 <span class="keywordflow">default</span>:
<a name="l01469"></a>01469                     <span class="comment">//No tablet event included : do nothing</span>
<a name="l01470"></a>01470                     <span class="keywordflow">break</span>;
<a name="l01471"></a>01471             }
<a name="l01472"></a>01472             <span class="keywordflow">break</span>;
<a name="l01473"></a>01473             
<a name="l01474"></a>01474         <span class="keywordflow">case</span> NSLeftMouseDragged:
<a name="l01475"></a>01475         <span class="keywordflow">case</span> NSRightMouseDragged:
<a name="l01476"></a>01476         <span class="keywordflow">case</span> NSOtherMouseDragged:               
<a name="l01477"></a>01477             <span class="comment">//Handle tablet events combined with mouse events</span>
<a name="l01478"></a>01478             <span class="keywordflow">switch</span> ([event subtype]) {
<a name="l01479"></a>01479                 <span class="keywordflow">case</span> NX_SUBTYPE_TABLET_POINT:
<a name="l01480"></a>01480                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">handleTabletEvent</a>(eventPtr, NSTabletPoint);
<a name="l01481"></a>01481                     <span class="keywordflow">break</span>;
<a name="l01482"></a>01482                 <span class="keywordflow">case</span> NX_SUBTYPE_TABLET_PROXIMITY:
<a name="l01483"></a>01483                     <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9f9009198e0750d941895d79844b8981">handleTabletEvent</a>(eventPtr, NSTabletProximity);
<a name="l01484"></a>01484                     <span class="keywordflow">break</span>;
<a name="l01485"></a>01485                 <span class="keywordflow">default</span>:
<a name="l01486"></a>01486                     <span class="comment">//No tablet event included : do nothing</span>
<a name="l01487"></a>01487                     <span class="keywordflow">break</span>;
<a name="l01488"></a>01488             }
<a name="l01489"></a>01489             
<a name="l01490"></a>01490         <span class="keywordflow">case</span> NSMouseMoved:
<a name="l01491"></a>01491                 <span class="keywordflow">switch</span> (window-&gt;getCursorGrabMode()) {
<a name="l01492"></a>01492                     <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ab7d992d3f8a0de5dd5a41d24f47106bba91b5c9d376132e0eed7641910d197262">GHOST_kGrabHide</a>: <span class="comment">//Cursor hidden grab operation : no cursor move</span>
<a name="l01493"></a>01493                     {
<a name="l01494"></a>01494                         <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x_warp, y_warp, x_accum, y_accum, x, y;
<a name="l01495"></a>01495                         
<a name="l01496"></a>01496                         window-&gt;getCursorGrabInitPos(x_warp, y_warp);
<a name="l01497"></a>01497                         
<a name="l01498"></a>01498                         window-&gt;getCursorGrabAccum(x_accum, y_accum);
<a name="l01499"></a>01499                         x_accum += [event deltaX];
<a name="l01500"></a>01500                         y_accum += -[event deltaY]; <span class="comment">//Strange Apple implementation (inverted coordinates for the deltaY) ...</span>
<a name="l01501"></a>01501                         window-&gt;setCursorGrabAccum(x_accum, y_accum);
<a name="l01502"></a>01502                         
<a name="l01503"></a>01503                         window-&gt;clientToScreenIntern(x_warp+x_accum, y_warp+y_accum, x, y);
<a name="l01504"></a>01504                         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../db/dee/classGHOST__EventCursor.html">GHOST_EventCursor</a>([event timestamp]*1000, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a5145e18bf4e32ba74fe5ef5e46d073b3">GHOST_kEventCursorMove</a>, window, x, y));
<a name="l01505"></a>01505                     }
<a name="l01506"></a>01506                         <span class="keywordflow">break</span>;
<a name="l01507"></a>01507                     <span class="keywordflow">case</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ab7d992d3f8a0de5dd5a41d24f47106bba066e5a5dd046074d7dfa34392684adf5">GHOST_kGrabWrap</a>: <span class="comment">//Wrap cursor at area/window boundaries</span>
<a name="l01508"></a>01508                     {
<a name="l01509"></a>01509                         NSPoint mousePos = [event locationInWindow];
<a name="l01510"></a>01510                         <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x_mouse= mousePos.x;
<a name="l01511"></a>01511                         <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> y_mouse= mousePos.y;
<a name="l01512"></a>01512                         <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x_accum, y_accum, x_cur, y_cur, x, y;
<a name="l01513"></a>01513                         <a class="code" href="../../d1/d86/classGHOST__Rect.html">GHOST_Rect</a> <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a42f734331cf10fc65cd1c80c5d764ebc">bounds</a>, windowBounds, correctedBounds;
<a name="l01514"></a>01514                         
<a name="l01515"></a>01515                         <span class="comment">/* fallback to window bounds */</span>
<a name="l01516"></a>01516                         <span class="keywordflow">if</span>(window-&gt;getCursorGrabBounds(bounds)==<a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>)
<a name="l01517"></a>01517                             window-&gt;getClientBounds(bounds);
<a name="l01518"></a>01518                         
<a name="l01519"></a>01519                         <span class="comment">//Switch back to Cocoa coordinates orientation (y=0 at botton,the same as blender internal btw!), and to client coordinates</span>
<a name="l01520"></a>01520                         window-&gt;getClientBounds(windowBounds);
<a name="l01521"></a>01521                         window-&gt;screenToClient(bounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#aab06205db4db05745895c45dc18b40fa">m_l</a>, bounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ae3e75e271f7683d270cd32a059e26b39">m_b</a>, correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#aab06205db4db05745895c45dc18b40fa">m_l</a>, correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab1b96623da2e2521e14ecfd59c333a7c">m_t</a>);
<a name="l01522"></a>01522                         window-&gt;screenToClient(bounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab486237b8431d626d698d9ee1085dc2d">m_r</a>, bounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab1b96623da2e2521e14ecfd59c333a7c">m_t</a>, correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab486237b8431d626d698d9ee1085dc2d">m_r</a>, correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ae3e75e271f7683d270cd32a059e26b39">m_b</a>);
<a name="l01523"></a>01523                         correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ae3e75e271f7683d270cd32a059e26b39">m_b</a> = (windowBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ae3e75e271f7683d270cd32a059e26b39">m_b</a> - windowBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab1b96623da2e2521e14ecfd59c333a7c">m_t</a>) - correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ae3e75e271f7683d270cd32a059e26b39">m_b</a>;
<a name="l01524"></a>01524                         correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab1b96623da2e2521e14ecfd59c333a7c">m_t</a> = (windowBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ae3e75e271f7683d270cd32a059e26b39">m_b</a> - windowBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab1b96623da2e2521e14ecfd59c333a7c">m_t</a>) - correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#ab1b96623da2e2521e14ecfd59c333a7c">m_t</a>;
<a name="l01525"></a>01525                         
<a name="l01526"></a>01526                         <span class="comment">//Update accumulation counts</span>
<a name="l01527"></a>01527                         window-&gt;getCursorGrabAccum(x_accum, y_accum);
<a name="l01528"></a>01528                         x_accum += [event deltaX]-<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae1a4443722e903dc2adce06ab34bafa3">m_cursorDelta_x</a>;
<a name="l01529"></a>01529                         y_accum += -[event deltaY]-<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a3ec16b99b6460b7c8cce94febcb22bb6">m_cursorDelta_y</a>; <span class="comment">//Strange Apple implementation (inverted coordinates for the deltaY) ...</span>
<a name="l01530"></a>01530                         window-&gt;setCursorGrabAccum(x_accum, y_accum);
<a name="l01531"></a>01531                         
<a name="l01532"></a>01532                         
<a name="l01533"></a>01533                         <span class="comment">//Warp mouse cursor if needed</span>
<a name="l01534"></a>01534                         x_mouse += [event deltaX]-<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae1a4443722e903dc2adce06ab34bafa3">m_cursorDelta_x</a>;
<a name="l01535"></a>01535                         y_mouse += -[event deltaY]-<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a3ec16b99b6460b7c8cce94febcb22bb6">m_cursorDelta_y</a>;
<a name="l01536"></a>01536                         correctedBounds.<a class="code" href="../../d1/d86/classGHOST__Rect.html#a22dd5dee9b419367588d480cb3636637">wrapPoint</a>(x_mouse, y_mouse, 2);
<a name="l01537"></a>01537                         
<a name="l01538"></a>01538                         <span class="comment">//Compensate for mouse moved event taking cursor position set into account</span>
<a name="l01539"></a>01539                         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae1a4443722e903dc2adce06ab34bafa3">m_cursorDelta_x</a> = x_mouse-mousePos.x;
<a name="l01540"></a>01540                         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a3ec16b99b6460b7c8cce94febcb22bb6">m_cursorDelta_y</a> = y_mouse-mousePos.y;
<a name="l01541"></a>01541                         
<a name="l01542"></a>01542                         <span class="comment">//Set new cursor position</span>
<a name="l01543"></a>01543                         window-&gt;clientToScreenIntern(x_mouse, y_mouse, x_cur, y_cur);
<a name="l01544"></a>01544                         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a04f105db4c542faab7f3f0e8752cbc9f">setMouseCursorPosition</a>(x_cur, y_cur); <span class="comment">/* wrap */</span>
<a name="l01545"></a>01545                         
<a name="l01546"></a>01546                         <span class="comment">//Post event</span>
<a name="l01547"></a>01547                         window-&gt;getCursorGrabInitPos(x_cur, y_cur);
<a name="l01548"></a>01548                         window-&gt;clientToScreenIntern(x_cur + x_accum, y_cur + y_accum, x, y);
<a name="l01549"></a>01549                         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../db/dee/classGHOST__EventCursor.html">GHOST_EventCursor</a>([event timestamp]*1000, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a5145e18bf4e32ba74fe5ef5e46d073b3">GHOST_kEventCursorMove</a>, window, x, y));
<a name="l01550"></a>01550                     }
<a name="l01551"></a>01551                         <span class="keywordflow">break</span>;
<a name="l01552"></a>01552                     <span class="keywordflow">default</span>:
<a name="l01553"></a>01553                     {
<a name="l01554"></a>01554                         <span class="comment">//Normal cursor operation: send mouse position in window</span>
<a name="l01555"></a>01555                         NSPoint mousePos = [event locationInWindow];
<a name="l01556"></a>01556                         <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x, y;
<a name="l01557"></a>01557 
<a name="l01558"></a>01558                         window-&gt;clientToScreenIntern(mousePos.x, mousePos.y, x, y);
<a name="l01559"></a>01559                         <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../db/dee/classGHOST__EventCursor.html">GHOST_EventCursor</a>([event timestamp]*1000, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044a5145e18bf4e32ba74fe5ef5e46d073b3">GHOST_kEventCursorMove</a>, window, x, y));
<a name="l01560"></a>01560 
<a name="l01561"></a>01561                         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#ae1a4443722e903dc2adce06ab34bafa3">m_cursorDelta_x</a>=0;
<a name="l01562"></a>01562                         <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a3ec16b99b6460b7c8cce94febcb22bb6">m_cursorDelta_y</a>=0; <span class="comment">//Mouse motion occurred between two cursor warps, so we can reset the delta counter</span>
<a name="l01563"></a>01563                     }
<a name="l01564"></a>01564                         <span class="keywordflow">break</span>;
<a name="l01565"></a>01565                 }
<a name="l01566"></a>01566                 <span class="keywordflow">break</span>;
<a name="l01567"></a>01567             
<a name="l01568"></a>01568         <span class="keywordflow">case</span> NSScrollWheel:
<a name="l01569"></a>01569             {
<a name="l01570"></a>01570                 <span class="comment">/* Send trackpad event if inside a trackpad gesture, send wheel event otherwise */</span>
<a name="l01571"></a>01571                 <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#afe0af28b0b2df81a0011ddf6140fae27">m_hasMultiTouchTrackpad</a> || !<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a96278251df7640e6bfdc054e1ea3571c">m_isGestureInProgress</a>) {
<a name="l01572"></a>01572                     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> delta;
<a name="l01573"></a>01573                     
<a name="l01574"></a>01574                     <span class="keywordtype">double</span> deltaF = [event deltaY];
<a name="l01575"></a>01575 
<a name="l01576"></a>01576                     <span class="keywordflow">if</span> (deltaF == 0.0) deltaF = [event deltaX]; <span class="comment">// make blender decide if it&#39;s horizontal scroll</span>
<a name="l01577"></a>01577                     <span class="keywordflow">if</span> (deltaF == 0.0) <span class="keywordflow">break</span>; <span class="comment">//discard trackpad delta=0 events</span>
<a name="l01578"></a>01578                     
<a name="l01579"></a>01579                     delta = deltaF &gt; 0.0 ? 1 : -1;
<a name="l01580"></a>01580                     <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../d4/d91/classGHOST__EventWheel.html">GHOST_EventWheel</a>([event timestamp]*1000, window, delta));
<a name="l01581"></a>01581                 }
<a name="l01582"></a>01582                 <span class="keywordflow">else</span> {
<a name="l01583"></a>01583                     NSPoint mousePos = [event locationInWindow];
<a name="l01584"></a>01584                     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x, y;
<a name="l01585"></a>01585                     <span class="keywordtype">double</span> dx = [event deltaX];
<a name="l01586"></a>01586                     <span class="keywordtype">double</span> dy = -[event deltaY];
<a name="l01587"></a>01587                     
<a name="l01588"></a>01588                     <span class="keyword">const</span> <span class="keywordtype">double</span> deltaMax = 50.0;
<a name="l01589"></a>01589                     
<a name="l01590"></a>01590                     <span class="keywordflow">if</span> ((dx == 0) &amp;&amp; (dy == 0)) <span class="keywordflow">break</span>;
<a name="l01591"></a>01591                     
<a name="l01592"></a>01592                     <span class="comment">/* Quadratic acceleration */</span>
<a name="l01593"></a>01593                     dx = dx*(<a class="code" href="../../d1/d22/stdosl_8h.html#a706cbf0492993ed1d280ccf8e9b56682">fabs</a>(dx)+0.5);
<a name="l01594"></a>01594                     <span class="keywordflow">if</span> (dx&lt;0.0) dx-=0.5; <span class="keywordflow">else</span> dx+=0.5;
<a name="l01595"></a>01595                     <span class="keywordflow">if</span> (dx&lt; -deltaMax) dx= -deltaMax; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dx&gt;deltaMax) dx=deltaMax;
<a name="l01596"></a>01596                     
<a name="l01597"></a>01597                     dy = dy*(<a class="code" href="../../d1/d22/stdosl_8h.html#a706cbf0492993ed1d280ccf8e9b56682">fabs</a>(dy)+0.5);
<a name="l01598"></a>01598                     <span class="keywordflow">if</span> (dy&lt;0.0) dy-=0.5; <span class="keywordflow">else</span> dy+=0.5;
<a name="l01599"></a>01599                     <span class="keywordflow">if</span> (dy&lt; -deltaMax) dy= -deltaMax; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dy&gt;deltaMax) dy=deltaMax;
<a name="l01600"></a>01600 
<a name="l01601"></a>01601                     window-&gt;clientToScreenIntern(mousePos.x, mousePos.y, x, y);
<a name="l01602"></a>01602                     dy = -dy;
<a name="l01603"></a>01603 
<a name="l01604"></a>01604                     <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../d2/de2/classGHOST__EventTrackpad.html">GHOST_EventTrackpad</a>([event timestamp]*1000, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a17bcf86444a2f5fbdd6cd723297d0b96acd69c0c2efb9ae2f3367377664704c06">GHOST_kTrackpadEventScroll</a>, x, y, dx, dy));
<a name="l01605"></a>01605                 }
<a name="l01606"></a>01606             }
<a name="l01607"></a>01607             <span class="keywordflow">break</span>;
<a name="l01608"></a>01608             
<a name="l01609"></a>01609         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cda98944690b880bb02726e09ba70aca8b1">NSEventTypeMagnify</a>:
<a name="l01610"></a>01610             {
<a name="l01611"></a>01611                 NSPoint mousePos = [event locationInWindow];
<a name="l01612"></a>01612                 <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x, y;
<a name="l01613"></a>01613                 window-&gt;clientToScreenIntern(mousePos.x, mousePos.y, x, y);
<a name="l01614"></a>01614                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../d2/de2/classGHOST__EventTrackpad.html">GHOST_EventTrackpad</a>([event timestamp]*1000, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a17bcf86444a2f5fbdd6cd723297d0b96a495517439b0d1713628ef03beb4fda33">GHOST_kTrackpadEventMagnify</a>, x, y,
<a name="l01615"></a>01615                                                   [event magnification]*125.0 + 0.1, 0));
<a name="l01616"></a>01616             }
<a name="l01617"></a>01617             <span class="keywordflow">break</span>;
<a name="l01618"></a>01618 
<a name="l01619"></a>01619         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdabcaf3dd7ee365e2eb63669d2afcd9a5a">NSEventTypeRotate</a>:
<a name="l01620"></a>01620             {
<a name="l01621"></a>01621                 NSPoint mousePos = [event locationInWindow];
<a name="l01622"></a>01622                 <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a5546963354d111d37595ed7d26522699">GHOST_TInt32</a> x, y;
<a name="l01623"></a>01623                 window-&gt;clientToScreenIntern(mousePos.x, mousePos.y, x, y);
<a name="l01624"></a>01624                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>(<span class="keyword">new</span> <a class="code" href="../../d2/de2/classGHOST__EventTrackpad.html">GHOST_EventTrackpad</a>([event timestamp]*1000, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a17bcf86444a2f5fbdd6cd723297d0b96acc4d28ea3b0882afe6d612964a3a7bb2">GHOST_kTrackpadEventRotate</a>, x, y,
<a name="l01625"></a>01625                                                   -[event rotation] * 5.0, 0));
<a name="l01626"></a>01626             }
<a name="l01627"></a>01627         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdaf01de0226d935ad525a3971752b11a55">NSEventTypeBeginGesture</a>:
<a name="l01628"></a>01628             <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a96278251df7640e6bfdc054e1ea3571c">m_isGestureInProgress</a> = <span class="keyword">true</span>;
<a name="l01629"></a>01629             <span class="keywordflow">break</span>;
<a name="l01630"></a>01630         <span class="keywordflow">case</span> <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#ac12627b43234a2c5005eca7a2a0a88cdadf7499883a32bc332537d0fb424eabef">NSEventTypeEndGesture</a>:
<a name="l01631"></a>01631             <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a96278251df7640e6bfdc054e1ea3571c">m_isGestureInProgress</a> = <span class="keyword">false</span>;
<a name="l01632"></a>01632             <span class="keywordflow">break</span>;
<a name="l01633"></a>01633         <span class="keywordflow">default</span>:
<a name="l01634"></a>01634             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01635"></a>01635             <span class="keywordflow">break</span>;
<a name="l01636"></a>01636         }
<a name="l01637"></a>01637     
<a name="l01638"></a>01638     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l01639"></a>01639 }
<a name="l01640"></a>01640 
<a name="l01641"></a>01641 
<a name="l01642"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4ae669dfda845c41a4b39d27cc482391">01642</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7d">GHOST_TSuccess</a> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a4ae669dfda845c41a4b39d27cc482391">GHOST_SystemCocoa::handleKeyEvent</a>(<span class="keywordtype">void</span> *eventPtr)
<a name="l01643"></a>01643 {
<a name="l01644"></a>01644     NSEvent *<span class="keyword">event</span> = (NSEvent *)eventPtr;
<a name="l01645"></a>01645     <a class="code" href="../../de/d3a/classGHOST__IWindow.html">GHOST_IWindow</a>* window;
<a name="l01646"></a>01646     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> modifiers;
<a name="l01647"></a>01647     NSString *characters;
<a name="l01648"></a>01648     NSData *convertedCharacters;
<a name="l01649"></a>01649     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7">GHOST_TKey</a> keyCode;
<a name="l01650"></a>01650     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ascii;
<a name="l01651"></a>01651     NSString* charsIgnoringModifiers;
<a name="l01652"></a>01652 
<a name="l01653"></a>01653     window = <a class="code" href="../../db/d6d/classGHOST__System.html#aa706d9c2d0bbc53c4e34d2446001d299">m_windowManager</a>-&gt;<a class="code" href="../../dd/dc9/classGHOST__WindowManager.html#a9078e2ad35337a10f03a79fb3fe416ef">getWindowAssociatedWithOSWindow</a>((<span class="keywordtype">void</span>*)[event window]);
<a name="l01654"></a>01654     <span class="keywordflow">if</span> (!window) {
<a name="l01655"></a>01655         <span class="comment">//printf(&quot;\nW failure for event 0x%x&quot;,[event type]);</span>
<a name="l01656"></a>01656         <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01657"></a>01657     }
<a name="l01658"></a>01658 
<a name="l01659"></a>01659     <span class="keywordtype">char</span> utf8_buf[6]= {<span class="charliteral">&#39;\0&#39;</span>};
<a name="l01660"></a>01660     ascii = 0;
<a name="l01661"></a>01661     
<a name="l01662"></a>01662     <span class="keywordflow">switch</span> ([event type]) {
<a name="l01663"></a>01663 
<a name="l01664"></a>01664         <span class="keywordflow">case</span> NSKeyDown:
<a name="l01665"></a>01665         <span class="keywordflow">case</span> NSKeyUp:
<a name="l01666"></a>01666             charsIgnoringModifiers = [event charactersIgnoringModifiers];
<a name="l01667"></a>01667             <span class="keywordflow">if</span> ([charsIgnoringModifiers <a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>]&gt;0)
<a name="l01668"></a>01668                 keyCode = <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a4a094a504d1fcc42103167f4b83d2d02">convertKey</a>([event keyCode],
<a name="l01669"></a>01669                                      [charsIgnoringModifiers characterAtIndex:0],
<a name="l01670"></a>01670                                      [event type] == NSKeyDown?kUCKeyActionDown:kUCKeyActionUp);
<a name="l01671"></a>01671             <span class="keywordflow">else</span>
<a name="l01672"></a>01672                 keyCode = <a class="code" href="../../d1/def/GHOST__SystemCocoa_8mm.html#a4a094a504d1fcc42103167f4b83d2d02">convertKey</a>([event keyCode],0,
<a name="l01673"></a>01673                                      [event type] == NSKeyDown?kUCKeyActionDown:kUCKeyActionUp);
<a name="l01674"></a>01674 
<a name="l01675"></a>01675             <span class="comment">/* handling both unicode or ascii */</span>
<a name="l01676"></a>01676             characters = [event characters];
<a name="l01677"></a>01677             <span class="keywordflow">if</span> ([characters <a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>]&gt;0) {
<a name="l01678"></a>01678                 convertedCharacters = [characters dataUsingEncoding:NSUTF8StringEncoding];
<a name="l01679"></a>01679                 
<a name="l01680"></a>01680                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; [convertedCharacters length]; x++) {
<a name="l01681"></a>01681                     utf8_buf[x] = ((<span class="keywordtype">char</span>*)[convertedCharacters bytes])[x];
<a name="l01682"></a>01682                 }
<a name="l01683"></a>01683 
<a name="l01684"></a>01684                 <span class="comment">/* ascii is a subset of unicode */</span>
<a name="l01685"></a>01685                 <span class="keywordflow">if</span> ([convertedCharacters <a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>] == 1) {
<a name="l01686"></a>01686                     ascii = utf8_buf[0];
<a name="l01687"></a>01687                 }
<a name="l01688"></a>01688             }
<a name="l01689"></a>01689 
<a name="l01690"></a>01690             <span class="comment">/* arrow keys should not have utf8 */</span>
<a name="l01691"></a>01691             <span class="keywordflow">if</span> ((keyCode &gt; 266) &amp;&amp; (keyCode &lt; 271))
<a name="l01692"></a>01692                 utf8_buf[0] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01693"></a>01693 
<a name="l01694"></a>01694             <span class="keywordflow">if</span> ((keyCode == <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a555ab58adaa4731faf778f3b93fc8a2d">GHOST_kKeyQ</a>) &amp;&amp; (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSCommandKeyMask))
<a name="l01695"></a>01695                 <span class="keywordflow">break</span>; <span class="comment">//Cmd-Q is directly handled by Cocoa</span>
<a name="l01696"></a>01696 
<a name="l01697"></a>01697             <span class="keywordflow">if</span> ([event type] == NSKeyDown) {
<a name="l01698"></a>01698                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>([event timestamp]*1000, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>, window, keyCode, ascii, utf8_buf) );
<a name="l01699"></a>01699                 <span class="comment">//printf(&quot;Key down rawCode=0x%x charsIgnoringModifiers=%c keyCode=%u ascii=%i %c utf8=%s\n&quot;,[event keyCode],[charsIgnoringModifiers length]&gt;0?[charsIgnoringModifiers characterAtIndex:0]:&#39; &#39;,keyCode,ascii,ascii, utf8_buf);</span>
<a name="l01700"></a>01700             } <span class="keywordflow">else</span> {
<a name="l01701"></a>01701                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>([event timestamp]*1000, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, keyCode, 0, <span class="charliteral">&#39;\0&#39;</span>) );
<a name="l01702"></a>01702                 <span class="comment">//printf(&quot;Key up rawCode=0x%x charsIgnoringModifiers=%c keyCode=%u ascii=%i %c utf8=%s\n&quot;,[event keyCode],[charsIgnoringModifiers length]&gt;0?[charsIgnoringModifiers characterAtIndex:0]:&#39; &#39;,keyCode,ascii,ascii, utf8_buf);</span>
<a name="l01703"></a>01703             }
<a name="l01704"></a>01704             <span class="keywordflow">break</span>;
<a name="l01705"></a>01705     
<a name="l01706"></a>01706         <span class="keywordflow">case</span> NSFlagsChanged: 
<a name="l01707"></a>01707             modifiers = [event modifierFlags];
<a name="l01708"></a>01708             
<a name="l01709"></a>01709             <span class="keywordflow">if</span> ((modifiers &amp; NSShiftKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSShiftKeyMask)) {
<a name="l01710"></a>01710                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>([event timestamp]*1000, (modifiers &amp; NSShiftKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7aef2c01413fb34ea291b1786b3073cfe2">GHOST_kKeyLeftShift</a>) );
<a name="l01711"></a>01711             }
<a name="l01712"></a>01712             <span class="keywordflow">if</span> ((modifiers &amp; NSControlKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSControlKeyMask)) {
<a name="l01713"></a>01713                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>([event timestamp]*1000, (modifiers &amp; NSControlKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a6c1164e35e71efead55cb6d113ad664f">GHOST_kKeyLeftControl</a>) );
<a name="l01714"></a>01714             }
<a name="l01715"></a>01715             <span class="keywordflow">if</span> ((modifiers &amp; NSAlternateKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSAlternateKeyMask)) {
<a name="l01716"></a>01716                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>([event timestamp]*1000, (modifiers &amp; NSAlternateKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a1ef1177814e1aed94435442820848278">GHOST_kKeyLeftAlt</a>) );
<a name="l01717"></a>01717             }
<a name="l01718"></a>01718             <span class="keywordflow">if</span> ((modifiers &amp; NSCommandKeyMask) != (<a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> &amp; NSCommandKeyMask)) {
<a name="l01719"></a>01719                 <a class="code" href="../../db/d6d/classGHOST__System.html#ab9b99730467902c70d3461e434d4d1c8">pushEvent</a>( <span class="keyword">new</span> <a class="code" href="../../de/dad/classGHOST__EventKey.html">GHOST_EventKey</a>([event timestamp]*1000, (modifiers &amp; NSCommandKeyMask)?<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044abdd4f5007ae125cb8172f22cae1a1dd1" title="N degree of freedom device button event.">GHOST_kEventKeyDown</a>:<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a316a048a989aa5ecc30cf4356f25d044ae6b90f2387a4b1a1906924872f9b4344">GHOST_kEventKeyUp</a>, window, <a class="code" href="../../d2/d43/GHOST__Types_8h.html#a88d55849c15c1c64b4ff762e40b36fc7a7d8c22a7083c0cdad6e957882937b39f">GHOST_kKeyOS</a>) );
<a name="l01720"></a>01720             }
<a name="l01721"></a>01721             
<a name="l01722"></a>01722             <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a9adb053aa858704228ac026d9d6d592d">m_modifierMask</a> = modifiers;
<a name="l01723"></a>01723             <span class="keywordflow">break</span>;
<a name="l01724"></a>01724             
<a name="l01725"></a>01725         <span class="keywordflow">default</span>:
<a name="l01726"></a>01726             <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7da619729d5dc3b0728267762027b82d32e">GHOST_kFailure</a>;
<a name="l01727"></a>01727             <span class="keywordflow">break</span>;
<a name="l01728"></a>01728     }
<a name="l01729"></a>01729     
<a name="l01730"></a>01730     <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#aa2df2b3c68e500b618ce5fdcb1cb1a7dabdfeef9ee5de58b8a6d55803a6b8baf8">GHOST_kSuccess</a>;
<a name="l01731"></a>01731 }
<a name="l01732"></a>01732 
<a name="l01733"></a>01733 
<a name="l01734"></a>01734 
<a name="l01735"></a>01735 <span class="preprocessor">#pragma mark Clipboard get/set</span>
<a name="l01736"></a>01736 <span class="preprocessor"></span>
<a name="l01737"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a75b49e05b89e9f94e4720cca959ea431">01737</a> <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>* <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a75b49e05b89e9f94e4720cca959ea431">GHOST_SystemCocoa::getClipboard</a>(<span class="keywordtype">bool</span> selection)<span class="keyword"> const</span>
<a name="l01738"></a>01738 <span class="keyword"></span>{
<a name="l01739"></a>01739     <a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a> * temp_buff;
<a name="l01740"></a>01740     <span class="keywordtype">size_t</span> pastedTextSize;  
<a name="l01741"></a>01741     
<a name="l01742"></a>01742     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l01743"></a>01743     
<a name="l01744"></a>01744     NSPasteboard *pasteBoard = [NSPasteboard generalPasteboard];
<a name="l01745"></a>01745     
<a name="l01746"></a>01746     <span class="keywordflow">if</span> (pasteBoard == nil) {
<a name="l01747"></a>01747         [pool drain];
<a name="l01748"></a>01748         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01749"></a>01749     }
<a name="l01750"></a>01750     
<a name="l01751"></a>01751     NSArray *supportedTypes =
<a name="l01752"></a>01752         [NSArray arrayWithObjects: NSStringPboardType, nil];
<a name="l01753"></a>01753     
<a name="l01754"></a>01754     NSString *bestType = [[NSPasteboard generalPasteboard]
<a name="l01755"></a>01755                           availableTypeFromArray:supportedTypes];
<a name="l01756"></a>01756     
<a name="l01757"></a>01757     <span class="keywordflow">if</span> (bestType == nil) {
<a name="l01758"></a>01758         [pool drain];
<a name="l01759"></a>01759         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01760"></a>01760     }
<a name="l01761"></a>01761     
<a name="l01762"></a>01762     NSString * textPasted = [pasteBoard stringForType:NSStringPboardType];
<a name="l01763"></a>01763 
<a name="l01764"></a>01764     <span class="keywordflow">if</span> (textPasted == nil) {
<a name="l01765"></a>01765         [pool drain];
<a name="l01766"></a>01766         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01767"></a>01767     }
<a name="l01768"></a>01768     
<a name="l01769"></a>01769     pastedTextSize = [textPasted lengthOfBytesUsingEncoding:NSUTF8StringEncoding];
<a name="l01770"></a>01770     
<a name="l01771"></a>01771     temp_buff = (<a class="code" href="../../d2/d43/GHOST__Types_8h.html#ac899f59b362ca3798de49aef2fb24fff">GHOST_TUns8</a>*) malloc(pastedTextSize+1); 
<a name="l01772"></a>01772 
<a name="l01773"></a>01773     <span class="keywordflow">if</span> (temp_buff == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01774"></a>01774         [pool drain];
<a name="l01775"></a>01775         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01776"></a>01776     }
<a name="l01777"></a>01777     
<a name="l01778"></a>01778     strncpy((<span class="keywordtype">char</span>*)temp_buff, [textPasted cStringUsingEncoding:NSUTF8StringEncoding], pastedTextSize);
<a name="l01779"></a>01779     
<a name="l01780"></a>01780     temp_buff[pastedTextSize] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01781"></a>01781     
<a name="l01782"></a>01782     [pool drain];
<a name="l01783"></a>01783 
<a name="l01784"></a>01784     <span class="keywordflow">if</span>(temp_buff) {
<a name="l01785"></a>01785         <span class="keywordflow">return</span> temp_buff;
<a name="l01786"></a>01786     } <span class="keywordflow">else</span> {
<a name="l01787"></a>01787         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01788"></a>01788     }
<a name="l01789"></a>01789 }
<a name="l01790"></a>01790 
<a name="l01791"></a><a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a08f46b3a3e48dee0f61e46e2cd09d460">01791</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d16/classGHOST__SystemCocoa.html#a08f46b3a3e48dee0f61e46e2cd09d460">GHOST_SystemCocoa::putClipboard</a>(<a class="code" href="../../d2/d43/GHOST__Types_8h.html#a91ce42cdaaa11ecbbf44bbd683c14c00">GHOST_TInt8</a> *buffer, <span class="keywordtype">bool</span> selection)<span class="keyword"> const</span>
<a name="l01792"></a>01792 <span class="keyword"></span>{
<a name="l01793"></a>01793     NSString *textToCopy;
<a name="l01794"></a>01794     
<a name="l01795"></a>01795     <span class="keywordflow">if</span>(selection) {<span class="keywordflow">return</span>;} <span class="comment">// for copying the selection, used on X11</span>
<a name="l01796"></a>01796 
<a name="l01797"></a>01797     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
<a name="l01798"></a>01798         
<a name="l01799"></a>01799     NSPasteboard *pasteBoard = [NSPasteboard generalPasteboard];
<a name="l01800"></a>01800     
<a name="l01801"></a>01801     <span class="keywordflow">if</span> (pasteBoard == nil) {
<a name="l01802"></a>01802         [pool drain];
<a name="l01803"></a>01803         <span class="keywordflow">return</span>;
<a name="l01804"></a>01804     }
<a name="l01805"></a>01805     
<a name="l01806"></a>01806     NSArray *supportedTypes = [NSArray arrayWithObject:NSStringPboardType];
<a name="l01807"></a>01807     
<a name="l01808"></a>01808     [pasteBoard declareTypes:supportedTypes owner:nil];
<a name="l01809"></a>01809     
<a name="l01810"></a>01810     textToCopy = [NSString stringWithCString:buffer encoding:NSUTF8StringEncoding];
<a name="l01811"></a>01811     
<a name="l01812"></a>01812     [pasteBoard setString:textToCopy forType:NSStringPboardType];
<a name="l01813"></a>01813     
<a name="l01814"></a>01814     [pool drain];
<a name="l01815"></a>01815 }
<a name="l01816"></a>01816 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:21 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
