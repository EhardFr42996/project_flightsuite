<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: space_view3d.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">space_view3d.c</div>  </div>
</div>
<div class="contents">
<a href="../../de/d28/space__view3d_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version. </span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2008 Blender Foundation.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * </span>
<a name="l00022"></a>00022 <span class="comment"> * Contributor(s): Blender Foundation</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d88/BLI__rand_8h.html" title="Random number functions.">BLI_rand.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dac/BKE__object_8h.html" title="General operations, lookup, etc. for blender objects.">BKE_object.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/da3/BKE__screen_8h.html">BKE_screen.h</a>&quot;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d5f/ED__space__api_8h.html">ED_space_api.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7a/ED__object_8h.html">ED_object.h</a>&quot;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d44/BIF__gl_8h.html">BIF_gl.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../db/da9/RE__engine_8h.html">RE_engine.h</a>&quot;</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d96/UI__resources_8h.html">UI_resources.h</a>&quot;</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/df4/view3d__intern_8h.html">view3d_intern.h</a>&quot;</span>  <span class="comment">// own include</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/* ******************** manage regions ********************* */</span>
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="../../d4/df4/view3d__intern_8h.html#aaa7c7766d520407052a176270150919e">00069</a> <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../de/d28/space__view3d_8c.html#aaa7c7766d520407052a176270150919e">view3d_has_buttons_region</a>(<a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa)
<a name="l00070"></a>00070 {
<a name="l00071"></a>00071     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, *arnew;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073     ar = <a class="code" href="../../d7/da3/BKE__screen_8h.html#a5094bc7dbca089e838bcd5fc9bcb52a7">BKE_area_find_region_type</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a1324ee7084207af80aad66c626841e8c">RGN_TYPE_UI</a>);
<a name="l00074"></a>00074     <span class="keywordflow">if</span> (ar) <span class="keywordflow">return</span> ar;
<a name="l00075"></a>00075     
<a name="l00076"></a>00076     <span class="comment">/* add subdiv level; after header */</span>
<a name="l00077"></a>00077     ar = <a class="code" href="../../d7/da3/BKE__screen_8h.html#a5094bc7dbca089e838bcd5fc9bcb52a7">BKE_area_find_region_type</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079     <span class="comment">/* is error! */</span>
<a name="l00080"></a>00080     <span class="keywordflow">if</span> (ar == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00081"></a>00081     
<a name="l00082"></a>00082     arnew = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;buttons for view3d&quot;</span>);
<a name="l00083"></a>00083     
<a name="l00084"></a>00084     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a9c299678f8810312806da26e6132ccc7">BLI_insertlinkafter</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>, ar, arnew);
<a name="l00085"></a>00085     arnew-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a1324ee7084207af80aad66c626841e8c">RGN_TYPE_UI</a>;
<a name="l00086"></a>00086     arnew-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a>;
<a name="l00087"></a>00087     
<a name="l00088"></a>00088     arnew-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>;
<a name="l00089"></a>00089     
<a name="l00090"></a>00090     <span class="keywordflow">return</span> arnew;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="../../d4/df4/view3d__intern_8h.html#afaca517bcaf6f166c47c490ef5d7ce00">00093</a> <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../de/d28/space__view3d_8c.html#afaca517bcaf6f166c47c490ef5d7ce00">view3d_has_tools_region</a>(<a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa)
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, *artool = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *arprops = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *arhead;
<a name="l00096"></a>00096     
<a name="l00097"></a>00097     <span class="keywordflow">for</span> (ar = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>) {
<a name="l00098"></a>00098         <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ad274603e567ada5179c2a7a3d5fb99f4">RGN_TYPE_TOOLS</a>)
<a name="l00099"></a>00099             artool = ar;
<a name="l00100"></a>00100         <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2aef41b39373a2eb1b6497f25ce95c05e3">RGN_TYPE_TOOL_PROPS</a>)
<a name="l00101"></a>00101             arprops = ar;
<a name="l00102"></a>00102     }
<a name="l00103"></a>00103     
<a name="l00104"></a>00104     <span class="comment">/* tool region hide/unhide also hides props */</span>
<a name="l00105"></a>00105     <span class="keywordflow">if</span> (arprops &amp;&amp; artool) <span class="keywordflow">return</span> artool;
<a name="l00106"></a>00106     
<a name="l00107"></a>00107     <span class="keywordflow">if</span> (artool == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00108"></a>00108         <span class="comment">/* add subdiv level; after header */</span>
<a name="l00109"></a>00109         <span class="keywordflow">for</span> (arhead = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; arhead; arhead = arhead-&gt;next)
<a name="l00110"></a>00110             <span class="keywordflow">if</span> (arhead-&gt;regiontype == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>)
<a name="l00111"></a>00111                 <span class="keywordflow">break</span>;
<a name="l00112"></a>00112         
<a name="l00113"></a>00113         <span class="comment">/* is error! */</span>
<a name="l00114"></a>00114         <span class="keywordflow">if</span> (arhead == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00115"></a>00115         
<a name="l00116"></a>00116         artool = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;tools for view3d&quot;</span>);
<a name="l00117"></a>00117         
<a name="l00118"></a>00118         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a9c299678f8810312806da26e6132ccc7">BLI_insertlinkafter</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>, arhead, artool);
<a name="l00119"></a>00119         artool-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ad274603e567ada5179c2a7a3d5fb99f4">RGN_TYPE_TOOLS</a>;
<a name="l00120"></a>00120         artool-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>; <span class="comment">//RGN_OVERLAP_LEFT;</span>
<a name="l00121"></a>00121         artool-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>;
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="keywordflow">if</span> (arprops == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00125"></a>00125         <span class="comment">/* add extra subdivided region for tool properties */</span>
<a name="l00126"></a>00126         arprops = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;tool props for view3d&quot;</span>);
<a name="l00127"></a>00127         
<a name="l00128"></a>00128         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a9c299678f8810312806da26e6132ccc7">BLI_insertlinkafter</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>, artool, arprops);
<a name="l00129"></a>00129         arprops-&gt;regiontype = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2aef41b39373a2eb1b6497f25ce95c05e3">RGN_TYPE_TOOL_PROPS</a>;
<a name="l00130"></a>00130         arprops-&gt;alignment = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a> | <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a8a5e3e090a3f96966048a2082a3ad8bb">RGN_SPLIT_PREV</a>;
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132     
<a name="l00133"></a>00133     <span class="keywordflow">return</span> artool;
<a name="l00134"></a>00134 }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="comment">/* ****************************************************** */</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="comment">/* function to always find a regionview3d context inside 3D window */</span>
<a name="l00139"></a><a class="code" href="../../de/d28/space__view3d_8c.html#aef68679659d0a49430b348edda54a4fb">00139</a> <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *<a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad7a31725b14f8332b355403058e71019">ED_view3d_context_rv3d</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00140"></a>00140 {
<a name="l00141"></a>00141     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = <a class="code" href="../../df/d01/BKE__context_8h.html#af03543cb8e3fa2c39bb777962a6eae13">CTX_wm_region_view3d</a>(C);
<a name="l00142"></a>00142     
<a name="l00143"></a>00143     <span class="keywordflow">if</span> (rv3d == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00144"></a>00144         <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00145"></a>00145         <span class="keywordflow">if</span> (sa &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>) {
<a name="l00146"></a>00146             <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../d7/da3/BKE__screen_8h.html#a5094bc7dbca089e838bcd5fc9bcb52a7">BKE_area_find_region_type</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>);
<a name="l00147"></a>00147             <span class="keywordflow">if</span> (ar) {
<a name="l00148"></a>00148                 rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00149"></a>00149             }
<a name="l00150"></a>00150         }
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152     <span class="keywordflow">return</span> rv3d;
<a name="l00153"></a>00153 }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="comment">/* ideally would return an rv3d but in some cases the region is needed too</span>
<a name="l00156"></a>00156 <span class="comment"> * so return that, the caller can then access the ar-&gt;regiondata */</span>
<a name="l00157"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a65c20f2e958798410dd2314cae5c6c35">00157</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad4cf23696859003e2cfe90b838cbdee8">ED_view3d_context_user_region</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d6/deb/structView3D.html">View3D</a> **v3d_r, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> **ar_r)
<a name="l00158"></a>00158 {
<a name="l00159"></a>00159     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     *v3d_r = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00162"></a>00162     *ar_r = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="keywordflow">if</span> (sa &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>) {
<a name="l00165"></a>00165         <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00166"></a>00166         <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = (<a class="code" href="../../d6/deb/structView3D.html">View3D</a> *)sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168         <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (ar) {
<a name="l00169"></a>00169             <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00170"></a>00170             <span class="keywordflow">if</span> (rv3d &amp;&amp; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2f24be354ab2bdec931764dda203ca3c">viewlock</a> == 0) {
<a name="l00171"></a>00171                 *v3d_r = v3d;
<a name="l00172"></a>00172                 *ar_r = ar;
<a name="l00173"></a>00173                 <span class="keywordflow">return</span> 1;
<a name="l00174"></a>00174             }
<a name="l00175"></a>00175             <span class="keywordflow">else</span> {
<a name="l00176"></a>00176                 <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar_unlock_user = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00177"></a>00177                 <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar_unlock = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00178"></a>00178                 <span class="keywordflow">for</span> (ar = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>) {
<a name="l00179"></a>00179                     <span class="comment">/* find the first unlocked rv3d */</span>
<a name="l00180"></a>00180                     <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>) {
<a name="l00181"></a>00181                         rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00182"></a>00182                         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2f24be354ab2bdec931764dda203ca3c">viewlock</a> == 0) {
<a name="l00183"></a>00183                             ar_unlock = ar;
<a name="l00184"></a>00184                             <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> == <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#abfc50fa3da91cc0d90401d24414e2482">RV3D_PERSP</a> || rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> == <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a4c869f8f07a58e54e43d35474bbe4757">RV3D_CAMOB</a>) {
<a name="l00185"></a>00185                                 ar_unlock_user = ar;
<a name="l00186"></a>00186                                 <span class="keywordflow">break</span>;
<a name="l00187"></a>00187                             }
<a name="l00188"></a>00188                         } 
<a name="l00189"></a>00189                     }
<a name="l00190"></a>00190                 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192                 <span class="comment">/* camera/perspective view get priority when the active region is locked */</span>
<a name="l00193"></a>00193                 <span class="keywordflow">if</span> (ar_unlock_user) {
<a name="l00194"></a>00194                     *v3d_r = v3d;
<a name="l00195"></a>00195                     *ar_r = ar_unlock_user;
<a name="l00196"></a>00196                     <span class="keywordflow">return</span> 1;
<a name="l00197"></a>00197                 }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199                 <span class="keywordflow">if</span> (ar_unlock) {
<a name="l00200"></a>00200                     *v3d_r = v3d;
<a name="l00201"></a>00201                     *ar_r = ar_unlock;
<a name="l00202"></a>00202                     <span class="keywordflow">return</span> 1;
<a name="l00203"></a>00203                 }
<a name="l00204"></a>00204             }
<a name="l00205"></a>00205         }
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <span class="keywordflow">return</span> 0;
<a name="l00209"></a>00209 }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="comment">/* Most of the time this isn&#39;t needed since you could assume the view matrix was</span>
<a name="l00212"></a>00212 <span class="comment"> * set while drawing, however when functions like mesh_foreachScreenVert are</span>
<a name="l00213"></a>00213 <span class="comment"> * called by selection tools, we can&#39;t be sure this object was the last.</span>
<a name="l00214"></a>00214 <span class="comment"> *</span>
<a name="l00215"></a>00215 <span class="comment"> * for example, transparent objects are drawn after editmode and will cause</span>
<a name="l00216"></a>00216 <span class="comment"> * the rv3d mat&#39;s to change and break selection.</span>
<a name="l00217"></a>00217 <span class="comment"> *</span>
<a name="l00218"></a>00218 <span class="comment"> * &#39;ED_view3d_init_mats_rv3d&#39; should be called before</span>
<a name="l00219"></a>00219 <span class="comment"> * view3d_project_short_clip and view3d_project_short_noclip in cases where</span>
<a name="l00220"></a>00220 <span class="comment"> * these functions are not used during draw_object</span>
<a name="l00221"></a>00221 <span class="comment"> */</span>
<a name="l00222"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a24e3af8e001ec247ef564377a403c05a">00222</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a24e3af8e001ec247ef564377a403c05a">ED_view3d_init_mats_rv3d</a>(<span class="keyword">struct</span> <a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <span class="keyword">struct</span> <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d)
<a name="l00223"></a>00223 {
<a name="l00224"></a>00224     <span class="comment">/* local viewmat and persmat, to calculate projections */</span>
<a name="l00225"></a>00225     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ae41a59d6db4a10a85f8fbf1e3842ba81">mult_m4_m4m4</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a12d37f255c840dce64ab32aac76bb860">viewmatob</a>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ad04178a1375cc4ef5c59a76b723f822f">viewmat</a>, ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00226"></a>00226     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ae41a59d6db4a10a85f8fbf1e3842ba81">mult_m4_m4m4</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ad0cd2f1eea91b899b403cf8e432513f4">persmatob</a>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8ab36b8b8caeec087fd9595c33e90775">persmat</a>, ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="comment">/* initializes object space clipping, speeds up clip tests */</span>
<a name="l00229"></a>00229     <a class="code" href="../../d8/d6a/ED__view3d_8h.html#af23af849d7708b6c8c92edc20bb450af">ED_view3d_clipping_local</a>(rv3d, ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="../../de/d28/space__view3d_8c.html#af77e75028798a3f75263d2ad6ab74406">00232</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d6a/ED__view3d_8h.html#af77e75028798a3f75263d2ad6ab74406">ED_view3d_init_mats_rv3d_gl</a>(<span class="keyword">struct</span> <a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <span class="keyword">struct</span> <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234     <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a24e3af8e001ec247ef564377a403c05a">ED_view3d_init_mats_rv3d</a>(ob, rv3d);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236     <span class="comment">/* we have to multiply instead of loading viewmatob to make</span>
<a name="l00237"></a>00237 <span class="comment">     * it work with duplis using displists, otherwise it will</span>
<a name="l00238"></a>00238 <span class="comment">     * override the dupli-matrix */</span>
<a name="l00239"></a>00239     <a class="code" href="../../dd/d44/BIF__gl_8h.html#a22a8b7985dcd174e9add6f20aa37a962">glMultMatrixf</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00240"></a>00240 }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="comment">/* ******************** default callbacks for view3d space ***************** */</span>
<a name="l00243"></a>00243 
<a name="l00244"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a6f70e4862d0df4bfe6568c7623b98f15">00244</a> <span class="keyword">static</span> <a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *<a class="code" href="../../de/d28/space__view3d_8c.html#a6f70e4862d0df4bfe6568c7623b98f15">view3d_new</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00245"></a>00245 {
<a name="l00246"></a>00246     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00247"></a>00247     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar;
<a name="l00248"></a>00248     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d;
<a name="l00249"></a>00249     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d;
<a name="l00250"></a>00250     
<a name="l00251"></a>00251     v3d = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d6/deb/structView3D.html">View3D</a>), <span class="stringliteral">&quot;initview3d&quot;</span>);
<a name="l00252"></a>00252     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a54949b71a2d0f4c37057f65ec3877f74">spacetype</a> = <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>;
<a name="l00253"></a>00253     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#af73a1bfc79d6e742d9b96992c8c71518">blockscale</a> = 0.7f;
<a name="l00254"></a>00254     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a45ac0a23240ec719b0952d62190e9130">lay</a> = v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a20eb2672523f97b49bc5fce33828021a">layact</a> = 1;
<a name="l00255"></a>00255     <span class="keywordflow">if</span> (scene) {
<a name="l00256"></a>00256         v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a45ac0a23240ec719b0952d62190e9130">lay</a> = v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a20eb2672523f97b49bc5fce33828021a">layact</a> = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a506dd867fc58506c37c1e56f6b134056">lay</a>;
<a name="l00257"></a>00257         v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a4eb998ff28617b65a2e6c431f319ac9a">camera</a> = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad050647276d4d850d127173450933107">camera</a>;
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a9b985c482e62755068cdd28ed0d50e50">scenelock</a> = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00260"></a>00260     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#aaee600b6bd2db36f2d2b53d433ffa4eb">grid</a> = 1.0f;
<a name="l00261"></a>00261     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#aadccf98762844bc1640c456817d65ae0">gridlines</a> = 16;
<a name="l00262"></a>00262     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a69fc4ce9fb26597c3bc6d254aaab798e">gridsubdiv</a> = 10;
<a name="l00263"></a>00263     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a591cd4c57e5a79352f6733f6fa2bc1c9">drawtype</a> = <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a02098d23ce96d480e90882bed52cb89d">OB_SOLID</a>;
<a name="l00264"></a>00264     
<a name="l00265"></a>00265     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a37adbba9358d3056e49aa538bd0bd960">gridflag</a> |= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#ab1f13e12fbc9aa7dfde7a301ace8ad8c">V3D_SHOW_X</a>;
<a name="l00266"></a>00266     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a37adbba9358d3056e49aa538bd0bd960">gridflag</a> |= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a96ee39bb05d78d9409d861aec5d57026">V3D_SHOW_Y</a>;
<a name="l00267"></a>00267     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a37adbba9358d3056e49aa538bd0bd960">gridflag</a> |= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#aefc15bee33771395e1804b1d33b61969">V3D_SHOW_FLOOR</a>;
<a name="l00268"></a>00268     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a37adbba9358d3056e49aa538bd0bd960">gridflag</a> &amp;= ~<a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a7a6ddc772c2839589a2b23ec7fed2d91">V3D_SHOW_Z</a>;
<a name="l00269"></a>00269     
<a name="l00270"></a>00270     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a97a32d38ce1481d61d60dc677693ce5d">flag</a> |= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a5556e5caae70d11b0f6aacf0ebb02f2f">V3D_SELECT_OUTLINE</a>;
<a name="l00271"></a>00271     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a70f4e893f7a84825c972ac65835d02bb">flag2</a> |= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a80073cb1e48d29283ad830be5353bdb3">V3D_SHOW_RECONSTRUCTION</a>;
<a name="l00272"></a>00272     
<a name="l00273"></a>00273     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a11bb79c913de7b38d21b9a3bece7c767">lens</a> = 35.0f;
<a name="l00274"></a>00274     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#aba3819f92b7807dcb98e1bc8605be7cb">near</a> = 0.01f;
<a name="l00275"></a>00275     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#af51cbdca30d806138c2b3a734b4df2b5">far</a> = 1000.0f;
<a name="l00276"></a>00276 
<a name="l00277"></a>00277     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#afe45541c90f2e43b78f8f8e7b955514d">twflag</a> |= <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.tw_flag &amp; <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a89e14c0010d0f1d7755dd750a5a9a97c">V3D_USE_MANIPULATOR</a>;
<a name="l00278"></a>00278     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a4fe725baacd2dde9697fdc67f7449e8b">twtype</a> = <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a1a81a4a704345e89a1e585acdcfba158">V3D_MANIP_TRANSLATE</a>;
<a name="l00279"></a>00279     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a78a9cea7025be4f40ba5e11de798e4b3">around</a> = <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#afd8c47e8e264b1f878a625b2d9d72858">V3D_CENTROID</a>;
<a name="l00280"></a>00280     
<a name="l00281"></a>00281     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a1403b2a117470cc7d9dd920e410a0dfe">bundle_size</a> = 0.2f;
<a name="l00282"></a>00282     v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#aeb48804272fd41192e6d642a030447b7">bundle_drawtype</a> = <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a9d1de056519bc074a2b9274320833f46">OB_PLAINAXES</a>;
<a name="l00283"></a>00283     
<a name="l00284"></a>00284     <span class="comment">/* header */</span>
<a name="l00285"></a>00285     ar = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;header for view3d&quot;</span>);
<a name="l00286"></a>00286     
<a name="l00287"></a>00287     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#ac9200c617c4513e638686629876c28ca">regionbase</a>, ar);
<a name="l00288"></a>00288     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>;
<a name="l00289"></a>00289     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a>;
<a name="l00290"></a>00290     
<a name="l00291"></a>00291     <span class="comment">/* tool shelf */</span>
<a name="l00292"></a>00292     ar = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;toolshelf for view3d&quot;</span>);
<a name="l00293"></a>00293     
<a name="l00294"></a>00294     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#ac9200c617c4513e638686629876c28ca">regionbase</a>, ar);
<a name="l00295"></a>00295     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ad274603e567ada5179c2a7a3d5fb99f4">RGN_TYPE_TOOLS</a>;
<a name="l00296"></a>00296     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>;
<a name="l00297"></a>00297     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>;
<a name="l00298"></a>00298     
<a name="l00299"></a>00299     <span class="comment">/* tool properties */</span>
<a name="l00300"></a>00300     ar = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;tool properties for view3d&quot;</span>);
<a name="l00301"></a>00301     
<a name="l00302"></a>00302     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#ac9200c617c4513e638686629876c28ca">regionbase</a>, ar);
<a name="l00303"></a>00303     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2aef41b39373a2eb1b6497f25ce95c05e3">RGN_TYPE_TOOL_PROPS</a>;
<a name="l00304"></a>00304     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a> | <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a8a5e3e090a3f96966048a2082a3ad8bb">RGN_SPLIT_PREV</a>;
<a name="l00305"></a>00305     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>;
<a name="l00306"></a>00306     
<a name="l00307"></a>00307     <span class="comment">/* buttons/list view */</span>
<a name="l00308"></a>00308     ar = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;buttons for view3d&quot;</span>);
<a name="l00309"></a>00309     
<a name="l00310"></a>00310     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#ac9200c617c4513e638686629876c28ca">regionbase</a>, ar);
<a name="l00311"></a>00311     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a1324ee7084207af80aad66c626841e8c">RGN_TYPE_UI</a>;
<a name="l00312"></a>00312     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a>;
<a name="l00313"></a>00313     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>;
<a name="l00314"></a>00314     
<a name="l00315"></a>00315     <span class="comment">/* main area */</span>
<a name="l00316"></a>00316     ar = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;main area for view3d&quot;</span>);
<a name="l00317"></a>00317     
<a name="l00318"></a>00318     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#ac9200c617c4513e638686629876c28ca">regionbase</a>, ar);
<a name="l00319"></a>00319     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>;
<a name="l00320"></a>00320     
<a name="l00321"></a>00321     ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a>), <span class="stringliteral">&quot;region view3d&quot;</span>);
<a name="l00322"></a>00322     rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00323"></a>00323     rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>[0] = 1.0f;
<a name="l00324"></a>00324     rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> = <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#abfc50fa3da91cc0d90401d24414e2482">RV3D_PERSP</a>;
<a name="l00325"></a>00325     rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a> = <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#aa72b4a41025c81315f3ca80a94ce65f9">RV3D_VIEW_PERSPORTHO</a>;
<a name="l00326"></a>00326     rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5a4f191256ccc5c28828b922636ca588">dist</a> = 10.0;
<a name="l00327"></a>00327     
<a name="l00328"></a>00328     <span class="keywordflow">return</span> (<a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *)v3d;
<a name="l00329"></a>00329 }
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 <span class="comment">/* not spacelink itself */</span>
<a name="l00332"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a2e371e18311c7b29d472f2e6c10b2d13">00332</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a2e371e18311c7b29d472f2e6c10b2d13">view3d_free</a>(<a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *sl)
<a name="l00333"></a>00333 {
<a name="l00334"></a>00334     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *vd = (<a class="code" href="../../d6/deb/structView3D.html">View3D</a> *) sl;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;vd-&gt;<a class="code" href="../../d6/deb/structView3D.html#a3246c1cbdd50c393126180ae4446992e">bgpicbase</a>);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338     <span class="keywordflow">if</span> (vd-&gt;<a class="code" href="../../d6/deb/structView3D.html#a7e87bb98f5f62744d30d1accb87cc664">localvd</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(vd-&gt;<a class="code" href="../../d6/deb/structView3D.html#a7e87bb98f5f62744d30d1accb87cc664">localvd</a>);
<a name="l00339"></a>00339     
<a name="l00340"></a>00340     <span class="keywordflow">if</span> (vd-&gt;<a class="code" href="../../d6/deb/structView3D.html#a1218103b2d22b4f78191fe145c07f4d2">properties_storage</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(vd-&gt;<a class="code" href="../../d6/deb/structView3D.html#a1218103b2d22b4f78191fe145c07f4d2">properties_storage</a>);
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="comment">/* spacetype; init callback */</span>
<a name="l00345"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a7e69c97823a35b8c7bab4af8a1351131">00345</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a7e69c97823a35b8c7bab4af8a1351131">view3d_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(wm), <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(sa))
<a name="l00346"></a>00346 {
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a1561e1344918a6d684a2e85df2a66d69">00350</a> <span class="keyword">static</span> <a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *<a class="code" href="../../de/d28/space__view3d_8c.html#a1561e1344918a6d684a2e85df2a66d69">view3d_duplicate</a>(<a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *sl)
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3do = (<a class="code" href="../../d6/deb/structView3D.html">View3D</a> *)sl;
<a name="l00353"></a>00353     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3dn = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(sl);
<a name="l00354"></a>00354     
<a name="l00355"></a>00355     <span class="comment">/* clear or remove stuff from old */</span>
<a name="l00356"></a>00356     
<a name="l00357"></a>00357 <span class="comment">// XXX  BIF_view3d_previewrender_free(v3do);</span>
<a name="l00358"></a>00358     
<a name="l00359"></a>00359     <span class="keywordflow">if</span> (v3do-&gt;<a class="code" href="../../d6/deb/structView3D.html#a7e87bb98f5f62744d30d1accb87cc664">localvd</a>) {
<a name="l00360"></a>00360         v3do-&gt;<a class="code" href="../../d6/deb/structView3D.html#a7e87bb98f5f62744d30d1accb87cc664">localvd</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00361"></a>00361         v3do-&gt;<a class="code" href="../../d6/deb/structView3D.html#a1218103b2d22b4f78191fe145c07f4d2">properties_storage</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00362"></a>00362         v3do-&gt;<a class="code" href="../../d6/deb/structView3D.html#a45ac0a23240ec719b0952d62190e9130">lay</a> = v3dn-&gt;<a class="code" href="../../d6/deb/structView3D.html#a7e87bb98f5f62744d30d1accb87cc664">localvd</a>-&gt;<a class="code" href="../../d6/deb/structView3D.html#a45ac0a23240ec719b0952d62190e9130">lay</a>;
<a name="l00363"></a>00363         v3do-&gt;<a class="code" href="../../d6/deb/structView3D.html#a45ac0a23240ec719b0952d62190e9130">lay</a> &amp;= 0xFFFFFF;
<a name="l00364"></a>00364     }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <span class="keywordflow">if</span> (v3dn-&gt;<a class="code" href="../../d6/deb/structView3D.html#a591cd4c57e5a79352f6733f6fa2bc1c9">drawtype</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a5ffb4ceb8fefd165399fc583a8f9d893">OB_RENDER</a>)
<a name="l00367"></a>00367         v3dn-&gt;<a class="code" href="../../d6/deb/structView3D.html#a591cd4c57e5a79352f6733f6fa2bc1c9">drawtype</a> = <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a02098d23ce96d480e90882bed52cb89d">OB_SOLID</a>;
<a name="l00368"></a>00368     
<a name="l00369"></a>00369     <span class="comment">/* copy or clear inside new stuff */</span>
<a name="l00370"></a>00370 
<a name="l00371"></a>00371     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#abc6ab715e5696ec3bb40014fc55182c6">BLI_duplicatelist</a>(&amp;v3dn-&gt;<a class="code" href="../../d6/deb/structView3D.html#a3246c1cbdd50c393126180ae4446992e">bgpicbase</a>, &amp;v3do-&gt;<a class="code" href="../../d6/deb/structView3D.html#a3246c1cbdd50c393126180ae4446992e">bgpicbase</a>);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373     v3dn-&gt;<a class="code" href="../../d6/deb/structView3D.html#a1218103b2d22b4f78191fe145c07f4d2">properties_storage</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00374"></a>00374     
<a name="l00375"></a>00375     <span class="keywordflow">return</span> (<a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *)v3dn;
<a name="l00376"></a>00376 }
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 <span class="comment">/* add handlers, stuff you only do once or on area/region changes */</span>
<a name="l00379"></a><a class="code" href="../../de/d28/space__view3d_8c.html#aabdadbf7e61c6ddfc0cd9ecb5324c966">00379</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#aabdadbf7e61c6ddfc0cd9ecb5324c966">view3d_main_area_init</a>(<a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *wm, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00380"></a>00380 {
<a name="l00381"></a>00381     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb;
<a name="l00382"></a>00382     <a class="code" href="../../d3/d90/structwmKeyMap.html">wmKeyMap</a> *keymap;
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     <span class="comment">/* object ops. */</span>
<a name="l00385"></a>00385     
<a name="l00386"></a>00386     <span class="comment">/* important to be before Pose keymap since they can both be enabled at once */</span>
<a name="l00387"></a>00387     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Face Mask&quot;</span>, 0, 0);
<a name="l00388"></a>00388     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00389"></a>00389     
<a name="l00390"></a>00390     
<a name="l00391"></a>00391     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Weight Paint Vertex Selection&quot;</span>, 0, 0);
<a name="l00392"></a>00392     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     <span class="comment">/* pose is not modal, operator poll checks for this */</span>
<a name="l00395"></a>00395     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Pose&quot;</span>, 0, 0);
<a name="l00396"></a>00396     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00397"></a>00397     
<a name="l00398"></a>00398     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Object Mode&quot;</span>, 0, 0);
<a name="l00399"></a>00399     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Image Paint&quot;</span>, 0, 0);
<a name="l00402"></a>00402     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00403"></a>00403 
<a name="l00404"></a>00404     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Vertex Paint&quot;</span>, 0, 0);
<a name="l00405"></a>00405     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00406"></a>00406 
<a name="l00407"></a>00407     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Weight Paint&quot;</span>, 0, 0);
<a name="l00408"></a>00408     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Sculpt&quot;</span>, 0, 0);
<a name="l00411"></a>00411     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00412"></a>00412     
<a name="l00413"></a>00413     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Mesh&quot;</span>, 0, 0);
<a name="l00414"></a>00414     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00415"></a>00415     
<a name="l00416"></a>00416     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Curve&quot;</span>, 0, 0);
<a name="l00417"></a>00417     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00418"></a>00418     
<a name="l00419"></a>00419     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Armature&quot;</span>, 0, 0);
<a name="l00420"></a>00420     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Pose&quot;</span>, 0, 0);
<a name="l00423"></a>00423     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00424"></a>00424 
<a name="l00425"></a>00425     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Metaball&quot;</span>, 0, 0);
<a name="l00426"></a>00426     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00427"></a>00427     
<a name="l00428"></a>00428     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Lattice&quot;</span>, 0, 0);
<a name="l00429"></a>00429     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <span class="comment">/* armature sketching needs to take over mouse */</span>
<a name="l00432"></a>00432     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Armature Sketch&quot;</span>, 0, 0);
<a name="l00433"></a>00433     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00434"></a>00434 
<a name="l00435"></a>00435     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Particle&quot;</span>, 0, 0);
<a name="l00436"></a>00436     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <span class="comment">/* editfont keymap swallows all... */</span>
<a name="l00439"></a>00439     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Font&quot;</span>, 0, 0);
<a name="l00440"></a>00440     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Object Non-modal&quot;</span>, 0, 0);
<a name="l00443"></a>00443     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;Frames&quot;</span>, 0, 0);
<a name="l00446"></a>00446     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     <span class="comment">/* own keymap, last so modes can override it */</span>
<a name="l00449"></a>00449     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;3D View Generic&quot;</span>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>, 0);
<a name="l00450"></a>00450     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00451"></a>00451 
<a name="l00452"></a>00452     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;3D View&quot;</span>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>, 0);
<a name="l00453"></a>00453     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00454"></a>00454     
<a name="l00455"></a>00455     <span class="comment">/* add drop boxes */</span>
<a name="l00456"></a>00456     lb = <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a9bdfefde719d427581820fde9975e46c">WM_dropboxmap_find</a>(<span class="stringliteral">&quot;View3D&quot;</span>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>);
<a name="l00457"></a>00457     
<a name="l00458"></a>00458     <a class="code" href="../../df/db0/wm__event__system_8c.html#a1c0385af2587f3e0ce0f4bf38ed49c47">WM_event_add_dropbox_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, lb);
<a name="l00459"></a>00459     
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00462"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a38af2a160cc58e7f10ceb742a30acde9">00462</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a38af2a160cc58e7f10ceb742a30acde9">view3d_ob_drop_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>), <a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l00463"></a>00463 {
<a name="l00464"></a>00464     <span class="keywordflow">if</span> (drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#aefc7fd61eecff37c03bab3cd263d2ba6">type</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ad0eae6683bc53af417ed22031e5585fc">WM_DRAG_ID</a>) {
<a name="l00465"></a>00465         <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a48492d6af92a0461bbf5d5f2307e0e9d">poin</a>;
<a name="l00466"></a>00466         <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>)
<a name="l00467"></a>00467             <span class="keywordflow">return</span> 1;
<a name="l00468"></a>00468     }
<a name="l00469"></a>00469     <span class="keywordflow">return</span> 0;
<a name="l00470"></a>00470 }
<a name="l00471"></a>00471 
<a name="l00472"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a454fc061b1a40128e362c7a495448414">00472</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a454fc061b1a40128e362c7a495448414">view3d_mat_drop_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>), <a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474     <span class="keywordflow">if</span> (drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#aefc7fd61eecff37c03bab3cd263d2ba6">type</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ad0eae6683bc53af417ed22031e5585fc">WM_DRAG_ID</a>) {
<a name="l00475"></a>00475         <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a48492d6af92a0461bbf5d5f2307e0e9d">poin</a>;
<a name="l00476"></a>00476         <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>)
<a name="l00477"></a>00477             <span class="keywordflow">return</span> 1;
<a name="l00478"></a>00478     }
<a name="l00479"></a>00479     <span class="keywordflow">return</span> 0;
<a name="l00480"></a>00480 }
<a name="l00481"></a>00481 
<a name="l00482"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a0b8e7fb55831d3fe891363f2f0ef1d81">00482</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a0b8e7fb55831d3fe891363f2f0ef1d81">view3d_ima_drop_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>), <a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l00483"></a>00483 {
<a name="l00484"></a>00484     <span class="keywordflow">if</span> (drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#aefc7fd61eecff37c03bab3cd263d2ba6">type</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ad0eae6683bc53af417ed22031e5585fc">WM_DRAG_ID</a>) {
<a name="l00485"></a>00485         <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a48492d6af92a0461bbf5d5f2307e0e9d">poin</a>;
<a name="l00486"></a>00486         <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a564eac75543b047cf8b2b759818529c3">ID_IM</a>)
<a name="l00487"></a>00487             <span class="keywordflow">return</span> 1;
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#aefc7fd61eecff37c03bab3cd263d2ba6">type</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a2905a35599b97e9022a7af7d86e9aa06">WM_DRAG_PATH</a>) {
<a name="l00490"></a>00490         <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a60291b8942feebbb1666a63f70be72be">icon</a>, 0, ICON_FILE_IMAGE))   <span class="comment">/* rule might not work? */</span>
<a name="l00491"></a>00491             <span class="keywordflow">return</span> 1;
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493     <span class="keywordflow">return</span> 0;
<a name="l00494"></a>00494 }
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 
<a name="l00497"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a903fbcaeb0ff5c36d2669bfce7a66df4">00497</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a903fbcaeb0ff5c36d2669bfce7a66df4">view3d_ima_bg_drop_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6a/ED__view3d_8h.html#a543c65d30fc888bba13d186696d922aa">ED_view3d_give_base_under_cursor</a>(C, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>) ) {
<a name="l00500"></a>00500         <span class="keywordflow">return</span> 0;
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502     <span class="keywordflow">return</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a0b8e7fb55831d3fe891363f2f0ef1d81">view3d_ima_drop_poll</a>(C, drag, event);
<a name="l00503"></a>00503 }
<a name="l00504"></a>00504 
<a name="l00505"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a182075989adf98012a06b7b61da5b54e">00505</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a182075989adf98012a06b7b61da5b54e">view3d_ima_ob_drop_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00506"></a>00506 {
<a name="l00507"></a>00507     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6a/ED__view3d_8h.html#a543c65d30fc888bba13d186696d922aa">ED_view3d_give_base_under_cursor</a>(C, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>) ) {
<a name="l00508"></a>00508         <span class="keywordflow">return</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a0b8e7fb55831d3fe891363f2f0ef1d81">view3d_ima_drop_poll</a>(C, drag, event);
<a name="l00509"></a>00509     }
<a name="l00510"></a>00510     <span class="keywordflow">return</span> 0;
<a name="l00511"></a>00511 }
<a name="l00512"></a>00512 
<a name="l00513"></a><a class="code" href="../../de/d28/space__view3d_8c.html#ac7542bf24fa936a8a4e9d54c9760407a">00513</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#ac7542bf24fa936a8a4e9d54c9760407a">view3d_ob_drop_copy</a>(<a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../da/d4b/structwmDropBox.html">wmDropBox</a> *drop)
<a name="l00514"></a>00514 {
<a name="l00515"></a>00515     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a48492d6af92a0461bbf5d5f2307e0e9d">poin</a>;
<a name="l00516"></a>00516     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     <span class="comment">/* need to put name in sub-operator in macro */</span>
<a name="l00519"></a>00519     ptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a243277576891ecaf204382563ed46364">RNA_pointer_get</a>(drop-&gt;<a class="code" href="../../da/d4b/structwmDropBox.html#afd695008bb8938a900a6d971f803f17e">ptr</a>, <span class="stringliteral">&quot;OBJECT_OT_add_named&quot;</span>);
<a name="l00520"></a>00520     <span class="keywordflow">if</span> (ptr.data)
<a name="l00521"></a>00521         <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(&amp;ptr, <span class="stringliteral">&quot;name&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l00522"></a>00522     <span class="keywordflow">else</span>
<a name="l00523"></a>00523         <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(drop-&gt;<a class="code" href="../../da/d4b/structwmDropBox.html#afd695008bb8938a900a6d971f803f17e">ptr</a>, <span class="stringliteral">&quot;name&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l00524"></a>00524 }
<a name="l00525"></a>00525 
<a name="l00526"></a><a class="code" href="../../de/d28/space__view3d_8c.html#ab4fb303c48d9ca9cb3ef41d55234da17">00526</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#ab4fb303c48d9ca9cb3ef41d55234da17">view3d_id_drop_copy</a>(<a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../da/d4b/structwmDropBox.html">wmDropBox</a> *drop)
<a name="l00527"></a>00527 {
<a name="l00528"></a>00528     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a48492d6af92a0461bbf5d5f2307e0e9d">poin</a>;
<a name="l00529"></a>00529     
<a name="l00530"></a>00530     <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(drop-&gt;<a class="code" href="../../da/d4b/structwmDropBox.html#afd695008bb8938a900a6d971f803f17e">ptr</a>, <span class="stringliteral">&quot;name&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l00531"></a>00531 }
<a name="l00532"></a>00532 
<a name="l00533"></a><a class="code" href="../../de/d28/space__view3d_8c.html#ab889fb6a38893e484cf54843264a7d98">00533</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#ab889fb6a38893e484cf54843264a7d98">view3d_id_path_drop_copy</a>(<a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../da/d4b/structwmDropBox.html">wmDropBox</a> *drop)
<a name="l00534"></a>00534 {
<a name="l00535"></a>00535     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a48492d6af92a0461bbf5d5f2307e0e9d">poin</a>;
<a name="l00536"></a>00536     
<a name="l00537"></a>00537     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<span class="keywordtype">id</span>)
<a name="l00538"></a>00538         <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(drop-&gt;<a class="code" href="../../da/d4b/structwmDropBox.html#afd695008bb8938a900a6d971f803f17e">ptr</a>, <span class="stringliteral">&quot;name&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l00539"></a>00539     <span class="keywordflow">if</span> (drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a3e19d880c2c368fa0674ed69b46a9b36">path</a>[0])
<a name="l00540"></a>00540         <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(drop-&gt;<a class="code" href="../../da/d4b/structwmDropBox.html#afd695008bb8938a900a6d971f803f17e">ptr</a>, <span class="stringliteral">&quot;filepath&quot;</span>, drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a3e19d880c2c368fa0674ed69b46a9b36">path</a>);
<a name="l00541"></a>00541 }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="comment">/* region dropbox definition */</span>
<a name="l00545"></a><a class="code" href="../../de/d28/space__view3d_8c.html#af3489d14fc56e0d65c88f442157dd482">00545</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#af3489d14fc56e0d65c88f442157dd482">view3d_dropboxes</a>(<span class="keywordtype">void</span>)
<a name="l00546"></a>00546 {
<a name="l00547"></a>00547     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb = <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a9bdfefde719d427581820fde9975e46c">WM_dropboxmap_find</a>(<span class="stringliteral">&quot;View3D&quot;</span>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>);
<a name="l00548"></a>00548     
<a name="l00549"></a>00549     <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a492e2c77ff7b14b50d31764e9c6616eb">WM_dropbox_add</a>(lb, <span class="stringliteral">&quot;OBJECT_OT_add_named_cursor&quot;</span>, <a class="code" href="../../de/d28/space__view3d_8c.html#a38af2a160cc58e7f10ceb742a30acde9">view3d_ob_drop_poll</a>, <a class="code" href="../../de/d28/space__view3d_8c.html#ac7542bf24fa936a8a4e9d54c9760407a">view3d_ob_drop_copy</a>);
<a name="l00550"></a>00550     <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a492e2c77ff7b14b50d31764e9c6616eb">WM_dropbox_add</a>(lb, <span class="stringliteral">&quot;OBJECT_OT_drop_named_material&quot;</span>, <a class="code" href="../../de/d28/space__view3d_8c.html#a454fc061b1a40128e362c7a495448414">view3d_mat_drop_poll</a>, <a class="code" href="../../de/d28/space__view3d_8c.html#ab4fb303c48d9ca9cb3ef41d55234da17">view3d_id_drop_copy</a>);
<a name="l00551"></a>00551     <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a492e2c77ff7b14b50d31764e9c6616eb">WM_dropbox_add</a>(lb, <span class="stringliteral">&quot;MESH_OT_drop_named_image&quot;</span>, <a class="code" href="../../de/d28/space__view3d_8c.html#a182075989adf98012a06b7b61da5b54e">view3d_ima_ob_drop_poll</a>, <a class="code" href="../../de/d28/space__view3d_8c.html#ab889fb6a38893e484cf54843264a7d98">view3d_id_path_drop_copy</a>);
<a name="l00552"></a>00552     <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a492e2c77ff7b14b50d31764e9c6616eb">WM_dropbox_add</a>(lb, <span class="stringliteral">&quot;VIEW3D_OT_background_image_add&quot;</span>, <a class="code" href="../../de/d28/space__view3d_8c.html#a903fbcaeb0ff5c36d2669bfce7a66df4">view3d_ima_bg_drop_poll</a>, <a class="code" href="../../de/d28/space__view3d_8c.html#ab889fb6a38893e484cf54843264a7d98">view3d_id_path_drop_copy</a>);
<a name="l00553"></a>00553 }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 
<a name="l00557"></a>00557 <span class="comment">/* type callback, not region itself */</span>
<a name="l00558"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a8931d03e23e7bbe75099cf379246de8b">00558</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a8931d03e23e7bbe75099cf379246de8b">view3d_main_area_free</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00559"></a>00559 {
<a name="l00560"></a>00560     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00561"></a>00561     
<a name="l00562"></a>00562     <span class="keywordflow">if</span> (rv3d) {
<a name="l00563"></a>00563         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>);
<a name="l00564"></a>00564         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#af03bef54d5f4dbf31d2f73a8d0c83d0a">clipbb</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#af03bef54d5f4dbf31d2f73a8d0c83d0a">clipbb</a>);
<a name="l00565"></a>00565 
<a name="l00566"></a>00566         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a9f780c24dcd7c2d37dd53a3d5a315deb">ri</a>) {
<a name="l00567"></a>00567             <span class="comment">// XXX      BIF_view3d_previewrender_free(rv3d);</span>
<a name="l00568"></a>00568         }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2edbfa90c097636953f1a14fb0b12115">render_engine</a>)
<a name="l00571"></a>00571             <a class="code" href="../../db/da9/RE__engine_8h.html#a8a292a5ca4bc5bb69055a1fe27b70d62">RE_engine_free</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2edbfa90c097636953f1a14fb0b12115">render_engine</a>);
<a name="l00572"></a>00572         
<a name="l00573"></a>00573         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ad42475ca8dcac3b4e0560c71f462f39c">depths</a>) {
<a name="l00574"></a>00574             <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ad42475ca8dcac3b4e0560c71f462f39c">depths</a>-&gt;<a class="code" href="../../de/ddc/structViewDepths.html#a8920463bc49ebed8f94ba29f3799c18b">depths</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ad42475ca8dcac3b4e0560c71f462f39c">depths</a>-&gt;<a class="code" href="../../de/ddc/structViewDepths.html#a8920463bc49ebed8f94ba29f3799c18b">depths</a>);
<a name="l00575"></a>00575             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ad42475ca8dcac3b4e0560c71f462f39c">depths</a>);
<a name="l00576"></a>00576         }
<a name="l00577"></a>00577         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(rv3d);
<a name="l00578"></a>00578         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580 }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="comment">/* copy regiondata */</span>
<a name="l00583"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a175c01e73d0a3a6206ae20f4d2f55946">00583</a> <span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../de/d28/space__view3d_8c.html#a175c01e73d0a3a6206ae20f4d2f55946">view3d_main_area_duplicate</a>(<span class="keywordtype">void</span> *poin)
<a name="l00584"></a>00584 {
<a name="l00585"></a>00585     <span class="keywordflow">if</span> (poin) {
<a name="l00586"></a>00586         <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = poin, *<span class="keyword">new</span>;
<a name="l00587"></a>00587     
<a name="l00588"></a>00588         <span class="keyword">new</span> = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(rv3d);
<a name="l00589"></a>00589         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>)
<a name="l00590"></a>00590             <span class="keyword">new</span>-&gt;localvd = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>);
<a name="l00591"></a>00591         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#af03bef54d5f4dbf31d2f73a8d0c83d0a">clipbb</a>)
<a name="l00592"></a>00592             <span class="keyword">new</span>-&gt;clipbb = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#af03bef54d5f4dbf31d2f73a8d0c83d0a">clipbb</a>);
<a name="l00593"></a>00593         
<a name="l00594"></a>00594         <span class="keyword">new</span>-&gt;depths = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00595"></a>00595         <span class="keyword">new</span>-&gt;ri = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00596"></a>00596         <span class="keyword">new</span>-&gt;render_engine = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00597"></a>00597         <span class="keyword">new</span>-&gt;gpd = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00598"></a>00598         <span class="keyword">new</span>-&gt;sms = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00599"></a>00599         <span class="keyword">new</span>-&gt;smooth_timer = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00600"></a>00600         
<a name="l00601"></a>00601         <span class="keywordflow">return</span> <span class="keyword">new</span>;
<a name="l00602"></a>00602     }
<a name="l00603"></a>00603     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00604"></a>00604 }
<a name="l00605"></a>00605 
<a name="l00606"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a1199cc9d0686e7cf31dfd4f4cb844a5b">00606</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a1199cc9d0686e7cf31dfd4f4cb844a5b">view3d_recalc_used_layers</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d4/d07/structwmNotifier.html">wmNotifier</a> *wmn, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00607"></a>00607 {
<a name="l00608"></a>00608     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win = wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a97b3fac1b9ffb6612448d76891e1f67a">wm</a>-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#af6c533cdbd4dc456794e6a89d0f1fe71">winactive</a>;
<a name="l00609"></a>00609     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l00610"></a>00610     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lay_used = 0;
<a name="l00611"></a>00611     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613     <span class="keywordflow">if</span> (!win) <span class="keywordflow">return</span>;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615     base = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00616"></a>00616     <span class="keywordflow">while</span> (base) {
<a name="l00617"></a>00617         lay_used |= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a> &amp; ((1 &lt;&lt; 20) - 1); <span class="comment">/* ignore localview */</span>
<a name="l00618"></a>00618 
<a name="l00619"></a>00619         <span class="keywordflow">if</span> (lay_used == (1 &lt;&lt; 20) - 1)
<a name="l00620"></a>00620             <span class="keywordflow">break</span>;
<a name="l00621"></a>00621 
<a name="l00622"></a>00622         base = base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l00623"></a>00623     }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     <span class="keywordflow">for</span> (sa = win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a5ec98a9e430fdc21a8d0f0b8dcc6ed05">screen</a>-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l00626"></a>00626         <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>) {
<a name="l00627"></a>00627             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a0a004822554284f0bb32fdc70cfeee1f">BLI_findindex</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>, ar) != -1) {
<a name="l00628"></a>00628                 <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00629"></a>00629                 v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#ade0b8e83e6981b379cba6c6266cfbaa3">lay_used</a> = lay_used;
<a name="l00630"></a>00630                 <span class="keywordflow">break</span>;
<a name="l00631"></a>00631             }
<a name="l00632"></a>00632         }
<a name="l00633"></a>00633     }
<a name="l00634"></a>00634 }
<a name="l00635"></a>00635 
<a name="l00636"></a><a class="code" href="../../de/d28/space__view3d_8c.html#aacba4ef5db72747f6f59d1668841093b">00636</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#aacba4ef5db72747f6f59d1668841093b">view3d_main_area_listener</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d4/d07/structwmNotifier.html">wmNotifier</a> *wmn)
<a name="l00637"></a>00637 {
<a name="l00638"></a>00638     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640     <span class="comment">/* context changes */</span>
<a name="l00641"></a>00641     <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a8d2543a915bef78c58c06b1cc765e2fd">category</a>) {
<a name="l00642"></a>00642         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>:
<a name="l00643"></a>00643             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00644"></a>00644                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a7f09fa8269c80b98dae22ad97b49b532">ND_KEYFRAME_PROP</a>:
<a name="l00645"></a>00645                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a1ae48304ab1b5da96c5319a62f9b3b80">ND_NLA_ACTCHANGE</a>:
<a name="l00646"></a>00646                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00647"></a>00647                     <span class="keywordflow">break</span>;
<a name="l00648"></a>00648                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aa4d0c2a2f5c2beace2902512fd13e4ae">ND_NLA</a>:
<a name="l00649"></a>00649                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ad3ac9c1f16a6876edef02a4bc8287a61">ND_KEYFRAME</a>:
<a name="l00650"></a>00650                     <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>)
<a name="l00651"></a>00651                         <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00652"></a>00652                     <span class="keywordflow">break</span>;
<a name="l00653"></a>00653                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ae33d7b6d741944268e2e95aa7416d97f">ND_ANIMCHAN</a>:
<a name="l00654"></a>00654                     <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#af783162b06c79f4448366ebc70ec8416">NA_SELECTED</a>)
<a name="l00655"></a>00655                         <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00656"></a>00656                     <span class="keywordflow">break</span>;
<a name="l00657"></a>00657             }
<a name="l00658"></a>00658             <span class="keywordflow">break</span>;
<a name="l00659"></a>00659         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>:
<a name="l00660"></a>00660             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00661"></a>00661                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6a92d2cd5aee244f522fdae27169c990">ND_LAYER_CONTENT</a>:
<a name="l00662"></a>00662                     <a class="code" href="../../de/d28/space__view3d_8c.html#a1199cc9d0686e7cf31dfd4f4cb844a5b">view3d_recalc_used_layers</a>(ar, wmn, wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#ae6b35e6d9d11657a5ee311b72ea3de5d">reference</a>);
<a name="l00663"></a>00663                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00664"></a>00664                     <span class="keywordflow">break</span>;
<a name="l00665"></a>00665                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>:
<a name="l00666"></a>00666                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aad6e17340eb558c0caa7c874dc0812f3">ND_TRANSFORM</a>:
<a name="l00667"></a>00667                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a2072407a0c536bf373bd0b6b7c159c5c">ND_OB_ACTIVE</a>:
<a name="l00668"></a>00668                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a59ea6c7f4b5448c4c4912e8893a031f4">ND_OB_SELECT</a>:
<a name="l00669"></a>00669                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a68804434f856105d55ed44db0225cbca">ND_OB_VISIBLE</a>:
<a name="l00670"></a>00670                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aae2648a20cf7e6e8b9ea7d4305d55b37">ND_LAYER</a>:
<a name="l00671"></a>00671                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a2d1f4e4fbef089f325035e7fcf010b66">ND_RENDER_OPTIONS</a>:
<a name="l00672"></a>00672                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a53c798c29ec45386460a892c62769440">ND_MODE</a>:
<a name="l00673"></a>00673                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00674"></a>00674                     <span class="keywordflow">break</span>;
<a name="l00675"></a>00675                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a0792c1b48c7575e8da04a53df4ac5e69">ND_WORLD</a>:
<a name="l00676"></a>00676                     <span class="comment">/* handled by space_view3d_listener() for v3d access */</span>
<a name="l00677"></a>00677                     <span class="keywordflow">break</span>;
<a name="l00678"></a>00678             }
<a name="l00679"></a>00679             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>)
<a name="l00680"></a>00680                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00681"></a>00681             <span class="keywordflow">break</span>;
<a name="l00682"></a>00682         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a>:
<a name="l00683"></a>00683             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00684"></a>00684                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aaa1212cd50cd3483487f040dfdb66cee">ND_BONE_ACTIVE</a>:
<a name="l00685"></a>00685                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ac7693a07a6e4c10de8d8882649fe4f73">ND_BONE_SELECT</a>:
<a name="l00686"></a>00686                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aad6e17340eb558c0caa7c874dc0812f3">ND_TRANSFORM</a>:
<a name="l00687"></a>00687                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a72e1ed3dc8d04e8bc84328ec6ef6ce80">ND_POSE</a>:
<a name="l00688"></a>00688                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a1f2c5ee380a0a55abaf43b7bceeb7688">ND_DRAW</a>:
<a name="l00689"></a>00689                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6ec218ae09d7e62810f2235c02a54ecf">ND_MODIFIER</a>:
<a name="l00690"></a>00690                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a87355bd87948236606ac66097a378e02">ND_CONSTRAINT</a>:
<a name="l00691"></a>00691                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ab2ab88214d816c47ebee1a985b0e68b3">ND_KEYS</a>:
<a name="l00692"></a>00692                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a74e7b63e675b313d1f9e5a4016a3e6cb">ND_PARTICLE</a>:
<a name="l00693"></a>00693                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00694"></a>00694                     <span class="keywordflow">break</span>;
<a name="l00695"></a>00695             }
<a name="l00696"></a>00696             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a>) {
<a name="l00697"></a>00697                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a66ee93621fb1e26b8b9bb49dc3c2c2af">NA_ADDED</a>:
<a name="l00698"></a>00698                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00699"></a>00699                     <span class="keywordflow">break</span>;
<a name="l00700"></a>00700             }
<a name="l00701"></a>00701             <span class="keywordflow">break</span>;
<a name="l00702"></a>00702         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a>:
<a name="l00703"></a>00703             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00704"></a>00704                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a25383f13197df9bda823d34736df4d82">ND_DATA</a>:
<a name="l00705"></a>00705                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>:
<a name="l00706"></a>00706                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00707"></a>00707                     <span class="keywordflow">break</span>;
<a name="l00708"></a>00708             }
<a name="l00709"></a>00709             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a>) {
<a name="l00710"></a>00710                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>:
<a name="l00711"></a>00711                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00712"></a>00712                     <span class="keywordflow">break</span>;
<a name="l00713"></a>00713             }
<a name="l00714"></a>00714             <span class="keywordflow">break</span>;
<a name="l00715"></a>00715         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6c8e772001142e55673ee490ce4c2b78">NC_GROUP</a>:
<a name="l00716"></a>00716             <span class="comment">/* all group ops for now */</span>
<a name="l00717"></a>00717             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00718"></a>00718             <span class="keywordflow">break</span>;
<a name="l00719"></a>00719         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a1f92a8bb850509b5eaec48a130689729">NC_BRUSH</a>:
<a name="l00720"></a>00720             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>)
<a name="l00721"></a>00721                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a3b439fcda0166f7507bbd49563172827">ED_region_tag_redraw_overlay</a>(ar);
<a name="l00722"></a>00722             <span class="keywordflow">break</span>;          
<a name="l00723"></a>00723         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a835f426982dfbc3be8305095253ad793">NC_MATERIAL</a>:
<a name="l00724"></a>00724             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00725"></a>00725                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aec47e351fe15423a3f06855b21e11548">ND_SHADING_DRAW</a>:
<a name="l00726"></a>00726                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00727"></a>00727                     <span class="keywordflow">break</span>;
<a name="l00728"></a>00728             }
<a name="l00729"></a>00729             <span class="keywordflow">break</span>;
<a name="l00730"></a>00730         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a03dbfa96e493f56aac353e5550380e8b">NC_WORLD</a>:
<a name="l00731"></a>00731             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00732"></a>00732                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#abd3a61b75254bbf02378c26c340c1063">ND_WORLD_DRAW</a>:
<a name="l00733"></a>00733                     <span class="comment">/* handled by space_view3d_listener() for v3d access */</span>
<a name="l00734"></a>00734                     <span class="keywordflow">break</span>;
<a name="l00735"></a>00735                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a4e7299eff7f0dc5ba80ddef20dd2db72">ND_WORLD_STARS</a>:
<a name="l00736"></a>00736                 {
<a name="l00737"></a>00737                     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00738"></a>00738                     <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> == <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a4c869f8f07a58e54e43d35474bbe4757">RV3D_CAMOB</a>) {
<a name="l00739"></a>00739                         <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00740"></a>00740                     }
<a name="l00741"></a>00741                 }
<a name="l00742"></a>00742             }
<a name="l00743"></a>00743             <span class="keywordflow">break</span>;
<a name="l00744"></a>00744         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a836d92a753bc7d1f05c0c59c18f153da">NC_LAMP</a>:
<a name="l00745"></a>00745             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00746"></a>00746                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a2afe5f5099f0957c5e7f47b2b8210cee">ND_LIGHTING_DRAW</a>:
<a name="l00747"></a>00747                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00748"></a>00748                     <span class="keywordflow">break</span>;
<a name="l00749"></a>00749             }
<a name="l00750"></a>00750             <span class="keywordflow">break</span>;
<a name="l00751"></a>00751         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a86a44bfe4ef4915f026b4dd988498727">NC_IMAGE</a>:  
<a name="l00752"></a>00752             <span class="comment">/* this could be more fine grained checks if we had</span>
<a name="l00753"></a>00753 <span class="comment">             * more context than just the region */</span>
<a name="l00754"></a>00754             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00755"></a>00755             <span class="keywordflow">break</span>;
<a name="l00756"></a>00756         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aa5d5ad0b941376d3be89c261f876f4fa">NC_TEXTURE</a>:    
<a name="l00757"></a>00757             <span class="comment">/* same as above */</span>
<a name="l00758"></a>00758             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00759"></a>00759             <span class="keywordflow">break</span>;
<a name="l00760"></a>00760         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a50b8b6ff8b8949b158250fdc6f315408">NC_MOVIECLIP</a>:
<a name="l00761"></a>00761             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a42500f6af626e48de8d66c7ae97af036">ND_DISPLAY</a>)
<a name="l00762"></a>00762                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00763"></a>00763             <span class="keywordflow">break</span>;
<a name="l00764"></a>00764         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>:
<a name="l00765"></a>00765             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ace9a4933ee2444c3c91d28a8bd2cd8a1">ND_SPACE_VIEW3D</a>) {
<a name="l00766"></a>00766                 <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#abee9ae8d3103b68a62a877e4f7091c14">subtype</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#aa741b2b1dbdc81a76558a285ed02f088">NS_VIEW3D_GPU</a>) {
<a name="l00767"></a>00767                     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00768"></a>00768                     rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a077da32c8352d8b7abb4b19919a14cf8">rflag</a> |= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a06f5743b14c7028d2dc2786d27106ca9">RV3D_GPULIGHT_UPDATE</a>;
<a name="l00769"></a>00769                 }
<a name="l00770"></a>00770                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00771"></a>00771             }
<a name="l00772"></a>00772             <span class="keywordflow">break</span>;
<a name="l00773"></a>00773         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a12ff8b13081ef1c126861ed65582f8fa">NC_ID</a>:
<a name="l00774"></a>00774             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ab2f233051d6d30ad67292ad937ec338c">NA_RENAME</a>)
<a name="l00775"></a>00775                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00776"></a>00776             <span class="keywordflow">break</span>;
<a name="l00777"></a>00777         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>:
<a name="l00778"></a>00778             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00779"></a>00779                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aeab12aa02a0566181ca86214c661faca">ND_GPENCIL</a>:
<a name="l00780"></a>00780                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a5a114b363a8646f4d29e416587b50480">ND_ANIMPLAY</a>:
<a name="l00781"></a>00781                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a530e6e29314e897aa83f4584260af530">ND_SKETCH</a>:
<a name="l00782"></a>00782                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00783"></a>00783                     <span class="keywordflow">break</span>;
<a name="l00784"></a>00784                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a024a1d387080576fe2eb4b5cfd30efd8">ND_SCREENBROWSE</a>:
<a name="l00785"></a>00785                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a9a73baf3e1573cc377e6368cae4b8fd5">ND_SCREENDELETE</a>:
<a name="l00786"></a>00786                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aac177e3bec7e8bffd887a51a1dbfad11">ND_SCREENSET</a>:
<a name="l00787"></a>00787                     <span class="comment">/* screen was changed, need to update used layers due to NC_SCENE|ND_LAYER_CONTENT */</span>
<a name="l00788"></a>00788                     <span class="comment">/* updates used layers only for View3D in active screen */</span>
<a name="l00789"></a>00789                     sc = wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#ae6b35e6d9d11657a5ee311b72ea3de5d">reference</a>;
<a name="l00790"></a>00790                     <a class="code" href="../../de/d28/space__view3d_8c.html#a1199cc9d0686e7cf31dfd4f4cb844a5b">view3d_recalc_used_layers</a>(ar, wmn, sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#a98cbd326f3b4179f769d007556e14999">scene</a>);
<a name="l00791"></a>00791                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00792"></a>00792                     <span class="keywordflow">break</span>;
<a name="l00793"></a>00793             }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795             <span class="keywordflow">break</span>;
<a name="l00796"></a>00796     }
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 <span class="comment">/* concept is to retrieve cursor type context-less */</span>
<a name="l00800"></a><a class="code" href="../../de/d28/space__view3d_8c.html#ae1524449e4c26c70535c5db33e8045d1">00800</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#ae1524449e4c26c70535c5db33e8045d1">view3d_main_area_cursor</a>(<a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win, <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(sa), <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ar))
<a name="l00801"></a>00801 {
<a name="l00802"></a>00802     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a5ec98a9e430fdc21a8d0f0b8dcc6ed05">screen</a>-&gt;<a class="code" href="../../de/de7/structbScreen.html#a98cbd326f3b4179f769d007556e14999">scene</a>;
<a name="l00803"></a>00803 
<a name="l00804"></a>00804     <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a1aa1978dba5dab99d35b6ba89e88b5bb">obedit</a>) {
<a name="l00805"></a>00805         <a class="code" href="../../de/d3c/wm__cursors_8c.html#a30f5564490ef777f782dbce942054565">WM_cursor_set</a>(win, <a class="code" href="../../db/da6/wm__cursors_8h.html#aeb8d583a31cccbb8cf9b452a8e298063a003cebaaa983d870cd4463a804a21f9d">CURSOR_EDIT</a>);
<a name="l00806"></a>00806     }
<a name="l00807"></a>00807     <span class="keywordflow">else</span> {
<a name="l00808"></a>00808         <a class="code" href="../../de/d3c/wm__cursors_8c.html#a30f5564490ef777f782dbce942054565">WM_cursor_set</a>(win, <a class="code" href="../../db/da6/wm__cursors_8h.html#aeb8d583a31cccbb8cf9b452a8e298063a581d03314f0c538b56cbef4d06a2a563">CURSOR_STD</a>);
<a name="l00809"></a>00809     }
<a name="l00810"></a>00810 }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812 <span class="comment">/* add handlers, stuff you only do once or on area/region changes */</span>
<a name="l00813"></a><a class="code" href="../../de/d28/space__view3d_8c.html#ad53adfc752b478f2d9248b487660cda0">00813</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#ad53adfc752b478f2d9248b487660cda0">view3d_header_area_init</a>(<a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *wm, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00814"></a>00814 {
<a name="l00815"></a>00815     <a class="code" href="../../d3/d90/structwmKeyMap.html">wmKeyMap</a> *keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;3D View Generic&quot;</span>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>, 0);
<a name="l00816"></a>00816     
<a name="l00817"></a>00817     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00818"></a>00818 
<a name="l00819"></a>00819     <a class="code" href="../../d1/d12/ED__screen_8h.html#a8ab6b6008731b26e0da833825bb23ed3">ED_region_header_init</a>(ar);
<a name="l00820"></a>00820 }
<a name="l00821"></a>00821 
<a name="l00822"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a475087fdfe192cf7bb2b737a69c68fda">00822</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a475087fdfe192cf7bb2b737a69c68fda">view3d_header_area_draw</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00823"></a>00823 {
<a name="l00824"></a>00824     <a class="code" href="../../d1/d12/ED__screen_8h.html#a71e8540b0713b316404a3e1a21690cb9">ED_region_header</a>(C, ar);
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00827"></a><a class="code" href="../../de/d28/space__view3d_8c.html#ac60765ed047f62a5bde68210b69b803c">00827</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#ac60765ed047f62a5bde68210b69b803c">view3d_header_area_listener</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d4/d07/structwmNotifier.html">wmNotifier</a> *wmn)
<a name="l00828"></a>00828 {
<a name="l00829"></a>00829     <span class="comment">/* context changes */</span>
<a name="l00830"></a>00830     <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a8d2543a915bef78c58c06b1cc765e2fd">category</a>) {
<a name="l00831"></a>00831         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>:
<a name="l00832"></a>00832             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00833"></a>00833                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>:
<a name="l00834"></a>00834                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a2072407a0c536bf373bd0b6b7c159c5c">ND_OB_ACTIVE</a>:
<a name="l00835"></a>00835                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a59ea6c7f4b5448c4c4912e8893a031f4">ND_OB_SELECT</a>:
<a name="l00836"></a>00836                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a68804434f856105d55ed44db0225cbca">ND_OB_VISIBLE</a>:
<a name="l00837"></a>00837                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a53c798c29ec45386460a892c62769440">ND_MODE</a>:
<a name="l00838"></a>00838                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aae2648a20cf7e6e8b9ea7d4305d55b37">ND_LAYER</a>:
<a name="l00839"></a>00839                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6d45e7088a585f99262267fe26de1b33">ND_TOOLSETTINGS</a>:
<a name="l00840"></a>00840                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6a92d2cd5aee244f522fdae27169c990">ND_LAYER_CONTENT</a>:
<a name="l00841"></a>00841                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00842"></a>00842                     <span class="keywordflow">break</span>;
<a name="l00843"></a>00843             }
<a name="l00844"></a>00844             <span class="keywordflow">break</span>;
<a name="l00845"></a>00845         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>:
<a name="l00846"></a>00846             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ace9a4933ee2444c3c91d28a8bd2cd8a1">ND_SPACE_VIEW3D</a>)
<a name="l00847"></a>00847                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00848"></a>00848             <span class="keywordflow">break</span>;
<a name="l00849"></a>00849     }
<a name="l00850"></a>00850 }
<a name="l00851"></a>00851 
<a name="l00852"></a>00852 <span class="comment">/* add handlers, stuff you only do once or on area/region changes */</span>
<a name="l00853"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a758375fbdcf77291329e8cb4999d321b">00853</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a758375fbdcf77291329e8cb4999d321b">view3d_buttons_area_init</a>(<a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *wm, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00854"></a>00854 {
<a name="l00855"></a>00855     <a class="code" href="../../d3/d90/structwmKeyMap.html">wmKeyMap</a> *keymap;
<a name="l00856"></a>00856 
<a name="l00857"></a>00857     <a class="code" href="../../d1/d12/ED__screen_8h.html#a130fc89f09440c7ad4c7462f26e64afb">ED_region_panels_init</a>(wm, ar);
<a name="l00858"></a>00858     
<a name="l00859"></a>00859     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;3D View Generic&quot;</span>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>, 0);
<a name="l00860"></a>00860     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00861"></a>00861 }
<a name="l00862"></a>00862 
<a name="l00863"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a2aa12a41873f8618e2634b2bb62c7103">00863</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a2aa12a41873f8618e2634b2bb62c7103">view3d_buttons_area_draw</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00864"></a>00864 {
<a name="l00865"></a>00865     <a class="code" href="../../d1/d12/ED__screen_8h.html#accfd2d3211f647ea5fb3d31b3ea34d07">ED_region_panels</a>(C, ar, 1, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1);
<a name="l00866"></a>00866 }
<a name="l00867"></a>00867 
<a name="l00868"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a6277766f8c4881afb84142ea0fd607ac">00868</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a6277766f8c4881afb84142ea0fd607ac">view3d_buttons_area_listener</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d4/d07/structwmNotifier.html">wmNotifier</a> *wmn)
<a name="l00869"></a>00869 {
<a name="l00870"></a>00870     <span class="comment">/* context changes */</span>
<a name="l00871"></a>00871     <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a8d2543a915bef78c58c06b1cc765e2fd">category</a>) {
<a name="l00872"></a>00872         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>:
<a name="l00873"></a>00873             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00874"></a>00874                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a7f09fa8269c80b98dae22ad97b49b532">ND_KEYFRAME_PROP</a>:
<a name="l00875"></a>00875                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a1ae48304ab1b5da96c5319a62f9b3b80">ND_NLA_ACTCHANGE</a>:
<a name="l00876"></a>00876                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00877"></a>00877                     <span class="keywordflow">break</span>;
<a name="l00878"></a>00878                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aa4d0c2a2f5c2beace2902512fd13e4ae">ND_NLA</a>:
<a name="l00879"></a>00879                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ad3ac9c1f16a6876edef02a4bc8287a61">ND_KEYFRAME</a>:
<a name="l00880"></a>00880                     <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>)
<a name="l00881"></a>00881                         <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00882"></a>00882                     <span class="keywordflow">break</span>;  
<a name="l00883"></a>00883             }
<a name="l00884"></a>00884             <span class="keywordflow">break</span>;
<a name="l00885"></a>00885         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>:
<a name="l00886"></a>00886             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00887"></a>00887                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>:
<a name="l00888"></a>00888                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a2072407a0c536bf373bd0b6b7c159c5c">ND_OB_ACTIVE</a>:
<a name="l00889"></a>00889                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a59ea6c7f4b5448c4c4912e8893a031f4">ND_OB_SELECT</a>:
<a name="l00890"></a>00890                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a68804434f856105d55ed44db0225cbca">ND_OB_VISIBLE</a>:
<a name="l00891"></a>00891                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a53c798c29ec45386460a892c62769440">ND_MODE</a>:
<a name="l00892"></a>00892                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aae2648a20cf7e6e8b9ea7d4305d55b37">ND_LAYER</a>:
<a name="l00893"></a>00893                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6a92d2cd5aee244f522fdae27169c990">ND_LAYER_CONTENT</a>:
<a name="l00894"></a>00894                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6d45e7088a585f99262267fe26de1b33">ND_TOOLSETTINGS</a>:
<a name="l00895"></a>00895                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00896"></a>00896                     <span class="keywordflow">break</span>;
<a name="l00897"></a>00897             }
<a name="l00898"></a>00898             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a>) {
<a name="l00899"></a>00899                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>:
<a name="l00900"></a>00900                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00901"></a>00901                     <span class="keywordflow">break</span>;
<a name="l00902"></a>00902             }
<a name="l00903"></a>00903             <span class="keywordflow">break</span>;
<a name="l00904"></a>00904         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a>:
<a name="l00905"></a>00905             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00906"></a>00906                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aaa1212cd50cd3483487f040dfdb66cee">ND_BONE_ACTIVE</a>:
<a name="l00907"></a>00907                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ac7693a07a6e4c10de8d8882649fe4f73">ND_BONE_SELECT</a>:
<a name="l00908"></a>00908                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aad6e17340eb558c0caa7c874dc0812f3">ND_TRANSFORM</a>:
<a name="l00909"></a>00909                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a72e1ed3dc8d04e8bc84328ec6ef6ce80">ND_POSE</a>:
<a name="l00910"></a>00910                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a1f2c5ee380a0a55abaf43b7bceeb7688">ND_DRAW</a>:
<a name="l00911"></a>00911                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#ab2ab88214d816c47ebee1a985b0e68b3">ND_KEYS</a>:
<a name="l00912"></a>00912                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6ec218ae09d7e62810f2235c02a54ecf">ND_MODIFIER</a>:
<a name="l00913"></a>00913                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00914"></a>00914                     <span class="keywordflow">break</span>;
<a name="l00915"></a>00915             }
<a name="l00916"></a>00916             <span class="keywordflow">break</span>;
<a name="l00917"></a>00917         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a>:
<a name="l00918"></a>00918             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00919"></a>00919                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a25383f13197df9bda823d34736df4d82">ND_DATA</a>:
<a name="l00920"></a>00920                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>:
<a name="l00921"></a>00921                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00922"></a>00922                     <span class="keywordflow">break</span>;
<a name="l00923"></a>00923             }
<a name="l00924"></a>00924             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>)
<a name="l00925"></a>00925                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00926"></a>00926             <span class="keywordflow">break</span>;
<a name="l00927"></a>00927         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#aa5d5ad0b941376d3be89c261f876f4fa">NC_TEXTURE</a>:
<a name="l00928"></a>00928         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a835f426982dfbc3be8305095253ad793">NC_MATERIAL</a>:
<a name="l00929"></a>00929             <span class="comment">/* for brush textures */</span>
<a name="l00930"></a>00930             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00931"></a>00931             <span class="keywordflow">break</span>;
<a name="l00932"></a>00932         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a1f92a8bb850509b5eaec48a130689729">NC_BRUSH</a>:
<a name="l00933"></a>00933             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>)
<a name="l00934"></a>00934                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00935"></a>00935             <span class="keywordflow">break</span>;
<a name="l00936"></a>00936         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>:
<a name="l00937"></a>00937             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ace9a4933ee2444c3c91d28a8bd2cd8a1">ND_SPACE_VIEW3D</a>)
<a name="l00938"></a>00938                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00939"></a>00939             <span class="keywordflow">break</span>;
<a name="l00940"></a>00940         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a12ff8b13081ef1c126861ed65582f8fa">NC_ID</a>:
<a name="l00941"></a>00941             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a1127cef43584875c4ec84b1d3b7dc655">action</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ab2f233051d6d30ad67292ad937ec338c">NA_RENAME</a>)
<a name="l00942"></a>00942                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00943"></a>00943             <span class="keywordflow">break</span>;
<a name="l00944"></a>00944         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>: 
<a name="l00945"></a>00945             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#aeab12aa02a0566181ca86214c661faca">ND_GPENCIL</a>)
<a name="l00946"></a>00946                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00947"></a>00947             <span class="keywordflow">break</span>;
<a name="l00948"></a>00948     }
<a name="l00949"></a>00949 }
<a name="l00950"></a>00950 
<a name="l00951"></a>00951 <span class="comment">/* add handlers, stuff you only do once or on area/region changes */</span>
<a name="l00952"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a74295cd8053f6fbbf27d584cda4b846e">00952</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a74295cd8053f6fbbf27d584cda4b846e">view3d_tools_area_init</a>(<a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *wm, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00953"></a>00953 {
<a name="l00954"></a>00954     <a class="code" href="../../d3/d90/structwmKeyMap.html">wmKeyMap</a> *keymap;
<a name="l00955"></a>00955     
<a name="l00956"></a>00956     <a class="code" href="../../d1/d12/ED__screen_8h.html#a130fc89f09440c7ad4c7462f26e64afb">ED_region_panels_init</a>(wm, ar);
<a name="l00957"></a>00957 
<a name="l00958"></a>00958     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a17c7e8a6747f168e3b9266314ba2534e">defaultconf</a>, <span class="stringliteral">&quot;3D View Generic&quot;</span>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>, 0);
<a name="l00959"></a>00959     <a class="code" href="../../df/db0/wm__event__system_8c.html#a966bbb5f2ccdc15546e0725efa379595">WM_event_add_keymap_handler</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a84683336306edb035eeaa8d2f6fa7033">handlers</a>, keymap);
<a name="l00960"></a>00960 }
<a name="l00961"></a>00961 
<a name="l00962"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a663a6516cc4724e9d777c786eaf798d6">00962</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a663a6516cc4724e9d777c786eaf798d6">view3d_tools_area_draw</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00963"></a>00963 {
<a name="l00964"></a>00964     <a class="code" href="../../d1/d12/ED__screen_8h.html#accfd2d3211f647ea5fb3d31b3ea34d07">ED_region_panels</a>(C, ar, 1, <a class="code" href="../../df/d01/BKE__context_8h.html#a9008c26fbac572db309aa711537ecbd0">CTX_data_mode_string</a>(C), -1);
<a name="l00965"></a>00965 }
<a name="l00966"></a>00966 
<a name="l00967"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a3adcc59c54470815b23d370009a40c76">00967</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a3adcc59c54470815b23d370009a40c76">view3d_props_area_listener</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d4/d07/structwmNotifier.html">wmNotifier</a> *wmn)
<a name="l00968"></a>00968 {
<a name="l00969"></a>00969     <span class="comment">/* context changes */</span>
<a name="l00970"></a>00970     <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a8d2543a915bef78c58c06b1cc765e2fd">category</a>) {
<a name="l00971"></a>00971         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a2401e8c966e41d3d8dec9d54fd68c630">NC_WM</a>:
<a name="l00972"></a>00972             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ab4bf082acaa06b8a2455eb4f9c563acc">ND_HISTORY</a>)
<a name="l00973"></a>00973                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00974"></a>00974             <span class="keywordflow">break</span>;
<a name="l00975"></a>00975         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>:
<a name="l00976"></a>00976             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a53c798c29ec45386460a892c62769440">ND_MODE</a>)
<a name="l00977"></a>00977                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00978"></a>00978             <span class="keywordflow">break</span>;
<a name="l00979"></a>00979         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>:
<a name="l00980"></a>00980             <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#ace9a4933ee2444c3c91d28a8bd2cd8a1">ND_SPACE_VIEW3D</a>)
<a name="l00981"></a>00981                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00982"></a>00982             <span class="keywordflow">break</span>;
<a name="l00983"></a>00983     }
<a name="l00984"></a>00984 }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986 <span class="comment">/*area (not region) level listener*/</span>
<a name="l00987"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a0d055b448c19b6c0b9f6b0dbf0fe89c4">00987</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a0d055b448c19b6c0b9f6b0dbf0fe89c4">space_view3d_listener</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa, <span class="keyword">struct</span> <a class="code" href="../../d4/d07/structwmNotifier.html">wmNotifier</a> *wmn)
<a name="l00988"></a>00988 {
<a name="l00989"></a>00989     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00990"></a>00990 
<a name="l00991"></a>00991     <span class="comment">/* context changes */</span>
<a name="l00992"></a>00992     <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a8d2543a915bef78c58c06b1cc765e2fd">category</a>) {
<a name="l00993"></a>00993         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>:
<a name="l00994"></a>00994             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l00995"></a>00995                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a0792c1b48c7575e8da04a53df4ac5e69">ND_WORLD</a>:
<a name="l00996"></a>00996                     <span class="keywordflow">if</span> (v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a70f4e893f7a84825c972ac65835d02bb">flag2</a> &amp; <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a5cb67e48c19ed7b93ea2d25ad4e7ee80">V3D_RENDER_OVERRIDE</a>)
<a name="l00997"></a>00997                         <a class="code" href="../../d1/d12/ED__screen_8h.html#a073feea7645bc6fffd331c7f1d2d5ae3">ED_area_tag_redraw_regiontype</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>);
<a name="l00998"></a>00998                     <span class="keywordflow">break</span>;
<a name="l00999"></a>00999             }
<a name="l01000"></a>01000             <span class="keywordflow">break</span>;
<a name="l01001"></a>01001         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a03dbfa96e493f56aac353e5550380e8b">NC_WORLD</a>:
<a name="l01002"></a>01002             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l01003"></a>01003                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#abd3a61b75254bbf02378c26c340c1063">ND_WORLD_DRAW</a>:
<a name="l01004"></a>01004                     <span class="keywordflow">if</span> (v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a70f4e893f7a84825c972ac65835d02bb">flag2</a> &amp; <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a5cb67e48c19ed7b93ea2d25ad4e7ee80">V3D_RENDER_OVERRIDE</a>)
<a name="l01005"></a>01005                         <a class="code" href="../../d1/d12/ED__screen_8h.html#a073feea7645bc6fffd331c7f1d2d5ae3">ED_area_tag_redraw_regiontype</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>);
<a name="l01006"></a>01006                     <span class="keywordflow">break</span>;
<a name="l01007"></a>01007             }
<a name="l01008"></a>01008             <span class="keywordflow">break</span>;
<a name="l01009"></a>01009         <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a835f426982dfbc3be8305095253ad793">NC_MATERIAL</a>:
<a name="l01010"></a>01010             <span class="keywordflow">switch</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a>) {
<a name="l01011"></a>01011                 <span class="keywordflow">case</span> <a class="code" href="../../d4/ddc/WM__types_8h.html#a6cc4913036e9953f8c01c6630065fc2f">ND_NODES</a>:
<a name="l01012"></a>01012                     <span class="keywordflow">if</span> (v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a591cd4c57e5a79352f6733f6fa2bc1c9">drawtype</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a12c14080c880d52c6a50c271e8bb87f8">OB_TEXTURE</a>)
<a name="l01013"></a>01013                         <a class="code" href="../../d1/d12/ED__screen_8h.html#a073feea7645bc6fffd331c7f1d2d5ae3">ED_area_tag_redraw_regiontype</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>);
<a name="l01014"></a>01014                     <span class="keywordflow">break</span>;
<a name="l01015"></a>01015             }
<a name="l01016"></a>01016             <span class="keywordflow">break</span>;
<a name="l01017"></a>01017     }
<a name="l01018"></a>01018 
<a name="l01019"></a>01019     <span class="comment">// removed since BKE_image_user_calc_frame is now called in draw_bgpic because screen_ops doesnt call the notifier.</span>
<a name="l01020"></a>01020 <span class="preprocessor">#if 0</span>
<a name="l01021"></a>01021 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a8d2543a915bef78c58c06b1cc765e2fd">category</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> &amp;&amp; wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#a0c5aedeba4ddcd19c9714f01e06a9a84">data</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>) {
<a name="l01022"></a>01022         <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = area-&gt;spacedata.first;
<a name="l01023"></a>01023         <a class="code" href="../../df/da6/structBGpic.html">BGpic</a> *bgpic = v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a3246c1cbdd50c393126180ae4446992e">bgpicbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01024"></a>01024 
<a name="l01025"></a>01025         <span class="keywordflow">for</span> (; bgpic; bgpic = bgpic-&gt;<a class="code" href="../../df/da6/structBGpic.html#a81c485660f1feac2cfa5c5813153c2f0">next</a>) {
<a name="l01026"></a>01026             <span class="keywordflow">if</span> (bgpic-&gt;<a class="code" href="../../df/da6/structBGpic.html#a826bef753b14debc45e2cacc6dc3c6f2">ima</a>) {
<a name="l01027"></a>01027                 <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = wmn-&gt;<a class="code" href="../../d4/d07/structwmNotifier.html#ae6b35e6d9d11657a5ee311b72ea3de5d">reference</a>;
<a name="l01028"></a>01028                 <a class="code" href="../../d2/d77/BKE__image_8h.html#a10903f281a2ed1213eb50d6ae09f50da">BKE_image_user_calc_frame</a>(&amp;bgpic-&gt;<a class="code" href="../../df/da6/structBGpic.html#a16f3925559495b9236d5e8160bc8f842">iuser</a>, scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>, 0);
<a name="l01029"></a>01029             }
<a name="l01030"></a>01030         }
<a name="l01031"></a>01031     }
<a name="l01032"></a>01032 <span class="preprocessor">#endif</span>
<a name="l01033"></a>01033 <span class="preprocessor"></span>}
<a name="l01034"></a>01034 
<a name="l01035"></a><a class="code" href="../../d4/df4/view3d__intern_8h.html#aa2fbc8a45725b8f71eecbc8caabf96dd">01035</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d28/space__view3d_8c.html#aa2fbc8a45725b8f71eecbc8caabf96dd">view3d_context_dir</a>[] = {
<a name="l01036"></a>01036     <span class="stringliteral">&quot;selected_objects&quot;</span>, <span class="stringliteral">&quot;selected_bases&quot;</span>, <span class="stringliteral">&quot;selected_editable_objects&quot;</span>,
<a name="l01037"></a>01037     <span class="stringliteral">&quot;selected_editable_bases&quot;</span>, <span class="stringliteral">&quot;visible_objects&quot;</span>, <span class="stringliteral">&quot;visible_bases&quot;</span>, <span class="stringliteral">&quot;selectable_objects&quot;</span>, <span class="stringliteral">&quot;selectable_bases&quot;</span>,
<a name="l01038"></a>01038     <span class="stringliteral">&quot;active_base&quot;</span>, <span class="stringliteral">&quot;active_object&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>
<a name="l01039"></a>01039 };
<a name="l01040"></a>01040 
<a name="l01041"></a><a class="code" href="../../de/d28/space__view3d_8c.html#a1b3b5e2802fb9113297aae88f92ed695">01041</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d28/space__view3d_8c.html#a1b3b5e2802fb9113297aae88f92ed695">view3d_context</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *member, <a class="code" href="../../d5/d8f/structbContextDataResult.html">bContextDataResult</a> *result)
<a name="l01042"></a>01042 {
<a name="l01043"></a>01043     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = <a class="code" href="../../df/d01/BKE__context_8h.html#a88ab4a564441708766a6b4ace3b17908">CTX_wm_view3d</a>(C);
<a name="l01044"></a>01044     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01045"></a>01045     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l01046"></a>01046     <span class="comment">/* fallback to the scene layer, allows duplicate and other object operators to run outside the 3d view */</span>
<a name="l01047"></a>01047     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lay = v3d ? v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a45ac0a23240ec719b0952d62190e9130">lay</a> : scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a506dd867fc58506c37c1e56f6b134056">lay</a>;
<a name="l01048"></a>01048 
<a name="l01049"></a>01049     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa401e8870d4df902fe8a0b6a32bc21e4">CTX_data_dir</a>(member)) {
<a name="l01050"></a>01050         <a class="code" href="../../df/d01/BKE__context_8h.html#a19cfdfbe836a7d168affa16063c61804">CTX_data_dir_set</a>(result, view3d_context_dir);
<a name="l01051"></a>01051     }
<a name="l01052"></a>01052     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selected_objects&quot;</span>) || <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selected_bases&quot;</span>)) {
<a name="l01053"></a>01053         <span class="keywordtype">int</span> selected_objects = <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selected_objects&quot;</span>);
<a name="l01054"></a>01054 
<a name="l01055"></a>01055         <span class="keywordflow">for</span> (base = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; base; base = base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l01056"></a>01056             <span class="keywordflow">if</span> ((base-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) &amp;&amp; (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a> &amp; lay)) {
<a name="l01057"></a>01057                 <span class="keywordflow">if</span> ((base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) == 0) {
<a name="l01058"></a>01058                     <span class="keywordflow">if</span> (selected_objects)
<a name="l01059"></a>01059                         <a class="code" href="../../df/d01/BKE__context_8h.html#a53678c85e111b0c5aaf31f78702583e3">CTX_data_id_list_add</a>(result, &amp;base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>);
<a name="l01060"></a>01060                     <span class="keywordflow">else</span>
<a name="l01061"></a>01061                         <a class="code" href="../../df/d01/BKE__context_8h.html#a9f6a67ae43b146710149d19b8f49a6b0">CTX_data_list_add</a>(result, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a26b3c5a36c7af362ef220911e533b55a">RNA_ObjectBase</a>, base);
<a name="l01062"></a>01062                 }
<a name="l01063"></a>01063             }
<a name="l01064"></a>01064         }
<a name="l01065"></a>01065         <a class="code" href="../../df/d01/BKE__context_8h.html#ac2c8440421ee6750153db37e5cad893d">CTX_data_type_set</a>(result, <a class="code" href="../../df/d01/BKE__context_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aa533f445e50630fd9ca811f6afd378ee">CTX_DATA_TYPE_COLLECTION</a>);
<a name="l01066"></a>01066         <span class="keywordflow">return</span> 1;
<a name="l01067"></a>01067     }
<a name="l01068"></a>01068     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selected_editable_objects&quot;</span>) || <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selected_editable_bases&quot;</span>)) {
<a name="l01069"></a>01069         <span class="keywordtype">int</span> selected_editable_objects = <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selected_editable_objects&quot;</span>);
<a name="l01070"></a>01070 
<a name="l01071"></a>01071         <span class="keywordflow">for</span> (base = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; base; base = base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l01072"></a>01072             <span class="keywordflow">if</span> ((base-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) &amp;&amp; (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a> &amp; lay)) {
<a name="l01073"></a>01073                 <span class="keywordflow">if</span> ((base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) == 0) {
<a name="l01074"></a>01074                     <span class="keywordflow">if</span> (0 == <a class="code" href="../../df/dac/BKE__object_8h.html#a5d5bf72db49cdbf719ae31d77915c5aa">object_is_libdata</a>(base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>)) {
<a name="l01075"></a>01075                         <span class="keywordflow">if</span> (selected_editable_objects)
<a name="l01076"></a>01076                             <a class="code" href="../../df/d01/BKE__context_8h.html#a53678c85e111b0c5aaf31f78702583e3">CTX_data_id_list_add</a>(result, &amp;base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>);
<a name="l01077"></a>01077                         <span class="keywordflow">else</span>
<a name="l01078"></a>01078                             <a class="code" href="../../df/d01/BKE__context_8h.html#a9f6a67ae43b146710149d19b8f49a6b0">CTX_data_list_add</a>(result, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a26b3c5a36c7af362ef220911e533b55a">RNA_ObjectBase</a>, base);
<a name="l01079"></a>01079                     }
<a name="l01080"></a>01080                 }
<a name="l01081"></a>01081             }
<a name="l01082"></a>01082         }
<a name="l01083"></a>01083         <a class="code" href="../../df/d01/BKE__context_8h.html#ac2c8440421ee6750153db37e5cad893d">CTX_data_type_set</a>(result, <a class="code" href="../../df/d01/BKE__context_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aa533f445e50630fd9ca811f6afd378ee">CTX_DATA_TYPE_COLLECTION</a>);
<a name="l01084"></a>01084         <span class="keywordflow">return</span> 1;
<a name="l01085"></a>01085     }
<a name="l01086"></a>01086     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;visible_objects&quot;</span>) || <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;visible_bases&quot;</span>)) {
<a name="l01087"></a>01087         <span class="keywordtype">int</span> visible_objects = <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;visible_objects&quot;</span>);
<a name="l01088"></a>01088 
<a name="l01089"></a>01089         <span class="keywordflow">for</span> (base = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; base; base = base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l01090"></a>01090             <span class="keywordflow">if</span> (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a> &amp; lay) {
<a name="l01091"></a>01091                 <span class="keywordflow">if</span> ((base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) == 0) {
<a name="l01092"></a>01092                     <span class="keywordflow">if</span> (visible_objects)
<a name="l01093"></a>01093                         <a class="code" href="../../df/d01/BKE__context_8h.html#a53678c85e111b0c5aaf31f78702583e3">CTX_data_id_list_add</a>(result, &amp;base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>);
<a name="l01094"></a>01094                     <span class="keywordflow">else</span>
<a name="l01095"></a>01095                         <a class="code" href="../../df/d01/BKE__context_8h.html#a9f6a67ae43b146710149d19b8f49a6b0">CTX_data_list_add</a>(result, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a26b3c5a36c7af362ef220911e533b55a">RNA_ObjectBase</a>, base);
<a name="l01096"></a>01096                 }
<a name="l01097"></a>01097             }
<a name="l01098"></a>01098         }
<a name="l01099"></a>01099         <a class="code" href="../../df/d01/BKE__context_8h.html#ac2c8440421ee6750153db37e5cad893d">CTX_data_type_set</a>(result, <a class="code" href="../../df/d01/BKE__context_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aa533f445e50630fd9ca811f6afd378ee">CTX_DATA_TYPE_COLLECTION</a>);
<a name="l01100"></a>01100         <span class="keywordflow">return</span> 1;
<a name="l01101"></a>01101     }
<a name="l01102"></a>01102     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selectable_objects&quot;</span>) || <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selectable_bases&quot;</span>)) {
<a name="l01103"></a>01103         <span class="keywordtype">int</span> selectable_objects = <a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;selectable_objects&quot;</span>);
<a name="l01104"></a>01104 
<a name="l01105"></a>01105         <span class="keywordflow">for</span> (base = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; base; base = base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l01106"></a>01106             <span class="keywordflow">if</span> (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a> &amp; lay) {
<a name="l01107"></a>01107                 <span class="keywordflow">if</span> ((base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) == 0 &amp;&amp; (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a0a7b633594bee6f715ff6e8525317276">OB_RESTRICT_SELECT</a>) == 0) {
<a name="l01108"></a>01108                     <span class="keywordflow">if</span> (selectable_objects)
<a name="l01109"></a>01109                         <a class="code" href="../../df/d01/BKE__context_8h.html#a53678c85e111b0c5aaf31f78702583e3">CTX_data_id_list_add</a>(result, &amp;base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>);
<a name="l01110"></a>01110                     <span class="keywordflow">else</span>
<a name="l01111"></a>01111                         <a class="code" href="../../df/d01/BKE__context_8h.html#a9f6a67ae43b146710149d19b8f49a6b0">CTX_data_list_add</a>(result, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a26b3c5a36c7af362ef220911e533b55a">RNA_ObjectBase</a>, base);
<a name="l01112"></a>01112                 }
<a name="l01113"></a>01113             }
<a name="l01114"></a>01114         }
<a name="l01115"></a>01115         <a class="code" href="../../df/d01/BKE__context_8h.html#ac2c8440421ee6750153db37e5cad893d">CTX_data_type_set</a>(result, <a class="code" href="../../df/d01/BKE__context_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aa533f445e50630fd9ca811f6afd378ee">CTX_DATA_TYPE_COLLECTION</a>);
<a name="l01116"></a>01116         <span class="keywordflow">return</span> 1;
<a name="l01117"></a>01117     }
<a name="l01118"></a>01118     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;active_base&quot;</span>)) {
<a name="l01119"></a>01119         <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a> &amp;&amp; (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a> &amp; lay))
<a name="l01120"></a>01120             <span class="keywordflow">if</span> ((scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) == 0)
<a name="l01121"></a>01121                 <a class="code" href="../../df/d01/BKE__context_8h.html#a36c8a1c4b542713f489663ea2fd8a9ef">CTX_data_pointer_set</a>(result, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a26b3c5a36c7af362ef220911e533b55a">RNA_ObjectBase</a>, scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>);
<a name="l01122"></a>01122         
<a name="l01123"></a>01123         <span class="keywordflow">return</span> 1;
<a name="l01124"></a>01124     }
<a name="l01125"></a>01125     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a228bd8cfa9f1d2f1eda5f4721ec5d135">CTX_data_equals</a>(member, <span class="stringliteral">&quot;active_object&quot;</span>)) {
<a name="l01126"></a>01126         <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a> &amp;&amp; (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a> &amp; lay))
<a name="l01127"></a>01127             <span class="keywordflow">if</span> ((scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) == 0)
<a name="l01128"></a>01128                 <a class="code" href="../../df/d01/BKE__context_8h.html#a476bd9e38c8b8611dc361d4def05fdcb">CTX_data_id_pointer_set</a>(result, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>);
<a name="l01129"></a>01129         
<a name="l01130"></a>01130         <span class="keywordflow">return</span> 1;
<a name="l01131"></a>01131     }
<a name="l01132"></a>01132     <span class="keywordflow">else</span> {
<a name="l01133"></a>01133         <span class="keywordflow">return</span> 0; <span class="comment">/* not found */</span>
<a name="l01134"></a>01134     }
<a name="l01135"></a>01135 
<a name="l01136"></a>01136     <span class="keywordflow">return</span> -1; <span class="comment">/* found but not available */</span>
<a name="l01137"></a>01137 }
<a name="l01138"></a>01138 
<a name="l01139"></a>01139 
<a name="l01140"></a>01140 <span class="comment">/* only called once, from space/spacetypes.c */</span>
<a name="l01141"></a><a class="code" href="../../de/d28/space__view3d_8c.html#aa4e50002a9cc5e3810981b11d41479ed">01141</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/ED__space__api_8h.html#aa4e50002a9cc5e3810981b11d41479ed">ED_spacetype_view3d</a>(<span class="keywordtype">void</span>)
<a name="l01142"></a>01142 {
<a name="l01143"></a>01143     <a class="code" href="../../dd/d66/structSpaceType.html">SpaceType</a> *st = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d66/structSpaceType.html">SpaceType</a>), <span class="stringliteral">&quot;spacetype view3d&quot;</span>);
<a name="l01144"></a>01144     <a class="code" href="../../d7/da9/structARegionType.html">ARegionType</a> *art;
<a name="l01145"></a>01145     
<a name="l01146"></a>01146     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#ab48524ff2ba06b807a02a30beb483ed4">spaceid</a> = <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>;
<a name="l01147"></a>01147     strncpy(st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#ac40280f96e167cb439c8b2b5f351ae2b">name</a>, <span class="stringliteral">&quot;View3D&quot;</span>, <a class="code" href="../../d7/da3/BKE__screen_8h.html#a45abf23f4d3b58f03552ce758729d1f8">BKE_ST_MAXNAME</a>);
<a name="l01148"></a>01148     
<a name="l01149"></a>01149     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#aaa1fdc111c713e152ca17d11eb2b9d0d">new</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a6f70e4862d0df4bfe6568c7623b98f15">view3d_new</a>;
<a name="l01150"></a>01150     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a385600342d1d047d4eadd30788daae58">free</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a2e371e18311c7b29d472f2e6c10b2d13">view3d_free</a>;
<a name="l01151"></a>01151     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#abdfcfd243ed3663447182e07f9ba8d76">init</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a7e69c97823a35b8c7bab4af8a1351131">view3d_init</a>;
<a name="l01152"></a>01152     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#ac5d56cacefe324cee0857b015ac5d0c6">listener</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a0d055b448c19b6c0b9f6b0dbf0fe89c4">space_view3d_listener</a>;
<a name="l01153"></a>01153     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#aba604002bcb41899db2672f3332fa955">duplicate</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a1561e1344918a6d684a2e85df2a66d69">view3d_duplicate</a>;
<a name="l01154"></a>01154     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a97e505a2cad545e427a2ff4461929a7f">operatortypes</a> = <a class="code" href="../../d4/df4/view3d__intern_8h.html#a31d5ab0828ba6eb0301577c9d3903537">view3d_operatortypes</a>;
<a name="l01155"></a>01155     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a335606bfa25da72f8e03c082e8a6bd11">keymap</a> = <a class="code" href="../../d4/df4/view3d__intern_8h.html#a09dc91911e248ace3871c149cf9d2d61">view3d_keymap</a>;
<a name="l01156"></a>01156     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#aba620bf739db99a7a4fbc498a9873475">dropboxes</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#af3489d14fc56e0d65c88f442157dd482">view3d_dropboxes</a>;
<a name="l01157"></a>01157     st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#afb272f07005b0b040444e6f1b4ac17dd">context</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a1b3b5e2802fb9113297aae88f92ed695">view3d_context</a>;
<a name="l01158"></a>01158     
<a name="l01159"></a>01159     <span class="comment">/* regions: main window */</span>
<a name="l01160"></a>01160     art = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/da9/structARegionType.html">ARegionType</a>), <span class="stringliteral">&quot;spacetype view3d main region&quot;</span>);
<a name="l01161"></a>01161     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#adc963cf5301f7c166227476bd6007351">regionid</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>;
<a name="l01162"></a>01162     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a83727d6e4d5eb74d2f61031449675894">keymapflag</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#ae7b0ad3a25ed9ecdc7b6047f5e9f874e">ED_KEYMAP_GPENCIL</a>;
<a name="l01163"></a>01163     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a2733a2a01ced2989eda7b8bd856822ff">draw</a> = <a class="code" href="../../d8/d7f/view3d__draw_8c.html#a96f6cc5a0affb74ca0feba5e4bacfa52">view3d_main_area_draw</a>;
<a name="l01164"></a>01164     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a016e36f773c731c6cad78ad47cd69497">init</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#aabdadbf7e61c6ddfc0cd9ecb5324c966">view3d_main_area_init</a>;
<a name="l01165"></a>01165     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a572f0dac96aa5d3c85bc8bf13808ad2d">free</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a8931d03e23e7bbe75099cf379246de8b">view3d_main_area_free</a>;
<a name="l01166"></a>01166     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#ac1e59fbb92693f45f1857a95e8b1606e">duplicate</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a175c01e73d0a3a6206ae20f4d2f55946">view3d_main_area_duplicate</a>;
<a name="l01167"></a>01167     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#af40dfa26b17422112dcf6b5a216e0326">listener</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#aacba4ef5db72747f6f59d1668841093b">view3d_main_area_listener</a>;
<a name="l01168"></a>01168     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#ab586e66911ec226eb2fcf6ef645d24b8">cursor</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#ae1524449e4c26c70535c5db33e8045d1">view3d_main_area_cursor</a>;
<a name="l01169"></a>01169     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a5209eaa7e4f9683ceac1a24401676570">lock</a> = 1;   <span class="comment">/* can become flag, see BKE_spacedata_draw_locks */</span>
<a name="l01170"></a>01170     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a0898c8f786986bbb89e252e18a7b560e">regiontypes</a>, art);
<a name="l01171"></a>01171     
<a name="l01172"></a>01172     <span class="comment">/* regions: listview/buttons */</span>
<a name="l01173"></a>01173     art = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/da9/structARegionType.html">ARegionType</a>), <span class="stringliteral">&quot;spacetype view3d buttons region&quot;</span>);
<a name="l01174"></a>01174     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#adc963cf5301f7c166227476bd6007351">regionid</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a1324ee7084207af80aad66c626841e8c">RGN_TYPE_UI</a>;
<a name="l01175"></a>01175     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a42adc2547994df726d3dc8bce9028601">prefsizex</a> = 180; <span class="comment">// XXX</span>
<a name="l01176"></a>01176     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a83727d6e4d5eb74d2f61031449675894">keymapflag</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#afe076e6519bb89b26bd067645a45c920">ED_KEYMAP_UI</a> | <a class="code" href="../../d1/d12/ED__screen_8h.html#a18d81a5f638e7d5c787d340a7f415917">ED_KEYMAP_FRAMES</a>;
<a name="l01177"></a>01177     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#af40dfa26b17422112dcf6b5a216e0326">listener</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a6277766f8c4881afb84142ea0fd607ac">view3d_buttons_area_listener</a>;
<a name="l01178"></a>01178     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a016e36f773c731c6cad78ad47cd69497">init</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a758375fbdcf77291329e8cb4999d321b">view3d_buttons_area_init</a>;
<a name="l01179"></a>01179     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a2733a2a01ced2989eda7b8bd856822ff">draw</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a2aa12a41873f8618e2634b2bb62c7103">view3d_buttons_area_draw</a>;
<a name="l01180"></a>01180     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a0898c8f786986bbb89e252e18a7b560e">regiontypes</a>, art);
<a name="l01181"></a>01181 
<a name="l01182"></a>01182     <a class="code" href="../../d2/d47/view3d__buttons_8c.html#a8ae7bd021eb095ed50fa6c40fe7866b4">view3d_buttons_register</a>(art);
<a name="l01183"></a>01183 
<a name="l01184"></a>01184     <span class="comment">/* regions: tool(bar) */</span>
<a name="l01185"></a>01185     art = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/da9/structARegionType.html">ARegionType</a>), <span class="stringliteral">&quot;spacetype view3d tools region&quot;</span>);
<a name="l01186"></a>01186     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#adc963cf5301f7c166227476bd6007351">regionid</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ad274603e567ada5179c2a7a3d5fb99f4">RGN_TYPE_TOOLS</a>;
<a name="l01187"></a>01187     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a42adc2547994df726d3dc8bce9028601">prefsizex</a> = 160; <span class="comment">// XXX</span>
<a name="l01188"></a>01188     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a731e71cf273e50acc629de70427ff2bd">prefsizey</a> = 50; <span class="comment">// XXX</span>
<a name="l01189"></a>01189     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a83727d6e4d5eb74d2f61031449675894">keymapflag</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#afe076e6519bb89b26bd067645a45c920">ED_KEYMAP_UI</a> | <a class="code" href="../../d1/d12/ED__screen_8h.html#a18d81a5f638e7d5c787d340a7f415917">ED_KEYMAP_FRAMES</a>;
<a name="l01190"></a>01190     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#af40dfa26b17422112dcf6b5a216e0326">listener</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a6277766f8c4881afb84142ea0fd607ac">view3d_buttons_area_listener</a>;
<a name="l01191"></a>01191     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a016e36f773c731c6cad78ad47cd69497">init</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a74295cd8053f6fbbf27d584cda4b846e">view3d_tools_area_init</a>;
<a name="l01192"></a>01192     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a2733a2a01ced2989eda7b8bd856822ff">draw</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a663a6516cc4724e9d777c786eaf798d6">view3d_tools_area_draw</a>;
<a name="l01193"></a>01193     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a0898c8f786986bbb89e252e18a7b560e">regiontypes</a>, art);
<a name="l01194"></a>01194     
<a name="l01195"></a>01195 <span class="preprocessor">#if 0</span>
<a name="l01196"></a>01196 <span class="preprocessor"></span>    <span class="comment">/* unfinished still */</span>
<a name="l01197"></a>01197     <a class="code" href="../../d4/df4/view3d__intern_8h.html#af6204a682b64d9d44fc7a8601789a780">view3d_toolshelf_register</a>(art);
<a name="l01198"></a>01198 <span class="preprocessor">#endif</span>
<a name="l01199"></a>01199 <span class="preprocessor"></span>
<a name="l01200"></a>01200     <span class="comment">/* regions: tool properties */</span>
<a name="l01201"></a>01201     art = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/da9/structARegionType.html">ARegionType</a>), <span class="stringliteral">&quot;spacetype view3d tool properties region&quot;</span>);
<a name="l01202"></a>01202     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#adc963cf5301f7c166227476bd6007351">regionid</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2aef41b39373a2eb1b6497f25ce95c05e3">RGN_TYPE_TOOL_PROPS</a>;
<a name="l01203"></a>01203     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a42adc2547994df726d3dc8bce9028601">prefsizex</a> = 0;
<a name="l01204"></a>01204     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a731e71cf273e50acc629de70427ff2bd">prefsizey</a> = 120;
<a name="l01205"></a>01205     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a83727d6e4d5eb74d2f61031449675894">keymapflag</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#afe076e6519bb89b26bd067645a45c920">ED_KEYMAP_UI</a> | <a class="code" href="../../d1/d12/ED__screen_8h.html#a18d81a5f638e7d5c787d340a7f415917">ED_KEYMAP_FRAMES</a>;
<a name="l01206"></a>01206     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#af40dfa26b17422112dcf6b5a216e0326">listener</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a3adcc59c54470815b23d370009a40c76">view3d_props_area_listener</a>;
<a name="l01207"></a>01207     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a016e36f773c731c6cad78ad47cd69497">init</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a74295cd8053f6fbbf27d584cda4b846e">view3d_tools_area_init</a>;
<a name="l01208"></a>01208     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a2733a2a01ced2989eda7b8bd856822ff">draw</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a663a6516cc4724e9d777c786eaf798d6">view3d_tools_area_draw</a>;
<a name="l01209"></a>01209     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a0898c8f786986bbb89e252e18a7b560e">regiontypes</a>, art);
<a name="l01210"></a>01210     
<a name="l01211"></a>01211     <a class="code" href="../../d4/df4/view3d__intern_8h.html#ab9cf8ea3a766c1a97116f88fbabe03c5">view3d_tool_props_register</a>(art);
<a name="l01212"></a>01212     
<a name="l01213"></a>01213     
<a name="l01214"></a>01214     <span class="comment">/* regions: header */</span>
<a name="l01215"></a>01215     art = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/da9/structARegionType.html">ARegionType</a>), <span class="stringliteral">&quot;spacetype view3d header region&quot;</span>);
<a name="l01216"></a>01216     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#adc963cf5301f7c166227476bd6007351">regionid</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>;
<a name="l01217"></a>01217     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a731e71cf273e50acc629de70427ff2bd">prefsizey</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a0786ab753f1dd35145562e237cdfe49d">HEADERY</a>;
<a name="l01218"></a>01218     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a83727d6e4d5eb74d2f61031449675894">keymapflag</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#afe076e6519bb89b26bd067645a45c920">ED_KEYMAP_UI</a> | <a class="code" href="../../d1/d12/ED__screen_8h.html#aac298c77f1ccfa5a91f94b397e110682">ED_KEYMAP_VIEW2D</a> | <a class="code" href="../../d1/d12/ED__screen_8h.html#a18d81a5f638e7d5c787d340a7f415917">ED_KEYMAP_FRAMES</a> | <a class="code" href="../../d1/d12/ED__screen_8h.html#a5e6d02ad07a6b83a8a31bbd814ce6e96">ED_KEYMAP_HEADER</a>;
<a name="l01219"></a>01219     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#af40dfa26b17422112dcf6b5a216e0326">listener</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#ac60765ed047f62a5bde68210b69b803c">view3d_header_area_listener</a>;
<a name="l01220"></a>01220     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a016e36f773c731c6cad78ad47cd69497">init</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#ad53adfc752b478f2d9248b487660cda0">view3d_header_area_init</a>;
<a name="l01221"></a>01221     art-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a2733a2a01ced2989eda7b8bd856822ff">draw</a> = <a class="code" href="../../de/d28/space__view3d_8c.html#a475087fdfe192cf7bb2b737a69c68fda">view3d_header_area_draw</a>;
<a name="l01222"></a>01222     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;st-&gt;<a class="code" href="../../dd/d66/structSpaceType.html#a0898c8f786986bbb89e252e18a7b560e">regiontypes</a>, art);
<a name="l01223"></a>01223     
<a name="l01224"></a>01224     <a class="code" href="../../d7/da3/BKE__screen_8h.html#a8e5658b029bf0421c75322264062a997">BKE_spacetype_register</a>(st);
<a name="l01225"></a>01225 }
<a name="l01226"></a>01226 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:57 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
