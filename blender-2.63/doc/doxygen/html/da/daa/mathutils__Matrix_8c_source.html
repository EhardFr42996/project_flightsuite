<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: mathutils_Matrix.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">mathutils_Matrix.c</div>  </div>
</div>
<div class="contents">
<a href="../../da/daa/mathutils__Matrix_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00006"></a>00006 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00007"></a>00007 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00008"></a>00008 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00013"></a>00013 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00017"></a>00017 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * The Original Code is Copyright (C) 2001-2002 by NaN Holding BV.</span>
<a name="l00020"></a>00020 <span class="comment"> * All rights reserved.</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * Contributor(s): Michel Selten &amp; Joseph Gilbert</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;Python.h&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d58/mathutils_8h.html">mathutils.h</a>&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/db3/BLI__string_8h.html">BLI_string.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc9/BLI__dynstr_8h.html" title="A dynamically sized string ADT.">BLI_dynstr.h</a>&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60">00041</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60">eMatrixAccess_t</a> {
<a name="l00042"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a585b2e9c32e993b2c062699ee75be05d">00042</a>     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a585b2e9c32e993b2c062699ee75be05d">MAT_ACCESS_ROW</a>,
<a name="l00043"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a8d04ef4260d23ba4e228cc78f6e64930">00043</a>     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a8d04ef4260d23ba4e228cc78f6e64930">MAT_ACCESS_COL</a>
<a name="l00044"></a>00044 } <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60">eMatrixAccess_t</a>;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8fe1a1fb59878b7028eb74fb83ddb8b6">Matrix_copy</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>);
<a name="l00047"></a>00047 <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8865e678b22736b80ab0b381e96bd7b1">Matrix_deepcopy</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *args);
<a name="l00048"></a>00048 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aaa20df67c1252e1f57889f098981b370">Matrix_ass_slice</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> begin, <span class="keywordtype">int</span> end, PyObject *value);
<a name="l00049"></a>00049 <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af69282eedc8e57c3be2bcaa113caef6f">matrix__apply_to_copy</a>(PyNoArgsFunction matrix_func, <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>);
<a name="l00050"></a>00050 <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af9ec52581bc346b73e59d0b750c14e14">MatrixAccess_CreatePyObject</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *matrix, <span class="keyword">const</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60">eMatrixAccess_t</a> type);
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a20e6454ec050757a975c378c0bfd6555">00052</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a20e6454ec050757a975c378c0bfd6555">matrix_row_vector_check</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *mat, <a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *vec, <span class="keywordtype">int</span> row)
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054     <span class="keywordflow">if</span> ((vec-&gt;<a class="code" href="../../d6/ddb/structVectorObject.html#ac89291eafee981d627bc5b514e8acbaa">size</a> != mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>) || (row &gt;= mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>)) {
<a name="l00055"></a>00055         PyErr_SetString(PyExc_AttributeError,
<a name="l00056"></a>00056                         <span class="stringliteral">&quot;Matrix(): &quot;</span>
<a name="l00057"></a>00057                         <span class="stringliteral">&quot;owner matrix has been resized since this row vector was created&quot;</span>);
<a name="l00058"></a>00058         <span class="keywordflow">return</span> 0;
<a name="l00059"></a>00059     }
<a name="l00060"></a>00060     <span class="keywordflow">else</span> {
<a name="l00061"></a>00061         <span class="keywordflow">return</span> 1;
<a name="l00062"></a>00062     }
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad0d14487dc2b231afd799eb41f81d2ae">00065</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad0d14487dc2b231afd799eb41f81d2ae">matrix_col_vector_check</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *mat, <a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *vec, <span class="keywordtype">int</span> col)
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067     <span class="keywordflow">if</span> ((vec-&gt;<a class="code" href="../../d6/ddb/structVectorObject.html#ac89291eafee981d627bc5b514e8acbaa">size</a> != mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>) || (col &gt;= mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>)) {
<a name="l00068"></a>00068         PyErr_SetString(PyExc_AttributeError,
<a name="l00069"></a>00069                         <span class="stringliteral">&quot;Matrix(): &quot;</span>
<a name="l00070"></a>00070                         <span class="stringliteral">&quot;owner matrix has been resized since this column vector was created&quot;</span>);
<a name="l00071"></a>00071         <span class="keywordflow">return</span> 0;
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073     <span class="keywordflow">else</span> {
<a name="l00074"></a>00074         <span class="keywordflow">return</span> 1;
<a name="l00075"></a>00075     }
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">/* ----------------------------------------------------------------------------</span>
<a name="l00079"></a>00079 <span class="comment"> * matrix row callbacks</span>
<a name="l00080"></a>00080 <span class="comment"> * this is so you can do matrix[i][j] = val OR matrix.row[i][j] = val */</span>
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a46a309eac043b6ade3b6687924fc3e9a">00082</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a46a309eac043b6ade3b6687924fc3e9a">mathutils_matrix_row_cb_index</a> = -1;
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4d228db4f8a3ddfc524266874a20c02d">00084</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4d228db4f8a3ddfc524266874a20c02d">mathutils_matrix_row_check</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo)
<a name="l00085"></a>00085 {
<a name="l00086"></a>00086     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00087"></a>00087     <span class="keywordflow">return</span> <a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>);
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#acf49d9e60c05ea5229b9d393ac95d4ab">00090</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#acf49d9e60c05ea5229b9d393ac95d4ab">mathutils_matrix_row_get</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> row)
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00093"></a>00093     <span class="keywordtype">int</span> col;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00096"></a>00096         <span class="keywordflow">return</span> -1;
<a name="l00097"></a>00097     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a20e6454ec050757a975c378c0bfd6555">matrix_row_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, row))
<a name="l00098"></a>00098         <span class="keywordflow">return</span> -1;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l00101"></a>00101         bmo-&gt;data[col] = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col);
<a name="l00102"></a>00102     }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     <span class="keywordflow">return</span> 0;
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1e722089fb2cf2033ae4f6e1126f604d">00107</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1e722089fb2cf2033ae4f6e1126f604d">mathutils_matrix_row_set</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> row)
<a name="l00108"></a>00108 {
<a name="l00109"></a>00109     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00110"></a>00110     <span class="keywordtype">int</span> col;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00113"></a>00113         <span class="keywordflow">return</span> -1;
<a name="l00114"></a>00114     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a20e6454ec050757a975c378c0bfd6555">matrix_row_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, row))
<a name="l00115"></a>00115         <span class="keywordflow">return</span> -1;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l00118"></a>00118         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = bmo-&gt;data[col];
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l00122"></a>00122     <span class="keywordflow">return</span> 0;
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00125"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a23b29d17f8803dbe65ca396e72816b6d">00125</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a23b29d17f8803dbe65ca396e72816b6d">mathutils_matrix_row_get_index</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)
<a name="l00126"></a>00126 {
<a name="l00127"></a>00127     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00130"></a>00130         <span class="keywordflow">return</span> -1;
<a name="l00131"></a>00131     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a20e6454ec050757a975c378c0bfd6555">matrix_row_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, row))
<a name="l00132"></a>00132         <span class="keywordflow">return</span> -1;
<a name="l00133"></a>00133 
<a name="l00134"></a>00134     bmo-&gt;data[col] = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col);
<a name="l00135"></a>00135     <span class="keywordflow">return</span> 0;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a28581841d2affcd5c999a0e18b6ed7e7">00138</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a28581841d2affcd5c999a0e18b6ed7e7">mathutils_matrix_row_set_index</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00143"></a>00143         <span class="keywordflow">return</span> -1;
<a name="l00144"></a>00144     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a20e6454ec050757a975c378c0bfd6555">matrix_row_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, row))
<a name="l00145"></a>00145         <span class="keywordflow">return</span> -1;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = bmo-&gt;data[col];
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l00150"></a>00150     <span class="keywordflow">return</span> 0;
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 
<a name="l00153"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a876e4e78958e85ccab02dc4615e58cbc">00153</a> <a class="code" href="../../df/dbc/structMathutils__Callback.html">Mathutils_Callback</a> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9657484612f5b4213db522dcdee2674e">mathutils_matrix_row_cb</a> = {
<a name="l00154"></a>00154     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4d228db4f8a3ddfc524266874a20c02d">mathutils_matrix_row_check</a>,
<a name="l00155"></a>00155     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#acf49d9e60c05ea5229b9d393ac95d4ab">mathutils_matrix_row_get</a>,
<a name="l00156"></a>00156     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1e722089fb2cf2033ae4f6e1126f604d">mathutils_matrix_row_set</a>,
<a name="l00157"></a>00157     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a23b29d17f8803dbe65ca396e72816b6d">mathutils_matrix_row_get_index</a>,
<a name="l00158"></a>00158     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a28581841d2affcd5c999a0e18b6ed7e7">mathutils_matrix_row_set_index</a>
<a name="l00159"></a>00159 };
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="comment">/* ----------------------------------------------------------------------------</span>
<a name="l00163"></a>00163 <span class="comment"> * matrix row callbacks</span>
<a name="l00164"></a>00164 <span class="comment"> * this is so you can do matrix.col[i][j] = val */</span>
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#af9226430f6c79126ab66a3f97b5b9e27">00166</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af9226430f6c79126ab66a3f97b5b9e27">mathutils_matrix_col_cb_index</a> = -1;
<a name="l00167"></a>00167 
<a name="l00168"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae50d5f61b5bc4a4c2b84cd0d0c7ba2af">00168</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae50d5f61b5bc4a4c2b84cd0d0c7ba2af">mathutils_matrix_col_check</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo)
<a name="l00169"></a>00169 {
<a name="l00170"></a>00170     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00171"></a>00171     <span class="keywordflow">return</span> <a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>);
<a name="l00172"></a>00172 }
<a name="l00173"></a>00173 
<a name="l00174"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a2c87ab7b8d9ff06310bfb30f2042d741">00174</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a2c87ab7b8d9ff06310bfb30f2042d741">mathutils_matrix_col_get</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col)
<a name="l00175"></a>00175 {
<a name="l00176"></a>00176     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00177"></a>00177     <span class="keywordtype">int</span> num_row;
<a name="l00178"></a>00178     <span class="keywordtype">int</span> row;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00181"></a>00181         <span class="keywordflow">return</span> -1;
<a name="l00182"></a>00182     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad0d14487dc2b231afd799eb41f81d2ae">matrix_col_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, col))
<a name="l00183"></a>00183         <span class="keywordflow">return</span> -1;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     <span class="comment">/* for &#39;translation&#39; size will always be &#39;3&#39; even on 4x4 vec */</span>
<a name="l00186"></a>00186     num_row = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(self-&gt;num_row, ((<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo)-&gt;size);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="keywordflow">for</span> (row = 0; row &lt; num_row; row++) {
<a name="l00189"></a>00189         bmo-&gt;data[row] = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col);
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="keywordflow">return</span> 0;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a14ea41347b614c84e95cea48b9502c7f">00195</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a14ea41347b614c84e95cea48b9502c7f">mathutils_matrix_col_set</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col)
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00198"></a>00198     <span class="keywordtype">int</span> num_row;
<a name="l00199"></a>00199     <span class="keywordtype">int</span> row;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00202"></a>00202         <span class="keywordflow">return</span> -1;
<a name="l00203"></a>00203     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad0d14487dc2b231afd799eb41f81d2ae">matrix_col_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, col))
<a name="l00204"></a>00204         <span class="keywordflow">return</span> -1;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="comment">/* for &#39;translation&#39; size will always be &#39;3&#39; even on 4x4 vec */</span>
<a name="l00207"></a>00207     num_row = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(self-&gt;num_row, ((<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo)-&gt;size);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="keywordflow">for</span> (row = 0; row &lt; num_row; row++) {
<a name="l00210"></a>00210         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = bmo-&gt;data[row];
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l00214"></a>00214     <span class="keywordflow">return</span> 0;
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00217"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a80d55d42698ba944d44ea1f724281a8e">00217</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a80d55d42698ba944d44ea1f724281a8e">mathutils_matrix_col_get_index</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> row)
<a name="l00218"></a>00218 {
<a name="l00219"></a>00219     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00222"></a>00222         <span class="keywordflow">return</span> -1;
<a name="l00223"></a>00223     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad0d14487dc2b231afd799eb41f81d2ae">matrix_col_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, col))
<a name="l00224"></a>00224         <span class="keywordflow">return</span> -1;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     bmo-&gt;data[row] = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col);
<a name="l00227"></a>00227     <span class="keywordflow">return</span> 0;
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae7fe469f1fc9f2c60a9c2a4d65592dee">00230</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae7fe469f1fc9f2c60a9c2a4d65592dee">mathutils_matrix_col_set_index</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> row)
<a name="l00231"></a>00231 {
<a name="l00232"></a>00232     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00235"></a>00235         <span class="keywordflow">return</span> -1;
<a name="l00236"></a>00236     <span class="keywordflow">if</span> (!<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad0d14487dc2b231afd799eb41f81d2ae">matrix_col_vector_check</a>(<span class="keyword">self</span>, (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)bmo, col))
<a name="l00237"></a>00237         <span class="keywordflow">return</span> -1;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = bmo-&gt;data[row];
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l00242"></a>00242     <span class="keywordflow">return</span> 0;
<a name="l00243"></a>00243 }
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a9e5b1eb95bb94b950b6f859c1e4cbb94">00245</a> <a class="code" href="../../df/dbc/structMathutils__Callback.html">Mathutils_Callback</a> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a63c2bf819f06bca342a617116b070c2e">mathutils_matrix_col_cb</a> = {
<a name="l00246"></a>00246     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae50d5f61b5bc4a4c2b84cd0d0c7ba2af">mathutils_matrix_col_check</a>,
<a name="l00247"></a>00247     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a2c87ab7b8d9ff06310bfb30f2042d741">mathutils_matrix_col_get</a>,
<a name="l00248"></a>00248     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a14ea41347b614c84e95cea48b9502c7f">mathutils_matrix_col_set</a>,
<a name="l00249"></a>00249     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a80d55d42698ba944d44ea1f724281a8e">mathutils_matrix_col_get_index</a>,
<a name="l00250"></a>00250     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae7fe469f1fc9f2c60a9c2a4d65592dee">mathutils_matrix_col_set_index</a>
<a name="l00251"></a>00251 };
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="comment">/* ----------------------------------------------------------------------------</span>
<a name="l00255"></a>00255 <span class="comment"> * matrix row callbacks</span>
<a name="l00256"></a>00256 <span class="comment"> * this is so you can do matrix.translation = val</span>
<a name="l00257"></a>00257 <span class="comment"> * note, this is _exactly like matrix.col except the 4th component is always omitted */</span>
<a name="l00258"></a>00258 
<a name="l00259"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a1d69cf6e5c017ba6cec8f6434e6c0073">00259</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1d69cf6e5c017ba6cec8f6434e6c0073">mathutils_matrix_translation_cb_index</a> = -1;
<a name="l00260"></a>00260 
<a name="l00261"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad8143c7899ecd61e1758381605949f6b">00261</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad8143c7899ecd61e1758381605949f6b">mathutils_matrix_translation_check</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo)
<a name="l00262"></a>00262 {
<a name="l00263"></a>00263     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00264"></a>00264     <span class="keywordflow">return</span> <a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>);
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a973e0ac928e43f3cc6ccfd9f1dd886f5">00267</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a973e0ac928e43f3cc6ccfd9f1dd886f5">mathutils_matrix_translation_get</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col)
<a name="l00268"></a>00268 {
<a name="l00269"></a>00269     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00270"></a>00270     <span class="keywordtype">int</span> row;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00273"></a>00273         <span class="keywordflow">return</span> -1;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="keywordflow">for</span> (row = 0; row &lt; 3; row++) {
<a name="l00276"></a>00276         bmo-&gt;data[row] = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col);
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     <span class="keywordflow">return</span> 0;
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aee95575ea90eed782cd1f353f63a404e">00282</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aee95575ea90eed782cd1f353f63a404e">mathutils_matrix_translation_set</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col)
<a name="l00283"></a>00283 {
<a name="l00284"></a>00284     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00285"></a>00285     <span class="keywordtype">int</span> row;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00288"></a>00288         <span class="keywordflow">return</span> -1;
<a name="l00289"></a>00289 
<a name="l00290"></a>00290     <span class="keywordflow">for</span> (row = 0; row &lt; 3; row++) {
<a name="l00291"></a>00291         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = bmo-&gt;data[row];
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l00295"></a>00295     <span class="keywordflow">return</span> 0;
<a name="l00296"></a>00296 }
<a name="l00297"></a>00297 
<a name="l00298"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8292b814da72b9164d392dcd770e28eb">00298</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8292b814da72b9164d392dcd770e28eb">mathutils_matrix_translation_get_index</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> row)
<a name="l00299"></a>00299 {
<a name="l00300"></a>00300     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00303"></a>00303         <span class="keywordflow">return</span> -1;
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     bmo-&gt;data[row] = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col);
<a name="l00306"></a>00306     <span class="keywordflow">return</span> 0;
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a71a1b855114a81bc2967ed5f05cc8005">00309</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a71a1b855114a81bc2967ed5f05cc8005">mathutils_matrix_translation_set_index</a>(<a class="code" href="../../d5/d6d/structBaseMathObject.html">BaseMathObject</a> *bmo, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> row)
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)bmo-&gt;cb_user;
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00314"></a>00314         <span class="keywordflow">return</span> -1;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = bmo-&gt;data[row];
<a name="l00317"></a>00317 
<a name="l00318"></a>00318     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l00319"></a>00319     <span class="keywordflow">return</span> 0;
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#afebb20506d411dd9f01524d91cc24e54">00322</a> <a class="code" href="../../df/dbc/structMathutils__Callback.html">Mathutils_Callback</a> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9de2b1d268365a191cbc94e9ec47589a">mathutils_matrix_translation_cb</a> = {
<a name="l00323"></a>00323     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad8143c7899ecd61e1758381605949f6b">mathutils_matrix_translation_check</a>,
<a name="l00324"></a>00324     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a973e0ac928e43f3cc6ccfd9f1dd886f5">mathutils_matrix_translation_get</a>,
<a name="l00325"></a>00325     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aee95575ea90eed782cd1f353f63a404e">mathutils_matrix_translation_set</a>,
<a name="l00326"></a>00326     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8292b814da72b9164d392dcd770e28eb">mathutils_matrix_translation_get_index</a>,
<a name="l00327"></a>00327     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a71a1b855114a81bc2967ed5f05cc8005">mathutils_matrix_translation_set_index</a>
<a name="l00328"></a>00328 };
<a name="l00329"></a>00329 
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 <span class="comment">/* matrix column callbacks, this is so you can do matrix.translation = Vector()  */</span>
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 <span class="comment">//----------------------------------mathutils.Matrix() -----------------</span>
<a name="l00334"></a>00334 <span class="comment">//mat is a 1D array of floats - row[0][0], row[0][1], row[1][0], etc.</span>
<a name="l00335"></a>00335 <span class="comment">//create a new matrix type</span>
<a name="l00336"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a10db53ee7452ac66177dd7d18257a549">00336</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a10db53ee7452ac66177dd7d18257a549">Matrix_new</a>(PyTypeObject *type, PyObject *args, PyObject *kwds)
<a name="l00337"></a>00337 {
<a name="l00338"></a>00338     <span class="keywordflow">if</span> (kwds &amp;&amp; PyDict_Size(kwds)) {
<a name="l00339"></a>00339         PyErr_SetString(PyExc_TypeError,
<a name="l00340"></a>00340                         <span class="stringliteral">&quot;Matrix(): &quot;</span>
<a name="l00341"></a>00341                         <span class="stringliteral">&quot;takes no keyword args&quot;</span>);
<a name="l00342"></a>00342         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345     <span class="keywordflow">switch</span> (PyTuple_GET_SIZE(args)) {
<a name="l00346"></a>00346         <span class="keywordflow">case</span> 0:
<a name="l00347"></a>00347             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 4, 4, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, type);
<a name="l00348"></a>00348         <span class="keywordflow">case</span> 1:
<a name="l00349"></a>00349         {
<a name="l00350"></a>00350             PyObject *arg = PyTuple_GET_ITEM(args, 0);
<a name="l00351"></a>00351 
<a name="l00352"></a>00352             <span class="comment">/* Input is now as a sequence of rows so length of sequence</span>
<a name="l00353"></a>00353 <span class="comment">             * is the number of rows */</span>
<a name="l00354"></a>00354             <span class="comment">/* -1 is an error, size checks will accunt for this */</span>
<a name="l00355"></a>00355             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> num_row = PySequence_Size(arg);
<a name="l00356"></a>00356 
<a name="l00357"></a>00357             <span class="keywordflow">if</span> (num_row &gt;= 2 &amp;&amp; num_row &lt;= 4) {
<a name="l00358"></a>00358                 PyObject *item = PySequence_GetItem(arg, 0);
<a name="l00359"></a>00359                 <span class="comment">/* Since each item is a row, number of items is the</span>
<a name="l00360"></a>00360 <span class="comment">                 * same as the number of columns */</span>
<a name="l00361"></a>00361                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> num_col = PySequence_Size(item);
<a name="l00362"></a>00362                 Py_XDECREF(item);
<a name="l00363"></a>00363 
<a name="l00364"></a>00364                 <span class="keywordflow">if</span> (num_col &gt;= 2 &amp;&amp; num_col &lt;= 4) {
<a name="l00365"></a>00365                     <span class="comment">/* sane row &amp; col size, new matrix and assign as slice  */</span>
<a name="l00366"></a>00366                     PyObject *matrix = <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, num_col, num_row, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, type);
<a name="l00367"></a>00367                     <span class="keywordflow">if</span> (<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aaa20df67c1252e1f57889f098981b370">Matrix_ass_slice</a>((<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)matrix, 0, INT_MAX, arg) == 0) {
<a name="l00368"></a>00368                         <span class="keywordflow">return</span> matrix;
<a name="l00369"></a>00369                     }
<a name="l00370"></a>00370                     <span class="keywordflow">else</span> { <span class="comment">/* matrix ok, slice assignment not */</span>
<a name="l00371"></a>00371                         Py_DECREF(matrix);
<a name="l00372"></a>00372                     }
<a name="l00373"></a>00373                 }
<a name="l00374"></a>00374             }
<a name="l00375"></a>00375         }
<a name="l00376"></a>00376     }
<a name="l00377"></a>00377 
<a name="l00378"></a>00378     <span class="comment">/* will overwrite error */</span>
<a name="l00379"></a>00379     PyErr_SetString(PyExc_TypeError,
<a name="l00380"></a>00380                     <span class="stringliteral">&quot;Matrix(): &quot;</span>
<a name="l00381"></a>00381                     <span class="stringliteral">&quot;expects no args or 2-4 numeric sequences&quot;</span>);
<a name="l00382"></a>00382     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00383"></a>00383 }
<a name="l00384"></a>00384 
<a name="l00385"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af69282eedc8e57c3be2bcaa113caef6f">00385</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af69282eedc8e57c3be2bcaa113caef6f">matrix__apply_to_copy</a>(PyNoArgsFunction matrix_func, <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l00386"></a>00386 {
<a name="l00387"></a>00387     PyObject *ret = <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8fe1a1fb59878b7028eb74fb83ddb8b6">Matrix_copy</a>(<span class="keyword">self</span>);
<a name="l00388"></a>00388     PyObject *ret_dummy = matrix_func(ret);
<a name="l00389"></a>00389     <span class="keywordflow">if</span> (ret_dummy) {
<a name="l00390"></a>00390         Py_DECREF(ret_dummy);
<a name="l00391"></a>00391         <span class="keywordflow">return</span> (PyObject *)ret;
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393     <span class="keywordflow">else</span> { <span class="comment">/* error */</span>
<a name="l00394"></a>00394         Py_DECREF(ret);
<a name="l00395"></a>00395         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00396"></a>00396     }
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="comment">/* when a matrix is 4x4 size but initialized as a 3x3, re-assign values for 4x4 */</span>
<a name="l00400"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9340d3b71dd1d530f6baba271b4af22c">00400</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9340d3b71dd1d530f6baba271b4af22c">matrix_3x3_as_4x4</a>(<span class="keywordtype">float</span> mat[16])
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402     mat[10] = mat[8];
<a name="l00403"></a>00403     mat[9] = mat[7];
<a name="l00404"></a>00404     mat[8] = mat[6];
<a name="l00405"></a>00405     mat[7] = 0.0f;
<a name="l00406"></a>00406     mat[6] = mat[5];
<a name="l00407"></a>00407     mat[5] = mat[4];
<a name="l00408"></a>00408     mat[4] = mat[3];
<a name="l00409"></a>00409     mat[3] = 0.0f;
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 <span class="comment">/*-----------------------CLASS-METHODS----------------------------*/</span>
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="comment">//mat is a 1D array of floats - row[0][0], row[0][1], row[1][0], etc.</span>
<a name="l00415"></a>00415 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(C_Matrix_Identity_doc,
<a name="l00416"></a>00416 <span class="stringliteral">&quot;.. classmethod:: Identity(size)\n&quot;</span>
<a name="l00417"></a>00417 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00418"></a>00418 <span class="stringliteral">&quot;   Create an identity matrix.\n&quot;</span>
<a name="l00419"></a>00419 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00420"></a>00420 <span class="stringliteral">&quot;   :arg size: The size of the identity matrix to construct [2, 4].\n&quot;</span>
<a name="l00421"></a>00421 <span class="stringliteral">&quot;   :type size: int\n&quot;</span>
<a name="l00422"></a>00422 <span class="stringliteral">&quot;   :return: A new identity matrix.\n&quot;</span>
<a name="l00423"></a>00423 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l00424"></a>00424 );
<a name="l00425"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0ab3422144434a6457a08579ecdb71bd">00425</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0ab3422144434a6457a08579ecdb71bd">C_Matrix_Identity</a>(PyObject *cls, PyObject *args)
<a name="l00426"></a>00426 {
<a name="l00427"></a>00427     <span class="keywordtype">int</span> matSize;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <span class="keywordflow">if</span> (!PyArg_ParseTuple(args, <span class="stringliteral">&quot;i:Matrix.Identity&quot;</span>, &amp;matSize)) {
<a name="l00430"></a>00430         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00431"></a>00431     }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433     <span class="keywordflow">if</span> (matSize &lt; 2 || matSize &gt; 4) {
<a name="l00434"></a>00434         PyErr_SetString(PyExc_RuntimeError,
<a name="l00435"></a>00435                         <span class="stringliteral">&quot;Matrix.Identity(): &quot;</span>
<a name="l00436"></a>00436                         <span class="stringliteral">&quot;size must be between 2 and 4&quot;</span>);
<a name="l00437"></a>00437         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00438"></a>00438     }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, matSize, matSize, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, (PyTypeObject *)cls);
<a name="l00441"></a>00441 }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(C_Matrix_Rotation_doc,
<a name="l00444"></a>00444 <span class="stringliteral">&quot;.. classmethod:: Rotation(angle, size, axis)\n&quot;</span>
<a name="l00445"></a>00445 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00446"></a>00446 <span class="stringliteral">&quot;   Create a matrix representing a rotation.\n&quot;</span>
<a name="l00447"></a>00447 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00448"></a>00448 <span class="stringliteral">&quot;   :arg angle: The angle of rotation desired, in radians.\n&quot;</span>
<a name="l00449"></a>00449 <span class="stringliteral">&quot;   :type angle: float\n&quot;</span>
<a name="l00450"></a>00450 <span class="stringliteral">&quot;   :arg size: The size of the rotation matrix to construct [2, 4].\n&quot;</span>
<a name="l00451"></a>00451 <span class="stringliteral">&quot;   :type size: int\n&quot;</span>
<a name="l00452"></a>00452 <span class="stringliteral">&quot;   :arg axis: a string in [&#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;] or a 3D Vector Object\n&quot;</span>
<a name="l00453"></a>00453 <span class="stringliteral">&quot;      (optional when size is 2).\n&quot;</span>
<a name="l00454"></a>00454 <span class="stringliteral">&quot;   :type axis: string or :class:`Vector`\n&quot;</span>
<a name="l00455"></a>00455 <span class="stringliteral">&quot;   :return: A new rotation matrix.\n&quot;</span>
<a name="l00456"></a>00456 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l00457"></a>00457 );
<a name="l00458"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7ab6550b331d52ee026916c7471f4ac4">00458</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7ab6550b331d52ee026916c7471f4ac4">C_Matrix_Rotation</a>(PyObject *cls, PyObject *args)
<a name="l00459"></a>00459 {
<a name="l00460"></a>00460     PyObject *vec = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00461"></a>00461     <span class="keyword">const</span> <span class="keywordtype">char</span> *axis = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00462"></a>00462     <span class="keywordtype">int</span> matSize;
<a name="l00463"></a>00463     <span class="keywordtype">double</span> <a class="code" href="../../d9/d42/btQuaternion_8h.html#a0dbf74d697e478378c0c48ef948cac37" title="Return the angle between two quaternions.">angle</a>; <span class="comment">/* use double because of precision problems at high values */</span>
<a name="l00464"></a>00464     <span class="keywordtype">float</span> mat[16] = {0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00465"></a>00465                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00466"></a>00466                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00467"></a>00467                      0.0f, 0.0f, 0.0f, 1.0f};
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     <span class="keywordflow">if</span> (!PyArg_ParseTuple(args, <span class="stringliteral">&quot;di|O:Matrix.Rotation&quot;</span>, &amp;angle, &amp;matSize, &amp;vec)) {
<a name="l00470"></a>00470         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="keywordflow">if</span> (vec &amp;&amp; PyUnicode_Check(vec)) {
<a name="l00474"></a>00474         axis = _PyUnicode_AsString((PyObject *)vec);
<a name="l00475"></a>00475         <span class="keywordflow">if</span> (axis == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || axis[0] == <span class="charliteral">&#39;\0&#39;</span> || axis[1] != <span class="charliteral">&#39;\0&#39;</span> || axis[0] &lt; <span class="charliteral">&#39;X&#39;</span> || axis[0] &gt; <span class="charliteral">&#39;Z&#39;</span>) {
<a name="l00476"></a>00476             PyErr_SetString(PyExc_ValueError,
<a name="l00477"></a>00477                             <span class="stringliteral">&quot;Matrix.Rotation(): &quot;</span>
<a name="l00478"></a>00478                             <span class="stringliteral">&quot;3rd argument axis value must be a 3D vector &quot;</span>
<a name="l00479"></a>00479                             <span class="stringliteral">&quot;or a string in &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;&quot;</span>);
<a name="l00480"></a>00480             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00481"></a>00481         }
<a name="l00482"></a>00482         <span class="keywordflow">else</span> {
<a name="l00483"></a>00483             <span class="comment">/* use the string */</span>
<a name="l00484"></a>00484             vec = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00485"></a>00485         }
<a name="l00486"></a>00486     }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488     angle = <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ad7f64ab2e0be23226666ed15b9304390">angle_wrap_rad</a>(angle);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490     <span class="keywordflow">if</span> (matSize != 2 &amp;&amp; matSize != 3 &amp;&amp; matSize != 4) {
<a name="l00491"></a>00491         PyErr_SetString(PyExc_ValueError,
<a name="l00492"></a>00492                         <span class="stringliteral">&quot;Matrix.Rotation(): &quot;</span>
<a name="l00493"></a>00493                         <span class="stringliteral">&quot;can only return a 2x2 3x3 or 4x4 matrix&quot;</span>);
<a name="l00494"></a>00494         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00495"></a>00495     }
<a name="l00496"></a>00496     <span class="keywordflow">if</span> (matSize == 2 &amp;&amp; (vec != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {
<a name="l00497"></a>00497         PyErr_SetString(PyExc_ValueError,
<a name="l00498"></a>00498                         <span class="stringliteral">&quot;Matrix.Rotation(): &quot;</span>
<a name="l00499"></a>00499                         <span class="stringliteral">&quot;cannot create a 2x2 rotation matrix around arbitrary axis&quot;</span>);
<a name="l00500"></a>00500         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502     <span class="keywordflow">if</span> ((matSize == 3 || matSize == 4) &amp;&amp; (axis == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (vec == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {
<a name="l00503"></a>00503         PyErr_SetString(PyExc_ValueError,
<a name="l00504"></a>00504                         <span class="stringliteral">&quot;Matrix.Rotation(): &quot;</span>
<a name="l00505"></a>00505                         <span class="stringliteral">&quot;axis of rotation for 3d and 4d matrices is required&quot;</span>);
<a name="l00506"></a>00506         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="comment">/* check for valid vector/axis above */</span>
<a name="l00510"></a>00510     <span class="keywordflow">if</span> (vec) {
<a name="l00511"></a>00511         <span class="keywordtype">float</span> tvec[3];
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(tvec, 3, 3, vec, <span class="stringliteral">&quot;Matrix.Rotation(angle, size, axis), invalid &#39;axis&#39; arg&quot;</span>) == -1)
<a name="l00514"></a>00514             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#aa804c4cef742fd7a1dd820bf0128ad4a">axis_angle_to_mat3</a>((<span class="keywordtype">float</span> (*)[3])mat, tvec, angle);
<a name="l00517"></a>00517     }
<a name="l00518"></a>00518     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matSize == 2) {
<a name="l00519"></a>00519         <span class="keyword">const</span> <span class="keywordtype">float</span> angle_cos = <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a2503b77b52ff481a3507a596ae1f3938">cosf</a>(angle);
<a name="l00520"></a>00520         <span class="keyword">const</span> <span class="keywordtype">float</span> angle_sin = <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a1a55e3226c270625a4bff1befa977638">sinf</a>(angle);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522         <span class="comment">//2D rotation matrix</span>
<a name="l00523"></a>00523         mat[0] =  angle_cos;
<a name="l00524"></a>00524         mat[1] =  angle_sin;
<a name="l00525"></a>00525         mat[2] = -angle_sin;
<a name="l00526"></a>00526         mat[3] =  angle_cos;
<a name="l00527"></a>00527     }
<a name="l00528"></a>00528     <span class="keywordflow">else</span> {
<a name="l00529"></a>00529         <span class="comment">/* valid axis checked above */</span>
<a name="l00530"></a>00530         <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ac8ca0d66473b77e8abe94b5de00db361">single_axis_angle_to_mat3</a>((<span class="keywordtype">float</span> (*)[3])mat, axis[0], angle);
<a name="l00531"></a>00531     }
<a name="l00532"></a>00532 
<a name="l00533"></a>00533     <span class="keywordflow">if</span> (matSize == 4) {
<a name="l00534"></a>00534         <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9340d3b71dd1d530f6baba271b4af22c">matrix_3x3_as_4x4</a>(mat);
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536     <span class="comment">//pass to matrix creation</span>
<a name="l00537"></a>00537     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, matSize, matSize, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, (PyTypeObject *)cls);
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(C_Matrix_Translation_doc,
<a name="l00542"></a>00542 <span class="stringliteral">&quot;.. classmethod:: Translation(vector)\n&quot;</span>
<a name="l00543"></a>00543 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00544"></a>00544 <span class="stringliteral">&quot;   Create a matrix representing a translation.\n&quot;</span>
<a name="l00545"></a>00545 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00546"></a>00546 <span class="stringliteral">&quot;   :arg vector: The translation vector.\n&quot;</span>
<a name="l00547"></a>00547 <span class="stringliteral">&quot;   :type vector: :class:`Vector`\n&quot;</span>
<a name="l00548"></a>00548 <span class="stringliteral">&quot;   :return: An identity matrix with a translation.\n&quot;</span>
<a name="l00549"></a>00549 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l00550"></a>00550 );
<a name="l00551"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a774ff5eebcff5a146c15edb7c8fdbdc1">00551</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a774ff5eebcff5a146c15edb7c8fdbdc1">C_Matrix_Translation</a>(PyObject *cls, PyObject *value)
<a name="l00552"></a>00552 {
<a name="l00553"></a>00553     <span class="keywordtype">float</span> mat[4][4] = <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a0e2ef61ffa876947da5d7dfb15d79230">MAT4_UNITY</a>;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(mat[3], 3, 4, value, <span class="stringliteral">&quot;mathutils.Matrix.Translation(vector), invalid vector arg&quot;</span>) == -1)
<a name="l00556"></a>00556         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(&amp;mat[0][0], 4, 4, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, (PyTypeObject *)cls);
<a name="l00559"></a>00559 }
<a name="l00560"></a>00560 <span class="comment">//----------------------------------mathutils.Matrix.Scale() -------------</span>
<a name="l00561"></a>00561 <span class="comment">//mat is a 1D array of floats - row[0][0], row[0][1], row[1][0], etc.</span>
<a name="l00562"></a>00562 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(C_Matrix_Scale_doc,
<a name="l00563"></a>00563 <span class="stringliteral">&quot;.. classmethod:: Scale(factor, size, axis)\n&quot;</span>
<a name="l00564"></a>00564 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00565"></a>00565 <span class="stringliteral">&quot;   Create a matrix representing a scaling.\n&quot;</span>
<a name="l00566"></a>00566 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00567"></a>00567 <span class="stringliteral">&quot;   :arg factor: The factor of scaling to apply.\n&quot;</span>
<a name="l00568"></a>00568 <span class="stringliteral">&quot;   :type factor: float\n&quot;</span>
<a name="l00569"></a>00569 <span class="stringliteral">&quot;   :arg size: The size of the scale matrix to construct [2, 4].\n&quot;</span>
<a name="l00570"></a>00570 <span class="stringliteral">&quot;   :type size: int\n&quot;</span>
<a name="l00571"></a>00571 <span class="stringliteral">&quot;   :arg axis: Direction to influence scale. (optional).\n&quot;</span>
<a name="l00572"></a>00572 <span class="stringliteral">&quot;   :type axis: :class:`Vector`\n&quot;</span>
<a name="l00573"></a>00573 <span class="stringliteral">&quot;   :return: A new scale matrix.\n&quot;</span>
<a name="l00574"></a>00574 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l00575"></a>00575 );
<a name="l00576"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a81d72c1957c32d1e3a4218f9af709d49">00576</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a81d72c1957c32d1e3a4218f9af709d49">C_Matrix_Scale</a>(PyObject *cls, PyObject *args)
<a name="l00577"></a>00577 {
<a name="l00578"></a>00578     PyObject *vec = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00579"></a>00579     <span class="keywordtype">int</span> vec_size;
<a name="l00580"></a>00580     <span class="keywordtype">float</span> tvec[3];
<a name="l00581"></a>00581     <span class="keywordtype">float</span> factor;
<a name="l00582"></a>00582     <span class="keywordtype">int</span> matSize;
<a name="l00583"></a>00583     <span class="keywordtype">float</span> mat[16] = {0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00584"></a>00584                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00585"></a>00585                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00586"></a>00586                      0.0f, 0.0f, 0.0f, 1.0f};
<a name="l00587"></a>00587 
<a name="l00588"></a>00588     <span class="keywordflow">if</span> (!PyArg_ParseTuple(args, <span class="stringliteral">&quot;fi|O:Matrix.Scale&quot;</span>, &amp;factor, &amp;matSize, &amp;vec)) {
<a name="l00589"></a>00589         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591     <span class="keywordflow">if</span> (matSize != 2 &amp;&amp; matSize != 3 &amp;&amp; matSize != 4) {
<a name="l00592"></a>00592         PyErr_SetString(PyExc_ValueError,
<a name="l00593"></a>00593                         <span class="stringliteral">&quot;Matrix.Scale(): &quot;</span>
<a name="l00594"></a>00594                         <span class="stringliteral">&quot;can only return a 2x2 3x3 or 4x4 matrix&quot;</span>);
<a name="l00595"></a>00595         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00596"></a>00596     }
<a name="l00597"></a>00597     <span class="keywordflow">if</span> (vec) {
<a name="l00598"></a>00598         vec_size = (matSize == 2 ? 2 : 3);
<a name="l00599"></a>00599         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(tvec, vec_size, vec_size, vec,
<a name="l00600"></a>00600                                   <span class="stringliteral">&quot;Matrix.Scale(factor, size, axis), invalid &#39;axis&#39; arg&quot;</span>) == -1)
<a name="l00601"></a>00601         {
<a name="l00602"></a>00602             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605     <span class="keywordflow">if</span> (vec == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {  <span class="comment">//scaling along axis</span>
<a name="l00606"></a>00606         <span class="keywordflow">if</span> (matSize == 2) {
<a name="l00607"></a>00607             mat[0] = factor;
<a name="l00608"></a>00608             mat[3] = factor;
<a name="l00609"></a>00609         }
<a name="l00610"></a>00610         <span class="keywordflow">else</span> {
<a name="l00611"></a>00611             mat[0] = factor;
<a name="l00612"></a>00612             mat[4] = factor;
<a name="l00613"></a>00613             mat[8] = factor;
<a name="l00614"></a>00614         }
<a name="l00615"></a>00615     }
<a name="l00616"></a>00616     <span class="keywordflow">else</span> {
<a name="l00617"></a>00617         <span class="comment">/* scaling in arbitrary direction</span>
<a name="l00618"></a>00618 <span class="comment">         * normalize arbitrary axis */</span>
<a name="l00619"></a>00619         <span class="keywordtype">float</span> <a class="code" href="../../d1/d8e/ntl__vector3dim_8h.html#a828f653994f3f04fe2a539bc1ed64590">norm</a> = 0.0f;
<a name="l00620"></a>00620         <span class="keywordtype">int</span> x;
<a name="l00621"></a>00621         <span class="keywordflow">for</span> (x = 0; x &lt; vec_size; x++) {
<a name="l00622"></a>00622             norm += tvec[x] * tvec[x];
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624         norm = (float) <a class="code" href="../../d7/d47/NM__Scalar_8h.html#aa3fc8738e36a262f694814c04e8ef744">sqrt</a>(norm);
<a name="l00625"></a>00625         <span class="keywordflow">for</span> (x = 0; x &lt; vec_size; x++) {
<a name="l00626"></a>00626             tvec[x] /= <a class="code" href="../../d1/d8e/ntl__vector3dim_8h.html#a828f653994f3f04fe2a539bc1ed64590">norm</a>;
<a name="l00627"></a>00627         }
<a name="l00628"></a>00628         <span class="keywordflow">if</span> (matSize == 2) {
<a name="l00629"></a>00629             mat[0] = 1 + ((factor - 1) * (tvec[0] * tvec[0]));
<a name="l00630"></a>00630             mat[1] =     ((factor - 1) * (tvec[0] * tvec[1]));
<a name="l00631"></a>00631             mat[2] =     ((factor - 1) * (tvec[0] * tvec[1]));
<a name="l00632"></a>00632             mat[3] = 1 + ((factor - 1) * (tvec[1] * tvec[1]));
<a name="l00633"></a>00633         }
<a name="l00634"></a>00634         <span class="keywordflow">else</span> {
<a name="l00635"></a>00635             mat[0] = 1 + ((factor - 1) * (tvec[0] * tvec[0]));
<a name="l00636"></a>00636             mat[1] =     ((factor - 1) * (tvec[0] * tvec[1]));
<a name="l00637"></a>00637             mat[2] =     ((factor - 1) * (tvec[0] * tvec[2]));
<a name="l00638"></a>00638             mat[3] =     ((factor - 1) * (tvec[0] * tvec[1]));
<a name="l00639"></a>00639             mat[4] = 1 + ((factor - 1) * (tvec[1] * tvec[1]));
<a name="l00640"></a>00640             mat[5] =     ((factor - 1) * (tvec[1] * tvec[2]));
<a name="l00641"></a>00641             mat[6] =     ((factor - 1) * (tvec[0] * tvec[2]));
<a name="l00642"></a>00642             mat[7] =     ((factor - 1) * (tvec[1] * tvec[2]));
<a name="l00643"></a>00643             mat[8] = 1 + ((factor - 1) * (tvec[2] * tvec[2]));
<a name="l00644"></a>00644         }
<a name="l00645"></a>00645     }
<a name="l00646"></a>00646     <span class="keywordflow">if</span> (matSize == 4) {
<a name="l00647"></a>00647         <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9340d3b71dd1d530f6baba271b4af22c">matrix_3x3_as_4x4</a>(mat);
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649     <span class="comment">//pass to matrix creation</span>
<a name="l00650"></a>00650     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, matSize, matSize, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, (PyTypeObject *)cls);
<a name="l00651"></a>00651 }
<a name="l00652"></a>00652 <span class="comment">//----------------------------------mathutils.Matrix.OrthoProjection() ---</span>
<a name="l00653"></a>00653 <span class="comment">//mat is a 1D array of floats - row[0][0], row[0][1], row[1][0], etc.</span>
<a name="l00654"></a>00654 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(C_Matrix_OrthoProjection_doc,
<a name="l00655"></a>00655 <span class="stringliteral">&quot;.. classmethod:: OrthoProjection(axis, size)\n&quot;</span>
<a name="l00656"></a>00656 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00657"></a>00657 <span class="stringliteral">&quot;   Create a matrix to represent an orthographic projection.\n&quot;</span>
<a name="l00658"></a>00658 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00659"></a>00659 <span class="stringliteral">&quot;   :arg axis: Can be any of the following: [&#39;X&#39;, &#39;Y&#39;, &#39;XY&#39;, &#39;XZ&#39;, &#39;YZ&#39;],\n&quot;</span>
<a name="l00660"></a>00660 <span class="stringliteral">&quot;      where a single axis is for a 2D matrix.\n&quot;</span>
<a name="l00661"></a>00661 <span class="stringliteral">&quot;      Or a vector for an arbitrary axis\n&quot;</span>
<a name="l00662"></a>00662 <span class="stringliteral">&quot;   :type axis: string or :class:`Vector`\n&quot;</span>
<a name="l00663"></a>00663 <span class="stringliteral">&quot;   :arg size: The size of the projection matrix to construct [2, 4].\n&quot;</span>
<a name="l00664"></a>00664 <span class="stringliteral">&quot;   :type size: int\n&quot;</span>
<a name="l00665"></a>00665 <span class="stringliteral">&quot;   :return: A new projection matrix.\n&quot;</span>
<a name="l00666"></a>00666 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l00667"></a>00667 );
<a name="l00668"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1aa206544425bf15feb96a733dcfcd2e">00668</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1aa206544425bf15feb96a733dcfcd2e">C_Matrix_OrthoProjection</a>(PyObject *cls, PyObject *args)
<a name="l00669"></a>00669 {
<a name="l00670"></a>00670     PyObject *axis;
<a name="l00671"></a>00671 
<a name="l00672"></a>00672     <span class="keywordtype">int</span> matSize, x;
<a name="l00673"></a>00673     <span class="keywordtype">float</span> <a class="code" href="../../d1/d8e/ntl__vector3dim_8h.html#a828f653994f3f04fe2a539bc1ed64590">norm</a> = 0.0f;
<a name="l00674"></a>00674     <span class="keywordtype">float</span> mat[16] = {0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00675"></a>00675                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00676"></a>00676                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00677"></a>00677                      0.0f, 0.0f, 0.0f, 1.0f};
<a name="l00678"></a>00678 
<a name="l00679"></a>00679     <span class="keywordflow">if</span> (!PyArg_ParseTuple(args, <span class="stringliteral">&quot;Oi:Matrix.OrthoProjection&quot;</span>, &amp;axis, &amp;matSize)) {
<a name="l00680"></a>00680         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00681"></a>00681     }
<a name="l00682"></a>00682     <span class="keywordflow">if</span> (matSize != 2 &amp;&amp; matSize != 3 &amp;&amp; matSize != 4) {
<a name="l00683"></a>00683         PyErr_SetString(PyExc_ValueError,
<a name="l00684"></a>00684                         <span class="stringliteral">&quot;Matrix.OrthoProjection(): &quot;</span>
<a name="l00685"></a>00685                         <span class="stringliteral">&quot;can only return a 2x2 3x3 or 4x4 matrix&quot;</span>);
<a name="l00686"></a>00686         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689     <span class="keywordflow">if</span> (PyUnicode_Check(axis)) {    <span class="comment">//ortho projection onto cardinal plane</span>
<a name="l00690"></a>00690         Py_ssize_t plane_len;
<a name="l00691"></a>00691         <span class="keyword">const</span> <span class="keywordtype">char</span> *plane = _PyUnicode_AsStringAndSize(axis, &amp;plane_len);
<a name="l00692"></a>00692         <span class="keywordflow">if</span> (matSize == 2) {
<a name="l00693"></a>00693             <span class="keywordflow">if</span> (plane_len == 1 &amp;&amp; plane[0] == <span class="charliteral">&#39;X&#39;</span>) {
<a name="l00694"></a>00694                 mat[0] = 1.0f;
<a name="l00695"></a>00695             }
<a name="l00696"></a>00696             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plane_len == 1 &amp;&amp; plane[0] == <span class="charliteral">&#39;Y&#39;</span>) {
<a name="l00697"></a>00697                 mat[3] = 1.0f;
<a name="l00698"></a>00698             }
<a name="l00699"></a>00699             <span class="keywordflow">else</span> {
<a name="l00700"></a>00700                 PyErr_Format(PyExc_ValueError,
<a name="l00701"></a>00701                              <span class="stringliteral">&quot;Matrix.OrthoProjection(): &quot;</span>
<a name="l00702"></a>00702                              <span class="stringliteral">&quot;unknown plane, expected: X, Y, not &#39;%.200s&#39;&quot;</span>,
<a name="l00703"></a>00703                              plane);
<a name="l00704"></a>00704                 <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00705"></a>00705             }
<a name="l00706"></a>00706         }
<a name="l00707"></a>00707         <span class="keywordflow">else</span> {
<a name="l00708"></a>00708             <span class="keywordflow">if</span> (plane_len == 2 &amp;&amp; plane[0] == <span class="charliteral">&#39;X&#39;</span> &amp;&amp; plane[1] == <span class="charliteral">&#39;Y&#39;</span>) {
<a name="l00709"></a>00709                 mat[0] = 1.0f;
<a name="l00710"></a>00710                 mat[4] = 1.0f;
<a name="l00711"></a>00711             }
<a name="l00712"></a>00712             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plane_len == 2 &amp;&amp; plane[0] == <span class="charliteral">&#39;X&#39;</span> &amp;&amp; plane[1] == <span class="charliteral">&#39;Z&#39;</span>) {
<a name="l00713"></a>00713                 mat[0] = 1.0f;
<a name="l00714"></a>00714                 mat[8] = 1.0f;
<a name="l00715"></a>00715             }
<a name="l00716"></a>00716             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plane_len == 2 &amp;&amp; plane[0] == <span class="charliteral">&#39;Y&#39;</span> &amp;&amp; plane[1] == <span class="charliteral">&#39;Z&#39;</span>) {
<a name="l00717"></a>00717                 mat[4] = 1.0f;
<a name="l00718"></a>00718                 mat[8] = 1.0f;
<a name="l00719"></a>00719             }
<a name="l00720"></a>00720             <span class="keywordflow">else</span> {
<a name="l00721"></a>00721                 PyErr_Format(PyExc_ValueError,
<a name="l00722"></a>00722                              <span class="stringliteral">&quot;Matrix.OrthoProjection(): &quot;</span>
<a name="l00723"></a>00723                              <span class="stringliteral">&quot;unknown plane, expected: XY, XZ, YZ, not &#39;%.200s&#39;&quot;</span>,
<a name="l00724"></a>00724                              plane);
<a name="l00725"></a>00725                 <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00726"></a>00726             }
<a name="l00727"></a>00727         }
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729     <span class="keywordflow">else</span> {
<a name="l00730"></a>00730         <span class="comment">//arbitrary plane</span>
<a name="l00731"></a>00731 
<a name="l00732"></a>00732         <span class="keywordtype">int</span> vec_size = (matSize == 2 ? 2 : 3);
<a name="l00733"></a>00733         <span class="keywordtype">float</span> tvec[4];
<a name="l00734"></a>00734 
<a name="l00735"></a>00735         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(tvec, vec_size, vec_size, axis,
<a name="l00736"></a>00736                                   <span class="stringliteral">&quot;Matrix.OrthoProjection(axis, size), invalid &#39;axis&#39; arg&quot;</span>) == -1)
<a name="l00737"></a>00737         {
<a name="l00738"></a>00738             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00739"></a>00739         }
<a name="l00740"></a>00740 
<a name="l00741"></a>00741         <span class="comment">//normalize arbitrary axis</span>
<a name="l00742"></a>00742         <span class="keywordflow">for</span> (x = 0; x &lt; vec_size; x++) {
<a name="l00743"></a>00743             norm += tvec[x] * tvec[x];
<a name="l00744"></a>00744         }
<a name="l00745"></a>00745         norm = (float) <a class="code" href="../../d7/d47/NM__Scalar_8h.html#aa3fc8738e36a262f694814c04e8ef744">sqrt</a>(norm);
<a name="l00746"></a>00746         <span class="keywordflow">for</span> (x = 0; x &lt; vec_size; x++) {
<a name="l00747"></a>00747             tvec[x] /= <a class="code" href="../../d1/d8e/ntl__vector3dim_8h.html#a828f653994f3f04fe2a539bc1ed64590">norm</a>;
<a name="l00748"></a>00748         }
<a name="l00749"></a>00749         <span class="keywordflow">if</span> (matSize == 2) {
<a name="l00750"></a>00750             mat[0] = 1 - (tvec[0] * tvec[0]);
<a name="l00751"></a>00751             mat[1] =   - (tvec[0] * tvec[1]);
<a name="l00752"></a>00752             mat[2] =   - (tvec[0] * tvec[1]);
<a name="l00753"></a>00753             mat[3] = 1 - (tvec[1] * tvec[1]);
<a name="l00754"></a>00754         }
<a name="l00755"></a>00755         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matSize &gt; 2) {
<a name="l00756"></a>00756             mat[0] = 1 - (tvec[0] * tvec[0]);
<a name="l00757"></a>00757             mat[1] =   - (tvec[0] * tvec[1]);
<a name="l00758"></a>00758             mat[2] =   - (tvec[0] * tvec[2]);
<a name="l00759"></a>00759             mat[3] =   - (tvec[0] * tvec[1]);
<a name="l00760"></a>00760             mat[4] = 1 - (tvec[1] * tvec[1]);
<a name="l00761"></a>00761             mat[5] =   - (tvec[1] * tvec[2]);
<a name="l00762"></a>00762             mat[6] =   - (tvec[0] * tvec[2]);
<a name="l00763"></a>00763             mat[7] =   - (tvec[1] * tvec[2]);
<a name="l00764"></a>00764             mat[8] = 1 - (tvec[2] * tvec[2]);
<a name="l00765"></a>00765         }
<a name="l00766"></a>00766     }
<a name="l00767"></a>00767     <span class="keywordflow">if</span> (matSize == 4) {
<a name="l00768"></a>00768         <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9340d3b71dd1d530f6baba271b4af22c">matrix_3x3_as_4x4</a>(mat);
<a name="l00769"></a>00769     }
<a name="l00770"></a>00770     <span class="comment">//pass to matrix creation</span>
<a name="l00771"></a>00771     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, matSize, matSize, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, (PyTypeObject *)cls);
<a name="l00772"></a>00772 }
<a name="l00773"></a>00773 
<a name="l00774"></a>00774 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(C_Matrix_Shear_doc,
<a name="l00775"></a>00775 <span class="stringliteral">&quot;.. classmethod:: Shear(plane, size, factor)\n&quot;</span>
<a name="l00776"></a>00776 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00777"></a>00777 <span class="stringliteral">&quot;   Create a matrix to represent an shear transformation.\n&quot;</span>
<a name="l00778"></a>00778 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00779"></a>00779 <span class="stringliteral">&quot;   :arg plane: Can be any of the following: [&#39;X&#39;, &#39;Y&#39;, &#39;XY&#39;, &#39;XZ&#39;, &#39;YZ&#39;],\n&quot;</span>
<a name="l00780"></a>00780 <span class="stringliteral">&quot;      where a single axis is for a 2D matrix only.\n&quot;</span>
<a name="l00781"></a>00781 <span class="stringliteral">&quot;   :type plane: string\n&quot;</span>
<a name="l00782"></a>00782 <span class="stringliteral">&quot;   :arg size: The size of the shear matrix to construct [2, 4].\n&quot;</span>
<a name="l00783"></a>00783 <span class="stringliteral">&quot;   :type size: int\n&quot;</span>
<a name="l00784"></a>00784 <span class="stringliteral">&quot;   :arg factor: The factor of shear to apply. For a 3 or 4 *size* matrix\n&quot;</span>
<a name="l00785"></a>00785 <span class="stringliteral">&quot;      pass a pair of floats corresponding with the *plane* axis.\n&quot;</span>
<a name="l00786"></a>00786 <span class="stringliteral">&quot;   :type factor: float or float pair\n&quot;</span>
<a name="l00787"></a>00787 <span class="stringliteral">&quot;   :return: A new shear matrix.\n&quot;</span>
<a name="l00788"></a>00788 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l00789"></a>00789 );
<a name="l00790"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad4e18a16965e3e503bbe11f5c1b48728">00790</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad4e18a16965e3e503bbe11f5c1b48728">C_Matrix_Shear</a>(PyObject *cls, PyObject *args)
<a name="l00791"></a>00791 {
<a name="l00792"></a>00792     <span class="keywordtype">int</span> matSize;
<a name="l00793"></a>00793     <span class="keyword">const</span> <span class="keywordtype">char</span> *plane;
<a name="l00794"></a>00794     PyObject *fac;
<a name="l00795"></a>00795     <span class="keywordtype">float</span> mat[16] = {0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00796"></a>00796                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00797"></a>00797                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l00798"></a>00798                      0.0f, 0.0f, 0.0f, 1.0f};
<a name="l00799"></a>00799 
<a name="l00800"></a>00800     <span class="keywordflow">if</span> (!PyArg_ParseTuple(args, <span class="stringliteral">&quot;siO:Matrix.Shear&quot;</span>, &amp;plane, &amp;matSize, &amp;fac)) {
<a name="l00801"></a>00801         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00802"></a>00802     }
<a name="l00803"></a>00803     <span class="keywordflow">if</span> (matSize != 2 &amp;&amp; matSize != 3 &amp;&amp; matSize != 4) {
<a name="l00804"></a>00804         PyErr_SetString(PyExc_ValueError,
<a name="l00805"></a>00805                         <span class="stringliteral">&quot;Matrix.Shear(): &quot;</span>
<a name="l00806"></a>00806                         <span class="stringliteral">&quot;can only return a 2x2 3x3 or 4x4 matrix&quot;</span>);
<a name="l00807"></a>00807         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00808"></a>00808     }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810     <span class="keywordflow">if</span> (matSize == 2) {
<a name="l00811"></a>00811         <span class="keywordtype">float</span> <span class="keyword">const</span> factor = PyFloat_AsDouble(fac);
<a name="l00812"></a>00812 
<a name="l00813"></a>00813         <span class="keywordflow">if</span> (factor == -1.0f &amp;&amp; PyErr_Occurred()) {
<a name="l00814"></a>00814             PyErr_SetString(PyExc_TypeError,
<a name="l00815"></a>00815                             <span class="stringliteral">&quot;Matrix.Shear(): &quot;</span>
<a name="l00816"></a>00816                             <span class="stringliteral">&quot;the factor to be a float&quot;</span>);
<a name="l00817"></a>00817             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00818"></a>00818         }
<a name="l00819"></a>00819 
<a name="l00820"></a>00820         <span class="comment">/* unit */</span>
<a name="l00821"></a>00821         mat[0] = 1.0f;
<a name="l00822"></a>00822         mat[3] = 1.0f;
<a name="l00823"></a>00823 
<a name="l00824"></a>00824         <span class="keywordflow">if</span> (strcmp(plane, <span class="stringliteral">&quot;X&quot;</span>) == 0) {
<a name="l00825"></a>00825             mat[2] = factor;
<a name="l00826"></a>00826         }
<a name="l00827"></a>00827         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(plane, <span class="stringliteral">&quot;Y&quot;</span>) == 0) {
<a name="l00828"></a>00828             mat[1] = factor;
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830         <span class="keywordflow">else</span> {
<a name="l00831"></a>00831             PyErr_SetString(PyExc_ValueError,
<a name="l00832"></a>00832                             <span class="stringliteral">&quot;Matrix.Shear(): &quot;</span>
<a name="l00833"></a>00833                             <span class="stringliteral">&quot;expected: X, Y or wrong matrix size for shearing plane&quot;</span>);
<a name="l00834"></a>00834             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00835"></a>00835         }
<a name="l00836"></a>00836     }
<a name="l00837"></a>00837     <span class="keywordflow">else</span> {
<a name="l00838"></a>00838         <span class="comment">/* 3 or 4, apply as 3x3, resize later if needed */</span>
<a name="l00839"></a>00839         <span class="keywordtype">float</span> factor[2];
<a name="l00840"></a>00840 
<a name="l00841"></a>00841         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(factor, 2, 2, fac, <span class="stringliteral">&quot;Matrix.Shear()&quot;</span>) &lt; 0) {
<a name="l00842"></a>00842             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00843"></a>00843         }
<a name="l00844"></a>00844 
<a name="l00845"></a>00845         <span class="comment">/* unit */</span>
<a name="l00846"></a>00846         mat[0] = 1.0f;
<a name="l00847"></a>00847         mat[4] = 1.0f;
<a name="l00848"></a>00848         mat[8] = 1.0f;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850         <span class="keywordflow">if</span> (strcmp(plane, <span class="stringliteral">&quot;XY&quot;</span>) == 0) {
<a name="l00851"></a>00851             mat[6] = factor[0];
<a name="l00852"></a>00852             mat[7] = factor[1];
<a name="l00853"></a>00853         }
<a name="l00854"></a>00854         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(plane, <span class="stringliteral">&quot;XZ&quot;</span>) == 0) {
<a name="l00855"></a>00855             mat[3] = factor[0];
<a name="l00856"></a>00856             mat[5] = factor[1];
<a name="l00857"></a>00857         }
<a name="l00858"></a>00858         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(plane, <span class="stringliteral">&quot;YZ&quot;</span>) == 0) {
<a name="l00859"></a>00859             mat[1] = factor[0];
<a name="l00860"></a>00860             mat[2] = factor[1];
<a name="l00861"></a>00861         }
<a name="l00862"></a>00862         <span class="keywordflow">else</span> {
<a name="l00863"></a>00863             PyErr_SetString(PyExc_ValueError,
<a name="l00864"></a>00864                             <span class="stringliteral">&quot;Matrix.Shear(): &quot;</span>
<a name="l00865"></a>00865                             <span class="stringliteral">&quot;expected: X, Y, XY, XZ, YZ&quot;</span>);
<a name="l00866"></a>00866             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00867"></a>00867         }
<a name="l00868"></a>00868     }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870     <span class="keywordflow">if</span> (matSize == 4) {
<a name="l00871"></a>00871         <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9340d3b71dd1d530f6baba271b4af22c">matrix_3x3_as_4x4</a>(mat);
<a name="l00872"></a>00872     }
<a name="l00873"></a>00873     <span class="comment">//pass to matrix creation</span>
<a name="l00874"></a>00874     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, matSize, matSize, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, (PyTypeObject *)cls);
<a name="l00875"></a>00875 }
<a name="l00876"></a>00876 
<a name="l00877"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a8b433695865df09a00df205c0b1fc18c">00877</a> <span class="keywordtype">void</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8b433695865df09a00df205c0b1fc18c">matrix_as_3x3</a>(<span class="keywordtype">float</span> mat[3][3], <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l00878"></a>00878 {
<a name="l00879"></a>00879     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(mat[0], <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a432cc799e2d059e825c25da73ae0a1ff">MATRIX_COL_PTR</a>(<span class="keyword">self</span>, 0));
<a name="l00880"></a>00880     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(mat[1], <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a432cc799e2d059e825c25da73ae0a1ff">MATRIX_COL_PTR</a>(<span class="keyword">self</span>, 1));
<a name="l00881"></a>00881     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(mat[2], <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a432cc799e2d059e825c25da73ae0a1ff">MATRIX_COL_PTR</a>(<span class="keyword">self</span>, 2));
<a name="l00882"></a>00882 }
<a name="l00883"></a>00883 
<a name="l00884"></a>00884 <span class="comment">/* assumes rowsize == colsize is checked and the read callback has run */</span>
<a name="l00885"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac03fba9181b056c6ae837bc402914b1c">00885</a> <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac03fba9181b056c6ae837bc402914b1c">matrix_determinant_internal</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l00886"></a>00886 {
<a name="l00887"></a>00887     <span class="keywordflow">if</span> (self-&gt;num_col == 2) {
<a name="l00888"></a>00888         <span class="keywordflow">return</span> <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a7e80fad5b956112ebebdd303ace4392a">determinant_m2</a>(<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 0), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 1),
<a name="l00889"></a>00889                               <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 0), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 1));
<a name="l00890"></a>00890     }
<a name="l00891"></a>00891     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_col == 3) {
<a name="l00892"></a>00892         <span class="keywordflow">return</span> <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#afef4172206f4b9cdaa9f27f68fe67527">determinant_m3</a>(<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 0), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 1), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 2),
<a name="l00893"></a>00893                               <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 0), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 1), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 2),
<a name="l00894"></a>00894                               <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 2, 0), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 2, 1), <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 2, 2));
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896     <span class="keywordflow">else</span> {
<a name="l00897"></a>00897         <span class="keywordflow">return</span> <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#afab1cbe32ce9fbd4b66ad9b1cee818f8">determinant_m4</a>((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix);
<a name="l00898"></a>00898     }
<a name="l00899"></a>00899 }
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 
<a name="l00902"></a>00902 <span class="comment">/*-----------------------------METHODS----------------------------*/</span>
<a name="l00903"></a>00903 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_to_quaternion_doc,
<a name="l00904"></a>00904 <span class="stringliteral">&quot;.. method:: to_quaternion()\n&quot;</span>
<a name="l00905"></a>00905 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00906"></a>00906 <span class="stringliteral">&quot;   Return a quaternion representation of the rotation matrix.\n&quot;</span>
<a name="l00907"></a>00907 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00908"></a>00908 <span class="stringliteral">&quot;   :return: Quaternion representation of the rotation matrix.\n&quot;</span>
<a name="l00909"></a>00909 <span class="stringliteral">&quot;   :rtype: :class:`Quaternion`\n&quot;</span>
<a name="l00910"></a>00910 );
<a name="l00911"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4c2aae5ba72b2535a4c6c56187bbf802">00911</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4c2aae5ba72b2535a4c6c56187bbf802">Matrix_to_quaternion</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l00912"></a>00912 {
<a name="l00913"></a>00913     <span class="keywordtype">float</span> quat[4];
<a name="l00914"></a>00914 
<a name="l00915"></a>00915     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00916"></a>00916         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00917"></a>00917 
<a name="l00918"></a>00918     <span class="comment">/* must be 3-4 cols, 3-4 rows, square matrix */</span>
<a name="l00919"></a>00919     <span class="keywordflow">if</span> ((self-&gt;num_row &lt; 3) || (self-&gt;num_col &lt; 3) || (self-&gt;num_row != self-&gt;num_col)) {
<a name="l00920"></a>00920         PyErr_SetString(PyExc_ValueError,
<a name="l00921"></a>00921                         <span class="stringliteral">&quot;Matrix.to_quat(): &quot;</span>
<a name="l00922"></a>00922                         <span class="stringliteral">&quot;inappropriate matrix size - expects 3x3 or 4x4 matrix&quot;</span>);
<a name="l00923"></a>00923         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00924"></a>00924     }
<a name="l00925"></a>00925     <span class="keywordflow">if</span> (self-&gt;num_row == 3) {
<a name="l00926"></a>00926         <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a176f538ccb9db7cc95d7699264508b26">mat3_to_quat</a>(quat, (<span class="keywordtype">float</span> (*)[3])self-&gt;matrix);
<a name="l00927"></a>00927     }
<a name="l00928"></a>00928     <span class="keywordflow">else</span> {
<a name="l00929"></a>00929         <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ad76b90158227d13beb93cf29952f78a9">mat4_to_quat</a>(quat, (<span class="keywordtype">float</span> (*)[4])self-&gt;matrix);
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931 
<a name="l00932"></a>00932     <span class="keywordflow">return</span> <a class="code" href="../../dd/dc0/mathutils__Quaternion_8c.html#a6d34ec42c240f5b80bc1e9667142b49f">Quaternion_CreatePyObject</a>(quat, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00933"></a>00933 }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935 <span class="comment">/*---------------------------matrix.toEuler() --------------------*/</span>
<a name="l00936"></a>00936 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_to_euler_doc,
<a name="l00937"></a>00937 <span class="stringliteral">&quot;.. method:: to_euler(order, euler_compat)\n&quot;</span>
<a name="l00938"></a>00938 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00939"></a>00939 <span class="stringliteral">&quot;   Return an Euler representation of the rotation matrix\n&quot;</span>
<a name="l00940"></a>00940 <span class="stringliteral">&quot;   (3x3 or 4x4 matrix only).\n&quot;</span>
<a name="l00941"></a>00941 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00942"></a>00942 <span class="stringliteral">&quot;   :arg order: Optional rotation order argument in\n&quot;</span>
<a name="l00943"></a>00943 <span class="stringliteral">&quot;      [&#39;XYZ&#39;, &#39;XZY&#39;, &#39;YXZ&#39;, &#39;YZX&#39;, &#39;ZXY&#39;, &#39;ZYX&#39;].\n&quot;</span>
<a name="l00944"></a>00944 <span class="stringliteral">&quot;   :type order: string\n&quot;</span>
<a name="l00945"></a>00945 <span class="stringliteral">&quot;   :arg euler_compat: Optional euler argument the new euler will be made\n&quot;</span>
<a name="l00946"></a>00946 <span class="stringliteral">&quot;      compatible with (no axis flipping between them).\n&quot;</span>
<a name="l00947"></a>00947 <span class="stringliteral">&quot;      Useful for converting a series of matrices to animation curves.\n&quot;</span>
<a name="l00948"></a>00948 <span class="stringliteral">&quot;   :type euler_compat: :class:`Euler`\n&quot;</span>
<a name="l00949"></a>00949 <span class="stringliteral">&quot;   :return: Euler representation of the matrix.\n&quot;</span>
<a name="l00950"></a>00950 <span class="stringliteral">&quot;   :rtype: :class:`Euler`\n&quot;</span>
<a name="l00951"></a>00951 );
<a name="l00952"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a317c398f4050730a968bb4150a1d70ab">00952</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a317c398f4050730a968bb4150a1d70ab">Matrix_to_euler</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *args)
<a name="l00953"></a>00953 {
<a name="l00954"></a>00954     <span class="keyword">const</span> <span class="keywordtype">char</span> *order_str = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00955"></a>00955     <span class="keywordtype">short</span> order = <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a4aa95d9f8c95e703a90ba8afe1a3c4bda705c121bb02bd5d21f85f011560c1b76">EULER_ORDER_XYZ</a>;
<a name="l00956"></a>00956     <span class="keywordtype">float</span> eul[3], eul_compatf[3];
<a name="l00957"></a>00957     <a class="code" href="../../d4/d4d/structEulerObject.html">EulerObject</a> *eul_compat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00958"></a>00958 
<a name="l00959"></a>00959     <span class="keywordtype">float</span> tmat[3][3];
<a name="l00960"></a>00960     float (*mat)[3];
<a name="l00961"></a>00961 
<a name="l00962"></a>00962     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l00963"></a>00963         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00964"></a>00964 
<a name="l00965"></a>00965     <span class="keywordflow">if</span> (!PyArg_ParseTuple(args, <span class="stringliteral">&quot;|sO!:to_euler&quot;</span>, &amp;order_str, &amp;<a class="code" href="../../db/d6e/mathutils__Euler_8c.html#a7fb4ff4f8355873606f6ea7919bb4942">euler_Type</a>, &amp;eul_compat))
<a name="l00966"></a>00966         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00967"></a>00967 
<a name="l00968"></a>00968     <span class="keywordflow">if</span> (eul_compat) {
<a name="l00969"></a>00969         <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(eul_compat) == -1)
<a name="l00970"></a>00970             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00971"></a>00971 
<a name="l00972"></a>00972         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(eul_compatf, eul_compat-&gt;eul);
<a name="l00973"></a>00973     }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975     <span class="comment">/*must be 3-4 cols, 3-4 rows, square matrix */</span>
<a name="l00976"></a>00976     <span class="keywordflow">if</span> (self-&gt;num_row == 3 &amp;&amp; self-&gt;num_col == 3) {
<a name="l00977"></a>00977         mat = (float (*)[3])self-&gt;matrix;
<a name="l00978"></a>00978     }
<a name="l00979"></a>00979     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_row == 4 &amp;&amp; self-&gt;num_col == 4) {
<a name="l00980"></a>00980         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a36f8fd23b3f7785d0396ea7a93683d09">copy_m3_m4</a>(tmat, (<span class="keywordtype">float</span> (*)[4])self-&gt;matrix);
<a name="l00981"></a>00981         mat = tmat;
<a name="l00982"></a>00982     }
<a name="l00983"></a>00983     <span class="keywordflow">else</span> {
<a name="l00984"></a>00984         PyErr_SetString(PyExc_ValueError,
<a name="l00985"></a>00985                         <span class="stringliteral">&quot;Matrix.to_euler(): &quot;</span>
<a name="l00986"></a>00986                         <span class="stringliteral">&quot;inappropriate matrix size - expects 3x3 or 4x4 matrix&quot;</span>);
<a name="l00987"></a>00987         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00988"></a>00988     }
<a name="l00989"></a>00989 
<a name="l00990"></a>00990     <span class="keywordflow">if</span> (order_str) {
<a name="l00991"></a>00991         order = <a class="code" href="../../db/d6e/mathutils__Euler_8c.html#a3b0601917a784d71c22916018d9eb744">euler_order_from_string</a>(order_str, <span class="stringliteral">&quot;Matrix.to_euler()&quot;</span>);
<a name="l00992"></a>00992 
<a name="l00993"></a>00993         <span class="keywordflow">if</span> (order == -1)
<a name="l00994"></a>00994             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00995"></a>00995     }
<a name="l00996"></a>00996 
<a name="l00997"></a>00997     <span class="keywordflow">if</span> (eul_compat) {
<a name="l00998"></a>00998         <span class="keywordflow">if</span> (order == 1) <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a08e6387e69cccc46190fdb741e8c5375">mat3_to_compatible_eul</a>(eul, eul_compatf, mat);
<a name="l00999"></a>00999         <span class="keywordflow">else</span> <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#aecda43d4ff738267956af5f39ac70681">mat3_to_compatible_eulO</a>(eul, eul_compatf, order, mat);
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001     <span class="keywordflow">else</span> {
<a name="l01002"></a>01002         <span class="keywordflow">if</span> (order == 1) <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ac702d04b4ffc7a1c7b803181a88e42df">mat3_to_eul</a>(eul, mat);
<a name="l01003"></a>01003         <span class="keywordflow">else</span> <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a6e14075421e1717d96f46dbb3a30afed">mat3_to_eulO</a>(eul, order, mat);
<a name="l01004"></a>01004     }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006     <span class="keywordflow">return</span> <a class="code" href="../../db/d6e/mathutils__Euler_8c.html#a16221a89837a487319d51c7410d38f2d">Euler_CreatePyObject</a>(eul, order, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01007"></a>01007 }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_resize_4x4_doc,
<a name="l01010"></a>01010 <span class="stringliteral">&quot;.. method:: resize_4x4()\n&quot;</span>
<a name="l01011"></a>01011 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01012"></a>01012 <span class="stringliteral">&quot;   Resize the matrix to 4x4.\n&quot;</span>
<a name="l01013"></a>01013 );
<a name="l01014"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a24633adf095ccdd6b8f46148b4fbdffa">01014</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a24633adf095ccdd6b8f46148b4fbdffa">Matrix_resize_4x4</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01015"></a>01015 {
<a name="l01016"></a>01016     <span class="keywordtype">float</span> mat[4][4] = <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a0e2ef61ffa876947da5d7dfb15d79230">MAT4_UNITY</a>;
<a name="l01017"></a>01017     <span class="keywordtype">int</span> col;
<a name="l01018"></a>01018 
<a name="l01019"></a>01019     <span class="keywordflow">if</span> (self-&gt;wrapped == <a class="code" href="../../dc/d58/mathutils_8h.html#acffd6a14b48ba647f924482760261e3c">Py_WRAP</a>) {
<a name="l01020"></a>01020         PyErr_SetString(PyExc_TypeError,
<a name="l01021"></a>01021                         <span class="stringliteral">&quot;Matrix.resize_4x4(): &quot;</span>
<a name="l01022"></a>01022                         <span class="stringliteral">&quot;cannot resize wrapped data - make a copy and resize that&quot;</span>);
<a name="l01023"></a>01023         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01024"></a>01024     }
<a name="l01025"></a>01025     <span class="keywordflow">if</span> (self-&gt;cb_user) {
<a name="l01026"></a>01026         PyErr_SetString(PyExc_TypeError,
<a name="l01027"></a>01027                         <span class="stringliteral">&quot;Matrix.resize_4x4(): &quot;</span>
<a name="l01028"></a>01028                         <span class="stringliteral">&quot;cannot resize owned data - make a copy and resize that&quot;</span>);
<a name="l01029"></a>01029         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01030"></a>01030     }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032     <span class="keyword">self</span>-&gt;matrix = PyMem_Realloc(self-&gt;matrix, (<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * 16));
<a name="l01033"></a>01033     <span class="keywordflow">if</span> (self-&gt;matrix == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01034"></a>01034         PyErr_SetString(PyExc_MemoryError,
<a name="l01035"></a>01035                         <span class="stringliteral">&quot;Matrix.resize_4x4(): &quot;</span>
<a name="l01036"></a>01036                         <span class="stringliteral">&quot;problem allocating pointer space&quot;</span>);
<a name="l01037"></a>01037         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01038"></a>01038     }
<a name="l01039"></a>01039 
<a name="l01040"></a>01040     <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l01041"></a>01041         memcpy(mat[col], <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a432cc799e2d059e825c25da73ae0a1ff">MATRIX_COL_PTR</a>(<span class="keyword">self</span>, col), self-&gt;num_row * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l01042"></a>01042     }
<a name="l01043"></a>01043 
<a name="l01044"></a>01044     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a54d4323b3d706eb2ad167e9551ba4414">copy_m4_m4</a>((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix, (float (*)[4])mat);
<a name="l01045"></a>01045 
<a name="l01046"></a>01046     <span class="keyword">self</span>-&gt;num_col = 4;
<a name="l01047"></a>01047     <span class="keyword">self</span>-&gt;num_row = 4;
<a name="l01048"></a>01048 
<a name="l01049"></a>01049     Py_RETURN_NONE;
<a name="l01050"></a>01050 }
<a name="l01051"></a>01051 
<a name="l01052"></a>01052 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_to_4x4_doc,
<a name="l01053"></a>01053 <span class="stringliteral">&quot;.. method:: to_4x4()\n&quot;</span>
<a name="l01054"></a>01054 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01055"></a>01055 <span class="stringliteral">&quot;   Return a 4x4 copy of this matrix.\n&quot;</span>
<a name="l01056"></a>01056 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01057"></a>01057 <span class="stringliteral">&quot;   :return: a new matrix.\n&quot;</span>
<a name="l01058"></a>01058 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l01059"></a>01059 );
<a name="l01060"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0f3c5135ec850a07b4e0e10c9e82d138">01060</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0f3c5135ec850a07b4e0e10c9e82d138">Matrix_to_4x4</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01061"></a>01061 {
<a name="l01062"></a>01062     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01063"></a>01063         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01064"></a>01064 
<a name="l01065"></a>01065     <span class="keywordflow">if</span> (self-&gt;num_row == 4 &amp;&amp; self-&gt;num_col == 4) {
<a name="l01066"></a>01066         <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(self-&gt;matrix, 4, 4, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(<span class="keyword">self</span>));
<a name="l01067"></a>01067     }
<a name="l01068"></a>01068     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_row == 3 &amp;&amp; self-&gt;num_col == 3) {
<a name="l01069"></a>01069         <span class="keywordtype">float</span> mat[4][4];
<a name="l01070"></a>01070         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a8efd369830530951efa924af73e43616">copy_m4_m3</a>(mat, (<span class="keywordtype">float</span> (*)[3])self-&gt;matrix);
<a name="l01071"></a>01071         <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>((<span class="keywordtype">float</span> *)mat, 4, 4, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(<span class="keyword">self</span>));
<a name="l01072"></a>01072     }
<a name="l01073"></a>01073     <span class="comment">/* TODO, 2x2 matrix */</span>
<a name="l01074"></a>01074 
<a name="l01075"></a>01075     PyErr_SetString(PyExc_TypeError,
<a name="l01076"></a>01076                     <span class="stringliteral">&quot;Matrix.to_4x4(): &quot;</span>
<a name="l01077"></a>01077                     <span class="stringliteral">&quot;inappropriate matrix size&quot;</span>);
<a name="l01078"></a>01078     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01079"></a>01079 }
<a name="l01080"></a>01080 
<a name="l01081"></a>01081 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_to_3x3_doc,
<a name="l01082"></a>01082 <span class="stringliteral">&quot;.. method:: to_3x3()\n&quot;</span>
<a name="l01083"></a>01083 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01084"></a>01084 <span class="stringliteral">&quot;   Return a 3x3 copy of this matrix.\n&quot;</span>
<a name="l01085"></a>01085 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01086"></a>01086 <span class="stringliteral">&quot;   :return: a new matrix.\n&quot;</span>
<a name="l01087"></a>01087 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l01088"></a>01088 );
<a name="l01089"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a61ca5f46c3962c0a011d4f57ea53aeed">01089</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a61ca5f46c3962c0a011d4f57ea53aeed">Matrix_to_3x3</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01090"></a>01090 {
<a name="l01091"></a>01091     <span class="keywordtype">float</span> mat[3][3];
<a name="l01092"></a>01092 
<a name="l01093"></a>01093     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01094"></a>01094         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01095"></a>01095 
<a name="l01096"></a>01096     <span class="keywordflow">if</span> ((self-&gt;num_row &lt; 3) || (self-&gt;num_col &lt; 3)) {
<a name="l01097"></a>01097         PyErr_SetString(PyExc_TypeError,
<a name="l01098"></a>01098                         <span class="stringliteral">&quot;Matrix.to_3x3(): inappropriate matrix size&quot;</span>);
<a name="l01099"></a>01099         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01100"></a>01100     }
<a name="l01101"></a>01101 
<a name="l01102"></a>01102     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8b433695865df09a00df205c0b1fc18c">matrix_as_3x3</a>(mat, <span class="keyword">self</span>);
<a name="l01103"></a>01103 
<a name="l01104"></a>01104     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>((<span class="keywordtype">float</span> *)mat, 3, 3, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(<span class="keyword">self</span>));
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_to_translation_doc,
<a name="l01108"></a>01108 <span class="stringliteral">&quot;.. method:: to_translation()\n&quot;</span>
<a name="l01109"></a>01109 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01110"></a>01110 <span class="stringliteral">&quot;   Return a the translation part of a 4 row matrix.\n&quot;</span>
<a name="l01111"></a>01111 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01112"></a>01112 <span class="stringliteral">&quot;   :return: Return a the translation of a matrix.\n&quot;</span>
<a name="l01113"></a>01113 <span class="stringliteral">&quot;   :rtype: :class:`Vector`\n&quot;</span>
<a name="l01114"></a>01114 );
<a name="l01115"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad4ca3f54fc1154c48161ca48081a6af7">01115</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad4ca3f54fc1154c48161ca48081a6af7">Matrix_to_translation</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01116"></a>01116 {
<a name="l01117"></a>01117     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01118"></a>01118         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01119"></a>01119 
<a name="l01120"></a>01120     <span class="keywordflow">if</span> ((self-&gt;num_row &lt; 3) || self-&gt;num_col &lt; 4) {
<a name="l01121"></a>01121         PyErr_SetString(PyExc_TypeError,
<a name="l01122"></a>01122                         <span class="stringliteral">&quot;Matrix.to_translation(): &quot;</span>
<a name="l01123"></a>01123                         <span class="stringliteral">&quot;inappropriate matrix size&quot;</span>);
<a name="l01124"></a>01124         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01125"></a>01125     }
<a name="l01126"></a>01126 
<a name="l01127"></a>01127     <span class="keywordflow">return</span> <a class="code" href="../../da/d49/mathutils__Vector_8c.html#aa26668c535dbe9c2d2b96259557a1be3">Vector_CreatePyObject</a>(<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a432cc799e2d059e825c25da73ae0a1ff">MATRIX_COL_PTR</a>(<span class="keyword">self</span>, 3), 3, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01128"></a>01128 }
<a name="l01129"></a>01129 
<a name="l01130"></a>01130 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_to_scale_doc,
<a name="l01131"></a>01131 <span class="stringliteral">&quot;.. method:: to_scale()\n&quot;</span>
<a name="l01132"></a>01132 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01133"></a>01133 <span class="stringliteral">&quot;   Return a the scale part of a 3x3 or 4x4 matrix.\n&quot;</span>
<a name="l01134"></a>01134 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01135"></a>01135 <span class="stringliteral">&quot;   :return: Return a the scale of a matrix.\n&quot;</span>
<a name="l01136"></a>01136 <span class="stringliteral">&quot;   :rtype: :class:`Vector`\n&quot;</span>
<a name="l01137"></a>01137 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01138"></a>01138 <span class="stringliteral">&quot;   .. note:: This method does not return negative a scale on any axis because it is not possible to obtain this data from the matrix alone.\n&quot;</span>
<a name="l01139"></a>01139 );
<a name="l01140"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac60f49994048b84779a64f944a45cfad">01140</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac60f49994048b84779a64f944a45cfad">Matrix_to_scale</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01141"></a>01141 {
<a name="l01142"></a>01142     <span class="keywordtype">float</span> <a class="code" href="../../df/d5a/svm__noise_8h.html#aae44e21ada356d9d84450d5440fbb0c4">rot</a>[3][3];
<a name="l01143"></a>01143     <span class="keywordtype">float</span> mat[3][3];
<a name="l01144"></a>01144     <span class="keywordtype">float</span> <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>[3];
<a name="l01145"></a>01145 
<a name="l01146"></a>01146     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01147"></a>01147         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01148"></a>01148 
<a name="l01149"></a>01149     <span class="comment">/*must be 3-4 cols, 3-4 rows, square matrix */</span>
<a name="l01150"></a>01150     <span class="keywordflow">if</span> ((self-&gt;num_row &lt; 3) || (self-&gt;num_col &lt; 3)) {
<a name="l01151"></a>01151         PyErr_SetString(PyExc_TypeError,
<a name="l01152"></a>01152                         <span class="stringliteral">&quot;Matrix.to_scale(): &quot;</span>
<a name="l01153"></a>01153                         <span class="stringliteral">&quot;inappropriate matrix size, 3x3 minimum size&quot;</span>);
<a name="l01154"></a>01154         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01155"></a>01155     }
<a name="l01156"></a>01156 
<a name="l01157"></a>01157     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8b433695865df09a00df205c0b1fc18c">matrix_as_3x3</a>(mat, <span class="keyword">self</span>);
<a name="l01158"></a>01158 
<a name="l01159"></a>01159     <span class="comment">/* compatible mat4_to_loc_rot_size */</span>
<a name="l01160"></a>01160     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#af8c04193d3ebb572da91ef5506e06b00">mat3_to_rot_size</a>(rot, size, mat);
<a name="l01161"></a>01161 
<a name="l01162"></a>01162     <span class="keywordflow">return</span> <a class="code" href="../../da/d49/mathutils__Vector_8c.html#aa26668c535dbe9c2d2b96259557a1be3">Vector_CreatePyObject</a>(size, 3, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01163"></a>01163 }
<a name="l01164"></a>01164 
<a name="l01165"></a>01165 <span class="comment">/*---------------------------matrix.invert() ---------------------*/</span>
<a name="l01166"></a>01166 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_invert_doc,
<a name="l01167"></a>01167 <span class="stringliteral">&quot;.. method:: invert()\n&quot;</span>
<a name="l01168"></a>01168 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01169"></a>01169 <span class="stringliteral">&quot;   Set the matrix to its inverse.\n&quot;</span>
<a name="l01170"></a>01170 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01171"></a>01171 <span class="stringliteral">&quot;   .. note:: When the matrix cant be inverted a :exc:`ValueError` exception is raised.\n&quot;</span>
<a name="l01172"></a>01172 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01173"></a>01173 <span class="stringliteral">&quot;   .. seealso:: &lt;http://en.wikipedia.org/wiki/Inverse_matrix&gt;\n&quot;</span>
<a name="l01174"></a>01174 );
<a name="l01175"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a41ae5180b1736341e4bd846ea6dee7c1">01175</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a41ae5180b1736341e4bd846ea6dee7c1">Matrix_invert</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01176"></a>01176 {
<a name="l01177"></a>01177 
<a name="l01178"></a>01178     <span class="keywordtype">int</span> x, y, z = 0;
<a name="l01179"></a>01179     <span class="keywordtype">float</span> det = 0.0f;
<a name="l01180"></a>01180     <span class="keywordtype">float</span> mat[16] = {0.0f, 0.0f, 0.0f, 0.0f,
<a name="l01181"></a>01181                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l01182"></a>01182                      0.0f, 0.0f, 0.0f, 0.0f,
<a name="l01183"></a>01183                      0.0f, 0.0f, 0.0f, 1.0f};
<a name="l01184"></a>01184 
<a name="l01185"></a>01185     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01186"></a>01186         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01187"></a>01187 
<a name="l01188"></a>01188     <span class="keywordflow">if</span> (self-&gt;num_col != self-&gt;num_row) {
<a name="l01189"></a>01189         PyErr_SetString(PyExc_TypeError,
<a name="l01190"></a>01190                         <span class="stringliteral">&quot;Matrix.invert(ed): &quot;</span>
<a name="l01191"></a>01191                         <span class="stringliteral">&quot;only square matrices are supported&quot;</span>);
<a name="l01192"></a>01192         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01193"></a>01193     }
<a name="l01194"></a>01194 
<a name="l01195"></a>01195     <span class="comment">/* calculate the determinant */</span>
<a name="l01196"></a>01196     det = <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac03fba9181b056c6ae837bc402914b1c">matrix_determinant_internal</a>(<span class="keyword">self</span>);
<a name="l01197"></a>01197 
<a name="l01198"></a>01198     <span class="keywordflow">if</span> (det != 0) {
<a name="l01199"></a>01199         <span class="comment">/* calculate the classical adjoint */</span>
<a name="l01200"></a>01200         <span class="keywordflow">if</span> (self-&gt;num_col == 2) {
<a name="l01201"></a>01201             mat[0] =  <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 1);
<a name="l01202"></a>01202             mat[1] = -<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 1);
<a name="l01203"></a>01203             mat[2] = -<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 0);
<a name="l01204"></a>01204             mat[3] =  <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 0);
<a name="l01205"></a>01205         }
<a name="l01206"></a>01206         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_col == 3) {
<a name="l01207"></a>01207             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ac818ba37d3a29ffac85916e5d534c236">adjoint_m3_m3</a>((<span class="keywordtype">float</span> (*)[3])mat, (<span class="keywordtype">float</span> (*)[3])self-&gt;matrix);
<a name="l01208"></a>01208         }
<a name="l01209"></a>01209         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_col == 4) {
<a name="l01210"></a>01210             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a91dae9af778be60a1a961423dfc4136e">adjoint_m4_m4</a>((<span class="keywordtype">float</span> (*)[4])mat, (<span class="keywordtype">float</span> (*)[4])self-&gt;matrix);
<a name="l01211"></a>01211         }
<a name="l01212"></a>01212         <span class="comment">/* divide by determinate */</span>
<a name="l01213"></a>01213         <span class="keywordflow">for</span> (x = 0; x &lt; (<span class="keyword">self</span>-&gt;num_col * <span class="keyword">self</span>-&gt;num_row); x++) {
<a name="l01214"></a>01214             mat[x] /= det;
<a name="l01215"></a>01215         }
<a name="l01216"></a>01216         <span class="comment">/* set values */</span>
<a name="l01217"></a>01217         <span class="keywordflow">for</span> (x = 0; x &lt; <span class="keyword">self</span>-&gt;num_col; x++) {
<a name="l01218"></a>01218             <span class="keywordflow">for</span> (y = 0; y &lt; <span class="keyword">self</span>-&gt;num_row; y++) {
<a name="l01219"></a>01219                 <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, y, x) = mat[z];
<a name="l01220"></a>01220                 z++;
<a name="l01221"></a>01221             }
<a name="l01222"></a>01222         }
<a name="l01223"></a>01223     }
<a name="l01224"></a>01224     <span class="keywordflow">else</span> {
<a name="l01225"></a>01225         PyErr_SetString(PyExc_ValueError,
<a name="l01226"></a>01226                         <span class="stringliteral">&quot;Matrix.invert(ed): &quot;</span>
<a name="l01227"></a>01227                         <span class="stringliteral">&quot;matrix does not have an inverse&quot;</span>);
<a name="l01228"></a>01228         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01229"></a>01229     }
<a name="l01230"></a>01230 
<a name="l01231"></a>01231     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l01232"></a>01232     Py_RETURN_NONE;
<a name="l01233"></a>01233 }
<a name="l01234"></a>01234 
<a name="l01235"></a>01235 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_inverted_doc,
<a name="l01236"></a>01236 <span class="stringliteral">&quot;.. method:: inverted()\n&quot;</span>
<a name="l01237"></a>01237 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01238"></a>01238 <span class="stringliteral">&quot;   Return an inverted copy of the matrix.\n&quot;</span>
<a name="l01239"></a>01239 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01240"></a>01240 <span class="stringliteral">&quot;   :return: the  inverted matrix.\n&quot;</span>
<a name="l01241"></a>01241 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l01242"></a>01242 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01243"></a>01243 <span class="stringliteral">&quot;   .. note:: When the matrix cant be inverted a :exc:`ValueError` exception is raised.\n&quot;</span>
<a name="l01244"></a>01244 );
<a name="l01245"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a934b0d7bebcc92206d8bb1cba129ed">01245</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a934b0d7bebcc92206d8bb1cba129ed">Matrix_inverted</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01246"></a>01246 {
<a name="l01247"></a>01247     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af69282eedc8e57c3be2bcaa113caef6f">matrix__apply_to_copy</a>((PyNoArgsFunction)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a41ae5180b1736341e4bd846ea6dee7c1">Matrix_invert</a>, <span class="keyword">self</span>);
<a name="l01248"></a>01248 }
<a name="l01249"></a>01249 
<a name="l01250"></a>01250 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_rotate_doc,
<a name="l01251"></a>01251 <span class="stringliteral">&quot;.. method:: rotate(other)\n&quot;</span>
<a name="l01252"></a>01252 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01253"></a>01253 <span class="stringliteral">&quot;   Rotates the matrix a by another mathutils value.\n&quot;</span>
<a name="l01254"></a>01254 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01255"></a>01255 <span class="stringliteral">&quot;   :arg other: rotation component of mathutils value\n&quot;</span>
<a name="l01256"></a>01256 <span class="stringliteral">&quot;   :type other: :class:`Euler`, :class:`Quaternion` or :class:`Matrix`\n&quot;</span>
<a name="l01257"></a>01257 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01258"></a>01258 <span class="stringliteral">&quot;   .. note:: If any of the columns are not unit length this may not have desired results.\n&quot;</span>
<a name="l01259"></a>01259 );
<a name="l01260"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a89ede5d1867042352d614b3ecc616300">01260</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a89ede5d1867042352d614b3ecc616300">Matrix_rotate</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *value)
<a name="l01261"></a>01261 {
<a name="l01262"></a>01262     <span class="keywordtype">float</span> self_rmat[3][3], other_rmat[3][3], rmat[3][3];
<a name="l01263"></a>01263 
<a name="l01264"></a>01264     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01265"></a>01265         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01266"></a>01266 
<a name="l01267"></a>01267     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#ab2a4d32454bb5cec142059c3a75e4a55">mathutils_any_to_rotmat</a>(other_rmat, value, <span class="stringliteral">&quot;matrix.rotate(value)&quot;</span>) == -1)
<a name="l01268"></a>01268         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01269"></a>01269 
<a name="l01270"></a>01270     <span class="keywordflow">if</span> (self-&gt;num_row != 3 || self-&gt;num_col != 3) {
<a name="l01271"></a>01271         PyErr_SetString(PyExc_TypeError,
<a name="l01272"></a>01272                         <span class="stringliteral">&quot;Matrix.rotate(): &quot;</span>
<a name="l01273"></a>01273                         <span class="stringliteral">&quot;must have 3x3 dimensions&quot;</span>);
<a name="l01274"></a>01274         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01275"></a>01275     }
<a name="l01276"></a>01276 
<a name="l01277"></a>01277     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8b433695865df09a00df205c0b1fc18c">matrix_as_3x3</a>(self_rmat, <span class="keyword">self</span>);
<a name="l01278"></a>01278     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a6879ca084fea564be44fbdd816781f74">mul_m3_m3m3</a>(rmat, other_rmat, self_rmat);
<a name="l01279"></a>01279 
<a name="l01280"></a>01280     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#aceb90dff38c8c92e00335f2da648d61e">copy_m3_m3</a>((<span class="keywordtype">float</span> (*)[3])(self-&gt;matrix), rmat);
<a name="l01281"></a>01281 
<a name="l01282"></a>01282     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l01283"></a>01283     Py_RETURN_NONE;
<a name="l01284"></a>01284 }
<a name="l01285"></a>01285 
<a name="l01286"></a>01286 <span class="comment">/*---------------------------matrix.decompose() ---------------------*/</span>
<a name="l01287"></a>01287 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_decompose_doc,
<a name="l01288"></a>01288 <span class="stringliteral">&quot;.. method:: decompose()\n&quot;</span>
<a name="l01289"></a>01289 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01290"></a>01290 <span class="stringliteral">&quot;   Return the location, rotaion and scale components of this matrix.\n&quot;</span>
<a name="l01291"></a>01291 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01292"></a>01292 <span class="stringliteral">&quot;   :return: loc, rot, scale triple.\n&quot;</span>
<a name="l01293"></a>01293 <span class="stringliteral">&quot;   :rtype: (:class:`Vector`, :class:`Quaternion`, :class:`Vector`)&quot;</span>
<a name="l01294"></a>01294 );
<a name="l01295"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7f9341b1f5ceaddf009c6dbd86c3ee8a">01295</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7f9341b1f5ceaddf009c6dbd86c3ee8a">Matrix_decompose</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01296"></a>01296 {
<a name="l01297"></a>01297     PyObject *ret;
<a name="l01298"></a>01298     <span class="keywordtype">float</span> loc[3];
<a name="l01299"></a>01299     <span class="keywordtype">float</span> <a class="code" href="../../df/d5a/svm__noise_8h.html#aae44e21ada356d9d84450d5440fbb0c4">rot</a>[3][3];
<a name="l01300"></a>01300     <span class="keywordtype">float</span> quat[4];
<a name="l01301"></a>01301     <span class="keywordtype">float</span> <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>[3];
<a name="l01302"></a>01302 
<a name="l01303"></a>01303     <span class="keywordflow">if</span> (self-&gt;num_row != 4 || self-&gt;num_col != 4) {
<a name="l01304"></a>01304         PyErr_SetString(PyExc_TypeError,
<a name="l01305"></a>01305                         <span class="stringliteral">&quot;Matrix.decompose(): &quot;</span>
<a name="l01306"></a>01306                         <span class="stringliteral">&quot;inappropriate matrix size - expects 4x4 matrix&quot;</span>);
<a name="l01307"></a>01307         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01308"></a>01308     }
<a name="l01309"></a>01309 
<a name="l01310"></a>01310     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01311"></a>01311         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01312"></a>01312 
<a name="l01313"></a>01313     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2626c6f2192bb7a832177be746dc9f08">mat4_to_loc_rot_size</a>(loc, rot, size, (<span class="keywordtype">float</span> (*)[4])self-&gt;matrix);
<a name="l01314"></a>01314     <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a176f538ccb9db7cc95d7699264508b26">mat3_to_quat</a>(quat, rot);
<a name="l01315"></a>01315 
<a name="l01316"></a>01316     ret = PyTuple_New(3);
<a name="l01317"></a>01317     PyTuple_SET_ITEM(ret, 0, <a class="code" href="../../da/d49/mathutils__Vector_8c.html#aa26668c535dbe9c2d2b96259557a1be3">Vector_CreatePyObject</a>(loc, 3, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));
<a name="l01318"></a>01318     PyTuple_SET_ITEM(ret, 1, <a class="code" href="../../dd/dc0/mathutils__Quaternion_8c.html#a6d34ec42c240f5b80bc1e9667142b49f">Quaternion_CreatePyObject</a>(quat, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));
<a name="l01319"></a>01319     PyTuple_SET_ITEM(ret, 2, <a class="code" href="../../da/d49/mathutils__Vector_8c.html#aa26668c535dbe9c2d2b96259557a1be3">Vector_CreatePyObject</a>(size, 3, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));
<a name="l01320"></a>01320 
<a name="l01321"></a>01321     <span class="keywordflow">return</span> ret;
<a name="l01322"></a>01322 }
<a name="l01323"></a>01323 
<a name="l01324"></a>01324 
<a name="l01325"></a>01325 
<a name="l01326"></a>01326 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_lerp_doc,
<a name="l01327"></a>01327 <span class="stringliteral">&quot;.. function:: lerp(other, factor)\n&quot;</span>
<a name="l01328"></a>01328 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01329"></a>01329 <span class="stringliteral">&quot;   Returns the interpolation of two matrices.\n&quot;</span>
<a name="l01330"></a>01330 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01331"></a>01331 <span class="stringliteral">&quot;   :arg other: value to interpolate with.\n&quot;</span>
<a name="l01332"></a>01332 <span class="stringliteral">&quot;   :type other: :class:`Matrix`\n&quot;</span>
<a name="l01333"></a>01333 <span class="stringliteral">&quot;   :arg factor: The interpolation value in [0.0, 1.0].\n&quot;</span>
<a name="l01334"></a>01334 <span class="stringliteral">&quot;   :type factor: float\n&quot;</span>
<a name="l01335"></a>01335 <span class="stringliteral">&quot;   :return: The interpolated rotation.\n&quot;</span>
<a name="l01336"></a>01336 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l01337"></a>01337 );
<a name="l01338"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0f4b4483f6bb4f82a82444fe616a3a7f">01338</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0f4b4483f6bb4f82a82444fe616a3a7f">Matrix_lerp</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *args)
<a name="l01339"></a>01339 {
<a name="l01340"></a>01340     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *mat2 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01341"></a>01341     <span class="keywordtype">float</span> fac, mat[<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a52ef6b753fe6fa402c16f29052941a2c">MATRIX_MAX_DIM</a> * <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a52ef6b753fe6fa402c16f29052941a2c">MATRIX_MAX_DIM</a>];
<a name="l01342"></a>01342 
<a name="l01343"></a>01343     <span class="keywordflow">if</span> (!PyArg_ParseTuple(args, <span class="stringliteral">&quot;O!f:lerp&quot;</span>, &amp;<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afcb36b111474c151c47f33c71cfaf0d2">matrix_Type</a>, &amp;mat2, &amp;fac))
<a name="l01344"></a>01344         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01345"></a>01345 
<a name="l01346"></a>01346     <span class="keywordflow">if</span> (self-&gt;num_col != mat2-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> || self-&gt;num_row != mat2-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>) {
<a name="l01347"></a>01347         PyErr_SetString(PyExc_ValueError,
<a name="l01348"></a>01348                         <span class="stringliteral">&quot;Matrix.lerp(): &quot;</span>
<a name="l01349"></a>01349                         <span class="stringliteral">&quot;expects both matrix objects of the same dimensions&quot;</span>);
<a name="l01350"></a>01350         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01351"></a>01351     }
<a name="l01352"></a>01352 
<a name="l01353"></a>01353     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1 || <a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(mat2) == -1)
<a name="l01354"></a>01354         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01355"></a>01355 
<a name="l01356"></a>01356     <span class="comment">/* TODO, different sized matrix */</span>
<a name="l01357"></a>01357     <span class="keywordflow">if</span> (self-&gt;num_col == 4 &amp;&amp; self-&gt;num_row == 4) {
<a name="l01358"></a>01358         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a3d5bcb56397fadbf6966427875962a01">blend_m4_m4m4</a>((<span class="keywordtype">float</span> (*)[4])mat, (<span class="keywordtype">float</span> (*)[4])self-&gt;matrix, (float (*)[4])mat2-&gt;matrix, fac);
<a name="l01359"></a>01359     }
<a name="l01360"></a>01360     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_col == 3 &amp;&amp; self-&gt;num_row == 3) {
<a name="l01361"></a>01361         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a8a916135c9e8628915f66d640fdd8905">blend_m3_m3m3</a>((<span class="keywordtype">float</span> (*)[3])mat, (<span class="keywordtype">float</span> (*)[3])self-&gt;matrix, (float (*)[3])mat2-&gt;matrix, fac);
<a name="l01362"></a>01362     }
<a name="l01363"></a>01363     <span class="keywordflow">else</span> {
<a name="l01364"></a>01364         PyErr_SetString(PyExc_ValueError,
<a name="l01365"></a>01365                         <span class="stringliteral">&quot;Matrix.lerp(): &quot;</span>
<a name="l01366"></a>01366                         <span class="stringliteral">&quot;only 3x3 and 4x4 matrices supported&quot;</span>);
<a name="l01367"></a>01367         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01368"></a>01368     }
<a name="l01369"></a>01369 
<a name="l01370"></a>01370     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, self-&gt;num_col, self-&gt;num_row, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(<span class="keyword">self</span>));
<a name="l01371"></a>01371 }
<a name="l01372"></a>01372 
<a name="l01373"></a>01373 <span class="comment">/*---------------------------matrix.determinant() ----------------*/</span>
<a name="l01374"></a>01374 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_determinant_doc,
<a name="l01375"></a>01375 <span class="stringliteral">&quot;.. method:: determinant()\n&quot;</span>
<a name="l01376"></a>01376 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01377"></a>01377 <span class="stringliteral">&quot;   Return the determinant of a matrix.\n&quot;</span>
<a name="l01378"></a>01378 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01379"></a>01379 <span class="stringliteral">&quot;   :return: Return a the determinant of a matrix.\n&quot;</span>
<a name="l01380"></a>01380 <span class="stringliteral">&quot;   :rtype: float\n&quot;</span>
<a name="l01381"></a>01381 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01382"></a>01382 <span class="stringliteral">&quot;   .. seealso:: &lt;http://en.wikipedia.org/wiki/Determinant&gt;\n&quot;</span>
<a name="l01383"></a>01383 );
<a name="l01384"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af1144607b981eca9a2deba77f2aef4f1">01384</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af1144607b981eca9a2deba77f2aef4f1">Matrix_determinant</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01385"></a>01385 {
<a name="l01386"></a>01386     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01387"></a>01387         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01388"></a>01388 
<a name="l01389"></a>01389     <span class="keywordflow">if</span> (self-&gt;num_col != self-&gt;num_row) {
<a name="l01390"></a>01390         PyErr_SetString(PyExc_TypeError,
<a name="l01391"></a>01391                         <span class="stringliteral">&quot;Matrix.determinant(): &quot;</span>
<a name="l01392"></a>01392                         <span class="stringliteral">&quot;only square matrices are supported&quot;</span>);
<a name="l01393"></a>01393         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01394"></a>01394     }
<a name="l01395"></a>01395 
<a name="l01396"></a>01396     <span class="keywordflow">return</span> PyFloat_FromDouble((<span class="keywordtype">double</span>)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac03fba9181b056c6ae837bc402914b1c">matrix_determinant_internal</a>(<span class="keyword">self</span>));
<a name="l01397"></a>01397 }
<a name="l01398"></a>01398 <span class="comment">/*---------------------------matrix.transpose() ------------------*/</span>
<a name="l01399"></a>01399 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_transpose_doc,
<a name="l01400"></a>01400 <span class="stringliteral">&quot;.. method:: transpose()\n&quot;</span>
<a name="l01401"></a>01401 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01402"></a>01402 <span class="stringliteral">&quot;   Set the matrix to its transpose.\n&quot;</span>
<a name="l01403"></a>01403 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01404"></a>01404 <span class="stringliteral">&quot;   .. seealso:: &lt;http://en.wikipedia.org/wiki/Transpose&gt;\n&quot;</span>
<a name="l01405"></a>01405 );
<a name="l01406"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae7af993ac7a6ed090e900b69f10e8741">01406</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae7af993ac7a6ed090e900b69f10e8741">Matrix_transpose</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01407"></a>01407 {
<a name="l01408"></a>01408     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01409"></a>01409         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411     <span class="keywordflow">if</span> (self-&gt;num_col != self-&gt;num_row) {
<a name="l01412"></a>01412         PyErr_SetString(PyExc_TypeError,
<a name="l01413"></a>01413                         <span class="stringliteral">&quot;Matrix.transpose(d): &quot;</span>
<a name="l01414"></a>01414                         <span class="stringliteral">&quot;only square matrices are supported&quot;</span>);
<a name="l01415"></a>01415         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01416"></a>01416     }
<a name="l01417"></a>01417 
<a name="l01418"></a>01418     <span class="keywordflow">if</span> (self-&gt;num_col == 2) {
<a name="l01419"></a>01419         <span class="keyword">const</span> <span class="keywordtype">float</span> t = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 0);
<a name="l01420"></a>01420         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 0) = <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 1);
<a name="l01421"></a>01421         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 1) = t;
<a name="l01422"></a>01422     }
<a name="l01423"></a>01423     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_col == 3) {
<a name="l01424"></a>01424         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad34fc69317ce2354d58d80147b753408">transpose_m3</a>((<span class="keywordtype">float</span> (*)[3])self-&gt;matrix);
<a name="l01425"></a>01425     }
<a name="l01426"></a>01426     <span class="keywordflow">else</span> {
<a name="l01427"></a>01427         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#aed30c43fde76b6b3ecbbb7ca5b5a1f93">transpose_m4</a>((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix);
<a name="l01428"></a>01428     }
<a name="l01429"></a>01429 
<a name="l01430"></a>01430     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l01431"></a>01431     Py_RETURN_NONE;
<a name="l01432"></a>01432 }
<a name="l01433"></a>01433 
<a name="l01434"></a>01434 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_transposed_doc,
<a name="l01435"></a>01435 <span class="stringliteral">&quot;.. method:: transposed()\n&quot;</span>
<a name="l01436"></a>01436 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01437"></a>01437 <span class="stringliteral">&quot;   Return a new, transposed matrix.\n&quot;</span>
<a name="l01438"></a>01438 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01439"></a>01439 <span class="stringliteral">&quot;   :return: a transposed matrix\n&quot;</span>
<a name="l01440"></a>01440 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l01441"></a>01441 );
<a name="l01442"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a779543b992f6565d84fa8f8296710a54">01442</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a779543b992f6565d84fa8f8296710a54">Matrix_transposed</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01443"></a>01443 {
<a name="l01444"></a>01444     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af69282eedc8e57c3be2bcaa113caef6f">matrix__apply_to_copy</a>((PyNoArgsFunction)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae7af993ac7a6ed090e900b69f10e8741">Matrix_transpose</a>, <span class="keyword">self</span>);
<a name="l01445"></a>01445 }
<a name="l01446"></a>01446 
<a name="l01447"></a>01447 <span class="comment">/*---------------------------matrix.zero() -----------------------*/</span>
<a name="l01448"></a>01448 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_zero_doc,
<a name="l01449"></a>01449 <span class="stringliteral">&quot;.. method:: zero()\n&quot;</span>
<a name="l01450"></a>01450 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01451"></a>01451 <span class="stringliteral">&quot;   Set all the matrix values to zero.\n&quot;</span>
<a name="l01452"></a>01452 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01453"></a>01453 <span class="stringliteral">&quot;   :return: an instance of itself\n&quot;</span>
<a name="l01454"></a>01454 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l01455"></a>01455 );
<a name="l01456"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae5cd901bfb114910e5837911908bfedd">01456</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae5cd901bfb114910e5837911908bfedd">Matrix_zero</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01457"></a>01457 {
<a name="l01458"></a>01458     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a7049bd8d71df5798aa35be0ad27ca513">fill_vn_fl</a>(self-&gt;matrix, self-&gt;num_col * self-&gt;num_row, 0.0f);
<a name="l01459"></a>01459 
<a name="l01460"></a>01460     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01461"></a>01461         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01462"></a>01462 
<a name="l01463"></a>01463     Py_RETURN_NONE;
<a name="l01464"></a>01464 }
<a name="l01465"></a>01465 <span class="comment">/*---------------------------matrix.identity(() ------------------*/</span>
<a name="l01466"></a>01466 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_identity_doc,
<a name="l01467"></a>01467 <span class="stringliteral">&quot;.. method:: identity()\n&quot;</span>
<a name="l01468"></a>01468 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01469"></a>01469 <span class="stringliteral">&quot;   Set the matrix to the identity matrix.\n&quot;</span>
<a name="l01470"></a>01470 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01471"></a>01471 <span class="stringliteral">&quot;   .. note:: An object with zero location and rotation, a scale of one,\n&quot;</span>
<a name="l01472"></a>01472 <span class="stringliteral">&quot;      will have an identity matrix.\n&quot;</span>
<a name="l01473"></a>01473 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01474"></a>01474 <span class="stringliteral">&quot;   .. seealso:: &lt;http://en.wikipedia.org/wiki/Identity_matrix&gt;\n&quot;</span>
<a name="l01475"></a>01475 );
<a name="l01476"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afa4a4a8c9f200ca2a32369f906c61cdb">01476</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afa4a4a8c9f200ca2a32369f906c61cdb">Matrix_identity</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01477"></a>01477 {
<a name="l01478"></a>01478     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01479"></a>01479         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01480"></a>01480 
<a name="l01481"></a>01481     <span class="keywordflow">if</span> (self-&gt;num_col != self-&gt;num_row) {
<a name="l01482"></a>01482         PyErr_SetString(PyExc_TypeError,
<a name="l01483"></a>01483                         <span class="stringliteral">&quot;Matrix.identity(): &quot;</span>
<a name="l01484"></a>01484                         <span class="stringliteral">&quot;only square matrices are supported&quot;</span>);
<a name="l01485"></a>01485         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01486"></a>01486     }
<a name="l01487"></a>01487 
<a name="l01488"></a>01488     <span class="keywordflow">if</span> (self-&gt;num_col == 2) {
<a name="l01489"></a>01489         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 0) = 1.0f;
<a name="l01490"></a>01490         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 0, 1) = 0.0f;
<a name="l01491"></a>01491         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 0) = 0.0f;
<a name="l01492"></a>01492         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, 1, 1) = 1.0f;
<a name="l01493"></a>01493     }
<a name="l01494"></a>01494     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_col == 3) {
<a name="l01495"></a>01495         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ac2ec10af660a2f1d912816c842f37bfb">unit_m3</a>((<span class="keywordtype">float</span> (*)[3])self-&gt;matrix);
<a name="l01496"></a>01496     }
<a name="l01497"></a>01497     <span class="keywordflow">else</span> {
<a name="l01498"></a>01498         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a573114dda84526c82734926c26953eb0">unit_m4</a>((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix);
<a name="l01499"></a>01499     }
<a name="l01500"></a>01500 
<a name="l01501"></a>01501     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01502"></a>01502         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01503"></a>01503 
<a name="l01504"></a>01504     Py_RETURN_NONE;
<a name="l01505"></a>01505 }
<a name="l01506"></a>01506 
<a name="l01507"></a>01507 <span class="comment">/*---------------------------Matrix.copy() ------------------*/</span>
<a name="l01508"></a>01508 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_copy_doc,
<a name="l01509"></a>01509 <span class="stringliteral">&quot;.. method:: copy()\n&quot;</span>
<a name="l01510"></a>01510 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01511"></a>01511 <span class="stringliteral">&quot;   Returns a copy of this matrix.\n&quot;</span>
<a name="l01512"></a>01512 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01513"></a>01513 <span class="stringliteral">&quot;   :return: an instance of itself\n&quot;</span>
<a name="l01514"></a>01514 <span class="stringliteral">&quot;   :rtype: :class:`Matrix`\n&quot;</span>
<a name="l01515"></a>01515 );
<a name="l01516"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8fe1a1fb59878b7028eb74fb83ddb8b6">01516</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8fe1a1fb59878b7028eb74fb83ddb8b6">Matrix_copy</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01517"></a>01517 {
<a name="l01518"></a>01518     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01519"></a>01519         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01520"></a>01520 
<a name="l01521"></a>01521     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>((<span class="keywordtype">float</span> (*))self-&gt;matrix, self-&gt;num_col, self-&gt;num_row, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(<span class="keyword">self</span>));
<a name="l01522"></a>01522 }
<a name="l01523"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8865e678b22736b80ab0b381e96bd7b1">01523</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8865e678b22736b80ab0b381e96bd7b1">Matrix_deepcopy</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *args)
<a name="l01524"></a>01524 {
<a name="l01525"></a>01525     <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d8a/mathutils_8c.html#ab3865fce1cfd36f7156df36b91108629">mathutils_deepcopy_args_check</a>(args))
<a name="l01526"></a>01526         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01527"></a>01527     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8fe1a1fb59878b7028eb74fb83ddb8b6">Matrix_copy</a>(<span class="keyword">self</span>);
<a name="l01528"></a>01528 }
<a name="l01529"></a>01529 
<a name="l01530"></a>01530 <span class="comment">/*----------------------------print object (internal)-------------*/</span>
<a name="l01531"></a>01531 <span class="comment">/* print the object to screen */</span>
<a name="l01532"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a81a5c0b615ed9b4e982846800c93172c">01532</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a81a5c0b615ed9b4e982846800c93172c">Matrix_repr</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01533"></a>01533 {
<a name="l01534"></a>01534     <span class="keywordtype">int</span> col, row;
<a name="l01535"></a>01535     PyObject *rows[<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a52ef6b753fe6fa402c16f29052941a2c">MATRIX_MAX_DIM</a>] = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l01536"></a>01536 
<a name="l01537"></a>01537     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01538"></a>01538         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01539"></a>01539 
<a name="l01540"></a>01540     <span class="keywordflow">for</span> (row = 0; row &lt; <span class="keyword">self</span>-&gt;num_row; row++) {
<a name="l01541"></a>01541         rows[row] = PyTuple_New(self-&gt;num_col);
<a name="l01542"></a>01542         <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l01543"></a>01543             PyTuple_SET_ITEM(rows[row], col, PyFloat_FromDouble(<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col)));
<a name="l01544"></a>01544         }
<a name="l01545"></a>01545     }
<a name="l01546"></a>01546     <span class="keywordflow">switch</span> (self-&gt;num_row) {
<a name="l01547"></a>01547         <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> PyUnicode_FromFormat(<span class="stringliteral">&quot;Matrix((%R,\n&quot;</span>
<a name="l01548"></a>01548                                             <span class="stringliteral">&quot;        %R))&quot;</span>, rows[0], rows[1]);
<a name="l01549"></a>01549 
<a name="l01550"></a>01550         <span class="keywordflow">case</span> 3: <span class="keywordflow">return</span> PyUnicode_FromFormat(<span class="stringliteral">&quot;Matrix((%R,\n&quot;</span>
<a name="l01551"></a>01551                                             <span class="stringliteral">&quot;        %R,\n&quot;</span>
<a name="l01552"></a>01552                                             <span class="stringliteral">&quot;        %R))&quot;</span>, rows[0], rows[1], rows[2]);
<a name="l01553"></a>01553 
<a name="l01554"></a>01554         <span class="keywordflow">case</span> 4: <span class="keywordflow">return</span> PyUnicode_FromFormat(<span class="stringliteral">&quot;Matrix((%R,\n&quot;</span>
<a name="l01555"></a>01555                                             <span class="stringliteral">&quot;        %R,\n&quot;</span>
<a name="l01556"></a>01556                                             <span class="stringliteral">&quot;        %R,\n&quot;</span>
<a name="l01557"></a>01557                                             <span class="stringliteral">&quot;        %R))&quot;</span>, rows[0], rows[1], rows[2], rows[3]);
<a name="l01558"></a>01558     }
<a name="l01559"></a>01559 
<a name="l01560"></a>01560     Py_FatalError(<span class="stringliteral">&quot;Matrix(): invalid row size!&quot;</span>);
<a name="l01561"></a>01561     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01562"></a>01562 }
<a name="l01563"></a>01563 
<a name="l01564"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a54451413c717511325ab42be9f67d0e4">01564</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a54451413c717511325ab42be9f67d0e4">Matrix_str</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01565"></a>01565 {
<a name="l01566"></a>01566     <a class="code" href="../../d4/de5/structDynStr.html">DynStr</a> *ds;
<a name="l01567"></a>01567 
<a name="l01568"></a>01568     <span class="keywordtype">int</span> maxsize[<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a52ef6b753fe6fa402c16f29052941a2c">MATRIX_MAX_DIM</a>];
<a name="l01569"></a>01569     <span class="keywordtype">int</span> row, col;
<a name="l01570"></a>01570 
<a name="l01571"></a>01571     <span class="keywordtype">char</span> dummy_buf[64];
<a name="l01572"></a>01572 
<a name="l01573"></a>01573     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01574"></a>01574         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01575"></a>01575 
<a name="l01576"></a>01576     ds = <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#ae83ee20abb290558ce2e8f151ed54227">BLI_dynstr_new</a>();
<a name="l01577"></a>01577 
<a name="l01578"></a>01578     <span class="comment">/* First determine the maximum width for each column */</span>
<a name="l01579"></a>01579     <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l01580"></a>01580         maxsize[col] = 0;
<a name="l01581"></a>01581         <span class="keywordflow">for</span> (row = 0; row &lt; <span class="keyword">self</span>-&gt;num_row; row++) {
<a name="l01582"></a>01582             <span class="keywordtype">int</span> <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a> = <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(dummy_buf, <span class="keyword">sizeof</span>(dummy_buf), <span class="stringliteral">&quot;%.4f&quot;</span>, <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col));
<a name="l01583"></a>01583             maxsize[col] = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(maxsize[col], size);
<a name="l01584"></a>01584         }
<a name="l01585"></a>01585     }
<a name="l01586"></a>01586 
<a name="l01587"></a>01587     <span class="comment">/* Now write the unicode string to be printed */</span>
<a name="l01588"></a>01588     <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a5220af66d1325c122e7276140580b873">BLI_dynstr_appendf</a>(ds, <span class="stringliteral">&quot;&lt;Matrix %dx%d (&quot;</span>, self-&gt;num_row, self-&gt;num_col);
<a name="l01589"></a>01589     <span class="keywordflow">for</span> (row = 0; row &lt; <span class="keyword">self</span>-&gt;num_row; row++) {
<a name="l01590"></a>01590         <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l01591"></a>01591             <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a5220af66d1325c122e7276140580b873">BLI_dynstr_appendf</a>(ds, col ? <span class="stringliteral">&quot;, %*.4f&quot;</span> : <span class="stringliteral">&quot;%*.4f&quot;</span>, maxsize[col], <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col));
<a name="l01592"></a>01592         }
<a name="l01593"></a>01593         <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a55db0fd7c4f2fd5714777dbbd56238b4">BLI_dynstr_append</a>(ds, row + 1 != self-&gt;num_row ? <span class="stringliteral">&quot;)\n            (&quot;</span> : <span class="stringliteral">&quot;)&quot;</span>);
<a name="l01594"></a>01594     }
<a name="l01595"></a>01595     <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a55db0fd7c4f2fd5714777dbbd56238b4">BLI_dynstr_append</a>(ds, <span class="stringliteral">&quot;&gt;&quot;</span>);
<a name="l01596"></a>01596 
<a name="l01597"></a>01597     <span class="keywordflow">return</span> <a class="code" href="../../d1/d8a/mathutils_8c.html#a33fd818acda8ed7755e3c36e22c3fd1a">mathutils_dynstr_to_py</a>(ds); <span class="comment">/* frees ds */</span>
<a name="l01598"></a>01598 }
<a name="l01599"></a>01599 
<a name="l01600"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a189107ed2a49d203628252561c2b4472">01600</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a189107ed2a49d203628252561c2b4472">Matrix_richcmpr</a>(PyObject *a, PyObject *b, <span class="keywordtype">int</span> op)
<a name="l01601"></a>01601 {
<a name="l01602"></a>01602     PyObject *res;
<a name="l01603"></a>01603     <span class="keywordtype">int</span> ok = -1; <span class="comment">/* zero is true */</span>
<a name="l01604"></a>01604 
<a name="l01605"></a>01605     <span class="keywordflow">if</span> (<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(a) &amp;&amp; <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(b)) {
<a name="l01606"></a>01606         <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *matA = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)a;
<a name="l01607"></a>01607         <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *matB = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)b;
<a name="l01608"></a>01608 
<a name="l01609"></a>01609         <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(matA) == -1 || <a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(matB) == -1)
<a name="l01610"></a>01610             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01611"></a>01611 
<a name="l01612"></a>01612         ok = ((matA-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a> == matB-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>) &amp;&amp;
<a name="l01613"></a>01613               (matA-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> == matB-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>) &amp;&amp;
<a name="l01614"></a>01614               <a class="code" href="../../d1/d8a/mathutils_8c.html#a885e764bd3bae0db8b258384fe8ddd6d">EXPP_VectorsAreEqual</a>(matA-&gt;matrix, matB-&gt;matrix, (matA-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> * matA-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>), 1)
<a name="l01615"></a>01615               ) ? 0 : -1;
<a name="l01616"></a>01616     }
<a name="l01617"></a>01617 
<a name="l01618"></a>01618     <span class="keywordflow">switch</span> (op) {
<a name="l01619"></a>01619         <span class="keywordflow">case</span> Py_NE:
<a name="l01620"></a>01620             ok = !ok; <span class="comment">/* pass through */</span>
<a name="l01621"></a>01621         <span class="keywordflow">case</span> Py_EQ:
<a name="l01622"></a>01622             res = ok ? Py_False : Py_True;
<a name="l01623"></a>01623             <span class="keywordflow">break</span>;
<a name="l01624"></a>01624 
<a name="l01625"></a>01625         <span class="keywordflow">case</span> Py_LT:
<a name="l01626"></a>01626         <span class="keywordflow">case</span> Py_LE:
<a name="l01627"></a>01627         <span class="keywordflow">case</span> Py_GT:
<a name="l01628"></a>01628         <span class="keywordflow">case</span> Py_GE:
<a name="l01629"></a>01629             res = Py_NotImplemented;
<a name="l01630"></a>01630             <span class="keywordflow">break</span>;
<a name="l01631"></a>01631         <span class="keywordflow">default</span>:
<a name="l01632"></a>01632             PyErr_BadArgument();
<a name="l01633"></a>01633             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01634"></a>01634     }
<a name="l01635"></a>01635 
<a name="l01636"></a>01636     <span class="keywordflow">return</span> Py_INCREF(res), res;
<a name="l01637"></a>01637 }
<a name="l01638"></a>01638 
<a name="l01639"></a>01639 <span class="comment">/*---------------------SEQUENCE PROTOCOLS------------------------</span>
<a name="l01640"></a>01640 <span class="comment"> * ----------------------------len(object)------------------------</span>
<a name="l01641"></a>01641 <span class="comment"> * sequence length */</span>
<a name="l01642"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0855a4cea795fc178abdd0b0130c9683">01642</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0855a4cea795fc178abdd0b0130c9683">Matrix_len</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>)
<a name="l01643"></a>01643 {
<a name="l01644"></a>01644     <span class="keywordflow">return</span> (self-&gt;num_row);
<a name="l01645"></a>01645 }
<a name="l01646"></a>01646 <span class="comment">/*----------------------------object[]---------------------------</span>
<a name="l01647"></a>01647 <span class="comment"> * sequence accessor (get)</span>
<a name="l01648"></a>01648 <span class="comment"> * the wrapped vector gives direct access to the matrix data */</span>
<a name="l01649"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a6e82bf144bb6972d2ff0672f05cbff">01649</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a6e82bf144bb6972d2ff0672f05cbff">Matrix_item_row</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> row)
<a name="l01650"></a>01650 {
<a name="l01651"></a>01651     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01652"></a>01652         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01653"></a>01653 
<a name="l01654"></a>01654     <span class="keywordflow">if</span> (row &lt; 0 || row &gt;= self-&gt;num_row) {
<a name="l01655"></a>01655         PyErr_SetString(PyExc_IndexError,
<a name="l01656"></a>01656                         <span class="stringliteral">&quot;matrix[attribute]: &quot;</span>
<a name="l01657"></a>01657                         <span class="stringliteral">&quot;array index out of range&quot;</span>);
<a name="l01658"></a>01658         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01659"></a>01659     }
<a name="l01660"></a>01660     <span class="keywordflow">return</span> <a class="code" href="../../da/d49/mathutils__Vector_8c.html#a1938e489497f1f80418a62a4084d4695">Vector_CreatePyObject_cb</a>((PyObject *)<span class="keyword">self</span>, self-&gt;num_col, <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a46a309eac043b6ade3b6687924fc3e9a">mathutils_matrix_row_cb_index</a>, row);
<a name="l01661"></a>01661 }
<a name="l01662"></a>01662 <span class="comment">/* same but column access */</span>
<a name="l01663"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a2f95335a659adafd015da48e1536f0cf">01663</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a2f95335a659adafd015da48e1536f0cf">Matrix_item_col</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> col)
<a name="l01664"></a>01664 {
<a name="l01665"></a>01665     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01666"></a>01666         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01667"></a>01667 
<a name="l01668"></a>01668     <span class="keywordflow">if</span> (col &lt; 0 || col &gt;= self-&gt;num_col) {
<a name="l01669"></a>01669         PyErr_SetString(PyExc_IndexError,
<a name="l01670"></a>01670                         <span class="stringliteral">&quot;matrix[attribute]: &quot;</span>
<a name="l01671"></a>01671                         <span class="stringliteral">&quot;array index out of range&quot;</span>);
<a name="l01672"></a>01672         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01673"></a>01673     }
<a name="l01674"></a>01674     <span class="keywordflow">return</span> <a class="code" href="../../da/d49/mathutils__Vector_8c.html#a1938e489497f1f80418a62a4084d4695">Vector_CreatePyObject_cb</a>((PyObject *)<span class="keyword">self</span>, self-&gt;num_row, <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af9226430f6c79126ab66a3f97b5b9e27">mathutils_matrix_col_cb_index</a>, col);
<a name="l01675"></a>01675 }
<a name="l01676"></a>01676 
<a name="l01677"></a>01677 <span class="comment">/*----------------------------object[]-------------------------</span>
<a name="l01678"></a>01678 <span class="comment"> * sequence accessor (set) */</span>
<a name="l01679"></a>01679 
<a name="l01680"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9833c1a8ccc585bb37d18be005056c03">01680</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9833c1a8ccc585bb37d18be005056c03">Matrix_ass_item_row</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> row, PyObject *value)
<a name="l01681"></a>01681 {
<a name="l01682"></a>01682     <span class="keywordtype">int</span> col;
<a name="l01683"></a>01683     <span class="keywordtype">float</span> vec[4];
<a name="l01684"></a>01684     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01685"></a>01685         <span class="keywordflow">return</span> -1;
<a name="l01686"></a>01686 
<a name="l01687"></a>01687     <span class="keywordflow">if</span> (row &gt;= self-&gt;num_row || row &lt; 0) {
<a name="l01688"></a>01688         PyErr_SetString(PyExc_IndexError,
<a name="l01689"></a>01689                         <span class="stringliteral">&quot;matrix[attribute] = x: bad row&quot;</span>);
<a name="l01690"></a>01690         <span class="keywordflow">return</span> -1;
<a name="l01691"></a>01691     }
<a name="l01692"></a>01692 
<a name="l01693"></a>01693     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(vec, self-&gt;num_col, self-&gt;num_col, value, <span class="stringliteral">&quot;matrix[i] = value assignment&quot;</span>) &lt; 0) {
<a name="l01694"></a>01694         <span class="keywordflow">return</span> -1;
<a name="l01695"></a>01695     }
<a name="l01696"></a>01696 
<a name="l01697"></a>01697     <span class="comment">/* Since we are assigning a row we cannot memcpy */</span>
<a name="l01698"></a>01698     <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l01699"></a>01699         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = vec[col];
<a name="l01700"></a>01700     }
<a name="l01701"></a>01701 
<a name="l01702"></a>01702     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l01703"></a>01703     <span class="keywordflow">return</span> 0;
<a name="l01704"></a>01704 }
<a name="l01705"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ab068405f42d032129f10722e99da501e">01705</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ab068405f42d032129f10722e99da501e">Matrix_ass_item_col</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> col, PyObject *value)
<a name="l01706"></a>01706 {
<a name="l01707"></a>01707     <span class="keywordtype">int</span> row;
<a name="l01708"></a>01708     <span class="keywordtype">float</span> vec[4];
<a name="l01709"></a>01709     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01710"></a>01710         <span class="keywordflow">return</span> -1;
<a name="l01711"></a>01711 
<a name="l01712"></a>01712     <span class="keywordflow">if</span> (col &gt;= self-&gt;num_col || col &lt; 0) {
<a name="l01713"></a>01713         PyErr_SetString(PyExc_IndexError,
<a name="l01714"></a>01714                         <span class="stringliteral">&quot;matrix[attribute] = x: bad col&quot;</span>);
<a name="l01715"></a>01715         <span class="keywordflow">return</span> -1;
<a name="l01716"></a>01716     }
<a name="l01717"></a>01717 
<a name="l01718"></a>01718     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(vec, self-&gt;num_row, self-&gt;num_row, value, <span class="stringliteral">&quot;matrix[i] = value assignment&quot;</span>) &lt; 0) {
<a name="l01719"></a>01719         <span class="keywordflow">return</span> -1;
<a name="l01720"></a>01720     }
<a name="l01721"></a>01721 
<a name="l01722"></a>01722     <span class="comment">/* Since we are assigning a row we cannot memcpy */</span>
<a name="l01723"></a>01723     <span class="keywordflow">for</span> (row = 0; row &lt; <span class="keyword">self</span>-&gt;num_row; row++) {
<a name="l01724"></a>01724         <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(<span class="keyword">self</span>, row, col) = vec[row];
<a name="l01725"></a>01725     }
<a name="l01726"></a>01726 
<a name="l01727"></a>01727     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l01728"></a>01728     <span class="keywordflow">return</span> 0;
<a name="l01729"></a>01729 }
<a name="l01730"></a>01730 
<a name="l01731"></a>01731 
<a name="l01732"></a>01732 <span class="comment">/*----------------------------object[z:y]------------------------</span>
<a name="l01733"></a>01733 <span class="comment"> * sequence slice (get)*/</span>
<a name="l01734"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afa360a0fee05afc179d3dec141f08093">01734</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afa360a0fee05afc179d3dec141f08093">Matrix_slice</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> begin, <span class="keywordtype">int</span> end)
<a name="l01735"></a>01735 {
<a name="l01736"></a>01736 
<a name="l01737"></a>01737     PyObject *tuple;
<a name="l01738"></a>01738     <span class="keywordtype">int</span> count;
<a name="l01739"></a>01739 
<a name="l01740"></a>01740     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01741"></a>01741         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01742"></a>01742 
<a name="l01743"></a>01743     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(begin, 0, self-&gt;num_row);
<a name="l01744"></a>01744     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(end, 0, self-&gt;num_row);
<a name="l01745"></a>01745     begin = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(begin, end);
<a name="l01746"></a>01746 
<a name="l01747"></a>01747     tuple = PyTuple_New(end - begin);
<a name="l01748"></a>01748     <span class="keywordflow">for</span> (count = begin; count &lt; end; count++) {
<a name="l01749"></a>01749         PyTuple_SET_ITEM(tuple, count - begin,
<a name="l01750"></a>01750                          <a class="code" href="../../da/d49/mathutils__Vector_8c.html#a1938e489497f1f80418a62a4084d4695">Vector_CreatePyObject_cb</a>((PyObject *)<span class="keyword">self</span>, self-&gt;num_col, <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a46a309eac043b6ade3b6687924fc3e9a">mathutils_matrix_row_cb_index</a>, count));
<a name="l01751"></a>01751     }
<a name="l01752"></a>01752 
<a name="l01753"></a>01753     <span class="keywordflow">return</span> tuple;
<a name="l01754"></a>01754 }
<a name="l01755"></a>01755 <span class="comment">/*----------------------------object[z:y]------------------------</span>
<a name="l01756"></a>01756 <span class="comment"> * sequence slice (set)*/</span>
<a name="l01757"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aaa20df67c1252e1f57889f098981b370">01757</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aaa20df67c1252e1f57889f098981b370">Matrix_ass_slice</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> begin, <span class="keywordtype">int</span> end, PyObject *value)
<a name="l01758"></a>01758 {
<a name="l01759"></a>01759     PyObject *value_fast = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01760"></a>01760 
<a name="l01761"></a>01761     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l01762"></a>01762         <span class="keywordflow">return</span> -1;
<a name="l01763"></a>01763 
<a name="l01764"></a>01764     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(begin, 0, self-&gt;num_row);
<a name="l01765"></a>01765     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(end, 0, self-&gt;num_row);
<a name="l01766"></a>01766     begin = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(begin, end);
<a name="l01767"></a>01767 
<a name="l01768"></a>01768     <span class="comment">/* non list/tuple cases */</span>
<a name="l01769"></a>01769     <span class="keywordflow">if</span> (!(value_fast = PySequence_Fast(value, <span class="stringliteral">&quot;matrix[begin:end] = value&quot;</span>))) {
<a name="l01770"></a>01770         <span class="comment">/* PySequence_Fast sets the error */</span>
<a name="l01771"></a>01771         <span class="keywordflow">return</span> -1;
<a name="l01772"></a>01772     }
<a name="l01773"></a>01773     <span class="keywordflow">else</span> {
<a name="l01774"></a>01774         <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a> = end - begin;
<a name="l01775"></a>01775         <span class="keywordtype">int</span> row, col;
<a name="l01776"></a>01776         <span class="keywordtype">float</span> mat[16];
<a name="l01777"></a>01777         <span class="keywordtype">float</span> vec[4];
<a name="l01778"></a>01778 
<a name="l01779"></a>01779         <span class="keywordflow">if</span> (PySequence_Fast_GET_SIZE(value_fast) != size) {
<a name="l01780"></a>01780             Py_DECREF(value_fast);
<a name="l01781"></a>01781             PyErr_SetString(PyExc_ValueError,
<a name="l01782"></a>01782                             <span class="stringliteral">&quot;matrix[begin:end] = []: &quot;</span>
<a name="l01783"></a>01783                             <span class="stringliteral">&quot;size mismatch in slice assignment&quot;</span>);
<a name="l01784"></a>01784             <span class="keywordflow">return</span> -1;
<a name="l01785"></a>01785         }
<a name="l01786"></a>01786 
<a name="l01787"></a>01787         memcpy(mat, self-&gt;matrix, self-&gt;num_col * self-&gt;num_row * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l01788"></a>01788 
<a name="l01789"></a>01789         <span class="comment">/* parse sub items */</span>
<a name="l01790"></a>01790         <span class="keywordflow">for</span> (row = begin; row &lt; end; row++) {
<a name="l01791"></a>01791             <span class="comment">/* parse each sub sequence */</span>
<a name="l01792"></a>01792             PyObject *item = PySequence_Fast_GET_ITEM(value_fast, row - begin);
<a name="l01793"></a>01793 
<a name="l01794"></a>01794             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(vec, self-&gt;num_col, self-&gt;num_col, item,
<a name="l01795"></a>01795                                       <span class="stringliteral">&quot;matrix[begin:end] = value assignment&quot;</span>) &lt; 0)
<a name="l01796"></a>01796             {
<a name="l01797"></a>01797                 <span class="keywordflow">return</span> -1;
<a name="l01798"></a>01798             }
<a name="l01799"></a>01799 
<a name="l01800"></a>01800             <span class="keywordflow">for</span> (col = 0; col &lt; <span class="keyword">self</span>-&gt;num_col; col++) {
<a name="l01801"></a>01801                 mat[col * <span class="keyword">self</span>-&gt;num_row + row] = vec[col];
<a name="l01802"></a>01802             }
<a name="l01803"></a>01803         }
<a name="l01804"></a>01804 
<a name="l01805"></a>01805         Py_DECREF(value_fast);
<a name="l01806"></a>01806 
<a name="l01807"></a>01807         <span class="comment">/*parsed well - now set in matrix*/</span>
<a name="l01808"></a>01808         memcpy(self-&gt;matrix, mat, self-&gt;num_col * self-&gt;num_row * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l01809"></a>01809 
<a name="l01810"></a>01810         (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l01811"></a>01811         <span class="keywordflow">return</span> 0;
<a name="l01812"></a>01812     }
<a name="l01813"></a>01813 }
<a name="l01814"></a>01814 <span class="comment">/*------------------------NUMERIC PROTOCOLS----------------------</span>
<a name="l01815"></a>01815 <span class="comment"> *------------------------obj + obj------------------------------*/</span>
<a name="l01816"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a401ec48e98f9647cdd35927801d3dc2d">01816</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a401ec48e98f9647cdd35927801d3dc2d">Matrix_add</a>(PyObject *m1, PyObject *m2)
<a name="l01817"></a>01817 {
<a name="l01818"></a>01818     <span class="keywordtype">float</span> mat[16];
<a name="l01819"></a>01819     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *mat1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *mat2 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01820"></a>01820 
<a name="l01821"></a>01821     mat1 = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)m1;
<a name="l01822"></a>01822     mat2 = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)m2;
<a name="l01823"></a>01823 
<a name="l01824"></a>01824     <span class="keywordflow">if</span> (!<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(m1) || !<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(m2)) {
<a name="l01825"></a>01825         PyErr_Format(PyExc_TypeError,
<a name="l01826"></a>01826                      <span class="stringliteral">&quot;Matrix addition: (%s + %s) &quot;</span>
<a name="l01827"></a>01827                      <span class="stringliteral">&quot;invalid type for this operation&quot;</span>,
<a name="l01828"></a>01828                      Py_TYPE(m1)-&gt;tp_name, Py_TYPE(m2)-&gt;tp_name);
<a name="l01829"></a>01829         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01830"></a>01830     }
<a name="l01831"></a>01831 
<a name="l01832"></a>01832     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(mat1) == -1 || <a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(mat2) == -1)
<a name="l01833"></a>01833         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01834"></a>01834 
<a name="l01835"></a>01835     <span class="keywordflow">if</span> (mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> != mat2-&gt;num_col || mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a> != mat2-&gt;num_row) {
<a name="l01836"></a>01836         PyErr_SetString(PyExc_TypeError,
<a name="l01837"></a>01837                         <span class="stringliteral">&quot;Matrix addition: &quot;</span>
<a name="l01838"></a>01838                         <span class="stringliteral">&quot;matrices must have the same dimensions for this operation&quot;</span>);
<a name="l01839"></a>01839         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01840"></a>01840     }
<a name="l01841"></a>01841 
<a name="l01842"></a>01842     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a59b7c6adf6acf3c8f6b2ab0086527bca">add_vn_vnvn</a>(mat, mat1-&gt;matrix, mat2-&gt;matrix, mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> * mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>);
<a name="l01843"></a>01843 
<a name="l01844"></a>01844     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>, mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(mat1));
<a name="l01845"></a>01845 }
<a name="l01846"></a>01846 <span class="comment">/*------------------------obj - obj------------------------------</span>
<a name="l01847"></a>01847 <span class="comment"> * subtraction */</span>
<a name="l01848"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af2d45a7eb8daf11ec5427cc24ac10752">01848</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af2d45a7eb8daf11ec5427cc24ac10752">Matrix_sub</a>(PyObject *m1, PyObject *m2)
<a name="l01849"></a>01849 {
<a name="l01850"></a>01850     <span class="keywordtype">float</span> mat[16];
<a name="l01851"></a>01851     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *mat1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *mat2 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01852"></a>01852 
<a name="l01853"></a>01853     mat1 = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)m1;
<a name="l01854"></a>01854     mat2 = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)m2;
<a name="l01855"></a>01855 
<a name="l01856"></a>01856     <span class="keywordflow">if</span> (!<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(m1) || !<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(m2)) {
<a name="l01857"></a>01857         PyErr_Format(PyExc_TypeError,
<a name="l01858"></a>01858                      <span class="stringliteral">&quot;Matrix subtraction: (%s - %s) &quot;</span>
<a name="l01859"></a>01859                      <span class="stringliteral">&quot;invalid type for this operation&quot;</span>,
<a name="l01860"></a>01860                      Py_TYPE(m1)-&gt;tp_name, Py_TYPE(m2)-&gt;tp_name);
<a name="l01861"></a>01861         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01862"></a>01862     }
<a name="l01863"></a>01863 
<a name="l01864"></a>01864     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(mat1) == -1 || <a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(mat2) == -1)
<a name="l01865"></a>01865         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01866"></a>01866 
<a name="l01867"></a>01867     <span class="keywordflow">if</span> (mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> != mat2-&gt;num_col || mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a> != mat2-&gt;num_row) {
<a name="l01868"></a>01868         PyErr_SetString(PyExc_TypeError,
<a name="l01869"></a>01869                         <span class="stringliteral">&quot;Matrix addition: &quot;</span>
<a name="l01870"></a>01870                         <span class="stringliteral">&quot;matrices must have the same dimensions for this operation&quot;</span>);
<a name="l01871"></a>01871         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01872"></a>01872     }
<a name="l01873"></a>01873 
<a name="l01874"></a>01874     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a4ec39cfbbb304bb61d60aefc474e3db5">sub_vn_vnvn</a>(mat, mat1-&gt;matrix, mat2-&gt;matrix, mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> * mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>);
<a name="l01875"></a>01875 
<a name="l01876"></a>01876     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>, mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(mat1));
<a name="l01877"></a>01877 }
<a name="l01878"></a>01878 <span class="comment">/*------------------------obj * obj------------------------------</span>
<a name="l01879"></a>01879 <span class="comment"> * mulplication */</span>
<a name="l01880"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1c17e2e341892673941345bbe80cbeb8">01880</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1c17e2e341892673941345bbe80cbeb8">matrix_mul_float</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *mat, <span class="keyword">const</span> <span class="keywordtype">float</span> scalar)
<a name="l01881"></a>01881 {
<a name="l01882"></a>01882     <span class="keywordtype">float</span> tmat[16];
<a name="l01883"></a>01883     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a1c19d1e22eea098752f7d78648e0eff8">mul_vn_vn_fl</a>(tmat, mat-&gt;matrix, mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> * mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>, scalar);
<a name="l01884"></a>01884     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(tmat, mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>, mat-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(mat));
<a name="l01885"></a>01885 }
<a name="l01886"></a>01886 
<a name="l01887"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4d76ec3359b89f86d5de40039f1686cd">01887</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4d76ec3359b89f86d5de40039f1686cd">Matrix_mul</a>(PyObject *m1, PyObject *m2)
<a name="l01888"></a>01888 {
<a name="l01889"></a>01889     <span class="keywordtype">float</span> scalar;
<a name="l01890"></a>01890     <span class="keywordtype">int</span> vec_size;
<a name="l01891"></a>01891 
<a name="l01892"></a>01892     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *mat1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *mat2 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01893"></a>01893 
<a name="l01894"></a>01894     <span class="keywordflow">if</span> (<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(m1)) {
<a name="l01895"></a>01895         mat1 = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)m1;
<a name="l01896"></a>01896         <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(mat1) == -1)
<a name="l01897"></a>01897             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01898"></a>01898     }
<a name="l01899"></a>01899     <span class="keywordflow">if</span> (<a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a63229a4d401357a52c70684629b87b5e">MatrixObject_Check</a>(m2)) {
<a name="l01900"></a>01900         mat2 = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)m2;
<a name="l01901"></a>01901         <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(mat2) == -1)
<a name="l01902"></a>01902             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01903"></a>01903     }
<a name="l01904"></a>01904 
<a name="l01905"></a>01905     <span class="keywordflow">if</span> (mat1 &amp;&amp; mat2) {
<a name="l01906"></a>01906         <span class="comment">/* MATRIX * MATRIX */</span>
<a name="l01907"></a>01907         <span class="keywordtype">float</span> mat[16] = {0.0f, 0.0f, 0.0f, 0.0f,
<a name="l01908"></a>01908                          0.0f, 0.0f, 0.0f, 0.0f,
<a name="l01909"></a>01909                          0.0f, 0.0f, 0.0f, 0.0f,
<a name="l01910"></a>01910                          0.0f, 0.0f, 0.0f, 1.0f};
<a name="l01911"></a>01911 
<a name="l01912"></a>01912         <span class="keywordtype">int</span> col, row, item;
<a name="l01913"></a>01913 
<a name="l01914"></a>01914         <span class="keywordflow">if</span> (mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> != mat2-&gt;num_row) {
<a name="l01915"></a>01915             PyErr_SetString(PyExc_ValueError,
<a name="l01916"></a>01916                             <span class="stringliteral">&quot;matrix1 * matrix2: matrix1 number of columns &quot;</span>
<a name="l01917"></a>01917                             <span class="stringliteral">&quot;and the matrix2 number of rows must be the same&quot;</span>);
<a name="l01918"></a>01918             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01919"></a>01919         }
<a name="l01920"></a>01920 
<a name="l01921"></a>01921         <span class="keywordflow">for</span> (col = 0; col &lt; mat2-&gt;num_col; col++) {
<a name="l01922"></a>01922             <span class="keywordflow">for</span> (row = 0; row &lt; mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>; row++) {
<a name="l01923"></a>01923                 <span class="keywordtype">double</span> <a class="code" href="../../d1/d22/stdosl_8h.html#aedba6e917e11b0571459516317985220">dot</a> = 0.0f;
<a name="l01924"></a>01924                 <span class="keywordflow">for</span> (item = 0; item &lt; mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>; item++) {
<a name="l01925"></a>01925                     dot += <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(mat1, row, item) * <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ad3249c4ed968b19c0db60c3fcfc2d315">MATRIX_ITEM</a>(mat2, item, col);
<a name="l01926"></a>01926                 }
<a name="l01927"></a>01927                 mat[(col * mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>) + row] = (<span class="keywordtype">float</span>)<a class="code" href="../../d1/d22/stdosl_8h.html#aedba6e917e11b0571459516317985220">dot</a>;
<a name="l01928"></a>01928             }
<a name="l01929"></a>01929         }
<a name="l01930"></a>01930 
<a name="l01931"></a>01931         <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(mat, mat2-&gt;num_col, mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(mat1));
<a name="l01932"></a>01932     }
<a name="l01933"></a>01933     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mat2) {
<a name="l01934"></a>01934         <span class="comment">/*FLOAT/INT * MATRIX */</span>
<a name="l01935"></a>01935         <span class="keywordflow">if</span> (((scalar = PyFloat_AsDouble(m1)) == -1.0f &amp;&amp; PyErr_Occurred()) == 0) {
<a name="l01936"></a>01936             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1c17e2e341892673941345bbe80cbeb8">matrix_mul_float</a>(mat2, scalar);
<a name="l01937"></a>01937         }
<a name="l01938"></a>01938     }
<a name="l01939"></a>01939     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mat1) {
<a name="l01940"></a>01940         <span class="comment">/* MATRIX * VECTOR */</span>
<a name="l01941"></a>01941         <span class="keywordflow">if</span> (<a class="code" href="../../dc/d11/mathutils__Vector_8h.html#ab57bd802e719b0adf0f8511cbfa38d8c">VectorObject_Check</a>(m2)) {
<a name="l01942"></a>01942             <a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *vec2 = (<a class="code" href="../../d6/ddb/structVectorObject.html">VectorObject</a> *)m2;
<a name="l01943"></a>01943             <span class="keywordtype">float</span> tvec[4];
<a name="l01944"></a>01944             <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(vec2) == -1)
<a name="l01945"></a>01945                 <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01946"></a>01946             <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#a36446edecca3d909f0ea53e1aca7dda7">column_vector_multiplication</a>(tvec, vec2, mat1) == -1) {
<a name="l01947"></a>01947                 <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01948"></a>01948             }
<a name="l01949"></a>01949 
<a name="l01950"></a>01950             <span class="keywordflow">if</span> (mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a> == 4 &amp;&amp; vec2-&gt;<a class="code" href="../../d6/ddb/structVectorObject.html#ac89291eafee981d627bc5b514e8acbaa">size</a> == 3) {
<a name="l01951"></a>01951                 vec_size = 3;
<a name="l01952"></a>01952             }
<a name="l01953"></a>01953             <span class="keywordflow">else</span> {
<a name="l01954"></a>01954                 vec_size = mat1-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>;
<a name="l01955"></a>01955             }
<a name="l01956"></a>01956 
<a name="l01957"></a>01957             <span class="keywordflow">return</span> <a class="code" href="../../da/d49/mathutils__Vector_8c.html#aa26668c535dbe9c2d2b96259557a1be3">Vector_CreatePyObject</a>(tvec, vec_size, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, Py_TYPE(m2));
<a name="l01958"></a>01958         }
<a name="l01959"></a>01959         <span class="comment">/*FLOAT/INT * MATRIX */</span>
<a name="l01960"></a>01960         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((scalar = PyFloat_AsDouble(m2)) == -1.0f &amp;&amp; PyErr_Occurred()) == 0) {
<a name="l01961"></a>01961             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1c17e2e341892673941345bbe80cbeb8">matrix_mul_float</a>(mat1, scalar);
<a name="l01962"></a>01962         }
<a name="l01963"></a>01963     }
<a name="l01964"></a>01964     <span class="keywordflow">else</span> {
<a name="l01965"></a>01965         <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa0fb403a3d83d016acdc506b2d4607cb">BLI_assert</a>(!<span class="stringliteral">&quot;internal error&quot;</span>);
<a name="l01966"></a>01966     }
<a name="l01967"></a>01967 
<a name="l01968"></a>01968     PyErr_Format(PyExc_TypeError,
<a name="l01969"></a>01969                  <span class="stringliteral">&quot;Matrix multiplication: &quot;</span>
<a name="l01970"></a>01970                  <span class="stringliteral">&quot;not supported between &#39;%.200s&#39; and &#39;%.200s&#39; types&quot;</span>,
<a name="l01971"></a>01971                  Py_TYPE(m1)-&gt;tp_name, Py_TYPE(m2)-&gt;tp_name);
<a name="l01972"></a>01972     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01973"></a>01973 }
<a name="l01974"></a>01974 
<a name="l01975"></a>01975 <span class="comment">/*-----------------PROTOCOL DECLARATIONS--------------------------*/</span>
<a name="l01976"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7d4360fdc29c3f61d4ed3ba5aed6142e">01976</a> <span class="keyword">static</span> PySequenceMethods <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7d4360fdc29c3f61d4ed3ba5aed6142e">Matrix_SeqMethods</a> = {
<a name="l01977"></a>01977     (lenfunc) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0855a4cea795fc178abdd0b0130c9683">Matrix_len</a>,                       <span class="comment">/* sq_length */</span>
<a name="l01978"></a>01978     (binaryfunc) <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                          <span class="comment">/* sq_concat */</span>
<a name="l01979"></a>01979     (ssizeargfunc) <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                        <span class="comment">/* sq_repeat */</span>
<a name="l01980"></a>01980     (ssizeargfunc) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a6e82bf144bb6972d2ff0672f05cbff">Matrix_item_row</a>,             <span class="comment">/* sq_item */</span>
<a name="l01981"></a>01981     (ssizessizeargfunc) <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                   <span class="comment">/* sq_slice, deprecated */</span>
<a name="l01982"></a>01982     (ssizeobjargproc) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9833c1a8ccc585bb37d18be005056c03">Matrix_ass_item_row</a>,      <span class="comment">/* sq_ass_item */</span>
<a name="l01983"></a>01983     (ssizessizeobjargproc) <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                <span class="comment">/* sq_ass_slice, deprecated */</span>
<a name="l01984"></a>01984     (objobjproc) <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                          <span class="comment">/* sq_contains */</span>
<a name="l01985"></a>01985     (binaryfunc) <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                          <span class="comment">/* sq_inplace_concat */</span>
<a name="l01986"></a>01986     (ssizeargfunc) <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                        <span class="comment">/* sq_inplace_repeat */</span>
<a name="l01987"></a>01987 };
<a name="l01988"></a>01988 
<a name="l01989"></a>01989 
<a name="l01990"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7fda606e0b6cdd5d80342979a27cb854">01990</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7fda606e0b6cdd5d80342979a27cb854">Matrix_subscript</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *item)
<a name="l01991"></a>01991 {
<a name="l01992"></a>01992     <span class="keywordflow">if</span> (PyIndex_Check(item)) {
<a name="l01993"></a>01993         Py_ssize_t <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l01994"></a>01994         i = PyNumber_AsSsize_t(item, PyExc_IndexError);
<a name="l01995"></a>01995         <span class="keywordflow">if</span> (i == -1 &amp;&amp; PyErr_Occurred())
<a name="l01996"></a>01996             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01997"></a>01997         <span class="keywordflow">if</span> (i &lt; 0)
<a name="l01998"></a>01998             i += <span class="keyword">self</span>-&gt;num_row;
<a name="l01999"></a>01999         <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a6e82bf144bb6972d2ff0672f05cbff">Matrix_item_row</a>(<span class="keyword">self</span>, i);
<a name="l02000"></a>02000     }
<a name="l02001"></a>02001     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PySlice_Check(item)) {
<a name="l02002"></a>02002         Py_ssize_t start, stop, <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>, slicelength;
<a name="l02003"></a>02003 
<a name="l02004"></a>02004         <span class="keywordflow">if</span> (PySlice_GetIndicesEx((<span class="keywordtype">void</span> *)item, self-&gt;num_row, &amp;start, &amp;stop, &amp;step, &amp;slicelength) &lt; 0)
<a name="l02005"></a>02005             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02006"></a>02006 
<a name="l02007"></a>02007         <span class="keywordflow">if</span> (slicelength &lt;= 0) {
<a name="l02008"></a>02008             <span class="keywordflow">return</span> PyTuple_New(0);
<a name="l02009"></a>02009         }
<a name="l02010"></a>02010         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (step == 1) {
<a name="l02011"></a>02011             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afa360a0fee05afc179d3dec141f08093">Matrix_slice</a>(<span class="keyword">self</span>, start, stop);
<a name="l02012"></a>02012         }
<a name="l02013"></a>02013         <span class="keywordflow">else</span> {
<a name="l02014"></a>02014             PyErr_SetString(PyExc_IndexError,
<a name="l02015"></a>02015                             <span class="stringliteral">&quot;slice steps not supported with matrices&quot;</span>);
<a name="l02016"></a>02016             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02017"></a>02017         }
<a name="l02018"></a>02018     }
<a name="l02019"></a>02019     <span class="keywordflow">else</span> {
<a name="l02020"></a>02020         PyErr_Format(PyExc_TypeError,
<a name="l02021"></a>02021                      <span class="stringliteral">&quot;matrix indices must be integers, not %.200s&quot;</span>,
<a name="l02022"></a>02022                      Py_TYPE(item)-&gt;tp_name);
<a name="l02023"></a>02023         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02024"></a>02024     }
<a name="l02025"></a>02025 }
<a name="l02026"></a>02026 
<a name="l02027"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a26014879ec6a0b09c523ecc0ccf68e65">02027</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a26014879ec6a0b09c523ecc0ccf68e65">Matrix_ass_subscript</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *item, PyObject *value)
<a name="l02028"></a>02028 {
<a name="l02029"></a>02029     <span class="keywordflow">if</span> (PyIndex_Check(item)) {
<a name="l02030"></a>02030         Py_ssize_t <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = PyNumber_AsSsize_t(item, PyExc_IndexError);
<a name="l02031"></a>02031         <span class="keywordflow">if</span> (i == -1 &amp;&amp; PyErr_Occurred())
<a name="l02032"></a>02032             <span class="keywordflow">return</span> -1;
<a name="l02033"></a>02033         <span class="keywordflow">if</span> (i &lt; 0)
<a name="l02034"></a>02034             i += <span class="keyword">self</span>-&gt;num_row;
<a name="l02035"></a>02035         <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9833c1a8ccc585bb37d18be005056c03">Matrix_ass_item_row</a>(<span class="keyword">self</span>, i, value);
<a name="l02036"></a>02036     }
<a name="l02037"></a>02037     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PySlice_Check(item)) {
<a name="l02038"></a>02038         Py_ssize_t start, stop, <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>, slicelength;
<a name="l02039"></a>02039 
<a name="l02040"></a>02040         <span class="keywordflow">if</span> (PySlice_GetIndicesEx((<span class="keywordtype">void</span> *)item, self-&gt;num_row, &amp;start, &amp;stop, &amp;step, &amp;slicelength) &lt; 0)
<a name="l02041"></a>02041             <span class="keywordflow">return</span> -1;
<a name="l02042"></a>02042 
<a name="l02043"></a>02043         <span class="keywordflow">if</span> (step == 1)
<a name="l02044"></a>02044             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aaa20df67c1252e1f57889f098981b370">Matrix_ass_slice</a>(<span class="keyword">self</span>, start, stop, value);
<a name="l02045"></a>02045         <span class="keywordflow">else</span> {
<a name="l02046"></a>02046             PyErr_SetString(PyExc_IndexError,
<a name="l02047"></a>02047                             <span class="stringliteral">&quot;slice steps not supported with matrices&quot;</span>);
<a name="l02048"></a>02048             <span class="keywordflow">return</span> -1;
<a name="l02049"></a>02049         }
<a name="l02050"></a>02050     }
<a name="l02051"></a>02051     <span class="keywordflow">else</span> {
<a name="l02052"></a>02052         PyErr_Format(PyExc_TypeError,
<a name="l02053"></a>02053                      <span class="stringliteral">&quot;matrix indices must be integers, not %.200s&quot;</span>,
<a name="l02054"></a>02054                      Py_TYPE(item)-&gt;tp_name);
<a name="l02055"></a>02055         <span class="keywordflow">return</span> -1;
<a name="l02056"></a>02056     }
<a name="l02057"></a>02057 }
<a name="l02058"></a>02058 
<a name="l02059"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8f926e4e0687a56a4fec00d37524c49b">02059</a> <span class="keyword">static</span> PyMappingMethods <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8f926e4e0687a56a4fec00d37524c49b">Matrix_AsMapping</a> = {
<a name="l02060"></a>02060     (lenfunc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0855a4cea795fc178abdd0b0130c9683">Matrix_len</a>,
<a name="l02061"></a>02061     (binaryfunc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7fda606e0b6cdd5d80342979a27cb854">Matrix_subscript</a>,
<a name="l02062"></a>02062     (objobjargproc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a26014879ec6a0b09c523ecc0ccf68e65">Matrix_ass_subscript</a>
<a name="l02063"></a>02063 };
<a name="l02064"></a>02064 
<a name="l02065"></a>02065 
<a name="l02066"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a76dbfb701257d5a919f4593f064f059c">02066</a> <span class="keyword">static</span> PyNumberMethods <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a76dbfb701257d5a919f4593f064f059c">Matrix_NumMethods</a> = {
<a name="l02067"></a>02067     (binaryfunc)    <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a401ec48e98f9647cdd35927801d3dc2d">Matrix_add</a>,     <span class="comment">/*nb_add*/</span>
<a name="l02068"></a>02068     (binaryfunc)    <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af2d45a7eb8daf11ec5427cc24ac10752">Matrix_sub</a>,     <span class="comment">/*nb_subtract*/</span>
<a name="l02069"></a>02069     (binaryfunc)    <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4d76ec3359b89f86d5de40039f1686cd">Matrix_mul</a>,     <span class="comment">/*nb_multiply*/</span>
<a name="l02070"></a>02070     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*nb_remainder*/</span>
<a name="l02071"></a>02071     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*nb_divmod*/</span>
<a name="l02072"></a>02072     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*nb_power*/</span>
<a name="l02073"></a>02073     (unaryfunc)     0,      <span class="comment">/*nb_negative*/</span>
<a name="l02074"></a>02074     (unaryfunc)     0,      <span class="comment">/*tp_positive*/</span>
<a name="l02075"></a>02075     (unaryfunc)     0,      <span class="comment">/*tp_absolute*/</span>
<a name="l02076"></a>02076     (inquiry)   0,      <span class="comment">/*tp_bool*/</span>
<a name="l02077"></a>02077     (unaryfunc) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a934b0d7bebcc92206d8bb1cba129ed">Matrix_inverted</a>,        <span class="comment">/*nb_invert*/</span>
<a name="l02078"></a>02078     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                   <span class="comment">/*nb_lshift*/</span>
<a name="l02079"></a>02079     (binaryfunc)0,      <span class="comment">/*nb_rshift*/</span>
<a name="l02080"></a>02080     NULL,                   <span class="comment">/*nb_and*/</span>
<a name="l02081"></a>02081     NULL,                   <span class="comment">/*nb_xor*/</span>
<a name="l02082"></a>02082     NULL,                   <span class="comment">/*nb_or*/</span>
<a name="l02083"></a>02083     NULL,                   <span class="comment">/*nb_int*/</span>
<a name="l02084"></a>02084     NULL,                   <span class="comment">/*nb_reserved*/</span>
<a name="l02085"></a>02085     NULL,                   <span class="comment">/*nb_float*/</span>
<a name="l02086"></a>02086     NULL,                   <span class="comment">/* nb_inplace_add */</span>
<a name="l02087"></a>02087     NULL,                   <span class="comment">/* nb_inplace_subtract */</span>
<a name="l02088"></a>02088     NULL,                   <span class="comment">/* nb_inplace_multiply */</span>
<a name="l02089"></a>02089     NULL,                   <span class="comment">/* nb_inplace_remainder */</span>
<a name="l02090"></a>02090     NULL,                   <span class="comment">/* nb_inplace_power */</span>
<a name="l02091"></a>02091     NULL,                   <span class="comment">/* nb_inplace_lshift */</span>
<a name="l02092"></a>02092     NULL,                   <span class="comment">/* nb_inplace_rshift */</span>
<a name="l02093"></a>02093     NULL,                   <span class="comment">/* nb_inplace_and */</span>
<a name="l02094"></a>02094     NULL,                   <span class="comment">/* nb_inplace_xor */</span>
<a name="l02095"></a>02095     NULL,                   <span class="comment">/* nb_inplace_or */</span>
<a name="l02096"></a>02096     NULL,                   <span class="comment">/* nb_floor_divide */</span>
<a name="l02097"></a>02097     NULL,                   <span class="comment">/* nb_true_divide */</span>
<a name="l02098"></a>02098     NULL,                   <span class="comment">/* nb_inplace_floor_divide */</span>
<a name="l02099"></a>02099     NULL,                   <span class="comment">/* nb_inplace_true_divide */</span>
<a name="l02100"></a>02100     NULL,                   <span class="comment">/* nb_index */</span>
<a name="l02101"></a>02101 };
<a name="l02102"></a>02102 
<a name="l02103"></a>02103 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_translation_doc,
<a name="l02104"></a>02104 <span class="stringliteral">&quot;The translation component of the matrix.\n\n:type: Vector&quot;</span>
<a name="l02105"></a>02105 );
<a name="l02106"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a3279aef32b8c0f9b49071d528c82edd2">02106</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a3279aef32b8c0f9b49071d528c82edd2">Matrix_translation_get</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02107"></a>02107 {
<a name="l02108"></a>02108     PyObject *ret;
<a name="l02109"></a>02109 
<a name="l02110"></a>02110     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l02111"></a>02111         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02112"></a>02112 
<a name="l02113"></a>02113     <span class="comment">/*must be 4x4 square matrix*/</span>
<a name="l02114"></a>02114     <span class="keywordflow">if</span> (self-&gt;num_row != 4 || self-&gt;num_col != 4) {
<a name="l02115"></a>02115         PyErr_SetString(PyExc_AttributeError,
<a name="l02116"></a>02116                         <span class="stringliteral">&quot;Matrix.translation: &quot;</span>
<a name="l02117"></a>02117                         <span class="stringliteral">&quot;inappropriate matrix size, must be 4x4&quot;</span>);
<a name="l02118"></a>02118         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02119"></a>02119     }
<a name="l02120"></a>02120 
<a name="l02121"></a>02121     ret = (PyObject *)<a class="code" href="../../da/d49/mathutils__Vector_8c.html#a1938e489497f1f80418a62a4084d4695">Vector_CreatePyObject_cb</a>((PyObject *)<span class="keyword">self</span>, 3, <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1d69cf6e5c017ba6cec8f6434e6c0073">mathutils_matrix_translation_cb_index</a>, 3);
<a name="l02122"></a>02122 
<a name="l02123"></a>02123     <span class="keywordflow">return</span> ret;
<a name="l02124"></a>02124 }
<a name="l02125"></a>02125 
<a name="l02126"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a371d447651ed466eca69bdefcbb29982">02126</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a371d447651ed466eca69bdefcbb29982">Matrix_translation_set</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, PyObject *value, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02127"></a>02127 {
<a name="l02128"></a>02128     <span class="keywordtype">float</span> tvec[3];
<a name="l02129"></a>02129 
<a name="l02130"></a>02130     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l02131"></a>02131         <span class="keywordflow">return</span> -1;
<a name="l02132"></a>02132 
<a name="l02133"></a>02133     <span class="comment">/*must be 4x4 square matrix*/</span>
<a name="l02134"></a>02134     <span class="keywordflow">if</span> (self-&gt;num_row != 4 || self-&gt;num_col != 4) {
<a name="l02135"></a>02135         PyErr_SetString(PyExc_AttributeError,
<a name="l02136"></a>02136                         <span class="stringliteral">&quot;Matrix.translation: &quot;</span>
<a name="l02137"></a>02137                         <span class="stringliteral">&quot;inappropriate matrix size, must be 4x4&quot;</span>);
<a name="l02138"></a>02138         <span class="keywordflow">return</span> -1;
<a name="l02139"></a>02139     }
<a name="l02140"></a>02140 
<a name="l02141"></a>02141     <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d8a/mathutils_8c.html#aaff7a3f480a3d1e885e88429e36122f5">mathutils_array_parse</a>(tvec, 3, 3, value, <span class="stringliteral">&quot;Matrix.translation&quot;</span>)) == -1) {
<a name="l02142"></a>02142         <span class="keywordflow">return</span> -1;
<a name="l02143"></a>02143     }
<a name="l02144"></a>02144 
<a name="l02145"></a>02145     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix)[3], tvec);
<a name="l02146"></a>02146 
<a name="l02147"></a>02147     (void)<a class="code" href="../../dc/d58/mathutils_8h.html#a5f7564b9bdecda052d6c8570a0752d1b">BaseMath_WriteCallback</a>(<span class="keyword">self</span>);
<a name="l02148"></a>02148 
<a name="l02149"></a>02149     <span class="keywordflow">return</span> 0;
<a name="l02150"></a>02150 }
<a name="l02151"></a>02151 
<a name="l02152"></a>02152 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_row_doc,
<a name="l02153"></a>02153 <span class="stringliteral">&quot;Access the matix by rows (default), (read-only).\n\n:type: Matrix Access&quot;</span>
<a name="l02154"></a>02154 );
<a name="l02155"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a5531909a775c59ad1b2f117d028c9a85">02155</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a5531909a775c59ad1b2f117d028c9a85">Matrix_row_get</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02156"></a>02156 {
<a name="l02157"></a>02157     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af9ec52581bc346b73e59d0b750c14e14">MatrixAccess_CreatePyObject</a>(<span class="keyword">self</span>, <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a585b2e9c32e993b2c062699ee75be05d">MAT_ACCESS_ROW</a>);
<a name="l02158"></a>02158 }
<a name="l02159"></a>02159 
<a name="l02160"></a>02160 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_col_doc,
<a name="l02161"></a>02161 <span class="stringliteral">&quot;Access the matix by colums, 3x3 and 4x4 only, (read-only).\n\n:type: Matrix Access&quot;</span>
<a name="l02162"></a>02162 );
<a name="l02163"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a784cbbf07b2a96591f68c7690e8130c1">02163</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a784cbbf07b2a96591f68c7690e8130c1">Matrix_col_get</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02164"></a>02164 {
<a name="l02165"></a>02165     <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af9ec52581bc346b73e59d0b750c14e14">MatrixAccess_CreatePyObject</a>(<span class="keyword">self</span>, <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a8d04ef4260d23ba4e228cc78f6e64930">MAT_ACCESS_COL</a>);
<a name="l02166"></a>02166 }
<a name="l02167"></a>02167 
<a name="l02168"></a>02168 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_median_scale_doc,
<a name="l02169"></a>02169 <span class="stringliteral">&quot;The average scale applied to each axis (read-only).\n\n:type: float&quot;</span>
<a name="l02170"></a>02170 );
<a name="l02171"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7a0244ae57a74e826da1562fa47d1f32">02171</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7a0244ae57a74e826da1562fa47d1f32">Matrix_median_scale_get</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02172"></a>02172 {
<a name="l02173"></a>02173     <span class="keywordtype">float</span> mat[3][3];
<a name="l02174"></a>02174 
<a name="l02175"></a>02175     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l02176"></a>02176         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02177"></a>02177 
<a name="l02178"></a>02178     <span class="comment">/*must be 3-4 cols, 3-4 rows, square matrix*/</span>
<a name="l02179"></a>02179     <span class="keywordflow">if</span> ((self-&gt;num_row &lt; 3) || (self-&gt;num_col &lt; 3)) {
<a name="l02180"></a>02180         PyErr_SetString(PyExc_AttributeError,
<a name="l02181"></a>02181                         <span class="stringliteral">&quot;Matrix.median_scale: &quot;</span>
<a name="l02182"></a>02182                         <span class="stringliteral">&quot;inappropriate matrix size, 3x3 minimum&quot;</span>);
<a name="l02183"></a>02183         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02184"></a>02184     }
<a name="l02185"></a>02185 
<a name="l02186"></a>02186     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8b433695865df09a00df205c0b1fc18c">matrix_as_3x3</a>(mat, <span class="keyword">self</span>);
<a name="l02187"></a>02187 
<a name="l02188"></a>02188     <span class="keywordflow">return</span> PyFloat_FromDouble(<a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a816ef9156767c849868a38c5b6bfff95">mat3_to_scale</a>(mat));
<a name="l02189"></a>02189 }
<a name="l02190"></a>02190 
<a name="l02191"></a>02191 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_is_negative_doc,
<a name="l02192"></a>02192 <span class="stringliteral">&quot;True if this matrix results in a negative scale, 3x3 and 4x4 only, (read-only).\n\n:type: bool&quot;</span>
<a name="l02193"></a>02193 );
<a name="l02194"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aa77ac7ca27277a397f692cf5df80b61f">02194</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aa77ac7ca27277a397f692cf5df80b61f">Matrix_is_negative_get</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02195"></a>02195 {
<a name="l02196"></a>02196     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l02197"></a>02197         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02198"></a>02198 
<a name="l02199"></a>02199     <span class="comment">/*must be 3-4 cols, 3-4 rows, square matrix*/</span>
<a name="l02200"></a>02200     <span class="keywordflow">if</span> (self-&gt;num_row == 4 &amp;&amp; self-&gt;num_col == 4)
<a name="l02201"></a>02201         <span class="keywordflow">return</span> PyBool_FromLong(<a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a6f80f6c6c2dfac5c69d2a27d06d18c23">is_negative_m4</a>((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix));
<a name="l02202"></a>02202     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_row == 3 &amp;&amp; self-&gt;num_col == 3)
<a name="l02203"></a>02203         <span class="keywordflow">return</span> PyBool_FromLong(<a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#aa4ece253a1c6292a85c025ab88ee910c">is_negative_m3</a>((<span class="keywordtype">float</span> (*)[3])self-&gt;matrix));
<a name="l02204"></a>02204     <span class="keywordflow">else</span> {
<a name="l02205"></a>02205         PyErr_SetString(PyExc_AttributeError,
<a name="l02206"></a>02206                         <span class="stringliteral">&quot;Matrix.is_negative: &quot;</span>
<a name="l02207"></a>02207                         <span class="stringliteral">&quot;inappropriate matrix size - expects 3x3 or 4x4 matrix&quot;</span>);
<a name="l02208"></a>02208         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02209"></a>02209     }
<a name="l02210"></a>02210 }
<a name="l02211"></a>02211 
<a name="l02212"></a>02212 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_is_orthogonal_doc,
<a name="l02213"></a>02213 <span class="stringliteral">&quot;True if this matrix is orthogonal, 3x3 and 4x4 only, (read-only).\n\n:type: bool&quot;</span>
<a name="l02214"></a>02214 );
<a name="l02215"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a75e2d4204cf08b029e099d35c2b71362">02215</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a75e2d4204cf08b029e099d35c2b71362">Matrix_is_orthogonal_get</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02216"></a>02216 {
<a name="l02217"></a>02217     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l02218"></a>02218         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02219"></a>02219 
<a name="l02220"></a>02220     <span class="comment">/*must be 3-4 cols, 3-4 rows, square matrix*/</span>
<a name="l02221"></a>02221     <span class="keywordflow">if</span> (self-&gt;num_row == 4 &amp;&amp; self-&gt;num_col == 4)
<a name="l02222"></a>02222         <span class="keywordflow">return</span> PyBool_FromLong(<a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a7d6349c81d854c4276ed105f170228f8">is_orthonormal_m4</a>((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix));
<a name="l02223"></a>02223     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_row == 3 &amp;&amp; self-&gt;num_col == 3)
<a name="l02224"></a>02224         <span class="keywordflow">return</span> PyBool_FromLong(<a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ab6d35830708b5489b76be0812f505b23">is_orthonormal_m3</a>((<span class="keywordtype">float</span> (*)[3])self-&gt;matrix));
<a name="l02225"></a>02225     <span class="keywordflow">else</span> {
<a name="l02226"></a>02226         PyErr_SetString(PyExc_AttributeError,
<a name="l02227"></a>02227                         <span class="stringliteral">&quot;Matrix.is_orthogonal: &quot;</span>
<a name="l02228"></a>02228                         <span class="stringliteral">&quot;inappropriate matrix size - expects 3x3 or 4x4 matrix&quot;</span>);
<a name="l02229"></a>02229         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02230"></a>02230     }
<a name="l02231"></a>02231 }
<a name="l02232"></a>02232 
<a name="l02233"></a>02233 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(Matrix_is_orthogonal_axis_vectors_doc,
<a name="l02234"></a>02234 <span class="stringliteral">&quot;True if this matrix has got orthogonal axis vectors, 3x3 and 4x4 only, (read-only).\n\n:type: bool&quot;</span>
<a name="l02235"></a>02235 );
<a name="l02236"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7cded7b06b7ca7024a149b32c53647b1">02236</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7cded7b06b7ca7024a149b32c53647b1">Matrix_is_orthogonal_axis_vectors_get</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(closure))
<a name="l02237"></a>02237 {
<a name="l02238"></a>02238     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d58/mathutils_8h.html#af636011ae03e771a9ed36746582293de">BaseMath_ReadCallback</a>(<span class="keyword">self</span>) == -1)
<a name="l02239"></a>02239         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02240"></a>02240 
<a name="l02241"></a>02241     <span class="comment">/*must be 3-4 cols, 3-4 rows, square matrix*/</span>
<a name="l02242"></a>02242     <span class="keywordflow">if</span> (self-&gt;num_row == 4 &amp;&amp; self-&gt;num_col == 4)
<a name="l02243"></a>02243         <span class="keywordflow">return</span> PyBool_FromLong(<a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2a9290661aac1c0b4ed37f786515bc34">is_orthogonal_m4</a>((<span class="keywordtype">float</span> (*)[4])self-&gt;matrix));
<a name="l02244"></a>02244     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;num_row == 3 &amp;&amp; self-&gt;num_col == 3)
<a name="l02245"></a>02245         <span class="keywordflow">return</span> PyBool_FromLong(<a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a7208eaeee4d884ef0815d7a3f987fc65">is_orthogonal_m3</a>((<span class="keywordtype">float</span> (*)[3])self-&gt;matrix));
<a name="l02246"></a>02246     <span class="keywordflow">else</span> {
<a name="l02247"></a>02247         PyErr_SetString(PyExc_AttributeError,
<a name="l02248"></a>02248                         <span class="stringliteral">&quot;Matrix.is_orthogonal_axis_vectors: &quot;</span>
<a name="l02249"></a>02249                         <span class="stringliteral">&quot;inappropriate matrix size - expects 3x3 or 4x4 matrix&quot;</span>);
<a name="l02250"></a>02250         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02251"></a>02251     }
<a name="l02252"></a>02252 }
<a name="l02253"></a>02253 
<a name="l02254"></a>02254 <span class="comment">/*****************************************************************************/</span>
<a name="l02255"></a>02255 <span class="comment">/* Python attributes get/set structure:                                      */</span>
<a name="l02256"></a>02256 <span class="comment">/*****************************************************************************/</span>
<a name="l02257"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0e0f3b9d5571ade698fce58d06496231">02257</a> <span class="keyword">static</span> PyGetSetDef <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0e0f3b9d5571ade698fce58d06496231">Matrix_getseters</a>[] = {
<a name="l02258"></a>02258     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;median_scale&quot;</span>, (getter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7a0244ae57a74e826da1562fa47d1f32">Matrix_median_scale_get</a>, (setter)NULL, Matrix_median_scale_doc, NULL},
<a name="l02259"></a>02259     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;translation&quot;</span>, (getter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a3279aef32b8c0f9b49071d528c82edd2">Matrix_translation_get</a>, (setter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a371d447651ed466eca69bdefcbb29982">Matrix_translation_set</a>, Matrix_translation_doc, NULL},
<a name="l02260"></a>02260     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;row&quot;</span>, (getter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a5531909a775c59ad1b2f117d028c9a85">Matrix_row_get</a>, (setter)NULL, Matrix_row_doc, NULL},
<a name="l02261"></a>02261     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;col&quot;</span>, (getter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a784cbbf07b2a96591f68c7690e8130c1">Matrix_col_get</a>, (setter)NULL, Matrix_col_doc, NULL},
<a name="l02262"></a>02262     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;is_negative&quot;</span>, (getter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aa77ac7ca27277a397f692cf5df80b61f">Matrix_is_negative_get</a>, (setter)NULL, Matrix_is_negative_doc, NULL},
<a name="l02263"></a>02263     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;is_orthogonal&quot;</span>, (getter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a75e2d4204cf08b029e099d35c2b71362">Matrix_is_orthogonal_get</a>, (setter)NULL, Matrix_is_orthogonal_doc, NULL},
<a name="l02264"></a>02264     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;is_orthogonal_axis_vectors&quot;</span>, (getter)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7cded7b06b7ca7024a149b32c53647b1">Matrix_is_orthogonal_axis_vectors_get</a>, (setter)NULL, Matrix_is_orthogonal_axis_vectors_doc, NULL},
<a name="l02265"></a>02265     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;is_wrapped&quot;</span>, (getter)<a class="code" href="../../d1/d8a/mathutils_8c.html#a32db0438411e250bc47f55cf7f32124e">BaseMathObject_is_wrapped_get</a>, (setter)NULL, <a class="code" href="../../d1/d8a/mathutils_8c.html#aa29c52bca0256c854d0505eaea6c5539">BaseMathObject_is_wrapped_doc</a>, NULL},
<a name="l02266"></a>02266     {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;owner&quot;</span>, (getter)<a class="code" href="../../d1/d8a/mathutils_8c.html#a98db0c3b8d2329008988674a3dde0f6c">BaseMathObject_owner_get</a>, (setter)NULL, <a class="code" href="../../d1/d8a/mathutils_8c.html#ad72003b509db13ee50f0a0a649ab329a">BaseMathObject_owner_doc</a>, NULL},
<a name="l02267"></a>02267     {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}  <span class="comment">/* Sentinel */</span>
<a name="l02268"></a>02268 };
<a name="l02269"></a>02269 
<a name="l02270"></a>02270 <span class="comment">/*-----------------------METHOD DEFINITIONS ----------------------*/</span>
<a name="l02271"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae1a82bb44e8f85ade0c16639de55055e">02271</a> <span class="keyword">static</span> <span class="keyword">struct </span>PyMethodDef <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae1a82bb44e8f85ade0c16639de55055e">Matrix_methods</a>[] = {
<a name="l02272"></a>02272     <span class="comment">/* derived values */</span>
<a name="l02273"></a>02273     {<span class="stringliteral">&quot;determinant&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af1144607b981eca9a2deba77f2aef4f1">Matrix_determinant</a>, METH_NOARGS, Matrix_determinant_doc},
<a name="l02274"></a>02274     {<span class="stringliteral">&quot;decompose&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7f9341b1f5ceaddf009c6dbd86c3ee8a">Matrix_decompose</a>, METH_NOARGS, Matrix_decompose_doc},
<a name="l02275"></a>02275 
<a name="l02276"></a>02276     <span class="comment">/* in place only */</span>
<a name="l02277"></a>02277     {<span class="stringliteral">&quot;zero&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae5cd901bfb114910e5837911908bfedd">Matrix_zero</a>, METH_NOARGS, Matrix_zero_doc},
<a name="l02278"></a>02278     {<span class="stringliteral">&quot;identity&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afa4a4a8c9f200ca2a32369f906c61cdb">Matrix_identity</a>, METH_NOARGS, Matrix_identity_doc},
<a name="l02279"></a>02279 
<a name="l02280"></a>02280     <span class="comment">/* operate on original or copy */</span>
<a name="l02281"></a>02281     {<span class="stringliteral">&quot;transpose&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ae7af993ac7a6ed090e900b69f10e8741">Matrix_transpose</a>, METH_NOARGS, Matrix_transpose_doc},
<a name="l02282"></a>02282     {<span class="stringliteral">&quot;transposed&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a779543b992f6565d84fa8f8296710a54">Matrix_transposed</a>, METH_NOARGS, Matrix_transposed_doc},
<a name="l02283"></a>02283     {<span class="stringliteral">&quot;invert&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a41ae5180b1736341e4bd846ea6dee7c1">Matrix_invert</a>, METH_NOARGS, Matrix_invert_doc},
<a name="l02284"></a>02284     {<span class="stringliteral">&quot;inverted&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a934b0d7bebcc92206d8bb1cba129ed">Matrix_inverted</a>, METH_NOARGS, Matrix_inverted_doc},
<a name="l02285"></a>02285     {<span class="stringliteral">&quot;to_3x3&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a61ca5f46c3962c0a011d4f57ea53aeed">Matrix_to_3x3</a>, METH_NOARGS, Matrix_to_3x3_doc},
<a name="l02286"></a>02286     <span class="comment">// TODO. {&quot;resize_3x3&quot;, (PyCFunction) Matrix_resize3x3, METH_NOARGS, Matrix_resize3x3_doc},</span>
<a name="l02287"></a>02287     {<span class="stringliteral">&quot;to_4x4&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0f3c5135ec850a07b4e0e10c9e82d138">Matrix_to_4x4</a>, METH_NOARGS, Matrix_to_4x4_doc},
<a name="l02288"></a>02288     {<span class="stringliteral">&quot;resize_4x4&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a24633adf095ccdd6b8f46148b4fbdffa">Matrix_resize_4x4</a>, METH_NOARGS, Matrix_resize_4x4_doc},
<a name="l02289"></a>02289     {<span class="stringliteral">&quot;rotate&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a89ede5d1867042352d614b3ecc616300">Matrix_rotate</a>, METH_O, Matrix_rotate_doc},
<a name="l02290"></a>02290 
<a name="l02291"></a>02291     <span class="comment">/* return converted representation */</span>
<a name="l02292"></a>02292     {<span class="stringliteral">&quot;to_euler&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a317c398f4050730a968bb4150a1d70ab">Matrix_to_euler</a>, METH_VARARGS, Matrix_to_euler_doc},
<a name="l02293"></a>02293     {<span class="stringliteral">&quot;to_quaternion&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4c2aae5ba72b2535a4c6c56187bbf802">Matrix_to_quaternion</a>, METH_NOARGS, Matrix_to_quaternion_doc},
<a name="l02294"></a>02294     {<span class="stringliteral">&quot;to_scale&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac60f49994048b84779a64f944a45cfad">Matrix_to_scale</a>, METH_NOARGS, Matrix_to_scale_doc},
<a name="l02295"></a>02295     {<span class="stringliteral">&quot;to_translation&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad4ca3f54fc1154c48161ca48081a6af7">Matrix_to_translation</a>, METH_NOARGS, Matrix_to_translation_doc},
<a name="l02296"></a>02296 
<a name="l02297"></a>02297     <span class="comment">/* operation between 2 or more types  */</span>
<a name="l02298"></a>02298     {<span class="stringliteral">&quot;lerp&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0f4b4483f6bb4f82a82444fe616a3a7f">Matrix_lerp</a>, METH_VARARGS, Matrix_lerp_doc},
<a name="l02299"></a>02299     {<span class="stringliteral">&quot;copy&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8fe1a1fb59878b7028eb74fb83ddb8b6">Matrix_copy</a>, METH_NOARGS, Matrix_copy_doc},
<a name="l02300"></a>02300     {<span class="stringliteral">&quot;__copy__&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8fe1a1fb59878b7028eb74fb83ddb8b6">Matrix_copy</a>, METH_NOARGS, Matrix_copy_doc},
<a name="l02301"></a>02301     {<span class="stringliteral">&quot;__deepcopy__&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8865e678b22736b80ab0b381e96bd7b1">Matrix_deepcopy</a>, METH_VARARGS, Matrix_copy_doc},
<a name="l02302"></a>02302 
<a name="l02303"></a>02303     <span class="comment">/* class methods */</span>
<a name="l02304"></a>02304     {<span class="stringliteral">&quot;Identity&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0ab3422144434a6457a08579ecdb71bd">C_Matrix_Identity</a>, METH_VARARGS | METH_CLASS, C_Matrix_Identity_doc},
<a name="l02305"></a>02305     {<span class="stringliteral">&quot;Rotation&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7ab6550b331d52ee026916c7471f4ac4">C_Matrix_Rotation</a>, METH_VARARGS | METH_CLASS, C_Matrix_Rotation_doc},
<a name="l02306"></a>02306     {<span class="stringliteral">&quot;Scale&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a81d72c1957c32d1e3a4218f9af709d49">C_Matrix_Scale</a>, METH_VARARGS | METH_CLASS, C_Matrix_Scale_doc},
<a name="l02307"></a>02307     {<span class="stringliteral">&quot;Shear&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ad4e18a16965e3e503bbe11f5c1b48728">C_Matrix_Shear</a>, METH_VARARGS | METH_CLASS, C_Matrix_Shear_doc},
<a name="l02308"></a>02308     {<span class="stringliteral">&quot;Translation&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a774ff5eebcff5a146c15edb7c8fdbdc1">C_Matrix_Translation</a>, METH_O | METH_CLASS, C_Matrix_Translation_doc},
<a name="l02309"></a>02309     {<span class="stringliteral">&quot;OrthoProjection&quot;</span>, (PyCFunction) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a1aa206544425bf15feb96a733dcfcd2e">C_Matrix_OrthoProjection</a>,  METH_VARARGS | METH_CLASS, C_Matrix_OrthoProjection_doc},
<a name="l02310"></a>02310     {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, NULL}
<a name="l02311"></a>02311 };
<a name="l02312"></a>02312 
<a name="l02313"></a>02313 <span class="comment">/*------------------PY_OBECT DEFINITION--------------------------*/</span>
<a name="l02314"></a>02314 <a class="code" href="../../de/d06/bmesh__py__api_8c.html#a716e5042919257c41a4482fbf4151a0a">PyDoc_STRVAR</a>(matrix_doc,
<a name="l02315"></a>02315 <span class="stringliteral">&quot;This object gives access to Matrices in Blender.&quot;</span>
<a name="l02316"></a>02316 );
<a name="l02317"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#afcb36b111474c151c47f33c71cfaf0d2">02317</a> PyTypeObject <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afcb36b111474c151c47f33c71cfaf0d2">matrix_Type</a> = {
<a name="l02318"></a>02318     PyVarObject_HEAD_INIT(NULL, 0)
<a name="l02319"></a>02319     <span class="stringliteral">&quot;Matrix&quot;</span>,                           <span class="comment">/*tp_name*/</span>
<a name="l02320"></a>02320     <span class="keyword">sizeof</span>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a>),               <span class="comment">/*tp_basicsize*/</span>
<a name="l02321"></a>02321     0,                                  <span class="comment">/*tp_itemsize*/</span>
<a name="l02322"></a>02322     (destructor)<a class="code" href="../../d1/d8a/mathutils_8c.html#a5a537baabedb87e6e84fe936781c05e1">BaseMathObject_dealloc</a>, <span class="comment">/*tp_dealloc*/</span>
<a name="l02323"></a>02323     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_print*/</span>
<a name="l02324"></a>02324     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_getattr*/</span>
<a name="l02325"></a>02325     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_setattr*/</span>
<a name="l02326"></a>02326     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_compare*/</span>
<a name="l02327"></a>02327     (reprfunc) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a81a5c0b615ed9b4e982846800c93172c">Matrix_repr</a>,             <span class="comment">/*tp_repr*/</span>
<a name="l02328"></a>02328     &amp;Matrix_NumMethods,                 <span class="comment">/*tp_as_number*/</span>
<a name="l02329"></a>02329     &amp;<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a7d4360fdc29c3f61d4ed3ba5aed6142e">Matrix_SeqMethods</a>,                 <span class="comment">/*tp_as_sequence*/</span>
<a name="l02330"></a>02330     &amp;<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8f926e4e0687a56a4fec00d37524c49b">Matrix_AsMapping</a>,                  <span class="comment">/*tp_as_mapping*/</span>
<a name="l02331"></a>02331     NULL,                               <span class="comment">/*tp_hash*/</span>
<a name="l02332"></a>02332     NULL,                               <span class="comment">/*tp_call*/</span>
<a name="l02333"></a>02333     (reprfunc) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a54451413c717511325ab42be9f67d0e4">Matrix_str</a>,              <span class="comment">/*tp_str*/</span>
<a name="l02334"></a>02334     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_getattro*/</span>
<a name="l02335"></a>02335     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_setattro*/</span>
<a name="l02336"></a>02336     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_as_buffer*/</span>
<a name="l02337"></a>02337     Py_TPFLAGS_DEFAULT | Py_TPFLAGS_BASETYPE | Py_TPFLAGS_HAVE_GC, <span class="comment">/*tp_flags*/</span>
<a name="l02338"></a>02338     matrix_doc,                         <span class="comment">/*tp_doc*/</span>
<a name="l02339"></a>02339     (traverseproc)<a class="code" href="../../d1/d8a/mathutils_8c.html#af699179a609843bd249a6b180eefd5c3">BaseMathObject_traverse</a>,  <span class="comment">//tp_traverse</span>
<a name="l02340"></a>02340     (inquiry)<a class="code" href="../../d1/d8a/mathutils_8c.html#ae501c7ac2e51162496089b42eca14aba">BaseMathObject_clear</a>,  <span class="comment">//tp_clear</span>
<a name="l02341"></a>02341     (richcmpfunc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a189107ed2a49d203628252561c2b4472">Matrix_richcmpr</a>,       <span class="comment">/*tp_richcompare*/</span>
<a name="l02342"></a>02342     0,                                  <span class="comment">/*tp_weaklistoffset*/</span>
<a name="l02343"></a>02343     NULL,                               <span class="comment">/*tp_iter*/</span>
<a name="l02344"></a>02344     NULL,                               <span class="comment">/*tp_iternext*/</span>
<a name="l02345"></a>02345     Matrix_methods,                     <span class="comment">/*tp_methods*/</span>
<a name="l02346"></a>02346     NULL,                               <span class="comment">/*tp_members*/</span>
<a name="l02347"></a>02347     Matrix_getseters,                   <span class="comment">/*tp_getset*/</span>
<a name="l02348"></a>02348     NULL,                               <span class="comment">/*tp_base*/</span>
<a name="l02349"></a>02349     NULL,                               <span class="comment">/*tp_dict*/</span>
<a name="l02350"></a>02350     NULL,                               <span class="comment">/*tp_descr_get*/</span>
<a name="l02351"></a>02351     NULL,                               <span class="comment">/*tp_descr_set*/</span>
<a name="l02352"></a>02352     0,                                  <span class="comment">/*tp_dictoffset*/</span>
<a name="l02353"></a>02353     NULL,                               <span class="comment">/*tp_init*/</span>
<a name="l02354"></a>02354     NULL,                               <span class="comment">/*tp_alloc*/</span>
<a name="l02355"></a>02355     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a10db53ee7452ac66177dd7d18257a549">Matrix_new</a>,                         <span class="comment">/*tp_new*/</span>
<a name="l02356"></a>02356     NULL,                               <span class="comment">/*tp_free*/</span>
<a name="l02357"></a>02357     NULL,                               <span class="comment">/*tp_is_gc*/</span>
<a name="l02358"></a>02358     NULL,                               <span class="comment">/*tp_bases*/</span>
<a name="l02359"></a>02359     NULL,                               <span class="comment">/*tp_mro*/</span>
<a name="l02360"></a>02360     NULL,                               <span class="comment">/*tp_cache*/</span>
<a name="l02361"></a>02361     NULL,                               <span class="comment">/*tp_subclasses*/</span>
<a name="l02362"></a>02362     NULL,                               <span class="comment">/*tp_weaklist*/</span>
<a name="l02363"></a>02363     NULL                                <span class="comment">/*tp_del*/</span>
<a name="l02364"></a>02364 };
<a name="l02365"></a>02365 
<a name="l02366"></a>02366 <span class="comment">/* pass Py_WRAP - if vector is a WRAPPER for data allocated by BLENDER</span>
<a name="l02367"></a>02367 <span class="comment"> * (i.e. it was allocated elsewhere by MEM_mallocN())</span>
<a name="l02368"></a>02368 <span class="comment"> * pass Py_NEW - if vector is not a WRAPPER and managed by PYTHON</span>
<a name="l02369"></a>02369 <span class="comment"> * (i.e. it must be created here with PyMEM_malloc()) */</span>
<a name="l02370"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ac5e61dc675580c8cd917c185a9f0bbc9">02370</a> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(<span class="keywordtype">float</span> *mat,
<a name="l02371"></a>02371                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> num_col, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> num_row,
<a name="l02372"></a>02372                                 <span class="keywordtype">int</span> type, PyTypeObject *base_type)
<a name="l02373"></a>02373 {
<a name="l02374"></a>02374     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span>;
<a name="l02375"></a>02375 
<a name="l02376"></a>02376     <span class="comment">/* matrix objects can be any 2-4row x 2-4col matrix */</span>
<a name="l02377"></a>02377     <span class="keywordflow">if</span> (num_col &lt; 2 || num_col &gt; 4 || num_row &lt; 2 || num_row &gt; 4) {
<a name="l02378"></a>02378         PyErr_SetString(PyExc_RuntimeError,
<a name="l02379"></a>02379                         <span class="stringliteral">&quot;Matrix(): &quot;</span>
<a name="l02380"></a>02380                         <span class="stringliteral">&quot;row and column sizes must be between 2 and 4&quot;</span>);
<a name="l02381"></a>02381         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02382"></a>02382     }
<a name="l02383"></a>02383 
<a name="l02384"></a>02384     <span class="keyword">self</span> = base_type ? (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)base_type-&gt;tp_alloc(base_type, 0) :
<a name="l02385"></a>02385                        (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)PyObject_GC_New(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a>, &amp;matrix_Type);
<a name="l02386"></a>02386 
<a name="l02387"></a>02387     <span class="keywordflow">if</span> (<span class="keyword">self</span>) {
<a name="l02388"></a>02388         <span class="keyword">self</span>-&gt;num_col = num_col;
<a name="l02389"></a>02389         <span class="keyword">self</span>-&gt;num_row = num_row;
<a name="l02390"></a>02390 
<a name="l02391"></a>02391         <span class="comment">/* init callbacks as NULL */</span>
<a name="l02392"></a>02392         <span class="keyword">self</span>-&gt;cb_user = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02393"></a>02393         <span class="keyword">self</span>-&gt;cb_type = <span class="keyword">self</span>-&gt;cb_subtype = 0;
<a name="l02394"></a>02394 
<a name="l02395"></a>02395         <span class="keywordflow">if</span> (type == <a class="code" href="../../dc/d58/mathutils_8h.html#acffd6a14b48ba647f924482760261e3c">Py_WRAP</a>) {
<a name="l02396"></a>02396             <span class="keyword">self</span>-&gt;matrix = mat;
<a name="l02397"></a>02397             <span class="keyword">self</span>-&gt;wrapped = <a class="code" href="../../dc/d58/mathutils_8h.html#acffd6a14b48ba647f924482760261e3c">Py_WRAP</a>;
<a name="l02398"></a>02398         }
<a name="l02399"></a>02399         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>) {
<a name="l02400"></a>02400             <span class="keyword">self</span>-&gt;matrix = PyMem_Malloc(num_col * num_row * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l02401"></a>02401             <span class="keywordflow">if</span> (self-&gt;matrix == NULL) { <span class="comment">/*allocation failure*/</span>
<a name="l02402"></a>02402                 PyErr_SetString(PyExc_MemoryError,
<a name="l02403"></a>02403                                 <span class="stringliteral">&quot;Matrix(): &quot;</span>
<a name="l02404"></a>02404                                 <span class="stringliteral">&quot;problem allocating pointer space&quot;</span>);
<a name="l02405"></a>02405                 <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02406"></a>02406             }
<a name="l02407"></a>02407 
<a name="l02408"></a>02408             <span class="keywordflow">if</span> (mat) {  <span class="comment">/*if a float array passed*/</span>
<a name="l02409"></a>02409                 memcpy(self-&gt;matrix, mat, num_col * num_row * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l02410"></a>02410             }
<a name="l02411"></a>02411             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_col == num_row) {
<a name="l02412"></a>02412                 <span class="comment">/* or if no arguments are passed return identity matrix for square matrices */</span>
<a name="l02413"></a>02413                 PyObject *ret_dummy = <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#afa4a4a8c9f200ca2a32369f906c61cdb">Matrix_identity</a>(<span class="keyword">self</span>);
<a name="l02414"></a>02414                 Py_DECREF(ret_dummy);
<a name="l02415"></a>02415             }
<a name="l02416"></a>02416             <span class="keywordflow">else</span> {
<a name="l02417"></a>02417                 <span class="comment">/* otherwise zero everything */</span>
<a name="l02418"></a>02418                 memset(self-&gt;matrix, 0, num_col * num_row * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l02419"></a>02419             }
<a name="l02420"></a>02420             <span class="keyword">self</span>-&gt;wrapped = <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>;
<a name="l02421"></a>02421         }
<a name="l02422"></a>02422         <span class="keywordflow">else</span> {
<a name="l02423"></a>02423             Py_FatalError(<span class="stringliteral">&quot;Matrix(): invalid type!&quot;</span>);
<a name="l02424"></a>02424             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02425"></a>02425         }
<a name="l02426"></a>02426     }
<a name="l02427"></a>02427     <span class="keywordflow">return</span> (PyObject *) <span class="keyword">self</span>;
<a name="l02428"></a>02428 }
<a name="l02429"></a>02429 
<a name="l02430"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#ae99cea4399592c4e2838da5186a14811">02430</a> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a751ca08f4e577570b8e9aebdb5c45a40">Matrix_CreatePyObject_cb</a>(PyObject *cb_user,
<a name="l02431"></a>02431                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> num_col, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> num_row,
<a name="l02432"></a>02432                                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cb_type, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cb_subtype)
<a name="l02433"></a>02433 {
<a name="l02434"></a>02434     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<span class="keyword">self</span> = (<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ac5e61dc675580c8cd917c185a9f0bbc9">Matrix_CreatePyObject</a>(NULL, num_col, num_row, <a class="code" href="../../dc/d58/mathutils_8h.html#abfeca67f7ef6ae1cdb4a0e75840e8e9c">Py_NEW</a>, NULL);
<a name="l02435"></a>02435     <span class="keywordflow">if</span> (<span class="keyword">self</span>) {
<a name="l02436"></a>02436         Py_INCREF(cb_user);
<a name="l02437"></a>02437         <span class="keyword">self</span>-&gt;cb_user         = cb_user;
<a name="l02438"></a>02438         <span class="keyword">self</span>-&gt;cb_type         = cb_type;
<a name="l02439"></a>02439         <span class="keyword">self</span>-&gt;cb_subtype      = cb_subtype;
<a name="l02440"></a>02440         PyObject_GC_Track(<span class="keyword">self</span>);
<a name="l02441"></a>02441     }
<a name="l02442"></a>02442     <span class="keywordflow">return</span> (PyObject *) <span class="keyword">self</span>;
<a name="l02443"></a>02443 }
<a name="l02444"></a>02444 
<a name="l02445"></a>02445 
<a name="l02446"></a>02446 <span class="comment">/* ----------------------------------------------------------------------------</span>
<a name="l02447"></a>02447 <span class="comment"> * special type for alaternate access */</span>
<a name="l02448"></a>02448 
<a name="l02449"></a><a class="code" href="../../d4/d32/structMatrixAccessObject.html">02449</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l02450"></a>02450     PyObject_HEAD <span class="comment">/* required python macro   */</span>
<a name="l02451"></a><a class="code" href="../../d4/d32/structMatrixAccessObject.html#a88d915b5bd59326c1d376846e7cfbc68">02451</a>     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *<a class="code" href="../../d4/d32/structMatrixAccessObject.html#a88d915b5bd59326c1d376846e7cfbc68">matrix_user</a>;
<a name="l02452"></a><a class="code" href="../../d4/d32/structMatrixAccessObject.html#aaa398f58b4833cafd49835ad35234d97">02452</a>     <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60">eMatrixAccess_t</a> <a class="code" href="../../d4/d32/structMatrixAccessObject.html#aaa398f58b4833cafd49835ad35234d97">type</a>;
<a name="l02453"></a>02453 } <a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a>;
<a name="l02454"></a>02454 
<a name="l02455"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a97d9c5e9b651124f8145eb40e368f258">02455</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a97d9c5e9b651124f8145eb40e368f258">MatrixAccess_traverse</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>, visitproc visit, <span class="keywordtype">void</span> *arg)
<a name="l02456"></a>02456 {
<a name="l02457"></a>02457     Py_VISIT(self-&gt;matrix_user);
<a name="l02458"></a>02458     <span class="keywordflow">return</span> 0;
<a name="l02459"></a>02459 }
<a name="l02460"></a>02460 
<a name="l02461"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4e319d4e2d26a8bc88639249542c268a">02461</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4e319d4e2d26a8bc88639249542c268a">MatrixAccess_clear</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>)
<a name="l02462"></a>02462 {
<a name="l02463"></a>02463     Py_CLEAR(self-&gt;matrix_user);
<a name="l02464"></a>02464     <span class="keywordflow">return</span> 0;
<a name="l02465"></a>02465 }
<a name="l02466"></a>02466 
<a name="l02467"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#adb2111761c3fb621f9bb710dd3fcbd59">02467</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#adb2111761c3fb621f9bb710dd3fcbd59">MatrixAccess_dealloc</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>)
<a name="l02468"></a>02468 {
<a name="l02469"></a>02469     <span class="keywordflow">if</span> (self-&gt;matrix_user) {
<a name="l02470"></a>02470         PyObject_GC_UnTrack(<span class="keyword">self</span>);
<a name="l02471"></a>02471         <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4e319d4e2d26a8bc88639249542c268a">MatrixAccess_clear</a>(<span class="keyword">self</span>);
<a name="l02472"></a>02472     }
<a name="l02473"></a>02473 
<a name="l02474"></a>02474     Py_TYPE(<span class="keyword">self</span>)-&gt;tp_free(<span class="keyword">self</span>);
<a name="l02475"></a>02475 }
<a name="l02476"></a>02476 
<a name="l02477"></a>02477 <span class="comment">/* sequence access */</span>
<a name="l02478"></a>02478 
<a name="l02479"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8d1ec25266596a4055fe3e90528a522e">02479</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8d1ec25266596a4055fe3e90528a522e">MatrixAccess_len</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>)
<a name="l02480"></a>02480 {
<a name="l02481"></a>02481     <span class="keywordflow">return</span> (self-&gt;type == <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a585b2e9c32e993b2c062699ee75be05d">MAT_ACCESS_ROW</a>) ?
<a name="l02482"></a>02482            <span class="keyword">self</span>-&gt;matrix_user-&gt;num_row :
<a name="l02483"></a>02483            <span class="keyword">self</span>-&gt;matrix_user-&gt;num_col;
<a name="l02484"></a>02484 }
<a name="l02485"></a>02485 
<a name="l02486"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a82111c13af8ae3da33645039e3004914">02486</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a82111c13af8ae3da33645039e3004914">MatrixAccess_slice</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>, <span class="keywordtype">int</span> begin, <span class="keywordtype">int</span> end)
<a name="l02487"></a>02487 {
<a name="l02488"></a>02488     PyObject *tuple;
<a name="l02489"></a>02489     <span class="keywordtype">int</span> count;
<a name="l02490"></a>02490 
<a name="l02491"></a>02491     <span class="comment">/* row/col access */</span>
<a name="l02492"></a>02492     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *matrix_user = <span class="keyword">self</span>-&gt;matrix_user;
<a name="l02493"></a>02493     <span class="keywordtype">int</span> matrix_access_len;
<a name="l02494"></a>02494     PyObject *(*Matrix_item_new)(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *, int);
<a name="l02495"></a>02495 
<a name="l02496"></a>02496     <span class="keywordflow">if</span> (self-&gt;type == <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a585b2e9c32e993b2c062699ee75be05d">MAT_ACCESS_ROW</a>) {
<a name="l02497"></a>02497         matrix_access_len = matrix_user-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>;
<a name="l02498"></a>02498         Matrix_item_new = <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a6e82bf144bb6972d2ff0672f05cbff">Matrix_item_row</a>;
<a name="l02499"></a>02499     }
<a name="l02500"></a>02500     <span class="keywordflow">else</span> { <span class="comment">/* MAT_ACCESS_ROW */</span>
<a name="l02501"></a>02501         matrix_access_len = matrix_user-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>;
<a name="l02502"></a>02502         Matrix_item_new = <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a2f95335a659adafd015da48e1536f0cf">Matrix_item_col</a>;
<a name="l02503"></a>02503     }
<a name="l02504"></a>02504 
<a name="l02505"></a>02505     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(begin, 0, matrix_access_len);
<a name="l02506"></a>02506     <span class="keywordflow">if</span> (end &lt; 0) end = (matrix_access_len + 1) + end;
<a name="l02507"></a>02507     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(end, 0, matrix_access_len);
<a name="l02508"></a>02508     begin = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(begin, end);
<a name="l02509"></a>02509 
<a name="l02510"></a>02510     tuple = PyTuple_New(end - begin);
<a name="l02511"></a>02511     <span class="keywordflow">for</span> (count = begin; count &lt; end; count++) {
<a name="l02512"></a>02512         PyTuple_SET_ITEM(tuple, count - begin, Matrix_item_new(matrix_user, count));
<a name="l02513"></a>02513     }
<a name="l02514"></a>02514 
<a name="l02515"></a>02515     <span class="keywordflow">return</span> tuple;
<a name="l02516"></a>02516 }
<a name="l02517"></a>02517 
<a name="l02518"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aea6613a31a57c53b20bcff74306ddae7">02518</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aea6613a31a57c53b20bcff74306ddae7">MatrixAccess_subscript</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>, PyObject *item)
<a name="l02519"></a>02519 {
<a name="l02520"></a>02520     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *matrix_user = <span class="keyword">self</span>-&gt;matrix_user;
<a name="l02521"></a>02521 
<a name="l02522"></a>02522     <span class="keywordflow">if</span> (PyIndex_Check(item)) {
<a name="l02523"></a>02523         Py_ssize_t <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l02524"></a>02524         i = PyNumber_AsSsize_t(item, PyExc_IndexError);
<a name="l02525"></a>02525         <span class="keywordflow">if</span> (i == -1 &amp;&amp; PyErr_Occurred())
<a name="l02526"></a>02526             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02527"></a>02527         <span class="keywordflow">if</span> (self-&gt;type == <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a585b2e9c32e993b2c062699ee75be05d">MAT_ACCESS_ROW</a>) {
<a name="l02528"></a>02528             <span class="keywordflow">if</span> (i &lt; 0)
<a name="l02529"></a>02529                 i += matrix_user-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>;
<a name="l02530"></a>02530             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8a6e82bf144bb6972d2ff0672f05cbff">Matrix_item_row</a>(matrix_user, i);
<a name="l02531"></a>02531         }
<a name="l02532"></a>02532         <span class="keywordflow">else</span> { <span class="comment">/* MAT_ACCESS_ROW */</span>
<a name="l02533"></a>02533             <span class="keywordflow">if</span> (i &lt; 0)
<a name="l02534"></a>02534                 i += matrix_user-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>;
<a name="l02535"></a>02535             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a2f95335a659adafd015da48e1536f0cf">Matrix_item_col</a>(matrix_user, i);
<a name="l02536"></a>02536         }
<a name="l02537"></a>02537     }
<a name="l02538"></a>02538     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PySlice_Check(item)) {
<a name="l02539"></a>02539         Py_ssize_t start, stop, <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>, slicelength;
<a name="l02540"></a>02540 
<a name="l02541"></a>02541         <span class="keywordflow">if</span> (PySlice_GetIndicesEx((<span class="keywordtype">void</span> *)item, <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8d1ec25266596a4055fe3e90528a522e">MatrixAccess_len</a>(<span class="keyword">self</span>), &amp;start, &amp;stop, &amp;step, &amp;slicelength) &lt; 0)
<a name="l02542"></a>02542             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02543"></a>02543 
<a name="l02544"></a>02544         <span class="keywordflow">if</span> (slicelength &lt;= 0) {
<a name="l02545"></a>02545             <span class="keywordflow">return</span> PyTuple_New(0);
<a name="l02546"></a>02546         }
<a name="l02547"></a>02547         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (step == 1) {
<a name="l02548"></a>02548             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a82111c13af8ae3da33645039e3004914">MatrixAccess_slice</a>(<span class="keyword">self</span>, start, stop);
<a name="l02549"></a>02549         }
<a name="l02550"></a>02550         <span class="keywordflow">else</span> {
<a name="l02551"></a>02551             PyErr_SetString(PyExc_IndexError,
<a name="l02552"></a>02552                             <span class="stringliteral">&quot;slice steps not supported with matrix accessors&quot;</span>);
<a name="l02553"></a>02553             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02554"></a>02554         }
<a name="l02555"></a>02555     }
<a name="l02556"></a>02556     <span class="keywordflow">else</span> {
<a name="l02557"></a>02557         PyErr_Format(PyExc_TypeError,
<a name="l02558"></a>02558                      <span class="stringliteral">&quot;matrix indices must be integers, not %.200s&quot;</span>,
<a name="l02559"></a>02559                      Py_TYPE(item)-&gt;tp_name);
<a name="l02560"></a>02560         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02561"></a>02561     }
<a name="l02562"></a>02562 }
<a name="l02563"></a>02563 
<a name="l02564"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#acc345accfa04eee05a661b1e30794f24">02564</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#acc345accfa04eee05a661b1e30794f24">MatrixAccess_ass_subscript</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>, PyObject *item, PyObject *value)
<a name="l02565"></a>02565 {
<a name="l02566"></a>02566     <a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *matrix_user = <span class="keyword">self</span>-&gt;matrix_user;
<a name="l02567"></a>02567 
<a name="l02568"></a>02568     <span class="keywordflow">if</span> (PyIndex_Check(item)) {
<a name="l02569"></a>02569         Py_ssize_t <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = PyNumber_AsSsize_t(item, PyExc_IndexError);
<a name="l02570"></a>02570         <span class="keywordflow">if</span> (i == -1 &amp;&amp; PyErr_Occurred())
<a name="l02571"></a>02571             <span class="keywordflow">return</span> -1;
<a name="l02572"></a>02572 
<a name="l02573"></a>02573         <span class="keywordflow">if</span> (self-&gt;type == <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60a585b2e9c32e993b2c062699ee75be05d">MAT_ACCESS_ROW</a>) {
<a name="l02574"></a>02574             <span class="keywordflow">if</span> (i &lt; 0)
<a name="l02575"></a>02575                 i += matrix_user-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#adffc3e5e7fd9d039655102f4916d4096">num_row</a>;
<a name="l02576"></a>02576             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a9833c1a8ccc585bb37d18be005056c03">Matrix_ass_item_row</a>(matrix_user, i, value);
<a name="l02577"></a>02577         }
<a name="l02578"></a>02578         <span class="keywordflow">else</span> { <span class="comment">/* MAT_ACCESS_ROW */</span>
<a name="l02579"></a>02579             <span class="keywordflow">if</span> (i &lt; 0)
<a name="l02580"></a>02580                 i += matrix_user-&gt;<a class="code" href="../../dc/de4/structMatrixObject.html#afcb7fb6da883c38d151968d9a5f4a75a">num_col</a>;
<a name="l02581"></a>02581             <span class="keywordflow">return</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#ab068405f42d032129f10722e99da501e">Matrix_ass_item_col</a>(matrix_user, i, value);
<a name="l02582"></a>02582         }
<a name="l02583"></a>02583 
<a name="l02584"></a>02584     }
<a name="l02585"></a>02585     <span class="comment">/* TODO, slice */</span>
<a name="l02586"></a>02586     <span class="keywordflow">else</span> {
<a name="l02587"></a>02587         PyErr_Format(PyExc_TypeError,
<a name="l02588"></a>02588                      <span class="stringliteral">&quot;matrix indices must be integers, not %.200s&quot;</span>,
<a name="l02589"></a>02589                      Py_TYPE(item)-&gt;tp_name);
<a name="l02590"></a>02590         <span class="keywordflow">return</span> -1;
<a name="l02591"></a>02591     }
<a name="l02592"></a>02592 }
<a name="l02593"></a>02593 
<a name="l02594"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a78eead8df35addbab3fe2ff3e0c24e2d">02594</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a78eead8df35addbab3fe2ff3e0c24e2d">MatrixAccess_iter</a>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *<span class="keyword">self</span>)
<a name="l02595"></a>02595 {
<a name="l02596"></a>02596     <span class="comment">/* Try get values from a collection */</span>
<a name="l02597"></a>02597     PyObject *ret;
<a name="l02598"></a>02598     PyObject *iter = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02599"></a>02599     ret = <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a82111c13af8ae3da33645039e3004914">MatrixAccess_slice</a>(<span class="keyword">self</span>, 0, <a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a52ef6b753fe6fa402c16f29052941a2c">MATRIX_MAX_DIM</a>);
<a name="l02600"></a>02600 
<a name="l02601"></a>02601     <span class="comment">/* we know this is a tuple so no need to PyIter_Check</span>
<a name="l02602"></a>02602 <span class="comment">     * otherwise it could be NULL (unlikely) if conversion failed */</span>
<a name="l02603"></a>02603     <span class="keywordflow">if</span> (ret) {
<a name="l02604"></a>02604         iter = PyObject_GetIter(ret);
<a name="l02605"></a>02605         Py_DECREF(ret);
<a name="l02606"></a>02606     }
<a name="l02607"></a>02607 
<a name="l02608"></a>02608     <span class="keywordflow">return</span> iter;
<a name="l02609"></a>02609 }
<a name="l02610"></a>02610 
<a name="l02611"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0d8e544a5c24c2f9ada8ba84b22da86d">02611</a> <span class="keyword">static</span> PyMappingMethods <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0d8e544a5c24c2f9ada8ba84b22da86d">MatrixAccess_AsMapping</a> = {
<a name="l02612"></a>02612     (lenfunc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8d1ec25266596a4055fe3e90528a522e">MatrixAccess_len</a>,
<a name="l02613"></a>02613     (binaryfunc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#aea6613a31a57c53b20bcff74306ddae7">MatrixAccess_subscript</a>,
<a name="l02614"></a>02614     (objobjargproc) <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#acc345accfa04eee05a661b1e30794f24">MatrixAccess_ass_subscript</a>
<a name="l02615"></a>02615 };
<a name="l02616"></a>02616 
<a name="l02617"></a><a class="code" href="../../de/d8b/mathutils__Matrix_8h.html#a72c56ced5b8f555dedd21392907f68d9">02617</a> PyTypeObject <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a72c56ced5b8f555dedd21392907f68d9">matrix_access_Type</a> = {
<a name="l02618"></a>02618     PyVarObject_HEAD_INIT(NULL, 0)
<a name="l02619"></a>02619     <span class="stringliteral">&quot;MatrixAccess&quot;</span>,                     <span class="comment">/*tp_name*/</span>
<a name="l02620"></a>02620     <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a>),         <span class="comment">/*tp_basicsize*/</span>
<a name="l02621"></a>02621     0,                                  <span class="comment">/*tp_itemsize*/</span>
<a name="l02622"></a>02622     (destructor)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#adb2111761c3fb621f9bb710dd3fcbd59">MatrixAccess_dealloc</a>,   <span class="comment">/*tp_dealloc*/</span>
<a name="l02623"></a>02623     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_print*/</span>
<a name="l02624"></a>02624     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_getattr*/</span>
<a name="l02625"></a>02625     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_setattr*/</span>
<a name="l02626"></a>02626     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_compare*/</span>
<a name="l02627"></a>02627     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_repr*/</span>
<a name="l02628"></a>02628     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_as_number*/</span>
<a name="l02629"></a>02629     NULL <span class="comment">/*&amp;MatrixAccess_SeqMethods*/</span> <span class="comment">/* TODO */</span>,           <span class="comment">/*tp_as_sequence*/</span>
<a name="l02630"></a>02630     &amp;<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a0d8e544a5c24c2f9ada8ba84b22da86d">MatrixAccess_AsMapping</a>,            <span class="comment">/*tp_as_mapping*/</span>
<a name="l02631"></a>02631     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_hash*/</span>
<a name="l02632"></a>02632     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_call*/</span>
<a name="l02633"></a>02633     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_str*/</span>
<a name="l02634"></a>02634     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_getattro*/</span>
<a name="l02635"></a>02635     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_setattro*/</span>
<a name="l02636"></a>02636     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_as_buffer*/</span>
<a name="l02637"></a>02637     Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC, <span class="comment">/*tp_flags*/</span>
<a name="l02638"></a>02638     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,                               <span class="comment">/*tp_doc*/</span>
<a name="l02639"></a>02639     (traverseproc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a97d9c5e9b651124f8145eb40e368f258">MatrixAccess_traverse</a>,    <span class="comment">//tp_traverse</span>
<a name="l02640"></a>02640     (inquiry)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a4e319d4e2d26a8bc88639249542c268a">MatrixAccess_clear</a>,    <span class="comment">//tp_clear</span>
<a name="l02641"></a>02641     NULL <span class="comment">/* (richcmpfunc)MatrixAccess_richcmpr */</span> <span class="comment">/* TODO*/</span>, <span class="comment">/*tp_richcompare*/</span>
<a name="l02642"></a>02642     0,                                  <span class="comment">/*tp_weaklistoffset*/</span>
<a name="l02643"></a>02643     (getiterfunc)<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a78eead8df35addbab3fe2ff3e0c24e2d">MatrixAccess_iter</a>, <span class="comment">/* getiterfunc tp_iter; */</span>
<a name="l02644"></a>02644 };
<a name="l02645"></a>02645 
<a name="l02646"></a><a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af9ec52581bc346b73e59d0b750c14e14">02646</a> <span class="keyword">static</span> PyObject *<a class="code" href="../../da/daa/mathutils__Matrix_8c.html#af9ec52581bc346b73e59d0b750c14e14">MatrixAccess_CreatePyObject</a>(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a> *matrix, <span class="keyword">const</span> <a class="code" href="../../da/daa/mathutils__Matrix_8c.html#a8206ed5c094020926b66d52e2d2f9b60">eMatrixAccess_t</a> type)
<a name="l02647"></a>02647 {
<a name="l02648"></a>02648     <a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *matrix_access = (<a class="code" href="../../d4/d32/structMatrixAccessObject.html">MatrixAccessObject</a> *)PyObject_GC_New(<a class="code" href="../../dc/de4/structMatrixObject.html">MatrixObject</a>, &amp;matrix_access_Type);
<a name="l02649"></a>02649 
<a name="l02650"></a>02650     matrix_access-&gt;<a class="code" href="../../d4/d32/structMatrixAccessObject.html#a88d915b5bd59326c1d376846e7cfbc68">matrix_user</a> = matrix;
<a name="l02651"></a>02651     Py_INCREF(matrix);
<a name="l02652"></a>02652 
<a name="l02653"></a>02653     matrix_access-&gt;<a class="code" href="../../d4/d32/structMatrixAccessObject.html#aaa398f58b4833cafd49835ad35234d97">type</a> = type;
<a name="l02654"></a>02654 
<a name="l02655"></a>02655     <span class="keywordflow">return</span> (PyObject *)matrix_access;
<a name="l02656"></a>02656 }
<a name="l02657"></a>02657 
<a name="l02658"></a>02658 <span class="comment">/* end special access</span>
<a name="l02659"></a>02659 <span class="comment"> * -------------------------------------------------------------------------- */</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:31 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
