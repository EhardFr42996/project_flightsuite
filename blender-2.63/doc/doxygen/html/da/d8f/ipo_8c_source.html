<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: ipo.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">ipo.c</div>  </div>
</div>
<div class="contents">
<a href="../../da/d8f/ipo_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2001-2002 by NaN Holding BV.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * The Original Code is: all of this file.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * Contributor(s): 2008,2009 Joshua Leung (IPO System cleanup, Animation System Recode)</span>
<a name="l00024"></a>00024 <span class="comment"> *</span>
<a name="l00025"></a>00025 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00033"></a>00033 <span class="comment">/* NOTE:</span>
<a name="l00034"></a>00034 <span class="comment"> *</span>
<a name="l00035"></a>00035 <span class="comment"> * This file is no longer used to provide tools for the depreceated IPO system. Instead, it</span>
<a name="l00036"></a>00036 <span class="comment"> * is only used to house the conversion code to the new system.</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> * -- Joshua Leung, Jan 2009</span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a>00040  
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;stddef.h&gt;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">/* since we have versioning code here */</span>
<a name="l00047"></a><a class="code" href="../../da/d8f/ipo_8c.html#aab0b0efbdfa37ee26c8805af7d2e8c9c">00047</a> <span class="preprocessor">#define DNA_DEPRECATED_ALLOW</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html">DNA_anim_types.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d03/DNA__constraint__types_8h.html">DNA_constraint_types.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d3b/DNA__camera__types_8h.html">DNA_camera_types.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html">DNA_lamp_types.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html">DNA_ipo_types.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d41/DNA__key__types_8h.html">DNA_key_types.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../de/db2/DNA__material__types_8h.html">DNA_material_types.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../db/db5/DNA__nla__types_8h.html">DNA_nla_types.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html">DNA_sequence_types.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d3b/DNA__world__types_8h.html">DNA_world_types.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span> <span class="comment">/* windows needs for M_PI */</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc9/BLI__dynstr_8h.html" title="A dynamically sized string ADT.">BLI_dynstr.h</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d48/BKE__ipo_8h.html">BKE_ipo.h</a>&quot;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d51/BKE__animsys_8h.html">BKE_animsys.h</a>&quot;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/df5/BKE__action_8h.html" title="Blender kernel action and pose functionality.">BKE_action.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dba/BKE__fcurve_8h.html">BKE_fcurve.h</a>&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/de6/BKE__nla_8h.html">BKE_nla.h</a>&quot;</span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html">BKE_sequencer.h</a>&quot;</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">/* *************************************************** */</span>
<a name="l00080"></a>00080 <span class="comment">/* Old-Data Freeing Tools */</span>
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="comment">/* Free data from old IPO-Blocks (those which haven&#39;t been converted), but not IPO block itself */</span>
<a name="l00083"></a>00083 <span class="comment">// XXX this shouldn&#39;t be necessary anymore, but may occur while not all data is converted yet</span>
<a name="l00084"></a><a class="code" href="../../da/d8f/ipo_8c.html#af4949631df37754dd5e13162e1da89aa">00084</a> <span class="keywordtype">void</span> <a class="code" href="../../db/d48/BKE__ipo_8h.html#a695b4e38f6038c948ae6077436343cf6">free_ipo</a> (<a class="code" href="../../d2/dc5/structIpo.html">Ipo</a> *ipo)
<a name="l00085"></a>00085 {
<a name="l00086"></a>00086     <a class="code" href="../../dd/d35/structIpoCurve.html">IpoCurve</a> *icu, *icn;
<a name="l00087"></a>00087     <span class="keywordtype">int</span> n= 0;
<a name="l00088"></a>00088     
<a name="l00089"></a>00089     <span class="keywordflow">for</span> (icu= ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a12f162ec784c7d4b3336c583dfa468e4">curve</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; icu; icu= icn) {
<a name="l00090"></a>00090         icn= icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#afe828a2dd44460b47a95430528ec274d">next</a>;
<a name="l00091"></a>00091         n++;
<a name="l00092"></a>00092         
<a name="l00093"></a>00093         <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>);
<a name="l00094"></a>00094         <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#aa81cacaf8ab46e219b0e65eec0416a93">bp</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#aa81cacaf8ab46e219b0e65eec0416a93">bp</a>);
<a name="l00095"></a>00095         <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>);
<a name="l00096"></a>00096         
<a name="l00097"></a>00097         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a2bb7ce226f8b42d21eb35100f0bb4580">BLI_freelinkN</a>(&amp;ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a12f162ec784c7d4b3336c583dfa468e4">curve</a>, icu);
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099     
<a name="l00100"></a>00100     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>)
<a name="l00101"></a>00101         printf(<span class="stringliteral">&quot;Freed %d (Unconverted) Ipo-Curves from IPO &#39;%s&#39;\n&quot;</span>, n, ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">/* *************************************************** */</span>
<a name="l00105"></a>00105 <span class="comment">/* ADRCODE to RNA-Path Conversion Code  - Special (Bitflags) */</span>
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">/* Mapping Table for bitflag &lt;-&gt; RNA path */</span>
<a name="l00108"></a><a class="code" href="../../dc/d19/structAdrBit2Path.html">00108</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../dc/d19/structAdrBit2Path.html">AdrBit2Path</a> {
<a name="l00109"></a><a class="code" href="../../dc/d19/structAdrBit2Path.html#a6c200ec2a13e27aaee0049bc862a0b7b">00109</a>     <span class="keywordtype">int</span> <a class="code" href="../../dc/d19/structAdrBit2Path.html#a6c200ec2a13e27aaee0049bc862a0b7b">bit</a>;
<a name="l00110"></a><a class="code" href="../../dc/d19/structAdrBit2Path.html#adb3399b6b4ae4af0f7e75e852ea52967">00110</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d19/structAdrBit2Path.html#adb3399b6b4ae4af0f7e75e852ea52967">path</a>;
<a name="l00111"></a><a class="code" href="../../dc/d19/structAdrBit2Path.html#a20f39c5a91e5fc4a52e0e6d75f6f9ab4">00111</a>     <span class="keywordtype">int</span> <a class="code" href="../../dc/d19/structAdrBit2Path.html#a20f39c5a91e5fc4a52e0e6d75f6f9ab4">array_index</a>;
<a name="l00112"></a>00112 } <a class="code" href="../../da/d8f/ipo_8c.html#a20ede9b4c8c1c32d299dc5107f09258f">AdrBit2Path</a>;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">/* ----------------- */</span>
<a name="l00115"></a>00115 <span class="comment">/* Mapping Tables to use bits &lt;-&gt; RNA paths */</span>
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="comment">/* Object layers */</span>
<a name="l00118"></a><a class="code" href="../../da/d8f/ipo_8c.html#a121b05fe0516fa116792ed59dbf7d41a">00118</a> <span class="keyword">static</span> <a class="code" href="../../dc/d19/structAdrBit2Path.html">AdrBit2Path</a> <a class="code" href="../../da/d8f/ipo_8c.html#a121b05fe0516fa116792ed59dbf7d41a">ob_layer_bits</a>[]= {
<a name="l00119"></a>00119     {(1&lt;&lt;0), <span class="stringliteral">&quot;layers&quot;</span>, 0},
<a name="l00120"></a>00120     {(1&lt;&lt;1), <span class="stringliteral">&quot;layers&quot;</span>, 1},
<a name="l00121"></a>00121     {(1&lt;&lt;2), <span class="stringliteral">&quot;layers&quot;</span>, 2},
<a name="l00122"></a>00122     {(1&lt;&lt;3), <span class="stringliteral">&quot;layers&quot;</span>, 3},
<a name="l00123"></a>00123     {(1&lt;&lt;4), <span class="stringliteral">&quot;layers&quot;</span>, 4},
<a name="l00124"></a>00124     {(1&lt;&lt;5), <span class="stringliteral">&quot;layers&quot;</span>, 5},
<a name="l00125"></a>00125     {(1&lt;&lt;6), <span class="stringliteral">&quot;layers&quot;</span>, 6},
<a name="l00126"></a>00126     {(1&lt;&lt;7), <span class="stringliteral">&quot;layers&quot;</span>, 7},
<a name="l00127"></a>00127     {(1&lt;&lt;8), <span class="stringliteral">&quot;layers&quot;</span>, 8},
<a name="l00128"></a>00128     {(1&lt;&lt;9), <span class="stringliteral">&quot;layers&quot;</span>, 9},
<a name="l00129"></a>00129     {(1&lt;&lt;10), <span class="stringliteral">&quot;layers&quot;</span>, 10},
<a name="l00130"></a>00130     {(1&lt;&lt;11), <span class="stringliteral">&quot;layers&quot;</span>, 11},
<a name="l00131"></a>00131     {(1&lt;&lt;12), <span class="stringliteral">&quot;layers&quot;</span>, 12},
<a name="l00132"></a>00132     {(1&lt;&lt;13), <span class="stringliteral">&quot;layers&quot;</span>, 13},
<a name="l00133"></a>00133     {(1&lt;&lt;14), <span class="stringliteral">&quot;layers&quot;</span>, 14},
<a name="l00134"></a>00134     {(1&lt;&lt;15), <span class="stringliteral">&quot;layers&quot;</span>, 15},
<a name="l00135"></a>00135     {(1&lt;&lt;16), <span class="stringliteral">&quot;layers&quot;</span>, 16},
<a name="l00136"></a>00136     {(1&lt;&lt;17), <span class="stringliteral">&quot;layers&quot;</span>, 17},
<a name="l00137"></a>00137     {(1&lt;&lt;18), <span class="stringliteral">&quot;layers&quot;</span>, 18},
<a name="l00138"></a>00138     {(1&lt;&lt;19), <span class="stringliteral">&quot;layers&quot;</span>, 19}
<a name="l00139"></a>00139 };
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="comment">/* Material mode */</span>
<a name="l00142"></a><a class="code" href="../../da/d8f/ipo_8c.html#ac9cbe10d54727dd6a30d039e58c0f3a6">00142</a> <span class="keyword">static</span> <a class="code" href="../../dc/d19/structAdrBit2Path.html">AdrBit2Path</a> <a class="code" href="../../da/d8f/ipo_8c.html#ac9cbe10d54727dd6a30d039e58c0f3a6">ma_mode_bits</a>[]= {
<a name="l00143"></a>00143 <span class="comment">//  {MA_TRACEBLE, &quot;traceable&quot;, 0},</span>
<a name="l00144"></a>00144 <span class="comment">//  {MA_SHADOW, &quot;shadow&quot;, 0},</span>
<a name="l00145"></a>00145 <span class="comment">//  {MA_SHLESS, &quot;shadeless&quot;, 0},</span>
<a name="l00146"></a>00146 <span class="comment">//  ...</span>
<a name="l00147"></a>00147     {<a class="code" href="../../de/db2/DNA__material__types_8h.html#a2f301bfe492802b8461b969fc72b3652">MA_RAYTRANSP</a>, <span class="stringliteral">&quot;transparency&quot;</span>, 0},
<a name="l00148"></a>00148     {<a class="code" href="../../de/db2/DNA__material__types_8h.html#a726661eedc26b958c4cbfdef14dbca54">MA_RAYMIRROR</a>, <span class="stringliteral">&quot;raytrace_mirror.enabled&quot;</span>, 0},
<a name="l00149"></a>00149 <span class="comment">//  {MA_HALO, &quot;type&quot;, MA_TYPE_HALO}</span>
<a name="l00150"></a>00150 };
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="comment">/* ----------------- */</span>
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="comment">/* quick macro for returning the appropriate array for adrcode_bitmaps_to_paths() */</span>
<a name="l00155"></a><a class="code" href="../../da/d8f/ipo_8c.html#ab51c1523f2e22d65c7a4c5fa02988542">00155</a> <span class="preprocessor">#define RET_ABP(items) \</span>
<a name="l00156"></a>00156 <span class="preprocessor">    { \</span>
<a name="l00157"></a>00157 <span class="preprocessor">        *tot= sizeof(items)/sizeof(AdrBit2Path); \</span>
<a name="l00158"></a>00158 <span class="preprocessor">        return items; \</span>
<a name="l00159"></a>00159 <span class="preprocessor">    }</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span>
<a name="l00161"></a>00161 <span class="comment">/* This function checks if a Blocktype+Adrcode combo, returning a mapping table */</span>
<a name="l00162"></a><a class="code" href="../../da/d8f/ipo_8c.html#a8f1a4ac1f2b44356f7befe8322fc5870">00162</a> <span class="keyword">static</span> <a class="code" href="../../dc/d19/structAdrBit2Path.html">AdrBit2Path</a> *<a class="code" href="../../da/d8f/ipo_8c.html#a8f1a4ac1f2b44356f7befe8322fc5870">adrcode_bitmaps_to_paths</a> (<span class="keywordtype">int</span> blocktype, <span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *tot)
<a name="l00163"></a>00163 {
<a name="l00164"></a>00164     <span class="comment">/* Object layers */</span>
<a name="l00165"></a>00165     <span class="keywordflow">if</span> ((blocktype == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) &amp;&amp; (adrcode == <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3532e12ef30a843aaf9416a0d73d850e">OB_LAY</a>)) 
<a name="l00166"></a>00166         <a class="code" href="../../da/d8f/ipo_8c.html#ab51c1523f2e22d65c7a4c5fa02988542">RET_ABP</a>(ob_layer_bits)
<a name="l00167"></a>00167     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((blocktype == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>) &amp;&amp; (adrcode == <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aff84c38b6c3b7c41980c53dca9336926">MA_MODE</a>))
<a name="l00168"></a>00168         <a class="code" href="../../da/d8f/ipo_8c.html#ab51c1523f2e22d65c7a4c5fa02988542">RET_ABP</a>(ma_mode_bits)
<a name="l00169"></a>00169     <span class="comment">// XXX TODO: add other types...</span>
<a name="l00170"></a>00170     
<a name="l00171"></a>00171     <span class="comment">/* Normal curve */</span>
<a name="l00172"></a>00172     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">/* *************************************************** */</span>
<a name="l00176"></a>00176 <span class="comment">/* ADRCODE to RNA-Path Conversion Code  - Standard */</span>
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 <span class="comment">/* Object types */</span>
<a name="l00179"></a><a class="code" href="../../da/d8f/ipo_8c.html#a10abdd8fd8401aee157c0b91272a1717">00179</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#a10abdd8fd8401aee157c0b91272a1717">ob_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00180"></a>00180 {
<a name="l00181"></a>00181     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00182"></a>00182     *array_index= 0;
<a name="l00183"></a>00183     
<a name="l00184"></a>00184     <span class="comment">/* result depends on adrcode */</span>
<a name="l00185"></a>00185     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00186"></a>00186         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a27e4792ca7662013defb5d5c49e4dd20">OB_LOC_X</a>:
<a name="l00187"></a>00187             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;location&quot;</span>;
<a name="l00188"></a>00188         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a513a340e950dce9c42a6a80f0a81c1a3">OB_LOC_Y</a>:
<a name="l00189"></a>00189             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;location&quot;</span>;
<a name="l00190"></a>00190         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a8ae819f84d4bb50a0da0e9c118ff795b">OB_LOC_Z</a>:
<a name="l00191"></a>00191             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;location&quot;</span>;
<a name="l00192"></a>00192         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aff6f3ed559b55ce363daf0eb087a57f9">OB_DLOC_X</a>:
<a name="l00193"></a>00193             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_location&quot;</span>;
<a name="l00194"></a>00194         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a624e54563805800da4efb87ad59e4598">OB_DLOC_Y</a>:
<a name="l00195"></a>00195             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_location&quot;</span>;
<a name="l00196"></a>00196         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad147983405c123ca9339cfd6fe2f625d">OB_DLOC_Z</a>:
<a name="l00197"></a>00197             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_location&quot;</span>;
<a name="l00198"></a>00198         
<a name="l00199"></a>00199         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab7f95025a9e7c3e44560ff3e47a47028">OB_ROT_X</a>:
<a name="l00200"></a>00200             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_euler&quot;</span>;
<a name="l00201"></a>00201         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a338abb6e4e4eded18bbe49c370fbb3a8">OB_ROT_Y</a>:
<a name="l00202"></a>00202             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_euler&quot;</span>;
<a name="l00203"></a>00203         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a61d7f02a72a245dd8ce7ec193bc2c4a7">OB_ROT_Z</a>:
<a name="l00204"></a>00204             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_euler&quot;</span>;
<a name="l00205"></a>00205         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#afbfadf78c5b2f82e99e054de4aa5ceb0">OB_DROT_X</a>:
<a name="l00206"></a>00206             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_rotation_euler&quot;</span>;
<a name="l00207"></a>00207         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad1ce32d20c651d3c96be0c388966f9e1">OB_DROT_Y</a>:
<a name="l00208"></a>00208             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_rotation_euler&quot;</span>;
<a name="l00209"></a>00209         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a19a898cbbf98bcb7c7af6279788781af">OB_DROT_Z</a>:
<a name="l00210"></a>00210             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_rotation_euler&quot;</span>;
<a name="l00211"></a>00211             
<a name="l00212"></a>00212         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa3a1560d910ff6faa215c4f4c9d9ba6b">OB_SIZE_X</a>:
<a name="l00213"></a>00213             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;scale&quot;</span>;
<a name="l00214"></a>00214         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad4b3dbae74fdc12e0e9f1f9115d45a17">OB_SIZE_Y</a>:
<a name="l00215"></a>00215             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;scale&quot;</span>;
<a name="l00216"></a>00216         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3fb3e5dacaffada0c0615b0760843df6">OB_SIZE_Z</a>:
<a name="l00217"></a>00217             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;scale&quot;</span>;
<a name="l00218"></a>00218         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a65c6921949811ab35729b47ba411eb72">OB_DSIZE_X</a>:
<a name="l00219"></a>00219             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_scale&quot;</span>;
<a name="l00220"></a>00220         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4ee5257f4fcdba2d252a50a3ce305250">OB_DSIZE_Y</a>:
<a name="l00221"></a>00221             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_scale&quot;</span>;
<a name="l00222"></a>00222         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a1c2c607e7258d7fc3288885c48d5e3f8">OB_DSIZE_Z</a>:
<a name="l00223"></a>00223             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;delta_scale&quot;</span>;
<a name="l00224"></a>00224         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a10b92d2c7b8c4ee42b68765ed1b5f896">OB_COL_R</a>:
<a name="l00225"></a>00225             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;color&quot;</span>;
<a name="l00226"></a>00226         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa5ceb6a039b1abe119fee87de7bbaa25">OB_COL_G</a>:
<a name="l00227"></a>00227             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;color&quot;</span>;
<a name="l00228"></a>00228         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9a51dc1d97f1534e8df6c3d2ed90cad6">OB_COL_B</a>:
<a name="l00229"></a>00229             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;color&quot;</span>;
<a name="l00230"></a>00230         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a1b5b9c3c0a4d086448d749da1e9f634b">OB_COL_A</a>:
<a name="l00231"></a>00231             *array_index= 3; <span class="keywordflow">return</span> <span class="stringliteral">&quot;color&quot;</span>;
<a name="l00232"></a>00232 <span class="preprocessor">#if 0</span>
<a name="l00233"></a>00233 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3e8ef4687dc510e93dcf7bcb93ee530f">OB_PD_FSTR</a>:
<a name="l00234"></a>00234             <span class="keywordflow">if</span> (ob-&gt;pd) poin= &amp;(ob-&gt;pd-&gt;f_strength);
<a name="l00235"></a>00235             <span class="keywordflow">break</span>;
<a name="l00236"></a>00236         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#abbbb97637cbe02cace46d535a306222f">OB_PD_FFALL</a>:
<a name="l00237"></a>00237             <span class="keywordflow">if</span> (ob-&gt;pd) poin= &amp;(ob-&gt;pd-&gt;f_power);
<a name="l00238"></a>00238             <span class="keywordflow">break</span>;
<a name="l00239"></a>00239         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad99eb21eb40a64538eae208dcf5c4379">OB_PD_SDAMP</a>:
<a name="l00240"></a>00240             <span class="keywordflow">if</span> (ob-&gt;pd) poin= &amp;(ob-&gt;pd-&gt;pdef_damp);
<a name="l00241"></a>00241             <span class="keywordflow">break</span>;
<a name="l00242"></a>00242         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ae7b06612a80b6f51ab6d0203b98f1750">OB_PD_RDAMP</a>:
<a name="l00243"></a>00243             <span class="keywordflow">if</span> (ob-&gt;pd) poin= &amp;(ob-&gt;pd-&gt;pdef_rdamp);
<a name="l00244"></a>00244             <span class="keywordflow">break</span>;
<a name="l00245"></a>00245         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a52affcd1efe026f991b3a8dcc64adc31">OB_PD_PERM</a>:
<a name="l00246"></a>00246             <span class="keywordflow">if</span> (ob-&gt;pd) poin= &amp;(ob-&gt;pd-&gt;pdef_perm);
<a name="l00247"></a>00247             <span class="keywordflow">break</span>;
<a name="l00248"></a>00248         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6b44c9bccd482a6ef086551458e3c9fa">OB_PD_FMAXD</a>:
<a name="l00249"></a>00249             <span class="keywordflow">if</span> (ob-&gt;pd) poin= &amp;(ob-&gt;pd-&gt;maxdist);
<a name="l00250"></a>00250             <span class="keywordflow">break</span>;
<a name="l00251"></a>00251 <span class="preprocessor">#endif</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span>    }
<a name="l00253"></a>00253     
<a name="l00254"></a>00254     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="comment">/* PoseChannel types </span>
<a name="l00258"></a>00258 <span class="comment"> * NOTE: pchan name comes from &#39;actname&#39; added earlier... </span>
<a name="l00259"></a>00259 <span class="comment"> */</span>
<a name="l00260"></a><a class="code" href="../../da/d8f/ipo_8c.html#a3b7814c3e40d4668a76c26a7581e250c">00260</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#a3b7814c3e40d4668a76c26a7581e250c">pchan_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00261"></a>00261 {
<a name="l00262"></a>00262     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00263"></a>00263     *array_index= 0;
<a name="l00264"></a>00264     
<a name="l00265"></a>00265     <span class="comment">/* result depends on adrcode */</span>
<a name="l00266"></a>00266     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00267"></a>00267         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4c85d8340fb2362080bac118bf2d3d30">AC_QUAT_W</a>:
<a name="l00268"></a>00268             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_quaternion&quot;</span>;
<a name="l00269"></a>00269         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a866d8274bc585145f3f32425cccc193b">AC_QUAT_X</a>:
<a name="l00270"></a>00270             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_quaternion&quot;</span>;
<a name="l00271"></a>00271         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6295456077cace8a70495ca3b7cd8194">AC_QUAT_Y</a>:
<a name="l00272"></a>00272             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_quaternion&quot;</span>;
<a name="l00273"></a>00273         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a1a35ff81011691b7d5566a1bd8fdeee9">AC_QUAT_Z</a>:
<a name="l00274"></a>00274             *array_index= 3; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_quaternion&quot;</span>;
<a name="l00275"></a>00275             
<a name="l00276"></a>00276         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9a5bf66c2fd0c205d8f7d65e8490e751">AC_EUL_X</a>:
<a name="l00277"></a>00277             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_euler&quot;</span>;
<a name="l00278"></a>00278         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a992eb0aacfd4acd4af8042c71c96b296">AC_EUL_Y</a>:
<a name="l00279"></a>00279             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_euler&quot;</span>;
<a name="l00280"></a>00280         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a0b756d5550bbf1654fa669b6f8399816">AC_EUL_Z</a>:
<a name="l00281"></a>00281             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rotation_euler&quot;</span>;
<a name="l00282"></a>00282         
<a name="l00283"></a>00283         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a756c21cd69812e31113f0a3ff50aba05">AC_LOC_X</a>:
<a name="l00284"></a>00284             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;location&quot;</span>;
<a name="l00285"></a>00285         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a72ff2aab50e84d0b13552d06b08788be">AC_LOC_Y</a>:
<a name="l00286"></a>00286             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;location&quot;</span>;
<a name="l00287"></a>00287         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a2fd2a6cd9717f46e645ef7334c0eb175">AC_LOC_Z</a>:
<a name="l00288"></a>00288             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;location&quot;</span>;
<a name="l00289"></a>00289         
<a name="l00290"></a>00290         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac29ad101d5f70cd9591a162ac6b9c123">AC_SIZE_X</a>:
<a name="l00291"></a>00291             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;scale&quot;</span>;
<a name="l00292"></a>00292         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a557c31235b9544c7f5dff399c482b257">AC_SIZE_Y</a>:
<a name="l00293"></a>00293             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;scale&quot;</span>;
<a name="l00294"></a>00294         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a651d706bd9908546e6ba17f600eb46ca">AC_SIZE_Z</a>:
<a name="l00295"></a>00295             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;scale&quot;</span>;
<a name="l00296"></a>00296     }
<a name="l00297"></a>00297     
<a name="l00298"></a>00298     <span class="comment">/* for debugging only */</span>
<a name="l00299"></a>00299     printf(<span class="stringliteral">&quot;ERROR: unmatched PoseChannel setting (code %d)\n&quot;</span>, adrcode);
<a name="l00300"></a>00300     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="comment">/* Constraint types */</span>
<a name="l00304"></a><a class="code" href="../../da/d8f/ipo_8c.html#a88b2f482eb3ef9df0310f9114c5d4792">00304</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#a88b2f482eb3ef9df0310f9114c5d4792">constraint_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00305"></a>00305 {
<a name="l00306"></a>00306     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00307"></a>00307     *array_index= 0;
<a name="l00308"></a>00308     
<a name="l00309"></a>00309     <span class="comment">/* result depends on adrcode */</span>
<a name="l00310"></a>00310     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00311"></a>00311         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ae3d1d5d98fb5fd52acbd31ee2b63bb0f">CO_ENFORCE</a>:
<a name="l00312"></a>00312             <span class="keywordflow">return</span> <span class="stringliteral">&quot;influence&quot;</span>;
<a name="l00313"></a>00313         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a36cf500cf7634cbb3439ec81167ad67d">CO_HEADTAIL</a>:   <span class="comment">// XXX this needs to be wrapped in RNA.. probably then this path will be invalid</span>
<a name="l00314"></a>00314             <span class="keywordflow">return</span> <span class="stringliteral">&quot;data.head_tail&quot;</span>;
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316     
<a name="l00317"></a>00317     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="comment">/* ShapeKey types </span>
<a name="l00321"></a>00321 <span class="comment"> * NOTE: as we don&#39;t have access to the keyblock where the data comes from (for now), </span>
<a name="l00322"></a>00322 <span class="comment"> *       we&#39;ll just use numerical indices for now...</span>
<a name="l00323"></a>00323 <span class="comment"> */</span>
<a name="l00324"></a><a class="code" href="../../da/d8f/ipo_8c.html#a4c149095377e213b861e32dc4750cb5a">00324</a> <span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#a4c149095377e213b861e32dc4750cb5a">shapekey_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(array_index))
<a name="l00325"></a>00325 {
<a name="l00326"></a>00326     <span class="keyword">static</span> <span class="keywordtype">char</span> buf[128];
<a name="l00327"></a>00327     
<a name="l00328"></a>00328     <span class="comment">/* block will be attached to ID_KE block... */</span>
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (adrcode == 0) {
<a name="l00330"></a>00330         <span class="comment">/* adrcode=0 was the misnamed &quot;speed&quot; curve (now &quot;evaluation time&quot;) */</span>
<a name="l00331"></a>00331         <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(buf, <span class="stringliteral">&quot;eval_time&quot;</span>, <span class="keyword">sizeof</span>(buf));
<a name="l00332"></a>00332     }
<a name="l00333"></a>00333     <span class="keywordflow">else</span> {
<a name="l00334"></a>00334         <span class="comment">/* setting that we alter is the &quot;value&quot; (i.e. keyblock.curval) */</span>
<a name="l00335"></a>00335         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;key_blocks[%d].value&quot;</span>, adrcode);
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337     <span class="keywordflow">return</span> buf;
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="comment">/* MTex (Texture Slot) types */</span>
<a name="l00341"></a><a class="code" href="../../da/d8f/ipo_8c.html#afeedeae2e9d25eb8f9442dec8969cb15">00341</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#afeedeae2e9d25eb8f9442dec8969cb15">mtex_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(array_index))
<a name="l00342"></a>00342 {
<a name="l00343"></a>00343     <span class="keyword">const</span> <span class="keywordtype">char</span> *base=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *prop=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00344"></a>00344     <span class="keyword">static</span> <span class="keywordtype">char</span> buf[128];
<a name="l00345"></a>00345     
<a name="l00346"></a>00346     <span class="comment">/* base part of path */</span>
<a name="l00347"></a>00347     <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a8b3bddf8e2e8ae6872cb15adb4493f7a">MA_MAP1</a>) base= <span class="stringliteral">&quot;textures[0]&quot;</span>;
<a name="l00348"></a>00348     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a406ac5be8d8ba1d88a4260ec33f1bb50">MA_MAP2</a>) base= <span class="stringliteral">&quot;textures[1]&quot;</span>;
<a name="l00349"></a>00349     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aafcac7be476b190207b4b96968099c67">MA_MAP3</a>) base= <span class="stringliteral">&quot;textures[2]&quot;</span>;
<a name="l00350"></a>00350     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a67291499ba09b0ef43abaae646213476">MA_MAP4</a>) base= <span class="stringliteral">&quot;textures[3]&quot;</span>;
<a name="l00351"></a>00351     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a738180d5bd8fe6873c2256d85de382fd">MA_MAP5</a>) base= <span class="stringliteral">&quot;textures[4]&quot;</span>;
<a name="l00352"></a>00352     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab98896bbcdf6e430bbf365d629bbf3f1">MA_MAP6</a>) base= <span class="stringliteral">&quot;textures[5]&quot;</span>;
<a name="l00353"></a>00353     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a586c044dcf61b20beebb9cd69b533ed4">MA_MAP7</a>) base= <span class="stringliteral">&quot;textures[6]&quot;</span>;
<a name="l00354"></a>00354     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#adefee51f88dcf9865957a26b9f1262cf">MA_MAP8</a>) base= <span class="stringliteral">&quot;textures[7]&quot;</span>;
<a name="l00355"></a>00355     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa35828cc9f66d4ed1c1ae134e4cac679">MA_MAP9</a>) base= <span class="stringliteral">&quot;textures[8]&quot;</span>;
<a name="l00356"></a>00356     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3a916923b3eb0d9b396d1ba96524dd8d">MA_MAP10</a>) base= <span class="stringliteral">&quot;textures[9]&quot;</span>;
<a name="l00357"></a>00357     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4b29a65ac1c0ad1adf97a08b96378180">MA_MAP11</a>) base= <span class="stringliteral">&quot;textures[10]&quot;</span>;
<a name="l00358"></a>00358     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac6641495d876abd28b518af3c7474035">MA_MAP12</a>) base= <span class="stringliteral">&quot;textures[11]&quot;</span>;
<a name="l00359"></a>00359     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a886c2ec50a435d9c9c619f0eae2db7ff">MA_MAP13</a>) base= <span class="stringliteral">&quot;textures[12]&quot;</span>;
<a name="l00360"></a>00360     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aec44dd3ee91493cae055b62f5466b7d3">MA_MAP14</a>) base= <span class="stringliteral">&quot;textures[13]&quot;</span>;
<a name="l00361"></a>00361     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a46c8ef368dc93e3aa012892fdcafa662">MA_MAP15</a>) base= <span class="stringliteral">&quot;textures[14]&quot;</span>;
<a name="l00362"></a>00362     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9ec0bdd6ec8739da2be8e6fc3fa2afa5">MA_MAP16</a>) base= <span class="stringliteral">&quot;textures[15]&quot;</span>;
<a name="l00363"></a>00363     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a190381ae243216e416a33446a7b34ff4">MA_MAP17</a>) base= <span class="stringliteral">&quot;textures[16]&quot;</span>;
<a name="l00364"></a>00364     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adrcode &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab08ab065eedcd3732cc759a9cc27eb34">MA_MAP18</a>) base= <span class="stringliteral">&quot;textures[17]&quot;</span>;
<a name="l00365"></a>00365         
<a name="l00366"></a>00366     <span class="comment">/* property identifier for path */</span>
<a name="l00367"></a>00367     adrcode= (adrcode &amp; (MA_MAP1-1));
<a name="l00368"></a>00368     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00369"></a>00369 <span class="preprocessor">#if 0 // XXX these are not wrapped in RNA yet!</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a7931ac03e624eac3c7c6667f51db0cd3">MAP_OFS_X</a>:
<a name="l00371"></a>00371             poin= &amp;(mtex-&gt;ofs[0]); <span class="keywordflow">break</span>;
<a name="l00372"></a>00372         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a050a73df8cb21ca8c5063d050dd7a2e5">MAP_OFS_Y</a>:
<a name="l00373"></a>00373             poin= &amp;(mtex-&gt;ofs[1]); <span class="keywordflow">break</span>;
<a name="l00374"></a>00374         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3ebd44aa988ab8d43140cf2b537d3e25">MAP_OFS_Z</a>:
<a name="l00375"></a>00375             poin= &amp;(mtex-&gt;ofs[2]); <span class="keywordflow">break</span>;
<a name="l00376"></a>00376         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a0cd4f6c7236aa34274fecd1e7bb9d19f">MAP_SIZE_X</a>:
<a name="l00377"></a>00377             poin= &amp;(mtex-&gt;size[0]); <span class="keywordflow">break</span>;
<a name="l00378"></a>00378         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a577d617366a2a1c84265f8da15ae96f6">MAP_SIZE_Y</a>:
<a name="l00379"></a>00379             poin= &amp;(mtex-&gt;size[1]); <span class="keywordflow">break</span>;
<a name="l00380"></a>00380         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a0216734b208b434dc3e25e60fe863572">MAP_SIZE_Z</a>:
<a name="l00381"></a>00381             poin= &amp;(mtex-&gt;size[2]); <span class="keywordflow">break</span>;
<a name="l00382"></a>00382         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a489afa73e3d1c2cfea4e43e384e655f6">MAP_R</a>:
<a name="l00383"></a>00383             poin= &amp;(mtex-&gt;r); <span class="keywordflow">break</span>;
<a name="l00384"></a>00384         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#acf905ad1dca517bcaa7c897d9e2ab904">MAP_G</a>:
<a name="l00385"></a>00385             poin= &amp;(mtex-&gt;g); <span class="keywordflow">break</span>;
<a name="l00386"></a>00386         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9aaa22e742525a9900a4fe227d6cd8e9">MAP_B</a>:
<a name="l00387"></a>00387             poin= &amp;(mtex-&gt;b); <span class="keywordflow">break</span>;
<a name="l00388"></a>00388         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a90e955a09d76b8dbcd49b682de3d349f">MAP_DVAR</a>:
<a name="l00389"></a>00389             poin= &amp;(mtex-&gt;def_var); <span class="keywordflow">break</span>;
<a name="l00390"></a>00390         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a51bf15f533f213344cd4d4d52fc0b471">MAP_COLF</a>:
<a name="l00391"></a>00391             poin= &amp;(mtex-&gt;colfac); <span class="keywordflow">break</span>;
<a name="l00392"></a>00392         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4797770a4a17861564c23a6cca17a9af">MAP_NORF</a>:
<a name="l00393"></a>00393             poin= &amp;(mtex-&gt;norfac); <span class="keywordflow">break</span>;
<a name="l00394"></a>00394         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac47f14877594ef0725a884527579d977">MAP_VARF</a>:
<a name="l00395"></a>00395             poin= &amp;(mtex-&gt;varfac); <span class="keywordflow">break</span>;
<a name="l00396"></a>00396 <span class="preprocessor">#endif</span>
<a name="l00397"></a>00397 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a90516c518f4f0451b6e33e733a8c0a3c">MAP_DISP</a>:
<a name="l00398"></a>00398             prop= <span class="stringliteral">&quot;warp_factor&quot;</span>; <span class="keywordflow">break</span>;
<a name="l00399"></a>00399     }
<a name="l00400"></a>00400     
<a name="l00401"></a>00401     <span class="comment">/* only build and return path if there&#39;s a property */</span>
<a name="l00402"></a>00402     <span class="keywordflow">if</span> (prop) {
<a name="l00403"></a>00403         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, 128, <span class="stringliteral">&quot;%s.%s&quot;</span>, base, prop);
<a name="l00404"></a>00404         <span class="keywordflow">return</span> buf;
<a name="l00405"></a>00405     }
<a name="l00406"></a>00406     <span class="keywordflow">else</span>
<a name="l00407"></a>00407         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00408"></a>00408 }
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 <span class="comment">/* Texture types */</span>
<a name="l00411"></a><a class="code" href="../../da/d8f/ipo_8c.html#a84f84bc78d24d0e2082f6028bb765ea4">00411</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#a84f84bc78d24d0e2082f6028bb765ea4">texture_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00412"></a>00412 {
<a name="l00413"></a>00413     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00414"></a>00414     *array_index= 0;
<a name="l00415"></a>00415     
<a name="l00416"></a>00416     <span class="comment">/* result depends on adrcode */</span>
<a name="l00417"></a>00417     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00418"></a>00418         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a2a17aeeec55beb9dc66217bcef274a84">TE_NSIZE</a>:
<a name="l00419"></a>00419             <span class="keywordflow">return</span> <span class="stringliteral">&quot;noise_size&quot;</span>;
<a name="l00420"></a>00420         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#acc5bb933bcf310e9efc425c21e33d08b">TE_TURB</a>:
<a name="l00421"></a>00421             <span class="keywordflow">return</span> <span class="stringliteral">&quot;turbulence&quot;</span>;
<a name="l00422"></a>00422             
<a name="l00423"></a>00423         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a88bc268e0c95801717235610b92347f8">TE_NDEPTH</a>: <span class="comment">// XXX texture RNA undefined</span>
<a name="l00424"></a>00424             <span class="comment">//poin= &amp;(tex-&gt;noisedepth); *type= IPO_SHORT; break;</span>
<a name="l00425"></a>00425             <span class="keywordflow">break</span>;
<a name="l00426"></a>00426         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a0d8c41007fd08b73a0069bcac3cf74dc">TE_NTYPE</a>: <span class="comment">// XXX texture RNA undefined</span>
<a name="l00427"></a>00427             <span class="comment">//poin= &amp;(tex-&gt;noisetype); *type= IPO_SHORT; break;</span>
<a name="l00428"></a>00428             <span class="keywordflow">break</span>;
<a name="l00429"></a>00429             
<a name="l00430"></a>00430         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a576c48228534d1943e60435dcf252fbf">TE_N_BAS1</a>:
<a name="l00431"></a>00431             <span class="keywordflow">return</span> <span class="stringliteral">&quot;noise_basis&quot;</span>;
<a name="l00432"></a>00432         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab777afea8d34c901fc69c445a738ac7e">TE_N_BAS2</a>:
<a name="l00433"></a>00433             <span class="keywordflow">return</span> <span class="stringliteral">&quot;noise_basis&quot;</span>; <span class="comment">// XXX this is not yet defined in RNA...</span>
<a name="l00434"></a>00434         
<a name="l00435"></a>00435             <span class="comment">/* voronoi */</span>
<a name="l00436"></a>00436         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a30cab1f697f779d44e304214af66c8ef">TE_VNW1</a>:
<a name="l00437"></a>00437             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;feature_weights&quot;</span>;
<a name="l00438"></a>00438         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a10ce1b749d9a064ef0cdc14ef89c9ef3">TE_VNW2</a>:
<a name="l00439"></a>00439             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;feature_weights&quot;</span>;
<a name="l00440"></a>00440         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a7230388fbfcecca1794c4f6af4b729fc">TE_VNW3</a>:
<a name="l00441"></a>00441             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;feature_weights&quot;</span>;
<a name="l00442"></a>00442         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab7e125d79ddb7a99cbca7ffc599e82a2">TE_VNW4</a>:
<a name="l00443"></a>00443             *array_index= 3; <span class="keywordflow">return</span> <span class="stringliteral">&quot;feature_weights&quot;</span>;
<a name="l00444"></a>00444         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6a08b3a9e060daf51b8d9d9bdf671e35">TE_VNMEXP</a>:
<a name="l00445"></a>00445             <span class="keywordflow">return</span> <span class="stringliteral">&quot;minkovsky_exponent&quot;</span>;
<a name="l00446"></a>00446         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3bf50c4ba2e4daa5d7722d24fbd31879">TE_VN_DISTM</a>:
<a name="l00447"></a>00447             <span class="keywordflow">return</span> <span class="stringliteral">&quot;distance_metric&quot;</span>;
<a name="l00448"></a>00448         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a268514316ad617657a815db3141bf351">TE_VN_COLT</a>:
<a name="l00449"></a>00449             <span class="keywordflow">return</span> <span class="stringliteral">&quot;color_type&quot;</span>;
<a name="l00450"></a>00450         
<a name="l00451"></a>00451             <span class="comment">/* distorted noise / voronoi */</span>
<a name="l00452"></a>00452         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#abea97191e385cc2fd8fd21ce78debae8">TE_ISCA</a>:
<a name="l00453"></a>00453             <span class="keywordflow">return</span> <span class="stringliteral">&quot;noise_intensity&quot;</span>;
<a name="l00454"></a>00454             
<a name="l00455"></a>00455             <span class="comment">/* distorted noise */</span>
<a name="l00456"></a>00456         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a2f672ae6f15aa47d32591a97a0d54142">TE_DISTA</a>:
<a name="l00457"></a>00457             <span class="keywordflow">return</span> <span class="stringliteral">&quot;distortion_amount&quot;</span>;
<a name="l00458"></a>00458         
<a name="l00459"></a>00459             <span class="comment">/* musgrave */</span>
<a name="l00460"></a>00460         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab7dcb45be8fd86aa198901129fb36fdf">TE_MG_TYP</a>: <span class="comment">// XXX texture RNA undefined</span>
<a name="l00461"></a>00461         <span class="comment">//  poin= &amp;(tex-&gt;stype); *type= IPO_SHORT; break;</span>
<a name="l00462"></a>00462             <span class="keywordflow">break</span>;
<a name="l00463"></a>00463         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad526619a57d5c4bc789c673bd40da714">TE_MGH</a>:
<a name="l00464"></a>00464             <span class="keywordflow">return</span> <span class="stringliteral">&quot;highest_dimension&quot;</span>;
<a name="l00465"></a>00465         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad9bf542af01daf9d5d0c6798b8af8384">TE_MG_LAC</a>:
<a name="l00466"></a>00466             <span class="keywordflow">return</span> <span class="stringliteral">&quot;lacunarity&quot;</span>;
<a name="l00467"></a>00467         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#af0f4f9c2ffc97e3db480925abff54404">TE_MG_OCT</a>:
<a name="l00468"></a>00468             <span class="keywordflow">return</span> <span class="stringliteral">&quot;octaves&quot;</span>;
<a name="l00469"></a>00469         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a961498c45ea1f825651dfb09ca39bc1f">TE_MG_OFF</a>:
<a name="l00470"></a>00470             <span class="keywordflow">return</span> <span class="stringliteral">&quot;offset&quot;</span>;
<a name="l00471"></a>00471         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a00d3f73ae1ee4b5c74e0baa52bd2d9e7">TE_MG_GAIN</a>:
<a name="l00472"></a>00472             <span class="keywordflow">return</span> <span class="stringliteral">&quot;gain&quot;</span>;
<a name="l00473"></a>00473             
<a name="l00474"></a>00474         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#abb492d3dde00fdafd8f8d513286a9f98">TE_COL_R</a>:
<a name="l00475"></a>00475             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rgb_factor&quot;</span>;
<a name="l00476"></a>00476         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab94e56157087f416b7b4f3366f7d1c28">TE_COL_G</a>:
<a name="l00477"></a>00477             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rgb_factor&quot;</span>;
<a name="l00478"></a>00478         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aed2d256c796e3b414df0d34a71c56fdc">TE_COL_B</a>:
<a name="l00479"></a>00479             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;rgb_factor&quot;</span>;
<a name="l00480"></a>00480             
<a name="l00481"></a>00481         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa61515913b67d62dce620648e9f054c9">TE_BRIGHT</a>:
<a name="l00482"></a>00482             <span class="keywordflow">return</span> <span class="stringliteral">&quot;brightness&quot;</span>;
<a name="l00483"></a>00483         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ae40935701ef7a4b767113401652cdf8d">TE_CONTRA</a>:
<a name="l00484"></a>00484             <span class="keywordflow">return</span> <span class="stringliteral">&quot;constrast&quot;</span>;
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486     
<a name="l00487"></a>00487     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="comment">/* Material Types */</span>
<a name="l00491"></a><a class="code" href="../../da/d8f/ipo_8c.html#ac01be44507eed239ac7e8c930c841ad7">00491</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#ac01be44507eed239ac7e8c930c841ad7">material_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00492"></a>00492 {
<a name="l00493"></a>00493     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00494"></a>00494     *array_index= 0;
<a name="l00495"></a>00495     
<a name="l00496"></a>00496     <span class="comment">/* result depends on adrcode */</span>
<a name="l00497"></a>00497     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00498"></a>00498         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac59e0e1cc338518cbfb6bde42ffb1c9d">MA_COL_R</a>:
<a name="l00499"></a>00499             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;diffuse_color&quot;</span>;
<a name="l00500"></a>00500         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a1f39416a8961b238c7aff07e3086faf4">MA_COL_G</a>:
<a name="l00501"></a>00501             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;diffuse_color&quot;</span>;
<a name="l00502"></a>00502         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac297ce0bf61e645c200bd6f8c761d3fe">MA_COL_B</a>:
<a name="l00503"></a>00503             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;diffuse_color&quot;</span>;
<a name="l00504"></a>00504             
<a name="l00505"></a>00505         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aabc8c264cd42abd6a5c9dadd15ecf107">MA_SPEC_R</a>:
<a name="l00506"></a>00506             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;specular_color&quot;</span>;
<a name="l00507"></a>00507         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#af5d4989e34d193ccfb11129b5db5cd2c">MA_SPEC_G</a>:
<a name="l00508"></a>00508             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;specular_color&quot;</span>;
<a name="l00509"></a>00509         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a537cb9f64d59770d10e754a2ca184e56">MA_SPEC_B</a>:
<a name="l00510"></a>00510             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;specular_color&quot;</span>;
<a name="l00511"></a>00511             
<a name="l00512"></a>00512         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ada07d9bf3841c48d256bb7d369cebb7f">MA_MIR_R</a>:
<a name="l00513"></a>00513             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;mirror_color&quot;</span>;
<a name="l00514"></a>00514         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4fcde906f8fcb2668ba482e057f3b72e">MA_MIR_G</a>:
<a name="l00515"></a>00515             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;mirror_color&quot;</span>;
<a name="l00516"></a>00516         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#adf43e86371f45d10ff5a3920076d0d27">MA_MIR_B</a>:
<a name="l00517"></a>00517             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;mirror_color&quot;</span>;
<a name="l00518"></a>00518             
<a name="l00519"></a>00519         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab786e877efecd1d95013cff27ae7f131">MA_ALPHA</a>:
<a name="l00520"></a>00520             <span class="keywordflow">return</span> <span class="stringliteral">&quot;alpha&quot;</span>;
<a name="l00521"></a>00521             
<a name="l00522"></a>00522         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#af9c0c9b9b66e50aae711826f13a697a1">MA_REF</a>:
<a name="l00523"></a>00523             <span class="keywordflow">return</span> <span class="stringliteral">&quot;diffuse_intensity&quot;</span>;
<a name="l00524"></a>00524         
<a name="l00525"></a>00525         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ae63a29df5077d597a18ff15c71b8f11d">MA_EMIT</a>:
<a name="l00526"></a>00526             <span class="keywordflow">return</span> <span class="stringliteral">&quot;emit&quot;</span>;
<a name="l00527"></a>00527         
<a name="l00528"></a>00528         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6ac360b55077a9ea494f66adf5c94972">MA_AMB</a>:
<a name="l00529"></a>00529             <span class="keywordflow">return</span> <span class="stringliteral">&quot;ambient&quot;</span>;
<a name="l00530"></a>00530         
<a name="l00531"></a>00531         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a22d4720c753b464fd24f2706d0b8d2bf">MA_SPEC</a>:
<a name="l00532"></a>00532             <span class="keywordflow">return</span> <span class="stringliteral">&quot;specular_intensity&quot;</span>;
<a name="l00533"></a>00533         
<a name="l00534"></a>00534         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a5872183fb4daab631bf7afa004bdf033">MA_HARD</a>:
<a name="l00535"></a>00535             <span class="keywordflow">return</span> <span class="stringliteral">&quot;specular_hardness&quot;</span>;
<a name="l00536"></a>00536             
<a name="l00537"></a>00537         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a86d116d963e0de15fd294ad657f1d704">MA_SPTR</a>:
<a name="l00538"></a>00538             <span class="keywordflow">return</span> <span class="stringliteral">&quot;specular_opacity&quot;</span>;
<a name="l00539"></a>00539             
<a name="l00540"></a>00540         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a37098237c95c5af8aea47c3891ee3108">MA_IOR</a>:
<a name="l00541"></a>00541             <span class="keywordflow">return</span> <span class="stringliteral">&quot;ior&quot;</span>;
<a name="l00542"></a>00542             
<a name="l00543"></a>00543         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a15da88cc7434348d153fbda74c047f4a">MA_HASIZE</a>:
<a name="l00544"></a>00544             <span class="keywordflow">return</span> <span class="stringliteral">&quot;halo.size&quot;</span>;
<a name="l00545"></a>00545             
<a name="l00546"></a>00546         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aaec9c2116a791632fc242e366a2c3ff9">MA_TRANSLU</a>:
<a name="l00547"></a>00547             <span class="keywordflow">return</span> <span class="stringliteral">&quot;translucency&quot;</span>;
<a name="l00548"></a>00548             
<a name="l00549"></a>00549         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab68ad6789f74055bdb428b030f2ff3c2">MA_RAYM</a>:
<a name="l00550"></a>00550             <span class="keywordflow">return</span> <span class="stringliteral">&quot;raytrace_mirror.reflect&quot;</span>;
<a name="l00551"></a>00551             
<a name="l00552"></a>00552         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad2514664e78f6c0526c267b6dadf5cea">MA_FRESMIR</a>:
<a name="l00553"></a>00553             <span class="keywordflow">return</span> <span class="stringliteral">&quot;raytrace_mirror.fresnel&quot;</span>;
<a name="l00554"></a>00554             
<a name="l00555"></a>00555         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab1181f8a09a69ca7b91722b5ffebdabd">MA_FRESMIRI</a>:
<a name="l00556"></a>00556             <span class="keywordflow">return</span> <span class="stringliteral">&quot;raytrace_mirror.fresnel_factor&quot;</span>;
<a name="l00557"></a>00557             
<a name="l00558"></a>00558         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3989b4e5fc383fed3e25bd7ee597a24c">MA_FRESTRA</a>:
<a name="l00559"></a>00559             <span class="keywordflow">return</span> <span class="stringliteral">&quot;raytrace_transparency.fresnel&quot;</span>;
<a name="l00560"></a>00560             
<a name="l00561"></a>00561         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aadb70f63ec22e0f8e5e264013903927e">MA_FRESTRAI</a>:
<a name="l00562"></a>00562             <span class="keywordflow">return</span> <span class="stringliteral">&quot;raytrace_transparency.fresnel_factor&quot;</span>;
<a name="l00563"></a>00563             
<a name="l00564"></a>00564         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a5032ed6349f01eef67746867b0a1b7fc">MA_ADD</a>:
<a name="l00565"></a>00565             <span class="keywordflow">return</span> <span class="stringliteral">&quot;halo.add&quot;</span>;
<a name="l00566"></a>00566         
<a name="l00567"></a>00567         <span class="keywordflow">default</span>: <span class="comment">/* for now, we assume that the others were MTex channels */</span>
<a name="l00568"></a>00568             <span class="keywordflow">return</span> <a class="code" href="../../da/d8f/ipo_8c.html#afeedeae2e9d25eb8f9442dec8969cb15">mtex_adrcodes_to_paths</a>(adrcode, array_index);
<a name="l00569"></a>00569     }
<a name="l00570"></a>00570     
<a name="l00571"></a>00571     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;    
<a name="l00572"></a>00572 }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 <span class="comment">/* Camera Types */</span>
<a name="l00575"></a><a class="code" href="../../da/d8f/ipo_8c.html#aa9577338db0521e8b9e9a4b1faf08d06">00575</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#aa9577338db0521e8b9e9a4b1faf08d06">camera_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00576"></a>00576 {
<a name="l00577"></a>00577     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00578"></a>00578     *array_index= 0;
<a name="l00579"></a>00579     
<a name="l00580"></a>00580     <span class="comment">/* result depends on adrcode */</span>
<a name="l00581"></a>00581     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00582"></a>00582         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a781efe052297937d6f30e8fa12c30e10">CAM_LENS</a>:
<a name="l00583"></a>00583 <span class="preprocessor">#if 0 // XXX this cannot be resolved easily... perhaps we assume camera is perspective (works for most cases...</span>
<a name="l00584"></a>00584 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (ca-&gt;type == <a class="code" href="../../d6/d3b/DNA__camera__types_8h.html#a75085da10f07c9a36e9a305ca2ecc6d8">CAM_ORTHO</a>)
<a name="l00585"></a>00585                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;ortho_scale&quot;</span>;
<a name="l00586"></a>00586             <span class="keywordflow">else</span>
<a name="l00587"></a>00587                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;lens&quot;</span>; 
<a name="l00588"></a>00588 <span class="preprocessor">#else // XXX lazy hack for now...</span>
<a name="l00589"></a>00589 <span class="preprocessor"></span>            <span class="keywordflow">return</span> <span class="stringliteral">&quot;lens&quot;</span>;
<a name="l00590"></a>00590 <span class="preprocessor">#endif // XXX this cannot be resolved easily</span>
<a name="l00591"></a>00591 <span class="preprocessor"></span>            
<a name="l00592"></a>00592         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a78de23f58a844c644eabb3701913581e">CAM_STA</a>:
<a name="l00593"></a>00593             <span class="keywordflow">return</span> <span class="stringliteral">&quot;clip_start&quot;</span>;
<a name="l00594"></a>00594         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9257ebf2ba7f0a76a67212b6709b7d49">CAM_END</a>:
<a name="l00595"></a>00595             <span class="keywordflow">return</span> <span class="stringliteral">&quot;clip_end&quot;</span>;
<a name="l00596"></a>00596             
<a name="l00597"></a>00597 <span class="preprocessor">#if 0 // XXX these are not defined in RNA</span>
<a name="l00598"></a>00598 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#af6a76cc5ef0ac7f23ae307adc044790f">CAM_YF_APERT</a>:
<a name="l00599"></a>00599             poin= &amp;(ca-&gt;YF_aperture); <span class="keywordflow">break</span>;
<a name="l00600"></a>00600         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad5c0b0b4a606d8e64662cda819c5953d">CAM_YF_FDIST</a>:
<a name="l00601"></a>00601             poin= &amp;(ca-&gt;YF_dofdist); <span class="keywordflow">break</span>;
<a name="l00602"></a>00602 <span class="preprocessor">#endif // XXX these are not defined in RNA</span>
<a name="l00603"></a>00603 <span class="preprocessor"></span>            
<a name="l00604"></a>00604         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a049e119bfa62c6784afd18a603ff8963">CAM_SHIFT_X</a>:
<a name="l00605"></a>00605             <span class="keywordflow">return</span> <span class="stringliteral">&quot;shift_x&quot;</span>;
<a name="l00606"></a>00606         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a605e031c79f3454d310cdfa25bfc6eaa">CAM_SHIFT_Y</a>:
<a name="l00607"></a>00607             <span class="keywordflow">return</span> <span class="stringliteral">&quot;shift_y&quot;</span>;
<a name="l00608"></a>00608     }
<a name="l00609"></a>00609     
<a name="l00610"></a>00610     <span class="comment">/* unrecognised adrcode, or not-yet-handled ones! */</span>
<a name="l00611"></a>00611     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00612"></a>00612 }
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 <span class="comment">/* Lamp Types */</span>
<a name="l00615"></a><a class="code" href="../../da/d8f/ipo_8c.html#a7c11c44c5755914a1017de93d876cae5">00615</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#a7c11c44c5755914a1017de93d876cae5">lamp_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00616"></a>00616 {
<a name="l00617"></a>00617     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00618"></a>00618     *array_index= 0;
<a name="l00619"></a>00619     
<a name="l00620"></a>00620     <span class="comment">/* result depends on adrcode */</span>
<a name="l00621"></a>00621     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00622"></a>00622         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a54106cb9e239e4881d803360867fd4b2">LA_ENERGY</a>:
<a name="l00623"></a>00623             <span class="keywordflow">return</span> <span class="stringliteral">&quot;energy&quot;</span>;
<a name="l00624"></a>00624             
<a name="l00625"></a>00625         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ae29f38034b8fa0b70ea821d5626f1b5b">LA_COL_R</a>:
<a name="l00626"></a>00626             *array_index= 0;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;color&quot;</span>;
<a name="l00627"></a>00627         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6ca9c7f84712026f9ed2639f8b099e0a">LA_COL_G</a>:
<a name="l00628"></a>00628             *array_index= 1;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;color&quot;</span>;
<a name="l00629"></a>00629         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a62b72fd04690a57cfde9d6d941647a50">LA_COL_B</a>:
<a name="l00630"></a>00630             *array_index= 2;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;color&quot;</span>;
<a name="l00631"></a>00631             
<a name="l00632"></a>00632         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a86400d3193856acc0559adc2f9639a22">LA_DIST</a>:
<a name="l00633"></a>00633             <span class="keywordflow">return</span> <span class="stringliteral">&quot;distance&quot;</span>;
<a name="l00634"></a>00634         
<a name="l00635"></a>00635         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6aeebe994021bdc19bd4f296c2cba5dc">LA_SPOTSI</a>:
<a name="l00636"></a>00636             <span class="keywordflow">return</span> <span class="stringliteral">&quot;spot_size&quot;</span>;
<a name="l00637"></a>00637         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac141f3fc1cdbb5a746c2db9fa7f31f5b">LA_SPOTBL</a>:
<a name="l00638"></a>00638             <span class="keywordflow">return</span> <span class="stringliteral">&quot;spot_blend&quot;</span>;
<a name="l00639"></a>00639             
<a name="l00640"></a>00640         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab6c13eb9fb05d1af9de69a9482142334">LA_QUAD1</a>:
<a name="l00641"></a>00641             <span class="keywordflow">return</span> <span class="stringliteral">&quot;linear_attenuation&quot;</span>;
<a name="l00642"></a>00642         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a5e38586e91798832b74f553929367b29">LA_QUAD2</a>:
<a name="l00643"></a>00643             <span class="keywordflow">return</span> <span class="stringliteral">&quot;quadratic_attenuation&quot;</span>;
<a name="l00644"></a>00644             
<a name="l00645"></a>00645         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a668bcce6fffff3028fef842395d32d1a">LA_HALOINT</a>:
<a name="l00646"></a>00646             <span class="keywordflow">return</span> <span class="stringliteral">&quot;halo_intensity&quot;</span>;
<a name="l00647"></a>00647             
<a name="l00648"></a>00648         <span class="keywordflow">default</span>: <span class="comment">/* for now, we assume that the others were MTex channels */</span>
<a name="l00649"></a>00649             <span class="keywordflow">return</span> <a class="code" href="../../da/d8f/ipo_8c.html#afeedeae2e9d25eb8f9442dec8969cb15">mtex_adrcodes_to_paths</a>(adrcode, array_index);
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651     
<a name="l00652"></a>00652     <span class="comment">/* unrecognised adrcode, or not-yet-handled ones! */</span>
<a name="l00653"></a>00653     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00654"></a>00654 }
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 <span class="comment">/* Sound Types */</span>
<a name="l00657"></a><a class="code" href="../../da/d8f/ipo_8c.html#a5b192d0c6e7fb0a356994c9de168338f">00657</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#a5b192d0c6e7fb0a356994c9de168338f">sound_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00658"></a>00658 {
<a name="l00659"></a>00659     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00660"></a>00660     *array_index= 0;
<a name="l00661"></a>00661     
<a name="l00662"></a>00662     <span class="comment">/* result depends on adrcode */</span>
<a name="l00663"></a>00663     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00664"></a>00664         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a86aa02aa7d70da3edf70f5cec827a9c3">SND_VOLUME</a>:
<a name="l00665"></a>00665             <span class="keywordflow">return</span> <span class="stringliteral">&quot;volume&quot;</span>;
<a name="l00666"></a>00666         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a56ca20ea11720cbc9f6a15c09914f87a">SND_PITCH</a>:
<a name="l00667"></a>00667             <span class="keywordflow">return</span> <span class="stringliteral">&quot;pitch&quot;</span>;
<a name="l00668"></a>00668     <span class="comment">/* XXX Joshua -- I had wrapped panning in rna, but someone commented out, calling it &quot;unused&quot; */</span>
<a name="l00669"></a>00669 <span class="preprocessor">#if 0</span>
<a name="l00670"></a>00670 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa3fe00c7ce3ebd0347001c6b40f04bf1">SND_PANNING</a>:
<a name="l00671"></a>00671             <span class="keywordflow">return</span> <span class="stringliteral">&quot;panning&quot;</span>;
<a name="l00672"></a>00672 <span class="preprocessor">#endif</span>
<a name="l00673"></a>00673 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a09215bb7f7964a18f49b49d763a5c708">SND_ATTEN</a>:
<a name="l00674"></a>00674             <span class="keywordflow">return</span> <span class="stringliteral">&quot;attenuation&quot;</span>;
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676     
<a name="l00677"></a>00677     <span class="comment">/* unrecognised adrcode, or not-yet-handled ones! */</span>
<a name="l00678"></a>00678     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00681"></a>00681 <span class="comment">/* World Types */</span>
<a name="l00682"></a><a class="code" href="../../da/d8f/ipo_8c.html#aced382f5cd1cf2d8b1f59a61f57b9aeb">00682</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#aced382f5cd1cf2d8b1f59a61f57b9aeb">world_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00683"></a>00683 {
<a name="l00684"></a>00684     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00685"></a>00685     *array_index= 0;
<a name="l00686"></a>00686     
<a name="l00687"></a>00687     <span class="comment">/* result depends on adrcode */</span>
<a name="l00688"></a>00688     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00689"></a>00689         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#afbcf6caee0c51b01e2d59e81cbe96ab2">WO_HOR_R</a>:
<a name="l00690"></a>00690             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;horizon_color&quot;</span>;
<a name="l00691"></a>00691         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a70fe165dc7fbc3ec329e43ef6ae6ace1">WO_HOR_G</a>:
<a name="l00692"></a>00692             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;horizon_color&quot;</span>;
<a name="l00693"></a>00693         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac51f0d029c1fce5a9d5cfe64e57bf9d0">WO_HOR_B</a>:
<a name="l00694"></a>00694             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;horizon_color&quot;</span>;
<a name="l00695"></a>00695         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a59779b37ff8492c6fcd8c26bec59f0e7">WO_ZEN_R</a>:
<a name="l00696"></a>00696             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;zenith_color&quot;</span>;
<a name="l00697"></a>00697         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a0bc6c365130dc0bfbb918d912af9feb5">WO_ZEN_G</a>:
<a name="l00698"></a>00698             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;zenith_color&quot;</span>;
<a name="l00699"></a>00699         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aaee9c6bda1f9612e507cae5f63bd41fd">WO_ZEN_B</a>:
<a name="l00700"></a>00700             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;zenith_color&quot;</span>;
<a name="l00701"></a>00701         
<a name="l00702"></a>00702         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a5d7422c5d8b22616f4b835e47a470529">WO_EXPOS</a>:
<a name="l00703"></a>00703             <span class="keywordflow">return</span> <span class="stringliteral">&quot;exposure&quot;</span>;
<a name="l00704"></a>00704         
<a name="l00705"></a>00705         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa13fd5c2bb34bb0e7e9e940dfceb24da">WO_MISI</a>:
<a name="l00706"></a>00706             <span class="keywordflow">return</span> <span class="stringliteral">&quot;mist.intensity&quot;</span>;
<a name="l00707"></a>00707         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a443a5967fc22491c2bdd41418bd12abf">WO_MISTDI</a>:
<a name="l00708"></a>00708             <span class="keywordflow">return</span> <span class="stringliteral">&quot;mist.depth&quot;</span>;
<a name="l00709"></a>00709         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad1270457072c86991bf66707937f9a7a">WO_MISTSTA</a>:
<a name="l00710"></a>00710             <span class="keywordflow">return</span> <span class="stringliteral">&quot;mist.start&quot;</span>;
<a name="l00711"></a>00711         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a39b0b11b847ee54ac82ae49677e778fc">WO_MISTHI</a>:
<a name="l00712"></a>00712             <span class="keywordflow">return</span> <span class="stringliteral">&quot;mist.height&quot;</span>;
<a name="l00713"></a>00713 
<a name="l00714"></a>00714         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a92134c442143390eaedb638d141c7058">WO_STAR_R</a>:
<a name="l00715"></a>00715         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad1ac6404b2c1c03147c22c8e3def3e7c">WO_STAR_G</a>:
<a name="l00716"></a>00716         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a03d37d16d2d82e11be0a5c8fc3c2100e">WO_STAR_B</a>:
<a name="l00717"></a>00717             printf(<span class="stringliteral">&quot;WARNING: WO_STAR_R/G/B deprecated\n&quot;</span>);
<a name="l00718"></a>00718             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00719"></a>00719         
<a name="l00720"></a>00720         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a1a726fc5071014f3856dae17856acf1c">WO_STARDIST</a>:
<a name="l00721"></a>00721             <span class="keywordflow">return</span> <span class="stringliteral">&quot;stars.min_distance&quot;</span>;
<a name="l00722"></a>00722         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa0344b81982d580b165efc2b355f36b0">WO_STARSIZE</a>:
<a name="l00723"></a>00723             <span class="keywordflow">return</span> <span class="stringliteral">&quot;stars.size&quot;</span>;
<a name="l00724"></a>00724         
<a name="l00725"></a>00725         <span class="keywordflow">default</span>: <span class="comment">/* for now, we assume that the others were MTex channels */</span>
<a name="l00726"></a>00726             <span class="keywordflow">return</span> <a class="code" href="../../da/d8f/ipo_8c.html#afeedeae2e9d25eb8f9442dec8969cb15">mtex_adrcodes_to_paths</a>(adrcode, array_index);
<a name="l00727"></a>00727         }
<a name="l00728"></a>00728         
<a name="l00729"></a>00729     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;    
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 <span class="comment">/* Particle Types */</span>
<a name="l00733"></a><a class="code" href="../../da/d8f/ipo_8c.html#acec21cc0c5756a018540be83d66fae69">00733</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#acec21cc0c5756a018540be83d66fae69">particle_adrcodes_to_paths</a> (<span class="keywordtype">int</span> adrcode, <span class="keywordtype">int</span> *array_index)
<a name="l00734"></a>00734 {
<a name="l00735"></a>00735     <span class="comment">/* set array index like this in-case nothing sets it correctly  */</span>
<a name="l00736"></a>00736     *array_index= 0;
<a name="l00737"></a>00737     
<a name="l00738"></a>00738     <span class="comment">/* result depends on adrcode */</span>
<a name="l00739"></a>00739     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00740"></a>00740         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4f444874ba8b64c6b3b59b2cbce467e1">PART_CLUMP</a>:
<a name="l00741"></a>00741             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.clump_factor&quot;</span>;
<a name="l00742"></a>00742         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4209080a55d5ee884e5583077229df75">PART_AVE</a>:
<a name="l00743"></a>00743             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.angular_velocity_factor&quot;</span>;
<a name="l00744"></a>00744         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a8fa79e660e95274d9b77427fa7535a23">PART_SIZE</a>:
<a name="l00745"></a>00745             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.particle_size&quot;</span>;
<a name="l00746"></a>00746         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#af78cb63778801077e68ac24c0a3e3120">PART_DRAG</a>:
<a name="l00747"></a>00747             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.drag_factor&quot;</span>;
<a name="l00748"></a>00748         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac15ccf8b021afd3f44621a4c4ff192fe">PART_BROWN</a>:
<a name="l00749"></a>00749             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.brownian_factor&quot;</span>;
<a name="l00750"></a>00750         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a0ef06f9d6c30c8ab7f5d6545aacf78c3">PART_DAMP</a>:
<a name="l00751"></a>00751             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.damp_factor&quot;</span>;
<a name="l00752"></a>00752         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a853eb286b5e884e260a834e0a6119082">PART_LENGTH</a>:
<a name="l00753"></a>00753             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.length&quot;</span>;
<a name="l00754"></a>00754         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#abbd9031c949c98501812fdb3368708f2">PART_GRAV_X</a>:
<a name="l00755"></a>00755             *array_index= 0; <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.acceleration&quot;</span>;
<a name="l00756"></a>00756         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#acfd456ed8d89c00aa4796586539d9deb">PART_GRAV_Y</a>:
<a name="l00757"></a>00757             *array_index= 1; <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.acceleration&quot;</span>;
<a name="l00758"></a>00758         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ae1f1908e5bff211e308d674a04d94e98">PART_GRAV_Z</a>:
<a name="l00759"></a>00759             *array_index= 2; <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.acceleration&quot;</span>;
<a name="l00760"></a>00760         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#abc82cb0d435b82088d922a3360df8436">PART_KINK_AMP</a>:
<a name="l00761"></a>00761             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.kink_amplitude&quot;</span>;
<a name="l00762"></a>00762         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6cf6b0d9fd98186dccfcddd4dec1012e">PART_KINK_FREQ</a>:
<a name="l00763"></a>00763             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.kink_frequency&quot;</span>;
<a name="l00764"></a>00764         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a741ccf862c665090e22c9577631e71a8">PART_KINK_SHAPE</a>:
<a name="l00765"></a>00765             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.kink_shape&quot;</span>;
<a name="l00766"></a>00766         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#acd494f560fac9ad9dd8d4541c8868932">PART_BB_TILT</a>:
<a name="l00767"></a>00767             <span class="keywordflow">return</span> <span class="stringliteral">&quot;settings.billboard_tilt&quot;</span>;
<a name="l00768"></a>00768         
<a name="l00769"></a>00769         <span class="comment">/* PartDeflect needs to be sorted out properly in rna_object_force;</span>
<a name="l00770"></a>00770 <span class="comment">         * If anyone else works on this, but is unfamiliar, these particular</span>
<a name="l00771"></a>00771 <span class="comment">         * settings reference the particles of the system themselves</span>
<a name="l00772"></a>00772 <span class="comment">         * being used as forces -- it will use the same rna structure</span>
<a name="l00773"></a>00773 <span class="comment">         * as the similar object forces */</span>
<a name="l00774"></a>00774 <span class="preprocessor">#if 0</span>
<a name="l00775"></a>00775 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a24a17d8b6c9326c92db42ee4d0b60998">PART_PD_FSTR</a>:
<a name="l00776"></a>00776             <span class="keywordflow">if</span> (part-&gt;pd) poin= &amp;(part-&gt;pd-&gt;f_strength);
<a name="l00777"></a>00777             <span class="keywordflow">break</span>;
<a name="l00778"></a>00778         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a4d76993cfe869806830cb76305b09077">PART_PD_FFALL</a>:
<a name="l00779"></a>00779             <span class="keywordflow">if</span> (part-&gt;pd) poin= &amp;(part-&gt;pd-&gt;f_power);
<a name="l00780"></a>00780             <span class="keywordflow">break</span>;
<a name="l00781"></a>00781         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a44d21c143820fd5bde534fac74015998">PART_PD_FMAXD</a>:
<a name="l00782"></a>00782             <span class="keywordflow">if</span> (part-&gt;pd) poin= &amp;(part-&gt;pd-&gt;maxdist);
<a name="l00783"></a>00783             <span class="keywordflow">break</span>;
<a name="l00784"></a>00784         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad5a4082d8f8b4922d95ef7978cec67ab">PART_PD2_FSTR</a>:
<a name="l00785"></a>00785             <span class="keywordflow">if</span> (part-&gt;pd2) poin= &amp;(part-&gt;pd2-&gt;f_strength);
<a name="l00786"></a>00786             <span class="keywordflow">break</span>;
<a name="l00787"></a>00787         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a60020c332fb53733646b2fead8d4ce22">PART_PD2_FFALL</a>:
<a name="l00788"></a>00788             <span class="keywordflow">if</span> (part-&gt;pd2) poin= &amp;(part-&gt;pd2-&gt;f_power);
<a name="l00789"></a>00789             <span class="keywordflow">break</span>;
<a name="l00790"></a>00790         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6d7a8f15ca22e1931445a25129a9d929">PART_PD2_FMAXD</a>:
<a name="l00791"></a>00791             <span class="keywordflow">if</span> (part-&gt;pd2) poin= &amp;(part-&gt;pd2-&gt;maxdist);
<a name="l00792"></a>00792             <span class="keywordflow">break</span>;
<a name="l00793"></a>00793 <span class="preprocessor">#endif</span>
<a name="l00794"></a>00794 <span class="preprocessor"></span>
<a name="l00795"></a>00795     }
<a name="l00796"></a>00796 
<a name="l00797"></a>00797     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00798"></a>00798 }
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 <span class="comment">/* ------- */</span>
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 <span class="comment">/* Allocate memory for RNA-path for some property given a blocktype, adrcode, and &#39;root&#39; parts of path</span>
<a name="l00803"></a>00803 <span class="comment"> *  Input:</span>
<a name="l00804"></a>00804 <span class="comment"> *      - blocktype, adrcode    - determines setting to get</span>
<a name="l00805"></a>00805 <span class="comment"> *      - actname, constname,seq - used to build path</span>
<a name="l00806"></a>00806 <span class="comment"> *  Output:</span>
<a name="l00807"></a>00807 <span class="comment"> *      - array_index           - index in property&#39;s array (if applicable) to use</span>
<a name="l00808"></a>00808 <span class="comment"> *      - return                - the allocated path...</span>
<a name="l00809"></a>00809 <span class="comment"> */</span>
<a name="l00810"></a><a class="code" href="../../da/d8f/ipo_8c.html#aff35613743894522d16717f58370d074">00810</a> <span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d8f/ipo_8c.html#aff35613743894522d16717f58370d074">get_rna_access</a> (<span class="keywordtype">int</span> blocktype, <span class="keywordtype">int</span> adrcode, <span class="keywordtype">char</span> actname[], <span class="keywordtype">char</span> constname[], <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, <span class="keywordtype">int</span> *array_index)
<a name="l00811"></a>00811 {
<a name="l00812"></a>00812     <a class="code" href="../../d4/de5/structDynStr.html">DynStr</a> *path= <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#ae83ee20abb290558ce2e8f151ed54227">BLI_dynstr_new</a>();
<a name="l00813"></a>00813     <span class="keyword">const</span> <span class="keywordtype">char</span> *propname=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00814"></a>00814     <span class="keywordtype">char</span> *rpath=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00815"></a>00815     <span class="keywordtype">char</span> buf[512];
<a name="l00816"></a>00816     <span class="keywordtype">int</span> dummy_index= 0;
<a name="l00817"></a>00817     
<a name="l00818"></a>00818     <span class="comment">/* hack: if constname is set, we can only be dealing with an Constraint curve */</span>
<a name="l00819"></a>00819     <span class="keywordflow">if</span> (constname)
<a name="l00820"></a>00820         blocktype= <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a15c8d2ae0dac5ad5ec7210020a4ca0f5">ID_CO</a>;
<a name="l00821"></a>00821     
<a name="l00822"></a>00822     <span class="comment">/* get property name based on blocktype */</span>
<a name="l00823"></a>00823     <span class="keywordflow">switch</span> (blocktype) {
<a name="l00824"></a>00824         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>: <span class="comment">/* object */</span>
<a name="l00825"></a>00825             propname= <a class="code" href="../../da/d8f/ipo_8c.html#a10abdd8fd8401aee157c0b91272a1717">ob_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00826"></a>00826             <span class="keywordflow">break</span>;
<a name="l00827"></a>00827         
<a name="l00828"></a>00828         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ae023c9fde422e208a00e982711ea8add">ID_PO</a>: <span class="comment">/* pose channel */</span>
<a name="l00829"></a>00829             propname= <a class="code" href="../../da/d8f/ipo_8c.html#a3b7814c3e40d4668a76c26a7581e250c">pchan_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00830"></a>00830             <span class="keywordflow">break</span>;
<a name="l00831"></a>00831             
<a name="l00832"></a>00832         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a46c0b029a6e8fc3d7ebb18311b83397d">ID_KE</a>: <span class="comment">/* shapekeys */</span>
<a name="l00833"></a>00833             propname= <a class="code" href="../../da/d8f/ipo_8c.html#a4c149095377e213b861e32dc4750cb5a">shapekey_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00834"></a>00834             <span class="keywordflow">break</span>;
<a name="l00835"></a>00835             
<a name="l00836"></a>00836         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a15c8d2ae0dac5ad5ec7210020a4ca0f5">ID_CO</a>: <span class="comment">/* constraint */</span>
<a name="l00837"></a>00837             propname= <a class="code" href="../../da/d8f/ipo_8c.html#a88b2f482eb3ef9df0310f9114c5d4792">constraint_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);  
<a name="l00838"></a>00838             <span class="keywordflow">break</span>;
<a name="l00839"></a>00839             
<a name="l00840"></a>00840         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>: <span class="comment">/* texture */</span>
<a name="l00841"></a>00841             propname= <a class="code" href="../../da/d8f/ipo_8c.html#a84f84bc78d24d0e2082f6028bb765ea4">texture_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00842"></a>00842             <span class="keywordflow">break</span>;
<a name="l00843"></a>00843             
<a name="l00844"></a>00844         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>: <span class="comment">/* material */</span>
<a name="l00845"></a>00845             propname= <a class="code" href="../../da/d8f/ipo_8c.html#ac01be44507eed239ac7e8c930c841ad7">material_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00846"></a>00846             <span class="keywordflow">break</span>;
<a name="l00847"></a>00847             
<a name="l00848"></a>00848         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82bdb2fdea7abee55d993c0210101273">ID_CA</a>: <span class="comment">/* camera */</span>
<a name="l00849"></a>00849             propname= <a class="code" href="../../da/d8f/ipo_8c.html#aa9577338db0521e8b9e9a4b1faf08d06">camera_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00850"></a>00850             <span class="keywordflow">break</span>;
<a name="l00851"></a>00851             
<a name="l00852"></a>00852         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>: <span class="comment">/* lamp */</span>
<a name="l00853"></a>00853             propname= <a class="code" href="../../da/d8f/ipo_8c.html#a7c11c44c5755914a1017de93d876cae5">lamp_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00854"></a>00854             <span class="keywordflow">break</span>;
<a name="l00855"></a>00855         
<a name="l00856"></a>00856         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a3bae74282a62fb44842ff3767a86ec70">ID_SO</a>: <span class="comment">/* sound */</span>
<a name="l00857"></a>00857             propname= <a class="code" href="../../da/d8f/ipo_8c.html#a5b192d0c6e7fb0a356994c9de168338f">sound_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00858"></a>00858             <span class="keywordflow">break</span>;
<a name="l00859"></a>00859         
<a name="l00860"></a>00860         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>: <span class="comment">/* world */</span>
<a name="l00861"></a>00861             propname= <a class="code" href="../../da/d8f/ipo_8c.html#aced382f5cd1cf2d8b1f59a61f57b9aeb">world_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00862"></a>00862             <span class="keywordflow">break</span>;
<a name="l00863"></a>00863         
<a name="l00864"></a>00864         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa64d54c8b860f4a2c7cabc743f60512e">ID_PA</a>: <span class="comment">/* particle */</span>
<a name="l00865"></a>00865             propname= <a class="code" href="../../da/d8f/ipo_8c.html#acec21cc0c5756a018540be83d66fae69">particle_adrcodes_to_paths</a>(adrcode, &amp;dummy_index);
<a name="l00866"></a>00866             <span class="keywordflow">break</span>;
<a name="l00867"></a>00867             
<a name="l00868"></a>00868         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ace150506eaf644d92a5110cf45978379">ID_CU</a>: <span class="comment">/* curve */</span>
<a name="l00869"></a>00869             <span class="comment">/* this used to be a &#39;dummy&#39; curve which got evaluated on the fly... </span>
<a name="l00870"></a>00870 <span class="comment">             * now we&#39;ve got real var for this!</span>
<a name="l00871"></a>00871 <span class="comment">             */</span>
<a name="l00872"></a>00872             propname= <span class="stringliteral">&quot;eval_time&quot;</span>;
<a name="l00873"></a>00873             <span class="keywordflow">break</span>;
<a name="l00874"></a>00874         
<a name="l00875"></a>00875         <span class="comment">/* XXX problematic blocktypes */</span>        
<a name="l00876"></a>00876         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ab17ab987c89f0b1ebb87538e4baba89c">ID_SEQ</a>: <span class="comment">/* sequencer strip */</span>
<a name="l00877"></a>00877             <span class="comment">//SEQ_FAC1:</span>
<a name="l00878"></a>00878             <span class="keywordflow">switch</span> (adrcode) {
<a name="l00879"></a>00879             <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac04d1b308ef4cb687b1e4bef3ea30f1b">SEQ_FAC1</a>:
<a name="l00880"></a>00880                 propname= <span class="stringliteral">&quot;effect_fader&quot;</span>;
<a name="l00881"></a>00881                 <span class="keywordflow">break</span>;
<a name="l00882"></a>00882             <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a043caaa25e0595910987eb7a6646e3e6">SEQ_FAC_SPEED</a>:
<a name="l00883"></a>00883                 propname= <span class="stringliteral">&quot;speed_fader&quot;</span>;
<a name="l00884"></a>00884                 <span class="keywordflow">break</span>;
<a name="l00885"></a>00885             <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a44d9b5d716705c30878cad6278e915af">SEQ_FAC_OPACITY</a>:
<a name="l00886"></a>00886                 propname= <span class="stringliteral">&quot;blend_opacity&quot;</span>;
<a name="l00887"></a>00887                 <span class="keywordflow">break</span>;
<a name="l00888"></a>00888             }
<a name="l00889"></a>00889             <span class="comment">//  poin= &amp;(seq-&gt;facf0); // XXX this doesn&#39;t seem to be included anywhere in sequencer RNA...</span>
<a name="l00890"></a>00890             <span class="keywordflow">break</span>;
<a name="l00891"></a>00891             
<a name="l00892"></a>00892         <span class="comment">/* special hacks */</span>
<a name="l00893"></a>00893         <span class="keywordflow">case</span> -1:
<a name="l00894"></a>00894             <span class="comment">/* special case for rotdiff drivers... we don&#39;t need a property for this... */</span>
<a name="l00895"></a>00895             <span class="keywordflow">break</span>;
<a name="l00896"></a>00896             
<a name="l00897"></a>00897         <span class="comment">// TODO... add other blocktypes...</span>
<a name="l00898"></a>00898         <span class="keywordflow">default</span>:
<a name="l00899"></a>00899             printf(<span class="stringliteral">&quot;IPO2ANIMATO WARNING: No path for blocktype %d, adrcode %d yet\n&quot;</span>, blocktype, adrcode);
<a name="l00900"></a>00900             <span class="keywordflow">break</span>;
<a name="l00901"></a>00901     }
<a name="l00902"></a>00902     
<a name="l00903"></a>00903     <span class="comment">/* check if any property found </span>
<a name="l00904"></a>00904 <span class="comment">     *  - blocktype &lt; 0 is special case for a specific type of driver, where we don&#39;t need a property name...</span>
<a name="l00905"></a>00905 <span class="comment">     */</span>
<a name="l00906"></a>00906     <span class="keywordflow">if</span> ((propname == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (blocktype &gt; 0)) {
<a name="l00907"></a>00907         <span class="comment">/* nothing was found, so exit */</span>
<a name="l00908"></a>00908         <span class="keywordflow">if</span> (array_index) 
<a name="l00909"></a>00909             *array_index= 0;
<a name="l00910"></a>00910             
<a name="l00911"></a>00911         <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a3687f0d324bc2026a013872ce32d157a">BLI_dynstr_free</a>(path);
<a name="l00912"></a>00912         
<a name="l00913"></a>00913         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00914"></a>00914     }
<a name="l00915"></a>00915     <span class="keywordflow">else</span> {
<a name="l00916"></a>00916         <span class="keywordflow">if</span> (array_index)
<a name="l00917"></a>00917             *array_index= dummy_index;
<a name="l00918"></a>00918     }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920     <span class="comment">/* &#39;buf&#39; _must_ be initialized in this block */</span>
<a name="l00921"></a>00921     <span class="comment">/* append preceding bits to path */</span>
<a name="l00922"></a>00922     <span class="comment">/* note, strings are not escapted and they should be! */</span>
<a name="l00923"></a>00923     <span class="keywordflow">if</span> ((actname &amp;&amp; actname[0]) &amp;&amp; (constname &amp;&amp; constname[0])) {
<a name="l00924"></a>00924         <span class="comment">/* Constraint in Pose-Channel */</span>
<a name="l00925"></a>00925         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;pose.bones[\&quot;%s\&quot;].constraints[\&quot;%s\&quot;]&quot;</span>, actname, constname);
<a name="l00926"></a>00926     }
<a name="l00927"></a>00927     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (actname &amp;&amp; actname[0]) {
<a name="l00928"></a>00928         <span class="keywordflow">if</span> ((blocktype == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) &amp;&amp; strcmp(actname, <span class="stringliteral">&quot;Object&quot;</span>)==0) {
<a name="l00929"></a>00929             <span class="comment">/* Actionified &quot;Object&quot; IPO&#39;s... no extra path stuff needed */</span>
<a name="l00930"></a>00930             buf[0]= <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* empty string */</span>
<a name="l00931"></a>00931         }
<a name="l00932"></a>00932         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((blocktype == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a46c0b029a6e8fc3d7ebb18311b83397d">ID_KE</a>) &amp;&amp; strcmp(actname, <span class="stringliteral">&quot;Shape&quot;</span>)==0) {
<a name="l00933"></a>00933             <span class="comment">/* Actionified &quot;Shape&quot; IPO&#39;s - these are forced onto object level via the action container there... */</span>
<a name="l00934"></a>00934             strcpy(buf, <span class="stringliteral">&quot;data.shape_keys&quot;</span>);
<a name="l00935"></a>00935         }
<a name="l00936"></a>00936         <span class="keywordflow">else</span> {
<a name="l00937"></a>00937             <span class="comment">/* Pose-Channel */</span>
<a name="l00938"></a>00938             <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;pose.bones[\&quot;%s\&quot;]&quot;</span>, actname);
<a name="l00939"></a>00939         }
<a name="l00940"></a>00940     }
<a name="l00941"></a>00941     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (constname &amp;&amp; constname[0]) {
<a name="l00942"></a>00942         <span class="comment">/* Constraint in Object */</span>
<a name="l00943"></a>00943         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;constraints[\&quot;%s\&quot;]&quot;</span>, constname);
<a name="l00944"></a>00944     }
<a name="l00945"></a>00945     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq) {
<a name="l00946"></a>00946         <span class="comment">/* Sequence names in Scene */</span>
<a name="l00947"></a>00947         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;sequence_editor.sequences_all[\&quot;%s\&quot;]&quot;</span>, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a>+2);
<a name="l00948"></a>00948     }
<a name="l00949"></a>00949     <span class="keywordflow">else</span> {
<a name="l00950"></a>00950         buf[0]= <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* empty string */</span>
<a name="l00951"></a>00951     }
<a name="l00952"></a>00952 
<a name="l00953"></a>00953     <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a55db0fd7c4f2fd5714777dbbd56238b4">BLI_dynstr_append</a>(path, buf);
<a name="l00954"></a>00954     
<a name="l00955"></a>00955     <span class="comment">/* need to add dot before property if there was anything precceding this */</span>
<a name="l00956"></a>00956     <span class="keywordflow">if</span> (buf[0])
<a name="l00957"></a>00957         <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a55db0fd7c4f2fd5714777dbbd56238b4">BLI_dynstr_append</a>(path, <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00958"></a>00958     
<a name="l00959"></a>00959     <span class="comment">/* now write name of property */</span>
<a name="l00960"></a>00960     <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a55db0fd7c4f2fd5714777dbbd56238b4">BLI_dynstr_append</a>(path, propname);
<a name="l00961"></a>00961     
<a name="l00962"></a>00962     <span class="comment">/* if there was no array index pointer provided, add it to the path */</span>
<a name="l00963"></a>00963     <span class="keywordflow">if</span> (array_index == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00964"></a>00964         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;[\&quot;%d\&quot;]&quot;</span>, dummy_index);
<a name="l00965"></a>00965         <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a55db0fd7c4f2fd5714777dbbd56238b4">BLI_dynstr_append</a>(path, buf);
<a name="l00966"></a>00966     }
<a name="l00967"></a>00967     
<a name="l00968"></a>00968     <span class="comment">/* convert to normal MEM_malloc&#39;d string */</span>
<a name="l00969"></a>00969     rpath= <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a4ec5498b239c83c6657f206d2f2f4968">BLI_dynstr_get_cstring</a>(path);
<a name="l00970"></a>00970     <a class="code" href="../../d7/dc9/BLI__dynstr_8h.html#a3687f0d324bc2026a013872ce32d157a">BLI_dynstr_free</a>(path);
<a name="l00971"></a>00971     
<a name="l00972"></a>00972     <span class="comment">/* return path... */</span>
<a name="l00973"></a>00973     <span class="keywordflow">return</span> rpath;
<a name="l00974"></a>00974 }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 <span class="comment">/* *************************************************** */</span>
<a name="l00977"></a>00977 <span class="comment">/* Conversion Utilities */</span>
<a name="l00978"></a>00978 
<a name="l00979"></a>00979 <span class="comment">/* Convert adrcodes to driver target transform channel types */</span>
<a name="l00980"></a><a class="code" href="../../da/d8f/ipo_8c.html#ad62eff43b7eab6f7a24d44e7e4fb7e59">00980</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../da/d8f/ipo_8c.html#ad62eff43b7eab6f7a24d44e7e4fb7e59">adrcode_to_dtar_transchan</a> (<span class="keywordtype">short</span> adrcode)
<a name="l00981"></a>00981 {
<a name="l00982"></a>00982     <span class="keywordflow">switch</span> (adrcode) {
<a name="l00983"></a>00983         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a27e4792ca7662013defb5d5c49e4dd20">OB_LOC_X</a>:  
<a name="l00984"></a>00984             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a5848da19ed9a4f6ed651f2a72d320934">DTAR_TRANSCHAN_LOCX</a>;
<a name="l00985"></a>00985         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a513a340e950dce9c42a6a80f0a81c1a3">OB_LOC_Y</a>:
<a name="l00986"></a>00986             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a67d713accbb1094eb66ab7b0a384ae98">DTAR_TRANSCHAN_LOCY</a>;
<a name="l00987"></a>00987         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a8ae819f84d4bb50a0da0e9c118ff795b">OB_LOC_Z</a>:
<a name="l00988"></a>00988             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a9ac49d56e14be1e5c4829fc681407a31">DTAR_TRANSCHAN_LOCZ</a>;
<a name="l00989"></a>00989         
<a name="l00990"></a>00990         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab7f95025a9e7c3e44560ff3e47a47028">OB_ROT_X</a>:  
<a name="l00991"></a>00991             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a70d33ca7a36d12ef881637440c5cf792">DTAR_TRANSCHAN_ROTX</a>;
<a name="l00992"></a>00992         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a338abb6e4e4eded18bbe49c370fbb3a8">OB_ROT_Y</a>:
<a name="l00993"></a>00993             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6af1aa7afec8722590406e5e1e3482cb8f">DTAR_TRANSCHAN_ROTY</a>;
<a name="l00994"></a>00994         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a61d7f02a72a245dd8ce7ec193bc2c4a7">OB_ROT_Z</a>:
<a name="l00995"></a>00995             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a147aa4181f2e92ad5261d1e1c42e093c">DTAR_TRANSCHAN_ROTZ</a>;
<a name="l00996"></a>00996         
<a name="l00997"></a>00997         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#aa3a1560d910ff6faa215c4f4c9d9ba6b">OB_SIZE_X</a>: 
<a name="l00998"></a>00998             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a15006c0fdbe76393480898e805a8d527">DTAR_TRANSCHAN_SCALEX</a>;
<a name="l00999"></a>00999         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ad4b3dbae74fdc12e0e9f1f9115d45a17">OB_SIZE_Y</a>:
<a name="l01000"></a>01000             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a15006c0fdbe76393480898e805a8d527">DTAR_TRANSCHAN_SCALEX</a>;
<a name="l01001"></a>01001         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a3fb3e5dacaffada0c0615b0760843df6">OB_SIZE_Z</a>:
<a name="l01002"></a>01002             <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a15006c0fdbe76393480898e805a8d527">DTAR_TRANSCHAN_SCALEX</a>;
<a name="l01003"></a>01003             
<a name="l01004"></a>01004         <span class="keywordflow">default</span>:
<a name="l01005"></a>01005             <span class="keywordflow">return</span> 0;
<a name="l01006"></a>01006     }
<a name="l01007"></a>01007 }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 <span class="comment">/* Convert IpoDriver to ChannelDriver - will free the old data (i.e. the old driver) */</span>
<a name="l01010"></a><a class="code" href="../../da/d8f/ipo_8c.html#a8e4c390c63ff7cd8f5eeb9751a87a093">01010</a> <span class="keyword">static</span> <a class="code" href="../../d3/d1e/structChannelDriver.html">ChannelDriver</a> *<a class="code" href="../../da/d8f/ipo_8c.html#a8e4c390c63ff7cd8f5eeb9751a87a093">idriver_to_cdriver</a> (<a class="code" href="../../d0/d89/structIpoDriver.html">IpoDriver</a> *idriver)
<a name="l01011"></a>01011 {
<a name="l01012"></a>01012     <a class="code" href="../../d3/d1e/structChannelDriver.html">ChannelDriver</a> *cdriver;
<a name="l01013"></a>01013     
<a name="l01014"></a>01014     <span class="comment">/* allocate memory for new driver */</span>
<a name="l01015"></a>01015     cdriver= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d3/d1e/structChannelDriver.html">ChannelDriver</a>), <span class="stringliteral">&quot;ChannelDriver&quot;</span>);
<a name="l01016"></a>01016     
<a name="l01017"></a>01017     <span class="comment">/* if &#39;pydriver&#39;, just copy data across */</span>
<a name="l01018"></a>01018     <span class="keywordflow">if</span> (idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#ad722ea5c9983395019124612a07484cc">type</a> == <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a77fe1f6ee3f57a6f83b207cc9be57791">IPO_DRIVER_TYPE_PYTHON</a>) {
<a name="l01019"></a>01019         <span class="comment">/* PyDriver only requires the expression to be copied */</span>
<a name="l01020"></a>01020         <span class="comment">// FIXME: expression will be useless due to API changes, but at least not totally lost</span>
<a name="l01021"></a>01021         cdriver-&gt;<a class="code" href="../../d3/d1e/structChannelDriver.html#a3945d10db5e98f2de0797cef16a43fbb">type</a> = <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a473d8cf531a0db376806d5149760dfd3a373b8dd334d78c62a7d8f4726046dea8">DRIVER_TYPE_PYTHON</a>;
<a name="l01022"></a>01022         <span class="keywordflow">if</span> (idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>[0])
<a name="l01023"></a>01023             <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(cdriver-&gt;<a class="code" href="../../d3/d1e/structChannelDriver.html#ad47404498424ae42fcd4c2804edbf1c6">expression</a>, idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>, <span class="keyword">sizeof</span>(cdriver-&gt;<a class="code" href="../../d3/d1e/structChannelDriver.html#ad47404498424ae42fcd4c2804edbf1c6">expression</a>));
<a name="l01024"></a>01024     }
<a name="l01025"></a>01025     <span class="keywordflow">else</span> {
<a name="l01026"></a>01026         <a class="code" href="../../d1/d24/structDriverVar.html">DriverVar</a> *dvar = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01027"></a>01027         <a class="code" href="../../df/d26/structDriverTarget.html">DriverTarget</a> *dtar = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01028"></a>01028         
<a name="l01029"></a>01029         <span class="comment">/* this should be ok for all types here... */</span>
<a name="l01030"></a>01030         cdriver-&gt;<a class="code" href="../../d3/d1e/structChannelDriver.html#a3945d10db5e98f2de0797cef16a43fbb">type</a>= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a473d8cf531a0db376806d5149760dfd3a35f1be0ae17dc775aff78508a5243354">DRIVER_TYPE_AVERAGE</a>;
<a name="l01031"></a>01031         
<a name="l01032"></a>01032         <span class="comment">/* what to store depends on the &#39;blocktype&#39; - object or posechannel */</span>
<a name="l01033"></a>01033         <span class="keywordflow">if</span> (idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a1f2e0f645098290b1c7551bf8a888eb1">blocktype</a> == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ae4ba19f70b08895557ef00b489e7d255">ID_AR</a>) { <span class="comment">/* PoseChannel */</span>
<a name="l01034"></a>01034             <span class="keywordflow">if</span> (idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#ae770b3413bc8e560059250acc2ac9c6c">adrcode</a> == <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a75f18073a017e9ab7b6aa72043c41be1">OB_ROT_DIFF</a>) {
<a name="l01035"></a>01035                 <span class="comment">/* Rotational Difference requires a special type of variable */</span>
<a name="l01036"></a>01036                 dvar= <a class="code" href="../../da/dba/BKE__fcurve_8h.html#a8f9bdffc0203c985fe46a3d84f880f44">driver_add_new_variable</a>(cdriver);
<a name="l01037"></a>01037                 <a class="code" href="../../da/dba/BKE__fcurve_8h.html#af3943320f375173560fae0463cfad099">driver_change_variable_type</a>(dvar, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a5fab844c1ef7db8f17ccb4ae57b7934ca43572bc69ffd8cfd2858971d2c4acc7c">DVAR_TYPE_ROT_DIFF</a>);
<a name="l01038"></a>01038                 
<a name="l01039"></a>01039                     <span class="comment">/* first bone target */</span>
<a name="l01040"></a>01040                 dtar= &amp;dvar-&gt;<a class="code" href="../../d1/d24/structDriverVar.html#a7f717ae819c408739d15204e1de98219">targets</a>[0];
<a name="l01041"></a>01041                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#abf59e6fd45af3532b4a1342a4376eb59">id</a>= (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a9650006b4c72ef892c17e815f3a6c3dd">ob</a>;
<a name="l01042"></a>01042                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a1c85ea14f7bba0f2dd6e3b10dcc774e3">idtype</a>= <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>;
<a name="l01043"></a>01043                 <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>[0])
<a name="l01044"></a>01044                     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a13435e86fb1862e6c28c3d1dc797623f">pchan_name</a>, idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>, <span class="keyword">sizeof</span>(dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a13435e86fb1862e6c28c3d1dc797623f">pchan_name</a>));
<a name="l01045"></a>01045                 
<a name="l01046"></a>01046                     <span class="comment">/* second bone target (name was stored in same var as the first one) */</span>
<a name="l01047"></a>01047                 dtar= &amp;dvar-&gt;<a class="code" href="../../d1/d24/structDriverVar.html#a7f717ae819c408739d15204e1de98219">targets</a>[1];
<a name="l01048"></a>01048                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#abf59e6fd45af3532b4a1342a4376eb59">id</a>= (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a9650006b4c72ef892c17e815f3a6c3dd">ob</a>;
<a name="l01049"></a>01049                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a1c85ea14f7bba0f2dd6e3b10dcc774e3">idtype</a>= <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>;
<a name="l01050"></a>01050                 <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>[0]) <span class="comment">// xxx... for safety</span>
<a name="l01051"></a>01051                     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a13435e86fb1862e6c28c3d1dc797623f">pchan_name</a>, idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>+<a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9974e61d717a8dd98634af40d69b8e4a">DRIVER_NAME_OFFS</a>, <span class="keyword">sizeof</span>(dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a13435e86fb1862e6c28c3d1dc797623f">pchan_name</a>));
<a name="l01052"></a>01052             }
<a name="l01053"></a>01053             <span class="keywordflow">else</span> {
<a name="l01054"></a>01054                 <span class="comment">/* only a single variable, of type &#39;transform channel&#39; */</span>
<a name="l01055"></a>01055                 dvar= <a class="code" href="../../da/dba/BKE__fcurve_8h.html#a8f9bdffc0203c985fe46a3d84f880f44">driver_add_new_variable</a>(cdriver);
<a name="l01056"></a>01056                 <a class="code" href="../../da/dba/BKE__fcurve_8h.html#af3943320f375173560fae0463cfad099">driver_change_variable_type</a>(dvar, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a5fab844c1ef7db8f17ccb4ae57b7934ca189c989aa474667a72eeaa4db54dc750">DVAR_TYPE_TRANSFORM_CHAN</a>);
<a name="l01057"></a>01057                 
<a name="l01058"></a>01058                 <span class="comment">/* only requires a single target */</span>
<a name="l01059"></a>01059                 dtar= &amp;dvar-&gt;<a class="code" href="../../d1/d24/structDriverVar.html#a7f717ae819c408739d15204e1de98219">targets</a>[0];
<a name="l01060"></a>01060                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#abf59e6fd45af3532b4a1342a4376eb59">id</a>= (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a9650006b4c72ef892c17e815f3a6c3dd">ob</a>;
<a name="l01061"></a>01061                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a1c85ea14f7bba0f2dd6e3b10dcc774e3">idtype</a>= <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>;
<a name="l01062"></a>01062                 <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>[0])
<a name="l01063"></a>01063                     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a13435e86fb1862e6c28c3d1dc797623f">pchan_name</a>, idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a07490acc19e67e591bff72cb81f6372b">name</a>, <span class="keyword">sizeof</span>(dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a13435e86fb1862e6c28c3d1dc797623f">pchan_name</a>));
<a name="l01064"></a>01064                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#ac8ffdbbdaeb860c6685af1c5e8800cf1">transChan</a>= <a class="code" href="../../da/d8f/ipo_8c.html#ad62eff43b7eab6f7a24d44e7e4fb7e59">adrcode_to_dtar_transchan</a>(idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#ae770b3413bc8e560059250acc2ac9c6c">adrcode</a>);
<a name="l01065"></a>01065                 dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a475f0be35635c6f5f6b2d257a7b78440">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a9b0375da90726dfc722f08e00bfe898aa296d68de32f1844a319d4fa63ea6dc59">DTAR_FLAG_LOCALSPACE</a>; <span class="comment">/* old drivers took local space */</span>
<a name="l01066"></a>01066             }
<a name="l01067"></a>01067         }
<a name="l01068"></a>01068         <span class="keywordflow">else</span> { <span class="comment">/* Object */</span>
<a name="l01069"></a>01069             <span class="comment">/* only a single variable, of type &#39;transform channel&#39; */</span>
<a name="l01070"></a>01070             dvar= <a class="code" href="../../da/dba/BKE__fcurve_8h.html#a8f9bdffc0203c985fe46a3d84f880f44">driver_add_new_variable</a>(cdriver);
<a name="l01071"></a>01071             <a class="code" href="../../da/dba/BKE__fcurve_8h.html#af3943320f375173560fae0463cfad099">driver_change_variable_type</a>(dvar, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a5fab844c1ef7db8f17ccb4ae57b7934ca189c989aa474667a72eeaa4db54dc750">DVAR_TYPE_TRANSFORM_CHAN</a>);
<a name="l01072"></a>01072             
<a name="l01073"></a>01073                 <span class="comment">/* only requires single target */</span>
<a name="l01074"></a>01074             dtar= &amp;dvar-&gt;<a class="code" href="../../d1/d24/structDriverVar.html#a7f717ae819c408739d15204e1de98219">targets</a>[0];
<a name="l01075"></a>01075             dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#abf59e6fd45af3532b4a1342a4376eb59">id</a>= (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a9650006b4c72ef892c17e815f3a6c3dd">ob</a>;
<a name="l01076"></a>01076             dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#a1c85ea14f7bba0f2dd6e3b10dcc774e3">idtype</a>= <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>;
<a name="l01077"></a>01077             dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#ac8ffdbbdaeb860c6685af1c5e8800cf1">transChan</a>= <a class="code" href="../../da/d8f/ipo_8c.html#ad62eff43b7eab6f7a24d44e7e4fb7e59">adrcode_to_dtar_transchan</a>(idriver-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#ae770b3413bc8e560059250acc2ac9c6c">adrcode</a>);
<a name="l01078"></a>01078         }
<a name="l01079"></a>01079     }
<a name="l01080"></a>01080     
<a name="l01081"></a>01081     <span class="comment">/* return the new one */</span>
<a name="l01082"></a>01082     <span class="keywordflow">return</span> cdriver;
<a name="l01083"></a>01083 }
<a name="l01084"></a>01084 
<a name="l01085"></a>01085 <span class="comment">/* Add F-Curve to the correct list </span>
<a name="l01086"></a>01086 <span class="comment"> *  - grpname is needed to be used as group name where relevant, and is usually derived from actname</span>
<a name="l01087"></a>01087 <span class="comment"> */</span>
<a name="l01088"></a><a class="code" href="../../da/d8f/ipo_8c.html#adf04b43a928a1288c3ce615073d4f69f">01088</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d8f/ipo_8c.html#adf04b43a928a1288c3ce615073d4f69f">fcurve_add_to_list</a> (<a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *groups, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *list, <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu, <span class="keywordtype">char</span> *grpname, <span class="keywordtype">int</span> muteipo)
<a name="l01089"></a>01089 {
<a name="l01090"></a>01090     <span class="comment">/* If we&#39;re adding to an action, we will have groups to write to... */</span>
<a name="l01091"></a>01091     <span class="keywordflow">if</span> (groups &amp;&amp; grpname) {
<a name="l01092"></a>01092         <span class="comment">/* wrap the pointers given into a dummy action that we pass to the API func</span>
<a name="l01093"></a>01093 <span class="comment">         * and extract the resultant lists...</span>
<a name="l01094"></a>01094 <span class="comment">         */</span>
<a name="l01095"></a>01095         <a class="code" href="../../d1/d48/structbAction.html">bAction</a> tmp_act;
<a name="l01096"></a>01096         <a class="code" href="../../d9/dcf/structbActionGroup.html">bActionGroup</a> *agrp= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01097"></a>01097         
<a name="l01098"></a>01098         <span class="comment">/* init the temp action */</span>
<a name="l01099"></a>01099         memset(&amp;tmp_act, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d48/structbAction.html">bAction</a>)); <span class="comment">// XXX only enable this line if we get errors</span>
<a name="l01100"></a>01100         tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>= groups-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01101"></a>01101         tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>= groups-&gt;<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01102"></a>01102         tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>= list-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01103"></a>01103         tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>= list-&gt;<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01104"></a>01104         <span class="comment">/* ... xxx, the other vars don&#39;t need to be filled in */</span>
<a name="l01105"></a>01105         
<a name="l01106"></a>01106         <span class="comment">/* get the group to use */</span>
<a name="l01107"></a>01107         agrp= <a class="code" href="../../d8/df5/BKE__action_8h.html#aaad65e0df0ec53f58ea0de0848ab383e">action_groups_find_named</a>(&amp;tmp_act, grpname);
<a name="l01108"></a>01108         <span class="comment">/* no matching group, so add one */</span>
<a name="l01109"></a>01109         <span class="keywordflow">if</span> (agrp == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01110"></a>01110             <span class="comment">/* Add a new group, and make it active */</span>
<a name="l01111"></a>01111             agrp= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d9/dcf/structbActionGroup.html">bActionGroup</a>), <span class="stringliteral">&quot;bActionGroup&quot;</span>);
<a name="l01112"></a>01112 
<a name="l01113"></a>01113             agrp-&gt;<a class="code" href="../../d9/dcf/structbActionGroup.html#a5a04faf9cd6c23df183545e5842caf80">flag</a> = <a class="code" href="../../dc/d2a/DNA__action__types_8h.html#a23623a6a10ec8ae24a77f37cf2093d1ea4e494b4850b6143bde5856f59a714929">AGRP_SELECTED</a>;
<a name="l01114"></a>01114             <span class="keywordflow">if</span> (muteipo) agrp-&gt;<a class="code" href="../../d9/dcf/structbActionGroup.html#a5a04faf9cd6c23df183545e5842caf80">flag</a> |= <a class="code" href="../../dc/d2a/DNA__action__types_8h.html#a23623a6a10ec8ae24a77f37cf2093d1eadbdf95c56849acad8f9da5a96593bdad">AGRP_MUTED</a>;
<a name="l01115"></a>01115 
<a name="l01116"></a>01116             <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(agrp-&gt;<a class="code" href="../../d9/dcf/structbActionGroup.html#a40cae12763851806783e00f80f1e01ec">name</a>, grpname, <span class="keyword">sizeof</span>(agrp-&gt;<a class="code" href="../../d9/dcf/structbActionGroup.html#a40cae12763851806783e00f80f1e01ec">name</a>));
<a name="l01117"></a>01117 
<a name="l01118"></a>01118             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>, agrp);
<a name="l01119"></a>01119             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a584e08e337965c8bb232cf7ff28a0e13">BLI_uniquename</a>(&amp;tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>, agrp, <span class="stringliteral">&quot;Group&quot;</span>, <span class="charliteral">&#39;.&#39;</span>, offsetof(<a class="code" href="../../d9/dcf/structbActionGroup.html">bActionGroup</a>, name), <span class="keyword">sizeof</span>(agrp-&gt;<a class="code" href="../../d9/dcf/structbActionGroup.html#a40cae12763851806783e00f80f1e01ec">name</a>));
<a name="l01120"></a>01120         }
<a name="l01121"></a>01121         
<a name="l01122"></a>01122         <span class="comment">/* add F-Curve to group */</span>
<a name="l01123"></a>01123         <span class="comment">/* WARNING: this func should only need to look at the stuff we initialized, if not, things may crash */</span>
<a name="l01124"></a>01124         <a class="code" href="../../d8/df5/BKE__action_8h.html#ae14baf4ad9762b4f19df690a2496ce53">action_groups_add_channel</a>(&amp;tmp_act, agrp, fcu);
<a name="l01125"></a>01125         
<a name="l01126"></a>01126         <span class="keywordflow">if</span> (agrp-&gt;<a class="code" href="../../d9/dcf/structbActionGroup.html#a5a04faf9cd6c23df183545e5842caf80">flag</a> &amp; <a class="code" href="../../dc/d2a/DNA__action__types_8h.html#a23623a6a10ec8ae24a77f37cf2093d1eadbdf95c56849acad8f9da5a96593bdad">AGRP_MUTED</a>) <span class="comment">/* flush down */</span>
<a name="l01127"></a>01127             fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464a28ead3f40ae6eaa9f6b27fd49caf0737">FCURVE_MUTED</a>;
<a name="l01128"></a>01128         
<a name="l01129"></a>01129         <span class="comment">/* set the output lists based on the ones in the temp action */</span>
<a name="l01130"></a>01130         groups-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>= tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01131"></a>01131         groups-&gt;<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>= tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01132"></a>01132         list-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>= tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01133"></a>01133         list-&gt;<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>= tmp_act.<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01134"></a>01134     }
<a name="l01135"></a>01135     <span class="keywordflow">else</span> {
<a name="l01136"></a>01136         <span class="comment">/* simply add the F-Curve to the end of the given list */</span>
<a name="l01137"></a>01137         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(list, fcu);
<a name="l01138"></a>01138     }
<a name="l01139"></a>01139 }
<a name="l01140"></a>01140 
<a name="l01141"></a>01141 <span class="comment">/* Convert IPO-Curve to F-Curve (including Driver data), and free any of the old data that </span>
<a name="l01142"></a>01142 <span class="comment"> * is not relevant, BUT do not free the IPO-Curve itself...</span>
<a name="l01143"></a>01143 <span class="comment"> *  actname: name of Action-Channel (if applicable) that IPO-Curve&#39;s IPO-block belonged to</span>
<a name="l01144"></a>01144 <span class="comment"> *  constname: name of Constraint-Channel (if applicable) that IPO-Curve&#39;s IPO-block belonged to</span>
<a name="l01145"></a>01145 <span class="comment"> *      seq: sequencer-strip (if applicable) that IPO-Curve&#39;s IPO-block belonged to</span>
<a name="l01146"></a>01146 <span class="comment"> */</span>
<a name="l01147"></a><a class="code" href="../../da/d8f/ipo_8c.html#a9efa3c92ed4e09bdf83f18896e5bddf7">01147</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d8f/ipo_8c.html#a9efa3c92ed4e09bdf83f18896e5bddf7">icu_to_fcurves</a> (<a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *groups, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *list, <a class="code" href="../../dd/d35/structIpoCurve.html">IpoCurve</a> *icu, <span class="keywordtype">char</span> *actname, <span class="keywordtype">char</span> *constname, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> * seq, <span class="keywordtype">int</span> muteipo)
<a name="l01148"></a>01148 {
<a name="l01149"></a>01149     <a class="code" href="../../dc/d19/structAdrBit2Path.html">AdrBit2Path</a> *abp;
<a name="l01150"></a>01150     <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu;
<a name="l01151"></a>01151     <span class="keywordtype">int</span> totbits;
<a name="l01152"></a>01152     
<a name="l01153"></a>01153     <span class="comment">/* allocate memory for a new F-Curve */</span>
<a name="l01154"></a>01154     fcu= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d6/df2/structFCurve.html">FCurve</a>), <span class="stringliteral">&quot;FCurve&quot;</span>);
<a name="l01155"></a>01155     
<a name="l01156"></a>01156     <span class="comment">/* convert driver */</span>
<a name="l01157"></a>01157     <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>)
<a name="l01158"></a>01158         fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a6c79ab38bad6125a0c63120a5bf4dd3e">driver</a>= <a class="code" href="../../da/d8f/ipo_8c.html#a8e4c390c63ff7cd8f5eeb9751a87a093">idriver_to_cdriver</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>);
<a name="l01159"></a>01159     
<a name="l01160"></a>01160     <span class="comment">/* copy flags */</span>
<a name="l01161"></a>01161     <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ab3fdfb0d88aa05814f7c34fcfef46a3d">flag</a> &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a73d3f1a915ef111638d67c07daf16b1d">IPO_VISIBLE</a>) fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464abc4ace997641edbdb0f8724f583dffda">FCURVE_VISIBLE</a>;
<a name="l01162"></a>01162     <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ab3fdfb0d88aa05814f7c34fcfef46a3d">flag</a> &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab7fc088daff923288d17c17ae7b9b128">IPO_SELECT</a>) fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464a663e89ede10f0771e57578f6ec020a8b">FCURVE_SELECTED</a>;
<a name="l01163"></a>01163     <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ab3fdfb0d88aa05814f7c34fcfef46a3d">flag</a> &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#adfe811e190e032f97d0981da4b9400e2">IPO_ACTIVE</a>) fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464a4dafc6cfdb87097d84384ce770383b66">FCURVE_ACTIVE</a>;
<a name="l01164"></a>01164     <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ab3fdfb0d88aa05814f7c34fcfef46a3d">flag</a> &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a6794ce5880796e9bbb26870427336896">IPO_MUTE</a>) fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464a28ead3f40ae6eaa9f6b27fd49caf0737">FCURVE_MUTED</a>;
<a name="l01165"></a>01165     <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ab3fdfb0d88aa05814f7c34fcfef46a3d">flag</a> &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab53e3270807361a89052caf9402f534b">IPO_PROTECT</a>) fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464ab581d30efbbb3a1a1f6f979d26d1cd25">FCURVE_PROTECTED</a>;
<a name="l01166"></a>01166     
<a name="l01167"></a>01167     <span class="comment">/* set extrapolation */</span>
<a name="l01168"></a>01168     <span class="keywordflow">switch</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ade2669efeeb37cbcdbc269ee4eed7c8a">extrap</a>) {
<a name="l01169"></a>01169         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac90f12f261a86941f8f721f1782388cc">IPO_HORIZ</a>: <span class="comment">/* constant extrapolation */</span>
<a name="l01170"></a>01170         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a5935f6786280c9965f7618cc1b1b405f">IPO_DIR</a>: <span class="comment">/* linear extrapolation */</span>
<a name="l01171"></a>01171         {
<a name="l01172"></a>01172             <span class="comment">/* just copy, as the new defines match the old ones... */</span>
<a name="l01173"></a>01173             fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ac932d96a37634a3b105b80b0daf3afd5">extend</a>= icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ade2669efeeb37cbcdbc269ee4eed7c8a">extrap</a>;
<a name="l01174"></a>01174         }
<a name="l01175"></a>01175             <span class="keywordflow">break</span>;
<a name="l01176"></a>01176             
<a name="l01177"></a>01177         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9e046983232401f456ec7618a9ce2b39">IPO_CYCL</a>: <span class="comment">/* cyclic extrapolation */</span>
<a name="l01178"></a>01178         <span class="keywordflow">case</span> <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#af3ebed469a48c357e7fe03174aa34837">IPO_CYCLX</a>: <span class="comment">/* cyclic extrapolation + offset */</span>
<a name="l01179"></a>01179         {
<a name="l01180"></a>01180             <span class="comment">/* Add a new FModifier (Cyclic) instead of setting extend value </span>
<a name="l01181"></a>01181 <span class="comment">             * as that&#39;s the new equivalent of that option.</span>
<a name="l01182"></a>01182 <span class="comment">             */</span>
<a name="l01183"></a>01183             <a class="code" href="../../dc/d68/structFModifier.html">FModifier</a> *fcm= <a class="code" href="../../da/dba/BKE__fcurve_8h.html#a782b8a634387db32ffbadd880093bf60">add_fmodifier</a>(&amp;fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#afd96cdfbbfd2b148482ca111cefa1f74">modifiers</a>, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a780a87e4018e6dbc53e4dc812f83c97ba0a9f871f719b71334e21fb78f83aa48d">FMODIFIER_TYPE_CYCLES</a>);
<a name="l01184"></a>01184             <a class="code" href="../../dd/d22/structFMod__Cycles.html">FMod_Cycles</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>= (<a class="code" href="../../dd/d22/structFMod__Cycles.html">FMod_Cycles</a> *)fcm-&gt;<a class="code" href="../../dc/d68/structFModifier.html#a68e8b157c9aa0a3984e0b772054c4416">data</a>;
<a name="l01185"></a>01185             
<a name="l01186"></a>01186             <span class="comment">/* if &#39;offset&#39; one is in use, set appropriate settings */</span>
<a name="l01187"></a>01187             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ade2669efeeb37cbcdbc269ee4eed7c8a">extrap</a> == <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#af3ebed469a48c357e7fe03174aa34837">IPO_CYCLX</a>)
<a name="l01188"></a>01188                 data-&gt;<a class="code" href="../../dd/d22/structFMod__Cycles.html#ada5730de9fe6c18ebb62ffb9da000a7a">before_mode</a>= data-&gt;<a class="code" href="../../dd/d22/structFMod__Cycles.html#a788ff5f906ec71a8d7b5f7655d5adb7d">after_mode</a>= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1be224f5cf919cb3c9dabfc9222d71c1aabf9e27d66329a785d994e215b28d169">FCM_EXTRAPOLATE_CYCLIC_OFFSET</a>;
<a name="l01189"></a>01189             <span class="keywordflow">else</span>
<a name="l01190"></a>01190                 data-&gt;<a class="code" href="../../dd/d22/structFMod__Cycles.html#ada5730de9fe6c18ebb62ffb9da000a7a">before_mode</a>= data-&gt;<a class="code" href="../../dd/d22/structFMod__Cycles.html#a788ff5f906ec71a8d7b5f7655d5adb7d">after_mode</a>= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1be224f5cf919cb3c9dabfc9222d71c1a72033c604fd1de12557519f70ae9eee3">FCM_EXTRAPOLATE_CYCLIC</a>;
<a name="l01191"></a>01191         }
<a name="l01192"></a>01192             <span class="keywordflow">break</span>;
<a name="l01193"></a>01193     }
<a name="l01194"></a>01194     
<a name="l01195"></a>01195     <span class="comment">/* -------- */</span>
<a name="l01196"></a>01196     
<a name="l01197"></a>01197     <span class="comment">/* get adrcode &lt;-&gt; bitflags mapping to handle nasty bitflag curves? */</span>
<a name="l01198"></a>01198     abp= <a class="code" href="../../da/d8f/ipo_8c.html#a8f1a4ac1f2b44356f7befe8322fc5870">adrcode_bitmaps_to_paths</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a70e0615c99593dcf7e10990450c0a052">blocktype</a>, icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#af001bcddaa79f238ecb0e98934704c2d">adrcode</a>, &amp;totbits);
<a name="l01199"></a>01199     <span class="keywordflow">if</span> (abp &amp;&amp; totbits) {
<a name="l01200"></a>01200         <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcurve;
<a name="l01201"></a>01201         <span class="keywordtype">int</span> b;
<a name="l01202"></a>01202         
<a name="l01203"></a>01203         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconvert bitflag ipocurve, totbits = %d\n&quot;</span>, totbits);
<a name="l01204"></a>01204         
<a name="l01205"></a>01205         <span class="comment">/* add the &#39;only int values&#39; flag */</span>
<a name="l01206"></a>01206         fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= (<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464a41ae3a6a2626d648a9150c3531ac8bb6">FCURVE_INT_VALUES</a>|<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464ab4fca2d24ce8b1b1482c796adf0f115f">FCURVE_DISCRETE_VALUES</a>);        
<a name="l01207"></a>01207         
<a name="l01208"></a>01208         <span class="comment">/* for each bit we have to remap + check for:</span>
<a name="l01209"></a>01209 <span class="comment">         * 1) we need to make copy the existing F-Curve data (fcu -&gt; fcurve),</span>
<a name="l01210"></a>01210 <span class="comment">         *    except for the last one which will use the original </span>
<a name="l01211"></a>01211 <span class="comment">         * 2) copy the relevant path info across</span>
<a name="l01212"></a>01212 <span class="comment">         * 3) filter the keyframes for the flag of interest</span>
<a name="l01213"></a>01213 <span class="comment">         */</span>
<a name="l01214"></a>01214         <span class="keywordflow">for</span> (b=0; b &lt; totbits; b++, abp++) {
<a name="l01215"></a>01215             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;
<a name="l01216"></a>01216             
<a name="l01217"></a>01217             <span class="comment">/* make a copy of existing base-data if not the last curve */</span>
<a name="l01218"></a>01218             <span class="keywordflow">if</span> (b &lt; (totbits-1))
<a name="l01219"></a>01219                 fcurve= <a class="code" href="../../da/dba/BKE__fcurve_8h.html#ae2aca464f2e35470877917876a933472">copy_fcurve</a>(fcu);
<a name="l01220"></a>01220             <span class="keywordflow">else</span>
<a name="l01221"></a>01221                 fcurve= fcu;
<a name="l01222"></a>01222                 
<a name="l01223"></a>01223             <span class="comment">/* set path */</span>
<a name="l01224"></a>01224             fcurve-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a4b841fbabd01a3fd639b7672dcc1da7a">rna_path</a>= <a class="code" href="../../d3/db3/BLI__string_8h.html#a45da837b000b29e7937f81c37bfbf72e">BLI_strdup</a>(abp-&gt;<a class="code" href="../../dc/d19/structAdrBit2Path.html#adb3399b6b4ae4af0f7e75e852ea52967">path</a>);
<a name="l01225"></a>01225             fcurve-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad63b7b4ef28bdd8a212bd6e35e954208">array_index</a>= abp-&gt;<a class="code" href="../../dc/d19/structAdrBit2Path.html#a20f39c5a91e5fc4a52e0e6d75f6f9ab4">array_index</a>;
<a name="l01226"></a>01226             
<a name="l01227"></a>01227             <span class="comment">/* convert keyframes </span>
<a name="l01228"></a>01228 <span class="comment">             *  - beztriples and bpoints are mutually exclusive, so we won&#39;t have both at the same time</span>
<a name="l01229"></a>01229 <span class="comment">             *  - beztriples are more likely to be encountered as they are keyframes (the other type wasn&#39;t used yet)</span>
<a name="l01230"></a>01230 <span class="comment">             */</span>
<a name="l01231"></a>01231             fcurve-&gt;<a class="code" href="../../d6/df2/structFCurve.html#adec915e7ed4f2b66b12313566bf5c33f">totvert</a>= icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a6c92b94aac5b2ca487002d58d71ce6b6">totvert</a>;
<a name="l01232"></a>01232             
<a name="l01233"></a>01233             <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>) {
<a name="l01234"></a>01234                 <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *dst, *src;
<a name="l01235"></a>01235                 
<a name="l01236"></a>01236                 <span class="comment">/* allocate new array for keyframes/beztriples */</span>
<a name="l01237"></a>01237                 fcurve-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a799ab2725f85e5ee19e9ef88a8d6b006">bezt</a>= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a>)*fcurve-&gt;<a class="code" href="../../d6/df2/structFCurve.html#adec915e7ed4f2b66b12313566bf5c33f">totvert</a>, <span class="stringliteral">&quot;BezTriples&quot;</span>);
<a name="l01238"></a>01238                 
<a name="l01239"></a>01239                 <span class="comment">/* loop through copying all BezTriples individually, as we need to modify a few things */</span>
<a name="l01240"></a>01240                 <span class="keywordflow">for</span> (dst=fcurve-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a799ab2725f85e5ee19e9ef88a8d6b006">bezt</a>, src=icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>, i=0; i &lt; fcurve-&gt;totvert; i++, dst++, src++) {
<a name="l01241"></a>01241                     <span class="comment">/* firstly, copy BezTriple data */</span>
<a name="l01242"></a>01242                     *dst= *src;
<a name="l01243"></a>01243                     
<a name="l01244"></a>01244                     <span class="comment">/* interpolation can only be constant... */</span>
<a name="l01245"></a>01245                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a2b20e9a54cf1f1637920ae56f75d0926">ipo</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#ad74346e6c15814750cc9c5eb6369fda5a8a7c4acc7a8382a9c8e1f88c9688254d">BEZT_IPO_CONST</a>;
<a name="l01246"></a>01246                     
<a name="l01247"></a>01247                     <span class="comment">/* &#39;hide&#39; flag is now used for keytype - only &#39;keyframes&#39; existed before */</span>
<a name="l01248"></a>01248                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#aaac89168848f34909c578acb0d6cca26">hide</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335cad5591000922bff58bafed40c0ab9a6e5">BEZT_KEYTYPE_KEYFRAME</a>;
<a name="l01249"></a>01249                     
<a name="l01250"></a>01250                     <span class="comment">/* auto-handles - per curve to per handle */</span>
<a name="l01251"></a>01251                     <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ab3fdfb0d88aa05814f7c34fcfef46a3d">flag</a> &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a94cdd43a149ede46cc9893d5886f2623">IPO_AUTO_HORIZ</a>) {
<a name="l01252"></a>01252                         <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a> == <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>) dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a> = <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>;
<a name="l01253"></a>01253                         <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a> == <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>) dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a> = <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>;
<a name="l01254"></a>01254                     }
<a name="l01255"></a>01255                     
<a name="l01256"></a>01256                     <span class="comment">/* correct values, by checking if the flag of interest is set */</span>
<a name="l01257"></a>01257                     <span class="keywordflow">if</span> ( ((<span class="keywordtype">int</span>)(dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1])) &amp; (abp-&gt;<a class="code" href="../../dc/d19/structAdrBit2Path.html#a6c200ec2a13e27aaee0049bc862a0b7b">bit</a>) )
<a name="l01258"></a>01258                         dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][1]= dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1]= dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][1] = 1.0f;
<a name="l01259"></a>01259                     <span class="keywordflow">else</span>
<a name="l01260"></a>01260                         dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][1]= dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1]= dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][1] = 0.0f;
<a name="l01261"></a>01261                 }
<a name="l01262"></a>01262             }
<a name="l01263"></a>01263             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#aa81cacaf8ab46e219b0e65eec0416a93">bp</a>) {
<a name="l01264"></a>01264                 <span class="comment">/* TODO: need to convert from BPoint type to the more compact FPoint type... but not priority, since no data used this */</span>
<a name="l01265"></a>01265                 <span class="comment">//BPoint *bp;</span>
<a name="l01266"></a>01266                 <span class="comment">//FPoint *fpt;</span>
<a name="l01267"></a>01267             }
<a name="l01268"></a>01268             
<a name="l01269"></a>01269             <span class="comment">/* add new F-Curve to list */</span>
<a name="l01270"></a>01270             <a class="code" href="../../da/d8f/ipo_8c.html#adf04b43a928a1288c3ce615073d4f69f">fcurve_add_to_list</a>(groups, list, fcurve, actname, muteipo);
<a name="l01271"></a>01271         }
<a name="l01272"></a>01272     }
<a name="l01273"></a>01273     <span class="keywordflow">else</span> {
<a name="l01274"></a>01274         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;
<a name="l01275"></a>01275         
<a name="l01276"></a>01276         <span class="comment">/* get rna-path</span>
<a name="l01277"></a>01277 <span class="comment">         *  - we will need to set the &#39;disabled&#39; flag if no path is able to be made (for now)</span>
<a name="l01278"></a>01278 <span class="comment">         */</span>
<a name="l01279"></a>01279         fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a4b841fbabd01a3fd639b7672dcc1da7a">rna_path</a>= <a class="code" href="../../da/d8f/ipo_8c.html#aff35613743894522d16717f58370d074">get_rna_access</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a70e0615c99593dcf7e10990450c0a052">blocktype</a>, icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#af001bcddaa79f238ecb0e98934704c2d">adrcode</a>, actname, constname, seq, &amp;fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad63b7b4ef28bdd8a212bd6e35e954208">array_index</a>);
<a name="l01280"></a>01280         <span class="keywordflow">if</span> (fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a4b841fbabd01a3fd639b7672dcc1da7a">rna_path</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01281"></a>01281             fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464a08981f44fd5fba6615e561ed5d1c7d67">FCURVE_DISABLED</a>;
<a name="l01282"></a>01282         
<a name="l01283"></a>01283         <span class="comment">/* convert keyframes </span>
<a name="l01284"></a>01284 <span class="comment">         *  - beztriples and bpoints are mutually exclusive, so we won&#39;t have both at the same time</span>
<a name="l01285"></a>01285 <span class="comment">         *  - beztriples are more likely to be encountered as they are keyframes (the other type wasn&#39;t used yet)</span>
<a name="l01286"></a>01286 <span class="comment">         */</span>
<a name="l01287"></a>01287         fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#adec915e7ed4f2b66b12313566bf5c33f">totvert</a>= icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a6c92b94aac5b2ca487002d58d71ce6b6">totvert</a>;
<a name="l01288"></a>01288         
<a name="l01289"></a>01289         <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>) {
<a name="l01290"></a>01290             <a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a> *dst, *src;
<a name="l01291"></a>01291             
<a name="l01292"></a>01292             <span class="comment">/* allocate new array for keyframes/beztriples */</span>
<a name="l01293"></a>01293             fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a799ab2725f85e5ee19e9ef88a8d6b006">bezt</a>= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d5/dd9/structBezTriple.html">BezTriple</a>)*fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#adec915e7ed4f2b66b12313566bf5c33f">totvert</a>, <span class="stringliteral">&quot;BezTriples&quot;</span>);
<a name="l01294"></a>01294             
<a name="l01295"></a>01295             <span class="comment">/* loop through copying all BezTriples individually, as we need to modify a few things */</span>
<a name="l01296"></a>01296             <span class="keywordflow">for</span> (dst=fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a799ab2725f85e5ee19e9ef88a8d6b006">bezt</a>, src=icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>, i=0; i &lt; fcu-&gt;totvert; i++, dst++, src++) {
<a name="l01297"></a>01297                 <span class="comment">/* firstly, copy BezTriple data */</span>
<a name="l01298"></a>01298                 *dst= *src;
<a name="l01299"></a>01299                 
<a name="l01300"></a>01300                 <span class="comment">/* now copy interpolation from curve (if not already set) */</span>
<a name="l01301"></a>01301                 <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ad39c6179137789e29e8b139a4dbf4549">ipo</a> != <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a15b0ed357d8c2d9949f26dfe3b3c0b27">IPO_MIXED</a>)
<a name="l01302"></a>01302                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a2b20e9a54cf1f1637920ae56f75d0926">ipo</a>= icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ad39c6179137789e29e8b139a4dbf4549">ipo</a>;
<a name="l01303"></a>01303                     
<a name="l01304"></a>01304                 <span class="comment">/* &#39;hide&#39; flag is now used for keytype - only &#39;keyframes&#39; existed before */</span>
<a name="l01305"></a>01305                 dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#aaac89168848f34909c578acb0d6cca26">hide</a>= <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#afd027912409530cf459cfbd97083335cad5591000922bff58bafed40c0ab9a6e5">BEZT_KEYTYPE_KEYFRAME</a>;
<a name="l01306"></a>01306                 
<a name="l01307"></a>01307                 <span class="comment">/* auto-handles - per curve to per handle */</span>
<a name="l01308"></a>01308                 <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#ab3fdfb0d88aa05814f7c34fcfef46a3d">flag</a> &amp; <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a94cdd43a149ede46cc9893d5886f2623">IPO_AUTO_HORIZ</a>) {
<a name="l01309"></a>01309                     <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a> == <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>) dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#af6f1298c6043038ba343b76054feb920">h1</a> = <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>;
<a name="l01310"></a>01310                     <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a> == <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca4030ebec929ea300ba646458062c761b">HD_AUTO</a>) dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#ad4c02b7166fdff040ebb931ed1d4bfc0">h2</a> = <a class="code" href="../../d6/d88/DNA__curve__types_8h.html#aae1919333e2c55cb17830a26b0ce45eca015592fc9e4aa078609a35b5bc00e698">HD_AUTO_ANIM</a>;
<a name="l01311"></a>01311                 }
<a name="l01312"></a>01312                     
<a name="l01313"></a>01313                 <span class="comment">/* correct values for euler rotation curves </span>
<a name="l01314"></a>01314 <span class="comment">                 *  - they were degrees/10 </span>
<a name="l01315"></a>01315 <span class="comment">                 *  - we need radians for RNA to do the right thing</span>
<a name="l01316"></a>01316 <span class="comment">                 */</span>
<a name="l01317"></a>01317                 <span class="keywordflow">if</span> ( ((icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a70e0615c99593dcf7e10990450c0a052">blocktype</a> == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) &amp;&amp; <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#af001bcddaa79f238ecb0e98934704c2d">adrcode</a>, <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ab7f95025a9e7c3e44560ff3e47a47028">OB_ROT_X</a>, <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a338abb6e4e4eded18bbe49c370fbb3a8">OB_ROT_Y</a>, <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a61d7f02a72a245dd8ce7ec193bc2c4a7">OB_ROT_Z</a>)) ||
<a name="l01318"></a>01318                      ((icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a70e0615c99593dcf7e10990450c0a052">blocktype</a> == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ae023c9fde422e208a00e982711ea8add">ID_PO</a>) &amp;&amp; <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#af001bcddaa79f238ecb0e98934704c2d">adrcode</a>, <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a9a5bf66c2fd0c205d8f7d65e8490e751">AC_EUL_X</a>, <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a992eb0aacfd4acd4af8042c71c96b296">AC_EUL_Y</a>, <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a0b756d5550bbf1654fa669b6f8399816">AC_EUL_Z</a>)) )
<a name="l01319"></a>01319                 {
<a name="l01320"></a>01320                     <span class="keyword">const</span> <span class="keywordtype">float</span> fac= (float)<a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 18.0f; <span class="comment">//10.0f * M_PI/180.0f;</span>
<a name="l01321"></a>01321                     
<a name="l01322"></a>01322                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][1] *= fac;
<a name="l01323"></a>01323                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1] *= fac;
<a name="l01324"></a>01324                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][1] *= fac;
<a name="l01325"></a>01325                 }
<a name="l01326"></a>01326                 
<a name="l01327"></a>01327                 <span class="comment">/* correct values for path speed curves </span>
<a name="l01328"></a>01328 <span class="comment">                 *  - their values were 0-1</span>
<a name="l01329"></a>01329 <span class="comment">                 *  - we now need as &#39;frames&#39;</span>
<a name="l01330"></a>01330 <span class="comment">                 */</span>
<a name="l01331"></a>01331                 <span class="keywordflow">if</span> ( (<span class="keywordtype">id</span>) &amp;&amp; (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a70e0615c99593dcf7e10990450c0a052">blocktype</a> == <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)) &amp;&amp; 
<a name="l01332"></a>01332                      (fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a4b841fbabd01a3fd639b7672dcc1da7a">rna_path</a> &amp;&amp; strcmp(fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a4b841fbabd01a3fd639b7672dcc1da7a">rna_path</a>, <span class="stringliteral">&quot;eval_time&quot;</span>)==0) )
<a name="l01333"></a>01333                 {
<a name="l01334"></a>01334                     <a class="code" href="../../da/d10/structCurve.html">Curve</a> *cu = (<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)<span class="keywordtype">id</span>;
<a name="l01335"></a>01335                     
<a name="l01336"></a>01336                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][1] *= cu-&gt;<a class="code" href="../../da/d10/structCurve.html#a0c9965770cb42b83eedc78f09d4087ce">pathlen</a>;
<a name="l01337"></a>01337                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][1] *= cu-&gt;<a class="code" href="../../da/d10/structCurve.html#a0c9965770cb42b83eedc78f09d4087ce">pathlen</a>;
<a name="l01338"></a>01338                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][1] *= cu-&gt;<a class="code" href="../../da/d10/structCurve.html#a0c9965770cb42b83eedc78f09d4087ce">pathlen</a>;
<a name="l01339"></a>01339                 }
<a name="l01340"></a>01340                 
<a name="l01341"></a>01341                 <span class="comment">/* correct times for rotation drivers </span>
<a name="l01342"></a>01342 <span class="comment">                 *  - need to go from degrees to radians...</span>
<a name="l01343"></a>01343 <span class="comment">                 *  - there&#39;s only really 1 target to worry about </span>
<a name="l01344"></a>01344 <span class="comment">                 *  - were also degrees/10</span>
<a name="l01345"></a>01345 <span class="comment">                 */</span>
<a name="l01346"></a>01346                 <span class="keywordflow">if</span> (fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a6c79ab38bad6125a0c63120a5bf4dd3e">driver</a> &amp;&amp; fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a6c79ab38bad6125a0c63120a5bf4dd3e">driver</a>-&gt;<a class="code" href="../../d3/d1e/structChannelDriver.html#a14d54c061db1124addaba9a6a80cce1e">variables</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) {
<a name="l01347"></a>01347                     <a class="code" href="../../d1/d24/structDriverVar.html">DriverVar</a> *dvar= fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#a6c79ab38bad6125a0c63120a5bf4dd3e">driver</a>-&gt;<a class="code" href="../../d3/d1e/structChannelDriver.html#a14d54c061db1124addaba9a6a80cce1e">variables</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01348"></a>01348                     <a class="code" href="../../df/d26/structDriverTarget.html">DriverTarget</a> *dtar= &amp;dvar-&gt;<a class="code" href="../../d1/d24/structDriverVar.html#a7f717ae819c408739d15204e1de98219">targets</a>[0];
<a name="l01349"></a>01349                     
<a name="l01350"></a>01350                     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(dtar-&gt;<a class="code" href="../../df/d26/structDriverTarget.html#ac8ffdbbdaeb860c6685af1c5e8800cf1">transChan</a>, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a70d33ca7a36d12ef881637440c5cf792">DTAR_TRANSCHAN_ROTX</a>, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6af1aa7afec8722590406e5e1e3482cb8f">DTAR_TRANSCHAN_ROTY</a>, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a1467b6d38dc5f38d00d1a813cd132ea6a147aa4181f2e92ad5261d1e1c42e093c">DTAR_TRANSCHAN_ROTZ</a>)) {
<a name="l01351"></a>01351                         <span class="keyword">const</span> <span class="keywordtype">float</span> fac= (float)<a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 18.0f;
<a name="l01352"></a>01352                         
<a name="l01353"></a>01353                         dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][0] *= fac;
<a name="l01354"></a>01354                         dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0] *= fac;
<a name="l01355"></a>01355                         dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][0] *= fac;
<a name="l01356"></a>01356                     }
<a name="l01357"></a>01357                 }
<a name="l01358"></a>01358                 
<a name="l01359"></a>01359                 <span class="comment">/* correct values for sequencer curves, that were not locked to frame */</span>
<a name="l01360"></a>01360                 <span class="keywordflow">if</span> (seq &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#acc883ac417976dd5a885dcb2be1b8856">SEQ_IPO_FRAME_LOCKED</a>) == 0) {
<a name="l01361"></a>01361                     <span class="keywordtype">double</span> <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a0ea807db9b245d41852d0326d715cc0b">mul</a>= (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>-seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>)/100.0f;
<a name="l01362"></a>01362                     <span class="keywordtype">double</span> offset= seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>;
<a name="l01363"></a>01363                     
<a name="l01364"></a>01364                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][0] *= <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a0ea807db9b245d41852d0326d715cc0b">mul</a>;
<a name="l01365"></a>01365                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[0][0] += offset;
<a name="l01366"></a>01366                     
<a name="l01367"></a>01367                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0] *= <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a0ea807db9b245d41852d0326d715cc0b">mul</a>;
<a name="l01368"></a>01368                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[1][0] += offset;
<a name="l01369"></a>01369                     
<a name="l01370"></a>01370                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][0] *= <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a0ea807db9b245d41852d0326d715cc0b">mul</a>;
<a name="l01371"></a>01371                     dst-&gt;<a class="code" href="../../d5/dd9/structBezTriple.html#a65c1569ddc02a36e6d245fa1cdd0f87e">vec</a>[2][0] += offset;
<a name="l01372"></a>01372                 }
<a name="l01373"></a>01373             }
<a name="l01374"></a>01374         }
<a name="l01375"></a>01375         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#aa81cacaf8ab46e219b0e65eec0416a93">bp</a>) {
<a name="l01376"></a>01376             <span class="comment">/* TODO: need to convert from BPoint type to the more compact FPoint type... but not priority, since no data used this */</span>
<a name="l01377"></a>01377             <span class="comment">//BPoint *bp;</span>
<a name="l01378"></a>01378             <span class="comment">//FPoint *fpt;</span>
<a name="l01379"></a>01379         }
<a name="l01380"></a>01380         
<a name="l01381"></a>01381         <span class="comment">/* add new F-Curve to list */</span>
<a name="l01382"></a>01382         <a class="code" href="../../da/d8f/ipo_8c.html#adf04b43a928a1288c3ce615073d4f69f">fcurve_add_to_list</a>(groups, list, fcu, actname, muteipo);
<a name="l01383"></a>01383     }
<a name="l01384"></a>01384 }
<a name="l01385"></a>01385 
<a name="l01386"></a>01386 <span class="comment">/* ------------------------- */</span>
<a name="l01387"></a>01387 
<a name="l01388"></a>01388 <span class="comment">/* Convert IPO-block (i.e. all its IpoCurves) to the new system.</span>
<a name="l01389"></a>01389 <span class="comment"> * This does not assume that any ID or AnimData uses it, but does assume that</span>
<a name="l01390"></a>01390 <span class="comment"> * it is given two lists, which it will perform driver/animation-data separation.</span>
<a name="l01391"></a>01391 <span class="comment"> */</span>
<a name="l01392"></a><a class="code" href="../../da/d8f/ipo_8c.html#a80e9604cefd2edf5f0836a28d9342fd2">01392</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d8f/ipo_8c.html#a80e9604cefd2edf5f0836a28d9342fd2">ipo_to_animato</a> (<a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>, <a class="code" href="../../d2/dc5/structIpo.html">Ipo</a> *ipo, <span class="keywordtype">char</span> actname[], <span class="keywordtype">char</span> constname[], <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *animgroups, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *<a class="code" href="../../d6/d4a/structanim.html">anim</a>, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *drivers)
<a name="l01393"></a>01393 {
<a name="l01394"></a>01394     <a class="code" href="../../dd/d35/structIpoCurve.html">IpoCurve</a> *icu;
<a name="l01395"></a>01395     
<a name="l01396"></a>01396     <span class="comment">/* sanity check */</span>
<a name="l01397"></a>01397     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ipo, anim, drivers))
<a name="l01398"></a>01398         <span class="keywordflow">return</span>;
<a name="l01399"></a>01399         
<a name="l01400"></a>01400     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;ipo_to_animato\n&quot;</span>);
<a name="l01401"></a>01401         
<a name="l01402"></a>01402     <span class="comment">/* validate actname and constname </span>
<a name="l01403"></a>01403 <span class="comment">     *  - clear actname if it was one of the generic &lt;builtin&gt; ones (i.e. &#39;Object&#39;, or &#39;Shapes&#39;)</span>
<a name="l01404"></a>01404 <span class="comment">     *  - actname can then be used to assign F-Curves in Action to Action Groups </span>
<a name="l01405"></a>01405 <span class="comment">     *    (i.e. thus keeping the benefits that used to be provided by Action Channels for grouping</span>
<a name="l01406"></a>01406 <span class="comment">     *      F-Curves for bones). This may be added later... for now let&#39;s just dump without them...</span>
<a name="l01407"></a>01407 <span class="comment">     */</span>
<a name="l01408"></a>01408     <span class="keywordflow">if</span> (actname) {
<a name="l01409"></a>01409         <span class="keywordflow">if</span> ((ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a578f52dc83257a470bd250f1ecee80c8">blocktype</a> == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) &amp;&amp; (strcmp(actname, <span class="stringliteral">&quot;Object&quot;</span>) == 0))
<a name="l01410"></a>01410             actname= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01411"></a>01411         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a578f52dc83257a470bd250f1ecee80c8">blocktype</a> == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) &amp;&amp; (strcmp(actname, <span class="stringliteral">&quot;Shape&quot;</span>) == 0))
<a name="l01412"></a>01412             actname= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01413"></a>01413     }
<a name="l01414"></a>01414     
<a name="l01415"></a>01415     <span class="comment">/* loop over IPO-Curves, freeing as we progress */</span>
<a name="l01416"></a>01416     <span class="keywordflow">for</span> (icu= ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a12f162ec784c7d4b3336c583dfa468e4">curve</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; icu; icu= icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#afe828a2dd44460b47a95430528ec274d">next</a>) {
<a name="l01417"></a>01417         <span class="comment">/* Since an IPO-Curve may end up being made into many F-Curves (i.e. bitflag curves), </span>
<a name="l01418"></a>01418 <span class="comment">         * we figure out the best place to put the channel, then tell the curve-converter to just dump there</span>
<a name="l01419"></a>01419 <span class="comment">         */</span>
<a name="l01420"></a>01420         <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>) {
<a name="l01421"></a>01421             <span class="comment">/* Blender 2.4x allowed empty drivers, but we don&#39;t now, since they cause more trouble than they&#39;re worth */</span>
<a name="l01422"></a>01422             <span class="keywordflow">if</span> ((icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#a9650006b4c72ef892c17e815f3a6c3dd">ob</a>) || (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>-&gt;<a class="code" href="../../d0/d89/structIpoDriver.html#ad722ea5c9983395019124612a07484cc">type</a> == <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a77fe1f6ee3f57a6f83b207cc9be57791">IPO_DRIVER_TYPE_PYTHON</a>)) {
<a name="l01423"></a>01423                 <a class="code" href="../../da/d8f/ipo_8c.html#a9efa3c92ed4e09bdf83f18896e5bddf7">icu_to_fcurves</a>(<span class="keywordtype">id</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, drivers, icu, actname, constname, seq, ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a120ddd28606a897f9af81275b7b615ff">muteipo</a>);
<a name="l01424"></a>01424             }
<a name="l01425"></a>01425             <span class="keywordflow">else</span> {
<a name="l01426"></a>01426                 <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>);
<a name="l01427"></a>01427                 icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01428"></a>01428             }
<a name="l01429"></a>01429         }
<a name="l01430"></a>01430         <span class="keywordflow">else</span>
<a name="l01431"></a>01431             <a class="code" href="../../da/d8f/ipo_8c.html#a9efa3c92ed4e09bdf83f18896e5bddf7">icu_to_fcurves</a>(<span class="keywordtype">id</span>, animgroups, anim, icu, actname, constname, seq, ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a120ddd28606a897f9af81275b7b615ff">muteipo</a>);
<a name="l01432"></a>01432     }
<a name="l01433"></a>01433     
<a name="l01434"></a>01434     <span class="comment">/* if this IPO block doesn&#39;t have any users after this one, free... */</span>
<a name="l01435"></a>01435     ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01436"></a>01436     <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfb/DNA__ID_8h.html#ab144cdfd04135cd0bffef8df2ab7eba1">ID_REAL_USERS</a>(ipo) &lt;= 0) {
<a name="l01437"></a>01437         <a class="code" href="../../dd/d35/structIpoCurve.html">IpoCurve</a> *icn;
<a name="l01438"></a>01438         
<a name="l01439"></a>01439         <span class="keywordflow">for</span> (icu= ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a12f162ec784c7d4b3336c583dfa468e4">curve</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; icu; icu= icn) {
<a name="l01440"></a>01440             icn= icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#afe828a2dd44460b47a95430528ec274d">next</a>;
<a name="l01441"></a>01441             
<a name="l01442"></a>01442             <span class="comment">/* free driver */</span>
<a name="l01443"></a>01443             <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>)
<a name="l01444"></a>01444                 <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a5fbfb6b72ef8f0c70b61ce7ae8350e79">driver</a>);
<a name="l01445"></a>01445                 
<a name="l01446"></a>01446             <span class="comment">/* free old data of curve now that it&#39;s no longer needed for converting any more curves */</span>
<a name="l01447"></a>01447             <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>);
<a name="l01448"></a>01448             <span class="keywordflow">if</span> (icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#aa81cacaf8ab46e219b0e65eec0416a93">bp</a>) <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#a2c2ff134af40961c76a8f410200a77d9">bezt</a>);
<a name="l01449"></a>01449             
<a name="l01450"></a>01450             <span class="comment">/* free this IPO-Curve */</span>
<a name="l01451"></a>01451             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a2bb7ce226f8b42d21eb35100f0bb4580">BLI_freelinkN</a>(&amp;ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a12f162ec784c7d4b3336c583dfa468e4">curve</a>, icu);
<a name="l01452"></a>01452         }
<a name="l01453"></a>01453     }
<a name="l01454"></a>01454 }
<a name="l01455"></a>01455 
<a name="l01456"></a>01456 <span class="comment">/* Convert Action-block to new system, separating animation and drivers</span>
<a name="l01457"></a>01457 <span class="comment"> * New curves may not be converted directly into the given Action (i.e. for Actions linked</span>
<a name="l01458"></a>01458 <span class="comment"> * to Objects, where ob-&gt;ipo and ob-&gt;action need to be combined).</span>
<a name="l01459"></a>01459 <span class="comment"> * NOTE: we need to be careful here, as same data-structs are used for new system too!</span>
<a name="l01460"></a>01460 <span class="comment"> */</span>
<a name="l01461"></a><a class="code" href="../../da/d8f/ipo_8c.html#a2bd479339bdd5cf65c72825e45be7205">01461</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d8f/ipo_8c.html#a2bd479339bdd5cf65c72825e45be7205">action_to_animato</a> (<a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>, <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *act, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *groups, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *curves, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *drivers)
<a name="l01462"></a>01462 {
<a name="l01463"></a>01463     <a class="code" href="../../da/d47/structbActionChannel.html">bActionChannel</a> *achan, *achann;
<a name="l01464"></a>01464     <a class="code" href="../../d7/dbe/structbConstraintChannel.html">bConstraintChannel</a> *conchan, *conchann;
<a name="l01465"></a>01465     
<a name="l01466"></a>01466     <span class="comment">/* only continue if there are Action Channels (indicating unconverted data) */</span>
<a name="l01467"></a>01467     <span class="keywordflow">if</span> (act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a3d353dd48d5478f1a943612bf1ac2388">chanbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01468"></a>01468         <span class="keywordflow">return</span>;
<a name="l01469"></a>01469         
<a name="l01470"></a>01470     <span class="comment">/* get rid of all Action Groups */</span>
<a name="l01471"></a>01471     <span class="comment">// XXX this is risky if there&#39;s some old + some new data in the Action...</span>
<a name="l01472"></a>01472     <span class="keywordflow">if</span> (act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) 
<a name="l01473"></a>01473         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>);
<a name="l01474"></a>01474     
<a name="l01475"></a>01475     <span class="comment">/* loop through Action-Channels, converting data, freeing as we go */</span>
<a name="l01476"></a>01476     <span class="keywordflow">for</span> (achan= act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a3d353dd48d5478f1a943612bf1ac2388">chanbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; achan; achan= achann) {
<a name="l01477"></a>01477         <span class="comment">/* get pointer to next Action Channel */</span>
<a name="l01478"></a>01478         achann= achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#a5bffc2b5bcea64ed3cfefa67496d1e4b">next</a>;
<a name="l01479"></a>01479         
<a name="l01480"></a>01480         <span class="comment">/* convert Action Channel&#39;s IPO data */</span>
<a name="l01481"></a>01481         <span class="keywordflow">if</span> (achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#abfaa53320e65308e3da97133a46bd95d">ipo</a>) {
<a name="l01482"></a>01482             <a class="code" href="../../da/d8f/ipo_8c.html#a80e9604cefd2edf5f0836a28d9342fd2">ipo_to_animato</a>(<span class="keywordtype">id</span>, achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#abfaa53320e65308e3da97133a46bd95d">ipo</a>, achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#a5f5171f59fd14394b9fc6e0d7dce25df">name</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, groups, curves, drivers);
<a name="l01483"></a>01483             achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#abfaa53320e65308e3da97133a46bd95d">ipo</a>-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01484"></a>01484             achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#abfaa53320e65308e3da97133a46bd95d">ipo</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01485"></a>01485         }
<a name="l01486"></a>01486         
<a name="l01487"></a>01487         <span class="comment">/* convert constraint channel IPO-data */</span>
<a name="l01488"></a>01488         <span class="keywordflow">for</span> (conchan= achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#ac7fb7ef70989a9a2ee883109d9b098a3">constraintChannels</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; conchan; conchan= conchann) {
<a name="l01489"></a>01489             <span class="comment">/* get pointer to next Constraint Channel */</span>
<a name="l01490"></a>01490             conchann= conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#acac0a238b06eef93fe5ae0a1051a510b">next</a>;
<a name="l01491"></a>01491             
<a name="l01492"></a>01492             <span class="comment">/* convert Constraint Channel&#39;s IPO data */</span>
<a name="l01493"></a>01493             <span class="keywordflow">if</span> (conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>) {
<a name="l01494"></a>01494                 <a class="code" href="../../da/d8f/ipo_8c.html#a80e9604cefd2edf5f0836a28d9342fd2">ipo_to_animato</a>(<span class="keywordtype">id</span>, conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>, achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#a5f5171f59fd14394b9fc6e0d7dce25df">name</a>, conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a04d85eff71b45989e31cba64b7286f15">name</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, groups, curves, drivers);
<a name="l01495"></a>01495                 conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01496"></a>01496                 conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01497"></a>01497             }
<a name="l01498"></a>01498             
<a name="l01499"></a>01499             <span class="comment">/* free Constraint Channel */</span>
<a name="l01500"></a>01500             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a2bb7ce226f8b42d21eb35100f0bb4580">BLI_freelinkN</a>(&amp;achan-&gt;<a class="code" href="../../da/d47/structbActionChannel.html#ac7fb7ef70989a9a2ee883109d9b098a3">constraintChannels</a>, conchan);
<a name="l01501"></a>01501         }
<a name="l01502"></a>01502         
<a name="l01503"></a>01503         <span class="comment">/* free Action Channel */</span>
<a name="l01504"></a>01504         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a2bb7ce226f8b42d21eb35100f0bb4580">BLI_freelinkN</a>(&amp;act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a3d353dd48d5478f1a943612bf1ac2388">chanbase</a>, achan);
<a name="l01505"></a>01505     }
<a name="l01506"></a>01506 }
<a name="l01507"></a>01507 
<a name="l01508"></a>01508 
<a name="l01509"></a>01509 <span class="comment">/* ------------------------- */</span>
<a name="l01510"></a>01510 
<a name="l01511"></a>01511 <span class="comment">/* Convert IPO-block (i.e. all its IpoCurves) for some ID to the new system</span>
<a name="l01512"></a>01512 <span class="comment"> * This assumes that AnimData has been added already. Separation of drivers</span>
<a name="l01513"></a>01513 <span class="comment"> * from animation data is accomplished here too...</span>
<a name="l01514"></a>01514 <span class="comment"> */</span>
<a name="l01515"></a><a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">01515</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a> (<a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>, <a class="code" href="../../d2/dc5/structIpo.html">Ipo</a> *ipo, <span class="keywordtype">char</span> actname[], <span class="keywordtype">char</span> constname[], <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq)
<a name="l01516"></a>01516 {
<a name="l01517"></a>01517     <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(<span class="keywordtype">id</span>);
<a name="l01518"></a>01518     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> <a class="code" href="../../d6/d4a/structanim.html">anim</a> = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l01519"></a>01519     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> drivers = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l01520"></a>01520     
<a name="l01521"></a>01521     <span class="comment">/* sanity check */</span>
<a name="l01522"></a>01522     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keywordtype">id</span>, ipo))
<a name="l01523"></a>01523         <span class="keywordflow">return</span>;
<a name="l01524"></a>01524     <span class="keywordflow">if</span> (adt == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01525"></a>01525         printf(<span class="stringliteral">&quot;ERROR ipo_to_animdata(): adt invalid\n&quot;</span>);
<a name="l01526"></a>01526         <span class="keywordflow">return</span>;
<a name="l01527"></a>01527     }
<a name="l01528"></a>01528     
<a name="l01529"></a>01529     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) {
<a name="l01530"></a>01530         printf(<span class="stringliteral">&quot;ipo to animdata - ID:%s, IPO:%s, actname:%s constname:%s seqname:%s  curves:%d\n&quot;</span>,
<a name="l01531"></a>01531                id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2, ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2, (actname)?actname:<span class="stringliteral">&quot;&lt;None&gt;&quot;</span>, (constname)?constname:<span class="stringliteral">&quot;&lt;None&gt;&quot;</span>, (seq)?(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a>+2):<span class="stringliteral">&quot;&lt;None&gt;&quot;</span>,
<a name="l01532"></a>01532             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aa3b37105a0793ac30946a6d220ee97d7">BLI_countlist</a>(&amp;ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a12f162ec784c7d4b3336c583dfa468e4">curve</a>));
<a name="l01533"></a>01533     }
<a name="l01534"></a>01534     
<a name="l01535"></a>01535     <span class="comment">/* Convert curves to animato system (separated into separate lists of F-Curves for animation and drivers),</span>
<a name="l01536"></a>01536 <span class="comment">     * and the try to put these lists in the right places, but do not free the lists here</span>
<a name="l01537"></a>01537 <span class="comment">     */</span>
<a name="l01538"></a>01538     <span class="comment">// XXX there shouldn&#39;t be any need for the groups, so don&#39;t supply pointer for that now... </span>
<a name="l01539"></a>01539     <a class="code" href="../../da/d8f/ipo_8c.html#a80e9604cefd2edf5f0836a28d9342fd2">ipo_to_animato</a>(<span class="keywordtype">id</span>, ipo, actname, constname, seq, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;anim, &amp;drivers);
<a name="l01540"></a>01540     
<a name="l01541"></a>01541     <span class="comment">/* deal with animation first */</span>
<a name="l01542"></a>01542     <span class="keywordflow">if</span> (anim.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) {
<a name="l01543"></a>01543         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\thas anim\n&quot;</span>);
<a name="l01544"></a>01544         <span class="comment">/* try to get action */</span>
<a name="l01545"></a>01545         <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01546"></a>01546             <span class="keywordtype">char</span> nameBuf[<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a6d7bce2e9ad79af316c9690a5b84b75c">MAX_ID_NAME</a>];
<a name="l01547"></a>01547             
<a name="l01548"></a>01548             <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(nameBuf, <span class="keyword">sizeof</span>(nameBuf), <span class="stringliteral">&quot;CDA:%s&quot;</span>, ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l01549"></a>01549             
<a name="l01550"></a>01550             adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>= <a class="code" href="../../d8/df5/BKE__action_8h.html#a77b6bd66ec260f2485cf1ff2d075fdb2">add_empty_action</a>(nameBuf);
<a name="l01551"></a>01551             <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\t\tadded new action - &#39;%s&#39;\n&quot;</span>, nameBuf);
<a name="l01552"></a>01552         }
<a name="l01553"></a>01553         
<a name="l01554"></a>01554         <span class="comment">/* add F-Curves to action */</span>
<a name="l01555"></a>01555         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aea47205fbf4fc9965bc2b06e7e3ca75a">BLI_movelisttolist</a>(&amp;adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>, &amp;anim);
<a name="l01556"></a>01556     }
<a name="l01557"></a>01557     
<a name="l01558"></a>01558     <span class="comment">/* deal with drivers */</span>
<a name="l01559"></a>01559     <span class="keywordflow">if</span> (drivers.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) {
<a name="l01560"></a>01560         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\thas drivers\n&quot;</span>);
<a name="l01561"></a>01561         <span class="comment">/* add drivers to end of driver stack */</span>
<a name="l01562"></a>01562         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aea47205fbf4fc9965bc2b06e7e3ca75a">BLI_movelisttolist</a>(&amp;adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#aaca565f031ee1209087422d8a5d77769">drivers</a>, &amp;drivers);
<a name="l01563"></a>01563     }
<a name="l01564"></a>01564 }
<a name="l01565"></a>01565 
<a name="l01566"></a>01566 <span class="comment">/* Convert Action-block to new system</span>
<a name="l01567"></a>01567 <span class="comment"> * NOTE: we need to be careful here, as same data-structs are used for new system too!</span>
<a name="l01568"></a>01568 <span class="comment"> */</span>
<a name="l01569"></a><a class="code" href="../../da/d8f/ipo_8c.html#a4cd435b52a6b2e3de8dcb2b5e8993c30">01569</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d8f/ipo_8c.html#a4cd435b52a6b2e3de8dcb2b5e8993c30">action_to_animdata</a> (<a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>, <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *act)
<a name="l01570"></a>01570 {
<a name="l01571"></a>01571     <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(<span class="keywordtype">id</span>);
<a name="l01572"></a>01572     
<a name="l01573"></a>01573     <span class="comment">/* only continue if there are Action Channels (indicating unconverted data) */</span>
<a name="l01574"></a>01574     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, adt, act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a3d353dd48d5478f1a943612bf1ac2388">chanbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>))
<a name="l01575"></a>01575         <span class="keywordflow">return</span>;
<a name="l01576"></a>01576     
<a name="l01577"></a>01577     <span class="comment">/* check if we need to set this Action as the AnimData&#39;s action */</span>
<a name="l01578"></a>01578     <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01579"></a>01579         <span class="comment">/* set this Action as AnimData&#39;s Action */</span>
<a name="l01580"></a>01580         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;act_to_adt - set adt action to act\n&quot;</span>);
<a name="l01581"></a>01581         adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>= act;
<a name="l01582"></a>01582     }
<a name="l01583"></a>01583     
<a name="l01584"></a>01584     <span class="comment">/* convert Action data */</span>
<a name="l01585"></a>01585     <a class="code" href="../../da/d8f/ipo_8c.html#a2bd479339bdd5cf65c72825e45be7205">action_to_animato</a>(<span class="keywordtype">id</span>, act, &amp;adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>, &amp;adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>, &amp;adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#aaca565f031ee1209087422d8a5d77769">drivers</a>);
<a name="l01586"></a>01586 }
<a name="l01587"></a>01587 
<a name="l01588"></a>01588 <span class="comment">/* ------------------------- */</span>
<a name="l01589"></a>01589 
<a name="l01590"></a>01590 <span class="comment">// TODO:</span>
<a name="l01591"></a>01591 <span class="comment">//  - NLA group duplicators info</span>
<a name="l01592"></a>01592 <span class="comment">//  - NLA curve/stride modifiers...</span>
<a name="l01593"></a>01593 
<a name="l01594"></a>01594 <span class="comment">/* Convert NLA-Strip to new system */</span>
<a name="l01595"></a><a class="code" href="../../da/d8f/ipo_8c.html#a4014fd078ae4ed1643fd25ebf5c11847">01595</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d8f/ipo_8c.html#a4014fd078ae4ed1643fd25ebf5c11847">nlastrips_to_animdata</a> (<a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *strips)
<a name="l01596"></a>01596 {
<a name="l01597"></a>01597     <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(<span class="keywordtype">id</span>);
<a name="l01598"></a>01598     <a class="code" href="../../d4/de0/structNlaTrack.html">NlaTrack</a> *nlt = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01599"></a>01599     <a class="code" href="../../d7/d95/structNlaStrip.html">NlaStrip</a> *strip;
<a name="l01600"></a>01600     <a class="code" href="../../d5/d84/structbActionStrip.html">bActionStrip</a> *as, *asn;
<a name="l01601"></a>01601     
<a name="l01602"></a>01602     <span class="comment">/* for each one of the original strips, convert to a new strip and free the old... */</span>
<a name="l01603"></a>01603     <span class="keywordflow">for</span> (as= strips-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; as; as= asn) {
<a name="l01604"></a>01604         asn= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a4db006cf84d35eed981ef557bdd9f126">next</a>;
<a name="l01605"></a>01605         
<a name="l01606"></a>01606         <span class="comment">/* this old strip is only worth something if it had an action... */</span>
<a name="l01607"></a>01607         <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a357e6e808ddbfc7e09a1b9ff256c2275">act</a>) {
<a name="l01608"></a>01608             <span class="comment">/* convert Action data (if not yet converted), storing the results in the same Action */</span>
<a name="l01609"></a>01609             <a class="code" href="../../da/d8f/ipo_8c.html#a2bd479339bdd5cf65c72825e45be7205">action_to_animato</a>(<span class="keywordtype">id</span>, as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a357e6e808ddbfc7e09a1b9ff256c2275">act</a>, &amp;as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a357e6e808ddbfc7e09a1b9ff256c2275">act</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>, &amp;as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a357e6e808ddbfc7e09a1b9ff256c2275">act</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>, &amp;adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#aaca565f031ee1209087422d8a5d77769">drivers</a>);
<a name="l01610"></a>01610             
<a name="l01611"></a>01611             <span class="comment">/* create a new-style NLA-strip which references this Action, then copy over relevant settings */</span>
<a name="l01612"></a>01612             {
<a name="l01613"></a>01613                 <span class="comment">/* init a new strip, and assign the action to it </span>
<a name="l01614"></a>01614 <span class="comment">                 *  - no need to muck around with the user-counts, since this is just </span>
<a name="l01615"></a>01615 <span class="comment">                 *    passing over the ref to the new owner, not creating an additional ref</span>
<a name="l01616"></a>01616 <span class="comment">                 */</span>
<a name="l01617"></a>01617                 strip= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d95/structNlaStrip.html">NlaStrip</a>), <span class="stringliteral">&quot;NlaStrip&quot;</span>);
<a name="l01618"></a>01618                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#af4a3969b3858c5536d1842f7a55f11ac">act</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a357e6e808ddbfc7e09a1b9ff256c2275">act</a>;
<a name="l01619"></a>01619                 
<a name="l01620"></a>01620                     <span class="comment">/* endpoints */</span>
<a name="l01621"></a>01621                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#ae2094c7a1fbf3ace399a32ec093c4fd5">start</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a4e6af4c6c0ab48d38415b188306d2de8">start</a>;
<a name="l01622"></a>01622                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a8d7f4a18c61cd0cac5cbe8a344e875a1">end</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a835d71d7c8291316173111f9550e2b81">end</a>;
<a name="l01623"></a>01623                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a014e33eeecd527bc006b4229cdf7ea72">actstart</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a0ed78fc8c736e6d0edf26be043f72f69">actstart</a>;
<a name="l01624"></a>01624                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#aa701a7e948622bb5e5759c1491e43578">actend</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a073a7ae656358268ee3d420b9d6869d8">actend</a>;
<a name="l01625"></a>01625                 
<a name="l01626"></a>01626                     <span class="comment">/* action reuse */</span>
<a name="l01627"></a>01627                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#ac810e95f37c9233f9c679ff25592a97e">repeat</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a92197783f4f742ad73eaa7d195e222f2">repeat</a>;
<a name="l01628"></a>01628                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a27146c6fc55825c160126786ad195950">scale</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a930aeaf6ab32582859087b304d0a2d67">scale</a>;
<a name="l01629"></a>01629                 <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#ad7ec9ba02c5f3dce1203a0536e6c7708">flag</a> &amp; <a class="code" href="../../db/db5/DNA__nla__types_8h.html#ac3143e0e96fb3d405cb6160e1a8ab0a3a8ed1c24e56ad817ca9d0f8aa165b65c4">ACTSTRIP_LOCK_ACTION</a>)    strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a38c39284c9b83acf3c582ca956ded9d1">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a0b7bac2d7694a130339dbc176c1f39f2ae28c6cc421766ca19f453005d4801cb5">NLASTRIP_FLAG_SYNC_LENGTH</a>;
<a name="l01630"></a>01630                 
<a name="l01631"></a>01631                     <span class="comment">/* blending */</span>
<a name="l01632"></a>01632                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#ad6778347ff710e6c2e8d8fd6fee26da6">blendin</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#aaea47d0789ad77aed90cdae665279a68">blendin</a>;
<a name="l01633"></a>01633                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a404fbc7678f6a351e3fbef441a2bac04">blendout</a>= as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a2c37815c2145c36273938c4e8461a8b1">blendout</a>;
<a name="l01634"></a>01634                 strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a1358dcd7111a0e1e74c8a6bc31b117ce">blendmode</a>= (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#a32e69c3e0070d3e487c271b662e13488">mode</a>==<a class="code" href="../../db/db5/DNA__nla__types_8h.html#a49bbc0c70fe587ce0ff317381c66b239">ACTSTRIPMODE_ADD</a>) ? <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a9ed6c7dec74bcd329ad19acabaac2b4ba5c15012822af1879fc082bd06e417326">NLASTRIP_MODE_ADD</a> : <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a9ed6c7dec74bcd329ad19acabaac2b4ba546bd3d62182655f892fc9f9b2d8f212">NLASTRIP_MODE_REPLACE</a>;
<a name="l01635"></a>01635                 <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#ad7ec9ba02c5f3dce1203a0536e6c7708">flag</a> &amp; <a class="code" href="../../db/db5/DNA__nla__types_8h.html#ac3143e0e96fb3d405cb6160e1a8ab0a3ade727059e5ae7b21fc648d22de7aff1f">ACTSTRIP_AUTO_BLENDS</a>)    strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a38c39284c9b83acf3c582ca956ded9d1">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a0b7bac2d7694a130339dbc176c1f39f2a5957e93f21fddd289ccc66ac78c37b06">NLASTRIP_FLAG_AUTO_BLENDS</a>;
<a name="l01636"></a>01636                     
<a name="l01637"></a>01637                     <span class="comment">/* assorted setting flags */</span>
<a name="l01638"></a>01638                 <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#ad7ec9ba02c5f3dce1203a0536e6c7708">flag</a> &amp; <a class="code" href="../../db/db5/DNA__nla__types_8h.html#ac3143e0e96fb3d405cb6160e1a8ab0a3a6cf1bce05c7be08459d60ee878420402">ACTSTRIP_SELECT</a>)         strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a38c39284c9b83acf3c582ca956ded9d1">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a0b7bac2d7694a130339dbc176c1f39f2a86b1827bba79c6683cdbeb6b1b4799e5">NLASTRIP_FLAG_SELECT</a>;
<a name="l01639"></a>01639                 <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#ad7ec9ba02c5f3dce1203a0536e6c7708">flag</a> &amp; <a class="code" href="../../db/db5/DNA__nla__types_8h.html#ac3143e0e96fb3d405cb6160e1a8ab0a3a5806049d9ddc7b3e4f9300a95294c901">ACTSTRIP_ACTIVE</a>)         strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a38c39284c9b83acf3c582ca956ded9d1">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a0b7bac2d7694a130339dbc176c1f39f2a11b77f0bda6fb63b936acc20b58496ac">NLASTRIP_FLAG_ACTIVE</a>;
<a name="l01640"></a>01640                 
<a name="l01641"></a>01641                 <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#ad7ec9ba02c5f3dce1203a0536e6c7708">flag</a> &amp; <a class="code" href="../../db/db5/DNA__nla__types_8h.html#ac3143e0e96fb3d405cb6160e1a8ab0a3a5c5edc1435bb060ee42615cbcf76d1dc">ACTSTRIP_MUTE</a>)           strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a38c39284c9b83acf3c582ca956ded9d1">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a0b7bac2d7694a130339dbc176c1f39f2a61116637b8face428895a0d7d1a47943">NLASTRIP_FLAG_MUTED</a>;
<a name="l01642"></a>01642                 <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#ad7ec9ba02c5f3dce1203a0536e6c7708">flag</a> &amp; <a class="code" href="../../db/db5/DNA__nla__types_8h.html#ac3143e0e96fb3d405cb6160e1a8ab0a3a7e8c1cfe144f55babb8cd3e72230cb39">ACTSTRIP_REVERSE</a>)        strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#a38c39284c9b83acf3c582ca956ded9d1">flag</a> |= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a0b7bac2d7694a130339dbc176c1f39f2a5ed0f0458a20c99adeca613f83ddd807">NLASTRIP_FLAG_REVERSE</a>;
<a name="l01643"></a>01643                 
<a name="l01644"></a>01644                     <span class="comment">/* by default, we now always extrapolate, while in the past this was optional */</span>
<a name="l01645"></a>01645                 <span class="keywordflow">if</span> ((as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#ad7ec9ba02c5f3dce1203a0536e6c7708">flag</a> &amp; <a class="code" href="../../db/db5/DNA__nla__types_8h.html#ac3143e0e96fb3d405cb6160e1a8ab0a3a9dd720684f223211ff0ecde7d17ebf56">ACTSTRIP_HOLDLASTFRAME</a>)==0) 
<a name="l01646"></a>01646                     strip-&gt;<a class="code" href="../../d7/d95/structNlaStrip.html#ae9070ad94fcfc0d7372652845dcd363f">extendmode</a>= <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a837ca549d74cba2a0bd31859e64d9f1fa3f57b0eb6ff21d2c99646bb180375911">NLASTRIP_EXTEND_NOTHING</a>;
<a name="l01647"></a>01647             }   
<a name="l01648"></a>01648             
<a name="l01649"></a>01649             <span class="comment">/* try to add this strip to the current NLA-Track (i.e. the &#39;last&#39; one on the stack atm) */</span>
<a name="l01650"></a>01650             <span class="keywordflow">if</span> (<a class="code" href="../../d9/de6/BKE__nla_8h.html#a15ed3c0b4de96436ec6938f4a2aae230">BKE_nlatrack_add_strip</a>(nlt, strip) == 0) {
<a name="l01651"></a>01651                 <span class="comment">/* trying to add to the current failed (no space), </span>
<a name="l01652"></a>01652 <span class="comment">                 * so add a new track to the stack, and add to that...</span>
<a name="l01653"></a>01653 <span class="comment">                 */</span>
<a name="l01654"></a>01654                 nlt= <a class="code" href="../../d9/de6/BKE__nla_8h.html#ade883909faa615e4f9aa88de3686d3ce">add_nlatrack</a>(adt, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01655"></a>01655                 <a class="code" href="../../d9/de6/BKE__nla_8h.html#a15ed3c0b4de96436ec6938f4a2aae230">BKE_nlatrack_add_strip</a>(nlt, strip);
<a name="l01656"></a>01656             }
<a name="l01657"></a>01657         }
<a name="l01658"></a>01658         
<a name="l01659"></a>01659         <span class="comment">/* modifiers */</span>
<a name="l01660"></a>01660         <span class="comment">// FIXME: for now, we just free them...</span>
<a name="l01661"></a>01661         <span class="keywordflow">if</span> (as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#aa16f01023db7f917b8a9178ee7cf0268">modifiers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l01662"></a>01662             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;as-&gt;<a class="code" href="../../d5/d84/structbActionStrip.html#aa16f01023db7f917b8a9178ee7cf0268">modifiers</a>);
<a name="l01663"></a>01663         
<a name="l01664"></a>01664         <span class="comment">/* free the old strip */</span>
<a name="l01665"></a>01665         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a2bb7ce226f8b42d21eb35100f0bb4580">BLI_freelinkN</a>(strips, as);
<a name="l01666"></a>01666     }
<a name="l01667"></a>01667 }
<a name="l01668"></a>01668 
<a name="l01669"></a>01669 <span class="comment">/* *************************************************** */</span>
<a name="l01670"></a>01670 <span class="comment">/* External API - Only Called from do_versions() */</span>
<a name="l01671"></a>01671 
<a name="l01672"></a>01672 <span class="comment">/* Called from do_versions() in readfile.c to convert the old &#39;IPO/adrcode&#39; system</span>
<a name="l01673"></a>01673 <span class="comment"> * to the new &#39;Animato/RNA&#39; system.</span>
<a name="l01674"></a>01674 <span class="comment"> *</span>
<a name="l01675"></a>01675 <span class="comment"> * The basic method used here, is to loop over datablocks which have IPO-data, and </span>
<a name="l01676"></a>01676 <span class="comment"> * add those IPO&#39;s to new AnimData blocks as Actions. </span>
<a name="l01677"></a>01677 <span class="comment"> * Action/NLA data only works well for Objects, so these only need to be checked for there.</span>
<a name="l01678"></a>01678 <span class="comment"> *  </span>
<a name="l01679"></a>01679 <span class="comment"> * Data that has been converted should be freed immediately, which means that it is immediately</span>
<a name="l01680"></a>01680 <span class="comment"> * clear which datablocks have yet to be converted, and also prevent freeing errors when we exit.</span>
<a name="l01681"></a>01681 <span class="comment"> */</span>
<a name="l01682"></a>01682 <span class="comment">// XXX currently done after all file reading... </span>
<a name="l01683"></a><a class="code" href="../../da/d8f/ipo_8c.html#a52bdfe6278cf051e5015582d78c13c21">01683</a> <span class="keywordtype">void</span> <a class="code" href="../../db/d48/BKE__ipo_8h.html#aa3fcf10503e305a71e9df87ff61e8bab">do_versions_ipos_to_animato</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *<a class="code" href="../../d5/d95/makesdna_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>)
<a name="l01684"></a>01684 {
<a name="l01685"></a>01685     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> drivers = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l01686"></a>01686     <a class="code" href="../../d8/d7e/structID.html">ID</a> *id;
<a name="l01687"></a>01687     
<a name="l01688"></a>01688     <span class="keywordflow">if</span> (main == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01689"></a>01689         printf(<span class="stringliteral">&quot;Argh! Main is NULL in do_versions_ipos_to_animato()\n&quot;</span>);
<a name="l01690"></a>01690         <span class="keywordflow">return</span>;
<a name="l01691"></a>01691     }
<a name="l01692"></a>01692         
<a name="l01693"></a>01693     <span class="comment">/* only convert if version is right */</span>
<a name="l01694"></a>01694     <span class="keywordflow">if</span> (main-&gt;<a class="code" href="../../d0/dc0/structMain.html#abb6d63262cd2a22e6d18f962e052eefa">versionfile</a> &gt;= 250) {
<a name="l01695"></a>01695         printf(<span class="stringliteral">&quot;WARNING: Animation data too new to convert (Version %d)\n&quot;</span>, main-&gt;<a class="code" href="../../d0/dc0/structMain.html#abb6d63262cd2a22e6d18f962e052eefa">versionfile</a>);
<a name="l01696"></a>01696         <span class="keywordflow">return</span>;
<a name="l01697"></a>01697     }
<a name="l01698"></a>01698     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>)
<a name="l01699"></a>01699         printf(<span class="stringliteral">&quot;INFO: Converting to Animato...\n&quot;</span>);
<a name="l01700"></a>01700         
<a name="l01701"></a>01701     <span class="comment">/* ----------- Animation Attached to Data -------------- */</span>
<a name="l01702"></a>01702     
<a name="l01703"></a>01703     <span class="comment">/* objects */</span>
<a name="l01704"></a>01704     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#ac9c12335b530e1b3f1717bb9cbc269a4">object</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01705"></a>01705         <a class="code" href="../../de/de7/structObject.html">Object</a> *ob= (<a class="code" href="../../de/de7/structObject.html">Object</a> *)<span class="keywordtype">id</span>;
<a name="l01706"></a>01706         <a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *pchan;
<a name="l01707"></a>01707         <a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *con;
<a name="l01708"></a>01708         <a class="code" href="../../d7/dbe/structbConstraintChannel.html">bConstraintChannel</a> *conchan, *conchann;
<a name="l01709"></a>01709         
<a name="l01710"></a>01710         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting ob %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l01711"></a>01711         
<a name="l01712"></a>01712         <span class="comment">/* check if object has any animation data */</span>
<a name="l01713"></a>01713         <span class="keywordflow">if</span> (ob-&gt;nlastrips.first) {
<a name="l01714"></a>01714             <span class="comment">/* Add AnimData block */</span>
<a name="l01715"></a>01715             <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01716"></a>01716             
<a name="l01717"></a>01717             <span class="comment">/* IPO first to take into any non-NLA&#39;d Object Animation */</span>
<a name="l01718"></a>01718             <span class="keywordflow">if</span> (ob-&gt;ipo) {
<a name="l01719"></a>01719                 <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, ob-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01720"></a>01720                 
<a name="l01721"></a>01721                 ob-&gt;ipo-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01722"></a>01722                 ob-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01723"></a>01723             }
<a name="l01724"></a>01724             
<a name="l01725"></a>01725             <span class="comment">/* Action is skipped since it&#39;ll be used by some strip in the NLA anyway, </span>
<a name="l01726"></a>01726 <span class="comment">             * causing errors with evaluation in the new evaluation pipeline</span>
<a name="l01727"></a>01727 <span class="comment">             */</span>
<a name="l01728"></a>01728             <span class="keywordflow">if</span> (ob-&gt;action) {
<a name="l01729"></a>01729                 ob-&gt;action-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01730"></a>01730                 ob-&gt;action= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01731"></a>01731             }
<a name="l01732"></a>01732             
<a name="l01733"></a>01733             <span class="comment">/* finally NLA */</span>
<a name="l01734"></a>01734             <a class="code" href="../../da/d8f/ipo_8c.html#a4014fd078ae4ed1643fd25ebf5c11847">nlastrips_to_animdata</a>(<span class="keywordtype">id</span>, &amp;ob-&gt;nlastrips);
<a name="l01735"></a>01735         }
<a name="l01736"></a>01736         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ob-&gt;ipo) || (ob-&gt;action)) {
<a name="l01737"></a>01737             <span class="comment">/* Add AnimData block */</span>
<a name="l01738"></a>01738             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01739"></a>01739             
<a name="l01740"></a>01740             <span class="comment">/* Action first - so that Action name get conserved */</span>
<a name="l01741"></a>01741             <span class="keywordflow">if</span> (ob-&gt;action) {
<a name="l01742"></a>01742                 <a class="code" href="../../da/d8f/ipo_8c.html#a4cd435b52a6b2e3de8dcb2b5e8993c30">action_to_animdata</a>(<span class="keywordtype">id</span>, ob-&gt;action);
<a name="l01743"></a>01743                 
<a name="l01744"></a>01744                 <span class="comment">/* only decrease usercount if this Action isn&#39;t now being used by AnimData */</span>
<a name="l01745"></a>01745                 <span class="keywordflow">if</span> (ob-&gt;action != adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>) {
<a name="l01746"></a>01746                     ob-&gt;action-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01747"></a>01747                     ob-&gt;action= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01748"></a>01748                 }
<a name="l01749"></a>01749             }
<a name="l01750"></a>01750             
<a name="l01751"></a>01751             <span class="comment">/* IPO second... */</span>
<a name="l01752"></a>01752             <span class="keywordflow">if</span> (ob-&gt;ipo) {
<a name="l01753"></a>01753                 <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, ob-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01754"></a>01754                 ob-&gt;ipo-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01755"></a>01755                 ob-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01756"></a>01756             }
<a name="l01757"></a>01757         }
<a name="l01758"></a>01758         
<a name="l01759"></a>01759         <span class="comment">/* check PoseChannels for constraints with local data */</span>
<a name="l01760"></a>01760         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a23522fc15312fc5d99e1e1f68c579c25">pose</a>) {
<a name="l01761"></a>01761             <span class="comment">/* Verify if there&#39;s AnimData block */</span>
<a name="l01762"></a>01762             <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01763"></a>01763             
<a name="l01764"></a>01764             <span class="keywordflow">for</span> (pchan= ob-&gt;<a class="code" href="../../de/de7/structObject.html#a23522fc15312fc5d99e1e1f68c579c25">pose</a>-&gt;<a class="code" href="../../d3/de4/structbPose.html#a0bcc485e14443c3542a761284fa36b81">chanbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; pchan; pchan= pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a73c14c1cca1a2d1e91778f44578eeca0">next</a>) {
<a name="l01765"></a>01765                 <span class="keywordflow">for</span> (con= pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a0374b80987b804af0b60a4930f3b5e0b">constraints</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; con; con= con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a463805fc5e4f3bfb3f0bf92913808c88">next</a>) {
<a name="l01766"></a>01766                     <span class="comment">/* if constraint has own IPO, convert add these to Object </span>
<a name="l01767"></a>01767 <span class="comment">                     * (NOTE: they&#39;re most likely to be drivers too) </span>
<a name="l01768"></a>01768 <span class="comment">                     */</span>
<a name="l01769"></a>01769                     <span class="keywordflow">if</span> (con-&gt;ipo) {
<a name="l01770"></a>01770                         <span class="comment">/* although this was the constraint&#39;s local IPO, we still need to provide pchan + con </span>
<a name="l01771"></a>01771 <span class="comment">                         * so that drivers can be added properly...</span>
<a name="l01772"></a>01772 <span class="comment">                         */</span>
<a name="l01773"></a>01773                         <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, con-&gt;ipo, pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a8e947cbe29071a1c347abe644fe9c0c1">name</a>, con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a331611e15b92efae7bdd74c1a849e8e6">name</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01774"></a>01774                         con-&gt;ipo-&gt;id.us--;
<a name="l01775"></a>01775                         con-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01776"></a>01776                     }
<a name="l01777"></a>01777                 }
<a name="l01778"></a>01778             }
<a name="l01779"></a>01779         }
<a name="l01780"></a>01780         
<a name="l01781"></a>01781         <span class="comment">/* check constraints for local IPO&#39;s */</span>
<a name="l01782"></a>01782         <span class="keywordflow">for</span> (con= ob-&gt;<a class="code" href="../../de/de7/structObject.html#a15cd252985e63b0a4b12a07297a7aa8b">constraints</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; con; con= con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a463805fc5e4f3bfb3f0bf92913808c88">next</a>) {
<a name="l01783"></a>01783             <span class="comment">/* if constraint has own IPO, convert add these to Object </span>
<a name="l01784"></a>01784 <span class="comment">             * (NOTE: they&#39;re most likely to be drivers too) </span>
<a name="l01785"></a>01785 <span class="comment">             */</span>
<a name="l01786"></a>01786             <span class="keywordflow">if</span> (con-&gt;ipo) {
<a name="l01787"></a>01787                 <span class="comment">/* Verify if there&#39;s AnimData block, just in case */</span>
<a name="l01788"></a>01788                 <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01789"></a>01789                 
<a name="l01790"></a>01790                 <span class="comment">/* although this was the constraint&#39;s local IPO, we still need to provide con </span>
<a name="l01791"></a>01791 <span class="comment">                 * so that drivers can be added properly...</span>
<a name="l01792"></a>01792 <span class="comment">                 */</span>
<a name="l01793"></a>01793                 <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, con-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a331611e15b92efae7bdd74c1a849e8e6">name</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01794"></a>01794                 con-&gt;ipo-&gt;id.us--;
<a name="l01795"></a>01795                 con-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01796"></a>01796             }
<a name="l01797"></a>01797              
<a name="l01798"></a>01798             <span class="comment">/* check for Action Constraint */</span>
<a name="l01799"></a>01799             <span class="comment">// XXX do we really want to do this here?</span>
<a name="l01800"></a>01800         }
<a name="l01801"></a>01801         
<a name="l01802"></a>01802         <span class="comment">/* check constraint channels - we need to remove them anyway... */</span>
<a name="l01803"></a>01803         <span class="keywordflow">if</span> (ob-&gt;constraintChannels.first) {
<a name="l01804"></a>01804             <span class="comment">/* Verify if there&#39;s AnimData block */</span>
<a name="l01805"></a>01805             <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01806"></a>01806             
<a name="l01807"></a>01807             <span class="keywordflow">for</span> (conchan= ob-&gt;constraintChannels.first; conchan; conchan= conchann) {
<a name="l01808"></a>01808                 <span class="comment">/* get pointer to next Constraint Channel */</span>
<a name="l01809"></a>01809                 conchann= conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#acac0a238b06eef93fe5ae0a1051a510b">next</a>;
<a name="l01810"></a>01810                 
<a name="l01811"></a>01811                 <span class="comment">/* convert Constraint Channel&#39;s IPO data */</span>
<a name="l01812"></a>01812                 <span class="keywordflow">if</span> (conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>) {
<a name="l01813"></a>01813                     <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a04d85eff71b45989e31cba64b7286f15">name</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01814"></a>01814                     conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01815"></a>01815                     conchan-&gt;<a class="code" href="../../d7/dbe/structbConstraintChannel.html#a45e2b4eb3c4093b7f136b0c2e7a360eb">ipo</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01816"></a>01816                 }
<a name="l01817"></a>01817                 
<a name="l01818"></a>01818                 <span class="comment">/* free Constraint Channel */</span>
<a name="l01819"></a>01819                 <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a2bb7ce226f8b42d21eb35100f0bb4580">BLI_freelinkN</a>(&amp;ob-&gt;constraintChannels, conchan);
<a name="l01820"></a>01820             }
<a name="l01821"></a>01821         }
<a name="l01822"></a>01822         
<a name="l01823"></a>01823         <span class="comment">/* object&#39;s action will always be object-rooted */</span>
<a name="l01824"></a>01824         {
<a name="l01825"></a>01825             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(<span class="keywordtype">id</span>);
<a name="l01826"></a>01826             <span class="keywordflow">if</span> (adt &amp;&amp; adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l01827"></a>01827                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>;
<a name="l01828"></a>01828         }
<a name="l01829"></a>01829     }
<a name="l01830"></a>01830     
<a name="l01831"></a>01831     <span class="comment">/* shapekeys */</span>
<a name="l01832"></a>01832     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#a1194bb31422b5ad4cd169ea17a08c0a6">key</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01833"></a>01833         <a class="code" href="../../d1/d9e/structKey.html">Key</a> *key= (<a class="code" href="../../d1/d9e/structKey.html">Key</a> *)<span class="keywordtype">id</span>;
<a name="l01834"></a>01834         
<a name="l01835"></a>01835         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting key %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l01836"></a>01836         
<a name="l01837"></a>01837         <span class="comment">/* we&#39;re only interested in the IPO </span>
<a name="l01838"></a>01838 <span class="comment">         * NOTE: for later, it might be good to port these over to Object instead, as many of these</span>
<a name="l01839"></a>01839 <span class="comment">         * are likely to be drivers, but it&#39;s hard to trace that from here, so move this to Ob loop?</span>
<a name="l01840"></a>01840 <span class="comment">         */</span>
<a name="l01841"></a>01841         <span class="keywordflow">if</span> (key-&gt;ipo) {
<a name="l01842"></a>01842             <span class="comment">/* Add AnimData block */</span>
<a name="l01843"></a>01843             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01844"></a>01844             
<a name="l01845"></a>01845             <span class="comment">/* Convert Shapekey data... */</span>
<a name="l01846"></a>01846             <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, key-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01847"></a>01847             
<a name="l01848"></a>01848             <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l01849"></a>01849                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = key-&gt;ipo-&gt;blocktype;
<a name="l01850"></a>01850             
<a name="l01851"></a>01851             key-&gt;ipo-&gt;<a class="code" href="../../d1/d9e/structKey.html#a4e5a48e60e8ed39616fdbb90d501fc6c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01852"></a>01852             key-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01853"></a>01853         }
<a name="l01854"></a>01854     }
<a name="l01855"></a>01855     
<a name="l01856"></a>01856     <span class="comment">/* materials */</span>
<a name="l01857"></a>01857     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#afbcb0c6e7f10e562d567fe016fc6c5a5">mat</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01858"></a>01858         <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma= (<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *)<span class="keywordtype">id</span>;
<a name="l01859"></a>01859         
<a name="l01860"></a>01860         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting material %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l01861"></a>01861         
<a name="l01862"></a>01862         <span class="comment">/* we&#39;re only interested in the IPO */</span>
<a name="l01863"></a>01863         <span class="keywordflow">if</span> (ma-&gt;ipo) {
<a name="l01864"></a>01864             <span class="comment">/* Add AnimData block */</span>
<a name="l01865"></a>01865             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01866"></a>01866             
<a name="l01867"></a>01867             <span class="comment">/* Convert Material data... */</span>
<a name="l01868"></a>01868             <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, ma-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01869"></a>01869             
<a name="l01870"></a>01870             <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l01871"></a>01871                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = ma-&gt;ipo-&gt;blocktype;
<a name="l01872"></a>01872             
<a name="l01873"></a>01873             ma-&gt;ipo-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01874"></a>01874             ma-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01875"></a>01875         }
<a name="l01876"></a>01876     }
<a name="l01877"></a>01877     
<a name="l01878"></a>01878     <span class="comment">/* worlds */</span>
<a name="l01879"></a>01879     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#a10592adbf2eb366b863e2e60159107a4">world</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01880"></a>01880         <a class="code" href="../../d7/d3f/structWorld.html">World</a> *wo= (<a class="code" href="../../d7/d3f/structWorld.html">World</a> *)<span class="keywordtype">id</span>;
<a name="l01881"></a>01881         
<a name="l01882"></a>01882         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting world %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l01883"></a>01883         
<a name="l01884"></a>01884         <span class="comment">/* we&#39;re only interested in the IPO */</span>
<a name="l01885"></a>01885         <span class="keywordflow">if</span> (wo-&gt;ipo) {
<a name="l01886"></a>01886             <span class="comment">/* Add AnimData block */</span>
<a name="l01887"></a>01887             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01888"></a>01888             
<a name="l01889"></a>01889             <span class="comment">/* Convert World data... */</span>
<a name="l01890"></a>01890             <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, wo-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01891"></a>01891             
<a name="l01892"></a>01892             <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l01893"></a>01893                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = wo-&gt;ipo-&gt;blocktype;
<a name="l01894"></a>01894             
<a name="l01895"></a>01895             wo-&gt;ipo-&gt;<a class="code" href="../../d7/d3f/structWorld.html#a4504eae7c57dff86fda73ab56264a50a">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01896"></a>01896             wo-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01897"></a>01897         }
<a name="l01898"></a>01898     }
<a name="l01899"></a>01899     
<a name="l01900"></a>01900     <span class="comment">/* sequence strips */</span>
<a name="l01901"></a>01901     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#a976062774f867fa0f917c23f2ec331bb">scene</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01902"></a>01902         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)<span class="keywordtype">id</span>;
<a name="l01903"></a>01903         <a class="code" href="../../d5/de9/structEditing.html">Editing</a> * ed = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>;
<a name="l01904"></a>01904         <span class="keywordflow">if</span> (ed &amp;&amp; ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>) {
<a name="l01905"></a>01905             <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> * seq;
<a name="l01906"></a>01906             
<a name="l01907"></a>01907             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01908"></a>01908             
<a name="l01909"></a>01909             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a3de0e0aacb6fcc8f1d3cbca62bd66daf">SEQ_BEGIN</a>(ed, seq) {
<a name="l01910"></a>01910                 <a class="code" href="../../dd/d35/structIpoCurve.html">IpoCurve</a> *icu = (seq-&gt;ipo) ? seq-&gt;ipo-&gt;curve.first : <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01911"></a>01911                 <span class="keywordtype">short</span> adrcode = <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#ac04d1b308ef4cb687b1e4bef3ea30f1b">SEQ_FAC1</a>;
<a name="l01912"></a>01912                 
<a name="l01913"></a>01913                 <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>)
<a name="l01914"></a>01914                     printf(<span class="stringliteral">&quot;\tconverting sequence strip %s\n&quot;</span>, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a>+2);
<a name="l01915"></a>01915                 
<a name="l01916"></a>01916                 <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, seq-&gt;ipo, icu)) {
<a name="l01917"></a>01917                     seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4d51aeba9e74bdfeb95f3f9a216baf11">SEQ_USE_EFFECT_DEFAULT_FADE</a>;
<a name="l01918"></a>01918                     <span class="keywordflow">continue</span>;
<a name="l01919"></a>01919                 }
<a name="l01920"></a>01920                 
<a name="l01921"></a>01921                 <span class="comment">/* patch adrcode, so that we can map</span>
<a name="l01922"></a>01922 <span class="comment">                 * to different DNA variables later </span>
<a name="l01923"></a>01923 <span class="comment">                 * (semi-hack (tm) )</span>
<a name="l01924"></a>01924 <span class="comment">                 */</span>
<a name="l01925"></a>01925                 <span class="keywordflow">switch</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a>) {
<a name="l01926"></a>01926                     <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ac06b183625bca249c8c0d1168f907aeb">SEQ_IMAGE</a>:
<a name="l01927"></a>01927                     <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>:
<a name="l01928"></a>01928                     <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af051b69d8cf51868252e25a23d14e50a">SEQ_SCENE</a>:
<a name="l01929"></a>01929                     <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af37f12bdb831d524294dcd62ff0a8805">SEQ_MOVIE</a>:
<a name="l01930"></a>01930                     <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ae712fce1b76be5f0eb730367e48ac0fd">SEQ_COLOR</a>:
<a name="l01931"></a>01931                         adrcode = <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a44d9b5d716705c30878cad6278e915af">SEQ_FAC_OPACITY</a>;
<a name="l01932"></a>01932                         <span class="keywordflow">break</span>;
<a name="l01933"></a>01933                     <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a83413469cce986fba23ad6412baa63c6">SEQ_SPEED</a>:
<a name="l01934"></a>01934                         adrcode = <a class="code" href="../../dc/d5e/DNA__ipo__types_8h.html#a043caaa25e0595910987eb7a6646e3e6">SEQ_FAC_SPEED</a>;
<a name="l01935"></a>01935                         <span class="keywordflow">break</span>;
<a name="l01936"></a>01936                 }
<a name="l01937"></a>01937                 icu-&gt;<a class="code" href="../../dd/d35/structIpoCurve.html#af001bcddaa79f238ecb0e98934704c2d">adrcode</a> = adrcode;
<a name="l01938"></a>01938                 
<a name="l01939"></a>01939                 <span class="comment">/* convert IPO */</span>
<a name="l01940"></a>01940                 <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scene, seq-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, seq);
<a name="l01941"></a>01941                 
<a name="l01942"></a>01942                 <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l01943"></a>01943                     adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac2b425dbd1f73ad1720fafad2626d974">ID_SCE</a>; <span class="comment">/* scene-rooted */</span>
<a name="l01944"></a>01944                 
<a name="l01945"></a>01945                 seq-&gt;ipo-&gt;id.us--;
<a name="l01946"></a>01946                 seq-&gt;ipo = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01947"></a>01947             }
<a name="l01948"></a>01948             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>
<a name="l01949"></a>01949         }
<a name="l01950"></a>01950     }
<a name="l01951"></a>01951 
<a name="l01952"></a>01952 
<a name="l01953"></a>01953     <span class="comment">/* textures */</span>
<a name="l01954"></a>01954     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#abd9c8128d38727f789af5a4c990fe20b">tex</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01955"></a>01955         <a class="code" href="../../df/d2d/structTex.html">Tex</a> *te= (<a class="code" href="../../df/d2d/structTex.html">Tex</a> *)<span class="keywordtype">id</span>;
<a name="l01956"></a>01956         
<a name="l01957"></a>01957         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting texture %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l01958"></a>01958         
<a name="l01959"></a>01959         <span class="comment">/* we&#39;re only interested in the IPO */</span>
<a name="l01960"></a>01960         <span class="keywordflow">if</span> (te-&gt;ipo) {
<a name="l01961"></a>01961             <span class="comment">/* Add AnimData block */</span>
<a name="l01962"></a>01962             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01963"></a>01963             
<a name="l01964"></a>01964             <span class="comment">/* Convert Texture data... */</span>
<a name="l01965"></a>01965             <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, te-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01966"></a>01966             
<a name="l01967"></a>01967             <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l01968"></a>01968                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = te-&gt;ipo-&gt;blocktype;
<a name="l01969"></a>01969             
<a name="l01970"></a>01970             te-&gt;ipo-&gt;<a class="code" href="../../df/d2d/structTex.html#a8319488bcdfe2de879476bd0f7c27aa2">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01971"></a>01971             te-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01972"></a>01972         }
<a name="l01973"></a>01973     }
<a name="l01974"></a>01974     
<a name="l01975"></a>01975     <span class="comment">/* cameras */</span>
<a name="l01976"></a>01976     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#a331d71d4f599b49bb6b38e48b7cfc7bf">camera</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01977"></a>01977         <a class="code" href="../../d7/d7e/structCamera.html">Camera</a> *ca= (<a class="code" href="../../d7/d7e/structCamera.html">Camera</a> *)<span class="keywordtype">id</span>;
<a name="l01978"></a>01978         
<a name="l01979"></a>01979         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting camera %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l01980"></a>01980         
<a name="l01981"></a>01981         <span class="comment">/* we&#39;re only interested in the IPO */</span>
<a name="l01982"></a>01982         <span class="keywordflow">if</span> (ca-&gt;ipo) {
<a name="l01983"></a>01983             <span class="comment">/* Add AnimData block */</span>
<a name="l01984"></a>01984             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l01985"></a>01985             
<a name="l01986"></a>01986             <span class="comment">/* Convert Camera data... */</span>
<a name="l01987"></a>01987             <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, ca-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01988"></a>01988             
<a name="l01989"></a>01989             <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l01990"></a>01990                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = ca-&gt;ipo-&gt;blocktype;
<a name="l01991"></a>01991             
<a name="l01992"></a>01992             ca-&gt;ipo-&gt;<a class="code" href="../../d7/d7e/structCamera.html#ab734d7dca17ac9d8cefcbac786413e41">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l01993"></a>01993             ca-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01994"></a>01994         }
<a name="l01995"></a>01995     }
<a name="l01996"></a>01996     
<a name="l01997"></a>01997     <span class="comment">/* lamps */</span>
<a name="l01998"></a>01998     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#a5c8647f5ca9b577b50cda518ccd53b8a">lamp</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01999"></a>01999         <a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *la= (<a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *)<span class="keywordtype">id</span>;
<a name="l02000"></a>02000         
<a name="l02001"></a>02001         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting lamp %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l02002"></a>02002         
<a name="l02003"></a>02003         <span class="comment">/* we&#39;re only interested in the IPO */</span>
<a name="l02004"></a>02004         <span class="keywordflow">if</span> (la-&gt;ipo) {
<a name="l02005"></a>02005             <span class="comment">/* Add AnimData block */</span>
<a name="l02006"></a>02006             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l02007"></a>02007             
<a name="l02008"></a>02008             <span class="comment">/* Convert Lamp data... */</span>
<a name="l02009"></a>02009             <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, la-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02010"></a>02010             
<a name="l02011"></a>02011             <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l02012"></a>02012                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = la-&gt;ipo-&gt;blocktype;
<a name="l02013"></a>02013             
<a name="l02014"></a>02014             la-&gt;ipo-&gt;<a class="code" href="../../d5/d72/structLamp.html#add71cdc042b5fe8dc4d423f9bfcd8335">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l02015"></a>02015             la-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02016"></a>02016         }
<a name="l02017"></a>02017     }
<a name="l02018"></a>02018     
<a name="l02019"></a>02019     <span class="comment">/* curves */</span>
<a name="l02020"></a>02020     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#ac343a12d387c6a325f4e7677469a4b93">curve</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l02021"></a>02021         <a class="code" href="../../da/d10/structCurve.html">Curve</a> *cu= (<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)<span class="keywordtype">id</span>;
<a name="l02022"></a>02022         
<a name="l02023"></a>02023         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting curve %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l02024"></a>02024         
<a name="l02025"></a>02025         <span class="comment">/* we&#39;re only interested in the IPO */</span>
<a name="l02026"></a>02026         <span class="keywordflow">if</span> (cu-&gt;ipo) {
<a name="l02027"></a>02027             <span class="comment">/* Add AnimData block */</span>
<a name="l02028"></a>02028             <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a3d1b7d3abe94890891569f4bd6ba21b1">BKE_id_add_animdata</a>(<span class="keywordtype">id</span>);
<a name="l02029"></a>02029             
<a name="l02030"></a>02030             <span class="comment">/* Convert Curve data... */</span>
<a name="l02031"></a>02031             <a class="code" href="../../da/d8f/ipo_8c.html#ab9c84b87a7b9cf1c4e518da0ba130eb6">ipo_to_animdata</a>(<span class="keywordtype">id</span>, cu-&gt;ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02032"></a>02032             
<a name="l02033"></a>02033             <span class="keywordflow">if</span> (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>)
<a name="l02034"></a>02034                 adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a14a8b84cc330ffddb772fe4a224eba0a">action</a>-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = cu-&gt;ipo-&gt;blocktype;
<a name="l02035"></a>02035             
<a name="l02036"></a>02036             cu-&gt;ipo-&gt;<a class="code" href="../../da/d10/structCurve.html#a82e3c1ecb3fc12d5ebb456ec7cdc2a0e">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l02037"></a>02037             cu-&gt;ipo= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02038"></a>02038         }
<a name="l02039"></a>02039     }
<a name="l02040"></a>02040     
<a name="l02041"></a>02041     <span class="comment">/* --------- Unconverted Animation Data ------------------ */</span>
<a name="l02042"></a>02042     <span class="comment">/* For Animation data which may not be directly connected (i.e. not linked) to any other </span>
<a name="l02043"></a>02043 <span class="comment">     * data, we need to perform a separate pass to make sure that they are converted to standalone</span>
<a name="l02044"></a>02044 <span class="comment">     * Actions which may then be able to be reused. This does mean that we will be going over data that&#39;s</span>
<a name="l02045"></a>02045 <span class="comment">     * already been converted, but there are no problems with that.</span>
<a name="l02046"></a>02046 <span class="comment">     *</span>
<a name="l02047"></a>02047 <span class="comment">     * The most common case for this will be Action Constraints, or IPO&#39;s with Fake-Users. </span>
<a name="l02048"></a>02048 <span class="comment">     * We collect all drivers that were found into a temporary collection, and free them in one go, as they&#39;re </span>
<a name="l02049"></a>02049 <span class="comment">     * impossible to resolve.</span>
<a name="l02050"></a>02050 <span class="comment">     */</span>
<a name="l02051"></a>02051     
<a name="l02052"></a>02052     <span class="comment">/* actions */</span>
<a name="l02053"></a>02053     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#a672d2abaa0d861f3a2d938549cbe212b">action</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l02054"></a>02054         <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *act= (<a class="code" href="../../d1/d48/structbAction.html">bAction</a> *)<span class="keywordtype">id</span>;
<a name="l02055"></a>02055         
<a name="l02056"></a>02056         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting action %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l02057"></a>02057         
<a name="l02058"></a>02058         <span class="comment">/* if old action, it will be object-only... */</span>
<a name="l02059"></a>02059         <span class="keywordflow">if</span> (act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a3d353dd48d5478f1a943612bf1ac2388">chanbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l02060"></a>02060             act-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>;
<a name="l02061"></a>02061         
<a name="l02062"></a>02062         <span class="comment">/* be careful! some of the actions we encounter will be converted ones... */</span>
<a name="l02063"></a>02063         <a class="code" href="../../da/d8f/ipo_8c.html#a2bd479339bdd5cf65c72825e45be7205">action_to_animato</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, act, &amp;act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a6d7358fa79f9d0feec006dd2d71c9cd4">groups</a>, &amp;act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>, &amp;drivers);
<a name="l02064"></a>02064     }
<a name="l02065"></a>02065     
<a name="l02066"></a>02066     <span class="comment">/* ipo&#39;s */</span>
<a name="l02067"></a>02067     <span class="keywordflow">for</span> (<span class="keywordtype">id</span>= main-&gt;<a class="code" href="../../d0/dc0/structMain.html#a506519dfdc231b82be806d4b53a09a4c">ipo</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span>= id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l02068"></a>02068         <a class="code" href="../../d2/dc5/structIpo.html">Ipo</a> *ipo= (<a class="code" href="../../d2/dc5/structIpo.html">Ipo</a> *)<span class="keywordtype">id</span>;
<a name="l02069"></a>02069         
<a name="l02070"></a>02070         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) printf(<span class="stringliteral">&quot;\tconverting ipo %s\n&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l02071"></a>02071         
<a name="l02072"></a>02072         <span class="comment">/* most likely this IPO has already been processed, so check if any curves left to convert */</span>
<a name="l02073"></a>02073         <span class="keywordflow">if</span> (ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a12f162ec784c7d4b3336c583dfa468e4">curve</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) {
<a name="l02074"></a>02074             <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *new_act;
<a name="l02075"></a>02075             
<a name="l02076"></a>02076             <span class="comment">/* add a new action for this, and convert all data into that action */</span>
<a name="l02077"></a>02077             new_act= <a class="code" href="../../d8/df5/BKE__action_8h.html#a77b6bd66ec260f2485cf1ff2d075fdb2">add_empty_action</a>(<span class="stringliteral">&quot;ConvIPO_Action&quot;</span>); <span class="comment">// XXX need a better name...</span>
<a name="l02078"></a>02078             <a class="code" href="../../da/d8f/ipo_8c.html#a80e9604cefd2edf5f0836a28d9342fd2">ipo_to_animato</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ipo, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;new_act-&gt;<a class="code" href="../../d1/d48/structbAction.html#a17c9f9250f377305171640e7a4aa7666">curves</a>, &amp;drivers);
<a name="l02079"></a>02079             new_act-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> = ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a578f52dc83257a470bd250f1ecee80c8">blocktype</a>;
<a name="l02080"></a>02080         }
<a name="l02081"></a>02081         
<a name="l02082"></a>02082         <span class="comment">/* clear fake-users, and set user-count to zero to make sure it is cleared on file-save */</span>
<a name="l02083"></a>02083         ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>= 0;
<a name="l02084"></a>02084         ipo-&gt;<a class="code" href="../../d2/dc5/structIpo.html#a63e8c79420e9fc86a87d0bb7d1bd553c">id</a>.<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp;= ~<a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac7a490f7c486f67fa46961f920fc8e26">LIB_FAKEUSER</a>;
<a name="l02085"></a>02085     }
<a name="l02086"></a>02086     
<a name="l02087"></a>02087     <span class="comment">/* free unused drivers from actions + ipos */</span>
<a name="l02088"></a>02088     <a class="code" href="../../da/dba/BKE__fcurve_8h.html#ab62d82f0242ead6ce4d83cf4e5d26774">free_fcurves</a>(&amp;drivers);
<a name="l02089"></a>02089     
<a name="l02090"></a>02090     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>)
<a name="l02091"></a>02091         printf(<span class="stringliteral">&quot;INFO: Animato convert done\n&quot;</span>);
<a name="l02092"></a>02092 }
<a name="l02093"></a>02093 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:26 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
