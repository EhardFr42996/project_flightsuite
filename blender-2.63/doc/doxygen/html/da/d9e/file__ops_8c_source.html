<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: file_ops.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">file_ops.c</div>  </div>
</div>
<div class="contents">
<a href="../../da/d9e/file__ops_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version. </span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2008 Blender Foundation.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * </span>
<a name="l00022"></a>00022 <span class="comment"> * Contributor(s): Andrea Weikert (c) 2008 Blender Foundation</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/da3/BKE__screen_8h.html">BKE_screen.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/BKE__report_8h.html">BKE_report.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#  include &quot;<a class="code" href="../../d9/ded/BLI__winstuff_8h.html" title="Compatibility-like things for windows.">BLI_winstuff.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#endif</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../db/db9/ED__fileselect_8h.html">ED_fileselect.h</a>&quot;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/RNA__define_8h.html">RNA_define.h</a>&quot;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d63/UI__view2d_8h.html">UI_view2d.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d71/file__intern_8h.html">file_intern.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d6a/filelist_8h.html">filelist.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/dc1/fsmenu_8h.html">fsmenu.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/* for events */</span>
<a name="l00068"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a1b69eb215801e3ec4418aface9840caa">00068</a> <span class="preprocessor">#define NOTACTIVEFILE           0</span>
<a name="l00069"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ad37ed8e28abe573e992766b0e3b0353b">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define ACTIVATE            1</span>
<a name="l00070"></a><a class="code" href="../../da/d9e/file__ops_8c.html#adf779156ceee91b558cdf7e2627828ac">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define INACTIVATE          2</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00072"></a>00072 <span class="comment">/* ---------- FILE SELECTION ------------ */</span>
<a name="l00073"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a43f88ae43e0936ef16c55c44e07c252d">00073</a> <span class="keyword">static</span> <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> <a class="code" href="../../da/d9e/file__ops_8c.html#a43f88ae43e0936ef16c55c44e07c252d">find_file_mouse_rect</a>(<a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile, <span class="keyword">struct</span> <a class="code" href="../../da/d23/structARegion.html">ARegion</a>* ar, <span class="keyword">const</span> <a class="code" href="../../d0/d28/structrcti.html">rcti</a>* rect)
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075     <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> sel;
<a name="l00076"></a>00076     <span class="keywordtype">float</span> fxmin,fymin,fxmax, fymax;
<a name="l00077"></a>00077     
<a name="l00078"></a>00078     <a class="code" href="../../d7/de3/structView2D.html">View2D</a>* v2d = &amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>;
<a name="l00079"></a>00079     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> rect_view;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, &amp;fxmin, &amp;fymin);
<a name="l00082"></a>00082     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>, &amp;fxmax, &amp;fymax);
<a name="l00083"></a>00083 
<a name="l00084"></a>00084     <a class="code" href="../../d5/d44/BLI__rect_8h.html#a77ca41dd284a3c2859185a86c173aef2">BLI_init_rcti</a>(&amp;rect_view, (<span class="keywordtype">int</span>)(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> + fxmin), (<span class="keywordtype">int</span>)(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> + fxmax), (<span class="keywordtype">int</span>)(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - fymin), (<span class="keywordtype">int</span>)(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - fymax));
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     sel  = <a class="code" href="../../db/db9/ED__fileselect_8h.html#a40f298be22a9970fb179b164c286d3dc">ED_fileselect_layout_offset_rect</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>, &amp;rect_view);
<a name="l00087"></a>00087     
<a name="l00088"></a>00088     <span class="keywordflow">return</span> sel;
<a name="l00089"></a>00089 }
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a3c14e92ea14dd24931650d1e51f29c82">00091</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a3c14e92ea14dd24931650d1e51f29c82">file_deselect_all</a>(<a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a>* sfile, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flag)
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093     <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> sel;
<a name="l00094"></a>00094     sel.<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> = 0;
<a name="l00095"></a>00095     sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>)-1;
<a name="l00096"></a>00096     
<a name="l00097"></a>00097     <a class="code" href="../../db/d74/filelist_8c.html#a8fe34149dcac0eb80d981ce7a81a89b9">filelist_select</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, &amp;sel, <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1fa23468b3691b18807a535d78687523992">FILE_SEL_REMOVE</a>, flag, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>);
<a name="l00098"></a>00098 }
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">00100</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a> { 
<a name="l00101"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a30aab39eaf7841907e7aad5d8cf46a75">00101</a>     <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a30aab39eaf7841907e7aad5d8cf46a75">FILE_SELECT_NOTHING</a> = 0,
<a name="l00102"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a6343f74f8725d34dd21bb1d10cdfda76">00102</a>     <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a6343f74f8725d34dd21bb1d10cdfda76">FILE_SELECT_DIR</a> = 1, 
<a name="l00103"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264aa014b4eaf238b3b93f8e1c0946791fee">00103</a>     <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264aa014b4eaf238b3b93f8e1c0946791fee">FILE_SELECT_FILE</a> = 2 
<a name="l00104"></a>00104 } <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a>;
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a6f44890047cf1cec1a61efadd2164aa4">00106</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a6f44890047cf1cec1a61efadd2164aa4">clamp_to_filelist</a>(<span class="keywordtype">int</span> numfiles, <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a>* sel)
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108     <span class="comment">/* border select before the first file */</span>
<a name="l00109"></a>00109     <span class="keywordflow">if</span> ( (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> &lt; 0) &amp;&amp; (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &gt;=0 ) ) {
<a name="l00110"></a>00110         sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> = 0;
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112     <span class="comment">/* don&#39;t select if everything is outside filelist */</span>
<a name="l00113"></a>00113     <span class="keywordflow">if</span> ( (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> &gt;= numfiles) &amp;&amp; ((sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &lt; 0) || (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &gt;= numfiles)) ) {
<a name="l00114"></a>00114         sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> = -1;
<a name="l00115"></a>00115         sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> = -1;
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117     
<a name="l00118"></a>00118     <span class="comment">/* fix if last file invalid */</span>
<a name="l00119"></a>00119     <span class="keywordflow">if</span> ( (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> &gt; 0) &amp;&amp; (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &lt; 0) )
<a name="l00120"></a>00120         sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> = numfiles-1;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="comment">/* clamp */</span>
<a name="l00123"></a>00123     <span class="keywordflow">if</span> ( (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> &gt;= numfiles) ) {
<a name="l00124"></a>00124         sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> = numfiles-1;
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126     <span class="keywordflow">if</span> ( (sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &gt;= numfiles) ) {
<a name="l00127"></a>00127         sel-&gt;<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> = numfiles-1;
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a137f4512f027b13de8e99dddf1dd9957">00131</a> <span class="keyword">static</span> <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> <a class="code" href="../../da/d9e/file__ops_8c.html#a137f4512f027b13de8e99dddf1dd9957">file_selection_get</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a>* <a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keyword">const</span> <a class="code" href="../../d0/d28/structrcti.html">rcti</a>* rect, <span class="keywordtype">short</span> fill)
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00134"></a>00134     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00135"></a>00135     <span class="keywordtype">int</span> numfiles = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>);
<a name="l00136"></a>00136     <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> sel;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     sel = <a class="code" href="../../da/d9e/file__ops_8c.html#a43f88ae43e0936ef16c55c44e07c252d">find_file_mouse_rect</a>(sfile, ar, rect);
<a name="l00139"></a>00139     <span class="keywordflow">if</span> ( !((sel.<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> == -1) &amp;&amp; (sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> == -1)) ) {
<a name="l00140"></a>00140         <a class="code" href="../../da/d9e/file__ops_8c.html#a6f44890047cf1cec1a61efadd2164aa4">clamp_to_filelist</a>(numfiles, &amp;sel);
<a name="l00141"></a>00141     }
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     <span class="comment">/* if desired, fill the selection up from the last selected file to the current one */</span>
<a name="l00145"></a>00145     <span class="keywordflow">if</span> (fill &amp;&amp; (sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &gt;= 0) &amp;&amp; (sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &lt; numfiles) ) {
<a name="l00146"></a>00146         <span class="keywordtype">int</span> f= sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a>;
<a name="l00147"></a>00147         <span class="keywordflow">while</span> (f &gt;= 0) {
<a name="l00148"></a>00148             <span class="keywordflow">if</span> ( <a class="code" href="../../db/d74/filelist_8c.html#a3fa7021bb02a2bdf36db713c1c8c424e">filelist_is_selected</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, f, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>) )
<a name="l00149"></a>00149                 <span class="keywordflow">break</span>;
<a name="l00150"></a>00150             f--;
<a name="l00151"></a>00151         }
<a name="l00152"></a>00152         <span class="keywordflow">if</span> (f &gt;= 0) {
<a name="l00153"></a>00153             sel.<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> = f+1;
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156     <span class="keywordflow">return</span> sel;
<a name="l00157"></a>00157 }
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a55f0c9040c874778893be157f3c1897d">00159</a> <span class="keyword">static</span> <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a> <a class="code" href="../../da/d9e/file__ops_8c.html#a55f0c9040c874778893be157f3c1897d">file_select_do</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a>* <a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">int</span> selected_idx)
<a name="l00160"></a>00160 {
<a name="l00161"></a>00161     <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a> retval = <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a30aab39eaf7841907e7aad5d8cf46a75">FILE_SELECT_NOTHING</a>;
<a name="l00162"></a>00162     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00163"></a>00163     <a class="code" href="../../d2/da8/structFileSelectParams.html">FileSelectParams</a> *params = <a class="code" href="../../db/db9/ED__fileselect_8h.html#a636b839dfef31f4a00e1116ab70e4d86">ED_fileselect_get_params</a>(sfile);
<a name="l00164"></a>00164     <span class="keywordtype">int</span> numfiles = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>);
<a name="l00165"></a>00165     <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a>* file;
<a name="l00166"></a>00166 
<a name="l00167"></a>00167     <span class="comment">/* make the selected file active */</span>
<a name="l00168"></a>00168     <span class="keywordflow">if</span> (        (selected_idx &gt;= 0) &amp;&amp;
<a name="l00169"></a>00169                 (selected_idx &lt; numfiles) &amp;&amp;
<a name="l00170"></a>00170                 (file= <a class="code" href="../../db/d74/filelist_8c.html#ae39663828b3dcd7ba509fdfa88051c42">filelist_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, selected_idx)))
<a name="l00171"></a>00171     {
<a name="l00172"></a>00172         params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a> = selected_idx;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         <span class="keywordflow">if</span> (<a class="code" href="../../d9/ded/BLI__winstuff_8h.html#a8b545e50cb6e6bd55ed72564bf52cacc">S_ISDIR</a>(file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#aff2ede3a107ed9d4ce33dd36d0c57e76">type</a>)) {
<a name="l00175"></a>00175             <span class="comment">/* the path is too long and we are not going up! */</span>
<a name="l00176"></a>00176             <span class="keywordflow">if</span> (strcmp(file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>, <span class="stringliteral">&quot;..&quot;</span>) &amp;&amp; <a class="code" href="../../d1/d22/stdosl_8h.html#af902ac638d8127503ad64a0eacb3a7e8">strlen</a>(params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>) + <a class="code" href="../../d1/d22/stdosl_8h.html#af902ac638d8127503ad64a0eacb3a7e8">strlen</a>(file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>) &gt;= <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a> ) {
<a name="l00177"></a>00177                 <span class="comment">// XXX error(&quot;Path too long, cannot enter this directory&quot;);</span>
<a name="l00178"></a>00178             }
<a name="l00179"></a>00179             <span class="keywordflow">else</span> {
<a name="l00180"></a>00180                 <span class="keywordflow">if</span> (strcmp(file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>, <span class="stringliteral">&quot;..&quot;</span>)==0) {
<a name="l00181"></a>00181                     <span class="comment">/* avoids /../../ */</span>
<a name="l00182"></a>00182                     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a286d1c9a8dd8e3d947274afa9c4fba9e">BLI_parent_dir</a>(params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00183"></a>00183                 }
<a name="l00184"></a>00184                 <span class="keywordflow">else</span> {
<a name="l00185"></a>00185                     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a7fcb2651a621a0b5e761fbe2a6add270">BLI_cleanup_dir</a>(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name, params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00186"></a>00186                     strcat(params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>);
<a name="l00187"></a>00187                     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#ab80bd3eb1d5a53807b777f4912b34cd9">BLI_add_slash</a>(params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00188"></a>00188                 }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190                 <a class="code" href="../../d4/d71/file__intern_8h.html#af7233b3e3a8c38045eb2fde332224c50">file_change_dir</a>(C, 0);
<a name="l00191"></a>00191                 retval = <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a6343f74f8725d34dd21bb1d10cdfda76">FILE_SELECT_DIR</a>;
<a name="l00192"></a>00192             }
<a name="l00193"></a>00193         }
<a name="l00194"></a>00194         <span class="keywordflow">else</span> {
<a name="l00195"></a>00195             <span class="keywordflow">if</span> (file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>) {
<a name="l00196"></a>00196                 <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>, file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>);
<a name="l00197"></a>00197             }
<a name="l00198"></a>00198             retval = <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264aa014b4eaf238b3b93f8e1c0946791fee">FILE_SELECT_FILE</a>;
<a name="l00199"></a>00199         }
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201     <span class="keywordflow">return</span> retval;
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ab4e525bec9c47a0f7057de04e12a7c30">00205</a> <span class="keyword">static</span> <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a> <a class="code" href="../../da/d9e/file__ops_8c.html#ab4e525bec9c47a0f7057de04e12a7c30">file_select</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a>* <a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keyword">const</span> <a class="code" href="../../d0/d28/structrcti.html">rcti</a>* rect, <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1f">FileSelType</a> select, <span class="keywordtype">short</span> fill)
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00208"></a>00208     <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a> retval = <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a30aab39eaf7841907e7aad5d8cf46a75">FILE_SELECT_NOTHING</a>;
<a name="l00209"></a>00209     <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> sel= <a class="code" href="../../da/d9e/file__ops_8c.html#a137f4512f027b13de8e99dddf1dd9957">file_selection_get</a>(C, rect, fill); <span class="comment">/* get the selection */</span>
<a name="l00210"></a>00210     <span class="keyword">const</span> <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1">FileCheckType</a> check_type= (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a3c6acc46c9f74e155a16521aa43e446d">flag</a> &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#abb65306ddc283c3df800be6ebe99c25d">FILE_DIRSEL_ONLY</a>) ? <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a15316ab090e454e90c0a578fff60a1b9">CHECK_DIRS</a> : <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>;
<a name="l00211"></a>00211     
<a name="l00212"></a>00212     <span class="comment">/* flag the files as selected in the filelist */</span>
<a name="l00213"></a>00213     <a class="code" href="../../db/d74/filelist_8c.html#a8fe34149dcac0eb80d981ce7a81a89b9">filelist_select</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, &amp;sel, select, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a0b4d7f067dfb4a502fca2a35b0033126">SELECTED_FILE</a>, check_type);
<a name="l00214"></a>00214     
<a name="l00215"></a>00215     <span class="comment">/* Don&#39;t act on multiple selected files */</span>
<a name="l00216"></a>00216     <span class="keywordflow">if</span> (sel.<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> != sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a>) select = 0;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <span class="comment">/* Do we have a valid selection and are we actually selecting */</span>
<a name="l00219"></a>00219     <span class="keywordflow">if</span> ((sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> &gt;= 0) &amp;&amp; ((select == <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1faa469b85fde04398148e8cc09f6cce1a1">FILE_SEL_ADD</a>) || (select == <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1fabfd9ba8e2d1e31f37408bb22e8bfe778">FILE_SEL_TOGGLE</a>))) {
<a name="l00220"></a>00220         <span class="comment">/* Check last selection, if selected, act on the file or dir */</span>
<a name="l00221"></a>00221         <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a3fa7021bb02a2bdf36db713c1c8c424e">filelist_is_selected</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a>, check_type)) {
<a name="l00222"></a>00222             retval = <a class="code" href="../../da/d9e/file__ops_8c.html#a55f0c9040c874778893be157f3c1897d">file_select_do</a>(C, sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a>);
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <span class="comment">/* update operator for name change event */</span>
<a name="l00227"></a>00227     <a class="code" href="../../d4/d71/file__intern_8h.html#ad90dbf875c519a204b3ee4413b5a92b7">file_draw_check_cb</a>(C, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00228"></a>00228     
<a name="l00229"></a>00229     <span class="keywordflow">return</span> retval;
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a2b40b8d70a92606b0ee73521ddf6fd24">00232</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a2b40b8d70a92606b0ee73521ddf6fd24">file_border_select_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00235"></a>00235     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00236"></a>00236     <a class="code" href="../../d2/da8/structFileSelectParams.html">FileSelectParams</a> *params = <a class="code" href="../../db/db9/ED__fileselect_8h.html#a636b839dfef31f4a00e1116ab70e4d86">ED_fileselect_get_params</a>(sfile);
<a name="l00237"></a>00237     <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> sel;
<a name="l00238"></a>00238     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> rect;
<a name="l00239"></a>00239 
<a name="l00240"></a>00240     <span class="keywordtype">int</span> result;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     result= <a class="code" href="../../d6/dae/wm__operators_8c.html#ab6bb53ebc07c5ca59c0a1a687124de2b">WM_border_select_modal</a>(C, op, event);
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <span class="keywordflow">if</span> (result==<a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>) {
<a name="l00245"></a>00245 
<a name="l00246"></a>00246         rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmin&quot;</span>);
<a name="l00247"></a>00247         rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymin&quot;</span>);
<a name="l00248"></a>00248         rect.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmax&quot;</span>);
<a name="l00249"></a>00249         rect.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymax&quot;</span>);
<a name="l00250"></a>00250 
<a name="l00251"></a>00251         <a class="code" href="../../d5/d44/BLI__rect_8h.html#abefa6d62a6bf5021bb1567112c87fd09">BLI_isect_rcti</a>(&amp;(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>.<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>), &amp;rect, &amp;rect);
<a name="l00252"></a>00252 
<a name="l00253"></a>00253         sel = <a class="code" href="../../da/d9e/file__ops_8c.html#a137f4512f027b13de8e99dddf1dd9957">file_selection_get</a>(C, &amp;rect, 0);
<a name="l00254"></a>00254         <span class="keywordflow">if</span> ( (sel.<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> != params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a5c34341bc073cb9eb74063fa4cf13566">sel_first</a>) || (sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> != params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#ac95c3665953526b26f402c8c1490fb05">sel_last</a>) ) {
<a name="l00255"></a>00255             <a class="code" href="../../da/d9e/file__ops_8c.html#a3c14e92ea14dd24931650d1e51f29c82">file_deselect_all</a>(sfile, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a4324ec928723150f41918fdb215d22b2">HILITED_FILE</a>);
<a name="l00256"></a>00256             <a class="code" href="../../db/d74/filelist_8c.html#a8fe34149dcac0eb80d981ce7a81a89b9">filelist_select</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, &amp;sel, <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1faa469b85fde04398148e8cc09f6cce1a1">FILE_SEL_ADD</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a4324ec928723150f41918fdb215d22b2">HILITED_FILE</a>, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>);
<a name="l00257"></a>00257             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae29e0307bcc4666f4ca65cf12480fde6">ND_SPACE_FILE_PARAMS</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259         params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a5c34341bc073cb9eb74063fa4cf13566">sel_first</a> = sel.<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a>; params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#ac95c3665953526b26f402c8c1490fb05">sel_last</a> = sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262     <span class="keywordflow">else</span> {
<a name="l00263"></a>00263         params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a> = -1;
<a name="l00264"></a>00264         params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a5c34341bc073cb9eb74063fa4cf13566">sel_first</a> = params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#ac95c3665953526b26f402c8c1490fb05">sel_last</a> = -1;
<a name="l00265"></a>00265         <a class="code" href="../../da/d9e/file__ops_8c.html#a3c14e92ea14dd24931650d1e51f29c82">file_deselect_all</a>(sfile, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a4324ec928723150f41918fdb215d22b2">HILITED_FILE</a>);
<a name="l00266"></a>00266         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae29e0307bcc4666f4ca65cf12480fde6">ND_SPACE_FILE_PARAMS</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     <span class="keywordflow">return</span> result;
<a name="l00270"></a>00270 }
<a name="l00271"></a>00271 
<a name="l00272"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a60c743c7ef9d1ea16682162ba21cc138">00272</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a60c743c7ef9d1ea16682162ba21cc138">file_border_select_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00273"></a>00273 {
<a name="l00274"></a>00274     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00275"></a>00275     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> rect;
<a name="l00276"></a>00276     <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a> ret;
<a name="l00277"></a>00277     <span class="keywordtype">int</span> extend= <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;extend&quot;</span>);
<a name="l00278"></a>00278     <span class="keywordtype">short</span> select= (<a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;gesture_mode&quot;</span>)==<a class="code" href="../../d1/d40/wm__event__types_8h.html#a99328936c1f7e4fc8d4a889098d4d22d">GESTURE_MODAL_SELECT</a>);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280     rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmin&quot;</span>);
<a name="l00281"></a>00281     rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymin&quot;</span>);
<a name="l00282"></a>00282     rect.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmax&quot;</span>);
<a name="l00283"></a>00283     rect.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymax&quot;</span>);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     <span class="keywordflow">if</span> (!extend) {
<a name="l00286"></a>00286         <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00287"></a>00287 
<a name="l00288"></a>00288         <a class="code" href="../../da/d9e/file__ops_8c.html#a3c14e92ea14dd24931650d1e51f29c82">file_deselect_all</a>(sfile, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a0b4d7f067dfb4a502fca2a35b0033126">SELECTED_FILE</a>);
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <a class="code" href="../../d5/d44/BLI__rect_8h.html#abefa6d62a6bf5021bb1567112c87fd09">BLI_isect_rcti</a>(&amp;(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>.<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>), &amp;rect, &amp;rect);
<a name="l00292"></a>00292 
<a name="l00293"></a>00293     ret = <a class="code" href="../../da/d9e/file__ops_8c.html#ab4e525bec9c47a0f7057de04e12a7c30">file_select</a>(C, &amp;rect, select ? <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1faa469b85fde04398148e8cc09f6cce1a1">FILE_SEL_ADD</a> : <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1fa23468b3691b18807a535d78687523992">FILE_SEL_REMOVE</a>, 0);
<a name="l00294"></a>00294     <span class="keywordflow">if</span> (<a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a6343f74f8725d34dd21bb1d10cdfda76">FILE_SELECT_DIR</a> == ret) {
<a name="l00295"></a>00295         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00296"></a>00296     }
<a name="l00297"></a>00297     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264aa014b4eaf238b3b93f8e1c0946791fee">FILE_SELECT_FILE</a> == ret) {
<a name="l00298"></a>00298         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae29e0307bcc4666f4ca65cf12480fde6">ND_SPACE_FILE_PARAMS</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a182b3b82e4e833cd345d2c2ab2d1bb4d">00303</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#abb01954afd97bd66cb3843222ff5004a">FILE_OT_select_border</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00304"></a>00304 {
<a name="l00305"></a>00305     <span class="comment">/* identifiers */</span>
<a name="l00306"></a>00306     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Activate/Select File&quot;</span>;
<a name="l00307"></a>00307     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Activate/select the file(s) contained in the border&quot;</span>;
<a name="l00308"></a>00308     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_select_border&quot;</span>;
<a name="l00309"></a>00309     
<a name="l00310"></a>00310     <span class="comment">/* api callbacks */</span>
<a name="l00311"></a>00311     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a8d45022b7baa1add659b6798c15601b1">WM_border_select_invoke</a>;
<a name="l00312"></a>00312     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a60c743c7ef9d1ea16682162ba21cc138">file_border_select_exec</a>;
<a name="l00313"></a>00313     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a2b40b8d70a92606b0ee73521ddf6fd24">file_border_select_modal</a>;
<a name="l00314"></a>00314     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l00315"></a>00315     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a30c4cae4bcb919d6519d9a1b5b77cdb0">WM_border_select_cancel</a>;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317     <span class="comment">/* rna */</span>
<a name="l00318"></a>00318     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7df9a6eccb78facfa397098a5ad2bc4a">WM_operator_properties_gesture_border</a>(ot, 1);
<a name="l00319"></a>00319 }
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a8433910f69b49665d94e992601fd83e9">00321</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a8433910f69b49665d94e992601fd83e9">file_select_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00322"></a>00322 {
<a name="l00323"></a>00323     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00324"></a>00324     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00325"></a>00325     <a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264">FileSelect</a> ret;
<a name="l00326"></a>00326     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> rect;
<a name="l00327"></a>00327     <span class="keywordtype">int</span> extend = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;extend&quot;</span>);
<a name="l00328"></a>00328     <span class="keywordtype">int</span> fill = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;fill&quot;</span>);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>)
<a name="l00331"></a>00331         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333     rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> = rect.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> = <span class="keyword">event</span>-&gt;mval[0];
<a name="l00334"></a>00334     rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> = rect.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> = <span class="keyword">event</span>-&gt;mval[1];
<a name="l00335"></a>00335 
<a name="l00336"></a>00336     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d44/BLI__rect_8h.html#a1242dd13fb888a0146765107474fffb4">BLI_in_rcti</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>.<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>, rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>))
<a name="l00337"></a>00337         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     <span class="comment">/* single select, deselect all selected first */</span>
<a name="l00340"></a>00340     <span class="keywordflow">if</span> (!extend) <a class="code" href="../../da/d9e/file__ops_8c.html#a3c14e92ea14dd24931650d1e51f29c82">file_deselect_all</a>(sfile, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a0b4d7f067dfb4a502fca2a35b0033126">SELECTED_FILE</a>);
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     ret = <a class="code" href="../../da/d9e/file__ops_8c.html#ab4e525bec9c47a0f7057de04e12a7c30">file_select</a>(C, &amp;rect, extend ? <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1fabfd9ba8e2d1e31f37408bb22e8bfe778">FILE_SEL_TOGGLE</a> : <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1faa469b85fde04398148e8cc09f6cce1a1">FILE_SEL_ADD</a>, fill);
<a name="l00343"></a>00343     <span class="keywordflow">if</span> (<a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264a6343f74f8725d34dd21bb1d10cdfda76">FILE_SELECT_DIR</a> == ret)
<a name="l00344"></a>00344         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00345"></a>00345     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../da/d9e/file__ops_8c.html#ae1a5bbcf38d20e2608e4f49920711264aa014b4eaf238b3b93f8e1c0946791fee">FILE_SELECT_FILE</a> == ret)
<a name="l00346"></a>00346         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae29e0307bcc4666f4ca65cf12480fde6">ND_SPACE_FILE_PARAMS</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     <a class="code" href="../../df/db0/wm__event__system_8c.html#a1d397b4836b1aa453112a4cc59550686">WM_event_add_mousemove</a>(C); <span class="comment">/* for directory changes */</span>
<a name="l00349"></a>00349     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae29e0307bcc4666f4ca65cf12480fde6">ND_SPACE_FILE_PARAMS</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00352"></a>00352 }
<a name="l00353"></a>00353 
<a name="l00354"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a990fa919324c64085f22ebb1ee658a88">00354</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a4b5a3906c0104000fdb2818cb302a9a0">FILE_OT_select</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00355"></a>00355 {
<a name="l00356"></a>00356     <span class="comment">/* identifiers */</span>
<a name="l00357"></a>00357     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Activate/Select File&quot;</span>;
<a name="l00358"></a>00358     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Activate/select file&quot;</span>;
<a name="l00359"></a>00359     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_select&quot;</span>;
<a name="l00360"></a>00360     
<a name="l00361"></a>00361     <span class="comment">/* api callbacks */</span>
<a name="l00362"></a>00362     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a8433910f69b49665d94e992601fd83e9">file_select_invoke</a>;
<a name="l00363"></a>00363     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     <span class="comment">/* rna */</span>
<a name="l00366"></a>00366     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;extend&quot;</span>, 0, <span class="stringliteral">&quot;Extend&quot;</span>, <span class="stringliteral">&quot;Extend selection instead of deselecting everything first&quot;</span>);
<a name="l00367"></a>00367     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;fill&quot;</span>, 0, <span class="stringliteral">&quot;Fill&quot;</span>, <span class="stringliteral">&quot;Select everything beginning with the last selection&quot;</span>);
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a0dbadaebec0e49921920754fb472a8a8">00370</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a0dbadaebec0e49921920754fb472a8a8">file_select_all_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l00371"></a>00371 {
<a name="l00372"></a>00372     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00373"></a>00373     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00374"></a>00374     <a class="code" href="../../d7/dc3/structFileSelection.html">FileSelection</a> sel;
<a name="l00375"></a>00375     <span class="keywordtype">int</span> numfiles = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>);
<a name="l00376"></a>00376     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00377"></a>00377     <span class="keywordtype">int</span> is_selected = 0;
<a name="l00378"></a>00378 
<a name="l00379"></a>00379     sel.<a class="code" href="../../d7/dc3/structFileSelection.html#a9b7ab5c3bbf2e667f2bc3ece75c4b035">first</a> = 0; 
<a name="l00380"></a>00380     sel.<a class="code" href="../../d7/dc3/structFileSelection.html#ac9df51dcbed0cbe710fc6399ebe7e036">last</a> = numfiles-1;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="comment">/* Is any file selected ? */</span>
<a name="l00383"></a>00383     <span class="keywordflow">for</span> ( i=0; i &lt; numfiles; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {
<a name="l00384"></a>00384         <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a3fa7021bb02a2bdf36db713c1c8c424e">filelist_is_selected</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, i, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>)) {
<a name="l00385"></a>00385             is_selected = 1;
<a name="l00386"></a>00386             <span class="keywordflow">break</span>;
<a name="l00387"></a>00387         }
<a name="l00388"></a>00388     }
<a name="l00389"></a>00389     <span class="comment">/* select all only if previously no file was selected */</span>
<a name="l00390"></a>00390     <span class="keywordflow">if</span> (is_selected) {
<a name="l00391"></a>00391         <a class="code" href="../../db/d74/filelist_8c.html#a8fe34149dcac0eb80d981ce7a81a89b9">filelist_select</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, &amp;sel, <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1fa23468b3691b18807a535d78687523992">FILE_SEL_REMOVE</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a0b4d7f067dfb4a502fca2a35b0033126">SELECTED_FILE</a>, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>);
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393     <span class="keywordflow">else</span> {
<a name="l00394"></a>00394         <span class="keyword">const</span> <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1">FileCheckType</a> check_type= (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a3c6acc46c9f74e155a16521aa43e446d">flag</a> &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#abb65306ddc283c3df800be6ebe99c25d">FILE_DIRSEL_ONLY</a>) ? <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a15316ab090e454e90c0a578fff60a1b9">CHECK_DIRS</a> : <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a0146c97a8557a33b872d93313c4e2507">CHECK_FILES</a>;
<a name="l00395"></a>00395         <a class="code" href="../../db/d74/filelist_8c.html#a8fe34149dcac0eb80d981ce7a81a89b9">filelist_select</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, &amp;sel, <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1faa469b85fde04398148e8cc09f6cce1a1">FILE_SEL_ADD</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a0b4d7f067dfb4a502fca2a35b0033126">SELECTED_FILE</a>, check_type);
<a name="l00396"></a>00396     }
<a name="l00397"></a>00397     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l00398"></a>00398     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00399"></a>00399 }
<a name="l00400"></a>00400 
<a name="l00401"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a0106954830d29ec241342ce6a50b992f">00401</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a3946edde3564c41e661f9f5a7c1a0a4c">FILE_OT_select_all_toggle</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00402"></a>00402 {
<a name="l00403"></a>00403     <span class="comment">/* identifiers */</span>
<a name="l00404"></a>00404     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;(De)select All Files&quot;</span>;
<a name="l00405"></a>00405     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select or deselect all files&quot;</span>;
<a name="l00406"></a>00406     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_select_all_toggle&quot;</span>;
<a name="l00407"></a>00407     
<a name="l00408"></a>00408     <span class="comment">/* api callbacks */</span>
<a name="l00409"></a>00409     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a0dbadaebec0e49921920754fb472a8a8">file_select_all_exec</a>;
<a name="l00410"></a>00410     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="comment">/* rna */</span>
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     
<a name="l00415"></a>00415 }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="comment">/* ---------- BOOKMARKS ----------- */</span>
<a name="l00418"></a>00418 
<a name="l00419"></a><a class="code" href="../../da/d9e/file__ops_8c.html#af1f21cbf14d0d283e30d5bf2dc663efb">00419</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#af1f21cbf14d0d283e30d5bf2dc663efb">bookmark_select_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00420"></a>00420 {
<a name="l00421"></a>00421     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00422"></a>00422 
<a name="l00423"></a>00423     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;dir&quot;</span>)) {
<a name="l00424"></a>00424         <span class="keywordtype">char</span> entry[256];
<a name="l00425"></a>00425         <a class="code" href="../../d2/da8/structFileSelectParams.html">FileSelectParams</a>* params = sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427         <a class="code" href="../../d3/d10/rna__access_8c.html#a810e909d61281bbb2d9fe99f9f2219ab">RNA_string_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;dir&quot;</span>, entry);
<a name="l00428"></a>00428         <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, entry, <span class="keyword">sizeof</span>(params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>));
<a name="l00429"></a>00429         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a7fcb2651a621a0b5e761fbe2a6add270">BLI_cleanup_dir</a>(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name, params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00430"></a>00430         <a class="code" href="../../d4/d71/file__intern_8h.html#af7233b3e3a8c38045eb2fde332224c50">file_change_dir</a>(C, 1);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434     
<a name="l00435"></a>00435     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00436"></a>00436 }
<a name="l00437"></a>00437 
<a name="l00438"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a1980ed594d13999d839f3f61c7dfa402">00438</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ab6a943f343be4f425d40e51b5b0a46d3">FILE_OT_select_bookmark</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00439"></a>00439 {
<a name="l00440"></a>00440     <span class="comment">/* identifiers */</span>
<a name="l00441"></a>00441     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select Directory&quot;</span>;
<a name="l00442"></a>00442     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select a bookmarked directory&quot;</span>;
<a name="l00443"></a>00443     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_select_bookmark&quot;</span>;
<a name="l00444"></a>00444     
<a name="l00445"></a>00445     <span class="comment">/* api callbacks */</span>
<a name="l00446"></a>00446     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#af1f21cbf14d0d283e30d5bf2dc663efb">bookmark_select_exec</a>;
<a name="l00447"></a>00447     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449     <a class="code" href="../../dc/d7e/rna__define_8c.html#ac53a3ed18da454971065d5b4e4cb4d62">RNA_def_string</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;dir&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 256, <span class="stringliteral">&quot;Dir&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00450"></a>00450 }
<a name="l00451"></a>00451 
<a name="l00452"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a34d8f790c788644719959b6b164544e7">00452</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a34d8f790c788644719959b6b164544e7">bookmark_add_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l00453"></a>00453 {
<a name="l00454"></a>00454     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00455"></a>00455     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00456"></a>00456     <span class="keyword">struct </span><a class="code" href="../../df/d7e/structFSMenu.html">FSMenu</a>* fsmenu = <a class="code" href="../../df/da8/fsmenu_8c.html#aa3a762769e978cf5b35c3b8081bf5ded">fsmenu_get</a>();
<a name="l00457"></a>00457     <span class="keyword">struct </span><a class="code" href="../../d2/da8/structFileSelectParams.html">FileSelectParams</a>* params= <a class="code" href="../../db/db9/ED__fileselect_8h.html#a636b839dfef31f4a00e1116ab70e4d86">ED_fileselect_get_params</a>(sfile);
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="keywordflow">if</span> (params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[0] != <span class="charliteral">&#39;\0&#39;</span>) {
<a name="l00460"></a>00460         <span class="keywordtype">char</span> name[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l00461"></a>00461     
<a name="l00462"></a>00462         <a class="code" href="../../df/da8/fsmenu_8c.html#ab0aef75ff1e67c7fb1ea386084e692e6">fsmenu_insert_entry</a>(fsmenu, <a class="code" href="../../dd/dc1/fsmenu_8h.html#a2689309e007670f38268e4fcbf90c00ba49be788663377e9edba6db293a6b6ed6">FS_CATEGORY_BOOKMARKS</a>, params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, 0, 1);
<a name="l00463"></a>00463         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a6f32ac1a463a6322c25cb5c1615c4b1c">BLI_make_file_string</a>(<span class="stringliteral">&quot;/&quot;</span>, name, <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a2d45fdb5b2e7511c16f48f9064b2c82f">BLI_get_folder_create</a>(<a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a637136ebeb2c8676285a55bf13e8145a">BLENDER_USER_CONFIG</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a619d8c8e6ab58ecef0b5ee62b2a9de4a">BLENDER_BOOKMARK_FILE</a>);
<a name="l00464"></a>00464         <a class="code" href="../../df/da8/fsmenu_8c.html#a91c5cadae964408e1876e41669dc0c6b">fsmenu_write_file</a>(fsmenu, name);
<a name="l00465"></a>00465     }
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l00468"></a>00468     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a15393f8cec4e8e2469505fea90607053">00471</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a5f54b3540096d36ed4a022b5bb7ad25f">FILE_OT_bookmark_add</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00472"></a>00472 {
<a name="l00473"></a>00473     <span class="comment">/* identifiers */</span>
<a name="l00474"></a>00474     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Add Bookmark&quot;</span>;
<a name="l00475"></a>00475     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Add a bookmark for the selected/active directory&quot;</span>;
<a name="l00476"></a>00476     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_bookmark_add&quot;</span>;
<a name="l00477"></a>00477     
<a name="l00478"></a>00478     <span class="comment">/* api callbacks */</span>
<a name="l00479"></a>00479     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a34d8f790c788644719959b6b164544e7">bookmark_add_exec</a>;
<a name="l00480"></a>00480     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l00481"></a>00481 }
<a name="l00482"></a>00482 
<a name="l00483"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ae0a222355f5ab2cae558ca07c029bfae">00483</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#ae0a222355f5ab2cae558ca07c029bfae">bookmark_delete_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00484"></a>00484 {
<a name="l00485"></a>00485     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00486"></a>00486     <span class="keyword">struct </span><a class="code" href="../../df/d7e/structFSMenu.html">FSMenu</a>* fsmenu = <a class="code" href="../../df/da8/fsmenu_8c.html#aa3a762769e978cf5b35c3b8081bf5ded">fsmenu_get</a>();
<a name="l00487"></a>00487     <span class="keywordtype">int</span> nentries = <a class="code" href="../../df/da8/fsmenu_8c.html#ab2dd9acc5166c602e0abfd62fbe9a588">fsmenu_get_nentries</a>(fsmenu, <a class="code" href="../../dd/dc1/fsmenu_8h.html#a2689309e007670f38268e4fcbf90c00ba49be788663377e9edba6db293a6b6ed6">FS_CATEGORY_BOOKMARKS</a>);
<a name="l00488"></a>00488     
<a name="l00489"></a>00489     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;index&quot;</span>)) {
<a name="l00490"></a>00490         <span class="keywordtype">int</span> index = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;index&quot;</span>);
<a name="l00491"></a>00491         <span class="keywordflow">if</span> ( (index &gt;-1) &amp;&amp; (index &lt; nentries)) {
<a name="l00492"></a>00492             <span class="keywordtype">char</span> name[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l00493"></a>00493             
<a name="l00494"></a>00494             <a class="code" href="../../df/da8/fsmenu_8c.html#a2683f8181eedbc8657f8bd0c250ca3f0">fsmenu_remove_entry</a>(fsmenu, <a class="code" href="../../dd/dc1/fsmenu_8h.html#a2689309e007670f38268e4fcbf90c00ba49be788663377e9edba6db293a6b6ed6">FS_CATEGORY_BOOKMARKS</a>, index);
<a name="l00495"></a>00495             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a6f32ac1a463a6322c25cb5c1615c4b1c">BLI_make_file_string</a>(<span class="stringliteral">&quot;/&quot;</span>, name, <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a2d45fdb5b2e7511c16f48f9064b2c82f">BLI_get_folder_create</a>(<a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a637136ebeb2c8676285a55bf13e8145a">BLENDER_USER_CONFIG</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a619d8c8e6ab58ecef0b5ee62b2a9de4a">BLENDER_BOOKMARK_FILE</a>);
<a name="l00496"></a>00496             <a class="code" href="../../df/da8/fsmenu_8c.html#a91c5cadae964408e1876e41669dc0c6b">fsmenu_write_file</a>(fsmenu, name);
<a name="l00497"></a>00497             <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l00498"></a>00498         }
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00502"></a>00502 }
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a2c5ea4be9b0a93bfa1f98558c8c873a6">00504</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a52231aadcf5cec58070a68b7be6b1ef7">FILE_OT_delete_bookmark</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00505"></a>00505 {
<a name="l00506"></a>00506     <span class="comment">/* identifiers */</span>
<a name="l00507"></a>00507     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Delete Bookmark&quot;</span>;
<a name="l00508"></a>00508     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Delete selected bookmark&quot;</span>;
<a name="l00509"></a>00509     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_delete_bookmark&quot;</span>;
<a name="l00510"></a>00510     
<a name="l00511"></a>00511     <span class="comment">/* api callbacks */</span>
<a name="l00512"></a>00512     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#ae0a222355f5ab2cae558ca07c029bfae">bookmark_delete_exec</a>;
<a name="l00513"></a>00513     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l00514"></a>00514 
<a name="l00515"></a>00515     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;index&quot;</span>, -1, -1, 20000, <span class="stringliteral">&quot;Index&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, -1, 20000);
<a name="l00516"></a>00516 }
<a name="l00517"></a>00517 
<a name="l00518"></a><a class="code" href="../../da/d9e/file__ops_8c.html#afd0128ce7afe831cc7e7c1e00af34f30">00518</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#afd5bc352bb823898f52bf5d1ca1db8bc">file_hilight_set</a>(<a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <span class="keywordtype">int</span> mx, <span class="keywordtype">int</span> my)
<a name="l00519"></a>00519 {
<a name="l00520"></a>00520     <a class="code" href="../../d7/de3/structView2D.html">View2D</a>* v2d = &amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>;
<a name="l00521"></a>00521     <a class="code" href="../../d2/da8/structFileSelectParams.html">FileSelectParams</a>* params;
<a name="l00522"></a>00522     <span class="keywordtype">int</span> numfiles, origfile; 
<a name="l00523"></a>00523 
<a name="l00524"></a>00524     <span class="keywordflow">if</span> (sfile==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     numfiles = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>);
<a name="l00527"></a>00527     params = <a class="code" href="../../db/db9/ED__fileselect_8h.html#a636b839dfef31f4a00e1116ab70e4d86">ED_fileselect_get_params</a>(sfile);
<a name="l00528"></a>00528 
<a name="l00529"></a>00529     origfile= params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a>;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     mx -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>;
<a name="l00532"></a>00532     my -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>;
<a name="l00533"></a>00533 
<a name="l00534"></a>00534     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d44/BLI__rect_8h.html#a1242dd13fb888a0146765107474fffb4">BLI_in_rcti</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>.<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>, mx, my)) {
<a name="l00535"></a>00535         <span class="keywordtype">float</span> fx, fy;
<a name="l00536"></a>00536         <span class="keywordtype">int</span> active_file;
<a name="l00537"></a>00537 
<a name="l00538"></a>00538         <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, mx, my, &amp;fx, &amp;fy);
<a name="l00539"></a>00539 
<a name="l00540"></a>00540         active_file = <a class="code" href="../../db/db9/ED__fileselect_8h.html#a4a34cb8659649ccdd3b73aca69b0aed1">ED_fileselect_layout_offset</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>, (<span class="keywordtype">int</span>)(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> + fx), (<span class="keywordtype">int</span>)(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - fy));
<a name="l00541"></a>00541 
<a name="l00542"></a>00542         <span class="keywordflow">if</span> ((active_file &gt;= 0) &amp;&amp; (active_file &lt; numfiles))
<a name="l00543"></a>00543             params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a>=active_file;
<a name="l00544"></a>00544         <span class="keywordflow">else</span>
<a name="l00545"></a>00545             params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a>= -1;
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547     <span class="keywordflow">else</span>
<a name="l00548"></a>00548         params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a>= -1;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550     <span class="keywordflow">return</span> (params-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a> != origfile);
<a name="l00551"></a>00551 }
<a name="l00552"></a>00552 
<a name="l00553"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a170d5f98e6d6462cd4aaaa0762b32f3d">00553</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a170d5f98e6d6462cd4aaaa0762b32f3d">file_highlight_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op), <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00554"></a>00554 {
<a name="l00555"></a>00555     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00556"></a>00556     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00557"></a>00557 
<a name="l00558"></a>00558     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d71/file__intern_8h.html#afd5bc352bb823898f52bf5d1ca1db8bc">file_hilight_set</a>(sfile, ar, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>))
<a name="l00559"></a>00559         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00560"></a>00560 
<a name="l00561"></a>00561     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l00562"></a>00562     
<a name="l00563"></a>00563     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00564"></a>00564 }
<a name="l00565"></a>00565 
<a name="l00566"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a47b0833d7a0d2020c76f95e407fdd179">00566</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a47b0833d7a0d2020c76f95e407fdd179">FILE_OT_highlight</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00567"></a>00567 {
<a name="l00568"></a>00568     <span class="comment">/* identifiers */</span>
<a name="l00569"></a>00569     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Highlight File&quot;</span>;
<a name="l00570"></a>00570     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Highlight selected file(s)&quot;</span>;
<a name="l00571"></a>00571     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_highlight&quot;</span>;
<a name="l00572"></a>00572     
<a name="l00573"></a>00573     <span class="comment">/* api callbacks */</span>
<a name="l00574"></a>00574     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a170d5f98e6d6462cd4aaaa0762b32f3d">file_highlight_invoke</a>;
<a name="l00575"></a>00575     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l00576"></a>00576 }
<a name="l00577"></a>00577 
<a name="l00578"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ad456029277b55710ab61b88a970ff4d6">00578</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ab685cd81ffb45fe2e09be5c153eed60c">file_cancel_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l00579"></a>00579 {
<a name="l00580"></a>00580     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00581"></a>00581     <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op = sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>;
<a name="l00582"></a>00582     
<a name="l00583"></a>00583     sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00584"></a>00584 
<a name="l00585"></a>00585     <a class="code" href="../../df/db0/wm__event__system_8c.html#af2c841ce7d02145a9cf4af19d2e46cce">WM_event_fileselect_event</a>(C, op, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a8c272fc867c9ef3db753b6964363e788">EVT_FILESELECT_CANCEL</a>);
<a name="l00586"></a>00586     
<a name="l00587"></a>00587     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a7602a7a9ae429b68b68604b105b777c6">00590</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a7602a7a9ae429b68b68604b105b777c6">file_operator_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l00591"></a>00591 {
<a name="l00592"></a>00592     <span class="keywordtype">int</span> poll = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>(C);
<a name="l00593"></a>00593     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00594"></a>00594 
<a name="l00595"></a>00595     <span class="keywordflow">if</span> (!sfile || !sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>) poll= 0;
<a name="l00596"></a>00596 
<a name="l00597"></a>00597     <span class="keywordflow">return</span> poll;
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00600"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a3891fd6ae03fac62fa8269524959760b">00600</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a3891fd6ae03fac62fa8269524959760b">FILE_OT_cancel</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00601"></a>00601 {
<a name="l00602"></a>00602     <span class="comment">/* identifiers */</span>
<a name="l00603"></a>00603     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Cancel File Load&quot;</span>;
<a name="l00604"></a>00604     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Cancel loading of selected file&quot;</span>;
<a name="l00605"></a>00605     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_cancel&quot;</span>;
<a name="l00606"></a>00606     
<a name="l00607"></a>00607     <span class="comment">/* api callbacks */</span>
<a name="l00608"></a>00608     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#ab685cd81ffb45fe2e09be5c153eed60c">file_cancel_exec</a>;
<a name="l00609"></a>00609     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a7602a7a9ae429b68b68604b105b777c6">file_operator_poll</a>;
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 
<a name="l00613"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a6431ba7197e1fce8df5aa8791b76a235">00613</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a4b56d5d5e71a9bfd0fc3290d2243b198">file_sfile_to_operator</a>(<a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile, <span class="keywordtype">char</span> *filepath)
<a name="l00614"></a>00614 {
<a name="l00615"></a>00615     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#af06511817c824c772ec102e6b23a3207">BLI_join_dirfile</a>(filepath, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>); <span class="comment">/* XXX, not real length */</span>
<a name="l00616"></a>00616     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;relative_path&quot;</span>)) {
<a name="l00617"></a>00617         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;relative_path&quot;</span>)) {
<a name="l00618"></a>00618             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a885e6044163b103a6c8e811d17286bb6">BLI_path_rel</a>(filepath, <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name);
<a name="l00619"></a>00619         }
<a name="l00620"></a>00620     }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filename&quot;</span>)) {
<a name="l00623"></a>00623         <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filename&quot;</span>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>);
<a name="l00624"></a>00624     }
<a name="l00625"></a>00625     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;directory&quot;</span>)) {
<a name="l00626"></a>00626         <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;directory&quot;</span>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filepath&quot;</span>)) {
<a name="l00629"></a>00629         <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filepath&quot;</span>, filepath);
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631     
<a name="l00632"></a>00632     <span class="comment">/* some ops have multiple files to select */</span>
<a name="l00633"></a>00633     <span class="comment">/* this is called on operators check() so clear collections first since</span>
<a name="l00634"></a>00634 <span class="comment">     * they may be already set. */</span>
<a name="l00635"></a>00635     {
<a name="l00636"></a>00636         <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> itemptr;
<a name="l00637"></a>00637         <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop_files= <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;files&quot;</span>);
<a name="l00638"></a>00638         <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop_dirs= <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;dirs&quot;</span>);
<a name="l00639"></a>00639         <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, numfiles = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>);
<a name="l00640"></a>00640 
<a name="l00641"></a>00641         <span class="keywordflow">if</span> (prop_files) {
<a name="l00642"></a>00642             <a class="code" href="../../d3/d10/rna__access_8c.html#ad0a799f6d6cfab002d3c7fe2fd188088">RNA_property_collection_clear</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, prop_files);
<a name="l00643"></a>00643             <span class="keywordflow">for</span> (i=0; i&lt;numfiles; i++) {
<a name="l00644"></a>00644                 <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a3fa7021bb02a2bdf36db713c1c8c424e">filelist_is_selected</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, i, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a0146c97a8557a33b872d93313c4e2507">CHECK_FILES</a>)) {
<a name="l00645"></a>00645                     <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *file= <a class="code" href="../../db/d74/filelist_8c.html#ae39663828b3dcd7ba509fdfa88051c42">filelist_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, i);
<a name="l00646"></a>00646                     <a class="code" href="../../d3/d10/rna__access_8c.html#aab8b3b9833568a452d4052f3f66288bb">RNA_property_collection_add</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, prop_files, &amp;itemptr);
<a name="l00647"></a>00647                     <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(&amp;itemptr, <span class="stringliteral">&quot;name&quot;</span>, file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>);
<a name="l00648"></a>00648                 }
<a name="l00649"></a>00649             }
<a name="l00650"></a>00650         }
<a name="l00651"></a>00651 
<a name="l00652"></a>00652         <span class="keywordflow">if</span> (prop_dirs) {
<a name="l00653"></a>00653             <a class="code" href="../../d3/d10/rna__access_8c.html#ad0a799f6d6cfab002d3c7fe2fd188088">RNA_property_collection_clear</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, prop_dirs);
<a name="l00654"></a>00654             <span class="keywordflow">for</span> (i=0; i&lt;numfiles; i++) {
<a name="l00655"></a>00655                 <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a3fa7021bb02a2bdf36db713c1c8c424e">filelist_is_selected</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, i, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a15316ab090e454e90c0a578fff60a1b9">CHECK_DIRS</a>)) {
<a name="l00656"></a>00656                     <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *file= <a class="code" href="../../db/d74/filelist_8c.html#ae39663828b3dcd7ba509fdfa88051c42">filelist_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, i);
<a name="l00657"></a>00657                     <a class="code" href="../../d3/d10/rna__access_8c.html#aab8b3b9833568a452d4052f3f66288bb">RNA_property_collection_add</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, prop_dirs, &amp;itemptr);
<a name="l00658"></a>00658                     <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(&amp;itemptr, <span class="stringliteral">&quot;name&quot;</span>, file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>);
<a name="l00659"></a>00659                 }
<a name="l00660"></a>00660             }
<a name="l00661"></a>00661         }
<a name="l00662"></a>00662 
<a name="l00663"></a>00663 
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665 }
<a name="l00666"></a>00666 
<a name="l00667"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a23abd58d3c975d1fae545c5983304761">00667</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a35ad270b4b93517f9717aee190bc0a31">file_operator_to_sfile</a>(<a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00668"></a>00668 {
<a name="l00669"></a>00669     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00670"></a>00670 
<a name="l00671"></a>00671     <span class="comment">/* If neither of the above are set, split the filepath back */</span>
<a name="l00672"></a>00672     <span class="keywordflow">if</span> ((prop= <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filepath&quot;</span>))) {
<a name="l00673"></a>00673         <span class="keywordtype">char</span> filepath[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l00674"></a>00674         <a class="code" href="../../d3/d10/rna__access_8c.html#a8cce1c1663f01ef0d74eb346bc9d445f">RNA_property_string_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, prop, filepath);
<a name="l00675"></a>00675         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#ae9bf85f6bb0df0bb8fcc352e870e32b8">BLI_split_dirfile</a>(filepath, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>, <span class="keyword">sizeof</span>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>), <span class="keyword">sizeof</span>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>));
<a name="l00676"></a>00676     }
<a name="l00677"></a>00677     <span class="keywordflow">else</span> {
<a name="l00678"></a>00678         <span class="keywordflow">if</span> ((prop= <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filename&quot;</span>))) {
<a name="l00679"></a>00679             <a class="code" href="../../d3/d10/rna__access_8c.html#a8cce1c1663f01ef0d74eb346bc9d445f">RNA_property_string_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, prop, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>);
<a name="l00680"></a>00680         }
<a name="l00681"></a>00681         <span class="keywordflow">if</span> ((prop= <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;directory&quot;</span>))) {
<a name="l00682"></a>00682             <a class="code" href="../../d3/d10/rna__access_8c.html#a8cce1c1663f01ef0d74eb346bc9d445f">RNA_property_string_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, prop, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00683"></a>00683         }
<a name="l00684"></a>00684     }
<a name="l00685"></a>00685     
<a name="l00686"></a>00686     <span class="comment">/* we could check for relative_path property which is used when converting</span>
<a name="l00687"></a>00687 <span class="comment">     * in the other direction but doesnt hurt to do this every time */</span>
<a name="l00688"></a>00688     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a779fd31715eb05e3322500e3426b03a2">BLI_path_abs</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name);
<a name="l00689"></a>00689 
<a name="l00690"></a>00690     <span class="comment">/* XXX, files and dirs updates missing, not really so important though */</span>
<a name="l00691"></a>00691 }
<a name="l00692"></a>00692 
<a name="l00693"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a97956a132837700430f6d887dac90733">00693</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ad90dbf875c519a204b3ee4413b5a92b7">file_draw_check_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg1), <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg2))
<a name="l00694"></a>00694 {
<a name="l00695"></a>00695     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00696"></a>00696     <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op= sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>;
<a name="l00697"></a>00697     <span class="keywordflow">if</span> (op) { <span class="comment">/* fail on reload */</span>
<a name="l00698"></a>00698         <span class="keywordflow">if</span> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a75c88e62b43b663e9a0cf6cfbede007c">type</a>-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a6f75ff0089a22e585a90313decbda6cb">check</a>) {
<a name="l00699"></a>00699             <span class="keywordtype">char</span> filepath[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l00700"></a>00700             <a class="code" href="../../d4/d71/file__intern_8h.html#a4b56d5d5e71a9bfd0fc3290d2243b198">file_sfile_to_operator</a>(op, sfile, filepath);
<a name="l00701"></a>00701             
<a name="l00702"></a>00702             <span class="comment">/* redraw */</span>
<a name="l00703"></a>00703             <span class="keywordflow">if</span> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a75c88e62b43b663e9a0cf6cfbede007c">type</a>-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a6f75ff0089a22e585a90313decbda6cb">check</a>(C, op)) {
<a name="l00704"></a>00704                 <a class="code" href="../../d4/d71/file__intern_8h.html#a35ad270b4b93517f9717aee190bc0a31">file_operator_to_sfile</a>(sfile, op);
<a name="l00705"></a>00705     
<a name="l00706"></a>00706                 <span class="comment">/* redraw, else the changed settings wont get updated */</span>
<a name="l00707"></a>00707                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l00708"></a>00708             }
<a name="l00709"></a>00709         }
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a><a class="code" href="../../da/d9e/file__ops_8c.html#af960b0be6d00d204aceb9657eb2dae43">00713</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#af960b0be6d00d204aceb9657eb2dae43">file_draw_check_exists</a>(<a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile)
<a name="l00714"></a>00714 {
<a name="l00715"></a>00715     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>) { <span class="comment">/* fails on reload */</span>
<a name="l00716"></a>00716         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;check_existing&quot;</span>)) {
<a name="l00717"></a>00717             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;check_existing&quot;</span>)) {
<a name="l00718"></a>00718                 <span class="keywordtype">char</span> filepath[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l00719"></a>00719                 <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#af06511817c824c772ec102e6b23a3207">BLI_join_dirfile</a>(filepath, <span class="keyword">sizeof</span>(filepath), sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>);
<a name="l00720"></a>00720                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d63/BLI__fileops_8h.html#abb32d6d105b2c7c8466b42e394422f1d">BLI_is_file</a>(filepath)) {
<a name="l00721"></a>00721                     <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00722"></a>00722                 }
<a name="l00723"></a>00723             }
<a name="l00724"></a>00724         }
<a name="l00725"></a>00725     }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727     <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00728"></a>00728 }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 <span class="comment">/* sends events now, so things get handled on windowqueue level */</span>
<a name="l00731"></a><a class="code" href="../../da/d9e/file__ops_8c.html#abf4a428cda1c0a41180766246cd05db9">00731</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a3fb922f9d83caf8db554a260ece0867b">file_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *exec_op)
<a name="l00732"></a>00732 {
<a name="l00733"></a>00733     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00734"></a>00734     <span class="keywordtype">char</span> filepath[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l00735"></a>00735     
<a name="l00736"></a>00736     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>) {
<a name="l00737"></a>00737         <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op= sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a>;
<a name="l00738"></a>00738     
<a name="l00739"></a>00739         <span class="comment">/* when used as a macro, for doubleclick, </span>
<a name="l00740"></a>00740 <span class="comment">         * to prevent closing when doubleclicking on .. item */</span>
<a name="l00741"></a>00741         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(exec_op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;need_active&quot;</span>)) {
<a name="l00742"></a>00742             <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, active=0;
<a name="l00743"></a>00743             
<a name="l00744"></a>00744             <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>); i++) {
<a name="l00745"></a>00745                 <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a3fa7021bb02a2bdf36db713c1c8c424e">filelist_is_selected</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, i, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>)) {
<a name="l00746"></a>00746                     active=1;
<a name="l00747"></a>00747                     <span class="keywordflow">break</span>;
<a name="l00748"></a>00748                 }
<a name="l00749"></a>00749             }
<a name="l00750"></a>00750             <span class="keywordflow">if</span> (active == 0)
<a name="l00751"></a>00751                 <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00752"></a>00752         }
<a name="l00753"></a>00753         
<a name="l00754"></a>00754         sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a5ef6059fa41acf4330598c19a62918ff">op</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00755"></a>00755 
<a name="l00756"></a>00756         <a class="code" href="../../d4/d71/file__intern_8h.html#a4b56d5d5e71a9bfd0fc3290d2243b198">file_sfile_to_operator</a>(op, sfile, filepath);
<a name="l00757"></a>00757 
<a name="l00758"></a>00758         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d63/BLI__fileops_8h.html#a0bf59749f87b0f283c37e27e72029591">BLI_exists</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>))
<a name="l00759"></a>00759             <a class="code" href="../../df/da8/fsmenu_8c.html#ab0aef75ff1e67c7fb1ea386084e692e6">fsmenu_insert_entry</a>(<a class="code" href="../../df/da8/fsmenu_8c.html#aa3a762769e978cf5b35c3b8081bf5ded">fsmenu_get</a>(), <a class="code" href="../../dd/dc1/fsmenu_8h.html#a2689309e007670f38268e4fcbf90c00ba1cf34addcde5144ddeebea4061f91517">FS_CATEGORY_RECENT</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, 0, 1);
<a name="l00760"></a>00760 
<a name="l00761"></a>00761         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a6f32ac1a463a6322c25cb5c1615c4b1c">BLI_make_file_string</a>(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name, filepath, <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a2d45fdb5b2e7511c16f48f9064b2c82f">BLI_get_folder_create</a>(<a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a637136ebeb2c8676285a55bf13e8145a">BLENDER_USER_CONFIG</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a619d8c8e6ab58ecef0b5ee62b2a9de4a">BLENDER_BOOKMARK_FILE</a>);
<a name="l00762"></a>00762         <a class="code" href="../../df/da8/fsmenu_8c.html#a91c5cadae964408e1876e41669dc0c6b">fsmenu_write_file</a>(<a class="code" href="../../df/da8/fsmenu_8c.html#aa3a762769e978cf5b35c3b8081bf5ded">fsmenu_get</a>(), filepath);
<a name="l00763"></a>00763         <a class="code" href="../../df/db0/wm__event__system_8c.html#af2c841ce7d02145a9cf4af19d2e46cce">WM_event_fileselect_event</a>(C, op, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab86275c636dc8e3b3aeb94494d3293c1">EVT_FILESELECT_EXEC</a>);
<a name="l00764"></a>00764 
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766                 
<a name="l00767"></a>00767     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00768"></a>00768 }
<a name="l00769"></a>00769 
<a name="l00770"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a9ef1b5bc49a5fa147ed3628c87087a64">00770</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a9ef1b5bc49a5fa147ed3628c87087a64">FILE_OT_execute</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00771"></a>00771 {
<a name="l00772"></a>00772     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00773"></a>00773 
<a name="l00774"></a>00774     <span class="comment">/* identifiers */</span>
<a name="l00775"></a>00775     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Execute File Window&quot;</span>;
<a name="l00776"></a>00776     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Execute selected file&quot;</span>;
<a name="l00777"></a>00777     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_execute&quot;</span>;
<a name="l00778"></a>00778     
<a name="l00779"></a>00779     <span class="comment">/* api callbacks */</span>
<a name="l00780"></a>00780     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#a3fb922f9d83caf8db554a260ece0867b">file_exec</a>;
<a name="l00781"></a>00781     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a7602a7a9ae429b68b68604b105b777c6">file_operator_poll</a>; 
<a name="l00782"></a>00782     
<a name="l00783"></a>00783     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;need_active&quot;</span>, 0, <span class="stringliteral">&quot;Need Active&quot;</span>,
<a name="l00784"></a>00784                            <span class="stringliteral">&quot;Only execute if there&#39;s an active selected file in the file list&quot;</span>);
<a name="l00785"></a>00785     <a class="code" href="../../dc/d7e/rna__define_8c.html#a97e75cad8daa0d94523c8df118947191">RNA_def_property_flag</a>(prop, <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ac49bd36c069e337f7ee269c672ef1332">PROP_SKIP_SAVE</a>);
<a name="l00786"></a>00786 }
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 
<a name="l00789"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a1983fe6938dd2466ff5a62c2d4a3b81b">00789</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#abde531a54e30b8a88300ff4e64db3d6a">file_parent_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l00790"></a>00790 {
<a name="l00791"></a>00791     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00792"></a>00792     
<a name="l00793"></a>00793     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l00794"></a>00794         <span class="keywordflow">if</span> (<a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a2bd669ec2a93ce9b453b83a179b8002c">BLI_has_parent</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>)) {
<a name="l00795"></a>00795             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a286d1c9a8dd8e3d947274afa9c4fba9e">BLI_parent_dir</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00796"></a>00796             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a7fcb2651a621a0b5e761fbe2a6add270">BLI_cleanup_dir</a>(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00797"></a>00797             <a class="code" href="../../d4/d71/file__intern_8h.html#af7233b3e3a8c38045eb2fde332224c50">file_change_dir</a>(C, 0);
<a name="l00798"></a>00798             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00799"></a>00799         }
<a name="l00800"></a>00800     }       
<a name="l00801"></a>00801     
<a name="l00802"></a>00802     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00803"></a>00803 
<a name="l00804"></a>00804 }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 
<a name="l00807"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a594c86c91b81e861d2e829f92b64c1a6">00807</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a594c86c91b81e861d2e829f92b64c1a6">FILE_OT_parent</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00808"></a>00808 {
<a name="l00809"></a>00809     <span class="comment">/* identifiers */</span>
<a name="l00810"></a>00810     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Parent File&quot;</span>;
<a name="l00811"></a>00811     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Move to parent directory&quot;</span>;
<a name="l00812"></a>00812     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_parent&quot;</span>;
<a name="l00813"></a>00813     
<a name="l00814"></a>00814     <span class="comment">/* api callbacks */</span>
<a name="l00815"></a>00815     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#abde531a54e30b8a88300ff4e64db3d6a">file_parent_exec</a>;
<a name="l00816"></a>00816     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l00817"></a>00817 }
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 
<a name="l00820"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a76bcfe1a20787ddbf60bee9e3d7d1a5f">00820</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a76bcfe1a20787ddbf60bee9e3d7d1a5f">file_refresh_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l00821"></a>00821 {
<a name="l00822"></a>00822     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     <a class="code" href="../../db/db9/ED__fileselect_8h.html#ae37aa4cdf13334767e899cc2a97dc737">ED_fileselect_clear</a>(C, sfile);
<a name="l00825"></a>00825 
<a name="l00826"></a>00826     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00827"></a>00827 
<a name="l00828"></a>00828     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 }
<a name="l00831"></a>00831 
<a name="l00832"></a><a class="code" href="../../da/d9e/file__ops_8c.html#af1987aa66cddc68d1806fc65bf92977c">00832</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#af1987aa66cddc68d1806fc65bf92977c">FILE_OT_previous</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00833"></a>00833 {
<a name="l00834"></a>00834     <span class="comment">/* identifiers */</span>
<a name="l00835"></a>00835     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Previous Folder&quot;</span>;
<a name="l00836"></a>00836     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Move to previous folder&quot;</span>;
<a name="l00837"></a>00837     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_previous&quot;</span>;
<a name="l00838"></a>00838     
<a name="l00839"></a>00839     <span class="comment">/* api callbacks */</span>
<a name="l00840"></a>00840     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#a28c83aac47beb91ca629553b2899967c">file_previous_exec</a>;
<a name="l00841"></a>00841     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l00842"></a>00842 }
<a name="l00843"></a>00843 
<a name="l00844"></a><a class="code" href="../../da/d9e/file__ops_8c.html#af27c9ccb444ea16cd3b33759ce35a263">00844</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a28c83aac47beb91ca629553b2899967c">file_previous_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l00845"></a>00845 {
<a name="l00846"></a>00846     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00847"></a>00847 
<a name="l00848"></a>00848     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l00849"></a>00849         <span class="keywordflow">if</span> (!sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ab587cdc4261210c9aeeaed40711de0ca">folders_next</a>)
<a name="l00850"></a>00850             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ab587cdc4261210c9aeeaed40711de0ca">folders_next</a> = <a class="code" href="../../db/d74/filelist_8c.html#a41f65b4b84135266cde16e89b72802d7">folderlist_new</a>();
<a name="l00851"></a>00851 
<a name="l00852"></a>00852         <a class="code" href="../../db/d74/filelist_8c.html#a6b368723b28a676eb995ee0848b2baa3">folderlist_pushdir</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ab587cdc4261210c9aeeaed40711de0ca">folders_next</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00853"></a>00853         <a class="code" href="../../db/d74/filelist_8c.html#a5cd87dc3b23c659dbbf0f48b1054490d">folderlist_popdir</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a65746145559024992c7406612cef9b6f">folders_prev</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00854"></a>00854         <a class="code" href="../../db/d74/filelist_8c.html#a6b368723b28a676eb995ee0848b2baa3">folderlist_pushdir</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ab587cdc4261210c9aeeaed40711de0ca">folders_next</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00855"></a>00855 
<a name="l00856"></a>00856         <a class="code" href="../../d4/d71/file__intern_8h.html#af7233b3e3a8c38045eb2fde332224c50">file_change_dir</a>(C, 1);
<a name="l00857"></a>00857     }
<a name="l00858"></a>00858     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00859"></a>00859 
<a name="l00860"></a>00860     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00861"></a>00861 }
<a name="l00862"></a>00862 
<a name="l00863"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ada7930f6a44082d915c98693a383824d">00863</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ada7930f6a44082d915c98693a383824d">FILE_OT_next</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00864"></a>00864 {
<a name="l00865"></a>00865     <span class="comment">/* identifiers */</span>
<a name="l00866"></a>00866     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Next Folder&quot;</span>;
<a name="l00867"></a>00867     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Move to next folder&quot;</span>;
<a name="l00868"></a>00868     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_next&quot;</span>;
<a name="l00869"></a>00869     
<a name="l00870"></a>00870     <span class="comment">/* api callbacks */</span>
<a name="l00871"></a>00871     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#a7743779b64108fb0d9c7d2102e39de42">file_next_exec</a>;
<a name="l00872"></a>00872     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l00873"></a>00873 }
<a name="l00874"></a>00874 
<a name="l00875"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a2fb97fe258f7dd79c9c91fdb7b551a0b">00875</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a7743779b64108fb0d9c7d2102e39de42">file_next_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l00876"></a>00876 {
<a name="l00877"></a>00877     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00878"></a>00878     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l00879"></a>00879         <span class="keywordflow">if</span> (!sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ab587cdc4261210c9aeeaed40711de0ca">folders_next</a>)
<a name="l00880"></a>00880             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ab587cdc4261210c9aeeaed40711de0ca">folders_next</a> = <a class="code" href="../../db/d74/filelist_8c.html#a41f65b4b84135266cde16e89b72802d7">folderlist_new</a>();
<a name="l00881"></a>00881 
<a name="l00882"></a>00882         <a class="code" href="../../db/d74/filelist_8c.html#a6b368723b28a676eb995ee0848b2baa3">folderlist_pushdir</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a65746145559024992c7406612cef9b6f">folders_prev</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00883"></a>00883         <a class="code" href="../../db/d74/filelist_8c.html#a5cd87dc3b23c659dbbf0f48b1054490d">folderlist_popdir</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ab587cdc4261210c9aeeaed40711de0ca">folders_next</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00884"></a>00884 
<a name="l00885"></a>00885         <span class="comment">// update folders_prev so we can check for it in folderlist_clear_next()</span>
<a name="l00886"></a>00886         <a class="code" href="../../db/d74/filelist_8c.html#a6b368723b28a676eb995ee0848b2baa3">folderlist_pushdir</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a65746145559024992c7406612cef9b6f">folders_prev</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l00887"></a>00887 
<a name="l00888"></a>00888         <a class="code" href="../../d4/d71/file__intern_8h.html#af7233b3e3a8c38045eb2fde332224c50">file_change_dir</a>(C, 1);
<a name="l00889"></a>00889     }       
<a name="l00890"></a>00890     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00891"></a>00891 
<a name="l00892"></a>00892     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00893"></a>00893 }
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 
<a name="l00896"></a>00896 <span class="comment">/* only meant for timer usage */</span>
<a name="l00897"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a50b8de29ef5483e20f377efc718800b6">00897</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a50b8de29ef5483e20f377efc718800b6">file_smoothscroll_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op), <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00898"></a>00898 {
<a name="l00899"></a>00899     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00900"></a>00900     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l00901"></a>00901     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, *oldar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00902"></a>00902     <span class="keywordtype">int</span> offset;
<a name="l00903"></a>00903     <span class="keywordtype">int</span> numfiles, numfiles_layout;
<a name="l00904"></a>00904     <span class="keywordtype">int</span> edit_idx = 0;
<a name="l00905"></a>00905     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00906"></a>00906 
<a name="l00907"></a>00907     <span class="comment">/* escape if not our timer */</span>
<a name="l00908"></a>00908     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>!=event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#afe8f2bc4e7e67063e0e2a92b08056c17">customdata</a>)
<a name="l00909"></a>00909         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l00910"></a>00910     
<a name="l00911"></a>00911     numfiles = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>);
<a name="l00912"></a>00912 
<a name="l00913"></a>00913     <span class="comment">/* check if we are editing a name */</span>
<a name="l00914"></a>00914     <span class="keywordflow">for</span> (i=0; i &lt; numfiles; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00915"></a>00915     {
<a name="l00916"></a>00916         <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a3fa7021bb02a2bdf36db713c1c8c424e">filelist_is_selected</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, i, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>) ) {
<a name="l00917"></a>00917             edit_idx=<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00918"></a>00918             <span class="keywordflow">break</span>;
<a name="l00919"></a>00919         }
<a name="l00920"></a>00920     }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922     <span class="comment">/* if we are not editing, we are done */</span>
<a name="l00923"></a>00923     <span class="keywordflow">if</span> (0==edit_idx) {
<a name="l00924"></a>00924         <a class="code" href="../../d7/d6e/wm__window_8c.html#a1a9f31ba88dd1dd3982b3d8f02de2e75">WM_event_remove_timer</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C), sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>);
<a name="l00925"></a>00925         sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00926"></a>00926         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l00927"></a>00927     }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     <span class="comment">/* we need the correct area for scrolling */</span>
<a name="l00930"></a>00930     ar = <a class="code" href="../../d7/da3/BKE__screen_8h.html#a5094bc7dbca089e838bcd5fc9bcb52a7">BKE_area_find_region_type</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>);
<a name="l00931"></a>00931     <span class="keywordflow">if</span> (!ar || ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>) {
<a name="l00932"></a>00932         <a class="code" href="../../d7/d6e/wm__window_8c.html#a1a9f31ba88dd1dd3982b3d8f02de2e75">WM_event_remove_timer</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C), sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>);
<a name="l00933"></a>00933         sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00934"></a>00934         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936 
<a name="l00937"></a>00937     offset = <a class="code" href="../../db/db9/ED__fileselect_8h.html#a4a34cb8659649ccdd3b73aca69b0aed1">ED_fileselect_layout_offset</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>, (<span class="keywordtype">int</span>)ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>.<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, (<span class="keywordtype">int</span>)-ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>.<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>);
<a name="l00938"></a>00938     <span class="keywordflow">if</span> (offset&lt;0) offset=0;
<a name="l00939"></a>00939 
<a name="l00940"></a>00940     <span class="comment">/* scroll offset is the first file in the row/column we are editing in */</span>
<a name="l00941"></a>00941     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> == 0) {
<a name="l00942"></a>00942         <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a76d8deb13314b95b43894717286edc08">flag</a> &amp; <a class="code" href="../../db/db9/ED__fileselect_8h.html#a1b9596c09e6ec73077491ce4a1937d6c">FILE_LAYOUT_HOR</a>) {
<a name="l00943"></a>00943             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> = (edit_idx/sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a31049a5f194fd7218f24fdd60a0122cf">rows</a>)*sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a31049a5f194fd7218f24fdd60a0122cf">rows</a>;
<a name="l00944"></a>00944             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> &lt;= offset) sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> -= sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a31049a5f194fd7218f24fdd60a0122cf">rows</a>;
<a name="l00945"></a>00945         }
<a name="l00946"></a>00946         <span class="keywordflow">else</span> {
<a name="l00947"></a>00947             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> = (edit_idx/sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a40f489eef3bc868ec6a0e8825d5f40b0">columns</a>)*sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a40f489eef3bc868ec6a0e8825d5f40b0">columns</a>;
<a name="l00948"></a>00948             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> &lt;= offset) sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> -= sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a40f489eef3bc868ec6a0e8825d5f40b0">columns</a>;
<a name="l00949"></a>00949         }
<a name="l00950"></a>00950     }
<a name="l00951"></a>00951     
<a name="l00952"></a>00952     numfiles_layout = <a class="code" href="../../db/db9/ED__fileselect_8h.html#a0225506022a8da9ee303a026e8dbe3ee">ED_fileselect_layout_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>, ar);
<a name="l00953"></a>00953     
<a name="l00954"></a>00954     <span class="comment">/* check if we have reached our final scroll position */</span>
<a name="l00955"></a>00955     <span class="keywordflow">if</span> ( (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> &gt;= offset) &amp;&amp; (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> &lt; offset + numfiles_layout) ) {
<a name="l00956"></a>00956         <a class="code" href="../../d7/d6e/wm__window_8c.html#a1a9f31ba88dd1dd3982b3d8f02de2e75">WM_event_remove_timer</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C), sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>);
<a name="l00957"></a>00957         sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a>=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00958"></a>00958         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00959"></a>00959     }
<a name="l00960"></a>00960 
<a name="l00961"></a>00961     <span class="comment">/* temporarily set context to the main window region, </span>
<a name="l00962"></a>00962 <span class="comment">     * so the scroll operators work */</span>
<a name="l00963"></a>00963     <a class="code" href="../../df/d01/BKE__context_8h.html#a2406677d500d1744af5e9e56c210590b">CTX_wm_region_set</a>(C, ar);
<a name="l00964"></a>00964     
<a name="l00965"></a>00965     <span class="comment">/* scroll one step in the desired direction */</span>
<a name="l00966"></a>00966     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a> &lt; offset) {
<a name="l00967"></a>00967         <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a76d8deb13314b95b43894717286edc08">flag</a> &amp; <a class="code" href="../../db/db9/ED__fileselect_8h.html#a1b9596c09e6ec73077491ce4a1937d6c">FILE_LAYOUT_HOR</a>) {
<a name="l00968"></a>00968             <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;VIEW2D_OT_scroll_left&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00969"></a>00969         }
<a name="l00970"></a>00970         <span class="keywordflow">else</span> {
<a name="l00971"></a>00971             <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;VIEW2D_OT_scroll_up&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00972"></a>00972         }
<a name="l00973"></a>00973         
<a name="l00974"></a>00974     }
<a name="l00975"></a>00975     <span class="keywordflow">else</span> {
<a name="l00976"></a>00976         <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a352bfdf5731e7c1b16bb2303a6341eb7">layout</a>-&gt;<a class="code" href="../../d7/dd8/structFileLayout.html#a76d8deb13314b95b43894717286edc08">flag</a> &amp; <a class="code" href="../../db/db9/ED__fileselect_8h.html#a1b9596c09e6ec73077491ce4a1937d6c">FILE_LAYOUT_HOR</a>) {
<a name="l00977"></a>00977             <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;VIEW2D_OT_scroll_right&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00978"></a>00978         }
<a name="l00979"></a>00979         <span class="keywordflow">else</span> {
<a name="l00980"></a>00980             <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;VIEW2D_OT_scroll_down&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00981"></a>00981         }
<a name="l00982"></a>00982     }
<a name="l00983"></a>00983     
<a name="l00984"></a>00984     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C));
<a name="l00985"></a>00985     
<a name="l00986"></a>00986     <span class="comment">/* and restore context */</span>
<a name="l00987"></a>00987     <a class="code" href="../../df/d01/BKE__context_8h.html#a2406677d500d1744af5e9e56c210590b">CTX_wm_region_set</a>(C, oldar);
<a name="l00988"></a>00988     
<a name="l00989"></a>00989     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00990"></a>00990 }
<a name="l00991"></a>00991 
<a name="l00992"></a>00992 
<a name="l00993"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a7a3d19fb8fad32c8df4dc9d4caae69a1">00993</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#aeef31187d3fa84a88cbe68fcf11ceed4">FILE_OT_smoothscroll</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00994"></a>00994 {
<a name="l00995"></a>00995     
<a name="l00996"></a>00996     <span class="comment">/* identifiers */</span>
<a name="l00997"></a>00997     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Smooth Scroll&quot;</span>;
<a name="l00998"></a>00998     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_smoothscroll&quot;</span>;
<a name="l00999"></a>00999     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Smooth scroll to make editable file visible&quot;</span>;
<a name="l01000"></a>01000     
<a name="l01001"></a>01001     <span class="comment">/* api callbacks */</span>
<a name="l01002"></a>01002     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a50b8de29ef5483e20f377efc718800b6">file_smoothscroll_invoke</a>;
<a name="l01003"></a>01003     
<a name="l01004"></a>01004     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>;
<a name="l01005"></a>01005 }
<a name="l01006"></a>01006 
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 <span class="comment">/* create a new, non-existing folder name, returns 1 if successful, 0 if name couldn&#39;t be created.</span>
<a name="l01009"></a>01009 <span class="comment"> * The actual name is returned in &#39;name&#39;, &#39;folder&#39; contains the complete path, including the new folder name.</span>
<a name="l01010"></a>01010 <span class="comment"> */</span>
<a name="l01011"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a23182e50e3ea5d562878ee4a895f38fb">01011</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a23182e50e3ea5d562878ee4a895f38fb">new_folder_path</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* parent, <span class="keywordtype">char</span> *folder, <span class="keywordtype">char</span> *name)
<a name="l01012"></a>01012 {
<a name="l01013"></a>01013     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1;
<a name="l01014"></a>01014     <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = 0;
<a name="l01015"></a>01015 
<a name="l01016"></a>01016     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(name, <span class="stringliteral">&quot;New Folder&quot;</span>, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>);
<a name="l01017"></a>01017     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#af06511817c824c772ec102e6b23a3207">BLI_join_dirfile</a>(folder, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>, parent, name); <span class="comment">/* XXX, not real length */</span>
<a name="l01018"></a>01018     <span class="comment">/* check whether folder with the name already exists, in this case</span>
<a name="l01019"></a>01019 <span class="comment">     * add number to the name. Check length of generated name to avoid</span>
<a name="l01020"></a>01020 <span class="comment">     * crazy case of huge number of folders each named &#39;New Folder (x)&#39; */</span>
<a name="l01021"></a>01021     <span class="keywordflow">while</span> (<a class="code" href="../../d2/d63/BLI__fileops_8h.html#a0bf59749f87b0f283c37e27e72029591">BLI_exists</a>(folder) &amp;&amp; (len&lt;<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>)) {
<a name="l01022"></a>01022         len = <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(name, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>, <span class="stringliteral">&quot;New Folder(%d)&quot;</span>, i);
<a name="l01023"></a>01023         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#af06511817c824c772ec102e6b23a3207">BLI_join_dirfile</a>(folder, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>, parent, name); <span class="comment">/* XXX, not real length */</span>
<a name="l01024"></a>01024         i++;
<a name="l01025"></a>01025     }
<a name="l01026"></a>01026 
<a name="l01027"></a>01027     <span class="keywordflow">return</span> (len&lt;<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>);
<a name="l01028"></a>01028 }
<a name="l01029"></a>01029 
<a name="l01030"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a43e5b1c2a9d4451a80b44cb20004e2d8">01030</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ac4199dad5d70305f98ac4d75ea0132b7">file_directory_new_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01031"></a>01031 {
<a name="l01032"></a>01032     <span class="keywordtype">char</span> name[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>];
<a name="l01033"></a>01033     <span class="keywordtype">char</span> <a class="code" href="../../dc/d22/structdirentry.html#a2ccd343a82507dda47b7414f5b1b4ca3">path</a>[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l01034"></a>01034     <span class="keywordtype">int</span> generate_name= 1;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01037"></a>01037     
<a name="l01038"></a>01038     <span class="keywordflow">if</span> (!sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01039"></a>01039         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>,<a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;No parent directory given&quot;</span>);
<a name="l01040"></a>01040         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01041"></a>01041     }
<a name="l01042"></a>01042     
<a name="l01043"></a>01043     path[0] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;directory&quot;</span>)) {
<a name="l01046"></a>01046         <a class="code" href="../../d3/d10/rna__access_8c.html#a810e909d61281bbb2d9fe99f9f2219ab">RNA_string_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;directory&quot;</span>, path);
<a name="l01047"></a>01047         <span class="keywordflow">if</span> (path[0] != <span class="charliteral">&#39;\0&#39;</span>) generate_name= 0;
<a name="l01048"></a>01048     }
<a name="l01049"></a>01049 
<a name="l01050"></a>01050     <span class="keywordflow">if</span> (generate_name) {
<a name="l01051"></a>01051         <span class="comment">/* create a new, non-existing folder name */</span>
<a name="l01052"></a>01052         <span class="keywordflow">if</span> (!<a class="code" href="../../da/d9e/file__ops_8c.html#a23182e50e3ea5d562878ee4a895f38fb">new_folder_path</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, path, name)) {
<a name="l01053"></a>01053             <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>,<a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Couldn&#39;t create new folder name&quot;</span>);
<a name="l01054"></a>01054             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01055"></a>01055         }
<a name="l01056"></a>01056     }
<a name="l01057"></a>01057 
<a name="l01058"></a>01058     <span class="comment">/* create the file */</span>
<a name="l01059"></a>01059     <a class="code" href="../../d2/d63/BLI__fileops_8h.html#a44e7a7091e4cf3ecce692fdc4216657e">BLI_dir_create_recursive</a>(path);
<a name="l01060"></a>01060 
<a name="l01061"></a>01061     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d63/BLI__fileops_8h.html#a0bf59749f87b0f283c37e27e72029591">BLI_exists</a>(path)) {
<a name="l01062"></a>01062         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>,<a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Couldn&#39;t create new folder&quot;</span>);
<a name="l01063"></a>01063         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01064"></a>01064     } 
<a name="l01065"></a>01065 
<a name="l01066"></a>01066     <span class="comment">/* now remember file to jump into editing */</span>
<a name="l01067"></a>01067     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a120d6d9439620f1ea4b26c411f3700d4">renamefile</a>, name, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>);
<a name="l01068"></a>01068 
<a name="l01069"></a>01069     <span class="comment">/* set timer to smoothly view newly generated file */</span>
<a name="l01070"></a>01070     sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a17f9e46bb100d16319ecffd8593444f0">smoothscroll_timer</a> = <a class="code" href="../../d7/d6e/wm__window_8c.html#af5bdd7109c7ea81c77a89d9f41585f3a">WM_event_add_timer</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C), <a class="code" href="../../d1/d40/wm__event__types_8h.html#a63bf4f24c85f26e838f55701a5e69831">TIMER1</a>, 1.0/1000.0);    <span class="comment">/* max 30 frs/sec */</span>
<a name="l01071"></a>01071     sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#ae9e095973abfb612f0a4e46cf1b4eb91">scroll_offset</a>=0;
<a name="l01072"></a>01072 
<a name="l01073"></a>01073     <span class="comment">/* reload dir to make sure we&#39;re seeing what&#39;s in the directory */</span>
<a name="l01074"></a>01074     <a class="code" href="../../db/db9/ED__fileselect_8h.html#ae37aa4cdf13334767e899cc2a97dc737">ED_fileselect_clear</a>(C, sfile);
<a name="l01075"></a>01075     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01076"></a>01076 
<a name="l01077"></a>01077     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01078"></a>01078 }
<a name="l01079"></a>01079 
<a name="l01080"></a>01080 
<a name="l01081"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a4dd8573947439d60017a1f201beb40ee">01081</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a4dd8573947439d60017a1f201beb40ee">FILE_OT_directory_new</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01082"></a>01082 {
<a name="l01083"></a>01083     <span class="comment">/* identifiers */</span>
<a name="l01084"></a>01084     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Create New Directory&quot;</span>;
<a name="l01085"></a>01085     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Create a new directory&quot;</span>;
<a name="l01086"></a>01086     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_directory_new&quot;</span>;
<a name="l01087"></a>01087     
<a name="l01088"></a>01088     <span class="comment">/* api callbacks */</span>
<a name="l01089"></a>01089     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a63ac1372a9efaaca8bec8660ff770026">WM_operator_confirm</a>;
<a name="l01090"></a>01090     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#ac4199dad5d70305f98ac4d75ea0132b7">file_directory_new_exec</a>;
<a name="l01091"></a>01091     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l01092"></a>01092 
<a name="l01093"></a>01093     <a class="code" href="../../dc/d7e/rna__define_8c.html#aad7c3743d8b3586233f0d56363352988">RNA_def_string_dir_path</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;directory&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>, <span class="stringliteral">&quot;Directory&quot;</span>, <span class="stringliteral">&quot;Name of new directory&quot;</span>);
<a name="l01094"></a>01094 
<a name="l01095"></a>01095 }
<a name="l01096"></a>01096 
<a name="l01097"></a>01097 
<a name="l01098"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ac4d6fdd02f6a26b77b4f6b52279bfc29">01098</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d9e/file__ops_8c.html#ac4d6fdd02f6a26b77b4f6b52279bfc29">file_expand_directory</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l01099"></a>01099 {
<a name="l01100"></a>01100     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01101"></a>01101     
<a name="l01102"></a>01102     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01103"></a>01103         <span class="keywordflow">if</span> ( sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[0] == <span class="charliteral">&#39;~&#39;</span> ) {
<a name="l01104"></a>01104             <span class="keywordtype">char</span> tmpstr[<span class="keyword">sizeof</span>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>)-1];
<a name="l01105"></a>01105             <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(tmpstr, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>+1, <span class="keyword">sizeof</span>(tmpstr));
<a name="l01106"></a>01106             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#af06511817c824c772ec102e6b23a3207">BLI_join_dirfile</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, <span class="keyword">sizeof</span>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>), <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a4995ef235d7273c4de2a77fbbc792575">BLI_getDefaultDocumentFolder</a>(), tmpstr);
<a name="l01107"></a>01107         }
<a name="l01108"></a>01108 
<a name="l01109"></a>01109         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[0] == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l01110"></a>01110 <span class="preprocessor">#ifndef WIN32</span>
<a name="l01111"></a>01111 <span class="preprocessor"></span>        {
<a name="l01112"></a>01112             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[0] = <span class="charliteral">&#39;/&#39;</span>;
<a name="l01113"></a>01113             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[1] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01114"></a>01114         }
<a name="l01115"></a>01115 <span class="preprocessor">#else</span>
<a name="l01116"></a>01116 <span class="preprocessor"></span>        {
<a name="l01117"></a>01117             <a class="code" href="../../d9/ded/BLI__winstuff_8h.html#aa17eb556eb4f390c64a7cdc7d1ae2b70">get_default_root</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l01118"></a>01118         }
<a name="l01119"></a>01119         <span class="comment">/* change &quot;C:&quot; --&gt; &quot;C:\&quot;, [#28102] */</span>
<a name="l01120"></a>01120         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (   (isalpha(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[0]) &amp;&amp;
<a name="l01121"></a>01121                     (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[1] == <span class="charliteral">&#39;:&#39;</span>)) &amp;&amp;
<a name="l01122"></a>01122                     (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[2] == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l01123"></a>01123 
<a name="l01124"></a>01124         ) {
<a name="l01125"></a>01125             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[2]= <span class="charliteral">&#39;\\&#39;</span>;
<a name="l01126"></a>01126             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>[3]= <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01127"></a>01127         }
<a name="l01128"></a>01128 <span class="preprocessor">#endif</span>
<a name="l01129"></a>01129 <span class="preprocessor"></span>    }
<a name="l01130"></a>01130 }
<a name="l01131"></a>01131 
<a name="l01132"></a><a class="code" href="../../da/d9e/file__ops_8c.html#af378c50ed596bf077606734e1e7cd7de">01132</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#af378c50ed596bf077606734e1e7cd7de">file_directory_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l01133"></a>01133 {
<a name="l01134"></a>01134     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01135"></a>01135 
<a name="l01136"></a>01136     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01137"></a>01137         <a class="code" href="../../da/d9e/file__ops_8c.html#ac4d6fdd02f6a26b77b4f6b52279bfc29">file_expand_directory</a>(C);
<a name="l01138"></a>01138         
<a name="l01139"></a>01139         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d63/BLI__fileops_8h.html#a0bf59749f87b0f283c37e27e72029591">BLI_exists</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>)) {
<a name="l01140"></a>01140             <span class="keywordflow">return</span> <a class="code" href="../../d6/dae/wm__operators_8c.html#a6bc12e5894a120e55a1768fb6d0a45fe">WM_operator_confirm_message</a>(C, op, <span class="stringliteral">&quot;Create new directory?&quot;</span>);
<a name="l01141"></a>01141         } 
<a name="l01142"></a>01142 
<a name="l01143"></a>01143         <span class="keywordflow">return</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ae97479d5cab8f6f7d50321e763f66a4e">file_directory_exec</a>(C, op);
<a name="l01144"></a>01144     }
<a name="l01145"></a>01145 
<a name="l01146"></a>01146     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01147"></a>01147 }
<a name="l01148"></a>01148 
<a name="l01149"></a>01149 
<a name="l01150"></a>01150 
<a name="l01151"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a8db1bfcb0f31853b4d2f123c5178aaed">01151</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ae97479d5cab8f6f7d50321e763f66a4e">file_directory_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l01152"></a>01152 {
<a name="l01153"></a>01153     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01154"></a>01154     
<a name="l01155"></a>01155     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01156"></a>01156         <a class="code" href="../../da/d9e/file__ops_8c.html#ac4d6fdd02f6a26b77b4f6b52279bfc29">file_expand_directory</a>(C);
<a name="l01157"></a>01157 
<a name="l01158"></a>01158         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d63/BLI__fileops_8h.html#a0bf59749f87b0f283c37e27e72029591">BLI_exists</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>)) {
<a name="l01159"></a>01159             <a class="code" href="../../d2/d63/BLI__fileops_8h.html#a44e7a7091e4cf3ecce692fdc4216657e">BLI_dir_create_recursive</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l01160"></a>01160         }
<a name="l01161"></a>01161 
<a name="l01162"></a>01162         <span class="comment">/* special case, user may have pasted a filepath into the directory */</span>
<a name="l01163"></a>01163         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d63/BLI__fileops_8h.html#abb32d6d105b2c7c8466b42e394422f1d">BLI_is_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>)) {
<a name="l01164"></a>01164             <span class="keywordtype">char</span> <a class="code" href="../../dc/d22/structdirentry.html#a2ccd343a82507dda47b7414f5b1b4ca3">path</a>[<span class="keyword">sizeof</span>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>)];
<a name="l01165"></a>01165             <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(<a class="code" href="../../dc/d22/structdirentry.html#a2ccd343a82507dda47b7414f5b1b4ca3">path</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../dc/d22/structdirentry.html#a2ccd343a82507dda47b7414f5b1b4ca3">path</a>));
<a name="l01166"></a>01166             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#ae9bf85f6bb0df0bb8fcc352e870e32b8">BLI_split_dirfile</a>(<a class="code" href="../../dc/d22/structdirentry.html#a2ccd343a82507dda47b7414f5b1b4ca3">path</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>, <span class="keyword">sizeof</span>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>), <span class="keyword">sizeof</span>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>));
<a name="l01167"></a>01167         }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a7fcb2651a621a0b5e761fbe2a6add270">BLI_cleanup_dir</a>(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l01170"></a>01170         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#ab80bd3eb1d5a53807b777f4912b34cd9">BLI_add_slash</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>);
<a name="l01171"></a>01171         <a class="code" href="../../d4/d71/file__intern_8h.html#af7233b3e3a8c38045eb2fde332224c50">file_change_dir</a>(C, 1);
<a name="l01172"></a>01172 
<a name="l01173"></a>01173         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01174"></a>01174     }       
<a name="l01175"></a>01175     
<a name="l01176"></a>01176 
<a name="l01177"></a>01177     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01178"></a>01178 }
<a name="l01179"></a>01179 
<a name="l01180"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a789b8c1fea1f85fef37a3c4d3f97f86f">01180</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a67611c3c79adaa2ed4d3579e2b7833b1">file_filename_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l01181"></a>01181 {
<a name="l01182"></a>01182     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01183"></a>01183     
<a name="l01184"></a>01184     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01185"></a>01185         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d71/file__intern_8h.html#ae6b2f05e0c7fb96cf02e415af4f1207e">file_select_match</a>(sfile, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>)) {
<a name="l01186"></a>01186             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01187"></a>01187             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae29e0307bcc4666f4ca65cf12480fde6">ND_SPACE_FILE_PARAMS</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01188"></a>01188         }
<a name="l01189"></a>01189     }       
<a name="l01190"></a>01190 
<a name="l01191"></a>01191     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01192"></a>01192 }
<a name="l01193"></a>01193 
<a name="l01194"></a>01194 <span class="comment">/* TODO, directory operator is non-functional while a library is loaded</span>
<a name="l01195"></a>01195 <span class="comment"> * until this is properly supported just disable it. */</span>
<a name="l01196"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ae87a0f0e51c8674c4e8d44b889660ced">01196</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#ae87a0f0e51c8674c4e8d44b889660ced">file_directory_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l01197"></a>01197 {
<a name="l01198"></a>01198     <span class="comment">/* sfile-&gt;files can be NULL on file load */</span>
<a name="l01199"></a>01199     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01200"></a>01200     <span class="keywordflow">return</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>(C) &amp;&amp; (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../db/d74/filelist_8c.html#a5724cc1a7fdc03c922b9c35bf740018d">filelist_lib</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01201"></a>01201 }
<a name="l01202"></a>01202 
<a name="l01203"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a75449465b2791b3b2cf5859912806a85">01203</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a75449465b2791b3b2cf5859912806a85">FILE_OT_directory</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01204"></a>01204 {
<a name="l01205"></a>01205     <span class="comment">/* identifiers */</span>
<a name="l01206"></a>01206     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Enter Directory Name&quot;</span>;
<a name="l01207"></a>01207     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Enter a directory name&quot;</span>;
<a name="l01208"></a>01208     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_directory&quot;</span>;
<a name="l01209"></a>01209     
<a name="l01210"></a>01210     <span class="comment">/* api callbacks */</span>
<a name="l01211"></a>01211     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#af378c50ed596bf077606734e1e7cd7de">file_directory_invoke</a>;
<a name="l01212"></a>01212     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#ae97479d5cab8f6f7d50321e763f66a4e">file_directory_exec</a>;
<a name="l01213"></a>01213     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#ae87a0f0e51c8674c4e8d44b889660ced">file_directory_poll</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 
<a name="l01216"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a7e2010b3f4300363e2c866eecdcf4ffd">01216</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a7e2010b3f4300363e2c866eecdcf4ffd">FILE_OT_refresh</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01217"></a>01217 {
<a name="l01218"></a>01218     <span class="comment">/* identifiers */</span>
<a name="l01219"></a>01219     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Refresh Filelist&quot;</span>;
<a name="l01220"></a>01220     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Refresh the file list&quot;</span>;
<a name="l01221"></a>01221     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_refresh&quot;</span>;
<a name="l01222"></a>01222     
<a name="l01223"></a>01223     <span class="comment">/* api callbacks */</span>
<a name="l01224"></a>01224     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a76bcfe1a20787ddbf60bee9e3d7d1a5f">file_refresh_exec</a>;
<a name="l01225"></a>01225     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l01226"></a>01226 }
<a name="l01227"></a>01227 
<a name="l01228"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a8640f2a312a688e323563a2c26ed9715">01228</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a8640f2a312a688e323563a2c26ed9715">file_hidedot_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l01229"></a>01229 {
<a name="l01230"></a>01230     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01231"></a>01231     
<a name="l01232"></a>01232     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01233"></a>01233         sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a3c6acc46c9f74e155a16521aa43e446d">flag</a> ^= <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#ac15dfdfe6eec84e8af76e4c35f2dcc44">FILE_HIDE_DOT</a>;
<a name="l01234"></a>01234         <a class="code" href="../../db/db9/ED__fileselect_8h.html#ae37aa4cdf13334767e899cc2a97dc737">ED_fileselect_clear</a>(C, sfile);
<a name="l01235"></a>01235         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01236"></a>01236     }
<a name="l01237"></a>01237     
<a name="l01238"></a>01238     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01239"></a>01239 }
<a name="l01240"></a>01240 
<a name="l01241"></a>01241 
<a name="l01242"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a78d19feba1b0d0ecdd96e2fe4ff27ca6">01242</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a78d19feba1b0d0ecdd96e2fe4ff27ca6">FILE_OT_hidedot</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01243"></a>01243 {
<a name="l01244"></a>01244     <span class="comment">/* identifiers */</span>
<a name="l01245"></a>01245     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Toggle Hide Dot Files&quot;</span>;
<a name="l01246"></a>01246     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Toggle hide hidden dot files&quot;</span>;
<a name="l01247"></a>01247     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_hidedot&quot;</span>;
<a name="l01248"></a>01248     
<a name="l01249"></a>01249     <span class="comment">/* api callbacks */</span>
<a name="l01250"></a>01250     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a8640f2a312a688e323563a2c26ed9715">file_hidedot_exec</a>;
<a name="l01251"></a>01251     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l01252"></a>01252 }
<a name="l01253"></a>01253 
<a name="l01254"></a><a class="code" href="../../da/d9e/file__ops_8c.html#aac0151e1f5259833562900b50ef679d7">01254</a> <span class="keyword">struct </span><a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../d4/d71/file__intern_8h.html#aac0151e1f5259833562900b50ef679d7">file_buttons_region</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa)
<a name="l01255"></a>01255 {
<a name="l01256"></a>01256     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, *arnew;
<a name="l01257"></a>01257     
<a name="l01258"></a>01258     <span class="keywordflow">for</span> (ar= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>)
<a name="l01259"></a>01259         <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a065baa7d4590b7259b08da664c894389">RGN_TYPE_CHANNELS</a>)
<a name="l01260"></a>01260             <span class="keywordflow">return</span> ar;
<a name="l01261"></a>01261 
<a name="l01262"></a>01262     <span class="comment">/* add subdiv level; after header */</span>
<a name="l01263"></a>01263     <span class="keywordflow">for</span> (ar= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>)
<a name="l01264"></a>01264         <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>)
<a name="l01265"></a>01265             <span class="keywordflow">break</span>;
<a name="l01266"></a>01266     
<a name="l01267"></a>01267     <span class="comment">/* is error! */</span>
<a name="l01268"></a>01268     <span class="keywordflow">if</span> (ar==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01269"></a>01269     
<a name="l01270"></a>01270     arnew= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a>), <span class="stringliteral">&quot;buttons for file panels&quot;</span>);
<a name="l01271"></a>01271     
<a name="l01272"></a>01272     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a9c299678f8810312806da26e6132ccc7">BLI_insertlinkafter</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>, ar, arnew);
<a name="l01273"></a>01273     arnew-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a065baa7d4590b7259b08da664c894389">RGN_TYPE_CHANNELS</a>;
<a name="l01274"></a>01274     arnew-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>;
<a name="l01275"></a>01275     
<a name="l01276"></a>01276     arnew-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> = <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>;
<a name="l01277"></a>01277     
<a name="l01278"></a>01278     <span class="keywordflow">return</span> arnew;
<a name="l01279"></a>01279 }
<a name="l01280"></a>01280 
<a name="l01281"></a><a class="code" href="../../da/d9e/file__ops_8c.html#af67d1266eb2f797b66f0adca714ca0a9">01281</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#af67d1266eb2f797b66f0adca714ca0a9">file_bookmark_toggle_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l01282"></a>01282 {
<a name="l01283"></a>01283     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l01284"></a>01284     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../d4/d71/file__intern_8h.html#aac0151e1f5259833562900b50ef679d7">file_buttons_region</a>(sa);
<a name="l01285"></a>01285     
<a name="l01286"></a>01286     <span class="keywordflow">if</span> (ar)
<a name="l01287"></a>01287         <a class="code" href="../../d1/d12/ED__screen_8h.html#a51b56d6a91ecd2fd3aac98659c8db1b6">ED_region_toggle_hidden</a>(C, ar);
<a name="l01288"></a>01288 
<a name="l01289"></a>01289     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01290"></a>01290 }
<a name="l01291"></a>01291 
<a name="l01292"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a5a24e6d0f19d43c08bf3d9505ce609d8">01292</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a5a24e6d0f19d43c08bf3d9505ce609d8">FILE_OT_bookmark_toggle</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01293"></a>01293 {
<a name="l01294"></a>01294     <span class="comment">/* identifiers */</span>
<a name="l01295"></a>01295     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Toggle Bookmarks&quot;</span>;
<a name="l01296"></a>01296     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Toggle bookmarks display&quot;</span>;
<a name="l01297"></a>01297     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_bookmark_toggle&quot;</span>;
<a name="l01298"></a>01298     
<a name="l01299"></a>01299     <span class="comment">/* api callbacks */</span>
<a name="l01300"></a>01300     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#af67d1266eb2f797b66f0adca714ca0a9">file_bookmark_toggle_exec</a>;
<a name="l01301"></a>01301     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l01302"></a>01302 }
<a name="l01303"></a>01303 
<a name="l01304"></a>01304 
<a name="l01305"></a><a class="code" href="../../da/d9e/file__ops_8c.html#affff182e15610ce8aa7be372df9b7fb5">01305</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#affff182e15610ce8aa7be372df9b7fb5">file_filenum_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01306"></a>01306 {
<a name="l01307"></a>01307     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01308"></a>01308     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l01309"></a>01309     
<a name="l01310"></a>01310     <span class="keywordtype">int</span> inc = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;increment&quot;</span>);
<a name="l01311"></a>01311     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a> &amp;&amp; (inc != 0)) {
<a name="l01312"></a>01312         <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a717769604e1e8805086b2f60e2e8fe2d">BLI_newname</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af58bb70e4853ac4cb338737f338a2c71">file</a>, inc);
<a name="l01313"></a>01313         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l01314"></a>01314         <a class="code" href="../../d4/d71/file__intern_8h.html#ad90dbf875c519a204b3ee4413b5a92b7">file_draw_check_cb</a>(C, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01315"></a>01315         <span class="comment">// WM_event_add_notifier(C, NC_WINDOW, NULL);</span>
<a name="l01316"></a>01316     }
<a name="l01317"></a>01317     
<a name="l01318"></a>01318     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01319"></a>01319 
<a name="l01320"></a>01320 }
<a name="l01321"></a>01321 
<a name="l01322"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a01db7676a95ce3b2f413a213ddd44ee8">01322</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a01db7676a95ce3b2f413a213ddd44ee8">FILE_OT_filenum</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01323"></a>01323 {
<a name="l01324"></a>01324     <span class="comment">/* identifiers */</span>
<a name="l01325"></a>01325     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Increment Number in Filename&quot;</span>;
<a name="l01326"></a>01326     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Increment number in filename&quot;</span>;
<a name="l01327"></a>01327     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_filenum&quot;</span>;
<a name="l01328"></a>01328     
<a name="l01329"></a>01329     <span class="comment">/* api callbacks */</span>
<a name="l01330"></a>01330     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#affff182e15610ce8aa7be372df9b7fb5">file_filenum_exec</a>;
<a name="l01331"></a>01331     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l01332"></a>01332 
<a name="l01333"></a>01333     <span class="comment">/* props */</span>
<a name="l01334"></a>01334     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;increment&quot;</span>, 1, -100, 100, <span class="stringliteral">&quot;Increment&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, -100,100);
<a name="l01335"></a>01335 }
<a name="l01336"></a>01336 
<a name="l01337"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a478bc4f68bac189894f950d68a83a29b">01337</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a478bc4f68bac189894f950d68a83a29b">file_rename_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01338"></a>01338 {
<a name="l01339"></a>01339     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l01340"></a>01340     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= (<a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a>*)<a class="code" href="../../df/d01/BKE__context_8h.html#ac2755ddf45c6787c6429d5af9b04d809">CTX_wm_space_data</a>(C);
<a name="l01341"></a>01341     
<a name="l01342"></a>01342     <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01343"></a>01343         <span class="keywordtype">int</span> idx = sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a>;
<a name="l01344"></a>01344         <span class="keywordtype">int</span> numfiles = <a class="code" href="../../db/d74/filelist_8c.html#abf8ce10f8516599558164e095b665dea">filelist_numfiles</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>);
<a name="l01345"></a>01345         <span class="keywordflow">if</span> ( (0&lt;=idx) &amp;&amp; (idx&lt;numfiles) ) {
<a name="l01346"></a>01346             <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *file= <a class="code" href="../../db/d74/filelist_8c.html#ae39663828b3dcd7ba509fdfa88051c42">filelist_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, idx);
<a name="l01347"></a>01347             <a class="code" href="../../db/d74/filelist_8c.html#a5c1613fbf8fd2cc01b6b0e51d1d09ab2">filelist_select_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, idx, <a class="code" href="../../d8/d6a/filelist_8h.html#a91ed2be2bf87223c2e75c2083c6fdb1faa469b85fde04398148e8cc09f6cce1a1">FILE_SEL_ADD</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#ae600b87acce857693b34999384dc4351">EDITING_FILE</a>, <a class="code" href="../../d8/d6a/filelist_8h.html#ab7073eb9af91155de50caa0bedc317c1a866238fc635d8ae84e456ffb44d89bf1">CHECK_ALL</a>);
<a name="l01348"></a>01348             <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a4f07bed38759aa356750391937d440bc">renameedit</a>, file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>, <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a40b3bb1f7d7c8c9bbf4e0ed92564e73e">FILE_MAXFILE</a>);
<a name="l01349"></a>01349             sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#a120d6d9439620f1ea4b26c411f3700d4">renamefile</a>[0]= <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01350"></a>01350         }
<a name="l01351"></a>01351         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l01352"></a>01352     }
<a name="l01353"></a>01353     
<a name="l01354"></a>01354     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01355"></a>01355 
<a name="l01356"></a>01356 }
<a name="l01357"></a>01357 
<a name="l01358"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a01c59b5149866971249d7eb8de365e26">01358</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#a01c59b5149866971249d7eb8de365e26">file_rename_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l01359"></a>01359 {
<a name="l01360"></a>01360     <span class="keywordtype">int</span> poll = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>(C);
<a name="l01361"></a>01361     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01362"></a>01362 
<a name="l01363"></a>01363     <span class="keywordflow">if</span> (sfile &amp;&amp; sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01364"></a>01364         <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a> &lt; 0) { 
<a name="l01365"></a>01365             poll= 0;
<a name="l01366"></a>01366         }
<a name="l01367"></a>01367         <span class="keywordflow">else</span> {
<a name="l01368"></a>01368             <span class="keywordtype">char</span> dir[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>], group[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];    
<a name="l01369"></a>01369             <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a45dcb46ad2398df6e81bd7b9ed62cdd4">filelist_islibrary</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, dir, group)) poll= 0;
<a name="l01370"></a>01370         }
<a name="l01371"></a>01371     }
<a name="l01372"></a>01372     <span class="keywordflow">else</span>
<a name="l01373"></a>01373         poll= 0;
<a name="l01374"></a>01374     <span class="keywordflow">return</span> poll;
<a name="l01375"></a>01375 }
<a name="l01376"></a>01376 
<a name="l01377"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a177b0047b91db673e5ea30f48df96306">01377</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a177b0047b91db673e5ea30f48df96306">FILE_OT_rename</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01378"></a>01378 {
<a name="l01379"></a>01379     <span class="comment">/* identifiers */</span>
<a name="l01380"></a>01380     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Rename File or Directory&quot;</span>;
<a name="l01381"></a>01381     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Rename file or file directory&quot;</span>;
<a name="l01382"></a>01382     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_rename&quot;</span>;
<a name="l01383"></a>01383     
<a name="l01384"></a>01384     <span class="comment">/* api callbacks */</span>
<a name="l01385"></a>01385     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a478bc4f68bac189894f950d68a83a29b">file_rename_exec</a>;
<a name="l01386"></a>01386     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#a01c59b5149866971249d7eb8de365e26">file_rename_poll</a>; 
<a name="l01387"></a>01387 
<a name="l01388"></a>01388 }
<a name="l01389"></a>01389 
<a name="l01390"></a><a class="code" href="../../da/d9e/file__ops_8c.html#ad6c16acb89aaa61df8f53a131ecbd19d">01390</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d9e/file__ops_8c.html#ad6c16acb89aaa61df8f53a131ecbd19d">file_delete_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l01391"></a>01391 {
<a name="l01392"></a>01392     <span class="keywordtype">int</span> poll = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>(C);
<a name="l01393"></a>01393     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01394"></a>01394     <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a>* file;
<a name="l01395"></a>01395 
<a name="l01396"></a>01396     <span class="keywordflow">if</span> (sfile &amp;&amp; sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>) {
<a name="l01397"></a>01397         <span class="keywordflow">if</span> (sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a> &lt; 0) { 
<a name="l01398"></a>01398             poll= 0;
<a name="l01399"></a>01399         }
<a name="l01400"></a>01400         <span class="keywordflow">else</span> {
<a name="l01401"></a>01401             <span class="keywordtype">char</span> dir[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>], group[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];    
<a name="l01402"></a>01402             <span class="keywordflow">if</span> (<a class="code" href="../../db/d74/filelist_8c.html#a45dcb46ad2398df6e81bd7b9ed62cdd4">filelist_islibrary</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, dir, group)) poll= 0;
<a name="l01403"></a>01403             file = <a class="code" href="../../db/d74/filelist_8c.html#ae39663828b3dcd7ba509fdfa88051c42">filelist_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a>);
<a name="l01404"></a>01404             <span class="keywordflow">if</span> (file &amp;&amp; <a class="code" href="../../d9/ded/BLI__winstuff_8h.html#a8b545e50cb6e6bd55ed72564bf52cacc">S_ISDIR</a>(file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#aff2ede3a107ed9d4ce33dd36d0c57e76">type</a>)) poll= 0;
<a name="l01405"></a>01405         }
<a name="l01406"></a>01406     }
<a name="l01407"></a>01407     <span class="keywordflow">else</span>
<a name="l01408"></a>01408         poll= 0;
<a name="l01409"></a>01409         
<a name="l01410"></a>01410     <span class="keywordflow">return</span> poll;
<a name="l01411"></a>01411 }
<a name="l01412"></a>01412 
<a name="l01413"></a><a class="code" href="../../da/d9e/file__ops_8c.html#accd9e6095fdf9c09d7fa4b0925c34edf">01413</a> <span class="keywordtype">int</span> <a class="code" href="../../d4/d71/file__intern_8h.html#ae4fb553a9cd70d1b3b9cb65878b3a913">file_delete_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01414"></a>01414 {
<a name="l01415"></a>01415     <span class="keywordtype">char</span> <a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l01416"></a>01416     <a class="code" href="../../d7/d1c/structSpaceFile.html">SpaceFile</a> *sfile= <a class="code" href="../../df/d01/BKE__context_8h.html#af2fd7d0e869872fc05e14252448f5e11">CTX_wm_space_file</a>(C);
<a name="l01417"></a>01417     <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a>* file;
<a name="l01418"></a>01418     
<a name="l01419"></a>01419     
<a name="l01420"></a>01420     file = <a class="code" href="../../db/d74/filelist_8c.html#ae39663828b3dcd7ba509fdfa88051c42">filelist_file</a>(sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a7da25f9907e5e3fae86c36ab182e3fec">files</a>, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#afe61b753e7d42ae728097087d6b3a011">active_file</a>);
<a name="l01421"></a>01421     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a6f32ac1a463a6322c25cb5c1615c4b1c">BLI_make_file_string</a>(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name, str, sfile-&gt;<a class="code" href="../../d7/d1c/structSpaceFile.html#a734998e9f91fa15ae0beb9f723a41d09">params</a>-&gt;<a class="code" href="../../d2/da8/structFileSelectParams.html#af79188d017715ec329cfb34a9b480690">dir</a>, file-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a45e58dd5321043a6dacd3d74650271fa">relname</a>);
<a name="l01422"></a>01422     <a class="code" href="../../d2/d63/BLI__fileops_8h.html#a732fc591374d736271bdaad0ff555432">BLI_delete</a>(str, 0, 0);  
<a name="l01423"></a>01423     <a class="code" href="../../db/db9/ED__fileselect_8h.html#ae37aa4cdf13334767e899cc2a97dc737">ED_fileselect_clear</a>(C, sfile);
<a name="l01424"></a>01424     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afe2265157352c4408924ed513490c532">ND_SPACE_FILE_LIST</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01425"></a>01425     
<a name="l01426"></a>01426     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01427"></a>01427 
<a name="l01428"></a>01428 }
<a name="l01429"></a>01429 
<a name="l01430"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a9e4af80bcbe14b1b05372148ee73e867">01430</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d71/file__intern_8h.html#a9e4af80bcbe14b1b05372148ee73e867">FILE_OT_delete</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01431"></a>01431 {
<a name="l01432"></a>01432     <span class="comment">/* identifiers */</span>
<a name="l01433"></a>01433     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Delete File&quot;</span>;
<a name="l01434"></a>01434     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Delete selected file&quot;</span>;
<a name="l01435"></a>01435     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;FILE_OT_delete&quot;</span>;
<a name="l01436"></a>01436     
<a name="l01437"></a>01437     <span class="comment">/* api callbacks */</span>
<a name="l01438"></a>01438     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a63ac1372a9efaaca8bec8660ff770026">WM_operator_confirm</a>;
<a name="l01439"></a>01439     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d4/d71/file__intern_8h.html#ae4fb553a9cd70d1b3b9cb65878b3a913">file_delete_exec</a>;
<a name="l01440"></a>01440     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d9e/file__ops_8c.html#ad6c16acb89aaa61df8f53a131ecbd19d">file_delete_poll</a>; <span class="comment">/* &lt;- important, handler is on window level */</span>
<a name="l01441"></a>01441 }
<a name="l01442"></a>01442 
<a name="l01443"></a>01443 
<a name="l01444"></a><a class="code" href="../../da/d9e/file__ops_8c.html#a09087688bbea94b999925f5b9d321223">01444</a> <span class="keywordtype">void</span> <a class="code" href="../../db/db9/ED__fileselect_8h.html#a09087688bbea94b999925f5b9d321223">ED_operatormacros_file</a>(<span class="keywordtype">void</span>)
<a name="l01445"></a>01445 {
<a name="l01446"></a>01446 <span class="comment">//  wmOperatorType *ot;</span>
<a name="l01447"></a>01447 <span class="comment">//  wmOperatorTypeMacro *otmacro;</span>
<a name="l01448"></a>01448     
<a name="l01449"></a>01449     <span class="comment">/* future macros */</span>
<a name="l01450"></a>01450 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:17 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
