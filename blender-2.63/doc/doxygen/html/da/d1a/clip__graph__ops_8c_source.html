<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: clip_graph_ops.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">clip_graph_ops.c</div>  </div>
</div>
<div class="contents">
<a href="../../da/d1a/clip__graph__ops_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version. </span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2011 Blender Foundation.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * Contributor(s): Blender Foundation,</span>
<a name="l00023"></a>00023 <span class="comment"> *                 Sergey Sharybin</span>
<a name="l00024"></a>00024 <span class="comment"> *</span>
<a name="l00025"></a>00025 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>   <span class="comment">/* SELECT */</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d3e/BLI__listbase_8h.html">BLI_listbase.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d44/BLI__rect_8h.html">BLI_rect.h</a>&quot;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd4/BKE__movieclip_8h.html">BKE_movieclip.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d72/BKE__tracking_8h.html">BKE_tracking.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dbe/ED__clip_8h.html">ED_clip.h</a>&quot;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1e/UI__interface_8h.html">UI_interface.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/RNA__define_8h.html">RNA_define.h</a>&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d63/UI__view2d_8h.html">UI_view2d.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/clip__intern_8h.html">clip_intern.h</a>&quot;</span>    <span class="comment">// own include</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/******************** common graph-editing utilities ********************/</span>
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">00064</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00067"></a>00067 
<a name="l00068"></a>00068     <span class="keywordflow">if</span> (sc &amp;&amp; sc-&gt;<a class="code" href="../../dc/dd5/structSpaceClip.html#ab38103375a048c37f80d4621df8186c8">clip</a>) {
<a name="l00069"></a>00069         <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <span class="keywordflow">return</span> ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a9c229d954ba6692b9ea76f4a444a6ad5">RGN_TYPE_PREVIEW</a>;
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     <span class="keywordflow">return</span> 0;
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="../../dc/df1/structSelectUserData.html">00077</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00078"></a><a class="code" href="../../dc/df1/structSelectUserData.html#a1057e9259cc08db4058128943a45f404">00078</a>     <span class="keywordtype">int</span> <a class="code" href="../../dc/df1/structSelectUserData.html#a1057e9259cc08db4058128943a45f404">action</a>;
<a name="l00079"></a>00079 } <a class="code" href="../../dc/df1/structSelectUserData.html">SelectUserData</a>;
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a55802a333d3b598268ed449da7f33975">00081</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a55802a333d3b598268ed449da7f33975">toggle_selection_cb</a>(<span class="keywordtype">void</span> *userdata, <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker)
<a name="l00082"></a>00082 {
<a name="l00083"></a>00083     <a class="code" href="../../dc/df1/structSelectUserData.html">SelectUserData</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = (<a class="code" href="../../dc/df1/structSelectUserData.html">SelectUserData</a> *)userdata;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085     <span class="keywordflow">switch</span>(data-&gt;<a class="code" href="../../dc/df1/structSelectUserData.html#a1057e9259cc08db4058128943a45f404">action</a>) {
<a name="l00086"></a>00086         <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#af76323cc5b70d4cbeca6b3887e166fb8">SEL_SELECT</a>:
<a name="l00087"></a>00087             marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> |= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>;
<a name="l00088"></a>00088             <span class="keywordflow">break</span>;
<a name="l00089"></a>00089         <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#a94dcbe0e237e6d615cad805221261370">SEL_DESELECT</a>:
<a name="l00090"></a>00090             marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> &amp;= ~<a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>;
<a name="l00091"></a>00091             <span class="keywordflow">break</span>;
<a name="l00092"></a>00092         <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#ac906797cc9a2787004c6ad16b8151913">SEL_INVERT</a>:
<a name="l00093"></a>00093             marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> ^= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>;
<a name="l00094"></a>00094             <span class="keywordflow">break</span>;
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="comment">/******************** mouse select operator ********************/</span>
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="../../d0/d97/structMouseSelectUserData.html">00100</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00101"></a><a class="code" href="../../d0/d97/structMouseSelectUserData.html#a9ddadb6d3dcd4042c17be6da1a5c5dbc">00101</a>     <span class="keywordtype">int</span> coord,      <span class="comment">/* coordinate index of found entuty (0 = X-axis, 1 = Y-axis) */</span>
<a name="l00102"></a>00102         <a class="code" href="../../d0/d97/structMouseSelectUserData.html#a9ddadb6d3dcd4042c17be6da1a5c5dbc">has_prev</a>;       <span class="comment">/* if there&#39;s valid coordinate of previous point of curve segment */</span>
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="../../d0/d97/structMouseSelectUserData.html#ac926d9033a31b06e5487222233e96c65">00104</a>     <span class="keywordtype">float</span> min_dist,     <span class="comment">/* minimal distance between mouse and currently found entuty */</span>
<a name="l00105"></a>00105           mouse_co[2],  <span class="comment">/* mouse coordinate */</span>
<a name="l00106"></a>00106           prev_co[2],   <span class="comment">/* coordinate of previeous point of segment */</span>
<a name="l00107"></a>00107           min_co[2];    <span class="comment">/* coordinate of entity with minimal distance */</span>
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">00109</a>     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a>;  <span class="comment">/* nearest found track */</span>
<a name="l00110"></a><a class="code" href="../../d0/d97/structMouseSelectUserData.html#ad69238149e5c973e1d051172970c7753">00110</a>     <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ad69238149e5c973e1d051172970c7753">marker</a>;    <span class="comment">/* nearest found marker */</span>
<a name="l00111"></a>00111 } <a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a>;
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a970be4138673f195f847bc70626c7956">00113</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a970be4138673f195f847bc70626c7956">find_nearest_tracking_segment_cb</a>(<span class="keywordtype">void</span> *userdata, <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *track,
<a name="l00114"></a>00114                                              <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker, <span class="keywordtype">int</span> coord, <span class="keywordtype">float</span> val)
<a name="l00115"></a>00115 {
<a name="l00116"></a>00116     <a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = userdata;
<a name="l00117"></a>00117     <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2] = {marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#add7ffc50ffb44d63da012f43977e38ad">framenr</a>, val};
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a9ddadb6d3dcd4042c17be6da1a5c5dbc">has_prev</a>) {
<a name="l00120"></a>00120         <span class="keywordtype">float</span> d = <a class="code" href="../../d9/dc3/BLI__math__geom_8h.html#acb707a79a8f4aaebf941caec9f14725a">dist_to_line_segment_v2</a>(data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a35a894dc70941a8040724b28515ec625">mouse_co</a>, data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ac926d9033a31b06e5487222233e96c65">prev_co</a>, co);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122         <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || d &lt; data-&gt;min_dist) {
<a name="l00123"></a>00123             data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a> = track;
<a name="l00124"></a>00124             data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ab775875f269a97b5afc851803d7f0a1e">min_dist</a> = d;
<a name="l00125"></a>00125             data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a1316e5a89668f18c0e49a2ea1ae201f1">coord</a> = coord;
<a name="l00126"></a>00126             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a5e7a11335014e249bd70cea058cc22ed">copy_v2_v2</a>(data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a44f51b9c563d5820fcce4bd56196b3f2">min_co</a>, co);
<a name="l00127"></a>00127         }
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a9ddadb6d3dcd4042c17be6da1a5c5dbc">has_prev</a> = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00131"></a>00131     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a5e7a11335014e249bd70cea058cc22ed">copy_v2_v2</a>(data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ac926d9033a31b06e5487222233e96c65">prev_co</a>, co);
<a name="l00132"></a>00132 }
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2bfe795faf7e143e3f499aab55682227">00134</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2bfe795faf7e143e3f499aab55682227">find_nearest_tracking_segment_end_cb</a>(<span class="keywordtype">void</span> *userdata)
<a name="l00135"></a>00135 {
<a name="l00136"></a>00136     <a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = userdata;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a9ddadb6d3dcd4042c17be6da1a5c5dbc">has_prev</a> = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af6e0909f0920a43c76f623380f315a7f">00141</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af6e0909f0920a43c76f623380f315a7f">find_nearest_tracking_knot_cb</a>(<span class="keywordtype">void</span> *userdata, <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *track,
<a name="l00142"></a>00142                                           <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker, <span class="keywordtype">int</span> coord, <span class="keywordtype">float</span> val)
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144     <a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = userdata;
<a name="l00145"></a>00145     <span class="keywordtype">float</span> dx = marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#add7ffc50ffb44d63da012f43977e38ad">framenr</a> - data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a35a894dc70941a8040724b28515ec625">mouse_co</a>[0], dy = val - data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a35a894dc70941a8040724b28515ec625">mouse_co</a>[1];
<a name="l00146"></a>00146     <span class="keywordtype">float</span> d = dx * dx + dy * dy;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ad69238149e5c973e1d051172970c7753">marker</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || d &lt; data-&gt;min_dist) {
<a name="l00149"></a>00149         <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2]= {marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#add7ffc50ffb44d63da012f43977e38ad">framenr</a>, val};
<a name="l00150"></a>00150 
<a name="l00151"></a>00151         data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a> = track;
<a name="l00152"></a>00152         data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ad69238149e5c973e1d051172970c7753">marker</a> = marker;
<a name="l00153"></a>00153         data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ab775875f269a97b5afc851803d7f0a1e">min_dist</a> = d;
<a name="l00154"></a>00154         data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a1316e5a89668f18c0e49a2ea1ae201f1">coord</a> = coord;
<a name="l00155"></a>00155         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a5e7a11335014e249bd70cea058cc22ed">copy_v2_v2</a>(data-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a44f51b9c563d5820fcce4bd56196b3f2">min_co</a>, co);
<a name="l00156"></a>00156     }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 }
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a82442a09f261e570aa924dd8d51a5108">00160</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a82442a09f261e570aa924dd8d51a5108">mouse_select_init_data</a>(<a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a> *userdata, <span class="keywordtype">float</span> *<a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>)
<a name="l00161"></a>00161 {
<a name="l00162"></a>00162     memset(userdata, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a>));
<a name="l00163"></a>00163     userdata-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ab775875f269a97b5afc851803d7f0a1e">min_dist</a> = <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>;
<a name="l00164"></a>00164     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a5e7a11335014e249bd70cea058cc22ed">copy_v2_v2</a>(userdata-&gt;<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a35a894dc70941a8040724b28515ec625">mouse_co</a>, co);
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a377515578d0d7a581f482b3922f96ba6">00167</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a377515578d0d7a581f482b3922f96ba6">mouse_select_knot</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2], <span class="keywordtype">int</span> extend)
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00170"></a>00170     <a class="code" href="../../d0/d44/structMovieClip.html">MovieClip</a> *clip= <a class="code" href="../../d6/dbe/ED__clip_8h.html#abdc3da548a748cedabcec52330b193c3">ED_space_clip</a>(sc);
<a name="l00171"></a>00171     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00172"></a>00172     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = &amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>;
<a name="l00173"></a>00173     <a class="code" href="../../d9/ddb/structMovieTracking.html">MovieTracking</a> *tracking = &amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#ad152541b1860f6ba2761a16270df8159">tracking</a>;
<a name="l00174"></a>00174     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *act_track = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a8f9e672798114ca61c2b66776bf4a6c8">BKE_tracking_active_track</a>(tracking);
<a name="l00175"></a>00175     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> delta = 6;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="keywordflow">if</span> (act_track) {
<a name="l00178"></a>00178         <a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a> userdata;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180         <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a82442a09f261e570aa924dd8d51a5108">mouse_select_init_data</a>(&amp;userdata, co);
<a name="l00181"></a>00181         <a class="code" href="../../d4/db3/clip__intern_8h.html#a86987d8150e0e1683bc2e49fb8f9dcf9">clip_graph_tracking_values_iterate_track</a>(sc, act_track, &amp;userdata,
<a name="l00182"></a>00182                                                  <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af6e0909f0920a43c76f623380f315a7f">find_nearest_tracking_knot_cb</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <span class="keywordflow">if</span> (userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ad69238149e5c973e1d051172970c7753">marker</a>) {
<a name="l00185"></a>00185             <span class="keywordtype">int</span> x1, y1, x2, y2;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187             <a class="code" href="../../d5/d63/UI__view2d_8h.html#accea1c4009d4c24471c1fcf6889fa6f5">UI_view2d_view_to_region</a>(v2d, co[0], co[1], &amp;x1, &amp;y1);
<a name="l00188"></a>00188             <a class="code" href="../../d5/d63/UI__view2d_8h.html#accea1c4009d4c24471c1fcf6889fa6f5">UI_view2d_view_to_region</a>(v2d, userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a44f51b9c563d5820fcce4bd56196b3f2">min_co</a>[0], userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a44f51b9c563d5820fcce4bd56196b3f2">min_co</a>[1], &amp;x2, &amp;y2);
<a name="l00189"></a>00189 
<a name="l00190"></a>00190             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/stdosl_8h.html#a1200284b0188ff3732b55b964e5e3a25">abs</a>(x2 - x1) &lt;= delta &amp;&amp; <a class="code" href="../../d1/d22/stdosl_8h.html#a1200284b0188ff3732b55b964e5e3a25">abs</a>(y2 - y1) &lt;= delta) {
<a name="l00191"></a>00191                 <span class="keywordflow">if</span> (!extend) {
<a name="l00192"></a>00192                     <a class="code" href="../../dc/df1/structSelectUserData.html">SelectUserData</a> selectdata = {<a class="code" href="../../d4/d7f/WM__api_8h.html#a94dcbe0e237e6d615cad805221261370">SEL_DESELECT</a>};
<a name="l00193"></a>00193 
<a name="l00194"></a>00194                     <a class="code" href="../../d4/db3/clip__intern_8h.html#a82602bbd7e822fccaf83f623ed0a9a7c">clip_graph_tracking_iterate</a>(sc, &amp;selectdata, <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a55802a333d3b598268ed449da7f33975">toggle_selection_cb</a>);
<a name="l00195"></a>00195                 }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197                 <span class="keywordflow">if</span> (userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a1316e5a89668f18c0e49a2ea1ae201f1">coord</a> == 0)
<a name="l00198"></a>00198                     userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ad69238149e5c973e1d051172970c7753">marker</a>-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> |= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb0bdb56dd26e4ba1dfab43038f9281b">MARKER_GRAPH_SEL_X</a>;
<a name="l00199"></a>00199                 <span class="keywordflow">else</span>
<a name="l00200"></a>00200                     userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#ad69238149e5c973e1d051172970c7753">marker</a>-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> |= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#a18dc59f0dbbf56fdabcbe764b8c09d3a">MARKER_GRAPH_SEL_Y</a>;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202                 <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00203"></a>00203             }
<a name="l00204"></a>00204         }
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a4fb7d78ff4e86090a92fd85d6dfd1b79">00210</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a4fb7d78ff4e86090a92fd85d6dfd1b79">mouse_select_curve</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2], <span class="keywordtype">int</span> extend)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00213"></a>00213     <a class="code" href="../../d0/d44/structMovieClip.html">MovieClip</a> *clip = <a class="code" href="../../d6/dbe/ED__clip_8h.html#abdc3da548a748cedabcec52330b193c3">ED_space_clip</a>(sc);
<a name="l00214"></a>00214     <a class="code" href="../../d9/ddb/structMovieTracking.html">MovieTracking</a> *tracking = &amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#ad152541b1860f6ba2761a16270df8159">tracking</a>;
<a name="l00215"></a>00215     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *act_track = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a8f9e672798114ca61c2b66776bf4a6c8">BKE_tracking_active_track</a>(tracking);
<a name="l00216"></a>00216     <a class="code" href="../../d0/d97/structMouseSelectUserData.html">MouseSelectUserData</a> userdata;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a82442a09f261e570aa924dd8d51a5108">mouse_select_init_data</a>(&amp;userdata, co);
<a name="l00219"></a>00219     <a class="code" href="../../d4/db3/clip__intern_8h.html#a907dcc02d5b3a36ddcd3ee70b86a62c9">clip_graph_tracking_values_iterate</a>(sc, &amp;userdata, <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a970be4138673f195f847bc70626c7956">find_nearest_tracking_segment_cb</a>,
<a name="l00220"></a>00220                                        <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2bfe795faf7e143e3f499aab55682227">find_nearest_tracking_segment_end_cb</a>);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="keywordflow">if</span> (userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a>) {
<a name="l00223"></a>00223         <span class="keywordflow">if</span> (extend) {
<a name="l00224"></a>00224             <span class="keywordflow">if</span> (act_track == userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a>) {
<a name="l00225"></a>00225                 <span class="comment">/* currently only single curve can be selected (selected curve represents active track) */</span>
<a name="l00226"></a>00226                 act_track = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00227"></a>00227             }
<a name="l00228"></a>00228         }
<a name="l00229"></a>00229         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act_track != userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a>) {
<a name="l00230"></a>00230             <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker;
<a name="l00231"></a>00231             <a class="code" href="../../dc/df1/structSelectUserData.html">SelectUserData</a> selectdata = {<a class="code" href="../../d4/d7f/WM__api_8h.html#a94dcbe0e237e6d615cad805221261370">SEL_DESELECT</a>};
<a name="l00232"></a>00232 
<a name="l00233"></a>00233             tracking-&gt;<a class="code" href="../../d9/ddb/structMovieTracking.html#a8589447927c2d2ed3f7fa8b23434046f">act_track</a> = userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a>;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235             <span class="comment">/* make active track be centered to screen */</span>
<a name="l00236"></a>00236             marker = <a class="code" href="../../da/d72/BKE__tracking_8h.html#ad5dea623719f25d453310a97ee138b6f">BKE_tracking_get_marker</a>(userdata.<a class="code" href="../../d0/d97/structMouseSelectUserData.html#a7baa5bd069966ee87bdc895e8959a1dd">track</a>, sc-&gt;<a class="code" href="../../dc/dd5/structSpaceClip.html#a2a37458b4cf3769ca1d24cbf25a96a51">user</a>.<a class="code" href="../../d8/dac/structMovieClipUser.html#a645bba5909762a5df052e903bfb00afb">framenr</a>);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238             <a class="code" href="../../d4/db3/clip__intern_8h.html#a06d8962c101b9646b802afa206330069">clip_view_center_to_point</a>(sc, marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a77909423cde0f8a5b52779c8897bb654">pos</a>[0], marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a77909423cde0f8a5b52779c8897bb654">pos</a>[1]);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240             <span class="comment">/* deselect all knots on newly selected curve */</span>
<a name="l00241"></a>00241             <a class="code" href="../../d4/db3/clip__intern_8h.html#a82602bbd7e822fccaf83f623ed0a9a7c">clip_graph_tracking_iterate</a>(sc, &amp;selectdata, <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a55802a333d3b598268ed449da7f33975">toggle_selection_cb</a>);
<a name="l00242"></a>00242         }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244         <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a16d6b780a6b1f785c80addc07c7504c3">00250</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a16d6b780a6b1f785c80addc07c7504c3">mouse_select</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2], <span class="keywordtype">int</span> extend)
<a name="l00251"></a>00251 {
<a name="l00252"></a>00252     <span class="keywordtype">int</span> sel = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00253"></a>00253 
<a name="l00254"></a>00254     <span class="comment">/* first try to select knot on selected curves */</span>
<a name="l00255"></a>00255     sel = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a377515578d0d7a581f482b3922f96ba6">mouse_select_knot</a>(C, co, extend);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="keywordflow">if</span> (!sel) {
<a name="l00258"></a>00258         <span class="comment">/* if there&#39;s no close enough knot to mouse osition, select nearest curve */</span>
<a name="l00259"></a>00259         sel = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a4fb7d78ff4e86090a92fd85d6dfd1b79">mouse_select_curve</a>(C, co, extend);
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <span class="keywordflow">if</span> (sel)
<a name="l00263"></a>00263         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a18e5c155e3414f127e82fafc888f5eef">00268</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a18e5c155e3414f127e82fafc888f5eef">select_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00269"></a>00269 {
<a name="l00270"></a>00270     <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2];
<a name="l00271"></a>00271     <span class="keywordtype">int</span>  extend = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;extend&quot;</span>);
<a name="l00272"></a>00272 
<a name="l00273"></a>00273     <a class="code" href="../../d3/d10/rna__access_8c.html#a5d95f86ccce314676ae750034fb56709">RNA_float_get_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;location&quot;</span>, co);
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="keywordflow">return</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a16d6b780a6b1f785c80addc07c7504c3">mouse_select</a>(C, co, extend);
<a name="l00276"></a>00276 }
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af5e32347991dfc835f7634e31f512ba2">00278</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af5e32347991dfc835f7634e31f512ba2">select_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00279"></a>00279 {
<a name="l00280"></a>00280     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00281"></a>00281     <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2];
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[0], event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[1], &amp;co[0], &amp;co[1]);
<a name="l00284"></a>00284     <a class="code" href="../../d3/d10/rna__access_8c.html#ad8067a3fc34e361ac2283352ff2f906c">RNA_float_set_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;location&quot;</span>, co);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286     <span class="keywordflow">return</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a18e5c155e3414f127e82fafc888f5eef">select_exec</a>(C, op);
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#a3be91eb047388dde709069da76ff0c2f">00289</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#acf14f81b42eaebdc0380abbcaca1e3ce">CLIP_OT_graph_select</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00290"></a>00290 {
<a name="l00291"></a>00291     <span class="comment">/* identifiers */</span>
<a name="l00292"></a>00292     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select&quot;</span>;
<a name="l00293"></a>00293     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select graph curves&quot;</span>;
<a name="l00294"></a>00294     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_select&quot;</span>;
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     <span class="comment">/* api callbacks */</span>
<a name="l00297"></a>00297     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a18e5c155e3414f127e82fafc888f5eef">select_exec</a>;
<a name="l00298"></a>00298     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af5e32347991dfc835f7634e31f512ba2">select_invoke</a>;
<a name="l00299"></a>00299     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     <span class="comment">/* flags */</span>
<a name="l00302"></a>00302     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     <span class="comment">/* properties */</span>
<a name="l00305"></a>00305     <a class="code" href="../../dc/d7e/rna__define_8c.html#a60e910dcfdccf2a1ede6471837912011">RNA_def_float_vector</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;location&quot;</span>, 2, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>,
<a name="l00306"></a>00306         <span class="stringliteral">&quot;Location&quot;</span>, <span class="stringliteral">&quot;Mouse location to select nearest entity&quot;</span>, -100.0f, 100.0f);
<a name="l00307"></a>00307     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;extend&quot;</span>, 0,
<a name="l00308"></a>00308         <span class="stringliteral">&quot;Extend&quot;</span>, <span class="stringliteral">&quot;Extend selection rather than clearing the existing selection&quot;</span>);
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">/********************** border select operator *********************/</span>
<a name="l00312"></a>00312 
<a name="l00313"></a><a class="code" href="../../d2/d92/structBorderSelectuserData.html">00313</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d92/structBorderSelectuserData.html">BorderSelectuserData</a> {
<a name="l00314"></a><a class="code" href="../../d2/d92/structBorderSelectuserData.html#a45fb19fdebf47a3f09032178317edd5b">00314</a>     <a class="code" href="../../da/d10/structrctf.html">rctf</a> <a class="code" href="../../d2/d92/structBorderSelectuserData.html#a45fb19fdebf47a3f09032178317edd5b">rect</a>;
<a name="l00315"></a><a class="code" href="../../d2/d92/structBorderSelectuserData.html#a78edc3eaa295c76ece6519ad5f12f697">00315</a>     <span class="keywordtype">int</span> <a class="code" href="../../d2/d92/structBorderSelectuserData.html#a3a20726cb28439f6c0ca578f1d7733c0">change</a>, <a class="code" href="../../d2/d92/structBorderSelectuserData.html#a78edc3eaa295c76ece6519ad5f12f697">mode</a>, <a class="code" href="../../d2/d92/structBorderSelectuserData.html#ae25e4d7ead3b9fe1ff9cbc72083b3bdb">extend</a>;
<a name="l00316"></a>00316 } <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a0cfc779f937cdcd56af1845be8e27cfe">BorderSelectuserData</a>;
<a name="l00317"></a>00317 
<a name="l00318"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2b9235a44a5ff2adc0d2538dd19eaddb">00318</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2b9235a44a5ff2adc0d2538dd19eaddb">border_select_cb</a>(<span class="keywordtype">void</span> *userdata, <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(track),
<a name="l00319"></a>00319                              <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker, <span class="keywordtype">int</span> coord, <span class="keywordtype">float</span> val)
<a name="l00320"></a>00320 {
<a name="l00321"></a>00321     <a class="code" href="../../d2/d92/structBorderSelectuserData.html">BorderSelectuserData</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = (<a class="code" href="../../d2/d92/structBorderSelectuserData.html">BorderSelectuserData</a> *) userdata;
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d44/BLI__rect_8h.html#a6601514c8df73c1e060cb2b3f4887b09">BLI_in_rctf</a>(&amp;data-&gt;<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a45fb19fdebf47a3f09032178317edd5b">rect</a>, marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#add7ffc50ffb44d63da012f43977e38ad">framenr</a>, val)) {
<a name="l00324"></a>00324         <span class="keywordtype">int</span> flag = 0;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         <span class="keywordflow">if</span> (coord == 0)
<a name="l00327"></a>00327             flag = <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb0bdb56dd26e4ba1dfab43038f9281b">MARKER_GRAPH_SEL_X</a>;
<a name="l00328"></a>00328         <span class="keywordflow">else</span>
<a name="l00329"></a>00329             flag = <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#a18dc59f0dbbf56fdabcbe764b8c09d3a">MARKER_GRAPH_SEL_Y</a>;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331         <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a78edc3eaa295c76ece6519ad5f12f697">mode</a> == <a class="code" href="../../d1/d40/wm__event__types_8h.html#a99328936c1f7e4fc8d4a889098d4d22d">GESTURE_MODAL_SELECT</a>)
<a name="l00332"></a>00332             marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> |= flag;
<a name="l00333"></a>00333         <span class="keywordflow">else</span>
<a name="l00334"></a>00334             marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> &amp;= ~flag;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         data-&gt;<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a3a20726cb28439f6c0ca578f1d7733c0">change</a> = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00337"></a>00337     }
<a name="l00338"></a>00338     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!data-&gt;<a class="code" href="../../d2/d92/structBorderSelectuserData.html#ae25e4d7ead3b9fe1ff9cbc72083b3bdb">extend</a>) {
<a name="l00339"></a>00339         marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a>&amp;= ~<a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>;
<a name="l00340"></a>00340     }
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a3cfc675a75f939c946ad42b318d732f3">00343</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a3cfc675a75f939c946ad42b318d732f3">border_select_graph_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00346"></a>00346     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00347"></a>00347     <a class="code" href="../../d0/d44/structMovieClip.html">MovieClip</a> *clip = <a class="code" href="../../d6/dbe/ED__clip_8h.html#abdc3da548a748cedabcec52330b193c3">ED_space_clip</a>(sc);
<a name="l00348"></a>00348     <a class="code" href="../../d9/ddb/structMovieTracking.html">MovieTracking</a> *tracking = &amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#ad152541b1860f6ba2761a16270df8159">tracking</a>;
<a name="l00349"></a>00349     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *act_track = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a8f9e672798114ca61c2b66776bf4a6c8">BKE_tracking_active_track</a>(tracking);
<a name="l00350"></a>00350     <a class="code" href="../../d2/d92/structBorderSelectuserData.html">BorderSelectuserData</a> userdata;
<a name="l00351"></a>00351     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> rect;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="comment">/* get rectangle from operator */</span>
<a name="l00354"></a>00354     rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmin&quot;</span>);
<a name="l00355"></a>00355     rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymin&quot;</span>);
<a name="l00356"></a>00356     rect.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmax&quot;</span>);
<a name="l00357"></a>00357     rect.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymax&quot;</span>);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>, rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, &amp;userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a45fb19fdebf47a3f09032178317edd5b">rect</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, &amp;userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a45fb19fdebf47a3f09032178317edd5b">rect</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>);
<a name="l00360"></a>00360     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>, rect.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>, &amp;userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a45fb19fdebf47a3f09032178317edd5b">rect</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a>, &amp;userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a45fb19fdebf47a3f09032178317edd5b">rect</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>);
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a3a20726cb28439f6c0ca578f1d7733c0">change</a> = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00363"></a>00363     userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a78edc3eaa295c76ece6519ad5f12f697">mode</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;gesture_mode&quot;</span>);
<a name="l00364"></a>00364     userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#ae25e4d7ead3b9fe1ff9cbc72083b3bdb">extend</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;extend&quot;</span>);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <a class="code" href="../../d4/db3/clip__intern_8h.html#a86987d8150e0e1683bc2e49fb8f9dcf9">clip_graph_tracking_values_iterate_track</a>(sc, act_track, &amp;userdata, <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2b9235a44a5ff2adc0d2538dd19eaddb">border_select_cb</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="keywordflow">if</span> (userdata.<a class="code" href="../../d2/d92/structBorderSelectuserData.html#a3a20726cb28439f6c0ca578f1d7733c0">change</a>) {
<a name="l00369"></a>00369         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00372"></a>00372     }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#a82500212df2991a605c1e2ea26339eec">00377</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a3871855a390232adbe2198a15882d990">CLIP_OT_graph_select_border</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00378"></a>00378 {
<a name="l00379"></a>00379     <span class="comment">/* identifiers */</span>
<a name="l00380"></a>00380     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Border Select&quot;</span>;
<a name="l00381"></a>00381     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select curve points using border selection&quot;</span>;
<a name="l00382"></a>00382     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_select_border&quot;</span>;
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     <span class="comment">/* api callbacks */</span>
<a name="l00385"></a>00385     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a8d45022b7baa1add659b6798c15601b1">WM_border_select_invoke</a>;
<a name="l00386"></a>00386     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a3cfc675a75f939c946ad42b318d732f3">border_select_graph_exec</a>;
<a name="l00387"></a>00387     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#ab6bb53ebc07c5ca59c0a1a687124de2b">WM_border_select_modal</a>;
<a name="l00388"></a>00388     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>;
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="comment">/* flags */</span>
<a name="l00391"></a>00391     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00392"></a>00392 
<a name="l00393"></a>00393     <span class="comment">/* properties */</span>
<a name="l00394"></a>00394     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7df9a6eccb78facfa397098a5ad2bc4a">WM_operator_properties_gesture_border</a>(ot, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">/********************** select all operator *********************/</span>
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#ad8007320bab870dba076742060eaf916">00399</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#ad8007320bab870dba076742060eaf916">graph_select_all_markers_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00402"></a>00402     <a class="code" href="../../d0/d44/structMovieClip.html">MovieClip</a> *clip = <a class="code" href="../../d6/dbe/ED__clip_8h.html#abdc3da548a748cedabcec52330b193c3">ED_space_clip</a>(sc);
<a name="l00403"></a>00403     <a class="code" href="../../d9/ddb/structMovieTracking.html">MovieTracking</a> *tracking = &amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#ad152541b1860f6ba2761a16270df8159">tracking</a>;
<a name="l00404"></a>00404     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *act_track = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a8f9e672798114ca61c2b66776bf4a6c8">BKE_tracking_active_track</a>(tracking);
<a name="l00405"></a>00405     <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker;
<a name="l00406"></a>00406     <span class="keywordtype">int</span> action = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;action&quot;</span>);
<a name="l00407"></a>00407     <span class="keywordtype">int</span> a;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409     <span class="keywordflow">if</span> (!act_track)
<a name="l00410"></a>00410         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="keywordflow">if</span> (action == <a class="code" href="../../d4/d7f/WM__api_8h.html#a070b8f09bd544f3d0bd5786ca00cda02">SEL_TOGGLE</a>) {
<a name="l00413"></a>00413         action = <a class="code" href="../../d4/d7f/WM__api_8h.html#af76323cc5b70d4cbeca6b3887e166fb8">SEL_SELECT</a>;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415         <span class="keywordflow">for</span> (a = 0; a &lt; act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#ada388ae01f83b973d2efb1414aab67de">markersnr</a>; a++) {
<a name="l00416"></a>00416             marker = &amp;act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#a9b873f8e5dc871f03a5ea0a42095927e">markers</a>[a];
<a name="l00417"></a>00417 
<a name="l00418"></a>00418             <span class="keywordflow">if</span> (marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> &amp; <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>) {
<a name="l00419"></a>00419                 action = <a class="code" href="../../d4/d7f/WM__api_8h.html#a94dcbe0e237e6d615cad805221261370">SEL_DESELECT</a>;
<a name="l00420"></a>00420                 <span class="keywordflow">break</span>;
<a name="l00421"></a>00421             }
<a name="l00422"></a>00422         }
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425     <span class="keywordflow">for</span> (a = 0; a &lt; act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#ada388ae01f83b973d2efb1414aab67de">markersnr</a>; a++) {
<a name="l00426"></a>00426         marker = &amp;act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#a9b873f8e5dc871f03a5ea0a42095927e">markers</a>[a];
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         <span class="keywordflow">switch</span> (action) {
<a name="l00429"></a>00429             <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#af76323cc5b70d4cbeca6b3887e166fb8">SEL_SELECT</a>:
<a name="l00430"></a>00430                 marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> |= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>;
<a name="l00431"></a>00431                 <span class="keywordflow">break</span>;
<a name="l00432"></a>00432             <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#a94dcbe0e237e6d615cad805221261370">SEL_DESELECT</a>:
<a name="l00433"></a>00433                 marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> &amp;= ~<a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>;
<a name="l00434"></a>00434                 <span class="keywordflow">break</span>;
<a name="l00435"></a>00435             <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#ac906797cc9a2787004c6ad16b8151913">SEL_INVERT</a>:
<a name="l00436"></a>00436                 marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> ^= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>;
<a name="l00437"></a>00437                 <span class="keywordflow">break</span>;
<a name="l00438"></a>00438         }
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00446"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#a9853fe0d6239d26a2df8bca9b6a6ca0f">00446</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aab146071892a41b92709534939bf2f56">CLIP_OT_graph_select_all_markers</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448     <span class="comment">/* identifiers */</span>
<a name="l00449"></a>00449     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;(De)select All Markers&quot;</span>;
<a name="l00450"></a>00450     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Change selection of all markers of active track&quot;</span>;
<a name="l00451"></a>00451     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_select_all_markers&quot;</span>;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="comment">/* api callbacks */</span>
<a name="l00454"></a>00454     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#ad8007320bab870dba076742060eaf916">graph_select_all_markers_exec</a>;
<a name="l00455"></a>00455     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457     <span class="comment">/* flags */</span>
<a name="l00458"></a>00458     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <a class="code" href="../../d6/dae/wm__operators_8c.html#ab59cd94616324bb4f3668be8f64bdcd8">WM_operator_properties_select_all</a>(ot);
<a name="l00461"></a>00461 }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 <span class="comment">/******************** delete curve operator ********************/</span>
<a name="l00464"></a>00464 
<a name="l00465"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2e0579b721d0b330f1bfd615c7497b99">00465</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2e0579b721d0b330f1bfd615c7497b99">delete_curve_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l00466"></a>00466 {
<a name="l00467"></a>00467     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00468"></a>00468     <a class="code" href="../../d0/d44/structMovieClip.html">MovieClip</a> *clip = <a class="code" href="../../d6/dbe/ED__clip_8h.html#abdc3da548a748cedabcec52330b193c3">ED_space_clip</a>(sc);
<a name="l00469"></a>00469     <a class="code" href="../../d9/ddb/structMovieTracking.html">MovieTracking</a> *tracking = &amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#ad152541b1860f6ba2761a16270df8159">tracking</a>;
<a name="l00470"></a>00470     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *tracksbase = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a306f9d42cfc651d8620b0d31bfbebd98">BKE_tracking_get_tracks</a>(tracking);
<a name="l00471"></a>00471     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *act_track = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a8f9e672798114ca61c2b66776bf4a6c8">BKE_tracking_active_track</a>(tracking);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="keywordflow">if</span> (act_track)
<a name="l00474"></a>00474         <a class="code" href="../../d4/db3/clip__intern_8h.html#a44f199e6742e811045ff7d371a626c1a">clip_delete_track</a>(C, clip, tracksbase, act_track);
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00479"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#a00f70cf37639bf683629406092451f84">00479</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a96967dc61be69f1552a34be5c8dd4781">CLIP_OT_graph_delete_curve</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481     <span class="comment">/* identifiers */</span>
<a name="l00482"></a>00482     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Delete Curve&quot;</span>;
<a name="l00483"></a>00483     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Delete selected curves&quot;</span>;
<a name="l00484"></a>00484     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_delete_curve&quot;</span>;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486     <span class="comment">/* api callbacks */</span>
<a name="l00487"></a>00487     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a63ac1372a9efaaca8bec8660ff770026">WM_operator_confirm</a>;
<a name="l00488"></a>00488     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a2e0579b721d0b330f1bfd615c7497b99">delete_curve_exec</a>;
<a name="l00489"></a>00489     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/dbe/ED__clip_8h.html#ab2528b5e2dc05f4428ecb491b0fe0343">ED_space_clip_poll</a>;
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     <span class="comment">/* flags */</span>
<a name="l00492"></a>00492     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00493"></a>00493 }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 <span class="comment">/******************** delete knot operator ********************/</span>
<a name="l00496"></a>00496 
<a name="l00497"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a4afc6902a883f2884b2939cfbe50f3dd">00497</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a4afc6902a883f2884b2939cfbe50f3dd">delete_knot_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00500"></a>00500     <a class="code" href="../../d0/d44/structMovieClip.html">MovieClip</a> *clip= <a class="code" href="../../d6/dbe/ED__clip_8h.html#abdc3da548a748cedabcec52330b193c3">ED_space_clip</a>(sc);
<a name="l00501"></a>00501     <a class="code" href="../../d9/ddb/structMovieTracking.html">MovieTracking</a> *tracking = &amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#ad152541b1860f6ba2761a16270df8159">tracking</a>;
<a name="l00502"></a>00502     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *tracksbase = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a306f9d42cfc651d8620b0d31bfbebd98">BKE_tracking_get_tracks</a>(tracking);
<a name="l00503"></a>00503     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *act_track = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a8f9e672798114ca61c2b66776bf4a6c8">BKE_tracking_active_track</a>(tracking);
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="keywordflow">if</span> (act_track) {
<a name="l00506"></a>00506         <span class="keywordtype">int</span> a = 0;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         <span class="keywordflow">while</span> (a &lt; act_track-&gt;markersnr) {
<a name="l00509"></a>00509             <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker = &amp;act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#a9b873f8e5dc871f03a5ea0a42095927e">markers</a>[a];
<a name="l00510"></a>00510 
<a name="l00511"></a>00511             <span class="keywordflow">if</span> (marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> &amp; <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>)
<a name="l00512"></a>00512                 <a class="code" href="../../d4/db3/clip__intern_8h.html#aca5206cae60e9bfd8a97faf952927fb6">clip_delete_marker</a>(C, clip, tracksbase, act_track, marker);
<a name="l00513"></a>00513             <span class="keywordflow">else</span>
<a name="l00514"></a>00514                 a++;
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00519"></a>00519 }
<a name="l00520"></a>00520 
<a name="l00521"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#ad97f99c5ba642c13022e9e79b04531af">00521</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a257e7b6b7eae10d5ae78cec951c62ec8">CLIP_OT_graph_delete_knot</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00522"></a>00522 {
<a name="l00523"></a>00523     <span class="comment">/* identifiers */</span>
<a name="l00524"></a>00524     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Delete Knot&quot;</span>;
<a name="l00525"></a>00525     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Delete curve knots&quot;</span>;
<a name="l00526"></a>00526     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_delete_knot&quot;</span>;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528     <span class="comment">/* api callbacks */</span>
<a name="l00529"></a>00529     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a4afc6902a883f2884b2939cfbe50f3dd">delete_knot_exec</a>;
<a name="l00530"></a>00530     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>;
<a name="l00531"></a>00531 
<a name="l00532"></a>00532     <span class="comment">/* flags */</span>
<a name="l00533"></a>00533     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00534"></a>00534 }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="comment">/******************** view all operator ********************/</span>
<a name="l00537"></a>00537 
<a name="l00538"></a><a class="code" href="../../de/d87/structViewAllUserData.html">00538</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00539"></a><a class="code" href="../../de/d87/structViewAllUserData.html#a9ac2e2e17af4b2936bce60e4677c3489">00539</a>     <span class="keywordtype">float</span> <a class="code" href="../../de/d87/structViewAllUserData.html#a9ac2e2e17af4b2936bce60e4677c3489">min</a>, <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>;
<a name="l00540"></a>00540 } <a class="code" href="../../de/d87/structViewAllUserData.html">ViewAllUserData</a>;
<a name="l00541"></a>00541 
<a name="l00542"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a3f1f2f3ead64eb02c576df58d36116e8">00542</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a3f1f2f3ead64eb02c576df58d36116e8">view_all_cb</a>(<span class="keywordtype">void</span> *userdata, <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(track), <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(marker),
<a name="l00543"></a>00543                         <span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(coord), <span class="keywordtype">float</span> val)
<a name="l00544"></a>00544 {
<a name="l00545"></a>00545     <a class="code" href="../../de/d87/structViewAllUserData.html">ViewAllUserData</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = (<a class="code" href="../../de/d87/structViewAllUserData.html">ViewAllUserData</a> *) userdata;
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="keywordflow">if</span> (val &lt; data-&gt;<a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>)
<a name="l00548"></a>00548         data-&gt;<a class="code" href="../../de/d87/structViewAllUserData.html#a9ac2e2e17af4b2936bce60e4677c3489">min</a> = val;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550     <span class="keywordflow">if</span> (val &gt; data-&gt;<a class="code" href="../../de/d87/structViewAllUserData.html#a490fae3f7ed87fa75745d53399074eed">max</a>)
<a name="l00551"></a>00551         data-&gt;<a class="code" href="../../de/d87/structViewAllUserData.html#a490fae3f7ed87fa75745d53399074eed">max</a> = val;
<a name="l00552"></a>00552 }
<a name="l00553"></a>00553 
<a name="l00554"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aa24a37b1e5fde3679e188b423826b44f">00554</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aa24a37b1e5fde3679e188b423826b44f">view_all_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l00555"></a>00555 {
<a name="l00556"></a>00556     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00557"></a>00557     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00558"></a>00558     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00559"></a>00559     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = &amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>;
<a name="l00560"></a>00560     <a class="code" href="../../de/d87/structViewAllUserData.html">ViewAllUserData</a> userdata;
<a name="l00561"></a>00561     <span class="keywordtype">float</span> extra;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563     userdata.<a class="code" href="../../de/d87/structViewAllUserData.html#a490fae3f7ed87fa75745d53399074eed">max</a> = -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>;
<a name="l00564"></a>00564     userdata.<a class="code" href="../../de/d87/structViewAllUserData.html#a9ac2e2e17af4b2936bce60e4677c3489">min</a> = <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>;
<a name="l00565"></a>00565 
<a name="l00566"></a>00566     <a class="code" href="../../d4/db3/clip__intern_8h.html#a907dcc02d5b3a36ddcd3ee70b86a62c9">clip_graph_tracking_values_iterate</a>(sc, &amp;userdata, <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a3f1f2f3ead64eb02c576df58d36116e8">view_all_cb</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="comment">/* set extents of view to start/end frames */</span>
<a name="l00569"></a>00569     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = (float) <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a6255c40f61f801b311b030a022f43c18">SFRA</a>;
<a name="l00570"></a>00570     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = (float) <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad256bf7a37ebe6e72d9ac63d4a4cea7a">EFRA</a>;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="keywordflow">if</span> (userdata.<a class="code" href="../../de/d87/structViewAllUserData.html#a9ac2e2e17af4b2936bce60e4677c3489">min</a> &lt; userdata.<a class="code" href="../../de/d87/structViewAllUserData.html#a490fae3f7ed87fa75745d53399074eed">max</a>) {
<a name="l00573"></a>00573         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = userdata.<a class="code" href="../../de/d87/structViewAllUserData.html#a9ac2e2e17af4b2936bce60e4677c3489">min</a>;
<a name="l00574"></a>00574         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = userdata.<a class="code" href="../../de/d87/structViewAllUserData.html#a490fae3f7ed87fa75745d53399074eed">max</a>;
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576     <span class="keywordflow">else</span> {
<a name="l00577"></a>00577         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = -10;
<a name="l00578"></a>00578         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = 10;
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581     <span class="comment">/* we need an extra &quot;buffer&quot; factor on either side so that the endpoints are visible */</span>
<a name="l00582"></a>00582     extra = 0.01f * (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>);
<a name="l00583"></a>00583     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> -= extra;
<a name="l00584"></a>00584     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> += extra;
<a name="l00585"></a>00585 
<a name="l00586"></a>00586     extra = 0.01f * (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>);
<a name="l00587"></a>00587     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> -= extra;
<a name="l00588"></a>00588     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> += extra;
<a name="l00589"></a>00589 
<a name="l00590"></a>00590     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00591"></a>00591 
<a name="l00592"></a>00592     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00593"></a>00593 }
<a name="l00594"></a>00594 
<a name="l00595"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#a53b866cbd5b41e5ed6b7d0c13c3abe57">00595</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aeef25d0ab6340792df44b8dd471071c4">CLIP_OT_graph_view_all</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00596"></a>00596 {
<a name="l00597"></a>00597     <span class="comment">/* identifiers */</span>
<a name="l00598"></a>00598     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;View All&quot;</span>;
<a name="l00599"></a>00599     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;View all curves in editor&quot;</span>;
<a name="l00600"></a>00600     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_view_all&quot;</span>;
<a name="l00601"></a>00601 
<a name="l00602"></a>00602     <span class="comment">/* api callbacks */</span>
<a name="l00603"></a>00603     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aa24a37b1e5fde3679e188b423826b44f">view_all_exec</a>;
<a name="l00604"></a>00604     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>;
<a name="l00605"></a>00605 }
<a name="l00606"></a>00606 
<a name="l00607"></a>00607 <span class="comment">/******************** jump to current frame operator ********************/</span>
<a name="l00608"></a>00608 
<a name="l00609"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#a353826ec84901608e480ece982dbd11e">00609</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a6869c44abdc8162270377154207e26fd">ED_clip_graph_center_current_frame</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar)
<a name="l00610"></a>00610 {
<a name="l00611"></a>00611     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = &amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>;
<a name="l00612"></a>00612     <span class="keywordtype">float</span> extra = (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) / 2.0f;
<a name="l00613"></a>00613 
<a name="l00614"></a>00614     <span class="comment">/* set extents of view to start/end frames */</span>
<a name="l00615"></a>00615     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = (float)<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a> - extra;
<a name="l00616"></a>00616     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = (float)<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a> + extra;
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00619"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a8383fce46a04f61576c037cdf01269af">00619</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a8383fce46a04f61576c037cdf01269af">center_current_frame_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l00620"></a>00620 {
<a name="l00621"></a>00621     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00622"></a>00622     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00623"></a>00623 
<a name="l00624"></a>00624     <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a6869c44abdc8162270377154207e26fd">ED_clip_graph_center_current_frame</a>(scene, ar);
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00629"></a>00629 }
<a name="l00630"></a>00630 
<a name="l00631"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#ad86a7fd527e0eebf7cfcb852560ed9a8">00631</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a7bd728ddc818c17c64e3ca366af36aad">CLIP_OT_graph_center_current_frame</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00632"></a>00632 {
<a name="l00633"></a>00633     <span class="comment">/* identifiers */</span>
<a name="l00634"></a>00634     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Center Current Frame&quot;</span>;
<a name="l00635"></a>00635     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Scroll view so current frame would be centered&quot;</span>;
<a name="l00636"></a>00636     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_center_current_frame&quot;</span>;
<a name="l00637"></a>00637 
<a name="l00638"></a>00638     <span class="comment">/* api callbacks */</span>
<a name="l00639"></a>00639     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#a8383fce46a04f61576c037cdf01269af">center_current_frame_exec</a>;
<a name="l00640"></a>00640     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>;
<a name="l00641"></a>00641 }
<a name="l00642"></a>00642 
<a name="l00643"></a>00643 <span class="comment">/********************** disable markers operator *********************/</span>
<a name="l00644"></a>00644 
<a name="l00645"></a><a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aae941a78a4ac6a26423be0a02cbb40f9">00645</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aae941a78a4ac6a26423be0a02cbb40f9">graph_disable_markers_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00646"></a>00646 {
<a name="l00647"></a>00647     <a class="code" href="../../dc/dd5/structSpaceClip.html">SpaceClip</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#a1edbbeea6cb0d78251bd452e711f2fff">CTX_wm_space_clip</a>(C);
<a name="l00648"></a>00648     <a class="code" href="../../d0/d44/structMovieClip.html">MovieClip</a> *clip = <a class="code" href="../../d6/dbe/ED__clip_8h.html#abdc3da548a748cedabcec52330b193c3">ED_space_clip</a>(sc);
<a name="l00649"></a>00649     <a class="code" href="../../d9/ddb/structMovieTracking.html">MovieTracking</a> *tracking = &amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#ad152541b1860f6ba2761a16270df8159">tracking</a>;
<a name="l00650"></a>00650     <a class="code" href="../../da/d5f/structMovieTrackingTrack.html">MovieTrackingTrack</a> *act_track = <a class="code" href="../../da/d72/BKE__tracking_8h.html#a8f9e672798114ca61c2b66776bf4a6c8">BKE_tracking_active_track</a>(tracking);
<a name="l00651"></a>00651     <a class="code" href="../../d2/d75/structMovieTrackingMarker.html">MovieTrackingMarker</a> *marker;
<a name="l00652"></a>00652     <span class="keywordtype">int</span> action = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;action&quot;</span>);
<a name="l00653"></a>00653     <span class="keywordtype">int</span> a;
<a name="l00654"></a>00654 
<a name="l00655"></a>00655     <span class="keywordflow">if</span> (!act_track || (act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#a71bf96554b319d35bd7c5570c261ba9a">flag</a> &amp; <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#a49f735da8b3ad3c977403a791df82088">TRACK_LOCKED</a>))
<a name="l00656"></a>00656         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00657"></a>00657 
<a name="l00658"></a>00658     <span class="keywordflow">for</span> (a = 0; a &lt; act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#ada388ae01f83b973d2efb1414aab67de">markersnr</a>; a++) {
<a name="l00659"></a>00659         marker = &amp;act_track-&gt;<a class="code" href="../../da/d5f/structMovieTrackingTrack.html#a9b873f8e5dc871f03a5ea0a42095927e">markers</a>[a];
<a name="l00660"></a>00660 
<a name="l00661"></a>00661         <span class="keywordflow">if</span> (marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> &amp; <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#adb70bde13c8aa8f66b9bd5a5f1d4e480">MARKER_GRAPH_SEL</a>) {
<a name="l00662"></a>00662             <span class="keywordflow">if</span> (action==0)
<a name="l00663"></a>00663                 marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> |= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#a90fb842f2f7efe62795eff3853df39ba">MARKER_DISABLED</a>;
<a name="l00664"></a>00664             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (action==1)
<a name="l00665"></a>00665                 marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> &amp;= ~<a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#a90fb842f2f7efe62795eff3853df39ba">MARKER_DISABLED</a>;
<a name="l00666"></a>00666             <span class="keywordflow">else</span>
<a name="l00667"></a>00667                 marker-&gt;<a class="code" href="../../d2/d75/structMovieTrackingMarker.html#a6bf7281cddce79f77edb8e48d58a5973">flag</a> ^= <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#a90fb842f2f7efe62795eff3853df39ba">MARKER_DISABLED</a>;
<a name="l00668"></a>00668         }
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a70d8c170e1f4bbcc010d94405d6a9817">DAG_id_tag_update</a>(&amp;clip-&gt;<a class="code" href="../../d0/d44/structMovieClip.html#a51cceb766b47f21cbe774967b1d73b8f">id</a>, 0);
<a name="l00672"></a>00672 
<a name="l00673"></a>00673     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a50b8b6ff8b8949b158250fdc6f315408">NC_MOVIECLIP</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a2eedf6f18454937ee3695d43d99a467d">NA_EVALUATED</a>, clip);
<a name="l00674"></a>00674 
<a name="l00675"></a>00675     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00676"></a>00676 }
<a name="l00677"></a>00677 
<a name="l00678"></a><a class="code" href="../../d4/db3/clip__intern_8h.html#af5a3a0e31d54c5c5ea9299a3ada6e3d3">00678</a> <span class="keywordtype">void</span> <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af5c36b17cf3297730c84ed3665cb2724">CLIP_OT_graph_disable_markers</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00679"></a>00679 {
<a name="l00680"></a>00680     <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> actions_items[] = {
<a name="l00681"></a>00681             {0, <span class="stringliteral">&quot;DISABLE&quot;</span>, 0, <span class="stringliteral">&quot;Disable&quot;</span>, <span class="stringliteral">&quot;Disable selected markers&quot;</span>},
<a name="l00682"></a>00682             {1, <span class="stringliteral">&quot;ENABLE&quot;</span>, 0, <span class="stringliteral">&quot;Enable&quot;</span>, <span class="stringliteral">&quot;Enable selected markers&quot;</span>},
<a name="l00683"></a>00683             {2, <span class="stringliteral">&quot;TOGGLE&quot;</span>, 0, <span class="stringliteral">&quot;Toggle&quot;</span>, <span class="stringliteral">&quot;Toggle disabled flag for selected markers&quot;</span>},
<a name="l00684"></a>00684             {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00685"></a>00685     };
<a name="l00686"></a>00686 
<a name="l00687"></a>00687     <span class="comment">/* identifiers */</span>
<a name="l00688"></a>00688     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Disable Markers&quot;</span>;
<a name="l00689"></a>00689     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Disable/enable selected markers&quot;</span>;
<a name="l00690"></a>00690     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;CLIP_OT_graph_disable_markers&quot;</span>;
<a name="l00691"></a>00691 
<a name="l00692"></a>00692     <span class="comment">/* api callbacks */</span>
<a name="l00693"></a>00693     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#aae941a78a4ac6a26423be0a02cbb40f9">graph_disable_markers_exec</a>;
<a name="l00694"></a>00694     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../da/d1a/clip__graph__ops_8c.html#af2873e7700dbff0e778e52ed16abc7ea">ED_space_clip_graph_poll</a>;
<a name="l00695"></a>00695 
<a name="l00696"></a>00696     <span class="comment">/* flags */</span>
<a name="l00697"></a>00697     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00698"></a>00698 
<a name="l00699"></a>00699     <span class="comment">/* properties */</span>
<a name="l00700"></a>00700     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;action&quot;</span>, actions_items, 0, <span class="stringliteral">&quot;Action&quot;</span>, <span class="stringliteral">&quot;Disable action to execute&quot;</span>);
<a name="l00701"></a>00701 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:11 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
