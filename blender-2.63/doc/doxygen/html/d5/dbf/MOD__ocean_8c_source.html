<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: MOD_ocean.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">MOD_ocean.c</div>  </div>
</div>
<div class="contents">
<a href="../../d5/dbf/MOD__ocean_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html">DNA_customdata_types.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d36/DNA__meshdata__types_8h.html">DNA_meshdata_types.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../da/df0/DNA__modifier__types_8h.html">DNA_modifier_types.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html">BKE_cdderivedmesh.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d0f/BKE__modifier_8h.html">BKE_modifier.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d53/BKE__ocean_8h.html">BKE_ocean.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/dde/BKE__utildefines_8h.html" title="blender format specific macros">BKE_utildefines.h</a>&quot;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d3d/BLI__math__inline_8h.html">BLI_math_inline.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/db3/BLI__string_8h.html">BLI_string.h</a>&quot;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d63/MOD__util_8h.html">MOD_util.h</a>&quot;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#ifdef WITH_OCEANSIM</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> init_cache_data(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd)
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053     <span class="keyword">const</span> <span class="keywordtype">char</span> *relbase= <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a0e4a2d2784b8ca3c1b20c7268e1e68b4">modifier_path_relbase</a>(ob);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a> = <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a64204a1ac8b7f1c6d3ce1269954ef15b">BKE_init_ocean_cache</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a0bb5d38722fec86a68fecbe876cb81c0">cachepath</a>, relbase,
<a name="l00056"></a>00056                                            omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a2479ca8d915d8491b3015149af3a2317">bakestart</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5e0ccffc53912c3c412657131da52a48">bakeend</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a45430913bbbd0898f98d3c6e6f1866a8">wave_scale</a>,
<a name="l00057"></a>00057                                            omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5bb2a5756953200be6bdabb4bb7ea458">chop_amount</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ae74e34cd4c4b8359bb6900d4fdc6d921">foam_coverage</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a63d40b8e265322eaf686921a6b6287c1">foam_fade</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>);
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="keyword">static</span> <span class="keywordtype">void</span> clear_cache_data(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd)
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062     <a class="code" href="../../d7/d53/BKE__ocean_8h.html#aaf198df4c4bb60a26f8556c925f646be">BKE_free_ocean_cache</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a>);
<a name="l00063"></a>00063     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00064"></a>00064     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a40a0d39d57749795f270882d21e6d620">cached</a> = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/* keep in sync with init_ocean_modifier_bake(), object_modifier.c */</span>
<a name="l00068"></a>00068 <span class="keyword">static</span> <span class="keywordtype">void</span> init_ocean_modifier(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd)
<a name="l00069"></a>00069 {
<a name="l00070"></a>00070     <span class="keywordtype">int</span> do_heightfield, do_chop, do_normals, do_jacobian;
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     <span class="keywordflow">if</span> (!omd || !omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>) <span class="keywordflow">return</span>;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     do_heightfield = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00075"></a>00075     do_chop = (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5bb2a5756953200be6bdabb4bb7ea458">chop_amount</a> &gt; 0);
<a name="l00076"></a>00076     do_normals = (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#abe68e015963e4431829a3bf3184bcefa">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a37c003af3facd9eeb474fbef4fcb7983">MOD_OCEAN_GENERATE_NORMALS</a>);
<a name="l00077"></a>00077     do_jacobian = (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#abe68e015963e4431829a3bf3184bcefa">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a0cf6d671e53df271f1ef9e9634ccf411">MOD_OCEAN_GENERATE_FOAM</a>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079     <a class="code" href="../../d7/d53/BKE__ocean_8h.html#aeb95bf7b4a367f39520c6781b3851dde">BKE_free_ocean_data</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>);
<a name="l00080"></a>00080     <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a0fcb37a5904606615405bf13f0616e82">BKE_init_ocean</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>*omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>*omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a>,
<a name="l00081"></a>00081                    omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a01953db093d0ff5fbdcc6b26838893fb">wind_velocity</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a7edc563d0b00a44444bf4ca64e3cea56">smallest_wave</a>, 1.0, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aeb7f2e6712a90b0ebc4f785c81c8c9aa">wave_direction</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ad4150598e7911b572a2e20b2c38946ce">damp</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a0921920e13004da1f2799cd87174172e">wave_alignment</a>,
<a name="l00082"></a>00082                    omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a71ded525b70fa0f93ae03d0df60526e0">depth</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a9ceb9f3bf19c74b1b96b4d79dc8d6f46">time</a>,
<a name="l00083"></a>00083                    do_heightfield, do_chop, do_normals, do_jacobian,
<a name="l00084"></a>00084                    omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4804095ee8c4cb2ab70b36469f3ff542">seed</a>);
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="keyword">static</span> <span class="keywordtype">void</span> simulate_ocean_modifier(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd)
<a name="l00088"></a>00088 {
<a name="l00089"></a>00089     <span class="keywordflow">if</span> (!omd || !omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>) <span class="keywordflow">return</span>;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091     <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a3e3e45b998478a4c1c89ace2ca624f09">BKE_simulate_ocean</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a9ceb9f3bf19c74b1b96b4d79dc8d6f46">time</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a45430913bbbd0898f98d3c6e6f1866a8">wave_scale</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5bb2a5756953200be6bdabb4bb7ea458">chop_amount</a>);
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 <span class="preprocessor">#endif </span><span class="comment">/* WITH_OCEANSIM */</span>
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="comment">/* Modifier Code */</span>
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="../../d5/dbf/MOD__ocean_8c.html#acad405562919addc6fda7d44b7f6fe03">00099</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#acad405562919addc6fda7d44b7f6fe03">initData</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md)
<a name="l00100"></a>00100 {
<a name="l00101"></a>00101 <span class="preprocessor">#ifdef WITH_OCEANSIM</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>    <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd = (<a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a>*) md;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a> = 7;
<a name="l00105"></a>00105     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a> = 50;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a0921920e13004da1f2799cd87174172e">wave_alignment</a> = 0.0;
<a name="l00108"></a>00108     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a01953db093d0ff5fbdcc6b26838893fb">wind_velocity</a> = 30.0;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ad4150598e7911b572a2e20b2c38946ce">damp</a> = 0.5;
<a name="l00111"></a>00111     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a7edc563d0b00a44444bf4ca64e3cea56">smallest_wave</a> = 0.01;
<a name="l00112"></a>00112     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aeb7f2e6712a90b0ebc4f785c81c8c9aa">wave_direction</a>= 0.0;
<a name="l00113"></a>00113     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a71ded525b70fa0f93ae03d0df60526e0">depth</a> = 200.0;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a45430913bbbd0898f98d3c6e6f1866a8">wave_scale</a> = 1.0;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5bb2a5756953200be6bdabb4bb7ea458">chop_amount</a> = 1.0;
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ae74e34cd4c4b8359bb6900d4fdc6d921">foam_coverage</a> = 0.0;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4804095ee8c4cb2ab70b36469f3ff542">seed</a> = 0;
<a name="l00122"></a>00122     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a9ceb9f3bf19c74b1b96b4d79dc8d6f46">time</a> = 1.0;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4fe0e1946f6efb86b772ce0f15585ba2">refresh</a> = 0;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aebf4d6d16a543b198390eaa363889696">size</a> = 1.0;
<a name="l00127"></a>00127     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ab7b9bb47774c8b567be669d9f4505704">repeat_x</a> = 1;
<a name="l00128"></a>00128     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a057ca7b5d4f80531e8532d10bbfb0b5d">repeat_y</a> = 1;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#ab70d223e61986d81d0530f24895a7a8f">modifier_path_init</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a0bb5d38722fec86a68fecbe876cb81c0">cachepath</a>, <span class="keyword">sizeof</span>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a0bb5d38722fec86a68fecbe876cb81c0">cachepath</a>), <span class="stringliteral">&quot;cache_ocean&quot;</span>);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a40a0d39d57749795f270882d21e6d620">cached</a> = 0;
<a name="l00133"></a>00133     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a2479ca8d915d8491b3015149af3a2317">bakestart</a> = 1;
<a name="l00134"></a>00134     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5e0ccffc53912c3c412657131da52a48">bakeend</a> = 250;
<a name="l00135"></a>00135     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00136"></a>00136     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a63d40b8e265322eaf686921a6b6287c1">foam_fade</a> = 0.98;
<a name="l00137"></a>00137     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#af1eb22cd63fe234cfdafefa6d0dd30d3">foamlayername</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;   <span class="comment">/* layer name empty by default */</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a> = <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a36accb2dbb6698deda2847fa10b8307c">BKE_add_ocean</a>();
<a name="l00140"></a>00140     init_ocean_modifier(omd);
<a name="l00141"></a>00141     simulate_ocean_modifier(omd);
<a name="l00142"></a>00142 <span class="preprocessor">#else  // WITH_OCEANSIM</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>    <span class="comment">/* unused */</span>
<a name="l00144"></a>00144     (void)md;
<a name="l00145"></a>00145 <span class="preprocessor">#endif // WITH_OCEANSIM</span>
<a name="l00146"></a>00146 <span class="preprocessor"></span>}
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="../../d5/dbf/MOD__ocean_8c.html#af2c8b1a155950117e5cd808fb00111dd">00148</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#af2c8b1a155950117e5cd808fb00111dd">freeData</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md)
<a name="l00149"></a>00149 {
<a name="l00150"></a>00150 <span class="preprocessor">#ifdef WITH_OCEANSIM</span>
<a name="l00151"></a>00151 <span class="preprocessor"></span>    <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd = (<a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a>*) md;
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a6dddf46fb252f41040d520861ebd29db">BKE_free_ocean</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>);
<a name="l00154"></a>00154     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a>)
<a name="l00155"></a>00155         <a class="code" href="../../d7/d53/BKE__ocean_8h.html#aaf198df4c4bb60a26f8556c925f646be">BKE_free_ocean_cache</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a>);
<a name="l00156"></a>00156 <span class="preprocessor">#else // WITH_OCEANSIM</span>
<a name="l00157"></a>00157 <span class="preprocessor"></span>    <span class="comment">/* unused */</span>
<a name="l00158"></a>00158     (void)md;
<a name="l00159"></a>00159 <span class="preprocessor">#endif // WITH_OCEANSIM</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span>}
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a65005feee1154b489f849ad1324f5f11">00162</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a65005feee1154b489f849ad1324f5f11">copyData</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md, <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *target)
<a name="l00163"></a>00163 {
<a name="l00164"></a>00164 <span class="preprocessor">#ifdef WITH_OCEANSIM</span>
<a name="l00165"></a>00165 <span class="preprocessor"></span>    <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd = (<a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a>*) md;
<a name="l00166"></a>00166     <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *tomd = (<a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a>*) target;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>;
<a name="l00169"></a>00169     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a>;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a01953db093d0ff5fbdcc6b26838893fb">wind_velocity</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a01953db093d0ff5fbdcc6b26838893fb">wind_velocity</a>;
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ad4150598e7911b572a2e20b2c38946ce">damp</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ad4150598e7911b572a2e20b2c38946ce">damp</a>;
<a name="l00174"></a>00174     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a7edc563d0b00a44444bf4ca64e3cea56">smallest_wave</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a7edc563d0b00a44444bf4ca64e3cea56">smallest_wave</a>;
<a name="l00175"></a>00175     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a71ded525b70fa0f93ae03d0df60526e0">depth</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a71ded525b70fa0f93ae03d0df60526e0">depth</a>;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a0921920e13004da1f2799cd87174172e">wave_alignment</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a0921920e13004da1f2799cd87174172e">wave_alignment</a>;
<a name="l00178"></a>00178     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aeb7f2e6712a90b0ebc4f785c81c8c9aa">wave_direction</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aeb7f2e6712a90b0ebc4f785c81c8c9aa">wave_direction</a>;
<a name="l00179"></a>00179     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a45430913bbbd0898f98d3c6e6f1866a8">wave_scale</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a45430913bbbd0898f98d3c6e6f1866a8">wave_scale</a>;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5bb2a5756953200be6bdabb4bb7ea458">chop_amount</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5bb2a5756953200be6bdabb4bb7ea458">chop_amount</a>;
<a name="l00182"></a>00182     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ae74e34cd4c4b8359bb6900d4fdc6d921">foam_coverage</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ae74e34cd4c4b8359bb6900d4fdc6d921">foam_coverage</a>;
<a name="l00183"></a>00183     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a9ceb9f3bf19c74b1b96b4d79dc8d6f46">time</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a9ceb9f3bf19c74b1b96b4d79dc8d6f46">time</a>;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4804095ee8c4cb2ab70b36469f3ff542">seed</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4804095ee8c4cb2ab70b36469f3ff542">seed</a>;
<a name="l00186"></a>00186     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#abe68e015963e4431829a3bf3184bcefa">flag</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#abe68e015963e4431829a3bf3184bcefa">flag</a>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4fe0e1946f6efb86b772ce0f15585ba2">refresh</a> = 0;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 
<a name="l00191"></a>00191     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aebf4d6d16a543b198390eaa363889696">size</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aebf4d6d16a543b198390eaa363889696">size</a>;
<a name="l00192"></a>00192     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ab7b9bb47774c8b567be669d9f4505704">repeat_x</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ab7b9bb47774c8b567be669d9f4505704">repeat_x</a>;
<a name="l00193"></a>00193     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a057ca7b5d4f80531e8532d10bbfb0b5d">repeat_y</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a057ca7b5d4f80531e8532d10bbfb0b5d">repeat_y</a>;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="comment">/* XXX todo: copy cache runtime too */</span>
<a name="l00196"></a>00196     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a40a0d39d57749795f270882d21e6d620">cached</a> = 0;
<a name="l00197"></a>00197     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a2479ca8d915d8491b3015149af3a2317">bakestart</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a2479ca8d915d8491b3015149af3a2317">bakestart</a>;
<a name="l00198"></a>00198     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5e0ccffc53912c3c412657131da52a48">bakeend</a> = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5e0ccffc53912c3c412657131da52a48">bakeend</a>;
<a name="l00199"></a>00199     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     tomd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a> = <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a36accb2dbb6698deda2847fa10b8307c">BKE_add_ocean</a>();
<a name="l00202"></a>00202     init_ocean_modifier(tomd);
<a name="l00203"></a>00203     simulate_ocean_modifier(tomd);
<a name="l00204"></a>00204 <span class="preprocessor">#else // WITH_OCEANSIM</span>
<a name="l00205"></a>00205 <span class="preprocessor"></span>    <span class="comment">/* unused */</span>
<a name="l00206"></a>00206     (void)md;
<a name="l00207"></a>00207     (void)target;
<a name="l00208"></a>00208 <span class="preprocessor">#endif // WITH_OCEANSIM</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>}
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="preprocessor">#ifdef WITH_OCEANSIM</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a2ffccc8a0150d2fe6f44a2407a542b30">CustomDataMask</a> <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#aaaab84bec23bf66ef8cb8ae92947ce43">requiredDataMask</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ob), <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md)
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214     <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd = (<a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *)md;
<a name="l00215"></a>00215     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a2ffccc8a0150d2fe6f44a2407a542b30">CustomDataMask</a> dataMask = 0;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#abe68e015963e4431829a3bf3184bcefa">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a0cf6d671e53df271f1ef9e9634ccf411">MOD_OCEAN_GENERATE_FOAM</a>)
<a name="l00218"></a>00218         dataMask |= <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a39309592e425ee3db512c41152ed8ea4">CD_MASK_MCOL</a>;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="keywordflow">return</span> dataMask;
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 <span class="preprocessor">#else // WITH_OCEANSIM</span>
<a name="l00223"></a><a class="code" href="../../d5/dbf/MOD__ocean_8c.html#aaaab84bec23bf66ef8cb8ae92947ce43">00223</a> <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a2ffccc8a0150d2fe6f44a2407a542b30">CustomDataMask</a> <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#aaaab84bec23bf66ef8cb8ae92947ce43">requiredDataMask</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ob), <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md)
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225     <span class="comment">/* unused */</span>
<a name="l00226"></a>00226     (void)md;
<a name="l00227"></a>00227     <span class="keywordflow">return</span> 0;
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 <span class="preprocessor">#endif // WITH_OCEANSIM</span>
<a name="l00230"></a>00230 <span class="preprocessor"></span>
<a name="l00231"></a>00231 <span class="preprocessor">#if 0</span>
<a name="l00232"></a>00232 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> dm_get_bounds(<a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *dm, <span class="keywordtype">float</span> *sx, <span class="keywordtype">float</span> *sy, <span class="keywordtype">float</span> *ox, <span class="keywordtype">float</span> *oy)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234     <span class="comment">/* get bounding box of underlying dm */</span>
<a name="l00235"></a>00235     <span class="keywordtype">int</span> v, totvert=dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a3d5c5a506b0705a9071680807da2e7ee">getNumVerts</a>(dm);
<a name="l00236"></a>00236     <span class="keywordtype">float</span> <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>[3], <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>[3], delta[3];
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <a class="code" href="../../d8/de5/structMVert.html">MVert</a> *mvert = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#aac2f1d3ce8a7a1a66926e1d295707e67">getVertDataArray</a>(dm,0);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(min, mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l00241"></a>00241     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(max, mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     <span class="keywordflow">for</span> (v=1; v&lt;totvert; v++, mvert++) {
<a name="l00244"></a>00244         min[0]=<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(min[0],mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[0]);
<a name="l00245"></a>00245         min[1]=<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(min[1],mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[1]);
<a name="l00246"></a>00246         min[2]=<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(min[2],mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[2]);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248         max[0]=<a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(max[0],mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[0]);
<a name="l00249"></a>00249         max[1]=<a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(max[1],mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[1]);
<a name="l00250"></a>00250         max[2]=<a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(max[2],mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[2]);
<a name="l00251"></a>00251     }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a55cc5423278e715951545237ac71fb8b">sub_v3_v3v3</a>(delta, max, min);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     *sx = delta[0];
<a name="l00256"></a>00256     *sy = delta[1];
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     *ox = min[0];
<a name="l00259"></a>00259     *oy = min[1];
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 <span class="preprocessor">#endif</span>
<a name="l00262"></a>00262 <span class="preprocessor"></span>
<a name="l00263"></a>00263 <span class="preprocessor">#ifdef WITH_OCEANSIM</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span>
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="preprocessor">#define OMP_MIN_RES 18</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *generate_ocean_geometry(<a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd)
<a name="l00268"></a>00268 {
<a name="l00269"></a>00269     <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *result;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <a class="code" href="../../d8/de5/structMVert.html">MVert</a> *mverts;
<a name="l00272"></a>00272     <a class="code" href="../../d2/dca/structMPoly.html">MPoly</a> *mpolys;
<a name="l00273"></a>00273     <a class="code" href="../../d7/d72/structMLoop.html">MLoop</a> *mloops;
<a name="l00274"></a>00274     <span class="keywordtype">int</span> *origindex;
<a name="l00275"></a>00275 
<a name="l00276"></a>00276     <span class="keywordtype">int</span> cdlayer;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     <span class="keyword">const</span> <span class="keywordtype">int</span> rx = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>*omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>;
<a name="l00279"></a>00279     <span class="keyword">const</span> <span class="keywordtype">int</span> ry = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>*omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aecc7a2d662068f684dc5bf274802d01d">resolution</a>;
<a name="l00280"></a>00280     <span class="keyword">const</span> <span class="keywordtype">int</span> res_x = rx * omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ab7b9bb47774c8b567be669d9f4505704">repeat_x</a>;
<a name="l00281"></a>00281     <span class="keyword">const</span> <span class="keywordtype">int</span> res_y = ry * omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a057ca7b5d4f80531e8532d10bbfb0b5d">repeat_y</a>;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <span class="keyword">const</span> <span class="keywordtype">int</span> num_verts = (res_x + 1) * (res_y + 1);
<a name="l00284"></a>00284     <span class="comment">/* const int num_edges = (res_x * res_y * 2) + res_x + res_y; */</span> <span class="comment">/* UNUSED BMESH */</span>
<a name="l00285"></a>00285     <span class="keyword">const</span> <span class="keywordtype">int</span> num_faces = res_x * res_y;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <span class="keywordtype">float</span> sx = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aebf4d6d16a543b198390eaa363889696">size</a> * omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a>;
<a name="l00288"></a>00288     <span class="keywordtype">float</span> sy = omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aebf4d6d16a543b198390eaa363889696">size</a> * omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a>;
<a name="l00289"></a>00289     <span class="keyword">const</span> <span class="keywordtype">float</span> ox = -sx / 2.0f;
<a name="l00290"></a>00290     <span class="keyword">const</span> <span class="keywordtype">float</span> oy = -sy / 2.0f;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292     <span class="keywordtype">float</span> ix, iy;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <span class="keywordtype">int</span> x, y;
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     sx /= rx;
<a name="l00297"></a>00297     sy /= ry;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299     result = <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#a430764cfc7b8ca4ba60d95c71ce227d7">CDDM_new</a>(num_verts, 0, 0, num_faces * 4, num_faces);
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     mverts = <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#aa752a14da3863173b9d2d3a6efa0b051">CDDM_get_verts</a>(result);
<a name="l00302"></a>00302     mpolys = <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#ad6182e4d1b2c1732283a8267f02302e5">CDDM_get_polys</a>(result);
<a name="l00303"></a>00303     mloops = <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#a4a5dc81c857ca30dceab292febcae987">CDDM_get_loops</a>(result);
<a name="l00304"></a>00304 
<a name="l00305"></a>00305 <span class="preprocessor">#if 0 // trunk</span>
<a name="l00306"></a>00306 <span class="preprocessor"></span>    origindex= result-&gt;getFaceDataArray(result, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a5e2cdbe47f447a68d43a9410d8c42100">CD_ORIGINDEX</a>);
<a name="l00307"></a>00307 <span class="preprocessor">#else // bmesh</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span>    origindex= <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#ab05e3a5a972a7132cc6e254914fb5743">CustomData_get_layer</a>(&amp;result-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a6fef20d1e0da7b52c44be7a98b2fb388">polyData</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a5e2cdbe47f447a68d43a9410d8c42100">CD_ORIGINDEX</a>);
<a name="l00309"></a>00309 <span class="preprocessor">#endif</span>
<a name="l00310"></a>00310 <span class="preprocessor"></span>
<a name="l00311"></a>00311     <span class="comment">/* create vertices */</span>
<a name="l00312"></a>00312 <span class="preprocessor">    #pragma omp parallel for private(x, y) if (rx &gt; OMP_MIN_RES)</span>
<a name="l00313"></a>00313 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (y=0; y &lt; res_y+1; y++) {
<a name="l00314"></a>00314         <span class="keywordflow">for</span> (x=0; x &lt; res_x+1; x++) {
<a name="l00315"></a>00315             <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = y*(res_x+1) + x;
<a name="l00316"></a>00316             <span class="keywordtype">float</span> *<a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>= mverts[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>;
<a name="l00317"></a>00317             co[0] = ox + (x * sx);
<a name="l00318"></a>00318             co[1] = oy + (y * sy);
<a name="l00319"></a>00319             co[2] = 0;
<a name="l00320"></a>00320         }
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="comment">/* create faces */</span>
<a name="l00324"></a>00324 <span class="preprocessor">    #pragma omp parallel for private(x, y) if (rx &gt; OMP_MIN_RES)</span>
<a name="l00325"></a>00325 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (y=0; y &lt; res_y; y++) {
<a name="l00326"></a>00326         <span class="keywordflow">for</span> (x=0; x &lt; res_x; x++) {
<a name="l00327"></a>00327             <span class="keyword">const</span> <span class="keywordtype">int</span> fi = y*res_x + x;
<a name="l00328"></a>00328             <span class="keyword">const</span> <span class="keywordtype">int</span> vi = y*(res_x+1) + x;
<a name="l00329"></a>00329             <a class="code" href="../../d2/dca/structMPoly.html">MPoly</a> *mp= &amp;mpolys[fi];
<a name="l00330"></a>00330             <a class="code" href="../../d7/d72/structMLoop.html">MLoop</a> *ml= &amp;mloops[fi * 4];
<a name="l00331"></a>00331 
<a name="l00332"></a>00332             ml-&gt;<a class="code" href="../../d7/d72/structMLoop.html#ae5aa5a4861aba2bd5145f0b2c4ab4412">v</a> = vi;
<a name="l00333"></a>00333             ml++;
<a name="l00334"></a>00334             ml-&gt;<a class="code" href="../../d7/d72/structMLoop.html#ae5aa5a4861aba2bd5145f0b2c4ab4412">v</a> = vi + 1;
<a name="l00335"></a>00335             ml++;
<a name="l00336"></a>00336             ml-&gt;<a class="code" href="../../d7/d72/structMLoop.html#ae5aa5a4861aba2bd5145f0b2c4ab4412">v</a> = vi + 1 + res_x + 1;
<a name="l00337"></a>00337             ml++;
<a name="l00338"></a>00338             ml-&gt;<a class="code" href="../../d7/d72/structMLoop.html#ae5aa5a4861aba2bd5145f0b2c4ab4412">v</a> = vi + res_x + 1;
<a name="l00339"></a>00339             ml++;
<a name="l00340"></a>00340 
<a name="l00341"></a>00341             mp-&gt;loopstart= fi * 4;
<a name="l00342"></a>00342             mp-&gt;totloop= 4;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344             mp-&gt;flag |= <a class="code" href="../../d4/d36/DNA__meshdata__types_8h.html#a2907e1f781802f5886994a86e0ee6fd1">ME_SMOOTH</a>;
<a name="l00345"></a>00345 
<a name="l00346"></a>00346             <span class="comment">/* generated geometry does not map to original faces */</span>
<a name="l00347"></a>00347             origindex[fi] = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a9c45061d42a9d82ed1a425e2b997c200">ORIGINDEX_NONE</a>;
<a name="l00348"></a>00348         }
<a name="l00349"></a>00349     }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#a63be9fde7bfa09853233c060d0417347">CDDM_calc_edges</a>(result);
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="comment">/* add uvs */</span>
<a name="l00354"></a>00354     cdlayer= <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a1952483728c254dddff6523fba919538">CustomData_number_of_layers</a>(&amp;result-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ad32638299fdf4c22df6a6254add64780">loopData</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#acc4311230a2627e6cbaf767a15b3aaa2">CD_MLOOPUV</a>);
<a name="l00355"></a>00355     <span class="keywordflow">if</span> (cdlayer &lt; <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#ae22819cd79515b97f4f20edf7efcc762">MAX_MTFACE</a>) {
<a name="l00356"></a>00356         <a class="code" href="../../d6/d90/structMLoopUV.html">MLoopUV</a> *mloopuvs = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a14573f9bdcf9448020a73d96d6e7a51e">CustomData_add_layer</a>(&amp;result-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ad32638299fdf4c22df6a6254add64780">loopData</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#acc4311230a2627e6cbaf767a15b3aaa2">CD_MLOOPUV</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a05108c9597b8051246fc8fbc09caa56d">CD_CALLOC</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, num_faces * 4);
<a name="l00357"></a>00357         <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a14573f9bdcf9448020a73d96d6e7a51e">CustomData_add_layer</a>(&amp;result-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a6fef20d1e0da7b52c44be7a98b2fb388">polyData</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a05731a08cef6d81e74c221963ae25712">CD_MTEXPOLY</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a05108c9597b8051246fc8fbc09caa56d">CD_CALLOC</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, num_faces);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359         <span class="keywordflow">if</span> (mloopuvs) { <span class="comment">/* unlikely to fail */</span>
<a name="l00360"></a>00360             ix = 1.0 / rx;
<a name="l00361"></a>00361             iy = 1.0 / ry;
<a name="l00362"></a>00362 <span class="preprocessor">            #pragma omp parallel for private(x, y) if (rx &gt; OMP_MIN_RES)</span>
<a name="l00363"></a>00363 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (y=0; y &lt; res_y; y++) {
<a name="l00364"></a>00364                 <span class="keywordflow">for</span> (x=0; x &lt; res_x; x++) {
<a name="l00365"></a>00365                     <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = y*res_x + x;
<a name="l00366"></a>00366                     <a class="code" href="../../d6/d90/structMLoopUV.html">MLoopUV</a> *luv= &amp;mloopuvs[i * 4];
<a name="l00367"></a>00367 
<a name="l00368"></a>00368                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[0] = x * ix;
<a name="l00369"></a>00369                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[1] = y * iy;
<a name="l00370"></a>00370                     luv++;
<a name="l00371"></a>00371 
<a name="l00372"></a>00372                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[0] = (x+1) * ix;
<a name="l00373"></a>00373                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[1] = y * iy;
<a name="l00374"></a>00374                     luv++;
<a name="l00375"></a>00375 
<a name="l00376"></a>00376                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[0] = (x+1) * ix;
<a name="l00377"></a>00377                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[1] = (y+1) * iy;
<a name="l00378"></a>00378                     luv++;
<a name="l00379"></a>00379 
<a name="l00380"></a>00380                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[0] = x * ix;
<a name="l00381"></a>00381                     luv-&gt;<a class="code" href="../../d6/d90/structMLoopUV.html#ac544e39393bf4b87a7addbcb03198a1f">uv</a>[1] = (y+1) * iy;
<a name="l00382"></a>00382                     luv++;
<a name="l00383"></a>00383 
<a name="l00384"></a>00384                 }
<a name="l00385"></a>00385             }
<a name="l00386"></a>00386         }
<a name="l00387"></a>00387     }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     <span class="keywordflow">return</span> result;
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 <span class="keyword">static</span> <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *<a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a0c07fdfebce51c60a7677ef07b35beb7">doOcean</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob,
<a name="l00393"></a>00393                             <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *derivedData,
<a name="l00394"></a>00394                             <span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(useRenderParams))
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396     <a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a> *omd = (<a class="code" href="../../dd/da2/structOceanModifierData.html">OceanModifierData</a>*) md;
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *dm=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00399"></a>00399     <a class="code" href="../../d9/db9/structOceanResult.html">OceanResult</a> ocr;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <a class="code" href="../../d8/de5/structMVert.html">MVert</a> *mverts, *mv;
<a name="l00402"></a>00402     <a class="code" href="../../d7/d72/structMLoop.html">MLoop</a> *mloops;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406     <span class="keywordtype">int</span> num_verts;
<a name="l00407"></a>00407     <span class="keywordtype">int</span> num_faces;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409     <span class="keywordtype">int</span> cfra;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411     <span class="comment">/* use cached &amp; inverted value for speed</span>
<a name="l00412"></a>00412 <span class="comment">     * expanded this would read...</span>
<a name="l00413"></a>00413 <span class="comment">     *</span>
<a name="l00414"></a>00414 <span class="comment">     * (axis / (omd-&gt;size * omd-&gt;spatial_size)) + 0.5f) */</span>
<a name="l00415"></a>00415 <span class="preprocessor">#define OCEAN_CO(_size_co_inv, _v) ((_v * _size_co_inv) + 0.5f)</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>
<a name="l00417"></a>00417     <span class="keyword">const</span> <span class="keywordtype">float</span> size_co_inv= 1.0f / (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#aebf4d6d16a543b198390eaa363889696">size</a> * omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4f620a74bb4b753105e787d9e5725a3c">spatial_size</a>);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <span class="comment">/* update modifier */</span>
<a name="l00420"></a>00420     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4fe0e1946f6efb86b772ce0f15585ba2">refresh</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#ad01b0781949d1f14eb39362eb4cf15ae">MOD_OCEAN_REFRESH_ADD</a>)
<a name="l00421"></a>00421         omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a> = <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a36accb2dbb6698deda2847fa10b8307c">BKE_add_ocean</a>();
<a name="l00422"></a>00422     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4fe0e1946f6efb86b772ce0f15585ba2">refresh</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a5cb36818f41a5ce593efab6f213d4a1a">MOD_OCEAN_REFRESH_RESET</a>)
<a name="l00423"></a>00423         init_ocean_modifier(omd);
<a name="l00424"></a>00424     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4fe0e1946f6efb86b772ce0f15585ba2">refresh</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#aa71aec18a7a8bc97f082fd5a739e4b87">MOD_OCEAN_REFRESH_CLEAR_CACHE</a>)
<a name="l00425"></a>00425         clear_cache_data(omd);
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a4fe0e1946f6efb86b772ce0f15585ba2">refresh</a> = 0;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <span class="comment">/* do ocean simulation */</span>
<a name="l00430"></a>00430     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a40a0d39d57749795f270882d21e6d620">cached</a> == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l00431"></a>00431         <span class="keywordflow">if</span> (!omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a>) init_cache_data(ob, omd);
<a name="l00432"></a>00432         <a class="code" href="../../d7/d53/BKE__ocean_8h.html#aa0d75b2030090b2e58c75585543988cb">BKE_simulate_ocean_cache</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a>, md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a753914a1c3656e4c937e3c3975fec77e">scene</a>-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>);
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434     <span class="keywordflow">else</span> {
<a name="l00435"></a>00435         simulate_ocean_modifier(omd);
<a name="l00436"></a>00436     }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a43a6883d0da63b4703a62ac59f1a1a6c">geometry_mode</a> == <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a38ea3eba645350b9e92b3d4d2d6525cf">MOD_OCEAN_GEOM_GENERATE</a>)
<a name="l00439"></a>00439         dm = generate_ocean_geometry(omd);
<a name="l00440"></a>00440     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a43a6883d0da63b4703a62ac59f1a1a6c">geometry_mode</a> == <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#ab60383c173d96d017d40cbae25689718">MOD_OCEAN_GEOM_DISPLACE</a>) {
<a name="l00441"></a>00441         dm = <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#a11c2ffc21d7b76e1d54d7d0acca4081b">CDDM_copy</a>(derivedData);
<a name="l00442"></a>00442     }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444     cfra = md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a753914a1c3656e4c937e3c3975fec77e">scene</a>-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>;
<a name="l00445"></a>00445     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(cfra, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a2479ca8d915d8491b3015149af3a2317">bakestart</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5e0ccffc53912c3c412657131da52a48">bakeend</a>);
<a name="l00446"></a>00446     cfra -= omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a2479ca8d915d8491b3015149af3a2317">bakestart</a>; <span class="comment">// shift to 0 based</span>
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     num_verts = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a3d5c5a506b0705a9071680807da2e7ee">getNumVerts</a>(dm);
<a name="l00449"></a>00449     num_faces = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a316a9297495999cd00e5fa1107c67efd">getNumPolys</a>(dm);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     mverts = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#adf25b9f9aee2bb3846fe2d0c4a2ab1d4">getVertArray</a>(dm);
<a name="l00452"></a>00452     mloops = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ac37f17fc9af1ffe241e8ad3049a9ccfb">getLoopArray</a>(dm);
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <span class="comment">/* add vcols before displacement - allows lookup based on position */</span>
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#abe68e015963e4431829a3bf3184bcefa">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a0cf6d671e53df271f1ef9e9634ccf411">MOD_OCEAN_GENERATE_FOAM</a>) {
<a name="l00457"></a>00457         <span class="keywordtype">int</span> cdlayer= <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a1952483728c254dddff6523fba919538">CustomData_number_of_layers</a>(&amp;dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ad32638299fdf4c22df6a6254add64780">loopData</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#adfdc3d9683ce132f088e8fee80fe6f71">CD_MLOOPCOL</a>);
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         <span class="keywordflow">if</span> (cdlayer &lt; <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a5398e8b5970d1d384b30aa928068cebd">MAX_MCOL</a>) {
<a name="l00460"></a>00460             <a class="code" href="../../d5/df4/structMLoopCol.html">MLoopCol</a> *mloopcols= <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a514f57347b3c1b0b3bdcbfca430b4730">CustomData_add_layer_named</a>(&amp;dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ad32638299fdf4c22df6a6254add64780">loopData</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#adfdc3d9683ce132f088e8fee80fe6f71">CD_MLOOPCOL</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a05108c9597b8051246fc8fbc09caa56d">CD_CALLOC</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, num_faces * 4, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#af1eb22cd63fe234cfdafefa6d0dd30d3">foamlayername</a>);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462             <span class="keywordflow">if</span> (mloopcols) { <span class="comment">/* unlikely to fail */</span>
<a name="l00463"></a>00463                 <a class="code" href="../../d5/df4/structMLoopCol.html">MLoopCol</a> *mlcol;
<a name="l00464"></a>00464                 <a class="code" href="../../d2/dca/structMPoly.html">MPoly</a> *mpolys= dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ab8b054b009b29543deee65428097ee83">getPolyArray</a>(dm);
<a name="l00465"></a>00465                 <a class="code" href="../../d2/dca/structMPoly.html">MPoly</a> *mp;
<a name="l00466"></a>00466 
<a name="l00467"></a>00467                 <span class="keywordtype">float</span> foam;
<a name="l00468"></a>00468 
<a name="l00469"></a>00469                 <span class="keywordflow">for</span> (i = 0, mp= mpolys; i &lt; num_faces; i++, mp++) {
<a name="l00470"></a>00470                     j= mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#a056a6dcc2dd557fc8b14db5aa6dfa8b0">totloop</a> - 1;
<a name="l00471"></a>00471 
<a name="l00472"></a>00472                     <span class="comment">/* highly unlikely */</span>
<a name="l00473"></a>00473                     <span class="keywordflow">if</span> (j &lt;= 0) <span class="keywordflow">continue</span>;
<a name="l00474"></a>00474 
<a name="l00475"></a>00475                     <span class="keywordflow">do</span> {
<a name="l00476"></a>00476                         <span class="keyword">const</span> <span class="keywordtype">float</span> *<a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>= mverts[mloops[mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#af553fa511f9a5475e5ff8cca8fa0b115">loopstart</a> + j].<a class="code" href="../../d7/d72/structMLoop.html#ae5aa5a4861aba2bd5145f0b2c4ab4412">v</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>;
<a name="l00477"></a>00477                         <span class="keyword">const</span> <span class="keywordtype">float</span> u = OCEAN_CO(size_co_inv, co[0]);
<a name="l00478"></a>00478                         <span class="keyword">const</span> <span class="keywordtype">float</span> v = OCEAN_CO(size_co_inv, co[1]);
<a name="l00479"></a>00479 
<a name="l00480"></a>00480                         <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a> &amp;&amp; omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a40a0d39d57749795f270882d21e6d620">cached</a>==<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l00481"></a>00481                             <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a1886c164597270fcc55c75bcc7f8c7ab">BKE_ocean_cache_eval_uv</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a>, &amp;ocr, cfra, u, v);
<a name="l00482"></a>00482                             foam = ocr.<a class="code" href="../../d9/db9/structOceanResult.html#afa8e5e40285e6129d984391e1248d032">foam</a>;
<a name="l00483"></a>00483                             <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(foam, 0.0f, 1.0f);
<a name="l00484"></a>00484                         }
<a name="l00485"></a>00485                         <span class="keywordflow">else</span> {
<a name="l00486"></a>00486                             <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a7b893f0600768a3f378b48be43d6b911">BKE_ocean_eval_uv</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>, &amp;ocr, u, v);
<a name="l00487"></a>00487                             foam = <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a3f0623bc72b9bc0f722cbe1e1f42163e">BKE_ocean_jminus_to_foam</a>(ocr.<a class="code" href="../../d9/db9/structOceanResult.html#a94986432916b25f42e8d01700c63688f">Jminus</a>, omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#ae74e34cd4c4b8359bb6900d4fdc6d921">foam_coverage</a>);
<a name="l00488"></a>00488                         }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490                         mlcol= &amp;mloopcols[mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#af553fa511f9a5475e5ff8cca8fa0b115">loopstart</a> + j];
<a name="l00491"></a>00491                         mlcol-&gt;<a class="code" href="../../d5/df4/structMLoopCol.html#a761df0c1a71a5aafd7e5c6183732e182">r</a> = mlcol-&gt;<a class="code" href="../../d5/df4/structMLoopCol.html#a3891d53855f19a889b5e25f7edc332ed">g</a> = mlcol-&gt;<a class="code" href="../../d5/df4/structMLoopCol.html#a313b1b64bedbf4b1d3426940076567c8">b</a> = (char)(foam * 255);
<a name="l00492"></a>00492                         <span class="comment">/* mc-&gt;a = 255; */</span> <span class="comment">/* no need to set */</span>
<a name="l00493"></a>00493                     } <span class="keywordflow">while</span> (j--);
<a name="l00494"></a>00494                 }
<a name="l00495"></a>00495             }
<a name="l00496"></a>00496         }
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     <span class="comment">/* displace the geometry */</span>
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     <span class="comment">//#pragma omp parallel for private(i, ocr) if (omd-&gt;resolution &gt; OMP_MIN_RES)</span>
<a name="l00503"></a>00503     <span class="keywordflow">for</span> (i=0, mv= mverts; i&lt; num_verts; i++, mv++) {
<a name="l00504"></a>00504         <span class="keyword">const</span> <span class="keywordtype">float</span> u = OCEAN_CO(size_co_inv, mv-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[0]);
<a name="l00505"></a>00505         <span class="keyword">const</span> <span class="keywordtype">float</span> v = OCEAN_CO(size_co_inv, mv-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[1]);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507         <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a> &amp;&amp; omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a40a0d39d57749795f270882d21e6d620">cached</a>==<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00508"></a>00508             <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a1886c164597270fcc55c75bcc7f8c7ab">BKE_ocean_cache_eval_uv</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a78587d758f8b21d9fdc1921152f2bb23">oceancache</a>, &amp;ocr, cfra, u, v);
<a name="l00509"></a>00509         <span class="keywordflow">else</span>
<a name="l00510"></a>00510             <a class="code" href="../../d7/d53/BKE__ocean_8h.html#a7b893f0600768a3f378b48be43d6b911">BKE_ocean_eval_uv</a>(omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a6110a9d1a5cc07374fc7391563a21fea">ocean</a>, &amp;ocr, u, v);
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         mv-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[2] += ocr.<a class="code" href="../../d9/db9/structOceanResult.html#a8314792c97872eb8295adf463e84dde9">disp</a>[1];
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         <span class="keywordflow">if</span> (omd-&gt;<a class="code" href="../../dd/da2/structOceanModifierData.html#a5bb2a5756953200be6bdabb4bb7ea458">chop_amount</a> &gt; 0.0f) {
<a name="l00515"></a>00515             mv-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[0] += ocr.<a class="code" href="../../d9/db9/structOceanResult.html#a8314792c97872eb8295adf463e84dde9">disp</a>[0];
<a name="l00516"></a>00516             mv-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>[1] += ocr.<a class="code" href="../../d9/db9/structOceanResult.html#a8314792c97872eb8295adf463e84dde9">disp</a>[2];
<a name="l00517"></a>00517         }
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 <span class="preprocessor">    #undef OCEAN_CO</span>
<a name="l00521"></a>00521 <span class="preprocessor"></span>
<a name="l00522"></a>00522     <span class="keywordflow">return</span> dm;
<a name="l00523"></a>00523 }
<a name="l00524"></a>00524 <span class="preprocessor">#else  // WITH_OCEANSIM</span>
<a name="l00525"></a><a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a0c07fdfebce51c60a7677ef07b35beb7">00525</a> <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *<a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a0c07fdfebce51c60a7677ef07b35beb7">doOcean</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md, <a class="code" href="../../de/de7/structObject.html">Object</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ob),
<a name="l00526"></a>00526                               <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *derivedData,
<a name="l00527"></a>00527                               <span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(useRenderParams))
<a name="l00528"></a>00528 {
<a name="l00529"></a>00529     <span class="comment">/* unused */</span>
<a name="l00530"></a>00530     (void)md;
<a name="l00531"></a>00531     <span class="keywordflow">return</span> derivedData;
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 <span class="preprocessor">#endif // WITH_OCEANSIM</span>
<a name="l00534"></a>00534 <span class="preprocessor"></span>
<a name="l00535"></a><a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a657770a7eaacfd887c90783cd4e61765">00535</a> <span class="keyword">static</span> <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *<a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a657770a7eaacfd887c90783cd4e61765">applyModifier</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob,
<a name="l00536"></a>00536                                   <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *derivedData,
<a name="l00537"></a>00537                                   <span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(useRenderParams),
<a name="l00538"></a>00538                                   <span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(isFinalCalc))
<a name="l00539"></a>00539 {
<a name="l00540"></a>00540     <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *result;
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     result = <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a0c07fdfebce51c60a7677ef07b35beb7">doOcean</a>(md, ob, derivedData, 0);
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     <span class="keywordflow">if</span> (result != derivedData)
<a name="l00545"></a>00545         <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#a231267779e27c6615eea7aa3bd40b036">CDDM_calc_normals</a>(result);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="keywordflow">return</span> result;
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00550"></a><a class="code" href="../../d5/dbf/MOD__ocean_8c.html#aeceac0f1d33f426a304db3463e2d5724">00550</a> <span class="keyword">static</span> <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *<a class="code" href="../../d5/dbf/MOD__ocean_8c.html#aeceac0f1d33f426a304db3463e2d5724">applyModifierEM</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob,
<a name="l00551"></a>00551                                     <span class="keyword">struct</span> <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(editData),
<a name="l00552"></a>00552                                     <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *derivedData)
<a name="l00553"></a>00553 {
<a name="l00554"></a>00554     <span class="keywordflow">return</span> <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a657770a7eaacfd887c90783cd4e61765">applyModifier</a>(md, ob, derivedData, 0, 1);
<a name="l00555"></a>00555 }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557 
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="../../d1/d59/MOD__modifiertypes_8h.html#a9184d6fb71ecd64d31c37b9d75db83d8">00559</a> <a class="code" href="../../db/dc5/structModifierTypeInfo.html">ModifierTypeInfo</a> <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a9184d6fb71ecd64d31c37b9d75db83d8">modifierType_Ocean</a> = {
<a name="l00560"></a>00560     <span class="comment">/* name */</span>              <span class="stringliteral">&quot;Ocean&quot;</span>,
<a name="l00561"></a>00561     <span class="comment">/* structName */</span>        <span class="stringliteral">&quot;OceanModifierData&quot;</span>,
<a name="l00562"></a>00562     <span class="comment">/* structSize */</span>        <span class="keyword">sizeof</span>(<a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a0ac05b4c44ecd7bf5535d30529360caf">OceanModifierData</a>),
<a name="l00563"></a>00563     <span class="comment">/* type */</span>              <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#abd2410bb81ff1d02c80627595bfc66a7aae51d200ac4da5c6b8e9c94542a20aaf">eModifierTypeType_Constructive</a>,
<a name="l00564"></a>00564     <span class="comment">/* flags */</span>             <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a4c64dc2e6ccb9a3c602589c543ac0321ae8fe84a2e8beccc9f9c6e0a800ee1fbe">eModifierTypeFlag_AcceptsMesh</a>
<a name="l00565"></a>00565                             | <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a4c64dc2e6ccb9a3c602589c543ac0321a8805d824ff1947a7a3d1a0e493770809">eModifierTypeFlag_SupportsEditmode</a>
<a name="l00566"></a>00566                             | <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a4c64dc2e6ccb9a3c602589c543ac0321a7974e4ad6ef025d3c3d801980541d61b">eModifierTypeFlag_EnableInEditmode</a>,
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="comment">/* copyData */</span>          <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a65005feee1154b489f849ad1324f5f11">copyData</a>,
<a name="l00569"></a>00569     <span class="comment">/* deformMatrices */</span>    <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00570"></a>00570     <span class="comment">/* deformVerts */</span>       <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00571"></a>00571     <span class="comment">/* deformVertsEM */</span>     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00572"></a>00572     <span class="comment">/* deformMatricesEM */</span>  <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00573"></a>00573     <span class="comment">/* applyModifier */</span>     <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#a657770a7eaacfd887c90783cd4e61765">applyModifier</a>,
<a name="l00574"></a>00574     <span class="comment">/* applyModifierEM */</span>   <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#aeceac0f1d33f426a304db3463e2d5724">applyModifierEM</a>,
<a name="l00575"></a>00575     <span class="comment">/* initData */</span>          <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#acad405562919addc6fda7d44b7f6fe03">initData</a>,
<a name="l00576"></a>00576     <span class="comment">/* requiredDataMask */</span>  <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#aaaab84bec23bf66ef8cb8ae92947ce43">requiredDataMask</a>,
<a name="l00577"></a>00577     <span class="comment">/* freeData */</span>          <a class="code" href="../../d5/dbf/MOD__ocean_8c.html#af2c8b1a155950117e5cd808fb00111dd">freeData</a>,
<a name="l00578"></a>00578     <span class="comment">/* isDisabled */</span>        <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00579"></a>00579     <span class="comment">/* updateDepgraph */</span>    <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00580"></a>00580     <span class="comment">/* dependsOnTime */</span>     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00581"></a>00581     <span class="comment">/* dependsOnNormals */</span>  <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00582"></a>00582     <span class="comment">/* foreachObjectLink */</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00583"></a>00583     <span class="comment">/* foreachIDLink */</span>     <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00584"></a>00584 };
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:33 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
