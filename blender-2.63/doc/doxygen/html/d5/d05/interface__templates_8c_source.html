<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: interface_templates.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">interface_templates.c</div>  </div>
</div>
<div class="contents">
<a href="../../d5/d05/interface__templates_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * Contributor(s): Blender Foundation 2009.</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stddef.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html">DNA_anim_types.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/daf/DNA__dynamicpaint__types_8h.html">DNA_dynamicpaint_types.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d41/DNA__key__types_8h.html">DNA_key_types.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/de4/DNA__userdef__types_8h.html">DNA_userdef_types.h</a>&quot;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/db3/BLI__string_8h.html">BLI_string.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc5/BLI__ghash_8h.html" title="A general (pointer -&gt; pointer) hash table ADT.">BLI_ghash.h</a>&quot;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d61/BLF__translation_8h.html">BLF_translation.h</a>&quot;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d51/BKE__animsys_8h.html">BKE_animsys.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/dca/BKE__colortools_8h.html">BKE_colortools.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/db4/BKE__dynamicpaint_8h.html">BKE_dynamicpaint.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/db1/BKE__library_8h.html">BKE_library.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dac/BKE__object_8h.html" title="General operations, lookup, etc. for blender objects.">BKE_object.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d0f/BKE__material_8h.html" title="General operations, lookup, etc. for materials.">BKE_material.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d66/BKE__texture_8h.html">BKE_texture.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/BKE__report_8h.html">BKE_report.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d12/BKE__displist_8h.html" title="display list (or rather multi purpose list) stuff.">BKE_displist.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d53/BKE__scene_8h.html">BKE_scene.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7a/ED__object_8h.html">ED_object.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d53/ED__render_8h.html">ED_render.h</a>&quot;</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d68/RNA__enum__types_8h.html">RNA_enum_types.h</a>&quot;</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1e/UI__interface_8h.html">UI_interface.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d2f/interface__intern_8h.html">interface_intern.h</a>&quot;</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d5d/BLF__api_8h.html">BLF_api.h</a>&quot;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d61/BLF__translation_8h.html">BLF_translation.h</a>&quot;</span>
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ae4cbbcf833cb78d03e1c347154efded1">00076</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4cbbcf833cb78d03e1c347154efded1">UI_template_fix_linking</a>(<span class="keywordtype">void</span>)
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078 }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="comment">/********************** Header Template *************************/</span>
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ab58c1e54b6e377d1f8a74a508444bc3d">00082</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a19872a993abde9767ad0d00f89325a8b">uiTemplateHeader</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">int</span> menus)
<a name="l00083"></a>00083 {
<a name="l00084"></a>00084     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a3a59f6fe6879fcbf0c65360ebc007c">uiLayoutAbsoluteBlock</a>(layout);
<a name="l00087"></a>00087     <span class="keywordflow">if</span> (menus) <a class="code" href="../../d1/d12/ED__screen_8h.html#a4980aaeed6aa9ad4731dee12540405f0">ED_area_header_standardbuttons</a>(C, block, 0);
<a name="l00088"></a>00088     <span class="keywordflow">else</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#afcb2cb6d479cafc06ae7fe5d58da03cb">ED_area_header_switchbutton</a>(C, block, 0);
<a name="l00089"></a>00089 }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">/********************** Search Callbacks *************************/</span>
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="../../d2/d8c/structTemplateID.html">00093</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> {
<a name="l00094"></a><a class="code" href="../../d2/d8c/structTemplateID.html#ab8a3481df0c006e3ed44a02f02f31d31">00094</a>     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> <a class="code" href="../../d2/d8c/structTemplateID.html#ab8a3481df0c006e3ed44a02f02f31d31">ptr</a>;
<a name="l00095"></a><a class="code" href="../../d2/d8c/structTemplateID.html#a5ff0a6b213a954542f7be7aef039e9e1">00095</a>     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *<a class="code" href="../../d2/d8c/structTemplateID.html#a5ff0a6b213a954542f7be7aef039e9e1">prop</a>;
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="../../d2/d8c/structTemplateID.html#a0f6465fe3affe79ee7facae2c3e3092c">00097</a>     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *<a class="code" href="../../d2/d8c/structTemplateID.html#a0f6465fe3affe79ee7facae2c3e3092c">idlb</a>;
<a name="l00098"></a><a class="code" href="../../d2/d8c/structTemplateID.html#a1a743a39495d13f3900e8bac0aab08b1">00098</a>     <span class="keywordtype">int</span> <a class="code" href="../../d2/d8c/structTemplateID.html#a1a743a39495d13f3900e8bac0aab08b1">prv_rows</a>, <a class="code" href="../../d2/d8c/structTemplateID.html#a00b2f12c31a9808f9795b23de54e8a48">prv_cols</a>;
<a name="l00099"></a><a class="code" href="../../d2/d8c/structTemplateID.html#a939b21bb722b3493e581d05f86836daf">00099</a>     <span class="keywordtype">int</span> <a class="code" href="../../d2/d8c/structTemplateID.html#a939b21bb722b3493e581d05f86836daf">preview</a>;
<a name="l00100"></a>00100 } <a class="code" href="../../d5/d05/interface__templates_8c.html#a95860269bfb11d668da2dfddb65190ed">TemplateID</a>;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="comment">/* Search browse menu, assign  */</span>
<a name="l00103"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a284e32e4d53f0e9e938fc00983d99f24">00103</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a284e32e4d53f0e9e938fc00983d99f24">id_search_call_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *arg_template, <span class="keywordtype">void</span> *item)
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105     <a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *<span class="keyword">template</span> = (<a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *)arg_template;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="comment">/* ID */</span>
<a name="l00108"></a>00108     <span class="keywordflow">if</span> (item) {
<a name="l00109"></a>00109         <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> idptr;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <a class="code" href="../../d3/d10/rna__access_8c.html#a2ce5c1d9b520b00730820e0e118dd4e1">RNA_id_pointer_create</a>(item, &amp;idptr);
<a name="l00112"></a>00112         <a class="code" href="../../d3/d10/rna__access_8c.html#adafe00269e3f01d8a6182040597fd020">RNA_property_pointer_set</a>(&amp;template-&gt;ptr, template-&gt;prop, idptr);
<a name="l00113"></a>00113         <a class="code" href="../../d3/d10/rna__access_8c.html#a5fa7d69c3a73312275e1e6d20baf3bc6">RNA_property_update</a>(C, &amp;template-&gt;ptr, template-&gt;prop);
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115 }
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="comment">/* ID Search browse menu, do the search */</span>
<a name="l00118"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a315f1aef762b0d15fe88d6aad92c85f6">00118</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a315f1aef762b0d15fe88d6aad92c85f6">id_search_cb</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *arg_template, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../d8/dbb/structuiSearchItems.html">uiSearchItems</a> *items)
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120     <a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *<span class="keyword">template</span> = (<a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *)arg_template;
<a name="l00121"></a>00121     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb = <span class="keyword">template</span>-&gt;idlb;
<a name="l00122"></a>00122     <a class="code" href="../../d8/d7e/structID.html">ID</a> *id, *id_from = <span class="keyword">template</span>-&gt;ptr.id.data;
<a name="l00123"></a>00123     <span class="keywordtype">int</span> iconid;
<a name="l00124"></a>00124     <span class="keywordtype">int</span> flag = <a class="code" href="../../d3/d10/rna__access_8c.html#a977a3c85a8d6d0a8b126e99a4955c634">RNA_property_flag</a>(template-&gt;prop);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <span class="comment">/* ID listbase */</span>
<a name="l00127"></a>00127     <span class="keywordflow">for</span> (<span class="keywordtype">id</span> = lb-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="keywordtype">id</span>; <span class="keywordtype">id</span> = id-&gt;<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00128"></a>00128         <span class="keywordflow">if</span> (!((flag &amp; <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ac567a4814345fecbf94eed28cf694853">PROP_ID_SELF_CHECK</a>) &amp;&amp; <span class="keywordtype">id</span> == id_from)) {
<a name="l00129"></a>00129 
<a name="l00130"></a>00130             <span class="comment">/* use filter */</span>
<a name="l00131"></a>00131             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(template-&gt;prop) == <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>) {
<a name="l00132"></a>00132                 <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l00133"></a>00133                 <a class="code" href="../../d3/d10/rna__access_8c.html#a2ce5c1d9b520b00730820e0e118dd4e1">RNA_id_pointer_create</a>(<span class="keywordtype">id</span>, &amp;ptr);
<a name="l00134"></a>00134                 <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#aa28e8b2ec2618f5ac44ab21937179ce3">RNA_property_pointer_poll</a>(&amp;template-&gt;ptr, template-&gt;prop, &amp;ptr) == 0)
<a name="l00135"></a>00135                     <span class="keywordflow">continue</span>;
<a name="l00136"></a>00136             }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138             <span class="comment">/* hide dot-datablocks, but only if filter does not force it visible */</span>
<a name="l00139"></a>00139             <span class="keywordflow">if</span> (<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.uiflag &amp; <a class="code" href="../../d7/de4/DNA__userdef__types_8h.html#ae924399a516de28bfa32c298640184cc">USER_HIDE_DOT</a>)
<a name="l00140"></a>00140                 <span class="keywordflow">if</span> ((id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>[2] == <span class="charliteral">&#39;.&#39;</span>) &amp;&amp; (str[0] != <span class="charliteral">&#39;.&#39;</span>))
<a name="l00141"></a>00141                     <span class="keywordflow">continue</span>;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143             <span class="keywordflow">if</span> (<a class="code" href="../../d3/db3/BLI__string_8h.html#acea342f9e36a26e2d404b1ada16f2b7a">BLI_strcasestr</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2, str)) {
<a name="l00144"></a>00144                 <span class="keywordtype">char</span> name_ui[<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a6d7bce2e9ad79af316c9690a5b84b75c">MAX_ID_NAME</a>];
<a name="l00145"></a>00145                 <a class="code" href="../../d8/db1/BKE__library_8h.html#a9c5a57b3a573374228102ae296d1ed43">name_uiprefix_id</a>(name_ui, <span class="keywordtype">id</span>);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147                 iconid = <a class="code" href="../../de/d28/interface__icons_8c.html#ab373f2d8c3db8560b85cd9b250982c33">ui_id_icon_get</a>((<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *)C, <span class="keywordtype">id</span>, template-&gt;preview);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149                 <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d1e/UI__interface_8h.html#a54841b6e4f540fcffd11d692e278a605">uiSearchItemAdd</a>(items, name_ui, <span class="keywordtype">id</span>, iconid))
<a name="l00150"></a>00150                     <span class="keywordflow">break</span>;
<a name="l00151"></a>00151             }
<a name="l00152"></a>00152         }
<a name="l00153"></a>00153     }
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 <span class="comment">/* ID Search browse menu, open */</span>
<a name="l00157"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a8813672b9eac6b353c242abc0caf8d8a">00157</a> <span class="keyword">static</span> <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *<a class="code" href="../../d5/d05/interface__templates_8c.html#a8813672b9eac6b353c242abc0caf8d8a">id_search_menu</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <span class="keywordtype">void</span> *arg_litem)
<a name="l00158"></a>00158 {
<a name="l00159"></a>00159     <span class="keyword">static</span> <span class="keywordtype">char</span> search[256];
<a name="l00160"></a>00160     <span class="keyword">static</span> <a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> <span class="keyword">template</span>;
<a name="l00161"></a>00161     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> idptr;
<a name="l00162"></a>00162     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win = <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C);
<a name="l00163"></a>00163     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l00164"></a>00164     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l00165"></a>00165     
<a name="l00166"></a>00166     <span class="comment">/* clear initial search string, then all items show */</span>
<a name="l00167"></a>00167     search[0] = 0;
<a name="l00168"></a>00168     <span class="comment">/* arg_litem is malloced, can be freed by parent button */</span>
<a name="l00169"></a>00169     <span class="keyword">template</span> = *((<a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *)arg_litem);
<a name="l00170"></a>00170     
<a name="l00171"></a>00171     <span class="comment">/* get active id for showing first item */</span>
<a name="l00172"></a>00172     idptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(&amp;<span class="keyword">template</span>.ptr, <span class="keyword">template</span>.prop);
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8bb41a5814e5120ba3c694cb35667128">uiBeginBlock</a>(C, ar, <span class="stringliteral">&quot;_popup&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l00175"></a>00175     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a619156a060c8092bf92b629660cbcc8e">uiBlockSetFlag</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a85cfd29a5959ab2b2fcc578bcbe6ef3c">UI_BLOCK_LOOP</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#af713453f64d2cd265b458ef9735e89d2">UI_BLOCK_REDRAW</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab829d5fb0e0e927effd6a779dafee967">UI_BLOCK_RET_1</a>);
<a name="l00176"></a>00176     
<a name="l00177"></a>00177     <span class="comment">/* preview thumbnails */</span>
<a name="l00178"></a>00178     <span class="keywordflow">if</span> (<span class="keyword">template</span>.prv_rows &gt; 0 &amp;&amp; <span class="keyword">template</span>.prv_cols &gt; 0) {
<a name="l00179"></a>00179         <span class="keywordtype">int</span> w = 96 * <span class="keyword">template</span>.prv_cols;
<a name="l00180"></a>00180         <span class="keywordtype">int</span> h = 96 * <span class="keyword">template</span>.prv_rows + 20;
<a name="l00181"></a>00181         
<a name="l00182"></a>00182         <span class="comment">/* fake button, it holds space for search items */</span>
<a name="l00183"></a>00183         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a0b7df70d4a086a227bc482b07e2bbbca">LABEL</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 10, 15, w, h, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00184"></a>00184         
<a name="l00185"></a>00185         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a15503b211bb301ff0fb2901c98740fcb">uiDefSearchBut</a>(block, search, 0, ICON_VIEWZOOM, <span class="keyword">sizeof</span>(search), 10, 0, w, 19, <span class="keyword">template</span>.prv_rows, <span class="keyword">template</span>.prv_cols, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00186"></a>00186         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a977047e0bf7e7ef5e6f26591ff8a53c9">uiButSetSearchFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#a315f1aef762b0d15fe88d6aad92c85f6">id_search_cb</a>, &amp;<span class="keyword">template</span>, <a class="code" href="../../d5/d05/interface__templates_8c.html#a284e32e4d53f0e9e938fc00983d99f24">id_search_call_cb</a>, idptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>);
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188     <span class="comment">/* list view */</span>
<a name="l00189"></a>00189     <span class="keywordflow">else</span> {
<a name="l00190"></a>00190         <span class="comment">/* fake button, it holds space for search items */</span>
<a name="l00191"></a>00191         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a0b7df70d4a086a227bc482b07e2bbbca">LABEL</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 10, 15, 150, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a449d97c143dffc7ad934756450eec63b">uiSearchBoxhHeight</a>(), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00192"></a>00192         
<a name="l00193"></a>00193         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a15503b211bb301ff0fb2901c98740fcb">uiDefSearchBut</a>(block, search, 0, ICON_VIEWZOOM, <span class="keyword">sizeof</span>(search), 10, 0, 150, 19, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00194"></a>00194         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a977047e0bf7e7ef5e6f26591ff8a53c9">uiButSetSearchFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#a315f1aef762b0d15fe88d6aad92c85f6">id_search_cb</a>, &amp;<span class="keyword">template</span>, <a class="code" href="../../d5/d05/interface__templates_8c.html#a284e32e4d53f0e9e938fc00983d99f24">id_search_call_cb</a>, idptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>);
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196         
<a name="l00197"></a>00197     
<a name="l00198"></a>00198     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a47d93c92ea07aa2fe68112a07a9f7aeb">uiBoundsBlock</a>(block, 6);
<a name="l00199"></a>00199     <a class="code" href="../../d8/d1e/UI__interface_8h.html#af0d71fa48a234ba4cb707b670455c913">uiBlockSetDirection</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#af8fb6027b0166761cb524a88fa0a7231">UI_DOWN</a>);    
<a name="l00200"></a>00200     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ac166273cd2c217e8b1da1bdac55a8ef8">uiEndBlock</a>(C, block);
<a name="l00201"></a>00201     
<a name="l00202"></a>00202     <span class="comment">/* give search-field focus */</span>
<a name="l00203"></a>00203     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a19e859713e6f41f2daab9942f0f645c8">uiButSetFocusOnEnter</a>(win, but);
<a name="l00204"></a>00204     <span class="comment">/* this type of search menu requires undo */</span>
<a name="l00205"></a>00205     but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a23817cfadf5bb0c6ec9bc28eeffc1368">flag</a> |= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a43152cd15e4d019a8ee2aeeeeafb0c98">UI_BUT_UNDO</a>;
<a name="l00206"></a>00206     
<a name="l00207"></a>00207     <span class="keywordflow">return</span> block;
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 <span class="comment">/************************ ID Template ***************************/</span>
<a name="l00211"></a>00211 <span class="comment">/* This is for browsing and editing the ID-blocks used */</span>
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 <span class="comment">/* for new/open operators */</span>
<a name="l00214"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#af994a54a23ed04954a6148238777bc8c">00214</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6bfd6ea66a2b01a45cc660c37585a58f">uiIDContextProperty</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> **prop)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216     <a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *<span class="keyword">template</span>;
<a name="l00217"></a>00217     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00218"></a>00218     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l00219"></a>00219     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     memset(ptr, 0, <span class="keyword">sizeof</span>(*ptr));
<a name="l00222"></a>00222     *prop = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224     <span class="keywordflow">if</span> (!ar)
<a name="l00225"></a>00225         <span class="keywordflow">return</span>;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     <span class="keywordflow">for</span> (block = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#afbd94c7a138066b4e773e9d3401b0d87">uiblocks</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; block; block = block-&gt;<a class="code" href="../../df/d5b/structuiBlock.html#a22b70a2cbc7345c42bf46c8e6dab6eb9">next</a>) {
<a name="l00228"></a>00228         <span class="keywordflow">for</span> (but = block-&gt;<a class="code" href="../../df/d5b/structuiBlock.html#a844299999568743bc189fcb02847e9e6">buttons</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; but; but = but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a115d85d61bc4c6fd0756320cb94f554e">next</a>) {
<a name="l00229"></a>00229             <span class="comment">/* find the button before the active one */</span>
<a name="l00230"></a>00230             <span class="keywordflow">if</span> ((but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a23817cfadf5bb0c6ec9bc28eeffc1368">flag</a> &amp; (<a class="code" href="../../d8/d1e/UI__interface_8h.html#aef8670638990f3f60d1c71ee4b120468">UI_BUT_LAST_ACTIVE</a> | <a class="code" href="../../d1/d2f/interface__intern_8h.html#a79b3f8d716499489d309feda1a3eaa43">UI_ACTIVE</a>))) {
<a name="l00231"></a>00231                 <span class="keywordflow">if</span> (but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#af44dd4115db2000459a0ffc72a9bc092">func_argN</a>) {
<a name="l00232"></a>00232                     <span class="keyword">template</span> = but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#af44dd4115db2000459a0ffc72a9bc092">func_argN</a>;
<a name="l00233"></a>00233                     *ptr = <span class="keyword">template</span>-&gt;ptr;
<a name="l00234"></a>00234                     *prop = <span class="keyword">template</span>-&gt;prop;
<a name="l00235"></a>00235                     <span class="keywordflow">return</span>;
<a name="l00236"></a>00236                 }
<a name="l00237"></a>00237             }
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240 }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 
<a name="l00243"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">00243</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *arg_litem, <span class="keywordtype">void</span> *arg_event)
<a name="l00244"></a>00244 {
<a name="l00245"></a>00245     <a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *<span class="keyword">template</span> = (<a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *)arg_litem;
<a name="l00246"></a>00246     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> idptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(&amp;template-&gt;ptr, template-&gt;prop);
<a name="l00247"></a>00247     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = idptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l00248"></a>00248     <span class="keywordtype">int</span> event = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#afe52e69b7f74d4e0319b467db917c08c">GET_INT_FROM_POINTER</a>(arg_event);
<a name="l00249"></a>00249     
<a name="l00250"></a>00250     <span class="keywordflow">switch</span> (event) {
<a name="l00251"></a>00251         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab5bc6f64692cb2512607a41cdf8b71c6">UI_ID_BROWSE</a>:
<a name="l00252"></a>00252         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a747700f697f710e7f1909b147d9af67c">UI_ID_PIN</a>:
<a name="l00253"></a>00253             <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;warning, id event %d shouldnt come here&quot;</span>, event);
<a name="l00254"></a>00254             <span class="keywordflow">break</span>;
<a name="l00255"></a>00255         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#aced6daa31c6105137d189f60a26d27a0">UI_ID_OPEN</a>:
<a name="l00256"></a>00256         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a0f819c3c730906a8fa600634441850d4">UI_ID_ADD_NEW</a>:
<a name="l00257"></a>00257             <span class="comment">/* these call uiIDContextPropertySet */</span>
<a name="l00258"></a>00258             <span class="keywordflow">break</span>;
<a name="l00259"></a>00259         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a939da80a9dca8951bf7350afe8744c68">UI_ID_DELETE</a>:
<a name="l00260"></a>00260             memset(&amp;idptr, 0, <span class="keyword">sizeof</span>(idptr));
<a name="l00261"></a>00261             <a class="code" href="../../d3/d10/rna__access_8c.html#adafe00269e3f01d8a6182040597fd020">RNA_property_pointer_set</a>(&amp;template-&gt;ptr, template-&gt;prop, idptr);
<a name="l00262"></a>00262             <a class="code" href="../../d3/d10/rna__access_8c.html#a5fa7d69c3a73312275e1e6d20baf3bc6">RNA_property_update</a>(C, &amp;template-&gt;ptr, template-&gt;prop);
<a name="l00263"></a>00263 
<a name="l00264"></a>00264             <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &amp;&amp; <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)-&gt;eventstate-&gt;shift) <span class="comment">/* useful hidden functionality, */</span>
<a name="l00265"></a>00265                 <span class="keywordtype">id</span>-&gt;us = 0;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267             <span class="keywordflow">break</span>;
<a name="l00268"></a>00268         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a17735a0280ba27f2cd238b870af0d9e3">UI_ID_FAKE_USER</a>:
<a name="l00269"></a>00269             <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l00270"></a>00270                 <span class="keywordflow">if</span> (id-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp; <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac7a490f7c486f67fa46961f920fc8e26">LIB_FAKEUSER</a>) <a class="code" href="../../d8/db1/BKE__library_8h.html#a967d1ceef29b2612ef6e03194c512ad6">id_us_plus</a>(<span class="keywordtype">id</span>);
<a name="l00271"></a>00271                 <span class="keywordflow">else</span> <a class="code" href="../../d8/db1/BKE__library_8h.html#a2caead3c3bda9441d1a4affbbe0d328b">id_us_min</a>(<span class="keywordtype">id</span>);
<a name="l00272"></a>00272             }
<a name="l00273"></a>00273             <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
<a name="l00274"></a>00274             <span class="keywordflow">break</span>;
<a name="l00275"></a>00275         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a2f101d59e7f9cd8faa1fec0bd66c80e2">UI_ID_LOCAL</a>:
<a name="l00276"></a>00276             <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l00277"></a>00277                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/db1/BKE__library_8h.html#aa39db829246321d923eefd92d56b29e6">id_make_local</a>(<span class="keywordtype">id</span>, 0)) {
<a name="l00278"></a>00278                     <span class="comment">/* reassign to get get proper updates/notifiers */</span>
<a name="l00279"></a>00279                     idptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(&amp;template-&gt;ptr, template-&gt;prop);
<a name="l00280"></a>00280                     <a class="code" href="../../d3/d10/rna__access_8c.html#adafe00269e3f01d8a6182040597fd020">RNA_property_pointer_set</a>(&amp;template-&gt;ptr, template-&gt;prop, idptr);
<a name="l00281"></a>00281                     <a class="code" href="../../d3/d10/rna__access_8c.html#a5fa7d69c3a73312275e1e6d20baf3bc6">RNA_property_update</a>(C, &amp;template-&gt;ptr, template-&gt;prop);
<a name="l00282"></a>00282                 }
<a name="l00283"></a>00283             }
<a name="l00284"></a>00284             <span class="keywordflow">break</span>;
<a name="l00285"></a>00285         <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff47337cb8fa9007f699b498e3b34bf2">UI_ID_ALONE</a>:
<a name="l00286"></a>00286             <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l00287"></a>00287                 <span class="keyword">const</span> <span class="keywordtype">int</span> do_scene_obj = (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) &amp;&amp;
<a name="l00288"></a>00288                                          (template-&gt;ptr.type == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#adac527fd7d3668a48de5995ffe09fc80">RNA_SceneObjects</a>);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290                 <span class="comment">/* make copy */</span>
<a name="l00291"></a>00291                 <span class="keywordflow">if</span> (do_scene_obj) {
<a name="l00292"></a>00292                     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00293"></a>00293                     <a class="code" href="../../da/d7a/ED__object_8h.html#a2c0c36df376ad772ce87eb015ae42fde">ED_object_single_user</a>(scene, (<span class="keyword">struct</span> <a class="code" href="../../de/de7/structObject.html">Object</a> *)<span class="keywordtype">id</span>);
<a name="l00294"></a>00294                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a2072407a0c536bf373bd0b6b7c159c5c">ND_OB_ACTIVE</a>, scene);
<a name="l00295"></a>00295                 }
<a name="l00296"></a>00296                 <span class="keywordflow">else</span> {
<a name="l00297"></a>00297                     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l00298"></a>00298                         <a class="code" href="../../d8/db1/BKE__library_8h.html#a4d786d1f0b083fc9679d4801725f0ae4">id_single_user</a>(C, <span class="keywordtype">id</span>, &amp;template-&gt;ptr, template-&gt;prop);
<a name="l00299"></a>00299                     }
<a name="l00300"></a>00300                 }
<a name="l00301"></a>00301             }
<a name="l00302"></a>00302             <span class="keywordflow">break</span>;
<a name="l00303"></a>00303 <span class="preprocessor">#if 0</span>
<a name="l00304"></a>00304 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#abddcac7afd7738ffd8942cb6c1b13b03">UI_ID_AUTO_NAME</a>:
<a name="l00305"></a>00305             <span class="keywordflow">break</span>;
<a name="l00306"></a>00306 <span class="preprocessor">#endif</span>
<a name="l00307"></a>00307 <span class="preprocessor"></span>    }
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 
<a name="l00310"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#afe8a80f00d9e21b0b4f3aaa987486b03">00310</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d05/interface__templates_8c.html#afe8a80f00d9e21b0b4f3aaa987486b03">template_id_browse_tip</a>(<a class="code" href="../../d5/d61/structStructRNA.html">StructRNA</a> *type)
<a name="l00311"></a>00311 {
<a name="l00312"></a>00312     <span class="keywordflow">if</span> (type) {
<a name="l00313"></a>00313         <span class="keywordflow">switch</span> (<a class="code" href="../../de/ddf/RNA__access_8h.html#ae73e191d4ec876451be218ad79e96eea">RNA_type_to_ID_code</a>(type)) {
<a name="l00314"></a>00314             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac2b425dbd1f73ad1720fafad2626d974">ID_SCE</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Scene to be linked&quot;</span>);
<a name="l00315"></a>00315             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Object to be linked&quot;</span>);
<a name="l00316"></a>00316             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a2e6c796d1f9370e5fd552166098cdd27">ID_ME</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Mesh Data to be linked&quot;</span>);
<a name="l00317"></a>00317             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ace150506eaf644d92a5110cf45978379">ID_CU</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Curve Data to be linked&quot;</span>);
<a name="l00318"></a>00318             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a3e4005eef9876a2cb9d799bdb2a43998">ID_MB</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Metaball Data to be linked&quot;</span>);
<a name="l00319"></a>00319             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Material to be linked&quot;</span>);
<a name="l00320"></a>00320             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Texture to be linked&quot;</span>);
<a name="l00321"></a>00321             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a564eac75543b047cf8b2b759818529c3">ID_IM</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Image to be linked&quot;</span>);
<a name="l00322"></a>00322             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ad058b07954b2795eadc855a7a354578b">ID_LT</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Lattice Data to be linked&quot;</span>);
<a name="l00323"></a>00323             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Lamp Data to be linked&quot;</span>);
<a name="l00324"></a>00324             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82bdb2fdea7abee55d993c0210101273">ID_CA</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Camera Data to be linked&quot;</span>);
<a name="l00325"></a>00325             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse World Settings to be linked&quot;</span>);
<a name="l00326"></a>00326             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ad177ecff9697780942b6ff5576c153e9">ID_SCR</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Choose Screen lay-out&quot;</span>);
<a name="l00327"></a>00327             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aedc19b629c5c0b30dd7697cd4ac4dc20">ID_TXT</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Text to be linked&quot;</span>);
<a name="l00328"></a>00328             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a0cd81e8a0b1724426ed2d1e36218cdf6">ID_SPK</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Speaker Data to be linked&quot;</span>);
<a name="l00329"></a>00329             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a3bae74282a62fb44842ff3767a86ec70">ID_SO</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Sound to be linked&quot;</span>);
<a name="l00330"></a>00330             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ae4ba19f70b08895557ef00b489e7d255">ID_AR</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Armature data to be linked&quot;</span>);
<a name="l00331"></a>00331             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a20fe08f8d0b2a4e6c0dbb2371aacadb0">ID_AC</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Action to be linked&quot;</span>);
<a name="l00332"></a>00332             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a6e5ed4060f73b0f46e66af2dbef9dd2a">ID_NT</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Node Tree to be linked&quot;</span>);
<a name="l00333"></a>00333             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac7f2ccbf688d8c6763420cb2fe028e5a">ID_BR</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Brush to be linked&quot;</span>);
<a name="l00334"></a>00334             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa64d54c8b860f4a2c7cabc743f60512e">ID_PA</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Particle System to be linked&quot;</span>);
<a name="l00335"></a>00335             <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a2df65579fd9eb1398862a7e915de5dc2">ID_GD</a>: <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse Grease Pencil Data to be linked&quot;</span>);
<a name="l00336"></a>00336         }
<a name="l00337"></a>00337     }
<a name="l00338"></a>00338     <span class="keywordflow">return</span> <a class="code" href="../../d6/d61/BLF__translation_8h.html#abdf0847bd8caa2c2247f5d9bc5e12982">N_</a>(<span class="stringliteral">&quot;Browse ID data to be linked&quot;</span>);
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ad59388a481a0c3bcc61e59b2f621e834">00341</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ad59388a481a0c3bcc61e59b2f621e834">template_ID</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *<span class="keyword">template</span>, <a class="code" href="../../d5/d61/structStructRNA.html">StructRNA</a> *type, <span class="keywordtype">short</span> idcode, <span class="keywordtype">int</span> flag, <span class="keyword">const</span> <span class="keywordtype">char</span> *newop, <span class="keyword">const</span> <span class="keywordtype">char</span> *openop, <span class="keyword">const</span> <span class="keywordtype">char</span> *unlinkop)
<a name="l00342"></a>00342 {
<a name="l00343"></a>00343     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l00344"></a>00344     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l00345"></a>00345     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> idptr;
<a name="l00346"></a>00346     <span class="comment">// ListBase *lb; // UNUSED</span>
<a name="l00347"></a>00347     <a class="code" href="../../d8/d7e/structID.html">ID</a> *id, *idfrom;
<a name="l00348"></a>00348     <span class="keywordtype">int</span> editable = <a class="code" href="../../d3/d10/rna__access_8c.html#a7b96714575f85b97b8f19e9acfbbd777">RNA_property_editable</a>(&amp;template-&gt;ptr, template-&gt;prop);
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     idptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(&amp;template-&gt;ptr, template-&gt;prop);
<a name="l00351"></a>00351     <span class="keywordtype">id</span> = idptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l00352"></a>00352     idfrom = <span class="keyword">template</span>-&gt;ptr.id.data;
<a name="l00353"></a>00353     <span class="comment">// lb= template-&gt;idlb;</span>
<a name="l00354"></a>00354 
<a name="l00355"></a>00355     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l00356"></a>00356     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4c674e4e473631554c7372d8c6cb36e">uiBlockBeginAlign</a>(block);
<a name="l00357"></a>00357 
<a name="l00358"></a>00358     <span class="keywordflow">if</span> (idptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>)
<a name="l00359"></a>00359         type = idptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361     <span class="keywordflow">if</span> (flag &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#aea0ae5167e3b0815b28bdc3096f90eb8">UI_ID_PREVIEWS</a>) {
<a name="l00362"></a>00362 
<a name="l00363"></a>00363         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a440904979372d28db8908072c2db4668">uiDefBlockButN</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a8813672b9eac6b353c242abc0caf8d8a">id_search_menu</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 6, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> * 6,
<a name="l00364"></a>00364                              <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<a class="code" href="../../d5/d05/interface__templates_8c.html#afe8a80f00d9e21b0b4f3aaa987486b03">template_id_browse_tip</a>(type)));
<a name="l00365"></a>00365         <span class="keywordflow">if</span> (type) {
<a name="l00366"></a>00366             but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#abb0eba9aee4e0fc4169591b35fabddf8">icon</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a5a07a8315a1b6d5b30bbca822db7195c">RNA_struct_ui_icon</a>(type);
<a name="l00367"></a>00367             <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#abb0eba9aee4e0fc4169591b35fabddf8">icon</a> = <a class="code" href="../../de/d28/interface__icons_8c.html#ab373f2d8c3db8560b85cd9b250982c33">ui_id_icon_get</a>(C, <span class="keywordtype">id</span>, 1);
<a name="l00368"></a>00368             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d1/d2f/interface__intern_8h.html#a08b9b7257aea77e3235d4c3df26f66e7">UI_HAS_ICON</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#adcedc6b8c6a8d8bb46d4fc9e8c20d4eb">UI_ICON_PREVIEW</a>);
<a name="l00369"></a>00369         }
<a name="l00370"></a>00370         <span class="keywordflow">if</span> ((idfrom &amp;&amp; idfrom-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) || !editable)
<a name="l00371"></a>00371             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00372"></a>00372         
<a name="l00373"></a>00373         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 1);
<a name="l00374"></a>00374         <span class="keyword">template</span>-&gt;preview = 1;
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flag &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab5bc6f64692cb2512607a41cdf8b71c6">UI_ID_BROWSE</a>) {
<a name="l00377"></a>00377         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a440904979372d28db8908072c2db4668">uiDefBlockButN</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a8813672b9eac6b353c242abc0caf8d8a">id_search_menu</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 1.6, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>,
<a name="l00378"></a>00378                              <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<a class="code" href="../../d5/d05/interface__templates_8c.html#afe8a80f00d9e21b0b4f3aaa987486b03">template_id_browse_tip</a>(type)));
<a name="l00379"></a>00379         <span class="keywordflow">if</span> (type) {
<a name="l00380"></a>00380             but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#abb0eba9aee4e0fc4169591b35fabddf8">icon</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a5a07a8315a1b6d5b30bbca822db7195c">RNA_struct_ui_icon</a>(type);
<a name="l00381"></a>00381             <span class="comment">/* default dragging of icon for id browse buttons */</span>
<a name="l00382"></a>00382             <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab2ffbb3cfe6997f0b21aa8cdc4d80995">uiButSetDragID</a>(but, <span class="keywordtype">id</span>);
<a name="l00383"></a>00383             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d1/d2f/interface__intern_8h.html#a08b9b7257aea77e3235d4c3df26f66e7">UI_HAS_ICON</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae7e246c45ab949219c4497c2ba1b6763">UI_ICON_LEFT</a>);
<a name="l00384"></a>00384         }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386         <span class="keywordflow">if</span> ((idfrom &amp;&amp; idfrom-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) || !editable)
<a name="l00387"></a>00387             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00388"></a>00388     }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="comment">/* text button with name */</span>
<a name="l00391"></a>00391     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l00392"></a>00392         <span class="keywordtype">char</span> name[<a class="code" href="../../d8/d1e/UI__interface_8h.html#add15eab7eae8baf93524951b6df38dd5">UI_MAX_NAME_STR</a>];
<a name="l00393"></a>00393         <span class="keyword">const</span> <span class="keywordtype">short</span> user_alert = (<span class="keywordtype">id</span>-&gt;us &lt;= 0);
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         <span class="comment">//text_idbutton(id, name);</span>
<a name="l00396"></a>00396         name[0] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00397"></a>00397         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab7f2f1d4c87c6811aea6150dfe23b2e7">uiDefButR</a>(block, <a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9ba24e799bd38fe08efb4756c63d8f78df9">TEX</a>, 0, name, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 6, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;idptr, <span class="stringliteral">&quot;name&quot;</span>, -1, 0, 0, -1, -1, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00398"></a>00398         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#a48c807dd3396d0fa240d7bcce2b364d1">UI_ID_RENAME</a>));
<a name="l00399"></a>00399         <span class="keywordflow">if</span> (user_alert) <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#afea08908c7b21b45842f47d0160d18e9">UI_BUT_REDALERT</a>);
<a name="l00400"></a>00400 
<a name="l00401"></a>00401         <span class="keywordflow">if</span> (id-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) {
<a name="l00402"></a>00402             <span class="keywordflow">if</span> (id-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp; <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ab205643c2c50ad2f8b3555a5d2314924">LIB_INDIRECT</a>) {
<a name="l00403"></a>00403                 but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_LIBRARY_DATA_INDIRECT, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l00404"></a>00404                                    <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Indirect library datablock, cannot change&quot;</span>));
<a name="l00405"></a>00405                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00406"></a>00406             }
<a name="l00407"></a>00407             <span class="keywordflow">else</span> {
<a name="l00408"></a>00408                 but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_LIBRARY_DATA_DIRECT, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l00409"></a>00409                                    <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Direct linked library datablock, click to make local&quot;</span>));
<a name="l00410"></a>00410                 <span class="keywordflow">if</span> (!<a class="code" href="../../d8/db1/BKE__library_8h.html#aa39db829246321d923eefd92d56b29e6">id_make_local</a>(<span class="keywordtype">id</span>, 1 <span class="comment">/* test */</span>) || (idfrom &amp;&amp; idfrom-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>))
<a name="l00411"></a>00411                     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00412"></a>00412             }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#a2f101d59e7f9cd8faa1fec0bd66c80e2">UI_ID_LOCAL</a>));
<a name="l00415"></a>00415         }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417         <span class="keywordflow">if</span> (id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a> &gt; 1) {
<a name="l00418"></a>00418             <span class="keywordtype">char</span> numstr[32];
<a name="l00419"></a>00419 
<a name="l00420"></a>00420             <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(numstr, <span class="keyword">sizeof</span>(numstr), <span class="stringliteral">&quot;%d&quot;</span>, id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, numstr, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> + ((id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a> &lt; 10) ? 0 : 10), <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l00423"></a>00423                            <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Display number of users of this data (click to make a single-user copy)&quot;</span>));
<a name="l00424"></a>00424 
<a name="l00425"></a>00425             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#aff47337cb8fa9007f699b498e3b34bf2">UI_ID_ALONE</a>));
<a name="l00426"></a>00426             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/db1/BKE__library_8h.html#a1d4fff892fca50b4c7315d381c53d381">id_copy</a>(<span class="keywordtype">id</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1 <span class="comment">/* test only */</span>) || (idfrom &amp;&amp; idfrom-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) || !editable)
<a name="l00427"></a>00427                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429     
<a name="l00430"></a>00430         <span class="keywordflow">if</span> (user_alert) <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#afea08908c7b21b45842f47d0160d18e9">UI_BUT_REDALERT</a>);
<a name="l00431"></a>00431         
<a name="l00432"></a>00432         <span class="keywordflow">if</span> (id-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; !(<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a94fe4335845faafd0b969e89a13d8c76">ELEM5</a>(<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>), <a class="code" href="../../d3/dfb/DNA__ID_8h.html#afc8c3d5178b4130eee3e7542ef0dcae7">ID_GR</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac2b425dbd1f73ad1720fafad2626d974">ID_SCE</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ad177ecff9697780942b6ff5576c153e9">ID_SCR</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aedc19b629c5c0b30dd7697cd4ac4dc20">ID_TXT</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>))) {
<a name="l00433"></a>00433             <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab7f2f1d4c87c6811aea6150dfe23b2e7">uiDefButR</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>, 0, <span class="stringliteral">&quot;F&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;idptr, <span class="stringliteral">&quot;use_fake_user&quot;</span>, -1, 0, 0, -1, -1, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00434"></a>00434         }
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436     
<a name="l00437"></a>00437     <span class="keywordflow">if</span> (flag &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#a0f819c3c730906a8fa600634441850d4">UI_ID_ADD_NEW</a>) {
<a name="l00438"></a>00438         <span class="keywordtype">int</span> w = <span class="keywordtype">id</span> ? <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> : (flag &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#aced6daa31c6105137d189f60a26d27a0">UI_ID_OPEN</a>) ? <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 3 : <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 6;
<a name="l00439"></a>00439         
<a name="l00440"></a>00440         <span class="keywordflow">if</span> (newop) {
<a name="l00441"></a>00441             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1b817b8c6ec6c006863ac2e754684cee">uiDefIconTextButO</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, newop, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ab5a7f40e5e55a912d974ab5224a0fa15">WM_OP_INVOKE_DEFAULT</a>, ICON_ZOOMIN, (<span class="keywordtype">id</span>) ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;New&quot;</span>), 0, 0, w, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00442"></a>00442             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(UI_ID_ADD_NEW));
<a name="l00443"></a>00443         }
<a name="l00444"></a>00444         <span class="keywordflow">else</span> {
<a name="l00445"></a>00445             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_ZOOMIN, (<span class="keywordtype">id</span>) ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;New&quot;</span>), 0, 0, w, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00446"></a>00446             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(UI_ID_ADD_NEW));
<a name="l00447"></a>00447         }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449         <span class="keywordflow">if</span> ((idfrom &amp;&amp; idfrom-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) || !editable)
<a name="l00450"></a>00450             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00451"></a>00451     }
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keywordflow">if</span> (flag &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#aced6daa31c6105137d189f60a26d27a0">UI_ID_OPEN</a>) {
<a name="l00454"></a>00454         <span class="keywordtype">int</span> w = <span class="keywordtype">id</span> ? <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> : (flag &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#a0f819c3c730906a8fa600634441850d4">UI_ID_ADD_NEW</a>) ? <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 3 : <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 6;
<a name="l00455"></a>00455         
<a name="l00456"></a>00456         <span class="keywordflow">if</span> (openop) {
<a name="l00457"></a>00457             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1b817b8c6ec6c006863ac2e754684cee">uiDefIconTextButO</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, openop, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ab5a7f40e5e55a912d974ab5224a0fa15">WM_OP_INVOKE_DEFAULT</a>, ICON_FILESEL, (<span class="keywordtype">id</span>) ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Open&quot;</span>), 0, 0, w, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00458"></a>00458             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(UI_ID_OPEN));
<a name="l00459"></a>00459         }
<a name="l00460"></a>00460         <span class="keywordflow">else</span> {
<a name="l00461"></a>00461             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_FILESEL, (<span class="keywordtype">id</span>) ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Open&quot;</span>), 0, 0, w, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00462"></a>00462             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(UI_ID_OPEN));
<a name="l00463"></a>00463         }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465         <span class="keywordflow">if</span> ((idfrom &amp;&amp; idfrom-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) || !editable)
<a name="l00466"></a>00466             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468     
<a name="l00469"></a>00469     <span class="comment">/* delete button */</span>
<a name="l00470"></a>00470     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &amp;&amp; (flag &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#a939da80a9dca8951bf7350afe8744c68">UI_ID_DELETE</a>) &amp;&amp; (<a class="code" href="../../d3/d10/rna__access_8c.html#a977a3c85a8d6d0a8b126e99a4955c634">RNA_property_flag</a>(template-&gt;prop) &amp; <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411a378eb11209555974f2a82004881b36a5">PROP_NEVER_UNLINK</a>) == 0) {
<a name="l00471"></a>00471         <span class="keywordflow">if</span> (unlinkop) {
<a name="l00472"></a>00472             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab77845284cea887b0abaa904c4b4b6c4">uiDefIconButO</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, unlinkop, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, ICON_X, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00473"></a>00473             <span class="comment">/* so we can access the template from operators, font unlinking needs this */</span>
<a name="l00474"></a>00474             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00475"></a>00475         }
<a name="l00476"></a>00476         <span class="keywordflow">else</span> {
<a name="l00477"></a>00477             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_X, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l00478"></a>00478                                <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Unlink datablock. Shift + Click to set users to zero, data will then not be saved&quot;</span>));
<a name="l00479"></a>00479             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#ac323872ee41bfb314d0c8c5a5382f4d9">template_id_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(<span class="keyword">template</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(UI_ID_DELETE));
<a name="l00480"></a>00480 
<a name="l00481"></a>00481             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a977a3c85a8d6d0a8b126e99a4955c634">RNA_property_flag</a>(template-&gt;prop) &amp; <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411a5def8c59b8ee9008946cf4314433b69a">PROP_NEVER_NULL</a>)
<a name="l00482"></a>00482                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         <span class="keywordflow">if</span> ((idfrom &amp;&amp; idfrom-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) || !editable)
<a name="l00486"></a>00486             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00487"></a>00487     }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <span class="keywordflow">if</span> (idcode == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>)
<a name="l00490"></a>00490         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aec7c39e1c7981d4e80f7b661fec44a03">uiTemplateTextureShow</a>(layout, C, &amp;template-&gt;ptr, template-&gt;prop);
<a name="l00491"></a>00491     
<a name="l00492"></a>00492     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l00493"></a>00493 }
<a name="l00494"></a>00494 
<a name="l00495"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#abf0a737fd9e63f4e1ab791e03f907df0">00495</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#abf0a737fd9e63f4e1ab791e03f907df0">ui_template_id</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keyword">const</span> <span class="keywordtype">char</span> *newop, <span class="keyword">const</span> <span class="keywordtype">char</span> *openop, <span class="keyword">const</span> <span class="keywordtype">char</span> *unlinkop, <span class="keywordtype">int</span> flag, <span class="keywordtype">int</span> prv_rows, <span class="keywordtype">int</span> prv_cols)
<a name="l00496"></a>00496 {
<a name="l00497"></a>00497     <a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a> *<span class="keyword">template</span>;
<a name="l00498"></a>00498     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00499"></a>00499     <a class="code" href="../../d5/d61/structStructRNA.html">StructRNA</a> *type;
<a name="l00500"></a>00500     <span class="keywordtype">short</span> idcode;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504     <span class="keywordflow">if</span> (!prop || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>) {
<a name="l00505"></a>00505         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;pointer property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l00506"></a>00506         <span class="keywordflow">return</span>;
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="keyword">template</span> = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d8c/structTemplateID.html">TemplateID</a>), <span class="stringliteral">&quot;TemplateID&quot;</span>);
<a name="l00510"></a>00510     <span class="keyword">template</span>-&gt;ptr = *ptr;
<a name="l00511"></a>00511     <span class="keyword">template</span>-&gt;prop = prop;
<a name="l00512"></a>00512     <span class="keyword">template</span>-&gt;prv_rows = prv_rows;
<a name="l00513"></a>00513     <span class="keyword">template</span>-&gt;prv_cols = prv_cols;
<a name="l00514"></a>00514 
<a name="l00515"></a>00515     <span class="keywordflow">if</span> (newop)
<a name="l00516"></a>00516         flag |= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a0f819c3c730906a8fa600634441850d4">UI_ID_ADD_NEW</a>;
<a name="l00517"></a>00517     <span class="keywordflow">if</span> (openop)
<a name="l00518"></a>00518         flag |= <a class="code" href="../../d8/d1e/UI__interface_8h.html#aced6daa31c6105137d189f60a26d27a0">UI_ID_OPEN</a>;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     type = <a class="code" href="../../d3/d10/rna__access_8c.html#a90d864adedcd427f9c2dac19e025a092">RNA_property_pointer_type</a>(ptr, prop);
<a name="l00521"></a>00521     idcode = <a class="code" href="../../de/ddf/RNA__access_8h.html#ae73e191d4ec876451be218ad79e96eea">RNA_type_to_ID_code</a>(type);
<a name="l00522"></a>00522     <span class="keyword">template</span>-&gt;idlb = <a class="code" href="../../d8/db1/BKE__library_8h.html#a2dc345b18171d710d51f14d814121381">which_libbase</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C), idcode);
<a name="l00523"></a>00523     
<a name="l00524"></a>00524     <span class="comment">/* create UI elements for this template</span>
<a name="l00525"></a>00525 <span class="comment">     *  - template_ID makes a copy of the template data and assigns it to the relevant buttons</span>
<a name="l00526"></a>00526 <span class="comment">     */</span>
<a name="l00527"></a>00527     <span class="keywordflow">if</span> (template-&gt;idlb) {
<a name="l00528"></a>00528         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 1);
<a name="l00529"></a>00529         <a class="code" href="../../d5/d05/interface__templates_8c.html#ad59388a481a0c3bcc61e59b2f621e834">template_ID</a>(C, layout, <span class="keyword">template</span>, type, idcode, flag, newop, openop, unlinkop);
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(<span class="keyword">template</span>);
<a name="l00533"></a>00533 }
<a name="l00534"></a>00534 
<a name="l00535"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#adbe80aae5e518b3e45f0f88ab052e0f8">00535</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1caec9fcdc7d298770e84c6daa185f59">uiTemplateID</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keyword">const</span> <span class="keywordtype">char</span> *newop, <span class="keyword">const</span> <span class="keywordtype">char</span> *openop, <span class="keyword">const</span> <span class="keywordtype">char</span> *unlinkop)
<a name="l00536"></a>00536 {
<a name="l00537"></a>00537     <a class="code" href="../../d5/d05/interface__templates_8c.html#abf0a737fd9e63f4e1ab791e03f907df0">ui_template_id</a>(layout, C, ptr, propname, newop, openop, unlinkop, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab5bc6f64692cb2512607a41cdf8b71c6">UI_ID_BROWSE</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#a48c807dd3396d0fa240d7bcce2b364d1">UI_ID_RENAME</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#a939da80a9dca8951bf7350afe8744c68">UI_ID_DELETE</a>, 0, 0);
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 
<a name="l00540"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a7d2def0ffce495b4ff6489ed411e30a5">00540</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#af0600602873d9fe9de182d18842f005e">uiTemplateIDBrowse</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keyword">const</span> <span class="keywordtype">char</span> *newop, <span class="keyword">const</span> <span class="keywordtype">char</span> *openop, <span class="keyword">const</span> <span class="keywordtype">char</span> *unlinkop)
<a name="l00541"></a>00541 {
<a name="l00542"></a>00542     <a class="code" href="../../d5/d05/interface__templates_8c.html#abf0a737fd9e63f4e1ab791e03f907df0">ui_template_id</a>(layout, C, ptr, propname, newop, openop, unlinkop, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab5bc6f64692cb2512607a41cdf8b71c6">UI_ID_BROWSE</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#a48c807dd3396d0fa240d7bcce2b364d1">UI_ID_RENAME</a>, 0, 0);
<a name="l00543"></a>00543 }
<a name="l00544"></a>00544 
<a name="l00545"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aa767a511a2e1306c9383ddc16e77bb7a">00545</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a626bdf2a85f3494db94a518183640747">uiTemplateIDPreview</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keyword">const</span> <span class="keywordtype">char</span> *newop, <span class="keyword">const</span> <span class="keywordtype">char</span> *openop, <span class="keyword">const</span> <span class="keywordtype">char</span> *unlinkop, <span class="keywordtype">int</span> rows, <span class="keywordtype">int</span> cols)
<a name="l00546"></a>00546 {
<a name="l00547"></a>00547     <a class="code" href="../../d5/d05/interface__templates_8c.html#abf0a737fd9e63f4e1ab791e03f907df0">ui_template_id</a>(layout, C, ptr, propname, newop, openop, unlinkop, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab5bc6f64692cb2512607a41cdf8b71c6">UI_ID_BROWSE</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#a48c807dd3396d0fa240d7bcce2b364d1">UI_ID_RENAME</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#a939da80a9dca8951bf7350afe8744c68">UI_ID_DELETE</a> | <a class="code" href="../../d8/d1e/UI__interface_8h.html#aea0ae5167e3b0815b28bdc3096f90eb8">UI_ID_PREVIEWS</a>, rows, cols);
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 <span class="comment">/************************ ID Chooser Template ***************************/</span>
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 <span class="comment">/* This is for selecting the type of ID-block to use, and then from the relevant type choosing the block to use </span>
<a name="l00553"></a>00553 <span class="comment"> *</span>
<a name="l00554"></a>00554 <span class="comment"> * - propname: property identifier for property that ID-pointer gets stored to</span>
<a name="l00555"></a>00555 <span class="comment"> * - proptypename: property identifier for property used to determine the type of ID-pointer that can be used</span>
<a name="l00556"></a>00556 <span class="comment"> */</span>
<a name="l00557"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a5874b29c748c1e9b86848171e7aa88ef">00557</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#acc85f4b8f6e490b3fda7338a95047b2d">uiTemplateAnyID</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keyword">const</span> <span class="keywordtype">char</span> *proptypename, <span class="keyword">const</span> <span class="keywordtype">char</span> *text)
<a name="l00558"></a>00558 {
<a name="l00559"></a>00559     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *propID, *propType;
<a name="l00560"></a>00560     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *row;
<a name="l00561"></a>00561     
<a name="l00562"></a>00562     <span class="comment">/* get properties... */</span>
<a name="l00563"></a>00563     propID = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l00564"></a>00564     propType = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, proptypename);
<a name="l00565"></a>00565 
<a name="l00566"></a>00566     <span class="keywordflow">if</span> (!propID || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(propID) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>) {
<a name="l00567"></a>00567         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;pointer property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l00568"></a>00568         <span class="keywordflow">return</span>;
<a name="l00569"></a>00569     }
<a name="l00570"></a>00570     <span class="keywordflow">if</span> (!propType || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(propType) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87a46db685881d563dbd4be267143d05b84">PROP_ENUM</a>) { 
<a name="l00571"></a>00571         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;pointer-type property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), proptypename);
<a name="l00572"></a>00572         <span class="keywordflow">return</span>;
<a name="l00573"></a>00573     }
<a name="l00574"></a>00574     
<a name="l00575"></a>00575     <span class="comment">/* Start drawing UI Elements using standard defines */</span>
<a name="l00576"></a>00576     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 1);
<a name="l00577"></a>00577     
<a name="l00578"></a>00578     <span class="comment">/* Label - either use the provided text, or will become &quot;ID-Block:&quot; */</span>
<a name="l00579"></a>00579     <span class="keywordflow">if</span> (text)
<a name="l00580"></a>00580         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, text, ICON_NONE);
<a name="l00581"></a>00581     <span class="keywordflow">else</span>
<a name="l00582"></a>00582         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, <span class="stringliteral">&quot;ID-Block:&quot;</span>, ICON_NONE);
<a name="l00583"></a>00583     
<a name="l00584"></a>00584     <span class="comment">/* ID-Type Selector - just have a menu of icons */</span>
<a name="l00585"></a>00585     <span class="comment">// FIXME: the icon-only setting doesn&#39;t work when we supply a blank name</span>
<a name="l00586"></a>00586     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad4ece3090bf561e4ea832f0011e6c409">uiItemFullR</a>(row, ptr, propType, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#afff97585e4a15b3fd526c29c9a9d7a70">UI_ITEM_R_ICON_ONLY</a>, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00587"></a>00587     
<a name="l00588"></a>00588     <span class="comment">/* ID-Block Selector - just use pointer widget... */</span>
<a name="l00589"></a>00589     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad4ece3090bf561e4ea832f0011e6c409">uiItemFullR</a>(row, ptr, propID, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <span class="comment">/********************* RNA Path Builder Template ********************/</span>
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 <span class="comment">/* ---------- */</span>
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 <span class="comment">/* This is creating/editing RNA-Paths </span>
<a name="l00597"></a>00597 <span class="comment"> *</span>
<a name="l00598"></a>00598 <span class="comment"> * - ptr: struct which holds the path property</span>
<a name="l00599"></a>00599 <span class="comment"> * - propname: property identifier for property that path gets stored to</span>
<a name="l00600"></a>00600 <span class="comment"> * - root_ptr: struct that path gets built from</span>
<a name="l00601"></a>00601 <span class="comment"> */</span>
<a name="l00602"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aa1dff1d5abd5e5d6931235a75f870659">00602</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a23f4a2ed9f079a6770554dee7e486480">uiTemplatePathBuilder</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(root_ptr), <span class="keyword">const</span> <span class="keywordtype">char</span> *text)
<a name="l00603"></a>00603 {
<a name="l00604"></a>00604     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *propPath;
<a name="l00605"></a>00605     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *row;
<a name="l00606"></a>00606     
<a name="l00607"></a>00607     <span class="comment">/* check that properties are valid */</span>
<a name="l00608"></a>00608     propPath = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l00609"></a>00609     <span class="keywordflow">if</span> (!propPath || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(propPath) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87a847d74deffc8d0ec556372561186ee41">PROP_STRING</a>) {
<a name="l00610"></a>00610         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;path property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l00611"></a>00611         <span class="keywordflow">return</span>;
<a name="l00612"></a>00612     }
<a name="l00613"></a>00613     
<a name="l00614"></a>00614     <span class="comment">/* Start drawing UI Elements using standard defines */</span>
<a name="l00615"></a>00615     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 1);
<a name="l00616"></a>00616     
<a name="l00617"></a>00617     <span class="comment">/* Path (existing string) Widget */</span>
<a name="l00618"></a>00618     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, ptr, propname, 0, text, ICON_RNA);
<a name="l00619"></a>00619     
<a name="l00620"></a>00620     <span class="comment">// TODO: attach something to this to make allow searching of nested properties to &#39;build&#39; the path</span>
<a name="l00621"></a>00621 }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="comment">/************************ Modifier Template *************************/</span>
<a name="l00624"></a>00624 
<a name="l00625"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aeffca2809ee144debc0c100a07be7f8c">00625</a> <span class="preprocessor">#define ERROR_LIBDATA_MESSAGE &quot;Can&#39;t edit external libdata&quot;</span>
<a name="l00626"></a>00626 <span class="preprocessor"></span>
<a name="l00627"></a>00627 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00628"></a>00628 
<a name="l00629"></a>00629 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d60/DNA__object__force_8h.html">DNA_object_force.h</a>&quot;</span>
<a name="l00630"></a>00630 
<a name="l00631"></a>00631 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00632"></a>00632 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d0f/BKE__modifier_8h.html">BKE_modifier.h</a>&quot;</span>
<a name="l00633"></a>00633 <span class="preprocessor">#include &quot;<a class="code" href="../../db/dca/BKE__particle_8h.html">BKE_particle.h</a>&quot;</span>
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/df1/ED__util_8h.html">ED_util.h</a>&quot;</span>
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00638"></a>00638 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d3e/BLI__listbase_8h.html">BLI_listbase.h</a>&quot;</span>
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7a/ED__object_8h.html">ED_object.h</a>&quot;</span>
<a name="l00641"></a>00641 
<a name="l00642"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#af9da430184a2ae6c02f96f6478cc084f">00642</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#af9da430184a2ae6c02f96f6478cc084f">modifiers_setOnCage</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *ob_v, <span class="keywordtype">void</span> *md_v)
<a name="l00643"></a>00643 {
<a name="l00644"></a>00644     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00645"></a>00645     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = ob_v;
<a name="l00646"></a>00646     <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md = md_v;
<a name="l00647"></a>00647     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, cageIndex = <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a928cf2f36a386c9d2c704e5b5ffe3b04">modifiers_getCageIndex</a>(scene, ob, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);
<a name="l00648"></a>00648 
<a name="l00649"></a>00649     <span class="comment">/* undo button operation */</span>
<a name="l00650"></a>00650     md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a> ^= <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601aeb4136782935ac4d26627d25af3906c1">eModifierMode_OnCage</a>;
<a name="l00651"></a>00651 
<a name="l00652"></a>00652     <span class="keywordflow">for</span> (i = 0, md = ob-&gt;<a class="code" href="../../de/de7/structObject.html#a31fdd585d66951dfd084a8e8ee624a8d">modifiers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; md; ++i, md = md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a3021bdd74b5a4d99e4ea5ee3a19f8560">next</a>) {
<a name="l00653"></a>00653         <span class="keywordflow">if</span> (md == md_v) {
<a name="l00654"></a>00654             <span class="keywordflow">if</span> (i &gt;= cageIndex)
<a name="l00655"></a>00655                 md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a> ^= <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601aeb4136782935ac4d26627d25af3906c1">eModifierMode_OnCage</a>;
<a name="l00656"></a>00656             <span class="keywordflow">break</span>;
<a name="l00657"></a>00657         }
<a name="l00658"></a>00658     }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a6ec218ae09d7e62810f2235c02a54ecf">ND_MODIFIER</a>, ob);
<a name="l00661"></a>00661     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a70d8c170e1f4bbcc010d94405d6a9817">DAG_id_tag_update</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a5753f311c53d8a8f72b1937f33ebb527">OB_RECALC_DATA</a>);
<a name="l00662"></a>00662 }
<a name="l00663"></a>00663 
<a name="l00664"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#af67f7dfe0c6f833bb4054beb904119e6">00664</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#af67f7dfe0c6f833bb4054beb904119e6">modifiers_convertToReal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *ob_v, <span class="keywordtype">void</span> *md_v)
<a name="l00665"></a>00665 {
<a name="l00666"></a>00666     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = ob_v;
<a name="l00667"></a>00667     <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md = md_v;
<a name="l00668"></a>00668     <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *nmd = <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#ad792bc6e3890679e671ffd17a10194c5">modifier_new</a>(md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a>);
<a name="l00669"></a>00669 
<a name="l00670"></a>00670     <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a21920e59b89287398d748a987821c7f7">modifier_copyData</a>(md, nmd);
<a name="l00671"></a>00671     nmd-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a> &amp;= ~<a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601a0742486098df403f1362234039fe2473">eModifierMode_Virtual</a>;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a31fdd585d66951dfd084a8e8ee624a8d">modifiers</a>, nmd);
<a name="l00674"></a>00674     
<a name="l00675"></a>00675     <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a3a5b9d70c91ea8daeaf40173bad993e0">modifier_unique_name</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a31fdd585d66951dfd084a8e8ee624a8d">modifiers</a>, nmd);
<a name="l00676"></a>00676 
<a name="l00677"></a>00677     ob-&gt;<a class="code" href="../../de/de7/structObject.html#a0ed2df4a386ce2b22084aaaa701d73ff">partype</a> = <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#accc5a1256f709e67b3448b2eb695bd8a">PAROBJECT</a>;
<a name="l00678"></a>00678 
<a name="l00679"></a>00679     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a6ec218ae09d7e62810f2235c02a54ecf">ND_MODIFIER</a>, ob);
<a name="l00680"></a>00680     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a70d8c170e1f4bbcc010d94405d6a9817">DAG_id_tag_update</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a5753f311c53d8a8f72b1937f33ebb527">OB_RECALC_DATA</a>);
<a name="l00681"></a>00681 
<a name="l00682"></a>00682     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Modifier convert to real&quot;</span>);
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ab5dcaf03fac43d9d3014abdf2db29a95">00685</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ab5dcaf03fac43d9d3014abdf2db29a95">modifier_can_delete</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md)
<a name="l00686"></a>00686 {
<a name="l00687"></a>00687     <span class="comment">/* fluid particle modifier can&#39;t be deleted here */</span>
<a name="l00688"></a>00688     <span class="keywordflow">if</span> (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> == <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a08b7b619df960c74b7097e769c4967a4">eModifierType_ParticleSystem</a>)
<a name="l00689"></a>00689         <span class="keywordflow">if</span> (((<a class="code" href="../../d7/da3/structParticleSystemModifierData.html">ParticleSystemModifierData</a> *)md)-&gt;psys-&gt;part-&gt;type == <a class="code" href="../../de/d5a/DNA__particle__types_8h.html#ad2b156b6908626c14f063e15712fe427">PART_FLUID</a>)
<a name="l00690"></a>00690             <span class="keywordflow">return</span> 0;
<a name="l00691"></a>00691 
<a name="l00692"></a>00692     <span class="keywordflow">return</span> 1;
<a name="l00693"></a>00693 }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="comment">/* Check wheter Modifier is a simulation or not, this is used for switching to the physics/particles context tab */</span>
<a name="l00696"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aaf78f4d4c17b514c5374fc3d1ba591ed">00696</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#aaf78f4d4c17b514c5374fc3d1ba591ed">modifier_is_simulation</a>(<a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md)
<a name="l00697"></a>00697 {
<a name="l00698"></a>00698     <span class="comment">/* Physic Tab */</span>
<a name="l00699"></a>00699     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa4fcf246fa95904d4151b46983f97f4e">ELEM7</a>(md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a5fc484f055c7aba4c89beda85b5ba321">eModifierType_Cloth</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435abc95e623f4353951954effc91fe021e2">eModifierType_Collision</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a1b7a8b34e7e5482f68e3447b75e56899">eModifierType_Fluidsim</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a7a78843e9dd6590fafc9b7682e691ac5">eModifierType_Smoke</a>,
<a name="l00700"></a>00700               <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435ae1ec58b8e8caf9b712d9e318c1afebf7">eModifierType_Softbody</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a5163fb176684a2ff2f47657ac51ab973">eModifierType_Surface</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435abf6c2369ea1f5b0cab992eb27906823c">eModifierType_DynamicPaint</a>))
<a name="l00701"></a>00701     {
<a name="l00702"></a>00702         <span class="keywordflow">return</span> 1;
<a name="l00703"></a>00703     }
<a name="l00704"></a>00704     <span class="comment">/* Particle Tab */</span>
<a name="l00705"></a>00705     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> == <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a08b7b619df960c74b7097e769c4967a4">eModifierType_ParticleSystem</a>) {
<a name="l00706"></a>00706         <span class="keywordflow">return</span> 2;
<a name="l00707"></a>00707     }
<a name="l00708"></a>00708     <span class="keywordflow">else</span> {
<a name="l00709"></a>00709         <span class="keywordflow">return</span> 0;
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a5bcce1de86afa904155750fa212fb18a">00713</a> <span class="keyword">static</span> <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *<a class="code" href="../../d5/d05/interface__templates_8c.html#a5bcce1de86afa904155750fa212fb18a">draw_modifier</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob,
<a name="l00714"></a>00714                                <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md, <span class="keywordtype">int</span> index, <span class="keywordtype">int</span> cageIndex, <span class="keywordtype">int</span> lastCageIndex)
<a name="l00715"></a>00715 {
<a name="l00716"></a>00716     <a class="code" href="../../db/dc5/structModifierTypeInfo.html">ModifierTypeInfo</a> *<a class="code" href="../../d8/d43/MT__random_8cpp.html#a0893639c022032e006e5b13378f7b4b2">mti</a> = <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a837a63cd144446bec663f3a02e0ad397">modifierType_getInfo</a>(md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a>);
<a name="l00717"></a>00717     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l00718"></a>00718     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l00719"></a>00719     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l00720"></a>00720     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *box, *column, *row;
<a name="l00721"></a>00721     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *result = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00722"></a>00722     <span class="keywordtype">int</span> isVirtual = (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601a0742486098df403f1362234039fe2473">eModifierMode_Virtual</a>);
<a name="l00723"></a>00723     <span class="keywordtype">char</span> <a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>[128];
<a name="l00724"></a>00724 
<a name="l00725"></a>00725     <span class="comment">/* create RNA pointer */</span>
<a name="l00726"></a>00726     <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a3579aeeec101cbed2e2de13bd918a52e">RNA_Modifier</a>, md, &amp;ptr);
<a name="l00727"></a>00727 
<a name="l00728"></a>00728     column = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(layout, 1);
<a name="l00729"></a>00729     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aaad8a2f95d9f906dbb19097a54c14bc9">uiLayoutSetContextPointer</a>(column, <span class="stringliteral">&quot;modifier&quot;</span>, &amp;ptr);
<a name="l00730"></a>00730 
<a name="l00731"></a>00731     <span class="comment">/* rounded header ------------------------------------------------------------------- */</span>
<a name="l00732"></a>00732     box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5570dc8f239e27a98c5fdbb965572d35">uiLayoutBox</a>(column);
<a name="l00733"></a>00733     
<a name="l00734"></a>00734     <span class="keywordflow">if</span> (isVirtual) {
<a name="l00735"></a>00735         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(box, 0);
<a name="l00736"></a>00736         <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(row, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a83dfa8e56539cd22059940bbddcc4d8c">UI_LAYOUT_ALIGN_EXPAND</a>);
<a name="l00737"></a>00737         block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(row);
<a name="l00738"></a>00738         <span class="comment">/* VIRTUAL MODIFIER */</span>
<a name="l00739"></a>00739         <span class="comment">// XXX this is not used now, since these cannot be accessed via RNA</span>
<a name="l00740"></a>00740         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;%s parent deform&quot;</span>, md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a11ae633f1d5e802a57abdd651ca99956">name</a>);
<a name="l00741"></a>00741         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a0b7df70d4a086a227bc482b07e2bbbca">LABEL</a>, 0, str, 0, 0, 185, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <span class="stringliteral">&quot;Modifier name&quot;</span>); 
<a name="l00742"></a>00742         
<a name="l00743"></a>00743         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Make Real&quot;</span>), 0, 0, 80, 16, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0,
<a name="l00744"></a>00744                        <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Convert virtual modifier to a real modifier&quot;</span>));
<a name="l00745"></a>00745         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#af67f7dfe0c6f833bb4054beb904119e6">modifiers_convertToReal</a>, ob, md);
<a name="l00746"></a>00746     }
<a name="l00747"></a>00747     <span class="keywordflow">else</span> {
<a name="l00748"></a>00748         <span class="comment">/* REAL MODIFIER */</span>
<a name="l00749"></a>00749         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(box, 0);
<a name="l00750"></a>00750         block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(row);
<a name="l00751"></a>00751         
<a name="l00752"></a>00752         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l00753"></a>00753         <span class="comment">/* Open/Close .................................  */</span>
<a name="l00754"></a>00754         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;show_expanded&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00755"></a>00755         
<a name="l00756"></a>00756         <span class="comment">/* modifier-type icon */</span>
<a name="l00757"></a>00757         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#a5a07a8315a1b6d5b30bbca822db7195c">RNA_struct_ui_icon</a>(ptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>));
<a name="l00758"></a>00758         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l00759"></a>00759         
<a name="l00760"></a>00760         <span class="comment">/* modifier name */</span>
<a name="l00761"></a>00761         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;name&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00762"></a>00762         
<a name="l00763"></a>00763         <span class="comment">/* mode enabling buttons */</span>
<a name="l00764"></a>00764         <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4c674e4e473631554c7372d8c6cb36e">uiBlockBeginAlign</a>(block);
<a name="l00765"></a>00765         <span class="comment">/* Softbody not allowed in this situation, enforce! */</span>
<a name="l00766"></a>00766         <span class="keywordflow">if</span> (((md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> != <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435ae1ec58b8e8caf9b712d9e318c1afebf7">eModifierType_Softbody</a> &amp;&amp; md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> != <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435abc95e623f4353951954effc91fe021e2">eModifierType_Collision</a>) || !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a5af3210d70b057f538ce36c033548836">pd</a> &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a5af3210d70b057f538ce36c033548836">pd</a>-&gt;<a class="code" href="../../d3/d76/structPartDeflect.html#a95751b10530e32549805265908842fa5">deflect</a>)) &amp;&amp;
<a name="l00767"></a>00767              (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> != <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a5163fb176684a2ff2f47657ac51ab973">eModifierType_Surface</a>) )
<a name="l00768"></a>00768         {
<a name="l00769"></a>00769             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;show_render&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00770"></a>00770             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;show_viewport&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00771"></a>00771             
<a name="l00772"></a>00772             <span class="keywordflow">if</span> (mti-&gt;<a class="code" href="../../db/dc5/structModifierTypeInfo.html#a6ab09ae52780d2c940000109012f1fe3">flags</a> &amp; <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a4c64dc2e6ccb9a3c602589c543ac0321a8805d824ff1947a7a3d1a0e493770809">eModifierTypeFlag_SupportsEditmode</a>)
<a name="l00773"></a>00773                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;show_in_editmode&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00774"></a>00774         }
<a name="l00775"></a>00775 
<a name="l00776"></a>00776         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>) {
<a name="l00777"></a>00777             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a646983c99e2265b77c4c8a7ab91b39bd">modifier_couldBeCage</a>(scene, md) &amp;&amp; (index &lt;= lastCageIndex)) {
<a name="l00778"></a>00778                 <span class="comment">/* -- convert to rna ? */</span>
<a name="l00779"></a>00779                 but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa9defd90102f943b88abe250434ebada">uiDefIconButBitI</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601aeb4136782935ac4d26627d25af3906c1">eModifierMode_OnCage</a>, 0, ICON_MESH_DATA, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> - 2, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a>, 0.0, 0.0, 0.0, 0.0,
<a name="l00780"></a>00780                                        <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Apply modifier to editing cage during Editmode&quot;</span>));
<a name="l00781"></a>00781                 <span class="keywordflow">if</span> (index &lt; cageIndex)
<a name="l00782"></a>00782                     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00783"></a>00783                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#af9da430184a2ae6c02f96f6478cc084f">modifiers_setOnCage</a>, ob, md);
<a name="l00784"></a>00784             }
<a name="l00785"></a>00785             <span class="keywordflow">else</span> {
<a name="l00786"></a>00786                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l00787"></a>00787 
<a name="l00788"></a>00788                 <span class="comment">/* place holder button */</span>
<a name="l00789"></a>00789                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l00790"></a>00790                 but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_NONE, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> - 2, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00791"></a>00791                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00792"></a>00792                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l00793"></a>00793             }
<a name="l00794"></a>00794         } <span class="comment">/* tessellation point for curve-typed objects */</span>
<a name="l00795"></a>00795         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a885d669104f0c596dabb147f9371ffc3">OB_CURVE</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ae247d3ec6e691b7752d8a90065428ecb">OB_SURF</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a1a94162b6fc469957966a01d41ff71d6">OB_FONT</a>)) {
<a name="l00796"></a>00796             <span class="comment">/* some modifiers could work with pre-tessellated curves only */</span>
<a name="l00797"></a>00797             <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a82ec76427c7cc0b352e6aadb2e3d0b89">eModifierType_Hook</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435ae1ec58b8e8caf9b712d9e318c1afebf7">eModifierType_Softbody</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a177f813942f48c8705d42b9820e02a80">eModifierType_MeshDeform</a>)) {
<a name="l00798"></a>00798                 <span class="comment">/* add disabled pre-tessellated button, so users could have</span>
<a name="l00799"></a>00799 <span class="comment">                 * message for this modifiers */</span>
<a name="l00800"></a>00800                 but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa9defd90102f943b88abe250434ebada">uiDefIconButBitI</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601a49808cacdbe6a8e864a00f461e261edf">eModifierMode_ApplyOnSpline</a>, 0, ICON_SURFACE_DATA, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> - 2, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a>, 0.0, 0.0, 0.0, 0.0,
<a name="l00801"></a>00801                                        <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;This modifier could be applied on splines&#39; points only&quot;</span>));
<a name="l00802"></a>00802                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l00803"></a>00803             }
<a name="l00804"></a>00804             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mti-&gt;<a class="code" href="../../db/dc5/structModifierTypeInfo.html#a7a7867ee9773d0b29fd0f4c9d3f390d0">type</a> != <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#abd2410bb81ff1d02c80627595bfc66a7aae51d200ac4da5c6b8e9c94542a20aaf">eModifierTypeType_Constructive</a>) {
<a name="l00805"></a>00805                 <span class="comment">/* constructive modifiers tessellates curve before applying */</span>
<a name="l00806"></a>00806                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;use_apply_on_spline&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00807"></a>00807             }
<a name="l00808"></a>00808         }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l00811"></a>00811         
<a name="l00812"></a>00812         <span class="comment">/* Up/Down + Delete ........................... */</span>
<a name="l00813"></a>00813         <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4c674e4e473631554c7372d8c6cb36e">uiBlockBeginAlign</a>(block);
<a name="l00814"></a>00814         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_TRIA_UP, <span class="stringliteral">&quot;OBJECT_OT_modifier_move_up&quot;</span>);
<a name="l00815"></a>00815         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_TRIA_DOWN, <span class="stringliteral">&quot;OBJECT_OT_modifier_move_down&quot;</span>);
<a name="l00816"></a>00816         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l00817"></a>00817         
<a name="l00818"></a>00818         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l00819"></a>00819         <span class="comment">// When Modifier is a simulation, show button to switch to context rather than the delete button. </span>
<a name="l00820"></a>00820         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d05/interface__templates_8c.html#ab5dcaf03fac43d9d3014abdf2db29a95">modifier_can_delete</a>(md) &amp;&amp; !<a class="code" href="../../d5/d05/interface__templates_8c.html#aaf78f4d4c17b514c5374fc3d1ba591ed">modifier_is_simulation</a>(md))
<a name="l00821"></a>00821             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_X, <span class="stringliteral">&quot;OBJECT_OT_modifier_remove&quot;</span>);
<a name="l00822"></a>00822         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d05/interface__templates_8c.html#aaf78f4d4c17b514c5374fc3d1ba591ed">modifier_is_simulation</a>(md) == 1)
<a name="l00823"></a>00823             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aca3e28252a7712df7f6cd0d82d97de9b">uiItemStringO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_BUTS, <span class="stringliteral">&quot;WM_OT_properties_context_change&quot;</span>, <span class="stringliteral">&quot;context&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);
<a name="l00824"></a>00824         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d05/interface__templates_8c.html#aaf78f4d4c17b514c5374fc3d1ba591ed">modifier_is_simulation</a>(md) == 2)
<a name="l00825"></a>00825             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aca3e28252a7712df7f6cd0d82d97de9b">uiItemStringO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_BUTS, <span class="stringliteral">&quot;WM_OT_properties_context_change&quot;</span>, <span class="stringliteral">&quot;context&quot;</span>, <span class="stringliteral">&quot;PARTICLES&quot;</span>);
<a name="l00826"></a>00826         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l00827"></a>00827     }
<a name="l00828"></a>00828 
<a name="l00829"></a>00829     
<a name="l00830"></a>00830     <span class="comment">/* modifier settings (under the header) --------------------------------------------------- */</span>
<a name="l00831"></a>00831     <span class="keywordflow">if</span> (!isVirtual &amp;&amp; (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601a196649f0c09227ef2126c272682446a8">eModifierMode_Expanded</a>)) {
<a name="l00832"></a>00832         <span class="comment">/* apply/convert/copy */</span>
<a name="l00833"></a>00833         box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5570dc8f239e27a98c5fdbb965572d35">uiLayoutBox</a>(column);
<a name="l00834"></a>00834         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(box, 0);
<a name="l00835"></a>00835         
<a name="l00836"></a>00836         <span class="keywordflow">if</span> (!<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435abc95e623f4353951954effc91fe021e2">eModifierType_Collision</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a5163fb176684a2ff2f47657ac51ab973">eModifierType_Surface</a>)) {
<a name="l00837"></a>00837             <span class="comment">/* only here obdata, the rest of modifiers is ob level */</span>
<a name="l00838"></a>00838             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a17dc76ab809a2cafb81c9edde75f6ffc">uiBlockSetButLock</a>(block, <a class="code" href="../../df/dac/BKE__object_8h.html#a7e66121d861c5070a2b6f9ed04ca87cb">object_data_is_libdata</a>(ob), <a class="code" href="../../d5/d05/interface__templates_8c.html#aeffca2809ee144debc0c100a07be7f8c">ERROR_LIBDATA_MESSAGE</a>);
<a name="l00839"></a>00839             
<a name="l00840"></a>00840             <span class="keywordflow">if</span> (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> == <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a08b7b619df960c74b7097e769c4967a4">eModifierType_ParticleSystem</a>) {
<a name="l00841"></a>00841                 <a class="code" href="../../d4/d14/structParticleSystem.html">ParticleSystem</a> *psys = ((<a class="code" href="../../d7/da3/structParticleSystemModifierData.html">ParticleSystemModifierData</a> *)md)-&gt;psys;
<a name="l00842"></a>00842                 
<a name="l00843"></a>00843                 <span class="keywordflow">if</span> (!(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a4f90725f5876b309d325c84ae4f5c51b">mode</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a36fb08f71e0c90da2a0f21518ef0d550a20027b5f4381f062402af134bcefe889">OB_MODE_PARTICLE_EDIT</a>) &amp;&amp; psys-&gt;<a class="code" href="../../d4/d14/structParticleSystem.html#ae097f6afc34289ef7ef3a6d6741070ad">pathcache</a>) {
<a name="l00844"></a>00844                     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(psys-&gt;<a class="code" href="../../d4/d14/structParticleSystem.html#a3b53997470f35e5d3a5e99ba52fb1c3a">part</a>-&gt;<a class="code" href="../../df/da6/structParticleSettings.html#a1a44c6ba58be14e0084b4f71c87d66a2">ren_as</a>, <a class="code" href="../../de/d5a/DNA__particle__types_8h.html#ababc8a40b78ea25bfdb9cd7b85c83f19">PART_DRAW_GR</a>, <a class="code" href="../../de/d5a/DNA__particle__types_8h.html#a2506fdc9f159583f812c900402c5ec54">PART_DRAW_OB</a>))
<a name="l00845"></a>00845                         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;Convert&quot;</span>, ICON_NONE, <span class="stringliteral">&quot;OBJECT_OT_duplicates_make_real&quot;</span>);
<a name="l00846"></a>00846                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (psys-&gt;<a class="code" href="../../d4/d14/structParticleSystem.html#a3b53997470f35e5d3a5e99ba52fb1c3a">part</a>-&gt;<a class="code" href="../../df/da6/structParticleSettings.html#a1a44c6ba58be14e0084b4f71c87d66a2">ren_as</a> == <a class="code" href="../../de/d5a/DNA__particle__types_8h.html#a0a6e2b5b7e3602b7647433415494031d">PART_DRAW_PATH</a>)
<a name="l00847"></a>00847                         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;Convert&quot;</span>, ICON_NONE, <span class="stringliteral">&quot;OBJECT_OT_modifier_convert&quot;</span>);
<a name="l00848"></a>00848                 }
<a name="l00849"></a>00849             }
<a name="l00850"></a>00850             <span class="keywordflow">else</span> {
<a name="l00851"></a>00851                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1a73a847be1bae1a560408d0b44c212f">uiLayoutSetOperatorContext</a>(row, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ab5a7f40e5e55a912d974ab5224a0fa15">WM_OP_INVOKE_DEFAULT</a>);
<a name="l00852"></a>00852                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6acba52fa82a73c1af44e3d52ddc5be2">uiItemEnumO</a>(row, <span class="stringliteral">&quot;OBJECT_OT_modifier_apply&quot;</span>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Apply&quot;</span>), 0, <span class="stringliteral">&quot;apply_as&quot;</span>, <a class="code" href="../../da/d7a/ED__object_8h.html#aa491173a6b1628f4ff82067b2e1ceaa9a4737b25527648c27040cfde94cea0981">MODIFIER_APPLY_DATA</a>);
<a name="l00853"></a>00853                 
<a name="l00854"></a>00854                 <span class="keywordflow">if</span> (<a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a4bd918e1c9ba591aeaadb58baf788f5c">modifier_sameTopology</a>(md) &amp;&amp; !<a class="code" href="../../d3/d0f/BKE__modifier_8h.html#af29125dfabfa2d5330bac4f5f553b8bb">modifier_nonGeometrical</a>(md))
<a name="l00855"></a>00855                     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6acba52fa82a73c1af44e3d52ddc5be2">uiItemEnumO</a>(row, <span class="stringliteral">&quot;OBJECT_OT_modifier_apply&quot;</span>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Apply as Shape Key&quot;</span>), 0, <span class="stringliteral">&quot;apply_as&quot;</span>, <a class="code" href="../../da/d7a/ED__object_8h.html#aa491173a6b1628f4ff82067b2e1ceaa9ab365566969213b99323003c8a599ed32">MODIFIER_APPLY_SHAPE</a>);
<a name="l00856"></a>00856             }
<a name="l00857"></a>00857             
<a name="l00858"></a>00858             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a14e71e813ef3b137101830aa8961f700">uiBlockClearButLock</a>(block);
<a name="l00859"></a>00859             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a17dc76ab809a2cafb81c9edde75f6ffc">uiBlockSetButLock</a>(block, ob &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#aeffca2809ee144debc0c100a07be7f8c">ERROR_LIBDATA_MESSAGE</a>);
<a name="l00860"></a>00860             
<a name="l00861"></a>00861             <span class="keywordflow">if</span> (!<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a94fe4335845faafd0b969e89a13d8c76">ELEM5</a>(md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a1b7a8b34e7e5482f68e3447b75e56899">eModifierType_Fluidsim</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435ae1ec58b8e8caf9b712d9e318c1afebf7">eModifierType_Softbody</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a08b7b619df960c74b7097e769c4967a4">eModifierType_ParticleSystem</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a5fc484f055c7aba4c89beda85b5ba321">eModifierType_Cloth</a>, <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a7a78843e9dd6590fafc9b7682e691ac5">eModifierType_Smoke</a>))
<a name="l00862"></a>00862                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Copy&quot;</span>), ICON_NONE, <span class="stringliteral">&quot;OBJECT_OT_modifier_copy&quot;</span>);
<a name="l00863"></a>00863         }
<a name="l00864"></a>00864         
<a name="l00865"></a>00865         <span class="comment">/* result is the layout block inside the box, that we return so that modifier settings can be drawn */</span>
<a name="l00866"></a>00866         result = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(box, 0);
<a name="l00867"></a>00867         block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a3a59f6fe6879fcbf0c65360ebc007c">uiLayoutAbsoluteBlock</a>(box);
<a name="l00868"></a>00868     }
<a name="l00869"></a>00869     
<a name="l00870"></a>00870     <span class="comment">/* error messages */</span>
<a name="l00871"></a>00871     <span class="keywordflow">if</span> (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#addfd2697b56281492c6b4223cdfde7a5">error</a>) {
<a name="l00872"></a>00872         box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5570dc8f239e27a98c5fdbb965572d35">uiLayoutBox</a>(column);
<a name="l00873"></a>00873         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(box, 0);
<a name="l00874"></a>00874         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#addfd2697b56281492c6b4223cdfde7a5">error</a>, ICON_ERROR);
<a name="l00875"></a>00875     }
<a name="l00876"></a>00876     
<a name="l00877"></a>00877     <span class="keywordflow">return</span> result;
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00880"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ab0d1ab6c86d969b44866746e4d64d7b8">00880</a> <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *<a class="code" href="../../d8/d1e/UI__interface_8h.html#acfc9248b626b98c5a34373c5ff986994">uiTemplateModifier</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr)
<a name="l00881"></a>00881 {
<a name="l00882"></a>00882     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00883"></a>00883     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob;
<a name="l00884"></a>00884     <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md, *vmd;
<a name="l00885"></a>00885     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, lastCageIndex, cageIndex;
<a name="l00886"></a>00886 
<a name="l00887"></a>00887     <span class="comment">/* verify we have valid data */</span>
<a name="l00888"></a>00888     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a3579aeeec101cbed2e2de13bd918a52e">RNA_Modifier</a>)) {
<a name="l00889"></a>00889         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Expected modifier on object&quot;</span>);
<a name="l00890"></a>00890         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00891"></a>00891     }
<a name="l00892"></a>00892 
<a name="l00893"></a>00893     ob = ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a7afa52885727738cb03bbdf46e808e1b">id</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l00894"></a>00894     md = ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l00895"></a>00895 
<a name="l00896"></a>00896     <span class="keywordflow">if</span> (!ob || !(<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>)) {
<a name="l00897"></a>00897         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Expected modifier on object&quot;</span>);
<a name="l00898"></a>00898         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00899"></a>00899     }
<a name="l00900"></a>00900     
<a name="l00901"></a>00901     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a17dc76ab809a2cafb81c9edde75f6ffc">uiBlockSetButLock</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout), (ob &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>), <a class="code" href="../../d5/d05/interface__templates_8c.html#aeffca2809ee144debc0c100a07be7f8c">ERROR_LIBDATA_MESSAGE</a>);
<a name="l00902"></a>00902     
<a name="l00903"></a>00903     <span class="comment">/* find modifier and draw it */</span>
<a name="l00904"></a>00904     cageIndex = <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a928cf2f36a386c9d2c704e5b5ffe3b04">modifiers_getCageIndex</a>(scene, ob, &amp;lastCageIndex, 0);
<a name="l00905"></a>00905 
<a name="l00906"></a>00906     <span class="comment">// XXX virtual modifiers are not accesible for python</span>
<a name="l00907"></a>00907     vmd = <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a136f15cde944e4b0c5d938d946d975c9">modifiers_getVirtualModifierList</a>(ob);
<a name="l00908"></a>00908 
<a name="l00909"></a>00909     <span class="keywordflow">for</span> (i = 0; vmd; i++, vmd = vmd-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a3021bdd74b5a4d99e4ea5ee3a19f8560">next</a>) {
<a name="l00910"></a>00910         <span class="keywordflow">if</span> (md == vmd)
<a name="l00911"></a>00911             <span class="keywordflow">return</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a5bcce1de86afa904155750fa212fb18a">draw_modifier</a>(layout, scene, ob, md, i, cageIndex, lastCageIndex);
<a name="l00912"></a>00912         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vmd-&gt;mode &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601a0742486098df403f1362234039fe2473">eModifierMode_Virtual</a>)
<a name="l00913"></a>00913             i--;
<a name="l00914"></a>00914     }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00917"></a>00917 }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919 <span class="comment">/************************ Constraint Template *************************/</span>
<a name="l00920"></a>00920 
<a name="l00921"></a>00921 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d03/DNA__constraint__types_8h.html">DNA_constraint_types.h</a>&quot;</span>
<a name="l00922"></a>00922 
<a name="l00923"></a>00923 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/df5/BKE__action_8h.html" title="Blender kernel action and pose functionality.">BKE_action.h</a>&quot;</span>
<a name="l00924"></a>00924 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddd/BKE__constraint_8h.html">BKE_constraint.h</a>&quot;</span>
<a name="l00925"></a>00925 
<a name="l00926"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a7e16771221d356dbe6792dd99ab5b02e">00926</a> <span class="preprocessor">#define REDRAWIPO                   1</span>
<a name="l00927"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ab8d41497f4db8b1112263845757564b5">00927</a> <span class="preprocessor"></span><span class="preprocessor">#define REDRAWNLA                   2</span>
<a name="l00928"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a8fc8fa69ab2cd7d90c2b6399e2fb47bc">00928</a> <span class="preprocessor"></span><span class="preprocessor">#define REDRAWBUTSOBJECT            3</span>
<a name="l00929"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a0c38a4c5c366a654b7bdb4f7125b2d70">00929</a> <span class="preprocessor"></span><span class="preprocessor">#define REDRAWACTION                4</span>
<a name="l00930"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ab17de0a329f302f373e7047519a409dd">00930</a> <span class="preprocessor"></span><span class="preprocessor">#define B_CONSTRAINT_TEST           5</span>
<a name="l00931"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a7466c81490afb004af228fc1f092706b">00931</a> <span class="preprocessor"></span><span class="preprocessor">#define B_CONSTRAINT_CHANGETARGET   6</span>
<a name="l00932"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ac326eac9972ea02e39c1ce14be1dbc47">00932</a> <span class="preprocessor"></span><span class="preprocessor">#define REMAKEIPO                   8</span>
<a name="l00933"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a3cdb672fb2ab4bd23001b20756d66388">00933</a> <span class="preprocessor"></span><span class="preprocessor">#define B_DIFF                      9</span>
<a name="l00934"></a>00934 <span class="preprocessor"></span>
<a name="l00935"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ad777efc3253cc2a641abe749b5df77fe">00935</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ad777efc3253cc2a641abe749b5df77fe">do_constraint_panels</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *ob_pt, <span class="keywordtype">int</span> event)
<a name="l00936"></a>00936 {
<a name="l00937"></a>00937     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain = <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l00938"></a>00938     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00939"></a>00939     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = (<a class="code" href="../../de/de7/structObject.html">Object</a> *)ob_pt;
<a name="l00940"></a>00940 
<a name="l00941"></a>00941     <span class="keywordflow">switch</span> (event) {
<a name="l00942"></a>00942         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ab17de0a329f302f373e7047519a409dd">B_CONSTRAINT_TEST</a>:
<a name="l00943"></a>00943             <span class="keywordflow">break</span>; <span class="comment">// no handling</span>
<a name="l00944"></a>00944         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a7466c81490afb004af228fc1f092706b">B_CONSTRAINT_CHANGETARGET</a>:
<a name="l00945"></a>00945             <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a23522fc15312fc5d99e1e1f68c579c25">pose</a>) ob-&gt;<a class="code" href="../../de/de7/structObject.html#a23522fc15312fc5d99e1e1f68c579c25">pose</a>-&gt;<a class="code" href="../../d3/de4/structbPose.html#a64ec87fedfe2de572e1c5418d9eac677">flag</a> |= <a class="code" href="../../dc/d2a/DNA__action__types_8h.html#adcdc440dbd940088a1e1af80558e483daa8b3bbff9fe194cbe52e3aad051a19a6">POSE_RECALC</a>;  <span class="comment">// checks &amp; sorts pose channels</span>
<a name="l00946"></a>00946             <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a1916587a9ec19eb3543b1c1bc54a8ded">DAG_scene_sort</a>(bmain, scene);
<a name="l00947"></a>00947             <span class="keywordflow">break</span>;
<a name="l00948"></a>00948         <span class="keywordflow">default</span>:
<a name="l00949"></a>00949             <span class="keywordflow">break</span>;
<a name="l00950"></a>00950     }
<a name="l00951"></a>00951 
<a name="l00952"></a>00952     <span class="comment">// note: RNA updates now call this, commenting else it gets called twice.</span>
<a name="l00953"></a>00953     <span class="comment">// if there are problems because of this, then rna needs changed update functions.</span>
<a name="l00954"></a>00954     <span class="comment">// </span>
<a name="l00955"></a>00955     <span class="comment">// object_test_constraints(ob);</span>
<a name="l00956"></a>00956     <span class="comment">// if (ob-&gt;pose) update_pose_constraint_flags(ob-&gt;pose);</span>
<a name="l00957"></a>00957     
<a name="l00958"></a>00958     <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a17c162dffb7fd4f0acb11d051374609b">OB_ARMATURE</a>) <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a70d8c170e1f4bbcc010d94405d6a9817">DAG_id_tag_update</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a5753f311c53d8a8f72b1937f33ebb527">OB_RECALC_DATA</a> | <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a189b3a96923b2425ee7c0990c0b3fd20">OB_RECALC_OB</a>);
<a name="l00959"></a>00959     <span class="keywordflow">else</span> <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a70d8c170e1f4bbcc010d94405d6a9817">DAG_id_tag_update</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a189b3a96923b2425ee7c0990c0b3fd20">OB_RECALC_OB</a>);
<a name="l00960"></a>00960 
<a name="l00961"></a>00961     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a87355bd87948236606ac66097a378e02">ND_CONSTRAINT</a>, ob);
<a name="l00962"></a>00962 }
<a name="l00963"></a>00963 
<a name="l00964"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a409427eff42b26356915d834c576f996">00964</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a409427eff42b26356915d834c576f996">constraint_active_func</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>), <span class="keywordtype">void</span> *ob_v, <span class="keywordtype">void</span> *con_v)
<a name="l00965"></a>00965 {
<a name="l00966"></a>00966     <a class="code" href="../../da/d7a/ED__object_8h.html#a7ff8632c94c40fd3b6962783a0be855b">ED_object_constraint_set_active</a>(ob_v, con_v);
<a name="l00967"></a>00967 }
<a name="l00968"></a>00968 
<a name="l00969"></a>00969 <span class="comment">/* draw panel showing settings for a constraint */</span>
<a name="l00970"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a170871edba4e0d9abe69d84a24fd2eee">00970</a> <span class="keyword">static</span> <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *<a class="code" href="../../d5/d05/interface__templates_8c.html#a170871edba4e0d9abe69d84a24fd2eee">draw_constraint</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *con)
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972     <a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *pchan = <a class="code" href="../../d8/df5/BKE__action_8h.html#aec3c2979d744c68e3fdbec5adfad77f1">get_active_posechannel</a>(ob);
<a name="l00973"></a>00973     <a class="code" href="../../dc/ded/structbConstraintTypeInfo.html">bConstraintTypeInfo</a> *cti;
<a name="l00974"></a>00974     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l00975"></a>00975     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *result = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *col, *box, *row;
<a name="l00976"></a>00976     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l00977"></a>00977     <span class="keywordtype">char</span> typestr[32];
<a name="l00978"></a>00978     <span class="keywordtype">short</span> proxy_protected, xco = 0, yco = 0;
<a name="l00979"></a>00979     <span class="comment">// int rb_col; // UNUSED</span>
<a name="l00980"></a>00980 
<a name="l00981"></a>00981     <span class="comment">/* get constraint typeinfo */</span>
<a name="l00982"></a>00982     cti = <a class="code" href="../../d4/ddd/BKE__constraint_8h.html#a8eac21e0105e441026a6b7cd7d78030d">constraint_get_typeinfo</a>(con);
<a name="l00983"></a>00983     <span class="keywordflow">if</span> (cti == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00984"></a>00984         <span class="comment">/* exception for &#39;Null&#39; constraint - it doesn&#39;t have constraint typeinfo! */</span>
<a name="l00985"></a>00985         <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(typestr, (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a63187d597452da3bb2bd3b52054167cc">type</a> == <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a22745fe3cf64fc34759408bb74cd18f5a82cd381e2c3f10ae3f420bd2b20e1806">CONSTRAINT_TYPE_NULL</a>) ? <span class="stringliteral">&quot;Null&quot;</span> : <span class="stringliteral">&quot;Unknown&quot;</span>, <span class="keyword">sizeof</span>(typestr));
<a name="l00986"></a>00986     }
<a name="l00987"></a>00987     <span class="keywordflow">else</span>
<a name="l00988"></a>00988         <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(typestr, cti-&gt;<a class="code" href="../../dc/ded/structbConstraintTypeInfo.html#ad399c9fcd89f712d7663a55faeb377dc">name</a>, <span class="keyword">sizeof</span>(typestr));
<a name="l00989"></a>00989         
<a name="l00990"></a>00990     <span class="comment">/* determine whether constraint is proxy protected or not */</span>
<a name="l00991"></a>00991     <span class="keywordflow">if</span> (<a class="code" href="../../d4/ddd/BKE__constraint_8h.html#a4d58ed07197e811922054478268f84ee">proxylocked_constraints_owner</a>(ob, pchan))
<a name="l00992"></a>00992         proxy_protected = (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#ac6a72c0507023027796fab32f3780463">flag</a> &amp; <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a0362894a1749bab66380cae2ce4b1efdaa25a8cd9a2826087e403fde72a2de286">CONSTRAINT_PROXY_LOCAL</a>) == 0;
<a name="l00993"></a>00993     <span class="keywordflow">else</span>
<a name="l00994"></a>00994         proxy_protected = 0;
<a name="l00995"></a>00995 
<a name="l00996"></a>00996     <span class="comment">/* unless button has own callback, it adds this callback to button */</span>
<a name="l00997"></a>00997     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l00998"></a>00998     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a678b88dc2247856d2d804986daf134cb">uiBlockSetHandleFunc</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#ad777efc3253cc2a641abe749b5df77fe">do_constraint_panels</a>, ob);
<a name="l00999"></a>00999     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a283c3c70489e4b3cd74853d007ad457a">uiBlockSetFunc</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a409427eff42b26356915d834c576f996">constraint_active_func</a>, ob, con);
<a name="l01000"></a>01000 
<a name="l01001"></a>01001     <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(&amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a46220a132f6713aaeb269ef7c811a20b">RNA_Constraint</a>, con, &amp;ptr);
<a name="l01002"></a>01002 
<a name="l01003"></a>01003     col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(layout, 1);
<a name="l01004"></a>01004     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aaad8a2f95d9f906dbb19097a54c14bc9">uiLayoutSetContextPointer</a>(col, <span class="stringliteral">&quot;constraint&quot;</span>, &amp;ptr);
<a name="l01005"></a>01005 
<a name="l01006"></a>01006     box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5570dc8f239e27a98c5fdbb965572d35">uiLayoutBox</a>(col);
<a name="l01007"></a>01007     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(box, 0);
<a name="l01008"></a>01008     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(box);
<a name="l01009"></a>01009 
<a name="l01010"></a>01010     <span class="comment">/* Draw constraint header */</span>
<a name="l01011"></a>01011 
<a name="l01012"></a>01012     <span class="comment">/* open/close */</span>
<a name="l01013"></a>01013     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l01014"></a>01014     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;show_expanded&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#afff97585e4a15b3fd526c29c9a9d7a70">UI_ITEM_R_ICON_ONLY</a>, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l01015"></a>01015     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01016"></a>01016     
<a name="l01017"></a>01017     <span class="comment">/* name */</span>
<a name="l01018"></a>01018     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a0b7df70d4a086a227bc482b07e2bbbca">LABEL</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ab17de0a329f302f373e7047519a409dd">B_CONSTRAINT_TEST</a>, typestr, xco + 10, yco, 100, 18, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01019"></a>01019 
<a name="l01020"></a>01020     <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#ac6a72c0507023027796fab32f3780463">flag</a> &amp; <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a0362894a1749bab66380cae2ce4b1efdac624d1811979843b913fe2a7c3833c53">CONSTRAINT_DISABLE</a>)
<a name="l01021"></a>01021         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a34f8e1a663c000791d49dd25da4d0827">uiLayoutSetRedAlert</a>(row, 1);
<a name="l01022"></a>01022     
<a name="l01023"></a>01023     <span class="keywordflow">if</span> (proxy_protected == 0) {
<a name="l01024"></a>01024         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;name&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l01025"></a>01025     }
<a name="l01026"></a>01026     <span class="keywordflow">else</span>
<a name="l01027"></a>01027         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a331611e15b92efae7bdd74c1a849e8e6">name</a>, ICON_NONE);
<a name="l01028"></a>01028     
<a name="l01029"></a>01029     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a34f8e1a663c000791d49dd25da4d0827">uiLayoutSetRedAlert</a>(row, 0);
<a name="l01030"></a>01030     
<a name="l01031"></a>01031     <span class="comment">/* proxy-protected constraints cannot be edited, so hide up/down + close buttons */</span>
<a name="l01032"></a>01032     <span class="keywordflow">if</span> (proxy_protected) {
<a name="l01033"></a>01033         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l01034"></a>01034         
<a name="l01035"></a>01035         <span class="comment">/* draw a ghost icon (for proxy) and also a lock beside it, to show that constraint is &quot;proxy locked&quot; */</span>
<a name="l01036"></a>01036         <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ab17de0a329f302f373e7047519a409dd">B_CONSTRAINT_TEST</a>, ICON_GHOST, xco + 244, yco, 19, 19, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Proxy Protected&quot;</span>));
<a name="l01037"></a>01037         <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ab17de0a329f302f373e7047519a409dd">B_CONSTRAINT_TEST</a>, ICON_LOCKED, xco + 262, yco, 19, 19, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Proxy Protected&quot;</span>));
<a name="l01038"></a>01038         
<a name="l01039"></a>01039         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01040"></a>01040     }
<a name="l01041"></a>01041     <span class="keywordflow">else</span> {
<a name="l01042"></a>01042         <span class="keywordtype">short</span> prev_proxylock, show_upbut, show_downbut;
<a name="l01043"></a>01043         
<a name="l01044"></a>01044         <span class="comment">/* Up/Down buttons: </span>
<a name="l01045"></a>01045 <span class="comment">         *  Proxy-constraints are not allowed to occur after local (non-proxy) constraints</span>
<a name="l01046"></a>01046 <span class="comment">         *  as that poses problems when restoring them, so disable the &quot;up&quot; button where</span>
<a name="l01047"></a>01047 <span class="comment">         *  it may cause this situation. </span>
<a name="l01048"></a>01048 <span class="comment">         *</span>
<a name="l01049"></a>01049 <span class="comment">         *  Up/Down buttons should only be shown (or not greyed - todo) if they serve some purpose.</span>
<a name="l01050"></a>01050 <span class="comment">         */</span>
<a name="l01051"></a>01051         <span class="keywordflow">if</span> (<a class="code" href="../../d4/ddd/BKE__constraint_8h.html#a4d58ed07197e811922054478268f84ee">proxylocked_constraints_owner</a>(ob, pchan)) {
<a name="l01052"></a>01052             <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a197290be38dd24e2fd2254044a5600f2">prev</a>) {
<a name="l01053"></a>01053                 prev_proxylock = (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a197290be38dd24e2fd2254044a5600f2">prev</a>-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#ac6a72c0507023027796fab32f3780463">flag</a> &amp; <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a0362894a1749bab66380cae2ce4b1efdaa25a8cd9a2826087e403fde72a2de286">CONSTRAINT_PROXY_LOCAL</a>) ? 0 : 1;
<a name="l01054"></a>01054             }
<a name="l01055"></a>01055             <span class="keywordflow">else</span>
<a name="l01056"></a>01056                 prev_proxylock = 0;
<a name="l01057"></a>01057         }
<a name="l01058"></a>01058         <span class="keywordflow">else</span>
<a name="l01059"></a>01059             prev_proxylock = 0;
<a name="l01060"></a>01060             
<a name="l01061"></a>01061         show_upbut = ((prev_proxylock == 0) &amp;&amp; (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a197290be38dd24e2fd2254044a5600f2">prev</a>));
<a name="l01062"></a>01062         show_downbut = (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a463805fc5e4f3bfb3f0bf92913808c88">next</a>) ? 1 : 0;
<a name="l01063"></a>01063         
<a name="l01064"></a>01064         <span class="comment">/* enabled */</span>
<a name="l01065"></a>01065         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l01066"></a>01066         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;mute&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#ac6a72c0507023027796fab32f3780463">flag</a> &amp; <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a0362894a1749bab66380cae2ce4b1efda3e9dbf2146b5916be569195d1098c5a2">CONSTRAINT_OFF</a>) ? ICON_RESTRICT_VIEW_ON : ICON_RESTRICT_VIEW_OFF);
<a name="l01067"></a>01067         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01068"></a>01068         
<a name="l01069"></a>01069         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1a73a847be1bae1a560408d0b44c212f">uiLayoutSetOperatorContext</a>(row, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ab5a7f40e5e55a912d974ab5224a0fa15">WM_OP_INVOKE_DEFAULT</a>);
<a name="l01070"></a>01070         
<a name="l01071"></a>01071         <span class="comment">/* up/down */</span>
<a name="l01072"></a>01072         <span class="keywordflow">if</span> (show_upbut || show_downbut) {
<a name="l01073"></a>01073             <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4c674e4e473631554c7372d8c6cb36e">uiBlockBeginAlign</a>(block);
<a name="l01074"></a>01074             <span class="keywordflow">if</span> (show_upbut)
<a name="l01075"></a>01075                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_TRIA_UP, <span class="stringliteral">&quot;CONSTRAINT_OT_move_up&quot;</span>);
<a name="l01076"></a>01076                 
<a name="l01077"></a>01077             <span class="keywordflow">if</span> (show_downbut)
<a name="l01078"></a>01078                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_TRIA_DOWN, <span class="stringliteral">&quot;CONSTRAINT_OT_move_down&quot;</span>);
<a name="l01079"></a>01079             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l01080"></a>01080         }
<a name="l01081"></a>01081         
<a name="l01082"></a>01082         <span class="comment">/* Close &#39;button&#39; - emboss calls here disable drawing of &#39;button&#39; behind X */</span>
<a name="l01083"></a>01083         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l01084"></a>01084         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_X, <span class="stringliteral">&quot;CONSTRAINT_OT_delete&quot;</span>);
<a name="l01085"></a>01085         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01086"></a>01086     }
<a name="l01087"></a>01087 
<a name="l01088"></a>01088     <span class="comment">/* Set but-locks for protected settings (magic numbers are used here!) */</span>
<a name="l01089"></a>01089     <span class="keywordflow">if</span> (proxy_protected)
<a name="l01090"></a>01090         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a17dc76ab809a2cafb81c9edde75f6ffc">uiBlockSetButLock</a>(block, 1, <span class="stringliteral">&quot;Cannot edit Proxy-Protected Constraint&quot;</span>);
<a name="l01091"></a>01091 
<a name="l01092"></a>01092     <span class="comment">/* Draw constraint data */</span>
<a name="l01093"></a>01093     <span class="keywordflow">if</span> ((con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#ac6a72c0507023027796fab32f3780463">flag</a> &amp; <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a0362894a1749bab66380cae2ce4b1efda250d4736d1258139f3d64a092266c72d">CONSTRAINT_EXPAND</a>) == 0) {
<a name="l01094"></a>01094         (yco) -= 21;
<a name="l01095"></a>01095     }
<a name="l01096"></a>01096     <span class="keywordflow">else</span> {
<a name="l01097"></a>01097         box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5570dc8f239e27a98c5fdbb965572d35">uiLayoutBox</a>(col);
<a name="l01098"></a>01098         block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a3a59f6fe6879fcbf0c65360ebc007c">uiLayoutAbsoluteBlock</a>(box);
<a name="l01099"></a>01099         result = box;
<a name="l01100"></a>01100     }
<a name="l01101"></a>01101 
<a name="l01102"></a>01102     <span class="comment">/* clear any locks set up for proxies/lib-linking */</span>
<a name="l01103"></a>01103     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a14e71e813ef3b137101830aa8961f700">uiBlockClearButLock</a>(block);
<a name="l01104"></a>01104 
<a name="l01105"></a>01105     <span class="keywordflow">return</span> result;
<a name="l01106"></a>01106 }
<a name="l01107"></a>01107 
<a name="l01108"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#abb38bcfeb11039144a5ef9502931ea96">01108</a> <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *<a class="code" href="../../d8/d1e/UI__interface_8h.html#a7ac46e3c154abd5b59dde65e3c2ad4ef">uiTemplateConstraint</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr)
<a name="l01109"></a>01109 {
<a name="l01110"></a>01110     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob;
<a name="l01111"></a>01111     <a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *con;
<a name="l01112"></a>01112 
<a name="l01113"></a>01113     <span class="comment">/* verify we have valid data */</span>
<a name="l01114"></a>01114     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a46220a132f6713aaeb269ef7c811a20b">RNA_Constraint</a>)) {
<a name="l01115"></a>01115         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Expected constraint on object&quot;</span>);
<a name="l01116"></a>01116         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01117"></a>01117     }
<a name="l01118"></a>01118 
<a name="l01119"></a>01119     ob = ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a7afa52885727738cb03bbdf46e808e1b">id</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l01120"></a>01120     con = ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l01121"></a>01121 
<a name="l01122"></a>01122     <span class="keywordflow">if</span> (!ob || !(<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>)) {
<a name="l01123"></a>01123         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Expected constraint on object&quot;</span>);
<a name="l01124"></a>01124         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01125"></a>01125     }
<a name="l01126"></a>01126     
<a name="l01127"></a>01127     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a17dc76ab809a2cafb81c9edde75f6ffc">uiBlockSetButLock</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout), (ob &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>), <a class="code" href="../../d5/d05/interface__templates_8c.html#aeffca2809ee144debc0c100a07be7f8c">ERROR_LIBDATA_MESSAGE</a>);
<a name="l01128"></a>01128 
<a name="l01129"></a>01129     <span class="comment">/* hrms, the temporal constraint should not draw! */</span>
<a name="l01130"></a>01130     <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a63187d597452da3bb2bd3b52054167cc">type</a> == <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a22745fe3cf64fc34759408bb74cd18f5a8061c31c9da4a7351ce57037615d2c16">CONSTRAINT_TYPE_KINEMATIC</a>) {
<a name="l01131"></a>01131         <a class="code" href="../../d4/d5b/structbKinematicConstraint.html">bKinematicConstraint</a> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = con-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#adfe30f55cbdd3ae1ae79948b63d3063e">data</a>;
<a name="l01132"></a>01132         <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d4/d5b/structbKinematicConstraint.html#ad7b9c9e543f98e483728044e9627fb14">flag</a> &amp; <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a151d60aa5af580c422f4b8a2f855af5da22e83cd66a7d89e06acd256efff5902f">CONSTRAINT_IK_TEMP</a>)
<a name="l01133"></a>01133             <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01134"></a>01134     }
<a name="l01135"></a>01135 
<a name="l01136"></a>01136     <span class="keywordflow">return</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a170871edba4e0d9abe69d84a24fd2eee">draw_constraint</a>(layout, ob, con);
<a name="l01137"></a>01137 }
<a name="l01138"></a>01138 
<a name="l01139"></a>01139 
<a name="l01140"></a>01140 <span class="comment">/************************* Preview Template ***************************/</span>
<a name="l01141"></a>01141 
<a name="l01142"></a>01142 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html">DNA_lamp_types.h</a>&quot;</span>
<a name="l01143"></a>01143 <span class="preprocessor">#include &quot;<a class="code" href="../../de/db2/DNA__material__types_8h.html">DNA_material_types.h</a>&quot;</span>
<a name="l01144"></a>01144 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d3b/DNA__world__types_8h.html">DNA_world_types.h</a>&quot;</span>
<a name="l01145"></a>01145 
<a name="l01146"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ae1d873f4cb1be8230c3191e5ed1e4b43">01146</a> <span class="preprocessor">#define B_MATPRV 1</span>
<a name="l01147"></a>01147 <span class="preprocessor"></span>
<a name="l01148"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aec5493335cb404a6b70b1ec33fc40468">01148</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#aec5493335cb404a6b70b1ec33fc40468">do_preview_buttons</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> event)
<a name="l01149"></a>01149 {
<a name="l01150"></a>01150     <span class="keywordflow">switch</span> (event) {
<a name="l01151"></a>01151         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ae1d873f4cb1be8230c3191e5ed1e4b43">B_MATPRV</a>:
<a name="l01152"></a>01152             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a835f426982dfbc3be8305095253ad793">NC_MATERIAL</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a06eb7c658fd58d7939317be9c870dbc5">ND_SHADING</a>, arg);
<a name="l01153"></a>01153             <span class="keywordflow">break</span>;
<a name="l01154"></a>01154     }
<a name="l01155"></a>01155 }
<a name="l01156"></a>01156 
<a name="l01157"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a808ed2dfc9ce2d2102e8b03dc7769a83">01157</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#af76fb75ecf7a02cab5de5e62cf8465fe">uiTemplatePreview</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>, <span class="keywordtype">int</span> show_buttons, <a class="code" href="../../d8/d7e/structID.html">ID</a> *parent, <a class="code" href="../../dc/ddd/structMTex.html">MTex</a> *slot)
<a name="l01158"></a>01158 {
<a name="l01159"></a>01159     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *row, *col;
<a name="l01160"></a>01160     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01161"></a>01161     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01162"></a>01162     <a class="code" href="../../df/d2d/structTex.html">Tex</a> *tex = (<a class="code" href="../../df/d2d/structTex.html">Tex</a> *)<span class="keywordtype">id</span>;
<a name="l01163"></a>01163     <a class="code" href="../../d8/d7e/structID.html">ID</a> *pid, *pparent;
<a name="l01164"></a>01164     <span class="keywordtype">short</span> *pr_texture = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01165"></a>01165     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> material_ptr;
<a name="l01166"></a>01166     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> texture_ptr;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &amp;&amp; !<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0388eda1f65113c4a15720e037c11cb4">ELEM4</a>(<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>), <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>)) {
<a name="l01169"></a>01169         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Expected ID of type material, texture, lamp or world&quot;</span>);
<a name="l01170"></a>01170         <span class="keywordflow">return</span>;
<a name="l01171"></a>01171     }
<a name="l01172"></a>01172 
<a name="l01173"></a>01173     <span class="comment">/* decide what to render */</span>
<a name="l01174"></a>01174     pid = id;
<a name="l01175"></a>01175     pparent = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01176"></a>01176 
<a name="l01177"></a>01177     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &amp;&amp; (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>)) {
<a name="l01178"></a>01178         <span class="keywordflow">if</span> (parent &amp;&amp; (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(parent-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>))
<a name="l01179"></a>01179             pr_texture = &amp;((<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *)parent)-&gt;pr_texture;
<a name="l01180"></a>01180         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parent &amp;&amp; (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(parent-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>))
<a name="l01181"></a>01181             pr_texture = &amp;((<a class="code" href="../../d7/d3f/structWorld.html">World</a> *)parent)-&gt;pr_texture;
<a name="l01182"></a>01182         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parent &amp;&amp; (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(parent-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>))
<a name="l01183"></a>01183             pr_texture = &amp;((<a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *)parent)-&gt;pr_texture;
<a name="l01184"></a>01184 
<a name="l01185"></a>01185         <span class="keywordflow">if</span> (pr_texture) {
<a name="l01186"></a>01186             <span class="keywordflow">if</span> (*pr_texture == <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a67aeb00aac7b790673e840b95f1e6f0c">TEX_PR_OTHER</a>)
<a name="l01187"></a>01187                 pid = parent;
<a name="l01188"></a>01188             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*pr_texture == <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a3749ae4f260202b6a7268c527452bd59">TEX_PR_BOTH</a>)
<a name="l01189"></a>01189                 pparent = parent;
<a name="l01190"></a>01190         }
<a name="l01191"></a>01191     }
<a name="l01192"></a>01192 
<a name="l01193"></a>01193     <span class="comment">/* layout */</span>
<a name="l01194"></a>01194     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l01195"></a>01195     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 0);
<a name="l01196"></a>01196     col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(row, 0);
<a name="l01197"></a>01197     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a70d15b72c1004af6f5e8e6d7d42d69db">uiLayoutSetKeepAspect</a>(col, 1);
<a name="l01198"></a>01198     
<a name="l01199"></a>01199     <span class="comment">/* add preview */</span>
<a name="l01200"></a>01200     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab8eaba4ebb775df110b46a838329a39c">BUT_EXTRA</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 6, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> * 6, pid, 0.0, 0.0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01201"></a>01201     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a86d3099a8e3c9e7ebab8819c87e746bc">uiBlockSetDrawExtraFunc</a>(block, <a class="code" href="../../d6/d53/ED__render_8h.html#a1cf162a26734bdbc74dc73c7e6ef5afa">ED_preview_draw</a>, pparent, slot);
<a name="l01202"></a>01202     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a678b88dc2247856d2d804986daf134cb">uiBlockSetHandleFunc</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#aec5493335cb404a6b70b1ec33fc40468">do_preview_buttons</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01203"></a>01203     
<a name="l01204"></a>01204     <span class="comment">/* add buttons */</span>
<a name="l01205"></a>01205     <span class="keywordflow">if</span> (pid &amp;&amp; show_buttons) {
<a name="l01206"></a>01206         <span class="keywordflow">if</span> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(pid-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a> || (pparent &amp;&amp; <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(pparent-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>)) {
<a name="l01207"></a>01207             <span class="keywordflow">if</span> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(pid-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>) ma = (<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *)pid;
<a name="l01208"></a>01208             <span class="keywordflow">else</span> ma = (<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *)pparent;
<a name="l01209"></a>01209             
<a name="l01210"></a>01210             <span class="comment">/* Create RNA Pointer */</span>
<a name="l01211"></a>01211             <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(<span class="keywordtype">id</span>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a14cefdef0fcee12e60d59826e40e0b1d">RNA_Material</a>, ma, &amp;material_ptr);
<a name="l01212"></a>01212 
<a name="l01213"></a>01213             col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(row, 1);
<a name="l01214"></a>01214             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4667c48f5c96d49d81f4f5204be37a87">uiLayoutSetScaleX</a>(col, 1.5);
<a name="l01215"></a>01215             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(col, &amp;material_ptr, <span class="stringliteral">&quot;preview_render_type&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4a1fb80bd5ce016a62ba2c23e992aa89">UI_ITEM_R_EXPAND</a>, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l01216"></a>01216         }
<a name="l01217"></a>01217 
<a name="l01218"></a>01218         <span class="keywordflow">if</span> (pr_texture) {
<a name="l01219"></a>01219             <span class="comment">/* Create RNA Pointer */</span>
<a name="l01220"></a>01220             <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(<span class="keywordtype">id</span>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ae59cf2103f62b2f5de697c81a33c30af">RNA_Texture</a>, tex, &amp;texture_ptr);
<a name="l01221"></a>01221             
<a name="l01222"></a>01222             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 1);
<a name="l01223"></a>01223             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ae1d873f4cb1be8230c3191e5ed1e4b43">B_MATPRV</a>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Texture&quot;</span>),  0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, pr_texture, 10, <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a7170a52b896adf7ba30635f902c1c0d3">TEX_PR_TEXTURE</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01224"></a>01224             <span class="keywordflow">if</span> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(parent-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>)
<a name="l01225"></a>01225                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ae1d873f4cb1be8230c3191e5ed1e4b43">B_MATPRV</a>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Material&quot;</span>),  0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, pr_texture, 10, <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a67aeb00aac7b790673e840b95f1e6f0c">TEX_PR_OTHER</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01226"></a>01226             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(parent-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>)
<a name="l01227"></a>01227                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ae1d873f4cb1be8230c3191e5ed1e4b43">B_MATPRV</a>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Lamp&quot;</span>),  0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, pr_texture, 10, <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a67aeb00aac7b790673e840b95f1e6f0c">TEX_PR_OTHER</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01228"></a>01228             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(parent-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>)
<a name="l01229"></a>01229                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ae1d873f4cb1be8230c3191e5ed1e4b43">B_MATPRV</a>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;World&quot;</span>),  0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, pr_texture, 10, <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a67aeb00aac7b790673e840b95f1e6f0c">TEX_PR_OTHER</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01230"></a>01230             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#ae1d873f4cb1be8230c3191e5ed1e4b43">B_MATPRV</a>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Both&quot;</span>),  0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, pr_texture, 10, <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a3749ae4f260202b6a7268c527452bd59">TEX_PR_BOTH</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01231"></a>01231             
<a name="l01232"></a>01232             <span class="comment">/* Alpha button for texture preview */</span>
<a name="l01233"></a>01233             <span class="keywordflow">if</span> (*pr_texture != <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a67aeb00aac7b790673e840b95f1e6f0c">TEX_PR_OTHER</a>) {
<a name="l01234"></a>01234                 row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 0);
<a name="l01235"></a>01235                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;texture_ptr, <span class="stringliteral">&quot;use_preview_alpha&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l01236"></a>01236             }
<a name="l01237"></a>01237         }
<a name="l01238"></a>01238     }
<a name="l01239"></a>01239 }
<a name="l01240"></a>01240 
<a name="l01241"></a>01241 <span class="comment">/********************** ColorRamp Template **************************/</span>
<a name="l01242"></a>01242 
<a name="l01243"></a>01243 
<a name="l01244"></a><a class="code" href="../../d7/d44/structRNAUpdateCb.html">01244</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> {
<a name="l01245"></a><a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">01245</a>     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> <a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a>;
<a name="l01246"></a><a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">01246</a>     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *<a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">prop</a>;
<a name="l01247"></a>01247 } <a class="code" href="../../d5/d05/interface__templates_8c.html#a2b4b01b244901582af6c66cf3364b7bc">RNAUpdateCb</a>;
<a name="l01248"></a>01248 
<a name="l01249"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">01249</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *arg_cb, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg))
<a name="l01250"></a>01250 {
<a name="l01251"></a>01251     <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb = (<a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *)arg_cb;
<a name="l01252"></a>01252 
<a name="l01253"></a>01253     <span class="comment">/* we call update here on the pointer property, this way the</span>
<a name="l01254"></a>01254 <span class="comment">     * owner of the curve mapping can still define it&#39;s own update</span>
<a name="l01255"></a>01255 <span class="comment">     * and notifier, even if the CurveMapping struct is shared. */</span>
<a name="l01256"></a>01256     <a class="code" href="../../d3/d10/rna__access_8c.html#a5fa7d69c3a73312275e1e6d20baf3bc6">RNA_property_update</a>(C, &amp;cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a>, cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">prop</a>);
<a name="l01257"></a>01257 }
<a name="l01258"></a>01258 
<a name="l01259"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a019b1ad790d7a57521565d576e1d184f">01259</a> <span class="preprocessor">#define B_BANDCOL 1</span>
<a name="l01260"></a>01260 <span class="preprocessor"></span>
<a name="l01261"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a28381180c5b269390c09ba45be67090e">01261</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a28381180c5b269390c09ba45be67090e">colorband_add_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cb_v, <span class="keywordtype">void</span> *coba_v)
<a name="l01262"></a>01262 {
<a name="l01263"></a>01263     <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba = coba_v;
<a name="l01264"></a>01264     <span class="keywordtype">float</span> pos = 0.5f;
<a name="l01265"></a>01265 
<a name="l01266"></a>01266     <span class="keywordflow">if</span> (coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a> &gt; 1) {
<a name="l01267"></a>01267         <span class="keywordflow">if</span> (coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a> &gt; 0) pos = (coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>[coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a> - 1].<a class="code" href="../../d6/de7/structCBData.html#a2c107365b262fd93815a67a2f41c7c6d">pos</a> + coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>[coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>].<a class="code" href="../../d6/de7/structCBData.html#a2c107365b262fd93815a67a2f41c7c6d">pos</a>) * 0.5f;
<a name="l01268"></a>01268         <span class="keywordflow">else</span> pos = (coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>[coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a> + 1].<a class="code" href="../../d6/de7/structCBData.html#a2c107365b262fd93815a67a2f41c7c6d">pos</a> + coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>[coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>].<a class="code" href="../../d6/de7/structCBData.html#a2c107365b262fd93815a67a2f41c7c6d">pos</a>) * 0.5f;
<a name="l01269"></a>01269     }
<a name="l01270"></a>01270 
<a name="l01271"></a>01271     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d66/BKE__texture_8h.html#a98fef2663e591ea08a0eef1832968713">colorband_element_add</a>(coba, pos)) {
<a name="l01272"></a>01272         <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>(C, cb_v, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01273"></a>01273         <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Add colorband&quot;</span>);   
<a name="l01274"></a>01274     }
<a name="l01275"></a>01275 }
<a name="l01276"></a>01276 
<a name="l01277"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#af18f915274a6d78788ae1a26a5454b28">01277</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#af18f915274a6d78788ae1a26a5454b28">colorband_del_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cb_v, <span class="keywordtype">void</span> *coba_v)
<a name="l01278"></a>01278 {
<a name="l01279"></a>01279     <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba = coba_v;
<a name="l01280"></a>01280 
<a name="l01281"></a>01281     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d66/BKE__texture_8h.html#a2f24477abe4efb9fda7cc1d47d716d49">colorband_element_remove</a>(coba, coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>)) {
<a name="l01282"></a>01282         <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Delete colorband&quot;</span>);
<a name="l01283"></a>01283         <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>(C, cb_v, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01284"></a>01284     }
<a name="l01285"></a>01285 }
<a name="l01286"></a>01286 
<a name="l01287"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ada0bc0bb37897b802d5fda05e0db32e1">01287</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ada0bc0bb37897b802d5fda05e0db32e1">colorband_flip_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cb_v, <span class="keywordtype">void</span> *coba_v)
<a name="l01288"></a>01288 {
<a name="l01289"></a>01289     <a class="code" href="../../d6/de7/structCBData.html">CBData</a> data_tmp[<a class="code" href="../../d2/d66/BKE__texture_8h.html#a1cbf8e30c6614205d3b962b9c3e8e56f">MAXCOLORBAND</a>];
<a name="l01290"></a>01290 
<a name="l01291"></a>01291     <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba = coba_v;
<a name="l01292"></a>01292     <span class="keywordtype">int</span> a;
<a name="l01293"></a>01293 
<a name="l01294"></a>01294     <span class="keywordflow">for</span> (a = 0; a &lt; coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a>; a++) {
<a name="l01295"></a>01295         data_tmp[a] = coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>[coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a> - (a + 1)];
<a name="l01296"></a>01296     }
<a name="l01297"></a>01297     <span class="keywordflow">for</span> (a = 0; a &lt; coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a>; a++) {
<a name="l01298"></a>01298         data_tmp[a].<a class="code" href="../../d6/de7/structCBData.html#a2c107365b262fd93815a67a2f41c7c6d">pos</a> = 1.0f - data_tmp[a].<a class="code" href="../../d6/de7/structCBData.html#a2c107365b262fd93815a67a2f41c7c6d">pos</a>;
<a name="l01299"></a>01299         coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>[a] = data_tmp[a];
<a name="l01300"></a>01300     }
<a name="l01301"></a>01301 
<a name="l01302"></a>01302     <span class="comment">/* may as well flip the cur*/</span>
<a name="l01303"></a>01303     coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a> = coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a> - (coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a> + 1);
<a name="l01304"></a>01304 
<a name="l01305"></a>01305     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Flip colorband&quot;</span>);
<a name="l01306"></a>01306 
<a name="l01307"></a>01307     <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>(C, cb_v, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01308"></a>01308 }
<a name="l01309"></a>01309 
<a name="l01310"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a69cdfb1a2f51907c23cbbfc573216aa4">01310</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a69cdfb1a2f51907c23cbbfc573216aa4">colorband_update_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <span class="keywordtype">void</span> *bt_v, <span class="keywordtype">void</span> *coba_v)
<a name="l01311"></a>01311 {
<a name="l01312"></a>01312     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt = bt_v;
<a name="l01313"></a>01313     <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba = coba_v;
<a name="l01314"></a>01314 
<a name="l01315"></a>01315     <span class="comment">/* sneaky update here, we need to sort the colorband points to be in order,</span>
<a name="l01316"></a>01316 <span class="comment">     * however the RNA pointer then is wrong, so we update it */</span>
<a name="l01317"></a>01317     <a class="code" href="../../d2/d66/BKE__texture_8h.html#a278487bc8c1708175fe9b2c3c4bad214">colorband_update_sort</a>(coba);
<a name="l01318"></a>01318     bt-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#afd86c402bb3c4c40bac45a5023b09128">rnapoin</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> = coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a> + coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>;
<a name="l01319"></a>01319 }
<a name="l01320"></a>01320 
<a name="l01321"></a>01321 <span class="comment">/* offset aligns from bottom, standard width 300, height 115 */</span>
<a name="l01322"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aed185f49cdeae296ef505dbc51a1cd8d">01322</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#aed185f49cdeae296ef505dbc51a1cd8d">colorband_buttons_large</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block, <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba, <span class="keywordtype">int</span> xoffs, <span class="keywordtype">int</span> yoffs, <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb)
<a name="l01323"></a>01323 {
<a name="l01324"></a>01324     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt;
<a name="l01325"></a>01325     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *row;
<a name="l01326"></a>01326     <span class="keyword">const</span> <span class="keywordtype">int</span> line1_y = yoffs + 65 + <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> + 2; <span class="comment">/* 2 for some space between the buttons */</span>
<a name="l01327"></a>01327     <span class="keyword">const</span> <span class="keywordtype">int</span> line2_y = yoffs + 65;
<a name="l01328"></a>01328 
<a name="l01329"></a>01329     <span class="keywordflow">if</span> (coba == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l01330"></a>01330 
<a name="l01331"></a>01331     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Add&quot;</span>), 0 + xoffs, line1_y, 40, UI_UNIT_Y, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l01332"></a>01332                   <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Add a new color stop to the colorband&quot;</span>));
<a name="l01333"></a>01333     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a28381180c5b269390c09ba45be67090e">colorband_add_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), coba);
<a name="l01334"></a>01334 
<a name="l01335"></a>01335     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Delete&quot;</span>), 45 + xoffs, line1_y, 45, UI_UNIT_Y, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l01336"></a>01336                   <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Delete the active position&quot;</span>));
<a name="l01337"></a>01337     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#af18f915274a6d78788ae1a26a5454b28">colorband_del_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), coba);
<a name="l01338"></a>01338 
<a name="l01339"></a>01339 
<a name="l01340"></a>01340     <span class="comment">/* XXX, todo for later - convert to operator - campbell */</span>
<a name="l01341"></a>01341     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <span class="stringliteral">&quot;F&quot;</span>,        95 + xoffs, line1_y, 20, UI_UNIT_Y, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Flip colorband&quot;</span>));
<a name="l01342"></a>01342     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#ada0bc0bb37897b802d5fda05e0db32e1">colorband_flip_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), coba);
<a name="l01343"></a>01343 
<a name="l01344"></a>01344     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#aaf0952059602752258dccaa015d7b54a">NUM</a>, 0,        <span class="stringliteral">&quot;&quot;</span>,             120 + xoffs, line1_y, 80, UI_UNIT_Y, &amp;coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>, 0.0, (<span class="keywordtype">float</span>)(<a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(0, coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a> - 1)), 0, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Choose active color stop&quot;</span>));
<a name="l01345"></a>01345 
<a name="l01346"></a>01346     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad0d059e6a83d21bea4f4db1c9fbd240b">MENU</a>, 0,       <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Interpolation %t|Ease %x1|Cardinal %x3|Linear %x0|B-Spline %x2|Constant %x4&quot;</span>),
<a name="l01347"></a>01347                    210 + xoffs, line1_y, 90, UI_UNIT_Y,      &amp;coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#ae0d9bb51bbed4b47d419b30a13d248fd">ipotype</a>, 0.0, 0.0, 0, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Set interpolation between color stops&quot;</span>));
<a name="l01348"></a>01348     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01349"></a>01349     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l01350"></a>01350 
<a name="l01351"></a>01351     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a84c5d75a8e1a067bb3def3f69049b22a">BUT_COLORBAND</a>, 0, <span class="stringliteral">&quot;&quot;</span>,   xoffs, line2_y, 300, UI_UNIT_Y, coba, 0, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01352"></a>01352     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01353"></a>01353 
<a name="l01354"></a>01354 
<a name="l01355"></a>01355 
<a name="l01356"></a>01356     <span class="keywordflow">if</span> (coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a>) {
<a name="l01357"></a>01357         <a class="code" href="../../d6/de7/structCBData.html">CBData</a> *cbd = coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a> + coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>;
<a name="l01358"></a>01358 
<a name="l01359"></a>01359         <span class="comment">/* better to use rna so we can animate them */</span>
<a name="l01360"></a>01360         <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l01361"></a>01361         <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a7afa52885727738cb03bbdf46e808e1b">id</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ab7f00b1da9d2dbc35876a3bd9f38eeea">RNA_ColorRampElement</a>, cbd, &amp;ptr);
<a name="l01362"></a>01362         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 0);
<a name="l01363"></a>01363 
<a name="l01364"></a>01364         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;position&quot;</span>, 0, <span class="stringliteral">&quot;Pos&quot;</span>, ICON_NONE);
<a name="l01365"></a>01365         bt = block-&gt;<a class="code" href="../../df/d5b/structuiBlock.html#a844299999568743bc189fcb02847e9e6">buttons</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01366"></a>01366         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a69cdfb1a2f51907c23cbbfc573216aa4">colorband_update_cb</a>, bt, coba);
<a name="l01367"></a>01367 
<a name="l01368"></a>01368         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;ptr, <span class="stringliteral">&quot;color&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l01369"></a>01369     }
<a name="l01370"></a>01370 
<a name="l01371"></a>01371 }
<a name="l01372"></a>01372 
<a name="l01373"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a48a6013a73bc6cfa40d0cf836dabbd15">01373</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a48a6013a73bc6cfa40d0cf836dabbd15">colorband_buttons_small</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block, <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba, <a class="code" href="../../da/d10/structrctf.html">rctf</a> *butr, <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb)
<a name="l01374"></a>01374 {
<a name="l01375"></a>01375     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt;
<a name="l01376"></a>01376     <span class="keywordtype">float</span> unit = (butr-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - butr-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) / 14.0f;
<a name="l01377"></a>01377     <span class="keywordtype">float</span> xs = butr-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>;
<a name="l01378"></a>01378 
<a name="l01379"></a>01379     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4c674e4e473631554c7372d8c6cb36e">uiBlockBeginAlign</a>(block);
<a name="l01380"></a>01380     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Add&quot;</span>), xs, butr-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> + <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, 2.0f * unit, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l01381"></a>01381                   <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Add a new color stop to the colorband&quot;</span>));
<a name="l01382"></a>01382     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a28381180c5b269390c09ba45be67090e">colorband_add_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), coba);
<a name="l01383"></a>01383     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Delete&quot;</span>), xs + 2.0f * unit, butr-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> + <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, 1.5f * unit, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>,    <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0,
<a name="l01384"></a>01384                   <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Delete the active position&quot;</span>));
<a name="l01385"></a>01385     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#af18f915274a6d78788ae1a26a5454b28">colorband_del_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), coba);
<a name="l01386"></a>01386     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <span class="stringliteral">&quot;F&quot;</span>,        xs + 3.5f * unit, butr-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> + <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, 0.5f * unit, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>,  <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Flip the color ramp&quot;</span>));
<a name="l01387"></a>01387     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#ada0bc0bb37897b802d5fda05e0db32e1">colorband_flip_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), coba);
<a name="l01388"></a>01388     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l01389"></a>01389 
<a name="l01390"></a>01390     <span class="keywordflow">if</span> (coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a>) {
<a name="l01391"></a>01391         <a class="code" href="../../d6/de7/structCBData.html">CBData</a> *cbd = coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a> + coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>;
<a name="l01392"></a>01392         <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l01393"></a>01393         <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a7afa52885727738cb03bbdf46e808e1b">id</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ab7f00b1da9d2dbc35876a3bd9f38eeea">RNA_ColorRampElement</a>, cbd, &amp;ptr);
<a name="l01394"></a>01394         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(layout, &amp;ptr, <span class="stringliteral">&quot;color&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l01395"></a>01395     }
<a name="l01396"></a>01396 
<a name="l01397"></a>01397     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a151fadb28add284e9982820c80e439ec">uiDefButS</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad0d059e6a83d21bea4f4db1c9fbd240b">MENU</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Interpolation %t|Ease %x1|Cardinal %x3|Linear %x0|B-Spline %x2|Constant %x4&quot;</span>),
<a name="l01398"></a>01398                    xs + 10.0f * unit, butr-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> + <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, unit * 4, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>,     &amp;coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#ae0d9bb51bbed4b47d419b30a13d248fd">ipotype</a>, 0.0, 0.0, 0, 0,
<a name="l01399"></a>01399                    <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Set interpolation between color stops&quot;</span>));
<a name="l01400"></a>01400     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01401"></a>01401 
<a name="l01402"></a>01402     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a84c5d75a8e1a067bb3def3f69049b22a">BUT_COLORBAND</a>, 0, <span class="stringliteral">&quot;&quot;</span>,       xs, butr-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, butr-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - butr-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, coba, 0, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01403"></a>01403     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01404"></a>01404 
<a name="l01405"></a>01405     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l01406"></a>01406 }
<a name="l01407"></a>01407 
<a name="l01408"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a2f711c1a20150706883ea3fcd28e1673">01408</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a2f711c1a20150706883ea3fcd28e1673">colorband_buttons_layout</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block, <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba, <a class="code" href="../../da/d10/structrctf.html">rctf</a> *butr, <span class="keywordtype">int</span> small, <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb)
<a name="l01409"></a>01409 {
<a name="l01410"></a>01410     <span class="keywordflow">if</span> (small)
<a name="l01411"></a>01411         <a class="code" href="../../d5/d05/interface__templates_8c.html#a48a6013a73bc6cfa40d0cf836dabbd15">colorband_buttons_small</a>(layout, block, coba, butr, cb);
<a name="l01412"></a>01412     <span class="keywordflow">else</span>
<a name="l01413"></a>01413         <a class="code" href="../../d5/d05/interface__templates_8c.html#aed185f49cdeae296ef505dbc51a1cd8d">colorband_buttons_large</a>(layout, block, coba, 0, 0, cb);
<a name="l01414"></a>01414 }
<a name="l01415"></a>01415 
<a name="l01416"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a76dccd99d7f508fda11b35a52cd31959">01416</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1b2dc02000f878b83904d5075e9ca782">uiTemplateColorRamp</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keywordtype">int</span> expand)
<a name="l01417"></a>01417 {
<a name="l01418"></a>01418     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l01419"></a>01419     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> cptr;
<a name="l01420"></a>01420     <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb;
<a name="l01421"></a>01421     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01422"></a>01422     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l01423"></a>01423 
<a name="l01424"></a>01424     <span class="keywordflow">if</span> (!prop || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>)
<a name="l01425"></a>01425         <span class="keywordflow">return</span>;
<a name="l01426"></a>01426 
<a name="l01427"></a>01427     cptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(ptr, prop);
<a name="l01428"></a>01428     <span class="keywordflow">if</span> (!cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> || !<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a595e4a9ce5947e1eb3181c1e512d184a">RNA_ColorRamp</a>))
<a name="l01429"></a>01429         <span class="keywordflow">return</span>;
<a name="l01430"></a>01430 
<a name="l01431"></a>01431     cb = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a>), <span class="stringliteral">&quot;RNAUpdateCb&quot;</span>);
<a name="l01432"></a>01432     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a> = *ptr;
<a name="l01433"></a>01433     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">prop</a> = prop;
<a name="l01434"></a>01434 
<a name="l01435"></a>01435     rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = 200;
<a name="l01436"></a>01436     rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = 190;
<a name="l01437"></a>01437 
<a name="l01438"></a>01438     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a3a59f6fe6879fcbf0c65360ebc007c">uiLayoutAbsoluteBlock</a>(layout);
<a name="l01439"></a>01439     <a class="code" href="../../d5/d05/interface__templates_8c.html#a2f711c1a20150706883ea3fcd28e1673">colorband_buttons_layout</a>(layout, block, cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>, &amp;rect, !expand, cb);
<a name="l01440"></a>01440 
<a name="l01441"></a>01441     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(cb);
<a name="l01442"></a>01442 }
<a name="l01443"></a>01443 
<a name="l01444"></a>01444 <span class="comment">/********************* Histogram Template ************************/</span>
<a name="l01445"></a>01445 
<a name="l01446"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#abac8b51d1025731239eee7911a66d858">01446</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a40d83cdb5d3bc0f262961766d8daa795">uiTemplateHistogram</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname)
<a name="l01447"></a>01447 {
<a name="l01448"></a>01448     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l01449"></a>01449     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> cptr;
<a name="l01450"></a>01450     <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb;
<a name="l01451"></a>01451     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01452"></a>01452     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt;
<a name="l01453"></a>01453     <a class="code" href="../../d4/d8b/structHistogram.html">Histogram</a> *hist;
<a name="l01454"></a>01454     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l01455"></a>01455     
<a name="l01456"></a>01456     <span class="keywordflow">if</span> (!prop || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>)
<a name="l01457"></a>01457         <span class="keywordflow">return</span>;
<a name="l01458"></a>01458     
<a name="l01459"></a>01459     cptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(ptr, prop);
<a name="l01460"></a>01460     <span class="keywordflow">if</span> (!cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> || !<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a11a948864bb482f9eeef8a365f8791d4">RNA_Histogram</a>))
<a name="l01461"></a>01461         <span class="keywordflow">return</span>;
<a name="l01462"></a>01462     
<a name="l01463"></a>01463     cb = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a>), <span class="stringliteral">&quot;RNAUpdateCb&quot;</span>);
<a name="l01464"></a>01464     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a> = *ptr;
<a name="l01465"></a>01465     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">prop</a> = prop;
<a name="l01466"></a>01466     
<a name="l01467"></a>01467     rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = 200;
<a name="l01468"></a>01468     rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = 190;
<a name="l01469"></a>01469     
<a name="l01470"></a>01470     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a3a59f6fe6879fcbf0c65360ebc007c">uiLayoutAbsoluteBlock</a>(layout);
<a name="l01471"></a>01471     <span class="comment">//colorband_buttons_layout(layout, block, cptr.data, &amp;rect, !expand, cb);</span>
<a name="l01472"></a>01472 
<a name="l01473"></a>01473     hist = (<a class="code" href="../../d4/d8b/structHistogram.html">Histogram</a> *)cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l01474"></a>01474 
<a name="l01475"></a>01475     hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#aa745e9495c4fb8768c0f1bfb65415030">height</a> = (hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#aa745e9495c4fb8768c0f1bfb65415030">height</a> &lt;= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>) ? <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> : hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#aa745e9495c4fb8768c0f1bfb65415030">height</a>;
<a name="l01476"></a>01476 
<a name="l01477"></a>01477     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a602a54df54894f53ce53e1011a1c5515">HISTOGRAM</a>, 0, <span class="stringliteral">&quot;&quot;</span>, rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#aa745e9495c4fb8768c0f1bfb65415030">height</a>, hist, 0, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01478"></a>01478     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01479"></a>01479 
<a name="l01480"></a>01480     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(cb);
<a name="l01481"></a>01481 }
<a name="l01482"></a>01482 
<a name="l01483"></a>01483 <span class="comment">/********************* Waveform Template ************************/</span>
<a name="l01484"></a>01484 
<a name="l01485"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a1d2945686bd8a139d6f8ac5f33345121">01485</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc298f3c1269b4be28b9033e9f20f95">uiTemplateWaveform</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname)
<a name="l01486"></a>01486 {
<a name="l01487"></a>01487     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l01488"></a>01488     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> cptr;
<a name="l01489"></a>01489     <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb;
<a name="l01490"></a>01490     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01491"></a>01491     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt;
<a name="l01492"></a>01492     <a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *scopes;
<a name="l01493"></a>01493     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l01494"></a>01494     
<a name="l01495"></a>01495     <span class="keywordflow">if</span> (!prop || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>)
<a name="l01496"></a>01496         <span class="keywordflow">return</span>;
<a name="l01497"></a>01497     
<a name="l01498"></a>01498     cptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(ptr, prop);
<a name="l01499"></a>01499     <span class="keywordflow">if</span> (!cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> || !<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a023eb537878479a4f6cba7aaa68aad1a">RNA_Scopes</a>))
<a name="l01500"></a>01500         <span class="keywordflow">return</span>;
<a name="l01501"></a>01501     scopes = (<a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *)cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l01502"></a>01502     
<a name="l01503"></a>01503     cb = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a>), <span class="stringliteral">&quot;RNAUpdateCb&quot;</span>);
<a name="l01504"></a>01504     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a> = *ptr;
<a name="l01505"></a>01505     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">prop</a> = prop;
<a name="l01506"></a>01506     
<a name="l01507"></a>01507     rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = 200;
<a name="l01508"></a>01508     rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = 190;
<a name="l01509"></a>01509     
<a name="l01510"></a>01510     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a3a59f6fe6879fcbf0c65360ebc007c">uiLayoutAbsoluteBlock</a>(layout);
<a name="l01511"></a>01511     
<a name="l01512"></a>01512     scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a0bb974670482bc2c2cdf8babc571ab7f">wavefrm_height</a> = (scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a0bb974670482bc2c2cdf8babc571ab7f">wavefrm_height</a> &lt;= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>) ? <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> : scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a0bb974670482bc2c2cdf8babc571ab7f">wavefrm_height</a>;
<a name="l01513"></a>01513 
<a name="l01514"></a>01514     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a0ebe5c598964d30fef9d41540637fc03">WAVEFORM</a>, 0, <span class="stringliteral">&quot;&quot;</span>, rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a0bb974670482bc2c2cdf8babc571ab7f">wavefrm_height</a>, scopes, 0, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01515"></a>01515     (void)bt; <span class="comment">// UNUSED</span>
<a name="l01516"></a>01516     
<a name="l01517"></a>01517     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(cb);
<a name="l01518"></a>01518 }
<a name="l01519"></a>01519 
<a name="l01520"></a>01520 <span class="comment">/********************* Vectorscope Template ************************/</span>
<a name="l01521"></a>01521 
<a name="l01522"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a4b5a6da988d59aee6e475c4e1f8a5776">01522</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6452c750c678a69657b24719e707856e">uiTemplateVectorscope</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname)
<a name="l01523"></a>01523 {
<a name="l01524"></a>01524     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l01525"></a>01525     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> cptr;
<a name="l01526"></a>01526     <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb;
<a name="l01527"></a>01527     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01528"></a>01528     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt;
<a name="l01529"></a>01529     <a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *scopes;
<a name="l01530"></a>01530     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l01531"></a>01531     
<a name="l01532"></a>01532     <span class="keywordflow">if</span> (!prop || <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>)
<a name="l01533"></a>01533         <span class="keywordflow">return</span>;
<a name="l01534"></a>01534     
<a name="l01535"></a>01535     cptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(ptr, prop);
<a name="l01536"></a>01536     <span class="keywordflow">if</span> (!cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> || !<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a023eb537878479a4f6cba7aaa68aad1a">RNA_Scopes</a>))
<a name="l01537"></a>01537         <span class="keywordflow">return</span>;
<a name="l01538"></a>01538     scopes = (<a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *)cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l01539"></a>01539 
<a name="l01540"></a>01540     cb = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a>), <span class="stringliteral">&quot;RNAUpdateCb&quot;</span>);
<a name="l01541"></a>01541     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a> = *ptr;
<a name="l01542"></a>01542     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">prop</a> = prop;
<a name="l01543"></a>01543     
<a name="l01544"></a>01544     rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = 200;
<a name="l01545"></a>01545     rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = 0; rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = 190;
<a name="l01546"></a>01546     
<a name="l01547"></a>01547     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a3a59f6fe6879fcbf0c65360ebc007c">uiLayoutAbsoluteBlock</a>(layout);
<a name="l01548"></a>01548 
<a name="l01549"></a>01549     scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a60c7ca02c8e7129c0498d956c4657d27">vecscope_height</a> = (scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a60c7ca02c8e7129c0498d956c4657d27">vecscope_height</a> &lt;= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>) ? <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> : scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a60c7ca02c8e7129c0498d956c4657d27">vecscope_height</a>;
<a name="l01550"></a>01550     
<a name="l01551"></a>01551     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#abeded13271071435e5d7d14a65f4c1be">VECTORSCOPE</a>, 0, <span class="stringliteral">&quot;&quot;</span>, rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, scopes-&gt;<a class="code" href="../../dc/db8/structScopes.html#a60c7ca02c8e7129c0498d956c4657d27">vecscope_height</a>, scopes, 0, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01552"></a>01552     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01553"></a>01553     
<a name="l01554"></a>01554     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(cb);
<a name="l01555"></a>01555 }
<a name="l01556"></a>01556 
<a name="l01557"></a>01557 <span class="comment">/********************* CurveMapping Template ************************/</span>
<a name="l01558"></a>01558 
<a name="l01559"></a>01559 
<a name="l01560"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a9974a173da0a4b5ba3a00c9859209d7d">01560</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a9974a173da0a4b5ba3a00c9859209d7d">curvemap_buttons_zoom_in</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cumap_v, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg))
<a name="l01561"></a>01561 {
<a name="l01562"></a>01562     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = cumap_v;
<a name="l01563"></a>01563     <span class="keywordtype">float</span> d;
<a name="l01564"></a>01564 
<a name="l01565"></a>01565     <span class="comment">/* we allow 20 times zoom */</span>
<a name="l01566"></a>01566     <span class="keywordflow">if</span> ( (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) &gt; 0.04f * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) ) {
<a name="l01567"></a>01567         d = 0.1154f * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>);
<a name="l01568"></a>01568         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> += d;
<a name="l01569"></a>01569         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> -= d;
<a name="l01570"></a>01570         d = 0.1154f * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>);
<a name="l01571"></a>01571         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> += d;
<a name="l01572"></a>01572         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> -= d;
<a name="l01573"></a>01573     }
<a name="l01574"></a>01574 
<a name="l01575"></a>01575     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C));
<a name="l01576"></a>01576 }
<a name="l01577"></a>01577 
<a name="l01578"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#abcc38f690a5c02989659fcc8dc7ba67d">01578</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#abcc38f690a5c02989659fcc8dc7ba67d">curvemap_buttons_zoom_out</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cumap_v, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l01579"></a>01579 {
<a name="l01580"></a>01580     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = cumap_v;
<a name="l01581"></a>01581     <span class="keywordtype">float</span> d, d1;
<a name="l01582"></a>01582 
<a name="l01583"></a>01583     <span class="comment">/* we allow 20 times zoom, but don&#39;t view outside clip */</span>
<a name="l01584"></a>01584     <span class="keywordflow">if</span> ( (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) &lt; 20.0f * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) ) {
<a name="l01585"></a>01585         d = d1 = 0.15f * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>);
<a name="l01586"></a>01586 
<a name="l01587"></a>01587         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a8649d5f9bc9f67e68cf78ffaa5b8695b">CUMA_DO_CLIP</a>) 
<a name="l01588"></a>01588             <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - d &lt; cumap-&gt;clipr.xmin)
<a name="l01589"></a>01589                 d1 = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>;
<a name="l01590"></a>01590         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> -= d1;
<a name="l01591"></a>01591 
<a name="l01592"></a>01592         d1 = d;
<a name="l01593"></a>01593         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a8649d5f9bc9f67e68cf78ffaa5b8695b">CUMA_DO_CLIP</a>) 
<a name="l01594"></a>01594             <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + d &gt; cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a>)
<a name="l01595"></a>01595                 d1 = -cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a>;
<a name="l01596"></a>01596         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> += d1;
<a name="l01597"></a>01597 
<a name="l01598"></a>01598         d = d1 = 0.15f * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>);
<a name="l01599"></a>01599 
<a name="l01600"></a>01600         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a8649d5f9bc9f67e68cf78ffaa5b8695b">CUMA_DO_CLIP</a>) 
<a name="l01601"></a>01601             <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - d &lt; cumap-&gt;clipr.ymin)
<a name="l01602"></a>01602                 d1 = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>;
<a name="l01603"></a>01603         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> -= d1;
<a name="l01604"></a>01604 
<a name="l01605"></a>01605         d1 = d;
<a name="l01606"></a>01606         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a8649d5f9bc9f67e68cf78ffaa5b8695b">CUMA_DO_CLIP</a>) 
<a name="l01607"></a>01607             <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + d &gt; cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>)
<a name="l01608"></a>01608                 d1 = -cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>;
<a name="l01609"></a>01609         cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> += d1;
<a name="l01610"></a>01610     }
<a name="l01611"></a>01611 
<a name="l01612"></a>01612     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C));
<a name="l01613"></a>01613 }
<a name="l01614"></a>01614 
<a name="l01615"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ae73d153ae79275a168158e68aaa4aa8b">01615</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ae73d153ae79275a168158e68aaa4aa8b">curvemap_buttons_setclip</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <span class="keywordtype">void</span> *cumap_v, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg))
<a name="l01616"></a>01616 {
<a name="l01617"></a>01617     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = cumap_v;
<a name="l01618"></a>01618 
<a name="l01619"></a>01619     <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01620"></a>01620 }   
<a name="l01621"></a>01621 
<a name="l01622"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#abda33b617cdefe4b5ebd29197e5a2db1">01622</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#abda33b617cdefe4b5ebd29197e5a2db1">curvemap_buttons_delete</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cb_v, <span class="keywordtype">void</span> *cumap_v)
<a name="l01623"></a>01623 {
<a name="l01624"></a>01624     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = cumap_v;
<a name="l01625"></a>01625 
<a name="l01626"></a>01626     <a class="code" href="../../d4/dca/BKE__colortools_8h.html#a5b0d2428f6b29f1224361bd544c5f847">curvemap_remove</a>(cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a> + cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>);
<a name="l01627"></a>01627     <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01628"></a>01628 
<a name="l01629"></a>01629     <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>(C, cb_v, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01630"></a>01630 }
<a name="l01631"></a>01631 
<a name="l01632"></a>01632 <span class="comment">/* NOTE: this is a block-menu, needs 0 events, otherwise the menu closes */</span>
<a name="l01633"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a60f67af8e05d614b20e11b9636c72c85">01633</a> <span class="keyword">static</span> <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *<a class="code" href="../../d5/d05/interface__templates_8c.html#a60f67af8e05d614b20e11b9636c72c85">curvemap_clipping_func</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keyword">struct</span> <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <span class="keywordtype">void</span> *cumap_v)
<a name="l01634"></a>01634 {
<a name="l01635"></a>01635     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = cumap_v;
<a name="l01636"></a>01636     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01637"></a>01637     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt;
<a name="l01638"></a>01638     <span class="keywordtype">float</span> width = 8 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>;
<a name="l01639"></a>01639 
<a name="l01640"></a>01640     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8bb41a5814e5120ba3c694cb35667128">uiBeginBlock</a>(C, ar, __func__, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01641"></a>01641 
<a name="l01642"></a>01642     <span class="comment">/* use this for a fake extra empy space around the buttons */</span>
<a name="l01643"></a>01643     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a0b7df70d4a086a227bc482b07e2bbbca">LABEL</a>, 0, <span class="stringliteral">&quot;&quot;</span>,           -4, 16, width + 8, 6 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01644"></a>01644 
<a name="l01645"></a>01645     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a082b1dfee3d913fe56f03fec26917fc8">uiDefButBitI</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>, <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a8649d5f9bc9f67e68cf78ffaa5b8695b">CUMA_DO_CLIP</a>, 1, <span class="stringliteral">&quot;Use Clipping&quot;</span>,
<a name="l01646"></a>01646                       0, 5 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, width, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a>, 0.0, 0.0, 10, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01647"></a>01647     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#ae73d153ae79275a168158e68aaa4aa8b">curvemap_buttons_setclip</a>, cumap, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01648"></a>01648 
<a name="l01649"></a>01649     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4c674e4e473631554c7372d8c6cb36e">uiBlockBeginAlign</a>(block);
<a name="l01650"></a>01650     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a73aec674c9611056494cc213961e6116">uiDefButF</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#aaf0952059602752258dccaa015d7b54a">NUM</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Min X &quot;</span>),   0, 4 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, width, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, -100.0, cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a>, 10, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01651"></a>01651     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a73aec674c9611056494cc213961e6116">uiDefButF</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#aaf0952059602752258dccaa015d7b54a">NUM</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Min Y &quot;</span>),   0, 3 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, width, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, -100.0, cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>, 10, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01652"></a>01652     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a73aec674c9611056494cc213961e6116">uiDefButF</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#aaf0952059602752258dccaa015d7b54a">NUM</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Max X &quot;</span>),   0, 2 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, width, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a>, cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, 100.0, 10, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01653"></a>01653     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a73aec674c9611056494cc213961e6116">uiDefButF</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#aaf0952059602752258dccaa015d7b54a">NUM</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Max Y &quot;</span>),   0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, width, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>, cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, 100.0, 10, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01654"></a>01654 
<a name="l01655"></a>01655     <a class="code" href="../../d8/d1e/UI__interface_8h.html#af0d71fa48a234ba4cb707b670455c913">uiBlockSetDirection</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8350d6c621c09b1989b60d24369844f9">UI_RIGHT</a>);
<a name="l01656"></a>01656 
<a name="l01657"></a>01657     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ac166273cd2c217e8b1da1bdac55a8ef8">uiEndBlock</a>(C, block);
<a name="l01658"></a>01658     <span class="keywordflow">return</span> block;
<a name="l01659"></a>01659 }
<a name="l01660"></a>01660 
<a name="l01661"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a35adcae6056273aa7ea98c2af81f3619">01661</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a35adcae6056273aa7ea98c2af81f3619">curvemap_tools_dofunc</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cumap_v, <span class="keywordtype">int</span> event)
<a name="l01662"></a>01662 {
<a name="l01663"></a>01663     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = cumap_v;
<a name="l01664"></a>01664     <a class="code" href="../../df/d78/structCurveMap.html">CurveMap</a> *cuma = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a> + cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>;
<a name="l01665"></a>01665 
<a name="l01666"></a>01666     <span class="keywordflow">switch</span> (event) {
<a name="l01667"></a>01667         <span class="keywordflow">case</span> 0: <span class="comment">/* reset */</span>
<a name="l01668"></a>01668             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#ac3ec3c6480f50624abef2aa621aba9b1">curvemap_reset</a>(cuma, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>, cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a799bee38fb167d41e7ff198e86e359f5">preset</a>, <a class="code" href="../../d4/dca/BKE__colortools_8h.html#a3f661a1286c9eae498b8e25041407840">CURVEMAP_SLOPE_POSITIVE</a>);
<a name="l01669"></a>01669             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01670"></a>01670             <span class="keywordflow">break</span>;
<a name="l01671"></a>01671         <span class="keywordflow">case</span> 1:
<a name="l01672"></a>01672             cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a> = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>;
<a name="l01673"></a>01673             <span class="keywordflow">break</span>;
<a name="l01674"></a>01674         <span class="keywordflow">case</span> 2: <span class="comment">/* set vector */</span>
<a name="l01675"></a>01675             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#a38317d5a425c0583c43400bbbab82ff9">curvemap_sethandle</a>(cuma, 1);
<a name="l01676"></a>01676             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01677"></a>01677             <span class="keywordflow">break</span>;
<a name="l01678"></a>01678         <span class="keywordflow">case</span> 3: <span class="comment">/* set auto */</span>
<a name="l01679"></a>01679             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#a38317d5a425c0583c43400bbbab82ff9">curvemap_sethandle</a>(cuma, 0);
<a name="l01680"></a>01680             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01681"></a>01681             <span class="keywordflow">break</span>;
<a name="l01682"></a>01682         <span class="keywordflow">case</span> 4: <span class="comment">/* extend horiz */</span>
<a name="l01683"></a>01683             cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#ab8bdb4a30d4ac21edb9c7f0fe4784c9c">flag</a> &amp;= ~<a class="code" href="../../da/ddd/DNA__color__types_8h.html#a53e0b7a779b29f4940c4eae3fd37ad8d">CUMA_EXTEND_EXTRAPOLATE</a>;
<a name="l01684"></a>01684             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01685"></a>01685             <span class="keywordflow">break</span>;
<a name="l01686"></a>01686         <span class="keywordflow">case</span> 5: <span class="comment">/* extend extrapolate */</span>
<a name="l01687"></a>01687             cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#ab8bdb4a30d4ac21edb9c7f0fe4784c9c">flag</a> |= <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a53e0b7a779b29f4940c4eae3fd37ad8d">CUMA_EXTEND_EXTRAPOLATE</a>;
<a name="l01688"></a>01688             <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01689"></a>01689             <span class="keywordflow">break</span>;
<a name="l01690"></a>01690     }
<a name="l01691"></a>01691     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C));
<a name="l01692"></a>01692 }
<a name="l01693"></a>01693 
<a name="l01694"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a0d34d2853b32c46acd65b16b96379555">01694</a> <span class="keyword">static</span> <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *<a class="code" href="../../d5/d05/interface__templates_8c.html#a0d34d2853b32c46acd65b16b96379555">curvemap_tools_func</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keyword">struct</span> <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <span class="keywordtype">void</span> *cumap_v)
<a name="l01695"></a>01695 {
<a name="l01696"></a>01696     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01697"></a>01697     <span class="keywordtype">short</span> yco = 0, menuwidth = 10 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>;
<a name="l01698"></a>01698 
<a name="l01699"></a>01699     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8bb41a5814e5120ba3c694cb35667128">uiBeginBlock</a>(C, ar, __func__, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01700"></a>01700     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a5806b83d265179aee6726334e1bb62">uiBlockSetButmFunc</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a35adcae6056273aa7ea98c2af81f3619">curvemap_tools_dofunc</a>, cumap_v);
<a name="l01701"></a>01701 
<a name="l01702"></a>01702     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Reset View&quot;</span>),         0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 1, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01703"></a>01703     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Vector Handle&quot;</span>),      0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 2, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01704"></a>01704     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Auto Handle&quot;</span>),            0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 3, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01705"></a>01705     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Extend Horizontal&quot;</span>),  0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 4, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01706"></a>01706     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Extend Extrapolated&quot;</span>),    0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 5, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01707"></a>01707     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Reset Curve&quot;</span>),            0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01708"></a>01708 
<a name="l01709"></a>01709     <a class="code" href="../../d8/d1e/UI__interface_8h.html#af0d71fa48a234ba4cb707b670455c913">uiBlockSetDirection</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8350d6c621c09b1989b60d24369844f9">UI_RIGHT</a>);
<a name="l01710"></a>01710     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3da212c864f001199ffa32dbbebf5419">uiTextBoundsBlock</a>(block, 50);
<a name="l01711"></a>01711 
<a name="l01712"></a>01712     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ac166273cd2c217e8b1da1bdac55a8ef8">uiEndBlock</a>(C, block);
<a name="l01713"></a>01713     <span class="keywordflow">return</span> block;
<a name="l01714"></a>01714 }
<a name="l01715"></a>01715 
<a name="l01716"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ad1b7e2d80d5c96ca23919f92898b101f">01716</a> <span class="keyword">static</span> <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *<a class="code" href="../../d5/d05/interface__templates_8c.html#ad1b7e2d80d5c96ca23919f92898b101f">curvemap_brush_tools_func</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keyword">struct</span> <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <span class="keywordtype">void</span> *cumap_v)
<a name="l01717"></a>01717 {
<a name="l01718"></a>01718     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01719"></a>01719     <span class="keywordtype">short</span> yco = 0, menuwidth = 10 * <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>;
<a name="l01720"></a>01720 
<a name="l01721"></a>01721     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8bb41a5814e5120ba3c694cb35667128">uiBeginBlock</a>(C, ar, __func__, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01722"></a>01722     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5a5806b83d265179aee6726334e1bb62">uiBlockSetButmFunc</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a35adcae6056273aa7ea98c2af81f3619">curvemap_tools_dofunc</a>, cumap_v);
<a name="l01723"></a>01723 
<a name="l01724"></a>01724     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Reset View&quot;</span>),     0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 1, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01725"></a>01725     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Vector Handle&quot;</span>),  0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 2, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01726"></a>01726     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Auto Handle&quot;</span>),        0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 3, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01727"></a>01727     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7489385fb8eddb0eabd9fc4c3954e653">BUTM</a>, 1, ICON_BLANK1, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Reset Curve&quot;</span>),        0, yco -= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, menuwidth, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01728"></a>01728 
<a name="l01729"></a>01729     <a class="code" href="../../d8/d1e/UI__interface_8h.html#af0d71fa48a234ba4cb707b670455c913">uiBlockSetDirection</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8350d6c621c09b1989b60d24369844f9">UI_RIGHT</a>);
<a name="l01730"></a>01730     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3da212c864f001199ffa32dbbebf5419">uiTextBoundsBlock</a>(block, 50);
<a name="l01731"></a>01731 
<a name="l01732"></a>01732     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ac166273cd2c217e8b1da1bdac55a8ef8">uiEndBlock</a>(C, block);
<a name="l01733"></a>01733     <span class="keywordflow">return</span> block;
<a name="l01734"></a>01734 }
<a name="l01735"></a>01735 
<a name="l01736"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">01736</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg1), <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg2))
<a name="l01737"></a>01737 {
<a name="l01738"></a>01738     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C));
<a name="l01739"></a>01739 }
<a name="l01740"></a>01740 
<a name="l01741"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a99856dd9deb1455a52885625962cfacf">01741</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a99856dd9deb1455a52885625962cfacf">curvemap_buttons_reset</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *cb_v, <span class="keywordtype">void</span> *cumap_v)
<a name="l01742"></a>01742 {
<a name="l01743"></a>01743     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = cumap_v;
<a name="l01744"></a>01744     <span class="keywordtype">int</span> a;
<a name="l01745"></a>01745     
<a name="l01746"></a>01746     cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a799bee38fb167d41e7ff198e86e359f5">preset</a> = <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a6dd78cb24fdca0792ce9e05b433409ceab43f7b14706115e66df1ba82ad101cc0">CURVE_PRESET_LINE</a>;
<a name="l01747"></a>01747     <span class="keywordflow">for</span> (a = 0; a &lt; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a03be79f4468bc6e046fbc08cb1f3f98c">CM_TOT</a>; a++)
<a name="l01748"></a>01748         <a class="code" href="../../d4/dca/BKE__colortools_8h.html#ac3ec3c6480f50624abef2aa621aba9b1">curvemap_reset</a>(cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a> + a, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>, cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a799bee38fb167d41e7ff198e86e359f5">preset</a>, <a class="code" href="../../d4/dca/BKE__colortools_8h.html#a3f661a1286c9eae498b8e25041407840">CURVEMAP_SLOPE_POSITIVE</a>);
<a name="l01749"></a>01749     
<a name="l01750"></a>01750     cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abe65d7070e469add475cbd0c619fd21d">black</a>[0] = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abe65d7070e469add475cbd0c619fd21d">black</a>[1] = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abe65d7070e469add475cbd0c619fd21d">black</a>[2] = 0.0f;
<a name="l01751"></a>01751     cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a97dbb7bbe74df4e0d3df0e2daf19173b">white</a>[0] = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a97dbb7bbe74df4e0d3df0e2daf19173b">white</a>[1] = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a97dbb7bbe74df4e0d3df0e2daf19173b">white</a>[2] = 1.0f;
<a name="l01752"></a>01752     <a class="code" href="../../d4/dca/BKE__colortools_8h.html#ada939d01e9436006abd067b30fab2e28">curvemapping_set_black_white</a>(cumap, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01753"></a>01753     
<a name="l01754"></a>01754     <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);
<a name="l01755"></a>01755 
<a name="l01756"></a>01756     <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>(C, cb_v, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01757"></a>01757 }
<a name="l01758"></a>01758 
<a name="l01759"></a>01759 <span class="comment">/* still unsure how this call evolves... we use labeltype for defining what curve-channels to show */</span>
<a name="l01760"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a70d8a8201080e6e8e93b21d698a027a9">01760</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a70d8a8201080e6e8e93b21d698a027a9">curvemap_buttons_layout</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keywordtype">char</span> labeltype, <span class="keywordtype">int</span> levels, <span class="keywordtype">int</span> brush, <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb)
<a name="l01761"></a>01761 {
<a name="l01762"></a>01762     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap = ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l01763"></a>01763     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *row, *sub, *<a class="code" href="../../d8/d40/btDbvt_8cpp.html#ad08f07bba2ea0c5c64802b70c686fc68">split</a>;
<a name="l01764"></a>01764     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l01765"></a>01765     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *bt;
<a name="l01766"></a>01766     <span class="keywordtype">float</span> dx = <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>;
<a name="l01767"></a>01767     <span class="keywordtype">int</span> icon, <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>;
<a name="l01768"></a>01768     <span class="keywordtype">int</span> bg = -1;
<a name="l01769"></a>01769 
<a name="l01770"></a>01770     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l01771"></a>01771 
<a name="l01772"></a>01772     <span class="comment">/* curve chooser */</span>
<a name="l01773"></a>01773     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 0);
<a name="l01774"></a>01774 
<a name="l01775"></a>01775     <span class="keywordflow">if</span> (labeltype == <span class="charliteral">&#39;v&#39;</span>) {
<a name="l01776"></a>01776         <span class="comment">/* vector */</span>
<a name="l01777"></a>01777         sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(row, 1);
<a name="l01778"></a>01778         <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(sub, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a799ed6b44b8ea9f302943a3ddfc697de">UI_LAYOUT_ALIGN_LEFT</a>);
<a name="l01779"></a>01779 
<a name="l01780"></a>01780         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[0].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01781"></a>01781             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;X&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 0.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01782"></a>01782             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01783"></a>01783         }
<a name="l01784"></a>01784         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[1].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01785"></a>01785             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;Y&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 1.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01786"></a>01786             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01787"></a>01787         }
<a name="l01788"></a>01788         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[2].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01789"></a>01789             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;Z&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 2.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01790"></a>01790             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01791"></a>01791         }
<a name="l01792"></a>01792     }
<a name="l01793"></a>01793     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (labeltype == <span class="charliteral">&#39;c&#39;</span>) {
<a name="l01794"></a>01794         <span class="comment">/* color */</span>
<a name="l01795"></a>01795         sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(row, 1);
<a name="l01796"></a>01796         <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(sub, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a799ed6b44b8ea9f302943a3ddfc697de">UI_LAYOUT_ALIGN_LEFT</a>);
<a name="l01797"></a>01797 
<a name="l01798"></a>01798         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[3].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01799"></a>01799             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;C&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 3.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01800"></a>01800             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01801"></a>01801         }
<a name="l01802"></a>01802         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[0].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01803"></a>01803             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;R&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 0.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01804"></a>01804             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01805"></a>01805         }
<a name="l01806"></a>01806         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[1].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01807"></a>01807             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;G&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 1.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01808"></a>01808             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01809"></a>01809         }
<a name="l01810"></a>01810         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[2].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01811"></a>01811             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;B&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 2.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01812"></a>01812             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01813"></a>01813         }
<a name="l01814"></a>01814     }
<a name="l01815"></a>01815     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (labeltype == <span class="charliteral">&#39;h&#39;</span>) {
<a name="l01816"></a>01816         <span class="comment">/* HSV */</span>
<a name="l01817"></a>01817         sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(row, 1);
<a name="l01818"></a>01818         <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(sub, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a799ed6b44b8ea9f302943a3ddfc697de">UI_LAYOUT_ALIGN_LEFT</a>);
<a name="l01819"></a>01819         
<a name="l01820"></a>01820         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[0].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01821"></a>01821             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;H&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 0.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01822"></a>01822             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01823"></a>01823         }
<a name="l01824"></a>01824         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[1].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01825"></a>01825             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;S&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 1.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01826"></a>01826             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01827"></a>01827         }
<a name="l01828"></a>01828         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a>[2].<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>) {
<a name="l01829"></a>01829             bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a4d92d07523ba751afadecd63d3479e30abf470e461303b909bf0dc58084ebafa0">ROW</a>, 0, <span class="stringliteral">&quot;V&quot;</span>, 0, 0, dx, dx, &amp;cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>, 0.0, 2.0, 0.0, 0.0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01830"></a>01830             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#aede2b293746d31bb047730857ec6c253">curvemap_buttons_redraw</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01831"></a>01831         }
<a name="l01832"></a>01832     }
<a name="l01833"></a>01833     <span class="keywordflow">else</span>
<a name="l01834"></a>01834         <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(row, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a697e2a0e180427a09cbdd46d1c8a221b">UI_LAYOUT_ALIGN_RIGHT</a>);
<a name="l01835"></a>01835     
<a name="l01836"></a>01836     <span class="keywordflow">if</span> (labeltype == <span class="charliteral">&#39;h&#39;</span>)
<a name="l01837"></a>01837         bg = <a class="code" href="../../d8/d1e/UI__interface_8h.html#acf9f25115e50fa96e2aea41929d3c42c">UI_GRAD_H</a>;
<a name="l01838"></a>01838 
<a name="l01839"></a>01839     <span class="comment">/* operation buttons */</span>
<a name="l01840"></a>01840     sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(row, 1);
<a name="l01841"></a>01841 
<a name="l01842"></a>01842     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l01843"></a>01843 
<a name="l01844"></a>01844     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_ZOOMIN, 0, 0, dx, dx, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Zoom in&quot;</span>));
<a name="l01845"></a>01845     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a9974a173da0a4b5ba3a00c9859209d7d">curvemap_buttons_zoom_in</a>, cumap, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01846"></a>01846 
<a name="l01847"></a>01847     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_ZOOMOUT, 0, 0, dx, dx, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Zoom out&quot;</span>));
<a name="l01848"></a>01848     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#abcc38f690a5c02989659fcc8dc7ba67d">curvemap_buttons_zoom_out</a>, cumap, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01849"></a>01849 
<a name="l01850"></a>01850     <span class="keywordflow">if</span> (brush)
<a name="l01851"></a>01851         bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a136317d2e29ca28b1f30d659c51d02e1">uiDefIconBlockBut</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#ad1b7e2d80d5c96ca23919f92898b101f">curvemap_brush_tools_func</a>, cumap, 0, ICON_MODIFIER, 0, 0, dx, dx, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Tools&quot;</span>));
<a name="l01852"></a>01852     <span class="keywordflow">else</span>
<a name="l01853"></a>01853         bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a136317d2e29ca28b1f30d659c51d02e1">uiDefIconBlockBut</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a0d34d2853b32c46acd65b16b96379555">curvemap_tools_func</a>, cumap, 0, ICON_MODIFIER, 0, 0, dx, dx, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Tools&quot;</span>));
<a name="l01854"></a>01854 
<a name="l01855"></a>01855     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01856"></a>01856 
<a name="l01857"></a>01857     <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a8649d5f9bc9f67e68cf78ffaa5b8695b">CUMA_DO_CLIP</a>) icon = ICON_CLIPUV_HLT; <span class="keywordflow">else</span> icon = ICON_CLIPUV_DEHLT;
<a name="l01858"></a>01858     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a136317d2e29ca28b1f30d659c51d02e1">uiDefIconBlockBut</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a60f67af8e05d614b20e11b9636c72c85">curvemap_clipping_func</a>, cumap, 0, icon, 0, 0, dx, dx, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Clipping Options&quot;</span>));
<a name="l01859"></a>01859     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01860"></a>01860 
<a name="l01861"></a>01861     bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_X, 0, 0, dx, dx, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Delete points&quot;</span>));
<a name="l01862"></a>01862     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#abda33b617cdefe4b5ebd29197e5a2db1">curvemap_buttons_delete</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), cumap);
<a name="l01863"></a>01863 
<a name="l01864"></a>01864     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l01865"></a>01865 
<a name="l01866"></a>01866     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a0a3d0f2692b6eaa7efdb396af76afeb1">uiBlockSetNFunc</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a48df5acd8425124d890f2d427be87958">rna_update_cb</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01867"></a>01867 
<a name="l01868"></a>01868     <span class="comment">/* curve itself */</span>
<a name="l01869"></a>01869     size = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa6198e7355c354fe28b233c97c323aa2">uiLayoutGetWidth</a>(layout);
<a name="l01870"></a>01870     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 0);
<a name="l01871"></a>01871     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a55737ebfa3a2ec487e87544adbf7e457">BUT_CURVE</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, size, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(size, 200), cumap, 0.0f, 1.0f, bg, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01872"></a>01872 
<a name="l01873"></a>01873     <span class="comment">/* black/white levels */</span>
<a name="l01874"></a>01874     <span class="keywordflow">if</span> (levels) {
<a name="l01875"></a>01875         split = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a81b59d1d72c4105842646d41bc39c972">uiLayoutSplit</a>(layout, 0, 0);
<a name="l01876"></a>01876         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(split, 0), ptr, <span class="stringliteral">&quot;black_level&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4a1fb80bd5ce016a62ba2c23e992aa89">UI_ITEM_R_EXPAND</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l01877"></a>01877         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(split, 0), ptr, <span class="stringliteral">&quot;white_level&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4a1fb80bd5ce016a62ba2c23e992aa89">UI_ITEM_R_EXPAND</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l01878"></a>01878 
<a name="l01879"></a>01879         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 0);
<a name="l01880"></a>01880         bt = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Reset&quot;</span>), 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0,
<a name="l01881"></a>01881                       <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Reset Black/White point and curves&quot;</span>));
<a name="l01882"></a>01882         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aeb04b1acc3bfca77e8ceec6590d59ef2">uiButSetNFunc</a>(bt, <a class="code" href="../../d5/d05/interface__templates_8c.html#a99856dd9deb1455a52885625962cfacf">curvemap_buttons_reset</a>, <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(cb), cumap);
<a name="l01883"></a>01883     }
<a name="l01884"></a>01884 
<a name="l01885"></a>01885     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a0a3d0f2692b6eaa7efdb396af76afeb1">uiBlockSetNFunc</a>(block, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01886"></a>01886 }
<a name="l01887"></a>01887 
<a name="l01888"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a8963f535d012317a5af10054de1f0083">01888</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a76cfc8c3547502b745359e3b6aa9ca31">uiTemplateCurveMapping</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keywordtype">int</span> type, <span class="keywordtype">int</span> levels, <span class="keywordtype">int</span> brush)
<a name="l01889"></a>01889 {
<a name="l01890"></a>01890     <a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a> *cb;
<a name="l01891"></a>01891     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l01892"></a>01892     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> cptr;
<a name="l01893"></a>01893 
<a name="l01894"></a>01894     <span class="keywordflow">if</span> (!prop) {
<a name="l01895"></a>01895         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;curve property not found: %s.%s&quot;</span>,
<a name="l01896"></a>01896                     <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l01897"></a>01897         <span class="keywordflow">return</span>;
<a name="l01898"></a>01898     }
<a name="l01899"></a>01899 
<a name="l01900"></a>01900     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop) != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>) {
<a name="l01901"></a>01901         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;curve is not a pointer: %s.%s&quot;</span>,
<a name="l01902"></a>01902                     <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l01903"></a>01903         <span class="keywordflow">return</span>;
<a name="l01904"></a>01904     }
<a name="l01905"></a>01905 
<a name="l01906"></a>01906     cptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(ptr, prop);
<a name="l01907"></a>01907     <span class="keywordflow">if</span> (!cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> || !<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(cptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ac3da5ca6a01e7ac856d0a3afb3e3b0fb">RNA_CurveMapping</a>))
<a name="l01908"></a>01908         <span class="keywordflow">return</span>;
<a name="l01909"></a>01909 
<a name="l01910"></a>01910     cb = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d44/structRNAUpdateCb.html">RNAUpdateCb</a>), <span class="stringliteral">&quot;RNAUpdateCb&quot;</span>);
<a name="l01911"></a>01911     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#a4a2528935bcea594d50ff0b60e9cf9d2">ptr</a> = *ptr;
<a name="l01912"></a>01912     cb-&gt;<a class="code" href="../../d7/d44/structRNAUpdateCb.html#ac5d8f8a37f7c4d45a2217cf2dc0abfd4">prop</a> = prop;
<a name="l01913"></a>01913 
<a name="l01914"></a>01914     <a class="code" href="../../d5/d05/interface__templates_8c.html#a70d8a8201080e6e8e93b21d698a027a9">curvemap_buttons_layout</a>(layout, &amp;cptr, type, levels, brush, cb);
<a name="l01915"></a>01915 
<a name="l01916"></a>01916     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(cb);
<a name="l01917"></a>01917 }
<a name="l01918"></a>01918 
<a name="l01919"></a>01919 <span class="comment">/********************* ColorWheel Template ************************/</span>
<a name="l01920"></a>01920 
<a name="l01921"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a2733ceaadab31da68b8568673d619b47">01921</a> <span class="preprocessor">#define WHEEL_SIZE  100</span>
<a name="l01922"></a>01922 <span class="preprocessor"></span>
<a name="l01923"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aa03281db0b27e0c8401c51f17d342476">01923</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a72bde1075c1bc71a944d2c1664a2fec1">uiTemplateColorWheel</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <span class="keywordtype">int</span> value_slider, <span class="keywordtype">int</span> lock, <span class="keywordtype">int</span> lock_luminosity, <span class="keywordtype">int</span> cubic)
<a name="l01924"></a>01924 {
<a name="l01925"></a>01925     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l01926"></a>01926     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l01927"></a>01927     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *col, *row;
<a name="l01928"></a>01928     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l01929"></a>01929     <span class="keywordtype">float</span> softmin, softmax, <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>, precision;
<a name="l01930"></a>01930     
<a name="l01931"></a>01931     <span class="keywordflow">if</span> (!prop) {
<a name="l01932"></a>01932         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l01933"></a>01933         <span class="keywordflow">return</span>;
<a name="l01934"></a>01934     }
<a name="l01935"></a>01935 
<a name="l01936"></a>01936     <a class="code" href="../../d3/d10/rna__access_8c.html#a3218cb137faf47ff47445e252251a87d">RNA_property_float_ui_range</a>(ptr, prop, &amp;softmin, &amp;softmax, &amp;step, &amp;precision);
<a name="l01937"></a>01937     
<a name="l01938"></a>01938     col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(layout, 0);
<a name="l01939"></a>01939     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(col, 1);
<a name="l01940"></a>01940     
<a name="l01941"></a>01941     but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7ab0e58f362f17f258b8696da210fd36">uiDefButR_prop</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#af5b7a7238e8eaabdbec6a107c41f426a">HSVCIRCLE</a>, 0, <span class="stringliteral">&quot;&quot;</span>,   0, 0, <a class="code" href="../../d5/d05/interface__templates_8c.html#a2733ceaadab31da68b8568673d619b47">WHEEL_SIZE</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#a2733ceaadab31da68b8568673d619b47">WHEEL_SIZE</a>, ptr, prop, -1, 0.0, 0.0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01942"></a>01942 
<a name="l01943"></a>01943     <span class="keywordflow">if</span> (lock) {
<a name="l01944"></a>01944         but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a23817cfadf5bb0c6ec9bc28eeffc1368">flag</a> |= <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa0865984d0d3142903ad29a4d571967d">UI_BUT_COLOR_LOCK</a>;
<a name="l01945"></a>01945     }
<a name="l01946"></a>01946 
<a name="l01947"></a>01947     <span class="keywordflow">if</span> (lock_luminosity) {
<a name="l01948"></a>01948         <span class="keywordtype">float</span> color[4]; <span class="comment">/* in case of alpha */</span>
<a name="l01949"></a>01949         but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a23817cfadf5bb0c6ec9bc28eeffc1368">flag</a> |= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a47aba7a3a2fe2496b3cb1ba9a15efa1a">UI_BUT_VEC_SIZE_LOCK</a>;
<a name="l01950"></a>01950         <a class="code" href="../../d3/d10/rna__access_8c.html#a151557228dae14af24d5e1b57495642b">RNA_property_float_get_array</a>(ptr, prop, color);
<a name="l01951"></a>01951         but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#adabf3be1173f6353f40cde0c6519312c">a2</a> = <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a5dedd24d16c008a3d9e5fc0c4db3fa81">len_v3</a>(color);
<a name="l01952"></a>01952     }
<a name="l01953"></a>01953 
<a name="l01954"></a>01954     <span class="keywordflow">if</span> (cubic)
<a name="l01955"></a>01955         but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a23817cfadf5bb0c6ec9bc28eeffc1368">flag</a> |= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a10c42d8b0adb470a8abb4bd16c670d1f">UI_BUT_COLOR_CUBIC</a>;
<a name="l01956"></a>01956 
<a name="l01957"></a>01957     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5e3bb0f5147561627b0f3f92789476bd">uiItemS</a>(row);
<a name="l01958"></a>01958     
<a name="l01959"></a>01959     <span class="keywordflow">if</span> (value_slider)
<a name="l01960"></a>01960         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7ab0e58f362f17f258b8696da210fd36">uiDefButR_prop</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aaaed62f927be1bd36851e7a3008a35c2">HSVCUBE</a>, 0, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d5/d05/interface__templates_8c.html#a2733ceaadab31da68b8568673d619b47">WHEEL_SIZE</a> + 6, 0, 14, <a class="code" href="../../d5/d05/interface__templates_8c.html#a2733ceaadab31da68b8568673d619b47">WHEEL_SIZE</a>, ptr, prop, -1, softmin, softmax, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa15a85263ddb1caa2c928032de812a8e">UI_GRAD_V_ALT</a>, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01961"></a>01961 }
<a name="l01962"></a>01962 
<a name="l01963"></a>01963 <span class="comment">/********************* Layer Buttons Template ************************/</span>
<a name="l01964"></a>01964 
<a name="l01965"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#acbcdf2f283c79885775d3e776ea07197">01965</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#acbcdf2f283c79885775d3e776ea07197">handle_layer_buttons</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *arg1, <span class="keywordtype">void</span> *arg2)
<a name="l01966"></a>01966 {
<a name="l01967"></a>01967     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but = arg1;
<a name="l01968"></a>01968     <span class="keywordtype">int</span> cur = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#afe52e69b7f74d4e0319b467db917c08c">GET_INT_FROM_POINTER</a>(arg2);
<a name="l01969"></a>01969     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win = <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C);
<a name="l01970"></a>01970     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, tot, shift = win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a1c950f3f8bc3e99973abac8e510d0835">eventstate</a>-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a284c581e97d510de46fd27af4557c7d9">shift</a>;
<a name="l01971"></a>01971 
<a name="l01972"></a>01972     <span class="keywordflow">if</span> (!shift) {
<a name="l01973"></a>01973         tot = <a class="code" href="../../d3/d10/rna__access_8c.html#aad51db9a31d245dba4ee1f50608f331c">RNA_property_array_length</a>(&amp;but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#afd86c402bb3c4c40bac45a5023b09128">rnapoin</a>, but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#aee4d22f7078e1b1ed74fee4e0e97c621">rnaprop</a>);
<a name="l01974"></a>01974         
<a name="l01975"></a>01975         <span class="comment">/* Normally clicking only selects one layer */</span>
<a name="l01976"></a>01976         <a class="code" href="../../d3/d10/rna__access_8c.html#a658adde6477f2ecaf4b04402f1585e01">RNA_property_boolean_set_index</a>(&amp;but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#afd86c402bb3c4c40bac45a5023b09128">rnapoin</a>, but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#aee4d22f7078e1b1ed74fee4e0e97c621">rnaprop</a>, cur, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01977"></a>01977         <span class="keywordflow">for</span> (i = 0; i &lt; tot; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {
<a name="l01978"></a>01978             <span class="keywordflow">if</span> (i != cur)
<a name="l01979"></a>01979                 <a class="code" href="../../d3/d10/rna__access_8c.html#a658adde6477f2ecaf4b04402f1585e01">RNA_property_boolean_set_index</a>(&amp;but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#afd86c402bb3c4c40bac45a5023b09128">rnapoin</a>, but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#aee4d22f7078e1b1ed74fee4e0e97c621">rnaprop</a>, i, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01980"></a>01980         }
<a name="l01981"></a>01981     }
<a name="l01982"></a>01982     
<a name="l01983"></a>01983     <span class="comment">/* view3d layer change should update depsgraph (invisible object changed maybe) */</span>
<a name="l01984"></a>01984     <span class="comment">/* see view3d_header.c */</span>
<a name="l01985"></a>01985 }
<a name="l01986"></a>01986 
<a name="l01987"></a>01987 <span class="comment">// TODO:</span>
<a name="l01988"></a>01988 <span class="comment">//  - for now, grouping of layers is determined by dividing up the length of </span>
<a name="l01989"></a>01989 <span class="comment">//    the array of layer bitflags</span>
<a name="l01990"></a>01990 
<a name="l01991"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a36640b59e07ef2b4fa49d2e146f19399">01991</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a609516c70c66b24e456d331e5d6e35df">uiTemplateLayers</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname,
<a name="l01992"></a>01992                       <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *used_ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *used_propname, <span class="keywordtype">int</span> active_layer)
<a name="l01993"></a>01993 {
<a name="l01994"></a>01994     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *uRow, *uCol;
<a name="l01995"></a>01995     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop, *used_prop = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01996"></a>01996     <span class="keywordtype">int</span> groups, cols, layers;
<a name="l01997"></a>01997     <span class="keywordtype">int</span> group, col, layer, row;
<a name="l01998"></a>01998     <span class="keywordtype">int</span> cols_per_group = 5;
<a name="l01999"></a>01999 
<a name="l02000"></a>02000     prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l02001"></a>02001     <span class="keywordflow">if</span> (!prop) {
<a name="l02002"></a>02002         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;layers property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l02003"></a>02003         <span class="keywordflow">return</span>;
<a name="l02004"></a>02004     }
<a name="l02005"></a>02005     
<a name="l02006"></a>02006     <span class="comment">/* the number of layers determines the way we group them </span>
<a name="l02007"></a>02007 <span class="comment">     *  - we want 2 rows only (for now)</span>
<a name="l02008"></a>02008 <span class="comment">     *  - the number of columns (cols) is the total number of buttons per row</span>
<a name="l02009"></a>02009 <span class="comment">     *    the &#39;remainder&#39; is added to this, as it will be ok to have first row slightly wider if need be</span>
<a name="l02010"></a>02010 <span class="comment">     *  - for now, only split into groups if group will have at least 5 items</span>
<a name="l02011"></a>02011 <span class="comment">     */</span>
<a name="l02012"></a>02012     layers = <a class="code" href="../../d3/d10/rna__access_8c.html#aad51db9a31d245dba4ee1f50608f331c">RNA_property_array_length</a>(ptr, prop);
<a name="l02013"></a>02013     cols = (layers / 2) + (layers % 2);
<a name="l02014"></a>02014     groups = ((cols / 2) &lt; cols_per_group) ? (1) : (cols / cols_per_group);
<a name="l02015"></a>02015 
<a name="l02016"></a>02016     <span class="keywordflow">if</span> (used_ptr &amp;&amp; used_propname) {
<a name="l02017"></a>02017         used_prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(used_ptr, used_propname);
<a name="l02018"></a>02018         <span class="keywordflow">if</span> (!used_prop) {
<a name="l02019"></a>02019             <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;used layers property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), used_propname);
<a name="l02020"></a>02020             <span class="keywordflow">return</span>;
<a name="l02021"></a>02021         }
<a name="l02022"></a>02022 
<a name="l02023"></a>02023         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#aad51db9a31d245dba4ee1f50608f331c">RNA_property_array_length</a>(used_ptr, used_prop) &lt; layers)
<a name="l02024"></a>02024             used_prop = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02025"></a>02025     }
<a name="l02026"></a>02026     
<a name="l02027"></a>02027     <span class="comment">/* layers are laid out going across rows, with the columns being divided into groups */</span>
<a name="l02028"></a>02028     
<a name="l02029"></a>02029     <span class="keywordflow">for</span> (group = 0; group &lt; groups; group++) {
<a name="l02030"></a>02030         uCol = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(layout, 1);
<a name="l02031"></a>02031         
<a name="l02032"></a>02032         <span class="keywordflow">for</span> (row = 0; row &lt; 2; row++) {
<a name="l02033"></a>02033             <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l02034"></a>02034             <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l02035"></a>02035 
<a name="l02036"></a>02036             uRow = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(uCol, 1);
<a name="l02037"></a>02037             block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(uRow);
<a name="l02038"></a>02038             layer = groups * cols_per_group * row + cols_per_group * group;
<a name="l02039"></a>02039             
<a name="l02040"></a>02040             <span class="comment">/* add layers as toggle buts */</span>
<a name="l02041"></a>02041             <span class="keywordflow">for</span> (col = 0; (col &lt; cols_per_group) &amp;&amp; (layer &lt; layers); col++, layer++) {
<a name="l02042"></a>02042                 <span class="keywordtype">int</span> icon = 0;
<a name="l02043"></a>02043                 <span class="keywordtype">int</span> butlay = 1 &lt;&lt; layer;
<a name="l02044"></a>02044 
<a name="l02045"></a>02045                 <span class="keywordflow">if</span> (active_layer &amp; butlay)
<a name="l02046"></a>02046                     icon = ICON_LAYER_ACTIVE;
<a name="l02047"></a>02047                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (used_prop &amp;&amp; <a class="code" href="../../d3/d10/rna__access_8c.html#acb4afecfe847861cf6ebf4593d2b42bf">RNA_property_boolean_get_index</a>(used_ptr, used_prop, layer))
<a name="l02048"></a>02048                     icon = ICON_LAYER_USED;
<a name="l02049"></a>02049                 
<a name="l02050"></a>02050                 but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1b97f0b46fcbb373c1c2bafb2d0feb40">uiDefAutoButR</a>(block, ptr, prop, layer, <span class="stringliteral">&quot;&quot;</span>, icon, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> / 2, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> / 2);
<a name="l02051"></a>02051                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#acbcdf2f283c79885775d3e776ea07197">handle_layer_buttons</a>, but, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa6f58f8bcd4649b89458079eae9b1a1f">SET_INT_IN_POINTER</a>(layer));
<a name="l02052"></a>02052                 but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a56284cdae8be83ded3a0a78571caf54d">type</a> = <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>;
<a name="l02053"></a>02053             }
<a name="l02054"></a>02054         }
<a name="l02055"></a>02055     }
<a name="l02056"></a>02056 }
<a name="l02057"></a>02057 
<a name="l02058"></a>02058 
<a name="l02059"></a>02059 <span class="comment">/************************* List Template **************************/</span>
<a name="l02060"></a>02060 
<a name="l02061"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a792836da5e5bd031bf538ddc023587a6">02061</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a792836da5e5bd031bf538ddc023587a6">list_item_icon_get</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *itemptr, <span class="keywordtype">int</span> rnaicon, <span class="keywordtype">int</span> big)
<a name="l02062"></a>02062 {
<a name="l02063"></a>02063     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02064"></a>02064     <span class="keywordtype">int</span> icon;
<a name="l02065"></a>02065 
<a name="l02066"></a>02066     <span class="keywordflow">if</span> (!itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>)
<a name="l02067"></a>02067         <span class="keywordflow">return</span> rnaicon;
<a name="l02068"></a>02068 
<a name="l02069"></a>02069     <span class="comment">/* try ID, material or texture slot */</span>
<a name="l02070"></a>02070     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a04e91d163fed9c15bedf299f51732110">RNA_struct_is_ID</a>(itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>)) {
<a name="l02071"></a>02071         <span class="keywordtype">id</span> = itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a7afa52885727738cb03bbdf46e808e1b">id</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02072"></a>02072     }
<a name="l02073"></a>02073     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a073111ec187f67200136e92ed111699e">RNA_MaterialSlot</a>)) {
<a name="l02074"></a>02074         <span class="keywordtype">id</span> = <a class="code" href="../../d3/d10/rna__access_8c.html#a243277576891ecaf204382563ed46364">RNA_pointer_get</a>(itemptr, <span class="stringliteral">&quot;material&quot;</span>).<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02075"></a>02075     }
<a name="l02076"></a>02076     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ae4596366aa2c68cb80feff959b4b997d">RNA_TextureSlot</a>)) {
<a name="l02077"></a>02077         <span class="keywordtype">id</span> = <a class="code" href="../../d3/d10/rna__access_8c.html#a243277576891ecaf204382563ed46364">RNA_pointer_get</a>(itemptr, <span class="stringliteral">&quot;texture&quot;</span>).<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02078"></a>02078     }
<a name="l02079"></a>02079     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#abc13b5e24af6e690116c87cbdf5d9d9e">RNA_DynamicPaintSurface</a>)) {
<a name="l02080"></a>02080         <a class="code" href="../../dc/d46/structDynamicPaintSurface.html">DynamicPaintSurface</a> *surface = (<a class="code" href="../../dc/d46/structDynamicPaintSurface.html">DynamicPaintSurface</a> *)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02081"></a>02081 
<a name="l02082"></a>02082         <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (surface-&gt;<a class="code" href="../../dc/d46/structDynamicPaintSurface.html#a4c17d9e4778f82baa22c555ac00b79ae">format</a> == <a class="code" href="../../dd/daf/DNA__dynamicpaint__types_8h.html#a0217680ed7bc661ade1aac70bdb8b573">MOD_DPAINT_SURFACE_F_PTEX</a>) <span class="keywordflow">return</span> ICON_TEXTURE_SHADED;
<a name="l02083"></a>02083         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (surface-&gt;<a class="code" href="../../dc/d46/structDynamicPaintSurface.html#a4c17d9e4778f82baa22c555ac00b79ae">format</a> == <a class="code" href="../../dd/daf/DNA__dynamicpaint__types_8h.html#a91fee3b663b3f05a24bbec8a5e082e56">MOD_DPAINT_SURFACE_F_VERTEX</a>) <span class="keywordflow">return</span> ICON_OUTLINER_DATA_MESH;
<a name="l02084"></a>02084         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (surface-&gt;<a class="code" href="../../dc/d46/structDynamicPaintSurface.html#a4c17d9e4778f82baa22c555ac00b79ae">format</a> == <a class="code" href="../../dd/daf/DNA__dynamicpaint__types_8h.html#aaf778fa8a1ce6f8de3247adaa6a99958">MOD_DPAINT_SURFACE_F_IMAGESEQ</a>) <span class="keywordflow">return</span> ICON_FILE_IMAGE;
<a name="l02085"></a>02085     }
<a name="l02086"></a>02086 
<a name="l02087"></a>02087     <span class="comment">/* get icon from ID */</span>
<a name="l02088"></a>02088     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l02089"></a>02089         icon = <a class="code" href="../../de/d28/interface__icons_8c.html#ab373f2d8c3db8560b85cd9b250982c33">ui_id_icon_get</a>(C, <span class="keywordtype">id</span>, big);
<a name="l02090"></a>02090 
<a name="l02091"></a>02091         <span class="keywordflow">if</span> (icon)
<a name="l02092"></a>02092             <span class="keywordflow">return</span> icon;
<a name="l02093"></a>02093     }
<a name="l02094"></a>02094 
<a name="l02095"></a>02095     <span class="keywordflow">return</span> rnaicon;
<a name="l02096"></a>02096 }
<a name="l02097"></a>02097 
<a name="l02098"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a3c379bc674b5d358295ad373be8b526b">02098</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a3c379bc674b5d358295ad373be8b526b">list_item_row</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *itemptr, <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <span class="keywordtype">int</span> rnaicon, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *activeptr, <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *activeprop, <span class="keyword">const</span> <span class="keywordtype">char</span> *prop_list_id)
<a name="l02099"></a>02099 {
<a name="l02100"></a>02100     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l02101"></a>02101     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l02102"></a>02102     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *<a class="code" href="../../d8/d40/btDbvt_8cpp.html#ad08f07bba2ea0c5c64802b70c686fc68">split</a>, *overlap, *sub, *row;
<a name="l02103"></a>02103     <span class="keywordtype">char</span> *namebuf;
<a name="l02104"></a>02104     <span class="keyword">const</span> <span class="keywordtype">char</span> *name;
<a name="l02105"></a>02105     <span class="keywordtype">int</span> icon;
<a name="l02106"></a>02106 
<a name="l02107"></a>02107     overlap = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a222718a322e33405976c3b680746083a">uiLayoutOverlap</a>(layout);
<a name="l02108"></a>02108 
<a name="l02109"></a>02109     <span class="comment">/* list item behind label &amp; other buttons */</span>
<a name="l02110"></a>02110     sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(overlap, 0);
<a name="l02111"></a>02111 
<a name="l02112"></a>02112     but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7ab0e58f362f17f258b8696da210fd36">uiDefButR_prop</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a863e81437d873ffd4c9f4b31f624fbae">LISTROW</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, activeptr, activeprop, 0, 0, i, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02113"></a>02113     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1c6d5295e9786cbe9389d3122f1bf922">UI_BUT_NO_TOOLTIP</a>);
<a name="l02114"></a>02114 
<a name="l02115"></a>02115     sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(overlap, 0);
<a name="l02116"></a>02116 
<a name="l02117"></a>02117     <span class="comment">/* retrieve icon and name */</span>
<a name="l02118"></a>02118     icon = <a class="code" href="../../d5/d05/interface__templates_8c.html#a792836da5e5bd031bf538ddc023587a6">list_item_icon_get</a>(C, itemptr, rnaicon, 0);
<a name="l02119"></a>02119     <span class="keywordflow">if</span> (icon == ICON_NONE || icon == ICON_DOT)
<a name="l02120"></a>02120         icon = 0;
<a name="l02121"></a>02121 
<a name="l02122"></a>02122     namebuf = <a class="code" href="../../d3/d10/rna__access_8c.html#a3fcd1047eac0bc123f5f91cc2cef79d6">RNA_struct_name_get_alloc</a>(itemptr, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02123"></a>02123     name = (namebuf) ? namebuf : <span class="stringliteral">&quot;&quot;</span>;
<a name="l02124"></a>02124 
<a name="l02125"></a>02125     <span class="comment">/* hardcoded types */</span>
<a name="l02126"></a>02126     <span class="keywordflow">if</span> (itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a> == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#af4b8968051fffa5693c1c46828961774">RNA_MeshTexturePolyLayer</a> || itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a> == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ad24e33fb3bb5af9bcbc5254662077649">RNA_MeshLoopColorLayer</a>) {
<a name="l02127"></a>02127         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, icon);
<a name="l02128"></a>02128         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l02129"></a>02129         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a01035efe6b648b065f5d75ee569eebf5">uiDefIconButR</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>, 0, ICON_SCENE, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, itemptr, <span class="stringliteral">&quot;active_render&quot;</span>, 0, 0, 0, 0, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02130"></a>02130         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l02131"></a>02131     }
<a name="l02132"></a>02132     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a8910db0fb36a207151a19d0543eea2bf">RNA_MaterialTextureSlot</a>)) {
<a name="l02133"></a>02133         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, icon);
<a name="l02134"></a>02134         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l02135"></a>02135         <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab7f2f1d4c87c6811aea6150dfe23b2e7">uiDefButR</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a39d0de5f53bbf5622cd6af16d647fbe5">OPTION</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, ptr, <span class="stringliteral">&quot;use_textures&quot;</span>, i, 0, 0, 0, 0,  <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02136"></a>02136     }
<a name="l02137"></a>02137     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a5cecaf63e8b89551e0759437afbc2381">RNA_SceneRenderLayer</a>)) {
<a name="l02138"></a>02138         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, icon);
<a name="l02139"></a>02139         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l02140"></a>02140         <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab7f2f1d4c87c6811aea6150dfe23b2e7">uiDefButR</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a39d0de5f53bbf5622cd6af16d647fbe5">OPTION</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, itemptr, <span class="stringliteral">&quot;use&quot;</span>, 0, 0, 0, 0, 0,  <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02141"></a>02141     }
<a name="l02142"></a>02142     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a073111ec187f67200136e92ed111699e">RNA_MaterialSlot</a>)) {
<a name="l02143"></a>02143         <span class="comment">/* provision to draw active node name */</span>
<a name="l02144"></a>02144         <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma, *manode;
<a name="l02145"></a>02145         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02146"></a>02146         <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = (<a class="code" href="../../de/de7/structObject.html">Object</a> *)ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a7afa52885727738cb03bbdf46e808e1b">id</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02147"></a>02147         <span class="keywordtype">int</span> index = (<a class="code" href="../../d2/d10/structMaterial.html">Material</a> **)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> - ob-&gt;<a class="code" href="../../de/de7/structObject.html#a545b54048d299d5d9b5f49d6a80f1a9f">mat</a>;
<a name="l02148"></a>02148         
<a name="l02149"></a>02149         <span class="comment">/* default item with material base name */</span>
<a name="l02150"></a>02150         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, icon);
<a name="l02151"></a>02151         
<a name="l02152"></a>02152         ma = <a class="code" href="../../d4/d0f/BKE__material_8h.html#a941f5112d1047bcbcf3e2212685296a5">give_current_material</a>(ob, index + 1);
<a name="l02153"></a>02153         <span class="keywordflow">if</span> (ma &amp;&amp; !<a class="code" href="../../d8/d53/BKE__scene_8h.html#a041ff0e68dd0152e85ceddddc9b53cdc">scene_use_new_shading_nodes</a>(scene)) {
<a name="l02154"></a>02154             manode = <a class="code" href="../../d4/d0f/BKE__material_8h.html#aaf645f335fb81d811d6a33621ef80da7">give_node_material</a>(ma);
<a name="l02155"></a>02155             <span class="keywordflow">if</span> (manode) {
<a name="l02156"></a>02156                 <span class="keywordtype">char</span> <a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>[<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a6d7bce2e9ad79af316c9690a5b84b75c">MAX_ID_NAME</a> + 12];
<a name="l02157"></a>02157                 <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;Node %s&quot;</span>, manode-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l02158"></a>02158                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, str, <a class="code" href="../../de/d28/interface__icons_8c.html#ab373f2d8c3db8560b85cd9b250982c33">ui_id_icon_get</a>(C, &amp;manode-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>, 1));
<a name="l02159"></a>02159             }
<a name="l02160"></a>02160             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ae5c87659b1f4bd186431d96361ade966">use_nodes</a>) {
<a name="l02161"></a>02161                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, <span class="stringliteral">&quot;Node &lt;none&gt;&quot;</span>, ICON_NONE);
<a name="l02162"></a>02162             }
<a name="l02163"></a>02163         }
<a name="l02164"></a>02164     }
<a name="l02165"></a>02165     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a> == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a243b6055ad9f91e7878cead653cf50d9">RNA_ShapeKey</a>) {
<a name="l02166"></a>02166         <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = (<a class="code" href="../../de/de7/structObject.html">Object</a> *)activeptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02167"></a>02167         <a class="code" href="../../d1/d9e/structKey.html">Key</a> *key = (<a class="code" href="../../d1/d9e/structKey.html">Key</a> *)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a7afa52885727738cb03bbdf46e808e1b">id</a>.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02168"></a>02168         <a class="code" href="../../d2/dc3/structKeyBlock.html">KeyBlock</a> *kb = (<a class="code" href="../../d2/dc3/structKeyBlock.html">KeyBlock</a> *)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02169"></a>02169 
<a name="l02170"></a>02170         split = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a81b59d1d72c4105842646d41bc39c972">uiLayoutSplit</a>(sub, 0.66f, 0);
<a name="l02171"></a>02171 
<a name="l02172"></a>02172         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(split, name, icon);
<a name="l02173"></a>02173 
<a name="l02174"></a>02174         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l02175"></a>02175         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(split, 1);
<a name="l02176"></a>02176         <span class="keywordflow">if</span> (i == 0 || (key-&gt;type != <a class="code" href="../../de/d41/DNA__key__types_8h.html#a14061dd054afd472999a4f4f6cdf3923a166121abc12de1fb379b9e6956f45c67">KEY_RELATIVE</a>)) <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l02177"></a>02177         <span class="keywordflow">else</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, itemptr, <span class="stringliteral">&quot;value&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l02178"></a>02178         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, itemptr, <span class="stringliteral">&quot;mute&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, 0);
<a name="l02179"></a>02179 
<a name="l02180"></a>02180         <span class="keywordflow">if</span> ((kb-&gt;<a class="code" href="../../d2/dc3/structKeyBlock.html#a293ff458065155efca63b30b33387982">flag</a> &amp; <a class="code" href="../../de/d41/DNA__key__types_8h.html#af77d65ab56b38a820b1efc0bcafbd4fba985fc22c3c56f56ac76bbc3328d20350">KEYBLOCK_MUTE</a>) ||
<a name="l02181"></a>02181             (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a4f90725f5876b309d325c84ae4f5c51b">mode</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a36fb08f71e0c90da2a0f21518ef0d550a5aed90bff10a0fd5ad47c9ee79ae4580">OB_MODE_EDIT</a> &amp;&amp; !((ob-&gt;<a class="code" href="../../de/de7/structObject.html#af406445af536997110fc334c24854005">shapeflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a368b22f304142b93884f00ccfcb22c7a">OB_SHAPE_EDIT_MODE</a>) &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>)))
<a name="l02182"></a>02182         {
<a name="l02183"></a>02183             <a class="code" href="../../d8/d1e/UI__interface_8h.html#ace838ed32c66a6979e0df3cbaa7327b1">uiLayoutSetActive</a>(row, 0);
<a name="l02184"></a>02184         }
<a name="l02185"></a>02185         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l02186"></a>02186     }
<a name="l02187"></a>02187     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a> == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#abd7472ce2a6dc30e7185d1c12883c43d">RNA_VertexGroup</a>) {
<a name="l02188"></a>02188         <a class="code" href="../../de/dad/structbDeformGroup.html">bDeformGroup</a> *dg = (<a class="code" href="../../de/dad/structbDeformGroup.html">bDeformGroup</a> *)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02189"></a>02189         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, icon);
<a name="l02190"></a>02190         <span class="comment">/* RNA does not allow nice lock icons, use lower level buttons */</span>
<a name="l02191"></a>02191 <span class="preprocessor">#if 0</span>
<a name="l02192"></a>02192 <span class="preprocessor"></span>        <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab7f2f1d4c87c6811aea6150dfe23b2e7">uiDefButR</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a39d0de5f53bbf5622cd6af16d647fbe5">OPTION</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, itemptr, <span class="stringliteral">&quot;lock_weight&quot;</span>, 0, 0, 0, 0, 0,  <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02193"></a>02193 <span class="preprocessor">#else</span>
<a name="l02194"></a>02194 <span class="preprocessor"></span>        <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l02195"></a>02195         <a class="code" href="../../d8/d1e/UI__interface_8h.html#adb865bc1877cc1a03a080b286f535a1d">uiDefIconButBitC</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#add0642d9c162451e006491e534066144">DG_LOCK_WEIGHT</a>, 0, (dg-&gt;<a class="code" href="../../de/dad/structbDeformGroup.html#a66186b058bf902bc4a545deaf023c6a3">flag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#add0642d9c162451e006491e534066144">DG_LOCK_WEIGHT</a>) ? ICON_LOCKED : ICON_UNLOCKED, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, &amp;dg-&gt;<a class="code" href="../../de/dad/structbDeformGroup.html#a66186b058bf902bc4a545deaf023c6a3">flag</a>, 0, 0, 0, 0, <span class="stringliteral">&quot;Maintain relative weights while painting&quot;</span>);
<a name="l02196"></a>02196         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l02197"></a>02197 <span class="preprocessor">#endif</span>
<a name="l02198"></a>02198 <span class="preprocessor"></span>    }
<a name="l02199"></a>02199     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a> == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ad485426748d404323024d31ba1e1fa36">RNA_KeyingSetPath</a>) {
<a name="l02200"></a>02200         <a class="code" href="../../dc/d37/structKS__Path.html">KS_Path</a> *ksp = (<a class="code" href="../../dc/d37/structKS__Path.html">KS_Path</a> *)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02201"></a>02201         
<a name="l02202"></a>02202         <span class="comment">/* icon needs to be the type of ID which is currently active */</span>
<a name="l02203"></a>02203         <a class="code" href="../../d3/d10/rna__access_8c.html#a88794ed4a738cdb08b1d8649d246dc89">RNA_enum_icon_from_value</a>(<a class="code" href="../../dc/d0c/rna__ID_8c.html#ab7f91ac69dc788ca08c093abe95f7bdf">id_type_items</a>, ksp-&gt;<a class="code" href="../../dc/d37/structKS__Path.html#a4c6dd8d59dc18009dafb7bf13bae9edc">idtype</a>, &amp;icon);
<a name="l02204"></a>02204         
<a name="l02205"></a>02205         <span class="comment">/* nothing else special to do... */</span>
<a name="l02206"></a>02206         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, icon); <span class="comment">/* fails, backdrop LISTROW... */</span>
<a name="l02207"></a>02207     }
<a name="l02208"></a>02208     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a> == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#abc13b5e24af6e690116c87cbdf5d9d9e">RNA_DynamicPaintSurface</a>) {
<a name="l02209"></a>02209         <span class="keywordtype">char</span> name_final[96];
<a name="l02210"></a>02210         <span class="keyword">const</span> <span class="keywordtype">char</span> *enum_name;
<a name="l02211"></a>02211         <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(itemptr, <span class="stringliteral">&quot;surface_type&quot;</span>);
<a name="l02212"></a>02212         <a class="code" href="../../dc/d46/structDynamicPaintSurface.html">DynamicPaintSurface</a> *surface = (<a class="code" href="../../dc/d46/structDynamicPaintSurface.html">DynamicPaintSurface</a> *)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02213"></a>02213 
<a name="l02214"></a>02214         <a class="code" href="../../d3/d10/rna__access_8c.html#a7c1da74721bc9e37cfb13d01ce21982c">RNA_property_enum_name</a>(C, itemptr, prop, <a class="code" href="../../d3/d10/rna__access_8c.html#abb4862291354aedcb2cc916f1c30642b">RNA_property_enum_get</a>(itemptr, prop), &amp;enum_name);
<a name="l02215"></a>02215 
<a name="l02216"></a>02216         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(name_final, <span class="keyword">sizeof</span>(name_final), <span class="stringliteral">&quot;%s (%s)&quot;</span>, name, enum_name);
<a name="l02217"></a>02217         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name_final, icon);
<a name="l02218"></a>02218         <span class="keywordflow">if</span> (<a class="code" href="../../d0/db4/BKE__dynamicpaint_8h.html#ab59975a4aec1b3a0e2233d73ba1e9642">dynamicPaint_surfaceHasColorPreview</a>(surface)) {
<a name="l02219"></a>02219             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l02220"></a>02220             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a01035efe6b648b065f5d75ee569eebf5">uiDefIconButR</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a39d0de5f53bbf5622cd6af16d647fbe5">OPTION</a>, 0, (surface-&gt;<a class="code" href="../../dc/d46/structDynamicPaintSurface.html#a92478313cccf8148377b92b20349952d">flags</a> &amp; <a class="code" href="../../dd/daf/DNA__dynamicpaint__types_8h.html#a220f52ceb793e7a04f234014d0680e3f">MOD_DPAINT_PREVIEW</a>) ? ICON_RESTRICT_VIEW_OFF : ICON_RESTRICT_VIEW_ON,
<a name="l02221"></a>02221                           0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, itemptr, <span class="stringliteral">&quot;show_preview&quot;</span>, 0, 0, 0, 0, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02222"></a>02222             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l02223"></a>02223         }
<a name="l02224"></a>02224         <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab7f2f1d4c87c6811aea6150dfe23b2e7">uiDefButR</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a39d0de5f53bbf5622cd6af16d647fbe5">OPTION</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, itemptr, <span class="stringliteral">&quot;is_active&quot;</span>, i, 0, 0, 0, 0,  <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02225"></a>02225     }
<a name="l02226"></a>02226     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a> == &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#a5b052e9b826fc2eacb8318d0779d7bf2">RNA_MovieTrackingObject</a>) {
<a name="l02227"></a>02227         <a class="code" href="../../d2/de6/structMovieTrackingObject.html">MovieTrackingObject</a> *tracking_object = (<a class="code" href="../../d2/de6/structMovieTrackingObject.html">MovieTrackingObject</a> *)itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>;
<a name="l02228"></a>02228 
<a name="l02229"></a>02229         split = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a81b59d1d72c4105842646d41bc39c972">uiLayoutSplit</a>(sub, 0.75f, 0);
<a name="l02230"></a>02230         <span class="keywordflow">if</span> (tracking_object-&gt;<a class="code" href="../../d2/de6/structMovieTrackingObject.html#ac43786f911f695796bba9afbdc976f2c">flag</a> &amp; <a class="code" href="../../d3/dd4/DNA__tracking__types_8h.html#a06e7a47b7bac422584f1ce1607f6268f">TRACKING_OBJECT_CAMERA</a>) {
<a name="l02231"></a>02231             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(split, name, ICON_CAMERA_DATA);
<a name="l02232"></a>02232         }
<a name="l02233"></a>02233         <span class="keywordflow">else</span> {
<a name="l02234"></a>02234             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(split, name, ICON_OBJECT_DATA);
<a name="l02235"></a>02235         }
<a name="l02236"></a>02236     }
<a name="l02237"></a>02237 
<a name="l02238"></a>02238     <span class="comment">/* There is a last chance to display custom controls (in addition to the name/label):</span>
<a name="l02239"></a>02239 <span class="comment">     * If the given item property group features a string property named as prop_list,</span>
<a name="l02240"></a>02240 <span class="comment">     * this tries to add controls for all properties of the item listed in that string property.</span>
<a name="l02241"></a>02241 <span class="comment">     * (colon-separated names).</span>
<a name="l02242"></a>02242 <span class="comment">     *</span>
<a name="l02243"></a>02243 <span class="comment">     * This is especially useful for python. E.g., if you list a collection of this property</span>
<a name="l02244"></a>02244 <span class="comment">     * group:</span>
<a name="l02245"></a>02245 <span class="comment">     *</span>
<a name="l02246"></a>02246 <span class="comment">     * class TestPropertyGroup(bpy.types.PropertyGroup):</span>
<a name="l02247"></a>02247 <span class="comment">     *     bool    = BoolProperty(default=False)</span>
<a name="l02248"></a>02248 <span class="comment">     *     integer = IntProperty()</span>
<a name="l02249"></a>02249 <span class="comment">     *     string  = StringProperty()</span>
<a name="l02250"></a>02250 <span class="comment">     * </span>
<a name="l02251"></a>02251 <span class="comment">     *     # A string of all identifiers (colon-separated) which property&#39;s controls should be</span>
<a name="l02252"></a>02252 <span class="comment">     *     # displayed in a template_list.</span>
<a name="l02253"></a>02253 <span class="comment">     *     template_list_controls = StringProperty(default=&quot;integer:bool:string&quot;, options={&quot;HIDDEN&quot;})</span>
<a name="l02254"></a>02254 <span class="comment">     *</span>
<a name="l02255"></a>02255 <span class="comment">     * ... you&#39;ll get a numfield for the integer prop, a check box for the bool prop, and a textfield</span>
<a name="l02256"></a>02256 <span class="comment">     * for the string prop, after the name of each item of the collection.</span>
<a name="l02257"></a>02257 <span class="comment">     */</span>
<a name="l02258"></a>02258     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prop_list_id) {
<a name="l02259"></a>02259         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(sub, 1);
<a name="l02260"></a>02260         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, name, icon);
<a name="l02261"></a>02261 
<a name="l02262"></a>02262         <span class="comment">/* XXX: Check, as sometimes we get an itemptr looking like</span>
<a name="l02263"></a>02263 <span class="comment">         *      {id = {data = 0x0}, type = 0x0, data = 0x0}</span>
<a name="l02264"></a>02264 <span class="comment">         *      which would obviously produce a sigsev... */</span>
<a name="l02265"></a>02265         <span class="keywordflow">if</span> (itemptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>) {
<a name="l02266"></a>02266             <span class="comment">/* If the special property is set for the item, and it is a collection... */</span>
<a name="l02267"></a>02267             <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop_list = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(itemptr, prop_list_id);
<a name="l02268"></a>02268 
<a name="l02269"></a>02269             <span class="keywordflow">if</span> (prop_list &amp;&amp; <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop_list) == <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87a847d74deffc8d0ec556372561186ee41">PROP_STRING</a>) {
<a name="l02270"></a>02270                 <span class="keywordtype">int</span> prop_names_len;
<a name="l02271"></a>02271                 <span class="keywordtype">char</span> *prop_names = <a class="code" href="../../d3/d10/rna__access_8c.html#a6751615b211d7dd06640353d53198040">RNA_property_string_get_alloc</a>(itemptr, prop_list, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, &amp;prop_names_len);
<a name="l02272"></a>02272                 <span class="keywordtype">char</span> *prop_names_end = prop_names + prop_names_len;
<a name="l02273"></a>02273                 <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = prop_names;
<a name="l02274"></a>02274                 <span class="keywordtype">char</span> *id_next;
<a name="l02275"></a>02275                 <span class="keywordflow">while</span> (<span class="keywordtype">id</span> &lt; prop_names_end) {
<a name="l02276"></a>02276                     <span class="keywordflow">if</span> ((id_next = strchr(<span class="keywordtype">id</span>, <span class="charliteral">&#39;:&#39;</span>))) *id_next++ = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l02277"></a>02277                     <span class="keywordflow">else</span> id_next = prop_names_end;
<a name="l02278"></a>02278                     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, itemptr, <span class="keywordtype">id</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);
<a name="l02279"></a>02279                     <span class="keywordtype">id</span> = id_next;
<a name="l02280"></a>02280                 }
<a name="l02281"></a>02281                 <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(prop_names);
<a name="l02282"></a>02282             }
<a name="l02283"></a>02283         }
<a name="l02284"></a>02284     }
<a name="l02285"></a>02285 
<a name="l02286"></a>02286     <span class="keywordflow">else</span>
<a name="l02287"></a>02287         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, icon);  <span class="comment">/* fails, backdrop LISTROW... */</span>
<a name="l02288"></a>02288 
<a name="l02289"></a>02289     <span class="comment">/* free name */</span>
<a name="l02290"></a>02290     <span class="keywordflow">if</span> (namebuf) {
<a name="l02291"></a>02291         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(namebuf);
<a name="l02292"></a>02292     }
<a name="l02293"></a>02293 }
<a name="l02294"></a>02294 
<a name="l02295"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a7788351bfd8e3c05acc87d8fcceeeba6">02295</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#ac2c06f0e71824eba0c2c7121d180b7c2">uiTemplateList</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *propname, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *activeptr, <span class="keyword">const</span> <span class="keywordtype">char</span> *activepropname, <span class="keyword">const</span> <span class="keywordtype">char</span> *prop_list, <span class="keywordtype">int</span> rows, <span class="keywordtype">int</span> maxrows, <span class="keywordtype">int</span> listtype)
<a name="l02296"></a>02296 {
<a name="l02297"></a>02297     <span class="comment">//Scene *scene= CTX_data_scene(C);</span>
<a name="l02298"></a>02298     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *activeprop;
<a name="l02299"></a>02299     <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87">PropertyType</a> type, activetype;
<a name="l02300"></a>02300     <a class="code" href="../../d5/d61/structStructRNA.html">StructRNA</a> *ptype;
<a name="l02301"></a>02301     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *box, *row, *col;
<a name="l02302"></a>02302     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l02303"></a>02303     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l02304"></a>02304     <a class="code" href="../../d7/d84/structPanel.html">Panel</a> *pa;
<a name="l02305"></a>02305     <span class="keyword">const</span> <span class="keywordtype">char</span> *name;
<a name="l02306"></a>02306     <span class="keywordtype">char</span> numstr[32];
<a name="l02307"></a>02307     <span class="keywordtype">int</span> rnaicon = 0, icon = 0, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, activei = 0, <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = 0, items, found, <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>, <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>;
<a name="l02308"></a>02308 
<a name="l02309"></a>02309     <span class="comment">/* validate arguments */</span>
<a name="l02310"></a>02310     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l02311"></a>02311     pa = block-&gt;<a class="code" href="../../df/d5b/structuiBlock.html#a2cba1bdecae17fb0f88c3d4416797319">panel</a>;
<a name="l02312"></a>02312 
<a name="l02313"></a>02313     <span class="keywordflow">if</span> (!pa) {
<a name="l02314"></a>02314         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Only works inside a panel&quot;</span>);
<a name="l02315"></a>02315         <span class="keywordflow">return</span>;
<a name="l02316"></a>02316     }
<a name="l02317"></a>02317 
<a name="l02318"></a>02318     <span class="keywordflow">if</span> (!activeptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>)
<a name="l02319"></a>02319         <span class="keywordflow">return</span>;
<a name="l02320"></a>02320     
<a name="l02321"></a>02321     <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>) {
<a name="l02322"></a>02322         prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(ptr, propname);
<a name="l02323"></a>02323         <span class="keywordflow">if</span> (!prop) {
<a name="l02324"></a>02324             <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), propname);
<a name="l02325"></a>02325             <span class="keywordflow">return</span>;
<a name="l02326"></a>02326         }
<a name="l02327"></a>02327     }
<a name="l02328"></a>02328 
<a name="l02329"></a>02329     activeprop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(activeptr, activepropname);
<a name="l02330"></a>02330     <span class="keywordflow">if</span> (!activeprop) {
<a name="l02331"></a>02331         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Property not found: %s.%s&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abe9be1dcaf1b1767038a753cd0edb9ab">RNA_struct_identifier</a>(ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>), activepropname);
<a name="l02332"></a>02332         <span class="keywordflow">return</span>;
<a name="l02333"></a>02333     }
<a name="l02334"></a>02334 
<a name="l02335"></a>02335     <span class="keywordflow">if</span> (prop) {
<a name="l02336"></a>02336         type = <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop);
<a name="l02337"></a>02337         <span class="keywordflow">if</span> (type != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87af6747d14516095c7da178bdce8ec547e">PROP_COLLECTION</a>) {
<a name="l02338"></a>02338             <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;uiExpected collection property&quot;</span>);
<a name="l02339"></a>02339             <span class="keywordflow">return</span>;
<a name="l02340"></a>02340         }
<a name="l02341"></a>02341     }
<a name="l02342"></a>02342 
<a name="l02343"></a>02343     activetype = <a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(activeprop);
<a name="l02344"></a>02344     <span class="keywordflow">if</span> (activetype != <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87a620d0acb046e6bc10271434db1960d41">PROP_INT</a>) {
<a name="l02345"></a>02345         <a class="code" href="../../de/ddf/RNA__access_8h.html#a9c91f5df2b637e6ed72cf568a8487d16">RNA_warning</a>(<span class="stringliteral">&quot;Expected integer property&quot;</span>);
<a name="l02346"></a>02346         <span class="keywordflow">return</span>;
<a name="l02347"></a>02347     }
<a name="l02348"></a>02348 
<a name="l02349"></a>02349     <span class="comment">/* get icon */</span>
<a name="l02350"></a>02350     <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> &amp;&amp; prop) {
<a name="l02351"></a>02351         ptype = <a class="code" href="../../d3/d10/rna__access_8c.html#a90d864adedcd427f9c2dac19e025a092">RNA_property_pointer_type</a>(ptr, prop);
<a name="l02352"></a>02352         rnaicon = <a class="code" href="../../d3/d10/rna__access_8c.html#a5a07a8315a1b6d5b30bbca822db7195c">RNA_struct_ui_icon</a>(ptype);
<a name="l02353"></a>02353     }
<a name="l02354"></a>02354 
<a name="l02355"></a>02355     <span class="comment">/* get active data */</span>
<a name="l02356"></a>02356     activei = <a class="code" href="../../d3/d10/rna__access_8c.html#a7755e74d78f50e508966f2af17f7523e">RNA_property_int_get</a>(activeptr, activeprop);
<a name="l02357"></a>02357 
<a name="l02358"></a>02358     <span class="keywordflow">if</span> (listtype == <span class="charliteral">&#39;i&#39;</span>) {
<a name="l02359"></a>02359         box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a82b15d866e29243db21ed8150f69a322">uiLayoutListBox</a>(layout, ptr, prop, activeptr, activeprop);
<a name="l02360"></a>02360         col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(box, 1);
<a name="l02361"></a>02361         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(col, 0);
<a name="l02362"></a>02362 
<a name="l02363"></a>02363         <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> &amp;&amp; prop) {
<a name="l02364"></a>02364             <span class="comment">/* create list items */</span>
<a name="l02365"></a>02365             <a class="code" href="../../de/ddf/RNA__access_8h.html#a56f71b443d06f31f83fe3dfdf07fd4c4">RNA_PROP_BEGIN</a>(ptr, itemptr, prop) {
<a name="l02366"></a>02366                 <span class="comment">/* create button */</span>
<a name="l02367"></a>02367                 <span class="keywordflow">if</span> (!(<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> % 9))
<a name="l02368"></a>02368                     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(col, 0);
<a name="l02369"></a>02369 
<a name="l02370"></a>02370                 icon = <a class="code" href="../../d5/d05/interface__templates_8c.html#a792836da5e5bd031bf538ddc023587a6">list_item_icon_get</a>(C, &amp;itemptr, rnaicon, 1);
<a name="l02371"></a>02371                 but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a7d2957090152b46851fae411617f0060">uiDefIconButR_prop</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a863e81437d873ffd4c9f4b31f624fbae">LISTROW</a>, 0, icon, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, activeptr, activeprop, 0, 0, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02372"></a>02372                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1c6d5295e9786cbe9389d3122f1bf922">UI_BUT_NO_TOOLTIP</a>);
<a name="l02373"></a>02373                 
<a name="l02374"></a>02374 
<a name="l02375"></a>02375                 <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++;
<a name="l02376"></a>02376             }
<a name="l02377"></a>02377             <a class="code" href="../../de/ddf/RNA__access_8h.html#a00c9cc0174c79826c145c3e235e2b689">RNA_PROP_END</a>;
<a name="l02378"></a>02378         }
<a name="l02379"></a>02379     }
<a name="l02380"></a>02380     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (listtype == <span class="charliteral">&#39;c&#39;</span>) {
<a name="l02381"></a>02381         <span class="comment">/* compact layout */</span>
<a name="l02382"></a>02382 
<a name="l02383"></a>02383         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 1);
<a name="l02384"></a>02384 
<a name="l02385"></a>02385         <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> &amp;&amp; prop) {
<a name="l02386"></a>02386             <span class="comment">/* create list items */</span>
<a name="l02387"></a>02387             <a class="code" href="../../de/ddf/RNA__access_8h.html#a56f71b443d06f31f83fe3dfdf07fd4c4">RNA_PROP_BEGIN</a>(ptr, itemptr, prop) {
<a name="l02388"></a>02388                 found = (activei == <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);
<a name="l02389"></a>02389 
<a name="l02390"></a>02390                 <span class="keywordflow">if</span> (found) {
<a name="l02391"></a>02391                     <span class="comment">/* create button */</span>
<a name="l02392"></a>02392                     name = <a class="code" href="../../d3/d10/rna__access_8c.html#a3fcd1047eac0bc123f5f91cc2cef79d6">RNA_struct_name_get_alloc</a>(&amp;itemptr, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02393"></a>02393                     icon = <a class="code" href="../../d5/d05/interface__templates_8c.html#a792836da5e5bd031bf538ddc023587a6">list_item_icon_get</a>(C, &amp;itemptr, rnaicon, 0);
<a name="l02394"></a>02394                     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, (name) ? name : <span class="stringliteral">&quot;&quot;</span>, icon);
<a name="l02395"></a>02395 
<a name="l02396"></a>02396                     <span class="keywordflow">if</span> (name) {
<a name="l02397"></a>02397                         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>((<span class="keywordtype">void</span> *)name);
<a name="l02398"></a>02398                     }
<a name="l02399"></a>02399                 }
<a name="l02400"></a>02400 
<a name="l02401"></a>02401                 <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++;
<a name="l02402"></a>02402             }
<a name="l02403"></a>02403             <a class="code" href="../../de/ddf/RNA__access_8h.html#a00c9cc0174c79826c145c3e235e2b689">RNA_PROP_END</a>;
<a name="l02404"></a>02404         }
<a name="l02405"></a>02405 
<a name="l02406"></a>02406         <span class="comment">/* if not found, add in dummy button */</span>
<a name="l02407"></a>02407         <span class="keywordflow">if</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0)
<a name="l02408"></a>02408             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(row, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l02409"></a>02409 
<a name="l02410"></a>02410         <span class="comment">/* next/prev button */</span>
<a name="l02411"></a>02411         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(numstr, <span class="keyword">sizeof</span>(numstr), <span class="stringliteral">&quot;%d :&quot;</span>, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);
<a name="l02412"></a>02412         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#ac325ab732226c99df455d3f0c6fc6421">uiDefIconTextButR_prop</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#aaf0952059602752258dccaa015d7b54a">NUM</a>, 0, 0, numstr, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 5, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, activeptr, activeprop, 0, 0, 0, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02413"></a>02413         <span class="keywordflow">if</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0)
<a name="l02414"></a>02414             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a12ded2eebd02d1d7ba6539465315a37b">uiButSetFlag</a>(but, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aebc550f9a03ce3bd40d3c7a024c0f5a8">UI_BUT_DISABLED</a>);
<a name="l02415"></a>02415     }
<a name="l02416"></a>02416     <span class="keywordflow">else</span> {
<a name="l02417"></a>02417         <span class="comment">/* default rows */</span>
<a name="l02418"></a>02418         <span class="keywordflow">if</span> (rows == 0)
<a name="l02419"></a>02419             rows = 5;
<a name="l02420"></a>02420         <span class="keywordflow">if</span> (maxrows == 0)
<a name="l02421"></a>02421             maxrows = 5;
<a name="l02422"></a>02422         <span class="keywordflow">if</span> (pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#a6b5871cea5e9a75387031e19477fdb79">list_grip_size</a> != 0)
<a name="l02423"></a>02423             rows = pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#a6b5871cea5e9a75387031e19477fdb79">list_grip_size</a>;
<a name="l02424"></a>02424 
<a name="l02425"></a>02425         <span class="comment">/* layout */</span>
<a name="l02426"></a>02426         box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a82b15d866e29243db21ed8150f69a322">uiLayoutListBox</a>(layout, ptr, prop, activeptr, activeprop);
<a name="l02427"></a>02427         row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(box, 0);
<a name="l02428"></a>02428         col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(row, 1);
<a name="l02429"></a>02429 
<a name="l02430"></a>02430         <span class="comment">/* init numbers */</span>
<a name="l02431"></a>02431         <a class="code" href="../../d3/d10/rna__access_8c.html#ac511ed744e0dad1b0a43e6c05d46b9ce">RNA_property_int_range</a>(activeptr, activeprop, &amp;min, &amp;max);
<a name="l02432"></a>02432 
<a name="l02433"></a>02433         <span class="keywordflow">if</span> (prop)
<a name="l02434"></a>02434             <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#afa268ad0fdaa32bbbf52be74426bfbd6">RNA_property_collection_length</a>(ptr, prop);
<a name="l02435"></a>02435         items = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a49a86f7d81f477961529de3add6d68ab">CLAMPIS</a>(<a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>, rows, <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(rows, maxrows));
<a name="l02436"></a>02436 
<a name="l02437"></a>02437         <span class="comment">/* if list length changes and active is out of view, scroll to it */</span>
<a name="l02438"></a>02438         <span class="keywordflow">if</span> (pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#a40a2d1aeffdec6d1e0ae40556ad47dc6">list_last_len</a> != <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>)
<a name="l02439"></a>02439             <span class="keywordflow">if</span> ((activei &lt; pa-&gt;list_scroll || activei &gt;= pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a> + items))
<a name="l02440"></a>02440                 pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a> = activei;
<a name="l02441"></a>02441 
<a name="l02442"></a>02442         pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a> = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a>, <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> - items);
<a name="l02443"></a>02443         pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a> = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a>, 0);
<a name="l02444"></a>02444         pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#a5b8bbc438cda1ee81ae512aa9b89ebff">list_size</a> = items;
<a name="l02445"></a>02445         pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#a40a2d1aeffdec6d1e0ae40556ad47dc6">list_last_len</a> = <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>;
<a name="l02446"></a>02446 
<a name="l02447"></a>02447         <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> &amp;&amp; prop) {
<a name="l02448"></a>02448             <span class="comment">/* create list items */</span>
<a name="l02449"></a>02449             <a class="code" href="../../de/ddf/RNA__access_8h.html#a56f71b443d06f31f83fe3dfdf07fd4c4">RNA_PROP_BEGIN</a>(ptr, itemptr, prop) {
<a name="l02450"></a>02450                 <span class="keywordflow">if</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a> &amp;&amp; i &lt; pa-&gt;list_scroll + items)
<a name="l02451"></a>02451                     <a class="code" href="../../d5/d05/interface__templates_8c.html#a3c379bc674b5d358295ad373be8b526b">list_item_row</a>(C, col, ptr, &amp;itemptr, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, rnaicon, activeptr, activeprop, prop_list);
<a name="l02452"></a>02452 
<a name="l02453"></a>02453                 <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++;
<a name="l02454"></a>02454             }
<a name="l02455"></a>02455             <a class="code" href="../../de/ddf/RNA__access_8h.html#a00c9cc0174c79826c145c3e235e2b689">RNA_PROP_END</a>;
<a name="l02456"></a>02456         }
<a name="l02457"></a>02457 
<a name="l02458"></a>02458         <span class="comment">/* add dummy buttons to fill space */</span>
<a name="l02459"></a>02459         <span class="keywordflow">while</span> (i &lt; pa-&gt;list_scroll + items) {
<a name="l02460"></a>02460             <span class="keywordflow">if</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a>)
<a name="l02461"></a>02461                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(col, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l02462"></a>02462             <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++;
<a name="l02463"></a>02463         }
<a name="l02464"></a>02464 
<a name="l02465"></a>02465         <span class="comment">/* add scrollbar */</span>
<a name="l02466"></a>02466         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> &gt; items) {
<a name="l02467"></a>02467             col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(row, 0);
<a name="l02468"></a>02468             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6f082b2e546932e29e6569a8db6372d7">uiDefButI</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa8fa67309d5b49cdd294644ff290591e">SCROLL</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 0.75, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> * items, &amp;pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#acf06ab0515da6b22b388d61b55c7520d">list_scroll</a>, 0, <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> - items, items, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02469"></a>02469         }
<a name="l02470"></a>02470     }
<a name="l02471"></a>02471 }
<a name="l02472"></a>02472 
<a name="l02473"></a>02473 <span class="comment">/************************* Operator Search Template **************************/</span>
<a name="l02474"></a>02474 
<a name="l02475"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a151be4529f0084651105f0766c4c1b77">02475</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a151be4529f0084651105f0766c4c1b77">operator_call_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg1), <span class="keywordtype">void</span> *arg2)
<a name="l02476"></a>02476 {
<a name="l02477"></a>02477     <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot = arg2;
<a name="l02478"></a>02478     
<a name="l02479"></a>02479     <span class="keywordflow">if</span> (ot)
<a name="l02480"></a>02480         <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ab5a7f40e5e55a912d974ab5224a0fa15">WM_OP_INVOKE_DEFAULT</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02481"></a>02481 }
<a name="l02482"></a>02482 
<a name="l02483"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a424e50b6af472c9bdab072e823ef3e1d">02483</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a424e50b6af472c9bdab072e823ef3e1d">operator_search_cb</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg), <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../d8/dbb/structuiSearchItems.html">uiSearchItems</a> *items)
<a name="l02484"></a>02484 {
<a name="l02485"></a>02485     <a class="code" href="../../d2/d31/structGHashIterator.html">GHashIterator</a> *iter = <a class="code" href="../../d6/dae/wm__operators_8c.html#accc27c068778bd428156a1a8ca0585b4">WM_operatortype_iter</a>();
<a name="l02486"></a>02486 
<a name="l02487"></a>02487     <span class="keywordflow">for</span> (; !<a class="code" href="../../d7/dc5/BLI__ghash_8h.html#a0eff6b7b74d72e06f7c125da5a46a5f1">BLI_ghashIterator_isDone</a>(iter); <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#a2d3ebd2fe8ee454695c6387215e3e88a">BLI_ghashIterator_step</a>(iter)) {
<a name="l02488"></a>02488         <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot = <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#a65c048ac3140f6c2598d94e4276a41f3">BLI_ghashIterator_getValue</a>(iter);
<a name="l02489"></a>02489 
<a name="l02490"></a>02490         <span class="keywordflow">if</span> (<a class="code" href="../../d3/db3/BLI__string_8h.html#acea342f9e36a26e2d404b1ada16f2b7a">BLI_strcasestr</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a>, str)) {
<a name="l02491"></a>02491             <span class="keywordflow">if</span> (<a class="code" href="../../df/db0/wm__event__system_8c.html#a9a97e0b7a1e43624abb8a0d37d21f161">WM_operator_poll</a>((<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *)C, ot)) {
<a name="l02492"></a>02492                 <span class="keywordtype">char</span> name[256];
<a name="l02493"></a>02493                 <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = <a class="code" href="../../d1/d22/stdosl_8h.html#af902ac638d8127503ad64a0eacb3a7e8">strlen</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a>);
<a name="l02494"></a>02494                 
<a name="l02495"></a>02495                 <span class="comment">/* display name for menu, can hold hotkey */</span>
<a name="l02496"></a>02496                 <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(name, ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a>, <span class="keyword">sizeof</span>(name));
<a name="l02497"></a>02497                 
<a name="l02498"></a>02498                 <span class="comment">/* check for hotkey */</span>
<a name="l02499"></a>02499                 <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span>(name) - 6) {
<a name="l02500"></a>02500                     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d78/wm__keymap_8c.html#afd663ed7665f3ba481cd77b05c9214a5">WM_key_event_operator_string</a>(C, ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ad2fa38d3cd3b0844e4a1b33bbf5f918c">WM_OP_EXEC_DEFAULT</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,
<a name="l02501"></a>02501                                                      &amp;name[len + 1], <span class="keyword">sizeof</span>(name) - len - 1))
<a name="l02502"></a>02502                     {
<a name="l02503"></a>02503                         name[<a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>] = <span class="charliteral">&#39;|&#39;</span>;
<a name="l02504"></a>02504                     }
<a name="l02505"></a>02505                 }
<a name="l02506"></a>02506                 
<a name="l02507"></a>02507                 <span class="keywordflow">if</span> (0 == <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54841b6e4f540fcffd11d692e278a605">uiSearchItemAdd</a>(items, name, ot, 0))
<a name="l02508"></a>02508                     <span class="keywordflow">break</span>;
<a name="l02509"></a>02509             }
<a name="l02510"></a>02510         }
<a name="l02511"></a>02511     }
<a name="l02512"></a>02512     <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#a3cc839e5e4e00419c6774832687e39c1">BLI_ghashIterator_free</a>(iter);
<a name="l02513"></a>02513 }
<a name="l02514"></a>02514 
<a name="l02515"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a6444cb2eedfa4ec62477d90fde9f7760">02515</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6444cb2eedfa4ec62477d90fde9f7760">uiTemplateOperatorSearch</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout)
<a name="l02516"></a>02516 {
<a name="l02517"></a>02517     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l02518"></a>02518     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l02519"></a>02519     <span class="keyword">static</span> <span class="keywordtype">char</span> search[256] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l02520"></a>02520         
<a name="l02521"></a>02521     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l02522"></a>02522     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a9607880380703426c9e76c66dc23a1f4">uiBlockSetCurLayout</a>(block, layout);
<a name="l02523"></a>02523 
<a name="l02524"></a>02524     but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a15503b211bb301ff0fb2901c98740fcb">uiDefSearchBut</a>(block, search, 0, ICON_VIEWZOOM, <span class="keyword">sizeof</span>(search), 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 6, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02525"></a>02525     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a977047e0bf7e7ef5e6f26591ff8a53c9">uiButSetSearchFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#a424e50b6af472c9bdab072e823ef3e1d">operator_search_cb</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#a151be4529f0084651105f0766c4c1b77">operator_call_cb</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02526"></a>02526 }
<a name="l02527"></a>02527 
<a name="l02528"></a>02528 <span class="comment">/************************* Running Jobs Template **************************/</span>
<a name="l02529"></a>02529 
<a name="l02530"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a58f76133ea1d0d7cdd4c0254d35d2f36">02530</a> <span class="preprocessor">#define B_STOPRENDER    1</span>
<a name="l02531"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#af7af04f0ac9b88ace78371e1d968c4d5">02531</a> <span class="preprocessor"></span><span class="preprocessor">#define B_STOPCAST      2</span>
<a name="l02532"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#af22071afc216ff6bf23eaf924bf495e7">02532</a> <span class="preprocessor"></span><span class="preprocessor">#define B_STOPANIM      3</span>
<a name="l02533"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aa407c468a79472fb9d5648fc2922c8fc">02533</a> <span class="preprocessor"></span><span class="preprocessor">#define B_STOPCOMPO     4</span>
<a name="l02534"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#ab23574796d53e64025ef01c1f50cd7a4">02534</a> <span class="preprocessor"></span><span class="preprocessor">#define B_STOPSEQ       5</span>
<a name="l02535"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#adcd203d0b19cfece7200ca2553426572">02535</a> <span class="preprocessor"></span><span class="preprocessor">#define B_STOPCLIP      6</span>
<a name="l02536"></a>02536 <span class="preprocessor"></span>
<a name="l02537"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a382f14cb8f48394d1b43792ee97578dc">02537</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a382f14cb8f48394d1b43792ee97578dc">do_running_jobs</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(arg), <span class="keywordtype">int</span> event)
<a name="l02538"></a>02538 {
<a name="l02539"></a>02539     <span class="keywordflow">switch</span> (event) {
<a name="l02540"></a>02540         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a58f76133ea1d0d7cdd4c0254d35d2f36">B_STOPRENDER</a>:
<a name="l02541"></a>02541             <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.afbreek = 1;
<a name="l02542"></a>02542             <span class="keywordflow">break</span>;
<a name="l02543"></a>02543         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#af7af04f0ac9b88ace78371e1d968c4d5">B_STOPCAST</a>:
<a name="l02544"></a>02544             <a class="code" href="../../d6/ddf/wm__jobs_8c.html#acd7d1a529406cec4491db88599b22aac">WM_jobs_stop</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02545"></a>02545             <span class="keywordflow">break</span>;
<a name="l02546"></a>02546         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#af22071afc216ff6bf23eaf924bf495e7">B_STOPANIM</a>:
<a name="l02547"></a>02547             <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a31f9a9093119792c53e4d38d2d3fdff8">WM_OP_INVOKE_SCREEN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02548"></a>02548             <span class="keywordflow">break</span>;
<a name="l02549"></a>02549         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#aa407c468a79472fb9d5648fc2922c8fc">B_STOPCOMPO</a>:
<a name="l02550"></a>02550             <a class="code" href="../../d6/ddf/wm__jobs_8c.html#acd7d1a529406cec4491db88599b22aac">WM_jobs_stop</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02551"></a>02551             <span class="keywordflow">break</span>;
<a name="l02552"></a>02552         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#ab23574796d53e64025ef01c1f50cd7a4">B_STOPSEQ</a>:
<a name="l02553"></a>02553             <a class="code" href="../../d6/ddf/wm__jobs_8c.html#acd7d1a529406cec4491db88599b22aac">WM_jobs_stop</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02554"></a>02554             <span class="keywordflow">break</span>;
<a name="l02555"></a>02555         <span class="keywordflow">case</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#adcd203d0b19cfece7200ca2553426572">B_STOPCLIP</a>:
<a name="l02556"></a>02556             <a class="code" href="../../d6/ddf/wm__jobs_8c.html#acd7d1a529406cec4491db88599b22aac">WM_jobs_stop</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02557"></a>02557             <span class="keywordflow">break</span>;
<a name="l02558"></a>02558     }
<a name="l02559"></a>02559 }
<a name="l02560"></a>02560 
<a name="l02561"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a2a7fa5485d5c9eef12701aa15351aa80">02561</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a21a0e965d7bff1efbe66f8bbcc004baf">uiTemplateRunningJobs</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l02562"></a>02562 {
<a name="l02563"></a>02563     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen = <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l02564"></a>02564     <a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *wm = <a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C);
<a name="l02565"></a>02565     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02566"></a>02566     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l02567"></a>02567     <span class="keywordtype">void</span> *owner = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02568"></a>02568     <span class="keywordtype">int</span> handle_event;
<a name="l02569"></a>02569     
<a name="l02570"></a>02570     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l02571"></a>02571     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a9607880380703426c9e76c66dc23a1f4">uiBlockSetCurLayout</a>(block, layout);
<a name="l02572"></a>02572 
<a name="l02573"></a>02573     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a678b88dc2247856d2d804986daf134cb">uiBlockSetHandleFunc</a>(block, <a class="code" href="../../d5/d05/interface__templates_8c.html#a382f14cb8f48394d1b43792ee97578dc">do_running_jobs</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02574"></a>02574 
<a name="l02575"></a>02575     <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca2ef41082c072d92dbf2d57e20442751d">SPACE_NODE</a>) {
<a name="l02576"></a>02576         <span class="keywordflow">if</span> (<a class="code" href="../../d6/ddf/wm__jobs_8c.html#ac173761e5d2abe3fef0c66bed8c471fd">WM_jobs_test</a>(wm, sa))
<a name="l02577"></a>02577             owner = sa;
<a name="l02578"></a>02578         handle_event = <a class="code" href="../../d5/d05/interface__templates_8c.html#aa407c468a79472fb9d5648fc2922c8fc">B_STOPCOMPO</a>;
<a name="l02579"></a>02579     }
<a name="l02580"></a>02580     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caa78bb4ba1705225aa14af78400406414">SPACE_SEQ</a>) {
<a name="l02581"></a>02581         <span class="keywordflow">if</span> (<a class="code" href="../../d6/ddf/wm__jobs_8c.html#ac173761e5d2abe3fef0c66bed8c471fd">WM_jobs_test</a>(wm, sa))
<a name="l02582"></a>02582             owner = sa;
<a name="l02583"></a>02583         handle_event = <a class="code" href="../../d5/d05/interface__templates_8c.html#ab23574796d53e64025ef01c1f50cd7a4">B_STOPSEQ</a>;
<a name="l02584"></a>02584     }
<a name="l02585"></a>02585     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca02bf62758ff66d33c28826738012179d">SPACE_CLIP</a>) {
<a name="l02586"></a>02586         <span class="keywordflow">if</span> (<a class="code" href="../../d6/ddf/wm__jobs_8c.html#ac173761e5d2abe3fef0c66bed8c471fd">WM_jobs_test</a>(wm, sa))
<a name="l02587"></a>02587             owner = sa;
<a name="l02588"></a>02588         handle_event = <a class="code" href="../../d5/d05/interface__templates_8c.html#adcd203d0b19cfece7200ca2553426572">B_STOPCLIP</a>;
<a name="l02589"></a>02589     }
<a name="l02590"></a>02590     <span class="keywordflow">else</span> {
<a name="l02591"></a>02591         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene;
<a name="l02592"></a>02592         <span class="comment">/* another scene can be rendering too, for example via compositor */</span>
<a name="l02593"></a>02593         <span class="keywordflow">for</span> (scene = <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C)-&gt;scene.first; scene; scene = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l02594"></a>02594             <span class="keywordflow">if</span> (<a class="code" href="../../d6/ddf/wm__jobs_8c.html#ac173761e5d2abe3fef0c66bed8c471fd">WM_jobs_test</a>(wm, scene))
<a name="l02595"></a>02595                 <span class="keywordflow">break</span>;
<a name="l02596"></a>02596         owner = scene;
<a name="l02597"></a>02597         handle_event = <a class="code" href="../../d5/d05/interface__templates_8c.html#a58f76133ea1d0d7cdd4c0254d35d2f36">B_STOPRENDER</a>;
<a name="l02598"></a>02598     }
<a name="l02599"></a>02599 
<a name="l02600"></a>02600     <span class="keywordflow">if</span> (owner) {
<a name="l02601"></a>02601         <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *ui_abs;
<a name="l02602"></a>02602         
<a name="l02603"></a>02603         ui_abs = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5b53413358411c336949b9b3ddedeced">uiLayoutAbsolute</a>(layout, 0);
<a name="l02604"></a>02604         (void)ui_abs; <span class="comment">// UNUSED</span>
<a name="l02605"></a>02605         
<a name="l02606"></a>02606         <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, handle_event, ICON_PANEL_CLOSE, 
<a name="l02607"></a>02607                      0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> * 0.1, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> * 0.8, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a> * 0.8, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Stop this job&quot;</span>));
<a name="l02608"></a>02608         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a2e8b374db15e64ac6199e8ca5c1bc0b2">PROGRESSBAR</a>, 0, <a class="code" href="../../d6/ddf/wm__jobs_8c.html#a64d9bc0874089bdfff687bad48a00583">WM_jobs_name</a>(wm, owner), 
<a name="l02609"></a>02609                  <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, 0, 100, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, <a class="code" href="../../d6/ddf/wm__jobs_8c.html#ae9f3158aa924b549f252f009e6c81ddc">WM_jobs_progress</a>(wm, owner), 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Progress&quot;</span>));
<a name="l02610"></a>02610         
<a name="l02611"></a>02611         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(layout, 0);
<a name="l02612"></a>02612     }
<a name="l02613"></a>02613     <span class="keywordflow">if</span> (<a class="code" href="../../d6/ddf/wm__jobs_8c.html#ac173761e5d2abe3fef0c66bed8c471fd">WM_jobs_test</a>(wm, screen))
<a name="l02614"></a>02614         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#af7af04f0ac9b88ace78371e1d968c4d5">B_STOPCAST</a>, ICON_CANCEL, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Capture&quot;</span>), 0, 0, 85, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0,
<a name="l02615"></a>02615                          <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Stop screencast&quot;</span>));
<a name="l02616"></a>02616     <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>)
<a name="l02617"></a>02617         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4d5e60fb7b1232c922c87756f90161ff">uiDefIconTextBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, <a class="code" href="../../d5/d05/interface__templates_8c.html#af22071afc216ff6bf23eaf924bf495e7">B_STOPANIM</a>, ICON_CANCEL, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Anim Player&quot;</span>), 0, 0, 100, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0,
<a name="l02618"></a>02618                          <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Stop animation playback&quot;</span>));
<a name="l02619"></a>02619 }
<a name="l02620"></a>02620 
<a name="l02621"></a>02621 <span class="comment">/************************* Reports for Last Operator Template **************************/</span>
<a name="l02622"></a>02622 
<a name="l02623"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a5795da91abc726ab25bcc2cd23de2ff9">02623</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a6818e55e5cf16ce21b8b34c6fe79578f">uiTemplateReportsBanner</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l02624"></a>02624 {
<a name="l02625"></a>02625     <a class="code" href="../../df/df0/structReportList.html">ReportList</a> *reports = <a class="code" href="../../df/d01/BKE__context_8h.html#ac83792b6e00e841cdb896c9c0230bde7">CTX_wm_reports</a>(C);
<a name="l02626"></a>02626     <a class="code" href="../../d2/dd6/structReport.html">Report</a> *report = <a class="code" href="../../d2/d40/BKE__report_8h.html#a4cc3a5fb6928f3b6522b39a5ec14d4a7">BKE_reports_last_displayable</a>(reports);
<a name="l02627"></a>02627     <a class="code" href="../../d4/d3f/structReportTimerInfo.html">ReportTimerInfo</a> *rti;
<a name="l02628"></a>02628     
<a name="l02629"></a>02629     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *ui_abs;
<a name="l02630"></a>02630     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l02631"></a>02631     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l02632"></a>02632     <a class="code" href="../../d3/d28/structuiStyle.html">uiStyle</a> *style = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a16828a47eb4af34d08dce0ead86693b3">UI_GetStyle</a>();
<a name="l02633"></a>02633     <span class="keywordtype">int</span> width;
<a name="l02634"></a>02634     <span class="keywordtype">int</span> icon = 0;
<a name="l02635"></a>02635     
<a name="l02636"></a>02636     <span class="comment">/* if the report display has timed out, don&#39;t show */</span>
<a name="l02637"></a>02637     <span class="keywordflow">if</span> (!reports-&gt;<a class="code" href="../../df/df0/structReportList.html#ac65127a29493297881520cb6a06be0fd">reporttimer</a>) <span class="keywordflow">return</span>;
<a name="l02638"></a>02638     
<a name="l02639"></a>02639     rti = (<a class="code" href="../../d4/d3f/structReportTimerInfo.html">ReportTimerInfo</a> *)reports-&gt;<a class="code" href="../../df/df0/structReportList.html#ac65127a29493297881520cb6a06be0fd">reporttimer</a>-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#a7e5850b6474f3948cb59cbd188ce68a6">customdata</a>;
<a name="l02640"></a>02640     
<a name="l02641"></a>02641     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (!rti || rti-&gt;<a class="code" href="../../d4/d3f/structReportTimerInfo.html#a25a349fd0a86069edf9f14afb4e9cee3">widthfac</a> == 0.0f || !report) <span class="keywordflow">return</span>;
<a name="l02642"></a>02642     
<a name="l02643"></a>02643     ui_abs = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5b53413358411c336949b9b3ddedeced">uiLayoutAbsolute</a>(layout, 0);
<a name="l02644"></a>02644     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(ui_abs);
<a name="l02645"></a>02645     
<a name="l02646"></a>02646     width = <a class="code" href="../../df/d5d/BLF__api_8h.html#a3b01ca673c67a730433f5156daf6ca29">BLF_width</a>(style-&gt;<a class="code" href="../../d3/d28/structuiStyle.html#ac9c53013a87786238c8f707bc39d81a6">widget</a>.<a class="code" href="../../df/d6e/structuiFontStyle.html#a9a1dd426613c712d2306f01553539ce7">uifont_id</a>, report-&gt;<a class="code" href="../../d2/dd6/structReport.html#ab65b90ed34c3aadcd0494b59d30eef99">message</a>);
<a name="l02647"></a>02647     width = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(rti-&gt;<a class="code" href="../../d4/d3f/structReportTimerInfo.html#a25a349fd0a86069edf9f14afb4e9cee3">widthfac</a> * width, width);
<a name="l02648"></a>02648     width = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(width, 10);
<a name="l02649"></a>02649     
<a name="l02650"></a>02650     <span class="comment">/* make a box around the report to make it stand out */</span>
<a name="l02651"></a>02651     <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae4c674e4e473631554c7372d8c6cb36e">uiBlockBeginAlign</a>(block);
<a name="l02652"></a>02652     but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a20f5ee572977e66f70f3350e350a5ad9">ROUNDBOX</a>, 0, <span class="stringliteral">&quot;&quot;</span>, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> + 10, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02653"></a>02653     <span class="comment">/* set the report&#39;s bg color in but-&gt;col - ROUNDBOX feature */</span>
<a name="l02654"></a>02654     <a class="code" href="../../d8/de1/BLI__math__color_8h.html#a9b3bb8bb3331550782244e732cd1d349">rgb_float_to_uchar</a>(but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a2a73ba930eaf5c11489e393cf582990c">col</a>, rti-&gt;<a class="code" href="../../d4/d3f/structReportTimerInfo.html#a802de3a97b6d2ede1bddd3ec57019700">col</a>);
<a name="l02655"></a>02655     but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a2a73ba930eaf5c11489e393cf582990c">col</a>[3] = 255;
<a name="l02656"></a>02656 
<a name="l02657"></a>02657     but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a20f5ee572977e66f70f3350e350a5ad9">ROUNDBOX</a>, 0, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> + 10, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> + width, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02658"></a>02658     but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a2a73ba930eaf5c11489e393cf582990c">col</a>[0] = but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a2a73ba930eaf5c11489e393cf582990c">col</a>[1] = but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a2a73ba930eaf5c11489e393cf582990c">col</a>[2] = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a950f9248447cf3159372f4f48e7504d6">FTOCHAR</a>(rti-&gt;<a class="code" href="../../d4/d3f/structReportTimerInfo.html#ad0d5df787599581cfaffd9ad4a9da967">greyscale</a>);
<a name="l02659"></a>02659     but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a2a73ba930eaf5c11489e393cf582990c">col</a>[3] = 255;
<a name="l02660"></a>02660 
<a name="l02661"></a>02661     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a760b83d713e0915ddaf3d307910e1c37">uiBlockEndAlign</a>(block);
<a name="l02662"></a>02662     
<a name="l02663"></a>02663     
<a name="l02664"></a>02664     <span class="comment">/* icon and report message on top */</span>
<a name="l02665"></a>02665     <span class="keywordflow">if</span> (report-&gt;<a class="code" href="../../d2/dd6/structReport.html#a4781d613a586f7aba1b820e12a5d2131">type</a> &amp; <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a58f46868e4d34e3dfb4711ab0c4917c2">RPT_ERROR_ALL</a>)
<a name="l02666"></a>02666         icon = ICON_ERROR;
<a name="l02667"></a>02667     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (report-&gt;<a class="code" href="../../d2/dd6/structReport.html#a4781d613a586f7aba1b820e12a5d2131">type</a> &amp; <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a9d99c8e53dbffbdbdcb72a721495e602">RPT_WARNING_ALL</a>)
<a name="l02668"></a>02668         icon = ICON_ERROR;
<a name="l02669"></a>02669     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (report-&gt;<a class="code" href="../../d2/dd6/structReport.html#a4781d613a586f7aba1b820e12a5d2131">type</a> &amp; <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a5f17d98cdbaa09a28a0c944765b8fec0">RPT_INFO_ALL</a>)
<a name="l02670"></a>02670         icon = ICON_INFO;
<a name="l02671"></a>02671     
<a name="l02672"></a>02672     <span class="comment">/* XXX: temporary operator to dump all reports to a text block, but only if more than 1 report </span>
<a name="l02673"></a>02673 <span class="comment">     * to be shown instead of icon when appropriate...</span>
<a name="l02674"></a>02674 <span class="comment">     */</span>
<a name="l02675"></a>02675     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l02676"></a>02676 
<a name="l02677"></a>02677     <span class="keywordflow">if</span> (reports-&gt;<a class="code" href="../../df/df0/structReportList.html#af4a8f2f776b099673ecbc6f04bf5db31">list</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> != reports-&gt;<a class="code" href="../../df/df0/structReportList.html#af4a8f2f776b099673ecbc6f04bf5db31">list</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>)
<a name="l02678"></a>02678         <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab77845284cea887b0abaa904c4b4b6c4">uiDefIconButO</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, <span class="stringliteral">&quot;UI_OT_reports_to_textblock&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, icon, 2, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Click to see rest of reports in textblock: &#39;Recent Reports&#39;&quot;</span>));
<a name="l02679"></a>02679     <span class="keywordflow">else</span>
<a name="l02680"></a>02680         <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a0b7df70d4a086a227bc482b07e2bbbca">LABEL</a>, 0, icon, 2, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02681"></a>02681 
<a name="l02682"></a>02682     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l02683"></a>02683     
<a name="l02684"></a>02684     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aff9055599f7d998b2b3ff2f02c6fb597">uiDefBut</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a0b7df70d4a086a227bc482b07e2bbbca">LABEL</a>, 0, report-&gt;<a class="code" href="../../d2/dd6/structReport.html#ab65b90ed34c3aadcd0494b59d30eef99">message</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> + 10, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a> + width, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, 0.0f, 0, 0, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02685"></a>02685 }
<a name="l02686"></a>02686 
<a name="l02687"></a>02687 <span class="comment">/********************************* Keymap *************************************/</span>
<a name="l02688"></a>02688 
<a name="l02689"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#aa207fdda8f6e5ea45705d3e688b4f9f2">02689</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#aa207fdda8f6e5ea45705d3e688b4f9f2">keymap_item_modified</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <span class="keywordtype">void</span> *kmi_p, <span class="keywordtype">void</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(unused))
<a name="l02690"></a>02690 {
<a name="l02691"></a>02691     <a class="code" href="../../d1/d5e/structwmKeyMapItem.html">wmKeyMapItem</a> *kmi = (<a class="code" href="../../d1/d5e/structwmKeyMapItem.html">wmKeyMapItem</a> *)kmi_p;
<a name="l02692"></a>02692     <a class="code" href="../../d7/d78/wm__keymap_8c.html#ab78b484f3737e0feb315ace1e7c223fc">WM_keyconfig_update_tag</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, kmi);
<a name="l02693"></a>02693 }
<a name="l02694"></a>02694 
<a name="l02695"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#a1e4f33cfea8e9fb6c161fa8f48c0f7d5">02695</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/interface__templates_8c.html#a1e4f33cfea8e9fb6c161fa8f48c0f7d5">template_keymap_item_properties</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <span class="keyword">const</span> <span class="keywordtype">char</span> *title, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr)
<a name="l02696"></a>02696 {
<a name="l02697"></a>02697     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *flow;
<a name="l02698"></a>02698 
<a name="l02699"></a>02699     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5e3bb0f5147561627b0f3f92789476bd">uiItemS</a>(layout);
<a name="l02700"></a>02700 
<a name="l02701"></a>02701     <span class="keywordflow">if</span> (title)
<a name="l02702"></a>02702         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(layout, title, ICON_NONE);
<a name="l02703"></a>02703     
<a name="l02704"></a>02704     flow = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a58b33708380bd362ec7897513118a8e1">uiLayoutColumnFlow</a>(layout, 2, 0);
<a name="l02705"></a>02705 
<a name="l02706"></a>02706     <a class="code" href="../../de/ddf/RNA__access_8h.html#a0969a790d2bade8d53b911a425188202">RNA_STRUCT_BEGIN</a>(ptr, prop) {
<a name="l02707"></a>02707         <span class="keywordtype">int</span> flag = <a class="code" href="../../d3/d10/rna__access_8c.html#a977a3c85a8d6d0a8b126e99a4955c634">RNA_property_flag</a>(prop);
<a name="l02708"></a>02708 
<a name="l02709"></a>02709         <span class="keywordflow">if</span> (flag &amp; <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ad872b0a5b183c05a4f6c6eaea6807334">PROP_HIDDEN</a>)
<a name="l02710"></a>02710             <span class="keywordflow">continue</span>;
<a name="l02711"></a>02711 
<a name="l02712"></a>02712         <span class="comment">/* recurse for nested properties */</span>
<a name="l02713"></a>02713         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a51b018d85ee119253ae423b9314eeaef">RNA_property_type</a>(prop) == <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87ad5e00a64fb9a818656ec43c5a3817d7c">PROP_POINTER</a>) {
<a name="l02714"></a>02714             <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> propptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a575c543a2a1f509f371bc1cee4fbe4d7">RNA_property_pointer_get</a>(ptr, prop);
<a name="l02715"></a>02715             <span class="keyword">const</span> <span class="keywordtype">char</span> *name = <a class="code" href="../../d3/d10/rna__access_8c.html#abf941f0964c5e2f66e923e88fe845e7e">RNA_property_ui_name</a>(prop);
<a name="l02716"></a>02716 
<a name="l02717"></a>02717             <span class="keywordflow">if</span> (propptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a> &amp;&amp; <a class="code" href="../../d3/d10/rna__access_8c.html#ab0ac980958da7c9390bc055c30bf429b">RNA_struct_is_a</a>(propptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a41f868aea62068fbbfa36c1a5dbe30f9">type</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#abd96241c85f66caa51fc039791f3e2fb">RNA_OperatorProperties</a>)) {
<a name="l02718"></a>02718                 <a class="code" href="../../d5/d05/interface__templates_8c.html#a1e4f33cfea8e9fb6c161fa8f48c0f7d5">template_keymap_item_properties</a>(layout, name, &amp;propptr);
<a name="l02719"></a>02719                 <span class="keywordflow">continue</span>;
<a name="l02720"></a>02720             }
<a name="l02721"></a>02721         }
<a name="l02722"></a>02722 
<a name="l02723"></a>02723         <span class="comment">/* add property */</span>
<a name="l02724"></a>02724         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(flow, ptr, <a class="code" href="../../d3/d10/rna__access_8c.html#ad6f3c9684a8786587872fc6baf17dfc9">RNA_property_identifier</a>(prop), 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l02725"></a>02725     }
<a name="l02726"></a>02726     <a class="code" href="../../de/ddf/RNA__access_8h.html#a187bb3c525d1f0717e3c27837eaae8e1">RNA_STRUCT_END</a>;
<a name="l02727"></a>02727 }
<a name="l02728"></a>02728 
<a name="l02729"></a><a class="code" href="../../d5/d05/interface__templates_8c.html#acb5582df10b1d3894507afc4100f2afb">02729</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8989e61eed7acc3adf8951f2bf5a8158">uiTemplateKeymapItemProperties</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ptr)
<a name="l02730"></a>02730 {
<a name="l02731"></a>02731     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> propptr = <a class="code" href="../../d3/d10/rna__access_8c.html#a243277576891ecaf204382563ed46364">RNA_pointer_get</a>(ptr, <span class="stringliteral">&quot;properties&quot;</span>);
<a name="l02732"></a>02732 
<a name="l02733"></a>02733     <span class="keywordflow">if</span> (propptr.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>) {
<a name="l02734"></a>02734         <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout)-&gt;<a class="code" href="../../df/d5b/structuiBlock.html#a844299999568743bc189fcb02847e9e6">buttons</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l02735"></a>02735 
<a name="l02736"></a>02736         <a class="code" href="../../d5/d05/interface__templates_8c.html#a1e4f33cfea8e9fb6c161fa8f48c0f7d5">template_keymap_item_properties</a>(layout, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;propptr);
<a name="l02737"></a>02737 
<a name="l02738"></a>02738         <span class="comment">/* attach callbacks to compensate for missing properties update,</span>
<a name="l02739"></a>02739 <span class="comment">         * we don&#39;t know which keymap (item) is being modified there */</span>
<a name="l02740"></a>02740         <span class="keywordflow">for</span> (; but; but = but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a115d85d61bc4c6fd0756320cb94f554e">next</a>)
<a name="l02741"></a>02741             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(but, <a class="code" href="../../d5/d05/interface__templates_8c.html#aa207fdda8f6e5ea45705d3e688b4f9f2">keymap_item_modified</a>, ptr-&gt;<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02742"></a>02742     }
<a name="l02743"></a>02743 }
<a name="l02744"></a>02744 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:26 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
