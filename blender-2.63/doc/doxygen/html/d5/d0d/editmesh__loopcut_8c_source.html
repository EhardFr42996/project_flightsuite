<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: editmesh_loopcut.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">editmesh_loopcut.c</div>  </div>
</div>
<div class="contents">
<a href="../../d5/d0d/editmesh__loopcut_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version. </span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2007 Blender Foundation.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * </span>
<a name="l00022"></a>00022 <span class="comment"> * Contributor(s): Joseph Eagar, Joshua Leung</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;float.h&gt;</span>
<a name="l00032"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a525335710b53cb064ca56b936120431e">00032</a> <span class="preprocessor">#define _USE_MATH_DEFINES</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span><span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/dfb/DNA__ID_8h.html" title="ID and Library types, which are fundamental for sdna.">DNA_ID.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d96/DNA__mesh__types_8h.html">DNA_mesh_types.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da4/DNA__screen__types_8h.html">DNA_screen_types.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/de4/DNA__userdef__types_8h.html">DNA_userdef_types.h</a>&quot;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d2e/PIL__time_8h.html">PIL_time.h</a>&quot;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d6c/BLI__array_8h.html">BLI_array.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc9/BLI__dynstr_8h.html" title="A dynamically sized string ADT.">BLI_dynstr.h</a>&quot;</span> <span class="comment">/*for WM_operator_pystring */</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/ddf/BKE__blender_8h.html" title="Blender util stuff.">BKE_blender.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d7f/BKE__mesh_8h.html">BKE_mesh.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d0f/BKE__modifier_8h.html">BKE_modifier.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/BKE__report_8h.html">BKE_report.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d53/BKE__scene_8h.html">BKE_scene.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html">BKE_tessmesh.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d44/BIF__gl_8h.html">BIF_gl.h</a>&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d71/BIF__glutil_8h.html">BIF_glutil.h</a>&quot;</span> <span class="comment">/* for paint cursor */</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc9/IMB__imbuf__types_8h.html" title="Contains defines and structs used throughout the imbuf module.">IMB_imbuf_types.h</a>&quot;</span>
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d5f/ED__space__api_8h.html">ED_space_api.h</a>&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d6a/ED__view3d_8h.html">ED_view3d.h</a>&quot;</span>
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/dd6/ED__mesh_8h.html">ED_mesh.h</a>&quot;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d36/ED__numinput_8h.html">ED_numinput.h</a>&quot;</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/RNA__define_8h.html">RNA_define.h</a>&quot;</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1e/UI__interface_8h.html">UI_interface.h</a>&quot;</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00082"></a>00082 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d5c/mesh__intern_8h.html">mesh_intern.h</a>&quot;</span>
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="comment">/* ringsel operator */</span>
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="comment">/* struct for properties used while drawing */</span>
<a name="l00089"></a><a class="code" href="../../db/d13/structtringselOpData.html">00089</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> {
<a name="l00090"></a><a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">00090</a>     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>;        <span class="comment">/* region that ringsel was activated in */</span>
<a name="l00091"></a><a class="code" href="../../db/d13/structtringselOpData.html#acb0d747852428a863d4f6cab12f4fbfe">00091</a>     <span class="keywordtype">void</span> *<a class="code" href="../../db/d13/structtringselOpData.html#acb0d747852428a863d4f6cab12f4fbfe">draw_handle</a>;  <span class="comment">/* for drawing preview loop */</span>
<a name="l00092"></a>00092     
<a name="l00093"></a><a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">00093</a>     float (*<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>)[2][3];
<a name="l00094"></a><a class="code" href="../../db/d13/structtringselOpData.html#a81700a6a6b3560a61358af88751095a7">00094</a>     <span class="keywordtype">int</span> <a class="code" href="../../db/d13/structtringselOpData.html#a81700a6a6b3560a61358af88751095a7">totedge</a>;
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">00096</a>     <a class="code" href="../../d8/d30/structViewContext.html">ViewContext</a> <a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>;
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">00098</a>     <a class="code" href="../../de/de7/structObject.html">Object</a> *<a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">ob</a>;
<a name="l00099"></a><a class="code" href="../../db/d13/structtringselOpData.html#aecba9500f56fdf0fc1c5483abe4c11c7">00099</a>     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *<a class="code" href="../../db/d13/structtringselOpData.html#aecba9500f56fdf0fc1c5483abe4c11c7">em</a>;
<a name="l00100"></a><a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">00100</a>     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>;
<a name="l00101"></a><a class="code" href="../../db/d13/structtringselOpData.html#a456587818319a40e42373253522571e0">00101</a>     <a class="code" href="../../d9/d39/structNumInput.html">NumInput</a> <a class="code" href="../../db/d13/structtringselOpData.html#a456587818319a40e42373253522571e0">num</a>;
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="../../db/d13/structtringselOpData.html#a817d865c01428ee82f25d075bbfcc5ff">00103</a>     <span class="keywordtype">int</span> <a class="code" href="../../db/d13/structtringselOpData.html#a817d865c01428ee82f25d075bbfcc5ff">extend</a>;
<a name="l00104"></a><a class="code" href="../../db/d13/structtringselOpData.html#a8baa0dbd2dc126f1a2f1efc2167b885d">00104</a>     <span class="keywordtype">int</span> <a class="code" href="../../db/d13/structtringselOpData.html#a8baa0dbd2dc126f1a2f1efc2167b885d">do_cut</a>;
<a name="l00105"></a>00105 } <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a572bdcbd62518e5a1a3a0b2a5c81dd1b">tringselOpData</a>;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">/* modal loop selection drawing callback */</span>
<a name="l00108"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a4415a06c29ff54b427b40941aaa009d4">00108</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a4415a06c29ff54b427b40941aaa009d4">ringsel_draw</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ar), <span class="keywordtype">void</span> *arg)
<a name="l00109"></a>00109 {
<a name="l00110"></a>00110     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = <a class="code" href="../../df/d01/BKE__context_8h.html#a88ab4a564441708766a6b4ace3b17908">CTX_wm_view3d</a>(C);
<a name="l00111"></a>00111     <a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd = arg;
<a name="l00112"></a>00112     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00113"></a>00113     
<a name="l00114"></a>00114     <span class="keywordflow">if</span> (lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a81700a6a6b3560a61358af88751095a7">totedge</a> &gt; 0) {
<a name="l00115"></a>00115         <span class="keywordflow">if</span> (v3d &amp;&amp; v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#afd443bfd0de5169661f08aa1eeb3bd69">zbuf</a>)
<a name="l00116"></a>00116             glDisable(GL_DEPTH_TEST);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118         glPushMatrix();
<a name="l00119"></a>00119         <a class="code" href="../../dd/d44/BIF__gl_8h.html#a22a8b7985dcd174e9add6f20aa37a962">glMultMatrixf</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         glColor3ub(255, 0, 255);
<a name="l00122"></a>00122         glBegin(GL_LINES);
<a name="l00123"></a>00123         <span class="keywordflow">for</span> (i = 0; i &lt; lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a81700a6a6b3560a61358af88751095a7">totedge</a>; i++) {
<a name="l00124"></a>00124             glVertex3fv(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>[i][0]);
<a name="l00125"></a>00125             glVertex3fv(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>[i][1]);
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127         glEnd();
<a name="l00128"></a>00128 
<a name="l00129"></a>00129         glPopMatrix();
<a name="l00130"></a>00130         <span class="keywordflow">if</span> (v3d &amp;&amp; v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#afd443bfd0de5169661f08aa1eeb3bd69">zbuf</a>)
<a name="l00131"></a>00131             glEnable(GL_DEPTH_TEST);
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 <span class="comment">/* given two opposite edges in a face, finds the ordering of their vertices so</span>
<a name="l00136"></a>00136 <span class="comment"> * that cut preview lines won&#39;t cross each other */</span>
<a name="l00137"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#ab8bf99c229b737cb91eaab24d4ce1883">00137</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#ab8bf99c229b737cb91eaab24d4ce1883">edgering_find_order</a>(<a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *lasteed, <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed,
<a name="l00138"></a>00138                                 <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *lastv1, <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *v[2][2])
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> liter;
<a name="l00141"></a>00141     <a class="code" href="../../dc/dd5/structBMLoop.html">BMLoop</a> *l, *l2;
<a name="l00142"></a>00142     <span class="keywordtype">int</span> rev;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     l = eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab9029150e1f571daf0c3e21c0bf6f797">l</a>;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     <span class="comment">/* find correct order for v[1] */</span>
<a name="l00147"></a>00147     <span class="keywordflow">if</span> (!(<a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a3128f46805d84c14939533499e3d910e">BM_edge_in_face</a>(l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a91ef300365e03d63842c7b694626bbb7">f</a>, eed) &amp;&amp; <a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a3128f46805d84c14939533499e3d910e">BM_edge_in_face</a>(l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a91ef300365e03d63842c7b694626bbb7">f</a>, lasteed))) {
<a name="l00148"></a>00148         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a5e5c4d17117bdcca9ab959ebf43a174f">BM_ITER_ELEM</a> (l, &amp;liter, l, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa08d813919c78cddefbb312ab86a31c39">BM_LOOPS_OF_LOOP</a>) {
<a name="l00149"></a>00149             <span class="keywordflow">if</span> (<a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a3128f46805d84c14939533499e3d910e">BM_edge_in_face</a>(l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a91ef300365e03d63842c7b694626bbb7">f</a>, eed) &amp;&amp; <a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a3128f46805d84c14939533499e3d910e">BM_edge_in_face</a>(l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a91ef300365e03d63842c7b694626bbb7">f</a>, lasteed))
<a name="l00150"></a>00150                 <span class="keywordflow">break</span>;
<a name="l00151"></a>00151         }
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153     
<a name="l00154"></a>00154     <span class="comment">/* this should never happen */</span>
<a name="l00155"></a>00155     <span class="keywordflow">if</span> (!l) {
<a name="l00156"></a>00156         v[0][0] = eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>;
<a name="l00157"></a>00157         v[0][1] = eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>;
<a name="l00158"></a>00158         v[1][0] = lasteed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>;
<a name="l00159"></a>00159         v[1][1] = lasteed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>;
<a name="l00160"></a>00160         <span class="keywordflow">return</span>;
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162     
<a name="l00163"></a>00163     l2 = <a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a01cc24309f04206082c6b4198d46912c" title="Other Loop in Face Sharing an Edge.">BM_face_other_edge_loop</a>(l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a91ef300365e03d63842c7b694626bbb7">f</a>, l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a37f32bdf99c1763a272342a3c83b5f51">e</a>, eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>);
<a name="l00164"></a>00164     rev = (l2 == l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a7566c73bc0e246e2b6db70c5e2284102">prev</a>);
<a name="l00165"></a>00165     <span class="keywordflow">while</span> (l2-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a2da088cf339e17dafd9f5e7ee0bf3771">v</a> != lasteed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a> &amp;&amp; l2-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a2da088cf339e17dafd9f5e7ee0bf3771">v</a> != lasteed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>) {
<a name="l00166"></a>00166         l2 = rev ? l2-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a7566c73bc0e246e2b6db70c5e2284102">prev</a> : l2-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#af78d4a4546e654c1dcc6ebe6476ff0b0">next</a>;
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169     <span class="keywordflow">if</span> (l2-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a2da088cf339e17dafd9f5e7ee0bf3771">v</a> == lastv1) {
<a name="l00170"></a>00170         v[0][0] = eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>;
<a name="l00171"></a>00171         v[0][1] = eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>;
<a name="l00172"></a>00172     }
<a name="l00173"></a>00173     <span class="keywordflow">else</span> {
<a name="l00174"></a>00174         v[0][0] = eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>;
<a name="l00175"></a>00175         v[0][1] = eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>;
<a name="l00176"></a>00176     }
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a313c024f9651ca8024fba846b7856f49">00179</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a313c024f9651ca8024fba846b7856f49">edgering_sel</a>(<a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd, <span class="keywordtype">int</span> previewlines, <span class="keywordtype">int</span> select)
<a name="l00180"></a>00180 {
<a name="l00181"></a>00181     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aecba9500f56fdf0fc1c5483abe4c11c7">em</a>;
<a name="l00182"></a>00182     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *startedge = lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>;
<a name="l00183"></a>00183     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed, *lasteed;
<a name="l00184"></a>00184     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *v[2][2], *lastv1;
<a name="l00185"></a>00185     <a class="code" href="../../d6/d0e/structBMWalker.html">BMWalker</a> walker;
<a name="l00186"></a>00186     float (*edges)[2][3] = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00187"></a>00187     <a class="code" href="../../da/d6c/BLI__array_8h.html#ae22059e2259b0ea217cfe400e698d21e">BLI_array_declare</a>(edges);
<a name="l00188"></a>00188     <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[2][3];
<a name="l00189"></a>00189     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, tot = 0;
<a name="l00190"></a>00190     
<a name="l00191"></a>00191     memset(v, 0, <span class="keyword">sizeof</span>(v));
<a name="l00192"></a>00192     
<a name="l00193"></a>00193     <span class="keywordflow">if</span> (!startedge)
<a name="l00194"></a>00194         <span class="keywordflow">return</span>;
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="keywordflow">if</span> (lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>) {
<a name="l00197"></a>00197         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>);
<a name="l00198"></a>00198         lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00199"></a>00199         lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a81700a6a6b3560a61358af88751095a7">totedge</a> = 0;
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <span class="keywordflow">if</span> (!lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a817d865c01428ee82f25d075bbfcc5ff">extend</a>) {
<a name="l00203"></a>00203         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aecba9500f56fdf0fc1c5483abe4c11c7">em</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="keywordflow">if</span> (select) {
<a name="l00207"></a>00207         <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a255f04e329b6a69cd64a6fe4ef4fc8f4" title="Init Walker.">BMW_init</a>(&amp;walker, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#aedcf2109f459315e1a7f2af73ec9b603a2022c5383f294bd1ef953b9cf391bb7b">BMW_EDGERING</a>,
<a name="l00208"></a>00208                  <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>,
<a name="l00209"></a>00209                  <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a94afa7b7a898f52e57cb96eb86a6506fa920d842b659ab1adcea06219bbab4da3">BMW_FLAG_TEST_HIDDEN</a>,
<a name="l00210"></a>00210                  <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a377591c19d65f85395a3409f304f7b71">BMW_NIL_LAY</a>);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212         eed = <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a725d1d5ae468a41811602645a85357f6">BMW_begin</a>(&amp;walker, startedge);
<a name="l00213"></a>00213         <span class="keywordflow">for</span> ( ; eed; eed = <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#ac10013e80d092bcbe5c601754fb420ac" title="Step Walker.">BMW_step</a>(&amp;walker)) {
<a name="l00214"></a>00214             <a class="code" href="../../d5/def/bmesh__marking_8c.html#a36117bf878409d6e7a6025d5fc7d2c50" title="Select Edge.">BM_edge_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, eed, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00215"></a>00215         }
<a name="l00216"></a>00216         <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a4aa4dae1cd457b22816e9d767592ce11" title="End Walker.">BMW_end</a>(&amp;walker);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="keywordflow">return</span>;
<a name="l00219"></a>00219     }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a255f04e329b6a69cd64a6fe4ef4fc8f4" title="Init Walker.">BMW_init</a>(&amp;walker, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#aedcf2109f459315e1a7f2af73ec9b603a2022c5383f294bd1ef953b9cf391bb7b">BMW_EDGERING</a>,
<a name="l00222"></a>00222              <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>,
<a name="l00223"></a>00223              <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a94afa7b7a898f52e57cb96eb86a6506fa920d842b659ab1adcea06219bbab4da3">BMW_FLAG_TEST_HIDDEN</a>,
<a name="l00224"></a>00224              <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a377591c19d65f85395a3409f304f7b71">BMW_NIL_LAY</a>);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     eed = startedge = <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a725d1d5ae468a41811602645a85357f6">BMW_begin</a>(&amp;walker, startedge);
<a name="l00227"></a>00227     lastv1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00228"></a>00228     <span class="keywordflow">for</span> (lasteed = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; eed; eed = <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#ac10013e80d092bcbe5c601754fb420ac" title="Step Walker.">BMW_step</a>(&amp;walker)) {
<a name="l00229"></a>00229         <span class="keywordflow">if</span> (lasteed) {
<a name="l00230"></a>00230             <span class="keywordflow">if</span> (lastv1) {
<a name="l00231"></a>00231                 v[1][0] = v[0][0];
<a name="l00232"></a>00232                 v[1][1] = v[0][1];
<a name="l00233"></a>00233             }
<a name="l00234"></a>00234             <span class="keywordflow">else</span> {
<a name="l00235"></a>00235                 v[1][0] = lasteed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>;
<a name="l00236"></a>00236                 v[1][1] = lasteed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>;
<a name="l00237"></a>00237                 lastv1 = lasteed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>;
<a name="l00238"></a>00238             }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240             <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#ab8bf99c229b737cb91eaab24d4ce1883">edgering_find_order</a>(lasteed, eed, lastv1, v);
<a name="l00241"></a>00241             lastv1 = v[0][0];
<a name="l00242"></a>00242 
<a name="l00243"></a>00243             <a class="code" href="../../da/d6c/BLI__array_8h.html#a2b94e088d5d4b36bccad5ad91b41da23">BLI_array_growitems</a>(edges, previewlines);
<a name="l00244"></a>00244 
<a name="l00245"></a>00245             <span class="keywordflow">for</span> (i = 1; i &lt;= previewlines; i++) {
<a name="l00246"></a>00246                 co[0][0] = (v[0][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0] - v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[0][0]-&gt;co[0];
<a name="l00247"></a>00247                 co[0][1] = (v[0][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1] - v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1];
<a name="l00248"></a>00248                 co[0][2] = (v[0][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2] - v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2];
<a name="l00249"></a>00249 
<a name="l00250"></a>00250                 co[1][0] = (v[1][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0] - v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0];
<a name="l00251"></a>00251                 co[1][1] = (v[1][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1] - v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1];
<a name="l00252"></a>00252                 co[1][2] = (v[1][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2] - v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2];
<a name="l00253"></a>00253 
<a name="l00254"></a>00254                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(edges[tot][0], co[0]);
<a name="l00255"></a>00255                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(edges[tot][1], co[1]);
<a name="l00256"></a>00256                 tot++;
<a name="l00257"></a>00257             }
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259         lasteed = eed;
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261     
<a name="l00262"></a>00262     <span class="keywordflow">if</span> (lasteed != startedge &amp;&amp; <a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a0d950827f9f6c904e1cb6026e09f32b7">BM_edge_share_face_count</a>(lasteed, startedge)) {
<a name="l00263"></a>00263         v[1][0] = v[0][0];
<a name="l00264"></a>00264         v[1][1] = v[0][1];
<a name="l00265"></a>00265 
<a name="l00266"></a>00266         <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#ab8bf99c229b737cb91eaab24d4ce1883">edgering_find_order</a>(lasteed, startedge, lastv1, v);
<a name="l00267"></a>00267         
<a name="l00268"></a>00268         <a class="code" href="../../da/d6c/BLI__array_8h.html#a2b94e088d5d4b36bccad5ad91b41da23">BLI_array_growitems</a>(edges, previewlines);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270         <span class="keywordflow">for</span> (i = 1; i &lt;= previewlines; i++) {
<a name="l00271"></a>00271             <span class="keywordflow">if</span> (!v[0][0] || !v[0][1] || !v[1][0] || !v[1][1])
<a name="l00272"></a>00272                 <span class="keywordflow">continue</span>;
<a name="l00273"></a>00273             
<a name="l00274"></a>00274             co[0][0] = (v[0][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0] - v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[0][0]-&gt;co[0];
<a name="l00275"></a>00275             co[0][1] = (v[0][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1] - v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1];
<a name="l00276"></a>00276             co[0][2] = (v[0][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2] - v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[0][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2];
<a name="l00277"></a>00277 
<a name="l00278"></a>00278             co[1][0] = (v[1][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0] - v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0];
<a name="l00279"></a>00279             co[1][1] = (v[1][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1] - v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1];
<a name="l00280"></a>00280             co[1][2] = (v[1][1]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2] - v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2]) * (i / ((<span class="keywordtype">float</span>)previewlines + 1)) + v[1][0]-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2];
<a name="l00281"></a>00281             
<a name="l00282"></a>00282             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(edges[tot][0], co[0]);
<a name="l00283"></a>00283             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(edges[tot][1], co[1]);
<a name="l00284"></a>00284             tot++;
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a4aa4dae1cd457b22816e9d767592ce11" title="End Walker.">BMW_end</a>(&amp;walker);
<a name="l00289"></a>00289     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a> = edges;
<a name="l00290"></a>00290     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a81700a6a6b3560a61358af88751095a7">totedge</a> = tot;
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a456a9f01c95d0bb05e9fa65c161426d1">00293</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a456a9f01c95d0bb05e9fa65c161426d1">ringsel_find_edge</a>(<a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd, <span class="keywordtype">int</span> cuts)
<a name="l00294"></a>00294 {
<a name="l00295"></a>00295     <span class="keywordflow">if</span> (lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>) {
<a name="l00296"></a>00296         <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a313c024f9651ca8024fba846b7856f49">edgering_sel</a>(lcd, cuts, 0);
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>) {
<a name="l00299"></a>00299         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>);
<a name="l00300"></a>00300         lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00301"></a>00301         lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a81700a6a6b3560a61358af88751095a7">totedge</a> = 0;
<a name="l00302"></a>00302     }
<a name="l00303"></a>00303 }
<a name="l00304"></a>00304 
<a name="l00305"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#acc6844e77fc7e7529a66fc962918cd41">00305</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#acc6844e77fc7e7529a66fc962918cd41">ringsel_finish</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00306"></a>00306 {
<a name="l00307"></a>00307     <a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd = op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00308"></a>00308     <span class="keywordtype">int</span> cuts = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>);
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="keywordflow">if</span> (lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>) {
<a name="l00311"></a>00311         <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aecba9500f56fdf0fc1c5483abe4c11c7">em</a>;
<a name="l00312"></a>00312 
<a name="l00313"></a>00313         <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a313c024f9651ca8024fba846b7856f49">edgering_sel</a>(lcd, cuts, 1);
<a name="l00314"></a>00314         
<a name="l00315"></a>00315         <span class="keywordflow">if</span> (lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a8baa0dbd2dc126f1a2f1efc2167b885d">do_cut</a>) {
<a name="l00316"></a>00316             <a class="code" href="../../de/d95/bmesh__operators_8h.html#a67d0dbd86f796d8ad1176c1a98632d69">BM_mesh_esubdivide</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>,
<a name="l00317"></a>00317                                0.0f, 0.0f,
<a name="l00318"></a>00318                                cuts,
<a name="l00319"></a>00319                                <a class="code" href="../../de/d95/bmesh__operators_8h.html#a84627a72058502328269676b81780f89a85df77c3a71412c35fa32377bfda43af">SUBDIV_SELECT_LOOPCUT</a>, <a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122ad508caa163258378cd395cb502737496">SUBD_PATH</a>, 0, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, 0);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321             <span class="comment">/* force edge slide to edge select mode in in face select mode */</span>
<a name="l00322"></a>00322             <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a616adf2bfd4117c15663a28e464a5100">SCE_SELECT_FACE</a>) {
<a name="l00323"></a>00323                 <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> == <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a616adf2bfd4117c15663a28e464a5100">SCE_SELECT_FACE</a>)
<a name="l00324"></a>00324                     em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad6cb358a5c5612c639f998b0601e0865">SCE_SELECT_EDGE</a>;
<a name="l00325"></a>00325                 <span class="keywordflow">else</span>
<a name="l00326"></a>00326                     em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp;= ~<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a616adf2bfd4117c15663a28e464a5100">SCE_SELECT_FACE</a>;
<a name="l00327"></a>00327                 <a class="code" href="../../df/d01/BKE__context_8h.html#ae91ddb50e1e5a0888a5636ce717a8ef3">CTX_data_tool_settings</a>(C)-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a85db400bd7203c7be03555b02e6c2709">selectmode</a> = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a>;
<a name="l00328"></a>00328                 <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ab679116d0ca6edaab30c80d6eeadd0ce">EDBM_selectmode_set</a>(em);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330                 <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a6d45e7088a585f99262267fe26de1b33">ND_TOOLSETTINGS</a>, <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C));
<a name="l00331"></a>00331             }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a25383f13197df9bda823d34736df4d82">ND_DATA</a>, lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l00334"></a>00334             <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a70d8c170e1f4bbcc010d94405d6a9817">DAG_id_tag_update</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>, 0);
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336         <span class="keywordflow">else</span> {
<a name="l00337"></a>00337             
<a name="l00338"></a>00338             <span class="comment">/* sets as active, useful for other tools */</span>
<a name="l00339"></a>00339             <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8de5fe0f8dbf523c4699a7b54c429e2f">SCE_SELECT_VERTEX</a>)
<a name="l00340"></a>00340                 <a class="code" href="../../d9/d94/bmesh__marking_8h.html#a3c5cdc2f0507fa78242993fc4880d87f">BM_select_history_store</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>);  <span class="comment">/* low priority TODO, get vertrex close to mouse */</span>
<a name="l00341"></a>00341             <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad6cb358a5c5612c639f998b0601e0865">SCE_SELECT_EDGE</a>)
<a name="l00342"></a>00342                 <a class="code" href="../../d9/d94/bmesh__marking_8h.html#a3c5cdc2f0507fa78242993fc4880d87f">BM_select_history_store</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>);
<a name="l00343"></a>00343             
<a name="l00344"></a>00344             <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aecba9500f56fdf0fc1c5483abe4c11c7">em</a>);
<a name="l00345"></a>00345             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l00346"></a>00346         }
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 <span class="comment">/* called when modal loop selection is done... */</span>
<a name="l00351"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a80660d03ec0789c9d78fd657e9b75949">00351</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a80660d03ec0789c9d78fd657e9b75949">ringsel_exit</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353     <a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd = op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00354"></a>00354 
<a name="l00355"></a>00355     <span class="comment">/* deactivate the extra drawing stuff in 3D-View */</span>
<a name="l00356"></a>00356     <a class="code" href="../../d0/d5f/ED__space__api_8h.html#af2341642ec2a46070cd7b0be6a6e716a">ED_region_draw_cb_exit</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#ae957cd551d82034b24008cfb99bbc4c7">type</a>, lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#acb0d747852428a863d4f6cab12f4fbfe">draw_handle</a>);
<a name="l00357"></a>00357     
<a name="l00358"></a>00358     <span class="keywordflow">if</span> (lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>)
<a name="l00359"></a>00359         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aea0b437f97fe0b7c650494c083cdeabe">edges</a>);
<a name="l00360"></a>00360 
<a name="l00361"></a>00361     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00362"></a>00362 
<a name="l00363"></a>00363     <span class="comment">/* free the custom data */</span>
<a name="l00364"></a>00364     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(lcd);
<a name="l00365"></a>00365     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 <span class="comment">/* called when modal loop selection gets set up... */</span>
<a name="l00369"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a828fd0c613d82b3b372172a9516b4fa6">00369</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a828fd0c613d82b3b372172a9516b4fa6">ringsel_init</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <span class="keywordtype">int</span> do_cut)
<a name="l00370"></a>00370 {
<a name="l00371"></a>00371     <a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd;
<a name="l00372"></a>00372     
<a name="l00373"></a>00373     <span class="comment">/* alloc new customdata */</span>
<a name="l00374"></a>00374     lcd = op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a>), <span class="stringliteral">&quot;ringsel Modal Op Data&quot;</span>);
<a name="l00375"></a>00375     
<a name="l00376"></a>00376     <span class="comment">/* assign the drawing handle for drawing preview line... */</span>
<a name="l00377"></a>00377     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a> = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l00378"></a>00378     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#acb0d747852428a863d4f6cab12f4fbfe">draw_handle</a> = <a class="code" href="../../d0/d5f/ED__space__api_8h.html#a48864a13f19218cbd1ff98b7fe9eb958">ED_region_draw_cb_activate</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#ae957cd551d82034b24008cfb99bbc4c7">type</a>, <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a4415a06c29ff54b427b40941aaa009d4">ringsel_draw</a>, lcd, <a class="code" href="../../d0/d5f/ED__space__api_8h.html#a3e6b57328ed92de959be772232b63718">REGION_DRAW_POST_VIEW</a>);
<a name="l00379"></a>00379     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">ob</a> = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00380"></a>00380     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#aecba9500f56fdf0fc1c5483abe4c11c7">em</a> = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#ac88769fd3513fb10adc8c65df2cdc981">ob</a>);
<a name="l00381"></a>00381     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a817d865c01428ee82f25d075bbfcc5ff">extend</a> = do_cut ? 0 : <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;extend&quot;</span>);
<a name="l00382"></a>00382     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a8baa0dbd2dc126f1a2f1efc2167b885d">do_cut</a> = do_cut;
<a name="l00383"></a>00383     
<a name="l00384"></a>00384     <a class="code" href="../../db/d36/ED__numinput_8h.html#a1f4908d6036502528e582e6190d97ecd">initNumInput</a>(&amp;lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a456587818319a40e42373253522571e0">num</a>);
<a name="l00385"></a>00385     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a456587818319a40e42373253522571e0">num</a>.<a class="code" href="../../d9/d39/structNumInput.html#a27618f1e3c3462027bf070b0c1a42ef2">idx_max</a> = 0;
<a name="l00386"></a>00386     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a456587818319a40e42373253522571e0">num</a>.<a class="code" href="../../d9/d39/structNumInput.html#ae419dcf116a65cf38ef80b525d40d101">flag</a> |= <a class="code" href="../../db/d36/ED__numinput_8h.html#ae2bd11d04444099d90f9ed424e6ef1d4">NUM_NO_NEGATIVE</a> | <a class="code" href="../../db/d36/ED__numinput_8h.html#a9dca2a0499c5460e466eae741e4655b7">NUM_NO_FRACTION</a>;
<a name="l00387"></a>00387     
<a name="l00388"></a>00388     <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a23a15b03b570d870fde800400a009714">em_setup_viewcontext</a>(C, &amp;lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00391"></a>00391 
<a name="l00392"></a>00392     <span class="keywordflow">return</span> 1;
<a name="l00393"></a>00393 }
<a name="l00394"></a>00394 
<a name="l00395"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#adc42f13837929201b580929fe1470346">00395</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#adc42f13837929201b580929fe1470346">ringcut_cancel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00396"></a>00396 {
<a name="l00397"></a>00397     <span class="comment">/* this is just a wrapper around exit() */</span>
<a name="l00398"></a>00398     <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a80660d03ec0789c9d78fd657e9b75949">ringsel_exit</a>(C, op);
<a name="l00399"></a>00399     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a6b621efa4022f51d945cb83fed66ff48">00402</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a6b621efa4022f51d945cb83fed66ff48">ringcut_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *evt)
<a name="l00403"></a>00403 {
<a name="l00404"></a>00404     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00405"></a>00405     <a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd;
<a name="l00406"></a>00406     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *edge;
<a name="l00407"></a>00407     <span class="keywordtype">int</span> dist = 75;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a416bce89c4ed91b52e1ca300cb55ea00">modifiers_isDeformedByLattice</a>(obedit) || <a class="code" href="../../d3/d0f/BKE__modifier_8h.html#a3da508ee2e78275014fa2a143c3e6045">modifiers_isDeformedByArmature</a>(obedit))
<a name="l00410"></a>00410         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;Loop cut doesn&#39;t work well on deformed edit mesh display&quot;</span>);
<a name="l00411"></a>00411     
<a name="l00412"></a>00412     <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad4e74149dc97fd5cdb1c124ecafd8eec">view3d_operator_needs_opengl</a>(C);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a828fd0c613d82b3b372172a9516b4fa6">ringsel_init</a>(C, op, 1))
<a name="l00415"></a>00415         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00416"></a>00416     
<a name="l00417"></a>00417     <span class="comment">/* add a modal handler for this operator - handles loop selection */</span>
<a name="l00418"></a>00418     <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420     lcd = op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00421"></a>00421     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>.<a class="code" href="../../d8/d30/structViewContext.html#a23107ec174c1a4f792bd8127477a18ec">mval</a>[0] = evt-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[0];
<a name="l00422"></a>00422     lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>.<a class="code" href="../../d8/d30/structViewContext.html#a23107ec174c1a4f792bd8127477a18ec">mval</a>[1] = evt-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[1];
<a name="l00423"></a>00423     
<a name="l00424"></a>00424     edge = <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a9691bcb4d4c67789ded3aaa9314e9eb3">EDBM_edge_find_nearest</a>(&amp;lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>, &amp;dist);
<a name="l00425"></a>00425     <span class="keywordflow">if</span> (edge != lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>) {
<a name="l00426"></a>00426         lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a> = edge;
<a name="l00427"></a>00427         <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a456a9f01c95d0bb05e9fa65c161426d1">ringsel_find_edge</a>(lcd, 1);
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429     <a class="code" href="../../d1/d12/ED__screen_8h.html#a3899c7d0aebef9cc11992a7de3e5f397">ED_area_headerprint</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), <span class="stringliteral">&quot;Select a ring to be cut, use mouse-wheel or page-up/down for number of cuts&quot;</span>);
<a name="l00430"></a>00430     
<a name="l00431"></a>00431     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l00432"></a>00432 }
<a name="l00433"></a>00433 
<a name="l00434"></a><a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a899b48703bb62f987d6b3f2b0a87b1a9">00434</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a899b48703bb62f987d6b3f2b0a87b1a9">loopcut_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00435"></a>00435 {
<a name="l00436"></a>00436     <span class="keywordtype">int</span> cuts = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>);
<a name="l00437"></a>00437     <a class="code" href="../../db/d13/structtringselOpData.html">tringselOpData</a> *lcd = op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00438"></a>00438     <span class="keywordtype">int</span> show_cuts = 0;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440     <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad4e74149dc97fd5cdb1c124ecafd8eec">view3d_operator_needs_opengl</a>(C);
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     <span class="keywordflow">switch</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>) {
<a name="l00443"></a>00443         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a6c861c5ebabe8fe076ed84a2aaa7a1a0">RETKEY</a>:
<a name="l00444"></a>00444         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>: <span class="comment">/* confirm */</span> <span class="comment">// XXX hardcoded</span>
<a name="l00445"></a>00445             <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>) {
<a name="l00446"></a>00446                 <span class="comment">/* finish */</span>
<a name="l00447"></a>00447                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00448"></a>00448                 
<a name="l00449"></a>00449                 <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#acc6844e77fc7e7529a66fc962918cd41">ringsel_finish</a>(C, op);
<a name="l00450"></a>00450                 <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a80660d03ec0789c9d78fd657e9b75949">ringsel_exit</a>(C, op);
<a name="l00451"></a>00451                 
<a name="l00452"></a>00452                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a3899c7d0aebef9cc11992a7de3e5f397">ED_area_headerprint</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00453"></a>00453                 
<a name="l00454"></a>00454                 <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00455"></a>00455             }
<a name="l00456"></a>00456             
<a name="l00457"></a>00457             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00458"></a>00458             <span class="keywordflow">break</span>;
<a name="l00459"></a>00459         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#adc87b609a6285a24e23172a90734044c">RIGHTMOUSE</a>: <span class="comment">/* abort */</span> <span class="comment">// XXX hardcoded</span>
<a name="l00460"></a>00460             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00461"></a>00461             <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a80660d03ec0789c9d78fd657e9b75949">ringsel_exit</a>(C, op);
<a name="l00462"></a>00462             <a class="code" href="../../d1/d12/ED__screen_8h.html#a3899c7d0aebef9cc11992a7de3e5f397">ED_area_headerprint</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00463"></a>00463 
<a name="l00464"></a>00464             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00465"></a>00465         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>:
<a name="l00466"></a>00466             <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>) {
<a name="l00467"></a>00467                 <span class="comment">/* cancel */</span>
<a name="l00468"></a>00468                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00469"></a>00469                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a3899c7d0aebef9cc11992a7de3e5f397">ED_area_headerprint</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00470"></a>00470                 
<a name="l00471"></a>00471                 <span class="keywordflow">return</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#adc42f13837929201b580929fe1470346">ringcut_cancel</a>(C, op);
<a name="l00472"></a>00472             }
<a name="l00473"></a>00473             
<a name="l00474"></a>00474             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00475"></a>00475             <span class="keywordflow">break</span>;
<a name="l00476"></a>00476         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a58d161b0d7f338f7c6083654a83100d0">PADPLUSKEY</a>:
<a name="l00477"></a>00477         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a2da9bb01ecf11a9818c9f8eb06743237">PAGEUPKEY</a>:
<a name="l00478"></a>00478         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae58fa49252a1cf05799ab21592491a30">WHEELUPMOUSE</a>:  <span class="comment">/* change number of cuts */</span>
<a name="l00479"></a>00479             <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>)
<a name="l00480"></a>00480                 <span class="keywordflow">break</span>;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482             cuts++;
<a name="l00483"></a>00483             <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>, cuts);
<a name="l00484"></a>00484             <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a456a9f01c95d0bb05e9fa65c161426d1">ringsel_find_edge</a>(lcd, cuts);
<a name="l00485"></a>00485             show_cuts = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00486"></a>00486             
<a name="l00487"></a>00487             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00488"></a>00488             <span class="keywordflow">break</span>;
<a name="l00489"></a>00489         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#af3feb147cfa2676ff6c909a61af4405b">PADMINUS</a>:
<a name="l00490"></a>00490         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a3864b9574c939049ca9a2cb6523035e8">PAGEDOWNKEY</a>:
<a name="l00491"></a>00491         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a2ffb32901b9678d9b738e618330f60c0">WHEELDOWNMOUSE</a>:  <span class="comment">/* change number of cuts */</span>
<a name="l00492"></a>00492             <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>)
<a name="l00493"></a>00493                 <span class="keywordflow">break</span>;
<a name="l00494"></a>00494 
<a name="l00495"></a>00495             cuts = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(cuts - 1, 1);
<a name="l00496"></a>00496             <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>, cuts);
<a name="l00497"></a>00497             <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a456a9f01c95d0bb05e9fa65c161426d1">ringsel_find_edge</a>(lcd, cuts);
<a name="l00498"></a>00498             show_cuts = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00499"></a>00499             
<a name="l00500"></a>00500             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00501"></a>00501             <span class="keywordflow">break</span>;
<a name="l00502"></a>00502         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#aa58b8b831d49bfef312f9ae99d742aae">MOUSEMOVE</a>: { <span class="comment">/* mouse moved somewhere to select another loop */</span>
<a name="l00503"></a>00503             <span class="keywordtype">int</span> dist = 75;
<a name="l00504"></a>00504             <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *edge;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506             lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>.<a class="code" href="../../d8/d30/structViewContext.html#a23107ec174c1a4f792bd8127477a18ec">mval</a>[0] = <span class="keyword">event</span>-&gt;mval[0];
<a name="l00507"></a>00507             lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>.<a class="code" href="../../d8/d30/structViewContext.html#a23107ec174c1a4f792bd8127477a18ec">mval</a>[1] = <span class="keyword">event</span>-&gt;mval[1];
<a name="l00508"></a>00508             edge = <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a9691bcb4d4c67789ded3aaa9314e9eb3">EDBM_edge_find_nearest</a>(&amp;lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a5541dc1c89c8168a5a73580a75a8c722">vc</a>, &amp;dist);
<a name="l00509"></a>00509 
<a name="l00510"></a>00510             <span class="keywordflow">if</span> (edge != lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a>) {
<a name="l00511"></a>00511                 lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a01f46f46d79f45ef3fab3c13e6400aa1">eed</a> = edge;
<a name="l00512"></a>00512                 <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a456a9f01c95d0bb05e9fa65c161426d1">ringsel_find_edge</a>(lcd, cuts);
<a name="l00513"></a>00513             }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00516"></a>00516             <span class="keywordflow">break</span>;
<a name="l00517"></a>00517         }           
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519     
<a name="l00520"></a>00520     <span class="comment">/* using the keyboard to input the number of cuts */</span>
<a name="l00521"></a>00521     <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a> == <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>) {
<a name="l00522"></a>00522         <span class="keywordtype">float</span> value;
<a name="l00523"></a>00523         
<a name="l00524"></a>00524         <span class="keywordflow">if</span> (<a class="code" href="../../db/d36/ED__numinput_8h.html#ac0c74aa4cdf6c6f0650a165f030c09b8">handleNumInput</a>(&amp;lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a456587818319a40e42373253522571e0">num</a>, event)) {
<a name="l00525"></a>00525             <a class="code" href="../../db/d36/ED__numinput_8h.html#a9be96dcce39f29ef904abec135996cb5">applyNumInput</a>(&amp;lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a456587818319a40e42373253522571e0">num</a>, &amp;value);
<a name="l00526"></a>00526             
<a name="l00527"></a>00527             cuts = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a49a86f7d81f477961529de3add6d68ab">CLAMPIS</a>(value, 1, 130);
<a name="l00528"></a>00528             
<a name="l00529"></a>00529             <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>, cuts);
<a name="l00530"></a>00530             <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a456a9f01c95d0bb05e9fa65c161426d1">ringsel_find_edge</a>(lcd, cuts);
<a name="l00531"></a>00531             show_cuts = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00532"></a>00532             
<a name="l00533"></a>00533             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(lcd-&gt;<a class="code" href="../../db/d13/structtringselOpData.html#a6a154a34a66cd1faac1610b4d0b073b5">ar</a>);
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536     
<a name="l00537"></a>00537     <span class="keywordflow">if</span> (show_cuts) {
<a name="l00538"></a>00538         <span class="keywordtype">char</span> buf[64];
<a name="l00539"></a>00539         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;Number of Cuts: %d&quot;</span>, cuts);
<a name="l00540"></a>00540         <a class="code" href="../../d1/d12/ED__screen_8h.html#a3899c7d0aebef9cc11992a7de3e5f397">ED_area_headerprint</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), buf);
<a name="l00541"></a>00541     }
<a name="l00542"></a>00542     
<a name="l00543"></a>00543     <span class="comment">/* keep going until the user confirms */</span>
<a name="l00544"></a>00544     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l00545"></a>00545 }
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 <span class="comment">/* for bmesh this tool is in bmesh_select.c */</span>
<a name="l00548"></a>00548 <span class="preprocessor">#if 0</span>
<a name="l00549"></a>00549 <span class="preprocessor"></span>
<a name="l00550"></a>00550 <span class="keywordtype">void</span> <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a9cd077615d74076adeb806059a435f1d">MESH_OT_edgering_select</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00551"></a>00551 {
<a name="l00552"></a>00552     <span class="comment">/* description */</span>
<a name="l00553"></a>00553     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Edge Ring Select&quot;</span>;
<a name="l00554"></a>00554     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_edgering_select&quot;</span>;
<a name="l00555"></a>00555     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select an edge ring&quot;</span>;
<a name="l00556"></a>00556     
<a name="l00557"></a>00557     <span class="comment">/* callbacks */</span>
<a name="l00558"></a>00558     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = ringsel_invoke;
<a name="l00559"></a>00559     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a9945ce52504bab38fbc27ecfc4a44cbd">ED_operator_editmesh_region_view3d</a>; 
<a name="l00560"></a>00560     
<a name="l00561"></a>00561     <span class="comment">/* flags */</span>
<a name="l00562"></a>00562     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00563"></a>00563 
<a name="l00564"></a>00564     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;extend&quot;</span>, 0, <span class="stringliteral">&quot;Extend&quot;</span>, <span class="stringliteral">&quot;Extend the selection&quot;</span>);
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 <span class="preprocessor">#endif</span>
<a name="l00568"></a>00568 <span class="preprocessor"></span>
<a name="l00569"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a90fc95fc8c3e2ab223f78a0cbeac5129">00569</a> <span class="keywordtype">void</span> <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#aca94a84fbae6173fb6287ec1a5e2b922">MESH_OT_loopcut</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00570"></a>00570 {
<a name="l00571"></a>00571     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00572"></a>00572 
<a name="l00573"></a>00573     <span class="comment">/* description */</span>
<a name="l00574"></a>00574     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Loop Cut&quot;</span>;
<a name="l00575"></a>00575     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_loopcut&quot;</span>;
<a name="l00576"></a>00576     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Add a new loop between existing loops&quot;</span>;
<a name="l00577"></a>00577     
<a name="l00578"></a>00578     <span class="comment">/* callbacks */</span>
<a name="l00579"></a>00579     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a6b621efa4022f51d945cb83fed66ff48">ringcut_invoke</a>;
<a name="l00580"></a>00580     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#a899b48703bb62f987d6b3f2b0a87b1a9">loopcut_modal</a>;
<a name="l00581"></a>00581     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d5/d0d/editmesh__loopcut_8c.html#adc42f13837929201b580929fe1470346">ringcut_cancel</a>;
<a name="l00582"></a>00582     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a9945ce52504bab38fbc27ecfc4a44cbd">ED_operator_editmesh_region_view3d</a>;
<a name="l00583"></a>00583     
<a name="l00584"></a>00584     <span class="comment">/* flags */</span>
<a name="l00585"></a>00585     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a2458c730dbcabf67cc8917d8de127bab">OPTYPE_BLOCKING</a>;
<a name="l00586"></a>00586 
<a name="l00587"></a>00587     <span class="comment">/* properties */</span>
<a name="l00588"></a>00588     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>, 1, 1, INT_MAX, <span class="stringliteral">&quot;Number of Cuts&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 1, 10);
<a name="l00589"></a>00589     <span class="comment">/* avoid re-using last var because it can cause _very_ high poly meshes and annoy users (or worse crash) */</span>
<a name="l00590"></a>00590     <a class="code" href="../../dc/d7e/rna__define_8c.html#a97e75cad8daa0d94523c8df118947191">RNA_def_property_flag</a>(prop, <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ac49bd36c069e337f7ee269c672ef1332">PROP_SKIP_SAVE</a>);
<a name="l00591"></a>00591 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:16 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
