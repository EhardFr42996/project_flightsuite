<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: opennl.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">opennl.c</div>  </div>
</div>
<div class="contents">
<a href="../../d5/d6b/opennl_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00004"></a>00004 <span class="comment">/*</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> *  OpenNL: Numerical Library</span>
<a name="l00007"></a>00007 <span class="comment"> *  Copyright (C) 2004 Bruno Levy</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *  This program is free software; you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment"> *  it under the terms of the GNU General Public License as published by</span>
<a name="l00011"></a>00011 <span class="comment"> *  the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00012"></a>00012 <span class="comment"> *  (at your option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> *  This program is distributed in the hope that it will be useful,</span>
<a name="l00015"></a>00015 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00017"></a>00017 <span class="comment"> *  GNU General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> *  You should have received a copy of the GNU General Public License</span>
<a name="l00020"></a>00020 <span class="comment"> *  along with this program; if not, write to the Free Software</span>
<a name="l00021"></a>00021 <span class="comment"> *  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> *  If you modify this software, you should include a notice giving the</span>
<a name="l00024"></a>00024 <span class="comment"> *  name of the person performing the modification, the date of modification,</span>
<a name="l00025"></a>00025 <span class="comment"> *  and the reason for such modification.</span>
<a name="l00026"></a>00026 <span class="comment"> *</span>
<a name="l00027"></a>00027 <span class="comment"> *  Contact: Bruno Levy</span>
<a name="l00028"></a>00028 <span class="comment"> *</span>
<a name="l00029"></a>00029 <span class="comment"> *   levy@loria.fr</span>
<a name="l00030"></a>00030 <span class="comment"> *</span>
<a name="l00031"></a>00031 <span class="comment"> *   ISA Project</span>
<a name="l00032"></a>00032 <span class="comment"> *   LORIA, INRIA Lorraine, </span>
<a name="l00033"></a>00033 <span class="comment"> *   Campus Scientifique, BP 239</span>
<a name="l00034"></a>00034 <span class="comment"> *   54506 VANDOEUVRE LES NANCY CEDEX </span>
<a name="l00035"></a>00035 <span class="comment"> *   FRANCE</span>
<a name="l00036"></a>00036 <span class="comment"> *</span>
<a name="l00037"></a>00037 <span class="comment"> *  Note that the GNU General Public License does not permit incorporating</span>
<a name="l00038"></a>00038 <span class="comment"> *  the Software into proprietary programs. </span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../db/dde/ONL__opennl_8h.html">ONL_opennl.h</a>&quot;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#ifdef NL_PARANOID</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="preprocessor">#ifndef NL_DEBUG</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#define NL_DEBUG</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a>00054 <span class="comment">/* SuperLU includes */</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/d07/ssp__defs_8h.html">ssp_defs.h</a>&gt;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;util.h&gt;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="comment">/************************************************************************************/</span>
<a name="l00059"></a>00059 <span class="comment">/* Assertions */</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a74ae70ad9cd2e344728d716ea14dd9e2">00062</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a74ae70ad9cd2e344728d716ea14dd9e2">__nl_assertion_failed</a>(<span class="keywordtype">char</span>* cond, <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line) {
<a name="l00063"></a>00063     fprintf(
<a name="l00064"></a>00064         stderr, 
<a name="l00065"></a>00065         <span class="stringliteral">&quot;OpenNL assertion failed: %s, file:%s, line:%d\n&quot;</span>,
<a name="l00066"></a>00066         cond,file,line
<a name="l00067"></a>00067     );
<a name="l00068"></a>00068     abort();
<a name="l00069"></a>00069 }
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a33798c0d30b0e787086af811d1497c25">00071</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a33798c0d30b0e787086af811d1497c25">__nl_range_assertion_failed</a>(
<a name="l00072"></a>00072     <span class="keywordtype">float</span> <a class="code" href="../../d3/dd9/structImBuf.html#ae7734bc51f5e3e75be66e6f6a26f4f4e">x</a>, <span class="keywordtype">float</span> min_val, <span class="keywordtype">float</span> max_val, <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line
<a name="l00073"></a>00073 ) {
<a name="l00074"></a>00074     fprintf(
<a name="l00075"></a>00075         stderr, 
<a name="l00076"></a>00076         <span class="stringliteral">&quot;OpenNL range assertion failed: %f in [ %f ... %f ], file:%s, line:%d\n&quot;</span>,
<a name="l00077"></a>00077         x, min_val, max_val, file,line
<a name="l00078"></a>00078     );
<a name="l00079"></a>00079     abort();
<a name="l00080"></a>00080 }
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a37ee682fa4524579064bced3256491be">00082</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a37ee682fa4524579064bced3256491be">__nl_should_not_have_reached</a>(<span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line) {
<a name="l00083"></a>00083     fprintf(
<a name="l00084"></a>00084         stderr, 
<a name="l00085"></a>00085         <span class="stringliteral">&quot;OpenNL should not have reached this point: file:%s, line:%d\n&quot;</span>,
<a name="l00086"></a>00086         file,line
<a name="l00087"></a>00087     );
<a name="l00088"></a>00088     abort();
<a name="l00089"></a>00089 }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">00092</a> <span class="preprocessor">#define __nl_assert(x) {                                        \</span>
<a name="l00093"></a>00093 <span class="preprocessor">    if(!(x)) {                                                \</span>
<a name="l00094"></a>00094 <span class="preprocessor">        __nl_assertion_failed(#x,__FILE__, __LINE__);         \</span>
<a name="l00095"></a>00095 <span class="preprocessor">    }                                                          \</span>
<a name="l00096"></a>00096 <span class="preprocessor">} </span>
<a name="l00097"></a>00097 <span class="preprocessor"></span>
<a name="l00098"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a042efb2fd9182de555620136894e8145">00098</a> <span class="preprocessor">#define __nl_range_assert(x,min_val,max_val) {                \</span>
<a name="l00099"></a>00099 <span class="preprocessor">    if(((x) &lt; (min_val)) || ((x) &gt; (max_val))) {                \</span>
<a name="l00100"></a>00100 <span class="preprocessor">        __nl_range_assertion_failed(x, min_val, max_val,        \</span>
<a name="l00101"></a>00101 <span class="preprocessor">            __FILE__, __LINE__                                \</span>
<a name="l00102"></a>00102 <span class="preprocessor">        );                                                   \</span>
<a name="l00103"></a>00103 <span class="preprocessor">    }                                                          \</span>
<a name="l00104"></a>00104 <span class="preprocessor">}</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">00106</a> <span class="preprocessor">#define __nl_assert_not_reached {                              \</span>
<a name="l00107"></a>00107 <span class="preprocessor">    __nl_should_not_have_reached(__FILE__, __LINE__);         \</span>
<a name="l00108"></a>00108 <span class="preprocessor">}</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>
<a name="l00110"></a>00110 <span class="preprocessor">#ifdef NL_DEBUG</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span><span class="preprocessor">#define __nl_debug_assert(x) __nl_assert(x)</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span><span class="preprocessor">#define __nl_debug_range_assert(x,min_val,max_val) __nl_range_assert(x,min_val,max_val)</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00114"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a57517f580feff6be2c2f866d9c58dd6f">00114</a> <span class="preprocessor"></span><span class="preprocessor">#define __nl_debug_assert(x) </span>
<a name="l00115"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ad0265764984195c90cc323fb767b19b6">00115</a> <span class="preprocessor"></span><span class="preprocessor">#define __nl_debug_range_assert(x,min_val,max_val) </span>
<a name="l00116"></a>00116 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00118"></a>00118 <span class="preprocessor">#ifdef NL_PARANOID</span>
<a name="l00119"></a>00119 <span class="preprocessor"></span><span class="preprocessor">#define __nl_parano_assert(x) __nl_assert(x)</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span><span class="preprocessor">#define __nl_parano_range_assert(x,min_val,max_val) __nl_range_assert(x,min_val,max_val)</span>
<a name="l00121"></a>00121 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00122"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a792aad9d4aae348f2eca4fcee433dfa8">00122</a> <span class="preprocessor"></span><span class="preprocessor">#define __nl_parano_assert(x) </span>
<a name="l00123"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">00123</a> <span class="preprocessor"></span><span class="preprocessor">#define __nl_parano_range_assert(x,min_val,max_val) </span>
<a name="l00124"></a>00124 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>
<a name="l00126"></a>00126 <span class="comment">/************************************************************************************/</span>
<a name="l00127"></a>00127 <span class="comment">/* classic macros */</span>
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="preprocessor">#ifndef MIN</span>
<a name="l00130"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a74e75242132eaabbc1c512488a135926">00130</a> <span class="preprocessor"></span><span class="preprocessor">#define MIN(x,y) (((x) &lt; (y)) ? (x) : (y)) </span>
<a name="l00131"></a>00131 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00132"></a>00132 <span class="preprocessor"></span>
<a name="l00133"></a>00133 <span class="preprocessor">#ifndef MAX</span>
<a name="l00134"></a><a class="code" href="../../d5/d6b/opennl_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">00134</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX(x,y) (((x) &gt; (y)) ? (x) : (y)) </span>
<a name="l00135"></a>00135 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span>
<a name="l00137"></a>00137 <span class="comment">/************************************************************************************/</span>
<a name="l00138"></a>00138 <span class="comment">/* memory management */</span>
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a49ddca582c22f314bf2d9da5d6434601">00140</a> <span class="preprocessor">#define __NL_NEW(T)             (T*)(calloc(1, sizeof(T))) </span>
<a name="l00141"></a><a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">00141</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_NEW_ARRAY(T,NB)       (T*)(calloc((NB),sizeof(T))) </span>
<a name="l00142"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a3df7761325adbd6c07f621cb6597cb77">00142</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_RENEW_ARRAY(T,x,NB)   (T*)(realloc(x,(NB)*sizeof(T))) </span>
<a name="l00143"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a9bacfb58b95fd2d49284a827cf6cbfb1">00143</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_DELETE(x)           free(x); x = NULL </span>
<a name="l00144"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">00144</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_DELETE_ARRAY(x)       free(x); x = NULL</span>
<a name="l00145"></a>00145 <span class="preprocessor"></span>
<a name="l00146"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a264cea5b6161caa59ef32342c61f262c">00146</a> <span class="preprocessor">#define __NL_CLEAR(T, x)           memset(x, 0, sizeof(T)) </span>
<a name="l00147"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a598435bfad713744704dd95fda607942">00147</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_CLEAR_ARRAY(T,x,NB)   memset(x, 0, (NB)*sizeof(T)) </span>
<a name="l00148"></a>00148 <span class="preprocessor"></span>
<a name="l00149"></a>00149 <span class="comment">/************************************************************************************/</span>
<a name="l00150"></a>00150 <span class="comment">/* Dynamic arrays for sparse row/columns */</span>
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="../../d0/d42/struct____NLCoeff.html">00152</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00153"></a><a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">00153</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>   <a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>;
<a name="l00154"></a><a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">00154</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> <a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a>;
<a name="l00155"></a>00155 } <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>;
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="../../d8/d84/struct____NLRowColumn.html">00157</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00158"></a><a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">00158</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>;
<a name="l00159"></a><a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">00159</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a>;
<a name="l00160"></a><a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">00160</a>     <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>* <a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>;
<a name="l00161"></a>00161 } <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>;
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a11a44e5b5c112631033a76968d2d5ed1">00163</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a11a44e5b5c112631033a76968d2d5ed1">__nlRowColumnConstruct</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* c) {
<a name="l00164"></a>00164     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>  = 0;
<a name="l00165"></a>00165     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a> = 0;
<a name="l00166"></a>00166     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>    = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00167"></a>00167 }
<a name="l00168"></a>00168 
<a name="l00169"></a><a class="code" href="../../d5/d6b/opennl_8c.html#af37b151bec2cc64c7b9709ef050e7e16">00169</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#af37b151bec2cc64c7b9709ef050e7e16">__nlRowColumnDestroy</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* c) {
<a name="l00170"></a>00170     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>);
<a name="l00171"></a>00171 <span class="preprocessor">#ifdef NL_PARANOID</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>    <a class="code" href="../../d5/d6b/opennl_8c.html#a264cea5b6161caa59ef32342c61f262c">__NL_CLEAR</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>, c); 
<a name="l00173"></a>00173 <span class="preprocessor">#endif</span>
<a name="l00174"></a>00174 <span class="preprocessor"></span>}
<a name="l00175"></a>00175 
<a name="l00176"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ad3605795fa72d0503d4369d335109ec8">00176</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#ad3605795fa72d0503d4369d335109ec8">__nlRowColumnGrow</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* c) {
<a name="l00177"></a>00177     <span class="keywordflow">if</span>(c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a> != 0) {
<a name="l00178"></a>00178         c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a> = 2 * c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a>;
<a name="l00179"></a>00179         c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#a3df7761325adbd6c07f621cb6597cb77">__NL_RENEW_ARRAY</a>(<a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>, c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>, c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a>);
<a name="l00180"></a>00180     } <span class="keywordflow">else</span> {
<a name="l00181"></a>00181         c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a> = 4;
<a name="l00182"></a>00182         c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>, c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a>);
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184 }
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ad725c0efc98915bf2d8a337a0949d3a8">00186</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#ad725c0efc98915bf2d8a337a0949d3a8">__nlRowColumnAdd</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* c, <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> index, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> value) {
<a name="l00187"></a>00187     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00188"></a>00188     <span class="keywordflow">for</span>(i=0; i&lt;c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; i++) {
<a name="l00189"></a>00189         <span class="keywordflow">if</span>(c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[i].<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a> == (<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>)index) {
<a name="l00190"></a>00190             c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> += value;
<a name="l00191"></a>00191             <span class="keywordflow">return</span>;
<a name="l00192"></a>00192         }
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194     <span class="keywordflow">if</span>(c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a> == c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a>) {
<a name="l00195"></a>00195         <a class="code" href="../../d5/d6b/opennl_8c.html#ad3605795fa72d0503d4369d335109ec8">__nlRowColumnGrow</a>(c);
<a name="l00196"></a>00196     }
<a name="l00197"></a>00197     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>].<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a> = index;
<a name="l00198"></a>00198     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>].<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> = value;
<a name="l00199"></a>00199     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>++;
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 <span class="comment">/* Does not check whether the index already exists */</span>
<a name="l00203"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a2a2d754c203fc79e70a03846b9ee24e1">00203</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a2a2d754c203fc79e70a03846b9ee24e1">__nlRowColumnAppend</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* c, <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> index, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> value) {
<a name="l00204"></a>00204     <span class="keywordflow">if</span>(c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a> == c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a>) {
<a name="l00205"></a>00205         <a class="code" href="../../d5/d6b/opennl_8c.html#ad3605795fa72d0503d4369d335109ec8">__nlRowColumnGrow</a>(c);
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>].<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a> = index;
<a name="l00208"></a>00208     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>].<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> = value;
<a name="l00209"></a>00209     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>++;
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ad8ac724a22f7688614ad4fc393f3c36d">00212</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#ad8ac724a22f7688614ad4fc393f3c36d">__nlRowColumnClear</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* c) {
<a name="l00213"></a>00213     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>  = 0;
<a name="l00214"></a>00214     c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#ae03ed4f31081e08283b5436005f0b0a1">capacity</a> = 0;
<a name="l00215"></a>00215     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(c-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>);
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">/************************************************************************************/</span>
<a name="l00219"></a>00219 <span class="comment">/* SparseMatrix data structure */</span>
<a name="l00220"></a>00220 
<a name="l00221"></a><a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">00221</a> <span class="preprocessor">#define __NL_ROWS     1</span>
<a name="l00222"></a><a class="code" href="../../d5/d6b/opennl_8c.html#acc999a99b0cd756e729858eb3bbc0af6">00222</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_COLUMNS   2</span>
<a name="l00223"></a><a class="code" href="../../d5/d6b/opennl_8c.html#afd84cb6981d0905d96ae9c1880bd88fc">00223</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_SYMMETRIC 4</span>
<a name="l00224"></a>00224 <span class="preprocessor"></span>
<a name="l00225"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html">00225</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00226"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">00226</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>;
<a name="l00227"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">00227</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>;
<a name="l00228"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a6faded6d6e0d448330f892d6c91c1052">00228</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a6faded6d6e0d448330f892d6c91c1052">diag_size</a>;
<a name="l00229"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">00229</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> <a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a>;
<a name="l00230"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">00230</a>     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* <a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>;
<a name="l00231"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">00231</a>     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* <a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>;
<a name="l00232"></a><a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0614ecf58eca7581bd173eaeb23b0ba8">00232</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>*      <a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0614ecf58eca7581bd173eaeb23b0ba8">diag</a>;
<a name="l00233"></a>00233 } <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 
<a name="l00236"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a11f79d2d9b9a98cf5a7231ec76ffa766">00236</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a11f79d2d9b9a98cf5a7231ec76ffa766">__nlSparseMatrixConstruct</a>(
<a name="l00237"></a>00237     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> m, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> storage
<a name="l00238"></a>00238 ) {
<a name="l00239"></a>00239     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00240"></a>00240     M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a> = m;
<a name="l00241"></a>00241     M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a> = n;
<a name="l00242"></a>00242     M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> = storage;
<a name="l00243"></a>00243     <span class="keywordflow">if</span>(storage &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>) {
<a name="l00244"></a>00244         M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>, m);
<a name="l00245"></a>00245         <span class="keywordflow">for</span>(i=0; i&lt;m; i++) {
<a name="l00246"></a>00246             <a class="code" href="../../d5/d6b/opennl_8c.html#a11a44e5b5c112631033a76968d2d5ed1">__nlRowColumnConstruct</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[i]));
<a name="l00247"></a>00247         }
<a name="l00248"></a>00248     } <span class="keywordflow">else</span> {
<a name="l00249"></a>00249         M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <span class="keywordflow">if</span>(storage &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#acc999a99b0cd756e729858eb3bbc0af6">__NL_COLUMNS</a>) {
<a name="l00253"></a>00253         M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>, n);
<a name="l00254"></a>00254         <span class="keywordflow">for</span>(i=0; i&lt;n; i++) {
<a name="l00255"></a>00255             <a class="code" href="../../d5/d6b/opennl_8c.html#a11a44e5b5c112631033a76968d2d5ed1">__nlRowColumnConstruct</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>[i]));
<a name="l00256"></a>00256         }
<a name="l00257"></a>00257     } <span class="keywordflow">else</span> {
<a name="l00258"></a>00258         M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a6faded6d6e0d448330f892d6c91c1052">diag_size</a> = <a class="code" href="../../d4/d22/BOP__CarveInterface_8cpp.html#a74e75242132eaabbc1c512488a135926">MIN</a>(m,n);
<a name="l00262"></a>00262     M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0614ecf58eca7581bd173eaeb23b0ba8">diag</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a6faded6d6e0d448330f892d6c91c1052">diag_size</a>);
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 
<a name="l00265"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a6c26d8ed88a14241d0d5ad9a3723131d">00265</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a6c26d8ed88a14241d0d5ad9a3723131d">__nlSparseMatrixDestroy</a>(<a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>) {
<a name="l00266"></a>00266     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00267"></a>00267     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0614ecf58eca7581bd173eaeb23b0ba8">diag</a>);
<a name="l00268"></a>00268     <span class="keywordflow">if</span>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>) {
<a name="l00269"></a>00269         <span class="keywordflow">for</span>(i=0; i&lt;M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>; i++) {
<a name="l00270"></a>00270             <a class="code" href="../../d5/d6b/opennl_8c.html#af37b151bec2cc64c7b9709ef050e7e16">__nlRowColumnDestroy</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[i]));
<a name="l00271"></a>00271         }
<a name="l00272"></a>00272         <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>);
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274     <span class="keywordflow">if</span>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#acc999a99b0cd756e729858eb3bbc0af6">__NL_COLUMNS</a>) {
<a name="l00275"></a>00275         <span class="keywordflow">for</span>(i=0; i&lt;M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>; i++) {
<a name="l00276"></a>00276             <a class="code" href="../../d5/d6b/opennl_8c.html#af37b151bec2cc64c7b9709ef050e7e16">__nlRowColumnDestroy</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>[i]));
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278         <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>);
<a name="l00279"></a>00279     }
<a name="l00280"></a>00280 <span class="preprocessor">#ifdef NL_PARANOID</span>
<a name="l00281"></a>00281 <span class="preprocessor"></span>    <a class="code" href="../../d5/d6b/opennl_8c.html#a264cea5b6161caa59ef32342c61f262c">__NL_CLEAR</a>(<a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>,M);
<a name="l00282"></a>00282 <span class="preprocessor">#endif</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span>}
<a name="l00284"></a>00284 
<a name="l00285"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a0b89ee6eee22cb4000e80859eb1bddd8">00285</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a0b89ee6eee22cb4000e80859eb1bddd8">__nlSparseMatrixAdd</a>(
<a name="l00286"></a>00286     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> j, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> value
<a name="l00287"></a>00287 ) {
<a name="l00288"></a>00288     <a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">__nl_parano_range_assert</a>(i, 0, M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a> - 1);
<a name="l00289"></a>00289     <a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">__nl_parano_range_assert</a>(j, 0, M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a> - 1);
<a name="l00290"></a>00290     <span class="keywordflow">if</span>((M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#afd84cb6981d0905d96ae9c1880bd88fc">__NL_SYMMETRIC</a>) &amp;&amp; (j &gt; i)) {
<a name="l00291"></a>00291         <span class="keywordflow">return</span>;
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293     <span class="keywordflow">if</span>(i == j) {
<a name="l00294"></a>00294         M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0614ecf58eca7581bd173eaeb23b0ba8">diag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] += value;
<a name="l00295"></a>00295     }
<a name="l00296"></a>00296     <span class="keywordflow">if</span>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>) {
<a name="l00297"></a>00297         <a class="code" href="../../d5/d6b/opennl_8c.html#ad725c0efc98915bf2d8a337a0949d3a8">__nlRowColumnAdd</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[i]), j, value);
<a name="l00298"></a>00298     }
<a name="l00299"></a>00299     <span class="keywordflow">if</span>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#acc999a99b0cd756e729858eb3bbc0af6">__NL_COLUMNS</a>) {
<a name="l00300"></a>00300         <a class="code" href="../../d5/d6b/opennl_8c.html#ad725c0efc98915bf2d8a337a0949d3a8">__nlRowColumnAdd</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>[j]), i, value);
<a name="l00301"></a>00301     }
<a name="l00302"></a>00302 }
<a name="l00303"></a>00303 
<a name="l00304"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a4612d5ec08be70e0fed1e9b2ea68a490">00304</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a4612d5ec08be70e0fed1e9b2ea68a490">__nlSparseMatrixClear</a>( <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>) {
<a name="l00305"></a>00305     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00306"></a>00306     <span class="keywordflow">if</span>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>) {
<a name="l00307"></a>00307         <span class="keywordflow">for</span>(i=0; i&lt;M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>; i++) {
<a name="l00308"></a>00308             <a class="code" href="../../d5/d6b/opennl_8c.html#ad8ac724a22f7688614ad4fc393f3c36d">__nlRowColumnClear</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[i]));
<a name="l00309"></a>00309         }
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311     <span class="keywordflow">if</span>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#acc999a99b0cd756e729858eb3bbc0af6">__NL_COLUMNS</a>) {
<a name="l00312"></a>00312         <span class="keywordflow">for</span>(i=0; i&lt;M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>; i++) {
<a name="l00313"></a>00313             <a class="code" href="../../d5/d6b/opennl_8c.html#ad8ac724a22f7688614ad4fc393f3c36d">__nlRowColumnClear</a>(&amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>[i]));
<a name="l00314"></a>00314         }
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316     <a class="code" href="../../d5/d6b/opennl_8c.html#a598435bfad713744704dd95fda607942">__NL_CLEAR_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0614ecf58eca7581bd173eaeb23b0ba8">diag</a>, M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a6faded6d6e0d448330f892d6c91c1052">diag_size</a>);   
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 <span class="comment">/* Returns the number of non-zero coefficients */</span>
<a name="l00320"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a9123ed4d00293a004ce409308c44cf83">00320</a> <span class="keyword">static</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../d5/d6b/opennl_8c.html#a9123ed4d00293a004ce409308c44cf83">__nlSparseMatrixNNZ</a>( <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>) {
<a name="l00321"></a>00321     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> nnz = 0;
<a name="l00322"></a>00322     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00323"></a>00323     <span class="keywordflow">if</span>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>) {
<a name="l00324"></a>00324         <span class="keywordflow">for</span>(i = 0; i&lt;M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>; i++) {
<a name="l00325"></a>00325             nnz += M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>;
<a name="l00326"></a>00326         }
<a name="l00327"></a>00327     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#acc999a99b0cd756e729858eb3bbc0af6">__NL_COLUMNS</a>) {
<a name="l00328"></a>00328         <span class="keywordflow">for</span>(i = 0; i&lt;M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>; i++) {
<a name="l00329"></a>00329             nnz += M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>;
<a name="l00330"></a>00330         }
<a name="l00331"></a>00331     } <span class="keywordflow">else</span> {
<a name="l00332"></a>00332         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00333"></a>00333     }
<a name="l00334"></a>00334     <span class="keywordflow">return</span> nnz;
<a name="l00335"></a>00335 }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 <span class="comment">/************************************************************************************/</span>
<a name="l00338"></a>00338 <span class="comment">/* SparseMatrix x Vector routines, internal helper routines */</span>
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a75c59dd054b685fc6fee313f5a69ec46">00340</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a75c59dd054b685fc6fee313f5a69ec46">__nlSparseMatrix_mult_rows_symmetric</a>(
<a name="l00341"></a>00341     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* A, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* y
<a name="l00342"></a>00342 ) {
<a name="l00343"></a>00343     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> m = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>;
<a name="l00344"></a>00344     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>,ij;
<a name="l00345"></a>00345     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* Ri = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00346"></a>00346     <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>* c = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00347"></a>00347     <span class="keywordflow">for</span>(i=0; i&lt;m; i++) {
<a name="l00348"></a>00348         y[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;
<a name="l00349"></a>00349         Ri = &amp;(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00350"></a>00350         <span class="keywordflow">for</span>(ij=0; ij&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; ij++) {
<a name="l00351"></a>00351             c = &amp;(Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[ij]);
<a name="l00352"></a>00352             y[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] += c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> * x[c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>];
<a name="l00353"></a>00353             <span class="keywordflow">if</span>(i != c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>) {
<a name="l00354"></a>00354                 y[c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>] += c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> * x[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00355"></a>00355             }
<a name="l00356"></a>00356         }
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00360"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a1b797b67a7946425ec4469463950275a">00360</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a1b797b67a7946425ec4469463950275a">__nlSparseMatrix_mult_rows</a>(
<a name="l00361"></a>00361     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* A, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* y
<a name="l00362"></a>00362 ) {
<a name="l00363"></a>00363     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> m = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>;
<a name="l00364"></a>00364     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>,ij;
<a name="l00365"></a>00365     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* Ri = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00366"></a>00366     <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>* c = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00367"></a>00367     <span class="keywordflow">for</span>(i=0; i&lt;m; i++) {
<a name="l00368"></a>00368         y[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;
<a name="l00369"></a>00369         Ri = &amp;(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00370"></a>00370         <span class="keywordflow">for</span>(ij=0; ij&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; ij++) {
<a name="l00371"></a>00371             c = &amp;(Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[ij]);
<a name="l00372"></a>00372             y[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] += c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> * x[c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>];
<a name="l00373"></a>00373         }
<a name="l00374"></a>00374     }
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a7f683472e3aed4059bd6a662802b452f">00377</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a7f683472e3aed4059bd6a662802b452f">__nlSparseMatrix_mult_cols_symmetric</a>(
<a name="l00378"></a>00378     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* A, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* y
<a name="l00379"></a>00379 ) {
<a name="l00380"></a>00380     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>;
<a name="l00381"></a>00381     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> j,ii;
<a name="l00382"></a>00382     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* Cj = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00383"></a>00383     <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>* c = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00384"></a>00384     <span class="keywordflow">for</span>(j=0; j&lt;n; j++) {
<a name="l00385"></a>00385         y[j] = 0;
<a name="l00386"></a>00386         Cj = &amp;(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>[j]);
<a name="l00387"></a>00387         <span class="keywordflow">for</span>(ii=0; ii&lt;Cj-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; ii++) {
<a name="l00388"></a>00388             c = &amp;(Cj-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[ii]);
<a name="l00389"></a>00389             y[c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>] += c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> * x[j];
<a name="l00390"></a>00390             <span class="keywordflow">if</span>(j != c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>) {
<a name="l00391"></a>00391                 y[j] += c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> * x[c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>];
<a name="l00392"></a>00392             }
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a7ef733a36b4d7dbe2864471763d0baee">00397</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a7ef733a36b4d7dbe2864471763d0baee">__nlSparseMatrix_mult_cols</a>(
<a name="l00398"></a>00398     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* A, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* y
<a name="l00399"></a>00399 ) {
<a name="l00400"></a>00400     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>;
<a name="l00401"></a>00401     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> j,ii; 
<a name="l00402"></a>00402     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* Cj = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00403"></a>00403     <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>* c = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00404"></a>00404     <a class="code" href="../../d5/d6b/opennl_8c.html#a598435bfad713744704dd95fda607942">__NL_CLEAR_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, y, A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>);
<a name="l00405"></a>00405     <span class="keywordflow">for</span>(j=0; j&lt;n; j++) {
<a name="l00406"></a>00406         Cj = &amp;(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a1a896996b552fc87fb6ef3acc21c2be2">column</a>[j]);
<a name="l00407"></a>00407         <span class="keywordflow">for</span>(ii=0; ii&lt;Cj-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; ii++) {
<a name="l00408"></a>00408             c = &amp;(Cj-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[ii]);
<a name="l00409"></a>00409             y[c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>] += c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> * x[j];
<a name="l00410"></a>00410         }
<a name="l00411"></a>00411     }
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="comment">/************************************************************************************/</span>
<a name="l00415"></a>00415 <span class="comment">/* SparseMatrix x Vector routines, main driver routine */</span>
<a name="l00416"></a>00416 
<a name="l00417"></a><a class="code" href="../../d5/d6b/opennl_8c.html#aef49cfa19f05ed535dcfbeaabb9ca5b0">00417</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#aef49cfa19f05ed535dcfbeaabb9ca5b0">__nlSparseMatrixMult</a>(<a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* A, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* y) {
<a name="l00418"></a>00418     <span class="keywordflow">if</span>(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>) {
<a name="l00419"></a>00419         <span class="keywordflow">if</span>(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#afd84cb6981d0905d96ae9c1880bd88fc">__NL_SYMMETRIC</a>) {
<a name="l00420"></a>00420             <a class="code" href="../../d5/d6b/opennl_8c.html#a75c59dd054b685fc6fee313f5a69ec46">__nlSparseMatrix_mult_rows_symmetric</a>(A, x, y);
<a name="l00421"></a>00421         } <span class="keywordflow">else</span> {
<a name="l00422"></a>00422             <a class="code" href="../../d5/d6b/opennl_8c.html#a1b797b67a7946425ec4469463950275a">__nlSparseMatrix_mult_rows</a>(A, x, y);
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424     } <span class="keywordflow">else</span> {
<a name="l00425"></a>00425         <span class="keywordflow">if</span>(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#afd84cb6981d0905d96ae9c1880bd88fc">__NL_SYMMETRIC</a>) {
<a name="l00426"></a>00426             <a class="code" href="../../d5/d6b/opennl_8c.html#a7f683472e3aed4059bd6a662802b452f">__nlSparseMatrix_mult_cols_symmetric</a>(A, x, y);
<a name="l00427"></a>00427         } <span class="keywordflow">else</span> {
<a name="l00428"></a>00428             <a class="code" href="../../d5/d6b/opennl_8c.html#a7ef733a36b4d7dbe2864471763d0baee">__nlSparseMatrix_mult_cols</a>(A, x, y);
<a name="l00429"></a>00429         }
<a name="l00430"></a>00430     }
<a name="l00431"></a>00431 }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 <span class="comment">/* ****************** Routines for least squares ******************* */</span>
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a20e238198172491df89d979f8393e56d">00435</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a20e238198172491df89d979f8393e56d">__nlSparseMatrix_square</a>(
<a name="l00436"></a>00436     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* AtA, <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a> *A
<a name="l00437"></a>00437 ) {
<a name="l00438"></a>00438     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> m = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>;
<a name="l00439"></a>00439     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>;
<a name="l00440"></a>00440     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j0, j1;
<a name="l00441"></a>00441     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a> *Ri = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00442"></a>00442     <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a> *c0 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *c1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00443"></a>00443     <span class="keywordtype">float</span> value;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <a class="code" href="../../d5/d6b/opennl_8c.html#a11f79d2d9b9a98cf5a7231ec76ffa766">__nlSparseMatrixConstruct</a>(AtA, n, n, A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a>);
<a name="l00446"></a>00446 
<a name="l00447"></a>00447     <span class="keywordflow">for</span>(i=0; i&lt;m; i++) {
<a name="l00448"></a>00448         Ri = &amp;(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00449"></a>00449 
<a name="l00450"></a>00450         <span class="keywordflow">for</span>(j0=0; j0&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; j0++) {
<a name="l00451"></a>00451             c0 = &amp;(Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[j0]);
<a name="l00452"></a>00452             <span class="keywordflow">for</span>(j1=0; j1&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; j1++) {
<a name="l00453"></a>00453                 c1 = &amp;(Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[j1]);
<a name="l00454"></a>00454 
<a name="l00455"></a>00455                 value = c0-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a>*c1-&gt;value;
<a name="l00456"></a>00456                 <a class="code" href="../../d5/d6b/opennl_8c.html#a0b89ee6eee22cb4000e80859eb1bddd8">__nlSparseMatrixAdd</a>(AtA, c0-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>, c1-&gt;index, value);
<a name="l00457"></a>00457             }
<a name="l00458"></a>00458         }
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00462"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a603b2e046933370d41e528c018fe4e3f">00462</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a603b2e046933370d41e528c018fe4e3f">__nlSparseMatrix_transpose_mult_rows</a>(
<a name="l00463"></a>00463     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* A, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* y
<a name="l00464"></a>00464 ) {
<a name="l00465"></a>00465     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> m = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a>;
<a name="l00466"></a>00466     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n = A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>;
<a name="l00467"></a>00467     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>,ij;
<a name="l00468"></a>00468     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* Ri = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00469"></a>00469     <a class="code" href="../../d0/d42/struct____NLCoeff.html">__NLCoeff</a>* c = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00470"></a>00470 
<a name="l00471"></a>00471     <a class="code" href="../../d5/d6b/opennl_8c.html#a598435bfad713744704dd95fda607942">__NL_CLEAR_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, y, n);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="keywordflow">for</span>(i=0; i&lt;m; i++) {
<a name="l00474"></a>00474         Ri = &amp;(A-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00475"></a>00475         <span class="keywordflow">for</span>(ij=0; ij&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; ij++) {
<a name="l00476"></a>00476             c = &amp;(Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[ij]);
<a name="l00477"></a>00477             y[c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>] += c-&gt;<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a> * x[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00478"></a>00478         }
<a name="l00479"></a>00479     }
<a name="l00480"></a>00480 }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="comment">/************************************************************************************/</span>
<a name="l00483"></a>00483 <span class="comment">/* NLContext data structure */</span>
<a name="l00484"></a>00484 
<a name="l00485"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a53a98f28ebab1b90b093a3fe1576a534">00485</a> <span class="keyword">typedef</span> void(*<a class="code" href="../../d5/d6b/opennl_8c.html#a53a98f28ebab1b90b093a3fe1576a534">__NLMatrixFunc</a>)(<span class="keywordtype">float</span>* x, <span class="keywordtype">float</span>* y);
<a name="l00486"></a>00486 
<a name="l00487"></a><a class="code" href="../../dc/dd6/struct____NLVariable.html">00487</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00488"></a><a class="code" href="../../dc/dd6/struct____NLVariable.html#acc5d2910f51c3a594ad60617928a5d7e">00488</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>  value[4];
<a name="l00489"></a><a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">00489</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>;
<a name="l00490"></a><a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">00490</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>  <a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>;
<a name="l00491"></a><a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">00491</a>     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a> *<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a>;
<a name="l00492"></a>00492 } <a class="code" href="../../dc/dd6/struct____NLVariable.html">__NLVariable</a>;
<a name="l00493"></a>00493 
<a name="l00494"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a4413b6097158a52117f51c7b4af75be0">00494</a> <span class="preprocessor">#define __NL_STATE_INITIAL              0</span>
<a name="l00495"></a><a class="code" href="../../d5/d6b/opennl_8c.html#aa53d4b0d74a15998ad0e24454c35e896">00495</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_STATE_SYSTEM               1</span>
<a name="l00496"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a16a48cf07bb5874c4e3f6373abe4afe3">00496</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_STATE_MATRIX               2</span>
<a name="l00497"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ab1a71f6ee419ffe1eb842a05e5ac74e9">00497</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_STATE_MATRIX_CONSTRUCTED   3</span>
<a name="l00498"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a7efb56fe0cf28aed935c4ca3bafee343">00498</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_STATE_SYSTEM_CONSTRUCTED   4</span>
<a name="l00499"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a0e64d144290a7e0c4ae4594f8138c0a3">00499</a> <span class="preprocessor"></span><span class="preprocessor">#define __NL_STATE_SYSTEM_SOLVED        5</span>
<a name="l00500"></a>00500 <span class="preprocessor"></span>
<a name="l00501"></a><a class="code" href="../../d2/d5c/struct____NLContext.html">00501</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00502"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#ad5c864fc50ea68a76cae430f85efeba1">00502</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a>          <a class="code" href="../../d2/d5c/struct____NLContext.html#ad5c864fc50ea68a76cae430f85efeba1">state</a>;
<a name="l00503"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">00503</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>          <a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>;
<a name="l00504"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">00504</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>          <a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a>;
<a name="l00505"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">00505</a>     <a class="code" href="../../dc/dd6/struct____NLVariable.html">__NLVariable</a>*   <a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>;
<a name="l00506"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">00506</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>*        <a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a>;
<a name="l00507"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#addd6fd469b2ae54120f6c168327810c8">00507</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>*        <a class="code" href="../../d2/d5c/struct____NLContext.html#addd6fd469b2ae54120f6c168327810c8">Mtb</a>;
<a name="l00508"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">00508</a>     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a> <a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>;
<a name="l00509"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#af83379748954234f16f9bb020fa4705d">00509</a>     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a> <a class="code" href="../../d2/d5c/struct____NLContext.html#af83379748954234f16f9bb020fa4705d">MtM</a>;
<a name="l00510"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#ae82de19e99d31be082eb383b5210ff3f">00510</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>*        <a class="code" href="../../d2/d5c/struct____NLContext.html#ae82de19e99d31be082eb383b5210ff3f">x</a>;
<a name="l00511"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">00511</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>          <a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>;
<a name="l00512"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">00512</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>          <a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">nb_rows</a>;
<a name="l00513"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">00513</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>;
<a name="l00514"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a4468df4a96aaf19e2d5387138135b954">00514</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#a4468df4a96aaf19e2d5387138135b954">symmetric</a>;
<a name="l00515"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">00515</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>          <a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>;
<a name="l00516"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">00516</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">solve_again</a>;
<a name="l00517"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a643cfa1b89f694de6c48aa1f2fb7c1b2">00517</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#a643cfa1b89f694de6c48aa1f2fb7c1b2">alloc_M</a>;
<a name="l00518"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a8144619a6fef56e6b514ab5be571e861">00518</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#a8144619a6fef56e6b514ab5be571e861">alloc_MtM</a>;
<a name="l00519"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#ada31ee16ee2c0d0c8c33ddd10ee3d216">00519</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#ada31ee16ee2c0d0c8c33ddd10ee3d216">alloc_variable</a>;
<a name="l00520"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a70d44b13ee05d98ccc6cea692c323146">00520</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#a70d44b13ee05d98ccc6cea692c323146">alloc_x</a>;
<a name="l00521"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a247a295aaa104e4b883cda573f01b253">00521</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#a247a295aaa104e4b883cda573f01b253">alloc_b</a>;
<a name="l00522"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#adab50826583256f44fd4fd1a8d9f8c8d">00522</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>       <a class="code" href="../../d2/d5c/struct____NLContext.html#adab50826583256f44fd4fd1a8d9f8c8d">alloc_Mtb</a>;
<a name="l00523"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a89358af7e1d7661d134cd42ec488a126">00523</a>     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>         <a class="code" href="../../d2/d5c/struct____NLContext.html#a89358af7e1d7661d134cd42ec488a126">error</a>;
<a name="l00524"></a><a class="code" href="../../d2/d5c/struct____NLContext.html#a44a57cc331374de767423cc7d8e60d57">00524</a>     <a class="code" href="../../d5/d6b/opennl_8c.html#a53a98f28ebab1b90b093a3fe1576a534">__NLMatrixFunc</a>  <a class="code" href="../../d2/d5c/struct____NLContext.html#a44a57cc331374de767423cc7d8e60d57">matrix_vector_prod</a>;
<a name="l00525"></a>00525 
<a name="l00526"></a><a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html">00526</a>     <span class="keyword">struct </span><a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html">__NLSuperLUContext</a> {
<a name="l00527"></a><a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a8163f31baa76d249e970b12b0b369060">00527</a>         <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a8163f31baa76d249e970b12b0b369060">alloc_slu</a>;
<a name="l00528"></a><a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#abc2bd0f4049be1e70fae9a6264654792">00528</a>         <a class="code" href="../../d8/d79/structSuperMatrix.html">SuperMatrix</a> <a class="code" href="../../d2/d6c/mball_8c.html#aa73214aa5f2f94f63d90bb4e3d99fe53">L</a>, <a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#abc2bd0f4049be1e70fae9a6264654792">U</a>;
<a name="l00529"></a><a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ac26e20f72c1de7e5d7465f0a3a83ddca">00529</a>         <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> *perm_c, *<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ac26e20f72c1de7e5d7465f0a3a83ddca">perm_r</a>;
<a name="l00530"></a><a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ab56799152a4db46e78ce1a9ebb7a5cc4">00530</a>         <a class="code" href="../../d7/d51/structSuperLUStat__t.html">SuperLUStat_t</a> <a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ab56799152a4db46e78ce1a9ebb7a5cc4">stat</a>;
<a name="l00531"></a>00531     } slu;
<a name="l00532"></a>00532 } <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>;
<a name="l00533"></a>00533 
<a name="l00534"></a><a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">00534</a> <span class="keyword">static</span> <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>* <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00535"></a>00535 
<a name="l00536"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ad21bd19076c1d7da8cde88af3320add8">00536</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#ad21bd19076c1d7da8cde88af3320add8">__nlMatrixVectorProd_default</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* y) {
<a name="l00537"></a>00537     <a class="code" href="../../d5/d6b/opennl_8c.html#aef49cfa19f05ed535dcfbeaabb9ca5b0">__nlSparseMatrixMult</a>(&amp;(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>), x, y);
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 
<a name="l00541"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ab1054f9a1b1ab94be7f2c63964c0a34a">00541</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a3481fa5895ecf7c96e0b6245295428d6">NLContext</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab1054f9a1b1ab94be7f2c63964c0a34a">nlNewContext</a>(<span class="keywordtype">void</span>) {
<a name="l00542"></a>00542     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>* result   = <a class="code" href="../../d5/d6b/opennl_8c.html#a49ddca582c22f314bf2d9da5d6434601">__NL_NEW</a>(<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>);
<a name="l00543"></a>00543     result-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad5c864fc50ea68a76cae430f85efeba1">state</a>           = <a class="code" href="../../d5/d6b/opennl_8c.html#a4413b6097158a52117f51c7b4af75be0">__NL_STATE_INITIAL</a>;
<a name="l00544"></a>00544     result-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a44a57cc331374de767423cc7d8e60d57">matrix_vector_prod</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#ad21bd19076c1d7da8cde88af3320add8">__nlMatrixVectorProd_default</a>;
<a name="l00545"></a>00545     result-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a> = 1;
<a name="l00546"></a>00546     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a81804eba1305d922f867fcb2b8c337cd">nlMakeCurrent</a>(result);
<a name="l00547"></a>00547     <span class="keywordflow">return</span> result;
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a63e2c7da32dfbbd667e5b5c367af6c4c">__nlFree_SUPERLU</a>(<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context);
<a name="l00551"></a>00551 
<a name="l00552"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a84abb0ff257158f1987b05ee51d9d626">00552</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa3cd9a372693b183d71e3a84053262d3">nlDeleteContext</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a3481fa5895ecf7c96e0b6245295428d6">NLContext</a> context_in) {
<a name="l00553"></a>00553     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>* context = (<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>*)(context_in);
<a name="l00554"></a>00554     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556     <span class="keywordflow">if</span>(__nlCurrentContext == context) {
<a name="l00557"></a>00557         __nlCurrentContext = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00558"></a>00558     }
<a name="l00559"></a>00559     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a643cfa1b89f694de6c48aa1f2fb7c1b2">alloc_M</a>) {
<a name="l00560"></a>00560         <a class="code" href="../../d5/d6b/opennl_8c.html#a6c26d8ed88a14241d0d5ad9a3723131d">__nlSparseMatrixDestroy</a>(&amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>);
<a name="l00561"></a>00561     }
<a name="l00562"></a>00562     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a8144619a6fef56e6b514ab5be571e861">alloc_MtM</a>) {
<a name="l00563"></a>00563         <a class="code" href="../../d5/d6b/opennl_8c.html#a6c26d8ed88a14241d0d5ad9a3723131d">__nlSparseMatrixDestroy</a>(&amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#af83379748954234f16f9bb020fa4705d">MtM</a>);
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ada31ee16ee2c0d0c8c33ddd10ee3d216">alloc_variable</a>) {
<a name="l00566"></a>00566         <span class="keywordflow">for</span>(i=0; i&lt;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>; i++) {
<a name="l00567"></a>00567             <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[i].<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a>) {
<a name="l00568"></a>00568                 <a class="code" href="../../d5/d6b/opennl_8c.html#af37b151bec2cc64c7b9709ef050e7e16">__nlRowColumnDestroy</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[i].<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a>);
<a name="l00569"></a>00569                 <a class="code" href="../../d5/d6b/opennl_8c.html#a9bacfb58b95fd2d49284a827cf6cbfb1">__NL_DELETE</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[i].<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a>);
<a name="l00570"></a>00570             }
<a name="l00571"></a>00571         }
<a name="l00572"></a>00572     }
<a name="l00573"></a>00573     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a247a295aaa104e4b883cda573f01b253">alloc_b</a>) {
<a name="l00574"></a>00574         <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a>);
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adab50826583256f44fd4fd1a8d9f8c8d">alloc_Mtb</a>) {
<a name="l00577"></a>00577         <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#addd6fd469b2ae54120f6c168327810c8">Mtb</a>);
<a name="l00578"></a>00578     }
<a name="l00579"></a>00579     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a70d44b13ee05d98ccc6cea692c323146">alloc_x</a>) {
<a name="l00580"></a>00580         <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ae82de19e99d31be082eb383b5210ff3f">x</a>);
<a name="l00581"></a>00581     }
<a name="l00582"></a>00582     <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a8163f31baa76d249e970b12b0b369060">alloc_slu</a>) {
<a name="l00583"></a>00583         <a class="code" href="../../d5/d6b/opennl_8c.html#a63e2c7da32dfbbd667e5b5c367af6c4c">__nlFree_SUPERLU</a>(context);
<a name="l00584"></a>00584     }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="preprocessor">#ifdef NL_PARANOID</span>
<a name="l00587"></a>00587 <span class="preprocessor"></span>    <a class="code" href="../../d5/d6b/opennl_8c.html#a264cea5b6161caa59ef32342c61f262c">__NL_CLEAR</a>(<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>, context);
<a name="l00588"></a>00588 <span class="preprocessor">#endif</span>
<a name="l00589"></a>00589 <span class="preprocessor"></span>    <a class="code" href="../../d5/d6b/opennl_8c.html#a9bacfb58b95fd2d49284a827cf6cbfb1">__NL_DELETE</a>(context);
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00592"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a81804eba1305d922f867fcb2b8c337cd">00592</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a81804eba1305d922f867fcb2b8c337cd">nlMakeCurrent</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a3481fa5895ecf7c96e0b6245295428d6">NLContext</a> context) {
<a name="l00593"></a>00593     __nlCurrentContext = (<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a>*)(context);
<a name="l00594"></a>00594 }
<a name="l00595"></a>00595 
<a name="l00596"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a9fb5d3916e99001b17e71ab38646119e">00596</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a3481fa5895ecf7c96e0b6245295428d6">NLContext</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a9fb5d3916e99001b17e71ab38646119e">nlGetCurrent</a>(<span class="keywordtype">void</span>) {
<a name="l00597"></a>00597     <span class="keywordflow">return</span> <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00600"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">00600</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a1ac338c8291400e2f2785ef2cb7a5458">state</a>) {
<a name="l00601"></a>00601     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad5c864fc50ea68a76cae430f85efeba1">state</a> == state);
<a name="l00602"></a>00602 }
<a name="l00603"></a>00603 
<a name="l00604"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">00604</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">__nlTransition</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> from_state, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> to_state) {
<a name="l00605"></a>00605     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(from_state);
<a name="l00606"></a>00606     __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad5c864fc50ea68a76cae430f85efeba1">state</a> = to_state;
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="comment">/************************************************************************************/</span>
<a name="l00610"></a>00610 <span class="comment">/* Get/Set parameters */</span>
<a name="l00611"></a>00611 
<a name="l00612"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a831ce0bdcfa93b930fedf5e8724df490">00612</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a831ce0bdcfa93b930fedf5e8724df490">nlSolverParameterf</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> param) {
<a name="l00613"></a>00613     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a4413b6097158a52117f51c7b4af75be0">__NL_STATE_INITIAL</a>);
<a name="l00614"></a>00614     <span class="keywordflow">switch</span>(pname) {
<a name="l00615"></a>00615     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a18fe83c4c3c6b38100da3898d8c717ed">NL_NB_VARIABLES</a>: {
<a name="l00616"></a>00616         <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(param &gt; 0);
<a name="l00617"></a>00617         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>)param;
<a name="l00618"></a>00618     } <span class="keywordflow">break</span>;
<a name="l00619"></a>00619     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a11ddde2a39d2538cc634bf2750414a9f">NL_NB_ROWS</a>: {
<a name="l00620"></a>00620         <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(param &gt; 0);
<a name="l00621"></a>00621         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">nb_rows</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>)param;
<a name="l00622"></a>00622     } <span class="keywordflow">break</span>;
<a name="l00623"></a>00623     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab52121ea76b6a5130531959d4213b0a5">NL_LEAST_SQUARES</a>: {
<a name="l00624"></a>00624         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>)param;
<a name="l00625"></a>00625     } <span class="keywordflow">break</span>;
<a name="l00626"></a>00626     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a283a58ef73ceced29a80358ff050d519">NL_SYMMETRIC</a>: {
<a name="l00627"></a>00627         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a4468df4a96aaf19e2d5387138135b954">symmetric</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>)param;       
<a name="l00628"></a>00628     } <span class="keywordflow">break</span>;
<a name="l00629"></a>00629     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a7bcb6a7540b0ded3a8c5a264a7520b8b">NL_NB_RIGHT_HAND_SIDES</a>: {
<a name="l00630"></a>00630         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>)param;
<a name="l00631"></a>00631     } <span class="keywordflow">break</span>;
<a name="l00632"></a>00632     <span class="keywordflow">default</span>: {
<a name="l00633"></a>00633         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00634"></a>00634     } <span class="keywordflow">break</span>;
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636 }
<a name="l00637"></a>00637 
<a name="l00638"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a478d8f98fe56b4383eeae14bf55bafaf">00638</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a478d8f98fe56b4383eeae14bf55bafaf">nlSolverParameteri</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname, <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> param) {
<a name="l00639"></a>00639     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a4413b6097158a52117f51c7b4af75be0">__NL_STATE_INITIAL</a>);
<a name="l00640"></a>00640     <span class="keywordflow">switch</span>(pname) {
<a name="l00641"></a>00641     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a18fe83c4c3c6b38100da3898d8c717ed">NL_NB_VARIABLES</a>: {
<a name="l00642"></a>00642         <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(param &gt; 0);
<a name="l00643"></a>00643         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>)param;
<a name="l00644"></a>00644     } <span class="keywordflow">break</span>;
<a name="l00645"></a>00645     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a11ddde2a39d2538cc634bf2750414a9f">NL_NB_ROWS</a>: {
<a name="l00646"></a>00646         <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(param &gt; 0);
<a name="l00647"></a>00647         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">nb_rows</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>)param;
<a name="l00648"></a>00648     } <span class="keywordflow">break</span>;
<a name="l00649"></a>00649     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab52121ea76b6a5130531959d4213b0a5">NL_LEAST_SQUARES</a>: {
<a name="l00650"></a>00650         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>)param;
<a name="l00651"></a>00651     } <span class="keywordflow">break</span>;
<a name="l00652"></a>00652     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a283a58ef73ceced29a80358ff050d519">NL_SYMMETRIC</a>: {
<a name="l00653"></a>00653         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a4468df4a96aaf19e2d5387138135b954">symmetric</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>)param;       
<a name="l00654"></a>00654     } <span class="keywordflow">break</span>;
<a name="l00655"></a>00655     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a7bcb6a7540b0ded3a8c5a264a7520b8b">NL_NB_RIGHT_HAND_SIDES</a>: {
<a name="l00656"></a>00656         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a> = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a>)param;
<a name="l00657"></a>00657     } <span class="keywordflow">break</span>;
<a name="l00658"></a>00658     <span class="keywordflow">default</span>: {
<a name="l00659"></a>00659         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00660"></a>00660     } <span class="keywordflow">break</span>;
<a name="l00661"></a>00661     }
<a name="l00662"></a>00662 }
<a name="l00663"></a>00663 
<a name="l00664"></a><a class="code" href="../../d5/d6b/opennl_8c.html#adf14c67af57c0623ffaa3628f82c543f">00664</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#adf14c67af57c0623ffaa3628f82c543f">nlGetBooleanv</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname, <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a>* params) {
<a name="l00665"></a>00665     <span class="keywordflow">switch</span>(pname) {
<a name="l00666"></a>00666     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab52121ea76b6a5130531959d4213b0a5">NL_LEAST_SQUARES</a>: {
<a name="l00667"></a>00667         *params = __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>;
<a name="l00668"></a>00668     } <span class="keywordflow">break</span>;
<a name="l00669"></a>00669     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a283a58ef73ceced29a80358ff050d519">NL_SYMMETRIC</a>: {
<a name="l00670"></a>00670         *params = __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a4468df4a96aaf19e2d5387138135b954">symmetric</a>;
<a name="l00671"></a>00671     } <span class="keywordflow">break</span>;
<a name="l00672"></a>00672     <span class="keywordflow">default</span>: {
<a name="l00673"></a>00673         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00674"></a>00674     } <span class="keywordflow">break</span>;
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676 }
<a name="l00677"></a>00677 
<a name="l00678"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a47b3f78a498d7fb6cef79a4d9cb783a4">00678</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a47b3f78a498d7fb6cef79a4d9cb783a4">nlGetFloatv</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* params) {
<a name="l00679"></a>00679     <span class="keywordflow">switch</span>(pname) {
<a name="l00680"></a>00680     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a18fe83c4c3c6b38100da3898d8c717ed">NL_NB_VARIABLES</a>: {
<a name="l00681"></a>00681         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>);
<a name="l00682"></a>00682     } <span class="keywordflow">break</span>;
<a name="l00683"></a>00683     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a11ddde2a39d2538cc634bf2750414a9f">NL_NB_ROWS</a>: {
<a name="l00684"></a>00684         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">nb_rows</a>);
<a name="l00685"></a>00685     } <span class="keywordflow">break</span>;
<a name="l00686"></a>00686     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab52121ea76b6a5130531959d4213b0a5">NL_LEAST_SQUARES</a>: {
<a name="l00687"></a>00687         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>);
<a name="l00688"></a>00688     } <span class="keywordflow">break</span>;
<a name="l00689"></a>00689     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a283a58ef73ceced29a80358ff050d519">NL_SYMMETRIC</a>: {
<a name="l00690"></a>00690         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a4468df4a96aaf19e2d5387138135b954">symmetric</a>);
<a name="l00691"></a>00691     } <span class="keywordflow">break</span>;
<a name="l00692"></a>00692     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a5ecd0f9865869c2c7f61d7aef08d025d">NL_ERROR</a>: {
<a name="l00693"></a>00693         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a89358af7e1d7661d134cd42ec488a126">error</a>);
<a name="l00694"></a>00694     } <span class="keywordflow">break</span>;
<a name="l00695"></a>00695     <span class="keywordflow">default</span>: {
<a name="l00696"></a>00696         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00697"></a>00697     } <span class="keywordflow">break</span>;
<a name="l00698"></a>00698     }
<a name="l00699"></a>00699 }
<a name="l00700"></a>00700 
<a name="l00701"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ada23ce23678b2c6d301b6c3729602c09">00701</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ada23ce23678b2c6d301b6c3729602c09">nlGetIntergerv</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname, <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>* params) {
<a name="l00702"></a>00702     <span class="keywordflow">switch</span>(pname) {
<a name="l00703"></a>00703     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a18fe83c4c3c6b38100da3898d8c717ed">NL_NB_VARIABLES</a>: {
<a name="l00704"></a>00704         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>);
<a name="l00705"></a>00705     } <span class="keywordflow">break</span>;
<a name="l00706"></a>00706     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a11ddde2a39d2538cc634bf2750414a9f">NL_NB_ROWS</a>: {
<a name="l00707"></a>00707         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">nb_rows</a>);
<a name="l00708"></a>00708     } <span class="keywordflow">break</span>;
<a name="l00709"></a>00709     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab52121ea76b6a5130531959d4213b0a5">NL_LEAST_SQUARES</a>: {
<a name="l00710"></a>00710         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>);
<a name="l00711"></a>00711     } <span class="keywordflow">break</span>;
<a name="l00712"></a>00712     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a283a58ef73ceced29a80358ff050d519">NL_SYMMETRIC</a>: {
<a name="l00713"></a>00713         *params = (<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>)(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a4468df4a96aaf19e2d5387138135b954">symmetric</a>);
<a name="l00714"></a>00714     } <span class="keywordflow">break</span>;
<a name="l00715"></a>00715     <span class="keywordflow">default</span>: {
<a name="l00716"></a>00716         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00717"></a>00717     } <span class="keywordflow">break</span>;
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 <span class="comment">/************************************************************************************/</span>
<a name="l00722"></a>00722 <span class="comment">/* Enable / Disable */</span>
<a name="l00723"></a>00723 
<a name="l00724"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a04a519f9780c9d03c89d64fcdf46ec9b">00724</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a04a519f9780c9d03c89d64fcdf46ec9b">nlEnable</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname) {
<a name="l00725"></a>00725     <span class="keywordflow">switch</span>(pname) {
<a name="l00726"></a>00726     <span class="keywordflow">default</span>: {
<a name="l00727"></a>00727         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729     }
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a7902de4ab87e0bca90d9a536cad65a53">00732</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a7902de4ab87e0bca90d9a536cad65a53">nlDisable</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname) {
<a name="l00733"></a>00733     <span class="keywordflow">switch</span>(pname) {
<a name="l00734"></a>00734     <span class="keywordflow">default</span>: {
<a name="l00735"></a>00735         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00736"></a>00736     }
<a name="l00737"></a>00737     }
<a name="l00738"></a>00738 }
<a name="l00739"></a>00739 
<a name="l00740"></a><a class="code" href="../../d5/d6b/opennl_8c.html#acc464204f1b32420405ce26c40c1d1c6">00740</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#acc464204f1b32420405ce26c40c1d1c6">nlIsEnabled</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> pname) {
<a name="l00741"></a>00741     <span class="keywordflow">switch</span>(pname) {
<a name="l00742"></a>00742     <span class="keywordflow">default</span>: {
<a name="l00743"></a>00743         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l00744"></a>00744     }
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746     <span class="keywordflow">return</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a0907391e671bc8a56d27a1a3c8c33c12">NL_FALSE</a>;
<a name="l00747"></a>00747 }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749 <span class="comment">/************************************************************************************/</span>
<a name="l00750"></a>00750 <span class="comment">/* Get/Set Lock/Unlock variables */</span>
<a name="l00751"></a>00751 
<a name="l00752"></a><a class="code" href="../../d5/d6b/opennl_8c.html#aef3296ce010ea7a5107facf759193876">00752</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#aef3296ce010ea7a5107facf759193876">nlSetVariable</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> rhsindex, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> index, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> value) {
<a name="l00753"></a>00753     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#aa53d4b0d74a15998ad0e24454c35e896">__NL_STATE_SYSTEM</a>);
<a name="l00754"></a>00754     <a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">__nl_parano_range_assert</a>(index, 0, __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> - 1);
<a name="l00755"></a>00755     __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#acc5d2910f51c3a594ad60617928a5d7e">value</a>[rhsindex] = value;    
<a name="l00756"></a>00756 }
<a name="l00757"></a>00757 
<a name="l00758"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a8beef3987b9c0b7e1aaf82ec70a88ef5">00758</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a8beef3987b9c0b7e1aaf82ec70a88ef5">nlGetVariable</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> rhsindex, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> index) {
<a name="l00759"></a>00759     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad5c864fc50ea68a76cae430f85efeba1">state</a> != <a class="code" href="../../d5/d6b/opennl_8c.html#a4413b6097158a52117f51c7b4af75be0">__NL_STATE_INITIAL</a>);
<a name="l00760"></a>00760     <a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">__nl_parano_range_assert</a>(index, 0, __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> - 1);
<a name="l00761"></a>00761     <span class="keywordflow">return</span> __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#acc5d2910f51c3a594ad60617928a5d7e">value</a>[rhsindex];
<a name="l00762"></a>00762 }
<a name="l00763"></a>00763 
<a name="l00764"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a8dce31ba4248794c9c0317a70c5d78ae">00764</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a8dce31ba4248794c9c0317a70c5d78ae">nlLockVariable</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> index) {
<a name="l00765"></a>00765     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#aa53d4b0d74a15998ad0e24454c35e896">__NL_STATE_SYSTEM</a>);
<a name="l00766"></a>00766     <a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">__nl_parano_range_assert</a>(index, 0, __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> - 1);
<a name="l00767"></a>00767     __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l00768"></a>00768 }
<a name="l00769"></a>00769 
<a name="l00770"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a26488aace8e52dda0191fe6641809538">00770</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a26488aace8e52dda0191fe6641809538">nlUnlockVariable</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> index) {
<a name="l00771"></a>00771     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#aa53d4b0d74a15998ad0e24454c35e896">__NL_STATE_SYSTEM</a>);
<a name="l00772"></a>00772     <a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">__nl_parano_range_assert</a>(index, 0, __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> - 1);
<a name="l00773"></a>00773     __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#a0907391e671bc8a56d27a1a3c8c33c12">NL_FALSE</a>;
<a name="l00774"></a>00774 }
<a name="l00775"></a>00775 
<a name="l00776"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a6c153e8bd87019812556de824a4e7653">00776</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a6c153e8bd87019812556de824a4e7653">nlVariableIsLocked</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> index) {
<a name="l00777"></a>00777     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad5c864fc50ea68a76cae430f85efeba1">state</a> != <a class="code" href="../../d5/d6b/opennl_8c.html#a4413b6097158a52117f51c7b4af75be0">__NL_STATE_INITIAL</a>);
<a name="l00778"></a>00778     <a class="code" href="../../d5/d6b/opennl_8c.html#a74e0fb1e253d7cde2c6439b757b75387">__nl_parano_range_assert</a>(index, 0, __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> - 1);
<a name="l00779"></a>00779     <span class="keywordflow">return</span> __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>;
<a name="l00780"></a>00780 }
<a name="l00781"></a>00781 
<a name="l00782"></a>00782 <span class="comment">/************************************************************************************/</span>
<a name="l00783"></a>00783 <span class="comment">/* System construction */</span>
<a name="l00784"></a>00784 
<a name="l00785"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ada541559a4e5c091a7fc9c9dfc8c2fb6">00785</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#ada541559a4e5c091a7fc9c9dfc8c2fb6">__nlVariablesToVector</a>() {
<a name="l00786"></a>00786     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00787"></a>00787     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, nb_rhs;
<a name="l00788"></a>00788 
<a name="l00789"></a>00789     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a70d44b13ee05d98ccc6cea692c323146">alloc_x</a>);
<a name="l00790"></a>00790     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ada31ee16ee2c0d0c8c33ddd10ee3d216">alloc_variable</a>);
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     nb_rhs= context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     <span class="keywordflow">for</span>(i=0; i&lt;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>; i++) {
<a name="l00795"></a>00795         <a class="code" href="../../dc/dd6/struct____NLVariable.html">__NLVariable</a>* v = &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00796"></a>00796         <span class="keywordflow">if</span>(!v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>) {
<a name="l00797"></a>00797             <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a> &lt; context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799             <span class="keywordflow">for</span>(j=0; j&lt;nb_rhs; j++)
<a name="l00800"></a>00800                 context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ae82de19e99d31be082eb383b5210ff3f">x</a>[context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>*j + v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>] = v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#acc5d2910f51c3a594ad60617928a5d7e">value</a>[j];
<a name="l00801"></a>00801         }
<a name="l00802"></a>00802     }
<a name="l00803"></a>00803 }
<a name="l00804"></a>00804 
<a name="l00805"></a><a class="code" href="../../d5/d6b/opennl_8c.html#aa0c083520823a3d79bc5cd6e2c4ad6ea">00805</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#aa0c083520823a3d79bc5cd6e2c4ad6ea">__nlVectorToVariables</a>() {
<a name="l00806"></a>00806     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00807"></a>00807     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, nb_rhs;
<a name="l00808"></a>00808 
<a name="l00809"></a>00809     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a70d44b13ee05d98ccc6cea692c323146">alloc_x</a>);
<a name="l00810"></a>00810     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ada31ee16ee2c0d0c8c33ddd10ee3d216">alloc_variable</a>);
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     nb_rhs= context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>;
<a name="l00813"></a>00813 
<a name="l00814"></a>00814     <span class="keywordflow">for</span>(i=0; i&lt;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>; i++) {
<a name="l00815"></a>00815         <a class="code" href="../../dc/dd6/struct____NLVariable.html">__NLVariable</a>* v = &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00816"></a>00816         <span class="keywordflow">if</span>(!v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>) {
<a name="l00817"></a>00817             <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a> &lt; context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>);
<a name="l00818"></a>00818 
<a name="l00819"></a>00819             <span class="keywordflow">for</span>(j=0; j&lt;nb_rhs; j++)
<a name="l00820"></a>00820                 v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#acc5d2910f51c3a594ad60617928a5d7e">value</a>[j] = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ae82de19e99d31be082eb383b5210ff3f">x</a>[context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>*j + v-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>];
<a name="l00821"></a>00821         }
<a name="l00822"></a>00822     }
<a name="l00823"></a>00823 }
<a name="l00824"></a>00824 
<a name="l00825"></a><a class="code" href="../../d5/d6b/opennl_8c.html#acc49cd34f1a147543af60eb908633918">00825</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#acc49cd34f1a147543af60eb908633918">__nlBeginSystem</a>() {
<a name="l00826"></a>00826     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a> &gt; 0);
<a name="l00827"></a>00827 
<a name="l00828"></a>00828     <span class="keywordflow">if</span> (__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">solve_again</a>)
<a name="l00829"></a>00829         <a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">__nlTransition</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a0e64d144290a7e0c4ae4594f8138c0a3">__NL_STATE_SYSTEM_SOLVED</a>, <a class="code" href="../../d5/d6b/opennl_8c.html#aa53d4b0d74a15998ad0e24454c35e896">__NL_STATE_SYSTEM</a>);
<a name="l00830"></a>00830     <span class="keywordflow">else</span> {
<a name="l00831"></a>00831         <a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">__nlTransition</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a4413b6097158a52117f51c7b4af75be0">__NL_STATE_INITIAL</a>, <a class="code" href="../../d5/d6b/opennl_8c.html#aa53d4b0d74a15998ad0e24454c35e896">__NL_STATE_SYSTEM</a>);
<a name="l00832"></a>00832 
<a name="l00833"></a>00833         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(
<a name="l00834"></a>00834             <a class="code" href="../../dc/dd6/struct____NLVariable.html">__NLVariable</a>, __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>);
<a name="l00835"></a>00835         
<a name="l00836"></a>00836         __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ada31ee16ee2c0d0c8c33ddd10ee3d216">alloc_variable</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l00837"></a>00837     }
<a name="l00838"></a>00838 }
<a name="l00839"></a>00839 
<a name="l00840"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a52061221bccf7c303f1744152eeffed5">00840</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a52061221bccf7c303f1744152eeffed5">__nlEndSystem</a>() {
<a name="l00841"></a>00841     <a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">__nlTransition</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#ab1a71f6ee419ffe1eb842a05e5ac74e9">__NL_STATE_MATRIX_CONSTRUCTED</a>, <a class="code" href="../../d5/d6b/opennl_8c.html#a7efb56fe0cf28aed935c4ca3bafee343">__NL_STATE_SYSTEM_CONSTRUCTED</a>);   
<a name="l00842"></a>00842 }
<a name="l00843"></a>00843 
<a name="l00844"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ad9c88713cfe95f17912046d29eb3ac60">00844</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#ad9c88713cfe95f17912046d29eb3ac60">__nlBeginMatrix</a>() {
<a name="l00845"></a>00845     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00846"></a>00846     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> m = 0, n = 0;
<a name="l00847"></a>00847     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> storage = <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>;
<a name="l00848"></a>00848     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850     <a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">__nlTransition</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#aa53d4b0d74a15998ad0e24454c35e896">__NL_STATE_SYSTEM</a>, <a class="code" href="../../d5/d6b/opennl_8c.html#a16a48cf07bb5874c4e3f6373abe4afe3">__NL_STATE_MATRIX</a>);
<a name="l00851"></a>00851 
<a name="l00852"></a>00852     <span class="keywordflow">if</span> (!context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">solve_again</a>) {
<a name="l00853"></a>00853         <span class="keywordflow">for</span>(i=0; i&lt;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>; i++) {
<a name="l00854"></a>00854             <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[i].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>) {
<a name="l00855"></a>00855                 context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a> = ~0;
<a name="l00856"></a>00856                 context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#a49ddca582c22f314bf2d9da5d6434601">__NL_NEW</a>(<a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>);
<a name="l00857"></a>00857                 <a class="code" href="../../d5/d6b/opennl_8c.html#a11a44e5b5c112631033a76968d2d5ed1">__nlRowColumnConstruct</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[i].<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a>);
<a name="l00858"></a>00858             }
<a name="l00859"></a>00859             <span class="keywordflow">else</span>
<a name="l00860"></a>00860                 context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a> = n++;
<a name="l00861"></a>00861         }
<a name="l00862"></a>00862 
<a name="l00863"></a>00863         m = (context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">nb_rows</a> == 0)? n: context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a7dc554631209e4b7db224b94f570f574">nb_rows</a>;
<a name="l00864"></a>00864 
<a name="l00865"></a>00865         context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> = m;
<a name="l00866"></a>00866         context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a> = n;
<a name="l00867"></a>00867 
<a name="l00868"></a>00868         <a class="code" href="../../d5/d6b/opennl_8c.html#a11f79d2d9b9a98cf5a7231ec76ffa766">__nlSparseMatrixConstruct</a>(&amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>, m, n, storage);
<a name="l00869"></a>00869         context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a643cfa1b89f694de6c48aa1f2fb7c1b2">alloc_M</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l00870"></a>00870 
<a name="l00871"></a>00871         context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, m*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>);
<a name="l00872"></a>00872         context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a247a295aaa104e4b883cda573f01b253">alloc_b</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l00873"></a>00873 
<a name="l00874"></a>00874         context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ae82de19e99d31be082eb383b5210ff3f">x</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, n*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>);
<a name="l00875"></a>00875         context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a70d44b13ee05d98ccc6cea692c323146">alloc_x</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l00876"></a>00876     }
<a name="l00877"></a>00877     <span class="keywordflow">else</span> {
<a name="l00878"></a>00878         <span class="comment">/* need to recompute b only, A is not constructed anymore */</span>
<a name="l00879"></a>00879         <a class="code" href="../../d5/d6b/opennl_8c.html#a598435bfad713744704dd95fda607942">__NL_CLEAR_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a>, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a>*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>);
<a name="l00880"></a>00880     }
<a name="l00881"></a>00881 
<a name="l00882"></a>00882     <a class="code" href="../../d5/d6b/opennl_8c.html#ada541559a4e5c091a7fc9c9dfc8c2fb6">__nlVariablesToVector</a>();
<a name="l00883"></a>00883 }
<a name="l00884"></a>00884 
<a name="l00885"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a4f65f922fc42c25c0b7390e1b88e8c5f">00885</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a4f65f922fc42c25c0b7390e1b88e8c5f">__nlEndMatrixRHS</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> rhs) {
<a name="l00886"></a>00886     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00887"></a>00887     <a class="code" href="../../dc/dd6/struct____NLVariable.html">__NLVariable</a> *variable;
<a name="l00888"></a>00888     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a> *a;
<a name="l00889"></a>00889     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> *b, *Mtb;
<a name="l00890"></a>00890     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;
<a name="l00891"></a>00891 
<a name="l00892"></a>00892     b = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a> + context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a>*rhs;
<a name="l00893"></a>00893     Mtb = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#addd6fd469b2ae54120f6c168327810c8">Mtb</a> + context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>*rhs;
<a name="l00894"></a>00894 
<a name="l00895"></a>00895     <span class="keywordflow">for</span>(i=0; i&lt;__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a972532eeb23b2f1ac69613baf80355c4">nb_variables</a>; i++) {
<a name="l00896"></a>00896         variable = &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00897"></a>00897 
<a name="l00898"></a>00898         <span class="keywordflow">if</span>(variable-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>) {
<a name="l00899"></a>00899             a = variable-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a>;
<a name="l00900"></a>00900 
<a name="l00901"></a>00901             <span class="keywordflow">for</span>(j=0; j&lt;a-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; j++) {
<a name="l00902"></a>00902                 b[a-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[j].<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>] -= a-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[j].<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a>*variable-&gt;<a class="code" href="../../dc/dd6/struct____NLVariable.html#acc5d2910f51c3a594ad60617928a5d7e">value</a>[rhs];
<a name="l00903"></a>00903             }
<a name="l00904"></a>00904         }
<a name="l00905"></a>00905     }
<a name="l00906"></a>00906 
<a name="l00907"></a>00907     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>)
<a name="l00908"></a>00908         <a class="code" href="../../d5/d6b/opennl_8c.html#a603b2e046933370d41e528c018fe4e3f">__nlSparseMatrix_transpose_mult_rows</a>(&amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>, b, Mtb);
<a name="l00909"></a>00909 }
<a name="l00910"></a>00910 
<a name="l00911"></a><a class="code" href="../../d5/d6b/opennl_8c.html#afd6ab4b10e3e3921d608e0e5dc5c5c31">00911</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#afd6ab4b10e3e3921d608e0e5dc5c5c31">__nlEndMatrix</a>() {
<a name="l00912"></a>00912     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00913"></a>00913     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915     <a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">__nlTransition</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a16a48cf07bb5874c4e3f6373abe4afe3">__NL_STATE_MATRIX</a>, <a class="code" href="../../d5/d6b/opennl_8c.html#ab1a71f6ee419ffe1eb842a05e5ac74e9">__NL_STATE_MATRIX_CONSTRUCTED</a>);   
<a name="l00916"></a>00916     
<a name="l00917"></a>00917     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>) {
<a name="l00918"></a>00918         <span class="keywordflow">if</span>(!__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">solve_again</a>) {
<a name="l00919"></a>00919             <a class="code" href="../../d5/d6b/opennl_8c.html#a20e238198172491df89d979f8393e56d">__nlSparseMatrix_square</a>(&amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#af83379748954234f16f9bb020fa4705d">MtM</a>, &amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>);
<a name="l00920"></a>00920             context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a8144619a6fef56e6b514ab5be571e861">alloc_MtM</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l00921"></a>00921 
<a name="l00922"></a>00922             context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#addd6fd469b2ae54120f6c168327810c8">Mtb</a> =
<a name="l00923"></a>00923                 <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>);
<a name="l00924"></a>00924             context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adab50826583256f44fd4fd1a8d9f8c8d">alloc_Mtb</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l00925"></a>00925         }
<a name="l00926"></a>00926     }
<a name="l00927"></a>00927 
<a name="l00928"></a>00928     <span class="keywordflow">for</span>(i=0; i&lt;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>; i++)
<a name="l00929"></a>00929         <a class="code" href="../../d5/d6b/opennl_8c.html#a4f65f922fc42c25c0b7390e1b88e8c5f">__nlEndMatrixRHS</a>(i);
<a name="l00930"></a>00930 }
<a name="l00931"></a>00931 
<a name="l00932"></a><a class="code" href="../../d5/d6b/opennl_8c.html#ae933bc06339e9abed3e98df7630884d8">00932</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ae933bc06339e9abed3e98df7630884d8">nlMatrixAdd</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> row, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> col, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> value)
<a name="l00933"></a>00933 {
<a name="l00934"></a>00934     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00935"></a>00935 
<a name="l00936"></a>00936     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a16a48cf07bb5874c4e3f6373abe4afe3">__NL_STATE_MATRIX</a>);
<a name="l00937"></a>00937 
<a name="l00938"></a>00938     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">solve_again</a>)
<a name="l00939"></a>00939         <span class="keywordflow">return</span>;
<a name="l00940"></a>00940 
<a name="l00941"></a>00941     <span class="keywordflow">if</span> (!context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a> &amp;&amp; context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[row].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>);
<a name="l00942"></a>00942     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[col].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>) {
<a name="l00943"></a>00943         <span class="keywordflow">if</span>(!context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>)
<a name="l00944"></a>00944             row = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[row].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>;
<a name="l00945"></a>00945         <a class="code" href="../../d5/d6b/opennl_8c.html#a2a2d754c203fc79e70a03846b9ee24e1">__nlRowColumnAppend</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[col].<a class="code" href="../../dc/dd6/struct____NLVariable.html#ae8e83336671a1d023856c27f0169d87a">a</a>, row, value);
<a name="l00946"></a>00946     }
<a name="l00947"></a>00947     <span class="keywordflow">else</span> {
<a name="l00948"></a>00948         <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>  = &amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>;
<a name="l00949"></a>00949         
<a name="l00950"></a>00950         <span class="keywordflow">if</span>(!context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>)
<a name="l00951"></a>00951             row = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[row].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>;
<a name="l00952"></a>00952         col = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[col].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>;
<a name="l00953"></a>00953         
<a name="l00954"></a>00954         <a class="code" href="../../d5/d6b/opennl_8c.html#a042efb2fd9182de555620136894e8145">__nl_range_assert</a>(row, 0, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> - 1);
<a name="l00955"></a>00955         <a class="code" href="../../d5/d6b/opennl_8c.html#a042efb2fd9182de555620136894e8145">__nl_range_assert</a>(col, 0, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a> - 1);
<a name="l00956"></a>00956 
<a name="l00957"></a>00957         <a class="code" href="../../d5/d6b/opennl_8c.html#a0b89ee6eee22cb4000e80859eb1bddd8">__nlSparseMatrixAdd</a>(M, row, col, value);
<a name="l00958"></a>00958     }
<a name="l00959"></a>00959 }
<a name="l00960"></a>00960 
<a name="l00961"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a7aa28383fe94304ea3cc8b86ac5b9024">00961</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a7aa28383fe94304ea3cc8b86ac5b9024">nlRightHandSideAdd</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> rhsindex, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> index, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> value)
<a name="l00962"></a>00962 {
<a name="l00963"></a>00963     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00964"></a>00964     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* b = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a>;
<a name="l00965"></a>00965 
<a name="l00966"></a>00966     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a16a48cf07bb5874c4e3f6373abe4afe3">__NL_STATE_MATRIX</a>);
<a name="l00967"></a>00967 
<a name="l00968"></a>00968     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>) {
<a name="l00969"></a>00969         <a class="code" href="../../d5/d6b/opennl_8c.html#a042efb2fd9182de555620136894e8145">__nl_range_assert</a>(index, 0, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> - 1);
<a name="l00970"></a>00970         b[rhsindex*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> + index] += value;
<a name="l00971"></a>00971     }
<a name="l00972"></a>00972     <span class="keywordflow">else</span> {
<a name="l00973"></a>00973         <span class="keywordflow">if</span>(!context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>) {
<a name="l00974"></a>00974             index = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>;
<a name="l00975"></a>00975             <a class="code" href="../../d5/d6b/opennl_8c.html#a042efb2fd9182de555620136894e8145">__nl_range_assert</a>(index, 0, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> - 1);
<a name="l00976"></a>00976 
<a name="l00977"></a>00977             b[rhsindex*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> + index] += value;
<a name="l00978"></a>00978         }
<a name="l00979"></a>00979     }
<a name="l00980"></a>00980 }
<a name="l00981"></a>00981 
<a name="l00982"></a><a class="code" href="../../d5/d6b/opennl_8c.html#af4f675423df8373a06ac7db7cd20703d">00982</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#af4f675423df8373a06ac7db7cd20703d">nlRightHandSideSet</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> rhsindex, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> index, <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> value)
<a name="l00983"></a>00983 {
<a name="l00984"></a>00984     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l00985"></a>00985     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* b = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a>;
<a name="l00986"></a>00986 
<a name="l00987"></a>00987     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a16a48cf07bb5874c4e3f6373abe4afe3">__NL_STATE_MATRIX</a>);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>) {
<a name="l00990"></a>00990         <a class="code" href="../../d5/d6b/opennl_8c.html#a042efb2fd9182de555620136894e8145">__nl_range_assert</a>(index, 0, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> - 1);
<a name="l00991"></a>00991         b[rhsindex*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> + index] = value;
<a name="l00992"></a>00992     }
<a name="l00993"></a>00993     <span class="keywordflow">else</span> {
<a name="l00994"></a>00994         <span class="keywordflow">if</span>(!context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a785818d0487d483bb19eabc566b75711">locked</a>) {
<a name="l00995"></a>00995             index = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a3a3880ef52adc7cb3857840732ccbfeb">variable</a>[index].<a class="code" href="../../dc/dd6/struct____NLVariable.html#a64ba20632f14355be7ea84c1171c669a">index</a>;
<a name="l00996"></a>00996             <a class="code" href="../../d5/d6b/opennl_8c.html#a042efb2fd9182de555620136894e8145">__nl_range_assert</a>(index, 0, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> - 1);
<a name="l00997"></a>00997 
<a name="l00998"></a>00998             b[rhsindex*context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a> + index] = value;
<a name="l00999"></a>00999         }
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001 }
<a name="l01002"></a>01002 
<a name="l01003"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a3e2130685ed940cc876b16ec01b5b4f3">01003</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a055e76d818259ca099f34768747045f7">nlBegin</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> prim) {
<a name="l01004"></a>01004     <span class="keywordflow">switch</span>(prim) {
<a name="l01005"></a>01005     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a7fd5de3ea97068e7853c36d9ea70d12e">NL_SYSTEM</a>: {
<a name="l01006"></a>01006         <a class="code" href="../../d5/d6b/opennl_8c.html#acc49cd34f1a147543af60eb908633918">__nlBeginSystem</a>();
<a name="l01007"></a>01007     } <span class="keywordflow">break</span>;
<a name="l01008"></a>01008     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a771e7b6917d1b664d82cfa2ba54db280">NL_MATRIX</a>: {
<a name="l01009"></a>01009         <a class="code" href="../../d5/d6b/opennl_8c.html#ad9c88713cfe95f17912046d29eb3ac60">__nlBeginMatrix</a>();
<a name="l01010"></a>01010     } <span class="keywordflow">break</span>;
<a name="l01011"></a>01011     <span class="keywordflow">default</span>: {
<a name="l01012"></a>01012         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l01013"></a>01013     }
<a name="l01014"></a>01014     }
<a name="l01015"></a>01015 }
<a name="l01016"></a>01016 
<a name="l01017"></a><a class="code" href="../../d5/d6b/opennl_8c.html#aa7fa7f57a79a23bc0608b7e4815fce55">01017</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a54fc2191decc6e675c9c9d969d890468">nlEnd</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa0809c67836e3d7add24715f9656924e">NLenum</a> prim) {
<a name="l01018"></a>01018     <span class="keywordflow">switch</span>(prim) {
<a name="l01019"></a>01019     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a7fd5de3ea97068e7853c36d9ea70d12e">NL_SYSTEM</a>: {
<a name="l01020"></a>01020         <a class="code" href="../../d5/d6b/opennl_8c.html#a52061221bccf7c303f1744152eeffed5">__nlEndSystem</a>();
<a name="l01021"></a>01021     } <span class="keywordflow">break</span>;
<a name="l01022"></a>01022     <span class="keywordflow">case</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a771e7b6917d1b664d82cfa2ba54db280">NL_MATRIX</a>: {
<a name="l01023"></a>01023         <a class="code" href="../../d5/d6b/opennl_8c.html#afd6ab4b10e3e3921d608e0e5dc5c5c31">__nlEndMatrix</a>();
<a name="l01024"></a>01024     } <span class="keywordflow">break</span>;
<a name="l01025"></a>01025     <span class="keywordflow">default</span>: {
<a name="l01026"></a>01026         <a class="code" href="../../d5/d6b/opennl_8c.html#a25758ac3c7485800987f4f4cb000c62d">__nl_assert_not_reached</a>;
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028     }
<a name="l01029"></a>01029 }
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 <span class="comment">/************************************************************************/</span>
<a name="l01032"></a>01032 <span class="comment">/* SuperLU wrapper */</span>
<a name="l01033"></a>01033 
<a name="l01034"></a>01034 <span class="comment">/* Note: SuperLU is difficult to call, but it is worth it.  */</span>
<a name="l01035"></a>01035 <span class="comment">/* Here is a driver inspired by A. Sheffer&#39;s &quot;cow flattener&quot;. */</span>
<a name="l01036"></a><a class="code" href="../../d5/d6b/opennl_8c.html#af476f63c01155820758a83c09ef56a31">01036</a> <span class="keyword">static</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../d5/d6b/opennl_8c.html#af476f63c01155820758a83c09ef56a31">__nlFactorize_SUPERLU</a>(<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context, <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> *permutation) {
<a name="l01037"></a>01037 
<a name="l01038"></a>01038     <span class="comment">/* OpenNL Context */</span>
<a name="l01039"></a>01039     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a> = (context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>)? &amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#af83379748954234f16f9bb020fa4705d">MtM</a>: &amp;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>;
<a name="l01040"></a>01040     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>;
<a name="l01041"></a>01041     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> nnz = <a class="code" href="../../d5/d6b/opennl_8c.html#a9123ed4d00293a004ce409308c44cf83">__nlSparseMatrixNNZ</a>(M); <span class="comment">/* number of non-zero coeffs */</span>
<a name="l01042"></a>01042 
<a name="l01043"></a>01043     <span class="comment">/* Compressed Row Storage matrix representation */</span>
<a name="l01044"></a>01044     <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>   *xa     = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>, n+1);
<a name="l01045"></a>01045     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> *rhs    = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, n);
<a name="l01046"></a>01046     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a> *a      = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>, nnz);
<a name="l01047"></a>01047     <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>   *asub   = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>, nnz);
<a name="l01048"></a>01048     <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>   *etree  = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>, n);
<a name="l01049"></a>01049 
<a name="l01050"></a>01050     <span class="comment">/* SuperLU variables */</span>
<a name="l01051"></a>01051     <a class="code" href="../../d8/d79/structSuperMatrix.html">SuperMatrix</a> At, AtP;
<a name="l01052"></a>01052     <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> info, panel_size, relax;
<a name="l01053"></a>01053     <a class="code" href="../../d8/dc6/structsuperlu__options__t.html">superlu_options_t</a> <a class="code" href="../../d3/d77/cycles__test_8cpp.html#ae5dd30972ef2b22e7bb03125f3c4a8c8">options</a>;
<a name="l01054"></a>01054 
<a name="l01055"></a>01055     <span class="comment">/* Temporary variables */</span>
<a name="l01056"></a>01056     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, jj, count;
<a name="l01057"></a>01057     
<a name="l01058"></a>01058     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(!(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#afd84cb6981d0905d96ae9c1880bd88fc">__NL_SYMMETRIC</a>));
<a name="l01059"></a>01059     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#ad66e816adef2884456ff66d98f662d1f">storage</a> &amp; <a class="code" href="../../d5/d6b/opennl_8c.html#aba8bdff0f5e9034efb0ce64373773926">__NL_ROWS</a>);
<a name="l01060"></a>01060     <a class="code" href="../../d5/d6b/opennl_8c.html#ab84d82f8348e12ab5f9071548ab1cc04">__nl_assert</a>(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a45e416ddd1e447829978770232b647fa">m</a> == M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a78a915f471f62e7ed46c0d12e10088cf">n</a>);
<a name="l01061"></a>01061     
<a name="l01062"></a>01062     <span class="comment">/* Convert M to compressed column format */</span>
<a name="l01063"></a>01063     <span class="keywordflow">for</span>(i=0, count=0; i&lt;n; i++) {
<a name="l01064"></a>01064         <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a> *Ri = M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a> + <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l01065"></a>01065         xa[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = count;
<a name="l01066"></a>01066 
<a name="l01067"></a>01067         <span class="keywordflow">for</span>(jj=0; jj&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; jj++, count++) {
<a name="l01068"></a>01068             a[count] = Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[jj].<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a>;
<a name="l01069"></a>01069             asub[count] = Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[jj].<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>;
<a name="l01070"></a>01070         }
<a name="l01071"></a>01071     }
<a name="l01072"></a>01072     xa[n] = nnz;
<a name="l01073"></a>01073 
<a name="l01074"></a>01074     <span class="comment">/* Free M, don&#39;t need it anymore at this point */</span>
<a name="l01075"></a>01075     <a class="code" href="../../d5/d6b/opennl_8c.html#a4612d5ec08be70e0fed1e9b2ea68a490">__nlSparseMatrixClear</a>(M);
<a name="l01076"></a>01076 
<a name="l01077"></a>01077     <span class="comment">/* Create superlu A matrix transposed */</span>
<a name="l01078"></a>01078     <a class="code" href="../../d9/d07/ssp__defs_8h.html#abb3d30eea43abc536793244e7564e70d">sCreate_CompCol_Matrix</a>(
<a name="l01079"></a>01079         &amp;At, n, n, nnz, a, asub, xa, 
<a name="l01080"></a>01080         <a class="code" href="../../d9/d61/supermatrix_8h.html#a9d2ddedeb2a3d92e950811c61d0b8796a0993c31a9ba98c523bfab0d759c1a628">SLU_NC</a>,     <span class="comment">/* Colum wise, no supernode */</span>
<a name="l01081"></a>01081         <a class="code" href="../../d9/d61/supermatrix_8h.html#a7987cb2a28ec879b39a90e9e48e29190a0da7fdd394e36c76e7aa215d6a79162d">SLU_S</a>,      <span class="comment">/* floats */</span> 
<a name="l01082"></a>01082         <a class="code" href="../../d9/d61/supermatrix_8h.html#a5962adac634f3feebe487ad443802d60aea9ef3cae331a60a4bcc353bb57ad5db">SLU_GE</a>      <span class="comment">/* general storage */</span>
<a name="l01083"></a>01083     );
<a name="l01084"></a>01084 
<a name="l01085"></a>01085     <span class="comment">/* Set superlu options */</span>
<a name="l01086"></a>01086     <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#a4792687285a879f7955029421ba99795">set_default_options</a>(&amp;options);
<a name="l01087"></a>01087     options.<a class="code" href="../../d8/dc6/structsuperlu__options__t.html#af6e41a7d8ca989c5396f6edc67be0409">ColPerm</a> = <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#abd17bbb14f57694750d96639e738e89ca7475651fbfee514ff59d61da9e101682">MY_PERMC</a>;
<a name="l01088"></a>01088     options.<a class="code" href="../../d8/dc6/structsuperlu__options__t.html#acbd3cc1d27bbaf5bc168ebbbd6bf60fe">Fact</a> = <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#ac785c8235480e5cfef9848d89c047c0aae0bd0c48044d1267a827ce526249e168">DOFACT</a>;
<a name="l01089"></a>01089 
<a name="l01090"></a>01090     <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#a9b8745daf1fd22070364570977fe1ccc">StatInit</a>(&amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ab56799152a4db46e78ce1a9ebb7a5cc4">stat</a>));
<a name="l01091"></a>01091 
<a name="l01092"></a>01092     panel_size = <a class="code" href="../../d8/de1/sp__ienv_8c.html#a21109476f1261abd6b256a393f5fd9e7">sp_ienv</a>(1); <span class="comment">/* sp_ienv give us the defaults */</span>
<a name="l01093"></a>01093     relax = <a class="code" href="../../d8/de1/sp__ienv_8c.html#a21109476f1261abd6b256a393f5fd9e7">sp_ienv</a>(2);
<a name="l01094"></a>01094 
<a name="l01095"></a>01095     <span class="comment">/* Compute permutation and permuted matrix */</span>
<a name="l01096"></a>01096     context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ac26e20f72c1de7e5d7465f0a3a83ddca">perm_r</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>, n);
<a name="l01097"></a>01097     context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a> = <a class="code" href="../../d5/d6b/opennl_8c.html#afd5b2d3f667bf7992fb31a9a6bb7a536">__NL_NEW_ARRAY</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>, n);
<a name="l01098"></a>01098 
<a name="l01099"></a>01099     <span class="keywordflow">if</span> ((permutation == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (*permutation == -1)) {
<a name="l01100"></a>01100         <a class="code" href="../../db/d2c/get__perm__c_8c.html#aaecb6e6e7a3e97356050bcfdf2573796">get_perm_c</a>(3, &amp;At, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a>);
<a name="l01101"></a>01101 
<a name="l01102"></a>01102         <span class="keywordflow">if</span> (permutation)
<a name="l01103"></a>01103             memcpy(permutation, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>)*n);
<a name="l01104"></a>01104     }
<a name="l01105"></a>01105     <span class="keywordflow">else</span>
<a name="l01106"></a>01106         memcpy(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a>, permutation, <span class="keyword">sizeof</span>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a>)*n);
<a name="l01107"></a>01107 
<a name="l01108"></a>01108     <a class="code" href="../../d3/d0e/sp__preorder_8c.html#ad3a9a45f02456022c7eba79e17e215bc">sp_preorder</a>(&amp;options, &amp;At, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a>, etree, &amp;AtP);
<a name="l01109"></a>01109 
<a name="l01110"></a>01110     <span class="comment">/* Decompose into L and U */</span>
<a name="l01111"></a>01111     <a class="code" href="../../d0/dba/sgstrf_8c.html#a2428d5d7ef46cf9a08069d9f55901284">sgstrf</a>(&amp;options, &amp;AtP, relax, panel_size,
<a name="l01112"></a>01112         etree, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a>, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ac26e20f72c1de7e5d7465f0a3a83ddca">perm_r</a>,
<a name="l01113"></a>01113         &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a44b8d156b60126a7cb860ce7703469ff">L</a>), &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#abc2bd0f4049be1e70fae9a6264654792">U</a>), &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ab56799152a4db46e78ce1a9ebb7a5cc4">stat</a>), &amp;info);
<a name="l01114"></a>01114 
<a name="l01115"></a>01115     <span class="comment">/* Cleanup */</span>
<a name="l01116"></a>01116 
<a name="l01117"></a>01117     <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#ac16a0aea75cf99b4d38ec4ede6f13eb4">Destroy_SuperMatrix_Store</a>(&amp;At);
<a name="l01118"></a>01118     <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#a7285ca16a0b84b4333d71efeb65c0126">Destroy_CompCol_Permuted</a>(&amp;AtP);
<a name="l01119"></a>01119 
<a name="l01120"></a>01120     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(etree);
<a name="l01121"></a>01121     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(xa);
<a name="l01122"></a>01122     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(rhs);
<a name="l01123"></a>01123     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(a);
<a name="l01124"></a>01124     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(asub);
<a name="l01125"></a>01125 
<a name="l01126"></a>01126     context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a8163f31baa76d249e970b12b0b369060">alloc_slu</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l01127"></a>01127 
<a name="l01128"></a>01128     <span class="keywordflow">return</span> (info == 0);
<a name="l01129"></a>01129 }
<a name="l01130"></a>01130 
<a name="l01131"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a849673e81f497f5f990ab6fb1e610ba8">01131</a> <span class="keyword">static</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../d5/d6b/opennl_8c.html#a849673e81f497f5f990ab6fb1e610ba8">__nlInvert_SUPERLU</a>(<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context) {
<a name="l01132"></a>01132 
<a name="l01133"></a>01133     <span class="comment">/* OpenNL Context */</span>
<a name="l01134"></a>01134     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* b = (context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a634d08594b4a37eb7914a25e42ab9f9f">least_squares</a>)? context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#addd6fd469b2ae54120f6c168327810c8">Mtb</a>: context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a>;
<a name="l01135"></a>01135     <a class="code" href="../../db/dde/ONL__opennl_8h.html#aa584b601ad6feb28565b4add3417ef5a">NLfloat</a>* x = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ae82de19e99d31be082eb383b5210ff3f">x</a>;
<a name="l01136"></a>01136     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>, j;
<a name="l01137"></a>01137 
<a name="l01138"></a>01138     <span class="comment">/* SuperLU variables */</span>
<a name="l01139"></a>01139     <a class="code" href="../../d8/d79/structSuperMatrix.html">SuperMatrix</a> <a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a>;
<a name="l01140"></a>01140     <a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> info = 0;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142     <span class="keywordflow">for</span>(j=0; j&lt;context-&gt;nb_rhs; j++, b+=n, x+=n) {
<a name="l01143"></a>01143         <span class="comment">/* Create superlu array for B */</span>
<a name="l01144"></a>01144         <a class="code" href="../../d9/d07/ssp__defs_8h.html#aca98118f5539f098beff0b70c041c2e6">sCreate_Dense_Matrix</a>(
<a name="l01145"></a>01145             &amp;<a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a>, n, 1, b, n, 
<a name="l01146"></a>01146             <a class="code" href="../../d9/d61/supermatrix_8h.html#a9d2ddedeb2a3d92e950811c61d0b8796aa59ca236b51fe0c7bd7c80c70e345768">SLU_DN</a>, <span class="comment">/* Fortran-type column-wise storage */</span>
<a name="l01147"></a>01147             <a class="code" href="../../d9/d61/supermatrix_8h.html#a7987cb2a28ec879b39a90e9e48e29190a0da7fdd394e36c76e7aa215d6a79162d">SLU_S</a>,  <span class="comment">/* floats                         */</span>
<a name="l01148"></a>01148             <a class="code" href="../../d9/d61/supermatrix_8h.html#a5962adac634f3feebe487ad443802d60aea9ef3cae331a60a4bcc353bb57ad5db">SLU_GE</a>  <span class="comment">/* general                        */</span>
<a name="l01149"></a>01149         );
<a name="l01150"></a>01150 
<a name="l01151"></a>01151         <span class="comment">/* Forward/Back substitution to compute x */</span>
<a name="l01152"></a>01152         <a class="code" href="../../d7/d9d/sgstrs_8c.html#a9b6e1e555af9cf109ef3a584054a91e2">sgstrs</a>(<a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a0c4e17b2d5cea33f9991ccc6a6678d62a1f61e3015bfe0f0c2c3fda4c5a0cdf58">TRANS</a>, &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a44b8d156b60126a7cb860ce7703469ff">L</a>), &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#abc2bd0f4049be1e70fae9a6264654792">U</a>),
<a name="l01153"></a>01153             context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a>, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ac26e20f72c1de7e5d7465f0a3a83ddca">perm_r</a>, &amp;<a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a>,
<a name="l01154"></a>01154             &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ab56799152a4db46e78ce1a9ebb7a5cc4">stat</a>), &amp;info);
<a name="l01155"></a>01155 
<a name="l01156"></a>01156         <span class="keywordflow">if</span>(info == 0)
<a name="l01157"></a>01157             memcpy(x, ((<a class="code" href="../../da/d7e/structDNformat.html">DNformat</a>*)<a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a>.Store)-&gt;nzval, <span class="keyword">sizeof</span>(*x)*n);
<a name="l01158"></a>01158 
<a name="l01159"></a>01159         <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#ac16a0aea75cf99b4d38ec4ede6f13eb4">Destroy_SuperMatrix_Store</a>(&amp;<a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a>);
<a name="l01160"></a>01160     }
<a name="l01161"></a>01161 
<a name="l01162"></a>01162     <span class="keywordflow">return</span> (info == 0);
<a name="l01163"></a>01163 }
<a name="l01164"></a>01164 
<a name="l01165"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a63e2c7da32dfbbd667e5b5c367af6c4c">01165</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d6b/opennl_8c.html#a63e2c7da32dfbbd667e5b5c367af6c4c">__nlFree_SUPERLU</a>(<a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context) {
<a name="l01166"></a>01166 
<a name="l01167"></a>01167     <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#aea724a390aed4ef00a4b8ed783c60014">Destroy_SuperNode_Matrix</a>(&amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a44b8d156b60126a7cb860ce7703469ff">L</a>));
<a name="l01168"></a>01168     <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#a27491a8171a480d6c98e6d1e535e1973">Destroy_CompCol_Matrix</a>(&amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#abc2bd0f4049be1e70fae9a6264654792">U</a>));
<a name="l01169"></a>01169 
<a name="l01170"></a>01170     <a class="code" href="../../d1/dc6/intern_2opennl_2superlu_2util_8c.html#a7d50e009f6f1f4ba8a63cdd912a0d31d">StatFree</a>(&amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ab56799152a4db46e78ce1a9ebb7a5cc4">stat</a>));
<a name="l01171"></a>01171 
<a name="l01172"></a>01172     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#ac26e20f72c1de7e5d7465f0a3a83ddca">perm_r</a>);
<a name="l01173"></a>01173     <a class="code" href="../../d5/d6b/opennl_8c.html#ab3986b8739352fabfc9eb1f5079a40f7">__NL_DELETE_ARRAY</a>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#af3207d3615531cde3c58cd036beec3bc">perm_c</a>);
<a name="l01174"></a>01174 
<a name="l01175"></a>01175     context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a98957aba48ec8a131ec559c99758d99c">slu</a>.<a class="code" href="../../db/d2a/struct____NLContext_1_1____NLSuperLUContext.html#a8163f31baa76d249e970b12b0b369060">alloc_slu</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#a0907391e671bc8a56d27a1a3c8c33c12">NL_FALSE</a>;
<a name="l01176"></a>01176 }
<a name="l01177"></a>01177 
<a name="l01178"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a02ef63e101f56a596217bbdab889f351">01178</a> <span class="keywordtype">void</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#a02ef63e101f56a596217bbdab889f351">nlPrintMatrix</a>(<span class="keywordtype">void</span>) {
<a name="l01179"></a>01179     <a class="code" href="../../d2/d5c/struct____NLContext.html">__NLContext</a> *context = <a class="code" href="../../d5/d6b/opennl_8c.html#af11dd4df12d5afbf46984c59abf9feec">__nlCurrentContext</a>;
<a name="l01180"></a>01180     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* <a class="code" href="../../d3/d41/mathutils__noise_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>  = &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a20a491299de1b188ecacbd5539234922">M</a>);
<a name="l01181"></a>01181     <a class="code" href="../../db/d64/struct____NLSparseMatrix.html">__NLSparseMatrix</a>* MtM  = &amp;(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#af83379748954234f16f9bb020fa4705d">MtM</a>);
<a name="l01182"></a>01182     <span class="keywordtype">float</span> *b = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#ad2c116409486c52c740e82fe9f4e66a3">b</a>;
<a name="l01183"></a>01183     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, jj, k;
<a name="l01184"></a>01184     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> m = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#adf849a25da8d583ea629c2412fc15d44">m</a>;
<a name="l01185"></a>01185     <a class="code" href="../../db/dde/ONL__opennl_8h.html#a97880d4c4029ac558eb96b59abe2f8cf">NLuint</a> n = context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>;
<a name="l01186"></a>01186     <a class="code" href="../../d8/d84/struct____NLRowColumn.html">__NLRowColumn</a>* Ri = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01187"></a>01187     <span class="keywordtype">float</span> *value = malloc(<span class="keyword">sizeof</span>(*value)*(n+m));
<a name="l01188"></a>01188 
<a name="l01189"></a>01189     printf(<span class="stringliteral">&quot;A:\n&quot;</span>);
<a name="l01190"></a>01190     <span class="keywordflow">for</span>(i=0; i&lt;m; i++) {
<a name="l01191"></a>01191         Ri = &amp;(M-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l01192"></a>01192 
<a name="l01193"></a>01193         memset(value, 0.0, <span class="keyword">sizeof</span>(*value)*n);
<a name="l01194"></a>01194         <span class="keywordflow">for</span>(jj=0; jj&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; jj++)
<a name="l01195"></a>01195             value[Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[jj].<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>] = Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[jj].<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a>;
<a name="l01196"></a>01196 
<a name="l01197"></a>01197         for (k = 0; k&lt;n; k++)
<a name="l01198"></a>01198             printf(<span class="stringliteral">&quot;%.3f &quot;</span>, value[k]);
<a name="l01199"></a>01199         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01200"></a>01200     }
<a name="l01201"></a>01201 
<a name="l01202"></a>01202     <span class="keywordflow">for</span>(k=0; k&lt;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>; k++) {
<a name="l01203"></a>01203         printf(<span class="stringliteral">&quot;b (%d):\n&quot;</span>, k);
<a name="l01204"></a>01204         <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
<a name="l01205"></a>01205             printf(<span class="stringliteral">&quot;%f &quot;</span>, b[context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>*k + i]);
<a name="l01206"></a>01206         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01207"></a>01207     }
<a name="l01208"></a>01208 
<a name="l01209"></a>01209     <span class="keywordflow">if</span>(context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a8144619a6fef56e6b514ab5be571e861">alloc_MtM</a>) {
<a name="l01210"></a>01210         printf(<span class="stringliteral">&quot;AtA:\n&quot;</span>);
<a name="l01211"></a>01211         <span class="keywordflow">for</span>(i=0; i&lt;n; i++) {
<a name="l01212"></a>01212             Ri = &amp;(MtM-&gt;<a class="code" href="../../db/d64/struct____NLSparseMatrix.html#a0e205fc35685402785dc6a8ceb41759a">row</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l01213"></a>01213 
<a name="l01214"></a>01214             memset(value, 0.0, <span class="keyword">sizeof</span>(*value)*m);
<a name="l01215"></a>01215             <span class="keywordflow">for</span>(jj=0; jj&lt;Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#a3f7f456ac79d234c09ff4657b6ec251f">size</a>; jj++)
<a name="l01216"></a>01216                 value[Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[jj].<a class="code" href="../../d0/d42/struct____NLCoeff.html#aa156f3097fda7ad4b27d4571ec92f789">index</a>] = Ri-&gt;<a class="code" href="../../d8/d84/struct____NLRowColumn.html#af6f5289a39007ce1038c2b78a1fbbb41">coeff</a>[jj].<a class="code" href="../../d0/d42/struct____NLCoeff.html#a6acc35f80f36c6a69de1604e91d52e6d">value</a>;
<a name="l01217"></a>01217 
<a name="l01218"></a>01218             for (k = 0; k&lt;n; k++)
<a name="l01219"></a>01219                 printf(<span class="stringliteral">&quot;%.3f &quot;</span>, value[k]);
<a name="l01220"></a>01220             printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01221"></a>01221         }
<a name="l01222"></a>01222 
<a name="l01223"></a>01223         <span class="keywordflow">for</span>(k=0; k&lt;context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#aba773568f286a54511a8186ad477b427">nb_rhs</a>; k++) {
<a name="l01224"></a>01224             printf(<span class="stringliteral">&quot;Mtb (%d):\n&quot;</span>, k);
<a name="l01225"></a>01225             <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
<a name="l01226"></a>01226                 printf(<span class="stringliteral">&quot;%f &quot;</span>, context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#addd6fd469b2ae54120f6c168327810c8">Mtb</a>[context-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a19c1416e30d818bac85c05df38b3c1dc">n</a>*k + i]);
<a name="l01227"></a>01227             printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01228"></a>01228         }
<a name="l01229"></a>01229         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01230"></a>01230     }
<a name="l01231"></a>01231 
<a name="l01232"></a>01232     free(value);
<a name="l01233"></a>01233 }
<a name="l01234"></a>01234 
<a name="l01235"></a>01235 <span class="comment">/************************************************************************/</span>
<a name="l01236"></a>01236 <span class="comment">/* nlSolve() driver routine */</span>
<a name="l01237"></a>01237 
<a name="l01238"></a><a class="code" href="../../d5/d6b/opennl_8c.html#afae449d3ffbd41c2fdabaf7602e6bbb9">01238</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#afae449d3ffbd41c2fdabaf7602e6bbb9">nlSolveAdvanced</a>(<a class="code" href="../../db/dde/ONL__opennl_8h.html#abcd59f4fe86239cad24a44a2b14d77a2">NLint</a> *permutation, <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> solveAgain) {
<a name="l01239"></a>01239     <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> result = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l01240"></a>01240 
<a name="l01241"></a>01241     <a class="code" href="../../d5/d6b/opennl_8c.html#a029314b0640edde299edd6bf38f05779">__nlCheckState</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a7efb56fe0cf28aed935c4ca3bafee343">__NL_STATE_SYSTEM_CONSTRUCTED</a>);
<a name="l01242"></a>01242 
<a name="l01243"></a>01243     <span class="keywordflow">if</span> (!__nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">solve_again</a>)
<a name="l01244"></a>01244         result = <a class="code" href="../../d5/d6b/opennl_8c.html#af476f63c01155820758a83c09ef56a31">__nlFactorize_SUPERLU</a>(__nlCurrentContext, permutation);
<a name="l01245"></a>01245 
<a name="l01246"></a>01246     <span class="keywordflow">if</span> (result) {
<a name="l01247"></a>01247         result = <a class="code" href="../../d5/d6b/opennl_8c.html#a849673e81f497f5f990ab6fb1e610ba8">__nlInvert_SUPERLU</a>(__nlCurrentContext);
<a name="l01248"></a>01248 
<a name="l01249"></a>01249         <span class="keywordflow">if</span> (result) {
<a name="l01250"></a>01250             <a class="code" href="../../d5/d6b/opennl_8c.html#aa0c083520823a3d79bc5cd6e2c4ad6ea">__nlVectorToVariables</a>();
<a name="l01251"></a>01251 
<a name="l01252"></a>01252             <span class="keywordflow">if</span> (solveAgain)
<a name="l01253"></a>01253                 __nlCurrentContext-&gt;<a class="code" href="../../d2/d5c/struct____NLContext.html#a565c91edb8d118cb8978ea61b533c2ec">solve_again</a> = <a class="code" href="../../db/dde/ONL__opennl_8h.html#ab803a6e79704c5027f50a830dc341d0c">NL_TRUE</a>;
<a name="l01254"></a>01254 
<a name="l01255"></a>01255             <a class="code" href="../../d5/d6b/opennl_8c.html#a6856434de0883f94c5a584ae24bda667">__nlTransition</a>(<a class="code" href="../../d5/d6b/opennl_8c.html#a7efb56fe0cf28aed935c4ca3bafee343">__NL_STATE_SYSTEM_CONSTRUCTED</a>, <a class="code" href="../../d5/d6b/opennl_8c.html#a0e64d144290a7e0c4ae4594f8138c0a3">__NL_STATE_SYSTEM_SOLVED</a>);
<a name="l01256"></a>01256         }
<a name="l01257"></a>01257     }
<a name="l01258"></a>01258 
<a name="l01259"></a>01259     <span class="keywordflow">return</span> result;
<a name="l01260"></a>01260 }
<a name="l01261"></a>01261 
<a name="l01262"></a><a class="code" href="../../d5/d6b/opennl_8c.html#a279fb9282a5cd8852bad29403df14d88">01262</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#ac7d6bf170a83fed9c2e8c97885b0ed88">NLboolean</a> <a class="code" href="../../db/dde/ONL__opennl_8h.html#aef6b6362d96851dc89b3eb40c9808ba6">nlSolve</a>() {
<a name="l01263"></a>01263     <span class="keywordflow">return</span> <a class="code" href="../../db/dde/ONL__opennl_8h.html#afae449d3ffbd41c2fdabaf7602e6bbb9">nlSolveAdvanced</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../db/dde/ONL__opennl_8h.html#a0907391e671bc8a56d27a1a3c8c33c12">NL_FALSE</a>);
<a name="l01264"></a>01264 }
<a name="l01265"></a>01265 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:42 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
