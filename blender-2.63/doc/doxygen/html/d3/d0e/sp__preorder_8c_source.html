<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: sp_preorder.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">sp_preorder.c</div>  </div>
</div>
<div class="contents">
<a href="../../d3/d0e/sp__preorder_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d07/ssp__defs_8h.html">ssp_defs.h</a>&quot;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="keywordtype">int</span> <a class="code" href="../../d3/d0e/sp__preorder_8c.html#acea4c23184563446c1e24428402d65f6">check_perm</a>(<span class="keywordtype">char</span> *, <span class="keywordtype">int</span> , <span class="keywordtype">int</span> *);
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="keywordtype">void</span>
<a name="l00010"></a><a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#adf9c573cbfb4520a5ea820702d27cfa5">00010</a> <a class="code" href="../../d3/d0e/sp__preorder_8c.html#ad3a9a45f02456022c7eba79e17e215bc">sp_preorder</a>(<a class="code" href="../../d8/dc6/structsuperlu__options__t.html">superlu_options_t</a> *<a class="code" href="../../d3/d77/cycles__test_8cpp.html#ae5dd30972ef2b22e7bb03125f3c4a8c8">options</a>,  <a class="code" href="../../d8/d79/structSuperMatrix.html">SuperMatrix</a> *A, <span class="keywordtype">int</span> *perm_c, 
<a name="l00011"></a>00011         <span class="keywordtype">int</span> *etree, <a class="code" href="../../d8/d79/structSuperMatrix.html">SuperMatrix</a> *AC)
<a name="l00012"></a>00012 {
<a name="l00013"></a>00013 <span class="comment">/*</span>
<a name="l00014"></a>00014 <span class="comment"> * Purpose</span>
<a name="l00015"></a>00015 <span class="comment"> * =======</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * sp_preorder() permutes the columns of the original matrix. It performs</span>
<a name="l00018"></a>00018 <span class="comment"> * the following steps:</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> *    1. Apply column permutation perm_c[] to A&#39;s column pointers to form AC;</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> *    2. If options-&gt;Fact = DOFACT, then</span>
<a name="l00023"></a>00023 <span class="comment"> *       (1) Compute column elimination tree etree[] of AC&#39;AC;</span>
<a name="l00024"></a>00024 <span class="comment"> *       (2) Post order etree[] to get a postordered elimination tree etree[],</span>
<a name="l00025"></a>00025 <span class="comment"> *           and a postorder permutation post[];</span>
<a name="l00026"></a>00026 <span class="comment"> *       (3) Apply post[] permutation to columns of AC;</span>
<a name="l00027"></a>00027 <span class="comment"> *       (4) Overwrite perm_c[] with the product perm_c * post.</span>
<a name="l00028"></a>00028 <span class="comment"> *</span>
<a name="l00029"></a>00029 <span class="comment"> * Arguments</span>
<a name="l00030"></a>00030 <span class="comment"> * =========</span>
<a name="l00031"></a>00031 <span class="comment"> *</span>
<a name="l00032"></a>00032 <span class="comment"> * options (input) superlu_options_t*</span>
<a name="l00033"></a>00033 <span class="comment"> *         Specifies whether or not the elimination tree will be re-used.</span>
<a name="l00034"></a>00034 <span class="comment"> *         If options-&gt;Fact == DOFACT, this means first time factor A, </span>
<a name="l00035"></a>00035 <span class="comment"> *         etree is computed, postered, and output.</span>
<a name="l00036"></a>00036 <span class="comment"> *         Otherwise, re-factor A, etree is input, unchanged on exit.</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> * A       (input) SuperMatrix*</span>
<a name="l00039"></a>00039 <span class="comment"> *         Matrix A in A*X=B, of dimension (A-&gt;nrow, A-&gt;ncol). The number</span>
<a name="l00040"></a>00040 <span class="comment"> *         of the linear equations is A-&gt;nrow. Currently, the type of A can be:</span>
<a name="l00041"></a>00041 <span class="comment"> *         Stype = NC or SLU_NCP; Mtype = SLU_GE.</span>
<a name="l00042"></a>00042 <span class="comment"> *         In the future, more general A may be handled.</span>
<a name="l00043"></a>00043 <span class="comment"> *</span>
<a name="l00044"></a>00044 <span class="comment"> * perm_c  (input/output) int*</span>
<a name="l00045"></a>00045 <span class="comment"> *     Column permutation vector of size A-&gt;ncol, which defines the </span>
<a name="l00046"></a>00046 <span class="comment"> *         permutation matrix Pc; perm_c[i] = j means column i of A is </span>
<a name="l00047"></a>00047 <span class="comment"> *         in position j in A*Pc.</span>
<a name="l00048"></a>00048 <span class="comment"> *         If options-&gt;Fact == DOFACT, perm_c is both input and output.</span>
<a name="l00049"></a>00049 <span class="comment"> *         On output, it is changed according to a postorder of etree.</span>
<a name="l00050"></a>00050 <span class="comment"> *         Otherwise, perm_c is input.</span>
<a name="l00051"></a>00051 <span class="comment"> *</span>
<a name="l00052"></a>00052 <span class="comment"> * etree   (input/output) int*</span>
<a name="l00053"></a>00053 <span class="comment"> *         Elimination tree of Pc&#39;*A&#39;*A*Pc, dimension A-&gt;ncol.</span>
<a name="l00054"></a>00054 <span class="comment"> *         If options-&gt;Fact == DOFACT, etree is an output argument,</span>
<a name="l00055"></a>00055 <span class="comment"> *         otherwise it is an input argument.</span>
<a name="l00056"></a>00056 <span class="comment"> *         Note: etree is a vector of parent pointers for a forest whose</span>
<a name="l00057"></a>00057 <span class="comment"> *         vertices are the integers 0 to A-&gt;ncol-1; etree[root]==A-&gt;ncol.</span>
<a name="l00058"></a>00058 <span class="comment"> *</span>
<a name="l00059"></a>00059 <span class="comment"> * AC      (output) SuperMatrix*</span>
<a name="l00060"></a>00060 <span class="comment"> *         The resulting matrix after applied the column permutation</span>
<a name="l00061"></a>00061 <span class="comment"> *         perm_c[] to matrix A. The type of AC can be:</span>
<a name="l00062"></a>00062 <span class="comment"> *         Stype = SLU_NCP; Dtype = A-&gt;Dtype; Mtype = SLU_GE.</span>
<a name="l00063"></a>00063 <span class="comment"> *</span>
<a name="l00064"></a>00064 <span class="comment"> */</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <a class="code" href="../../d6/d61/structNCformat.html">NCformat</a>  *Astore;
<a name="l00067"></a>00067     <a class="code" href="../../d6/d92/structNCPformat.html">NCPformat</a> *ACstore;
<a name="l00068"></a>00068     <span class="keywordtype">int</span>       *iwork, *<a class="code" href="../../d0/dea/sp__coletree_8c.html#ab6c0f6f7a979ede50dae233792e4efc7">post</a>;
<a name="l00069"></a>00069     <span class="keyword">register</span>  <span class="keywordtype">int</span> n, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     n = A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab8b85bf206c36ebc2223cc2ec6acbe8c">ncol</a>;
<a name="l00072"></a>00072     
<a name="l00073"></a>00073     <span class="comment">/* Apply column permutation perm_c to A&#39;s column pointers so to</span>
<a name="l00074"></a>00074 <span class="comment">       obtain NCP format in AC = A*Pc.  */</span>
<a name="l00075"></a>00075     AC-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab37e181824f50a405272451afc399952">Stype</a>       = <a class="code" href="../../d9/d61/supermatrix_8h.html#a9d2ddedeb2a3d92e950811c61d0b8796a25e4eb65ac258dadb9abccd65337cfe4">SLU_NCP</a>;
<a name="l00076"></a>00076     AC-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#aedd4bd451819549620b49076a62dfdcc">Dtype</a>       = A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#aedd4bd451819549620b49076a62dfdcc">Dtype</a>;
<a name="l00077"></a>00077     AC-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#a42877db0cfad1033374474f48e4b3fc4">Mtype</a>       = A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#a42877db0cfad1033374474f48e4b3fc4">Mtype</a>;
<a name="l00078"></a>00078     AC-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab1d854b814f0757e7ff7e0da01c6ef43">nrow</a>        = A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab1d854b814f0757e7ff7e0da01c6ef43">nrow</a>;
<a name="l00079"></a>00079     AC-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab8b85bf206c36ebc2223cc2ec6acbe8c">ncol</a>        = A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab8b85bf206c36ebc2223cc2ec6acbe8c">ncol</a>;
<a name="l00080"></a>00080     Astore          = A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#a73ebca1b46bb24536226b9378e01c5b5">Store</a>;
<a name="l00081"></a>00081     ACstore = AC-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#a73ebca1b46bb24536226b9378e01c5b5">Store</a> = (<span class="keywordtype">void</span> *) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a55a5ed83733c30850c14cc7b3f922a54">SUPERLU_MALLOC</a>( <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d92/structNCPformat.html">NCPformat</a>) );
<a name="l00082"></a>00082     <span class="keywordflow">if</span> ( !ACstore ) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#aa4b133a54309e2c6e4ba69f3ff1141c2">ABORT</a>(<span class="stringliteral">&quot;SUPERLU_MALLOC fails for ACstore&quot;</span>);
<a name="l00083"></a>00083     ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#ac8c12ffc9edd0906608612727ad406ed">nnz</a>    = Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#affa2566dd89ea8ce6422f788887b5b27">nnz</a>;
<a name="l00084"></a>00084     ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a519ed66fdf9da30c76c079474503c764">nzval</a>  = Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#aa3e85810bb190b7359d8aaa956a64e64">nzval</a>;
<a name="l00085"></a>00085     ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a8a27cd5a756bc313cc3c487a84e8ba30">rowind</a> = Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#a16eb8492bb5694035ef3e620ea8c77b1">rowind</a>;
<a name="l00086"></a>00086     ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a2192334a0f76d4c18784caa1f8783f01">colbeg</a> = (<span class="keywordtype">int</span>*) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a55a5ed83733c30850c14cc7b3f922a54">SUPERLU_MALLOC</a>(n*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00087"></a>00087     <span class="keywordflow">if</span> ( !(ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a2192334a0f76d4c18784caa1f8783f01">colbeg</a>) ) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#aa4b133a54309e2c6e4ba69f3ff1141c2">ABORT</a>(<span class="stringliteral">&quot;SUPERLU_MALLOC fails for ACstore-&gt;colbeg&quot;</span>);
<a name="l00088"></a>00088     ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a86dcc41e83595a12ecd88d57748430c0">colend</a> = (<span class="keywordtype">int</span>*) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a55a5ed83733c30850c14cc7b3f922a54">SUPERLU_MALLOC</a>(n*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00089"></a>00089     <span class="keywordflow">if</span> ( !(ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a86dcc41e83595a12ecd88d57748430c0">colend</a>) ) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#aa4b133a54309e2c6e4ba69f3ff1141c2">ABORT</a>(<span class="stringliteral">&quot;SUPERLU_MALLOC fails for ACstore-&gt;colend&quot;</span>);
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span>    <a class="code" href="../../d9/d07/ssp__defs_8h.html#aac67c35b47f2aa92a3202769d3eebdeb">print_int_vec</a>(<span class="stringliteral">&quot;pre_order:&quot;</span>, n, perm_c);
<a name="l00093"></a>00093     <a class="code" href="../../d3/d0e/sp__preorder_8c.html#acea4c23184563446c1e24428402d65f6">check_perm</a>(<span class="stringliteral">&quot;Initial perm_c&quot;</span>, n, perm_c);
<a name="l00094"></a>00094 <span class="preprocessor">#endif      </span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00096"></a>00096     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l00097"></a>00097     ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a2192334a0f76d4c18784caa1f8783f01">colbeg</a>[perm_c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#a881f460e39f34bbbf70909b6b0629adc">colptr</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; 
<a name="l00098"></a>00098     ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a86dcc41e83595a12ecd88d57748430c0">colend</a>[perm_c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#a881f460e39f34bbbf70909b6b0629adc">colptr</a>[i+1];
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100     
<a name="l00101"></a>00101     <span class="keywordflow">if</span> ( options-&gt;<a class="code" href="../../d8/dc6/structsuperlu__options__t.html#acbd3cc1d27bbaf5bc168ebbbd6bf60fe">Fact</a> == <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#ac785c8235480e5cfef9848d89c047c0aae0bd0c48044d1267a827ce526249e168">DOFACT</a> ) {
<a name="l00102"></a>00102 <span class="preprocessor">#undef ETREE_ATplusA</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span><span class="preprocessor">#ifdef ETREE_ATplusA</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span>        <span class="comment">/*--------------------------------------------</span>
<a name="l00105"></a>00105 <span class="comment">      COMPUTE THE ETREE OF Pc*(A&#39;+A)*Pc&#39;.</span>
<a name="l00106"></a>00106 <span class="comment">      --------------------------------------------*/</span>
<a name="l00107"></a>00107         <span class="keywordtype">int</span> *b_colptr, *b_rowind, bnz, j;
<a name="l00108"></a>00108     <span class="keywordtype">int</span> *c_colbeg, *c_colend;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110         <span class="comment">/*printf(&quot;Use etree(A&#39;+A)\n&quot;);*/</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112     <span class="comment">/* Form B = A + A&#39;. */</span>
<a name="l00113"></a>00113     <a class="code" href="../../db/d2c/get__perm__c_8c.html#af136e9a2580cd3a7767e6b8a78e35a92">at_plus_a</a>(n, Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#affa2566dd89ea8ce6422f788887b5b27">nnz</a>, Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#a881f460e39f34bbbf70909b6b0629adc">colptr</a>, Astore-&gt;<a class="code" href="../../d6/d61/structNCformat.html#a16eb8492bb5694035ef3e620ea8c77b1">rowind</a>,
<a name="l00114"></a>00114           &amp;bnz, &amp;b_colptr, &amp;b_rowind);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="comment">/* Form C = Pc*B*Pc&#39;. */</span>
<a name="l00117"></a>00117     c_colbeg = (<span class="keywordtype">int</span>*) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a55a5ed83733c30850c14cc7b3f922a54">SUPERLU_MALLOC</a>(2*n*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00118"></a>00118     c_colend = c_colbeg + n;
<a name="l00119"></a>00119     <span class="keywordflow">if</span> (!c_colbeg ) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#aa4b133a54309e2c6e4ba69f3ff1141c2">ABORT</a>(<span class="stringliteral">&quot;SUPERLU_MALLOC fails for c_colbeg/c_colend&quot;</span>);
<a name="l00120"></a>00120     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l00121"></a>00121         c_colbeg[perm_c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = b_colptr[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; 
<a name="l00122"></a>00122         c_colend[perm_c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = b_colptr[i+1];
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124     <span class="keywordflow">for</span> (j = 0; j &lt; n; ++j) {
<a name="l00125"></a>00125         <span class="keywordflow">for</span> (i = c_colbeg[j]; i &lt; c_colend[j]; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {
<a name="l00126"></a>00126             b_rowind[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = perm_c[b_rowind[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]];
<a name="l00127"></a>00127         }
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     <span class="comment">/* Compute etree of C. */</span>
<a name="l00131"></a>00131     <a class="code" href="../../d0/dea/sp__coletree_8c.html#a657d6b291654432e815392c2a00d2b84">sp_symetree</a>(c_colbeg, c_colend, b_rowind, n, etree);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a9672c5511c3efd9467e4d375a347c192">SUPERLU_FREE</a>(b_colptr);
<a name="l00134"></a>00134     <span class="keywordflow">if</span> ( bnz ) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a9672c5511c3efd9467e4d375a347c192">SUPERLU_FREE</a>(b_rowind);
<a name="l00135"></a>00135     <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a9672c5511c3efd9467e4d375a347c192">SUPERLU_FREE</a>(c_colbeg);
<a name="l00136"></a>00136     
<a name="l00137"></a>00137 <span class="preprocessor">#else</span>
<a name="l00138"></a>00138 <span class="preprocessor"></span>        <span class="comment">/*--------------------------------------------</span>
<a name="l00139"></a>00139 <span class="comment">      COMPUTE THE COLUMN ELIMINATION TREE.</span>
<a name="l00140"></a>00140 <span class="comment">      --------------------------------------------*/</span>
<a name="l00141"></a>00141     <a class="code" href="../../d0/dea/sp__coletree_8c.html#aa0494ba5c3e08e41a10ce8a2d96f8c49">sp_coletree</a>(ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a2192334a0f76d4c18784caa1f8783f01">colbeg</a>, ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a86dcc41e83595a12ecd88d57748430c0">colend</a>, ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a8a27cd5a756bc313cc3c487a84e8ba30">rowind</a>,
<a name="l00142"></a>00142             A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab1d854b814f0757e7ff7e0da01c6ef43">nrow</a>, A-&gt;<a class="code" href="../../d8/d79/structSuperMatrix.html#ab8b85bf206c36ebc2223cc2ec6acbe8c">ncol</a>, etree);
<a name="l00143"></a>00143 <span class="preprocessor">#endif</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span><span class="preprocessor">#ifdef DEBUG    </span>
<a name="l00145"></a>00145 <span class="preprocessor"></span>    <a class="code" href="../../d9/d07/ssp__defs_8h.html#aac67c35b47f2aa92a3202769d3eebdeb">print_int_vec</a>(<span class="stringliteral">&quot;etree:&quot;</span>, n, etree);
<a name="l00146"></a>00146 <span class="preprocessor">#endif  </span>
<a name="l00147"></a>00147 <span class="preprocessor"></span>    
<a name="l00148"></a>00148     <span class="comment">/* In symmetric mode, do not do postorder here. */</span>
<a name="l00149"></a>00149     <span class="keywordflow">if</span> ( options-&gt;<a class="code" href="../../d8/dc6/structsuperlu__options__t.html#aad1b52d0366ae8601e97fab5c470c45d">SymmetricMode</a> == <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#ae6553118ce91b9c08f9376941ae1536fa0d077f5b932ce05e5b9f30c6087a2f31">NO</a> ) {
<a name="l00150"></a>00150         <span class="comment">/* Post order etree */</span>
<a name="l00151"></a>00151         post = (<span class="keywordtype">int</span> *) <a class="code" href="../../d0/dea/sp__coletree_8c.html#a8bf99818533bf5c192e1e4791b4700cc">TreePostorder</a>(n, etree);
<a name="l00152"></a>00152         <span class="comment">/* for (i = 0; i &lt; n+1; ++i) inv_post[post[i]] = i;</span>
<a name="l00153"></a>00153 <span class="comment">           iwork = post; */</span>
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>        <a class="code" href="../../d9/d07/ssp__defs_8h.html#aac67c35b47f2aa92a3202769d3eebdeb">print_int_vec</a>(<span class="stringliteral">&quot;post:&quot;</span>, n+1, post);
<a name="l00157"></a>00157         <a class="code" href="../../d3/d0e/sp__preorder_8c.html#acea4c23184563446c1e24428402d65f6">check_perm</a>(<span class="stringliteral">&quot;post&quot;</span>, n, post);    
<a name="l00158"></a>00158 <span class="preprocessor">#endif  </span>
<a name="l00159"></a>00159 <span class="preprocessor"></span>        iwork = (<span class="keywordtype">int</span>*) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a55a5ed83733c30850c14cc7b3f922a54">SUPERLU_MALLOC</a>((n+1)*<span class="keyword">sizeof</span>(int)); 
<a name="l00160"></a>00160         <span class="keywordflow">if</span> ( !iwork ) <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#aa4b133a54309e2c6e4ba69f3ff1141c2">ABORT</a>(<span class="stringliteral">&quot;SUPERLU_MALLOC fails for iwork[]&quot;</span>);
<a name="l00161"></a>00161 
<a name="l00162"></a>00162         <span class="comment">/* Renumber etree in postorder */</span>
<a name="l00163"></a>00163         <span class="keywordflow">for</span> (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) iwork[post[i]] = post[etree[i]];
<a name="l00164"></a>00164         <span class="keywordflow">for</span> (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) etree[i] = iwork[i];
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 <span class="preprocessor">#ifdef DEBUG    </span>
<a name="l00167"></a>00167 <span class="preprocessor"></span>        <a class="code" href="../../d9/d07/ssp__defs_8h.html#aac67c35b47f2aa92a3202769d3eebdeb">print_int_vec</a>(<span class="stringliteral">&quot;postorder etree:&quot;</span>, n, etree);
<a name="l00168"></a>00168 <span class="preprocessor">#endif</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>    
<a name="l00170"></a>00170         <span class="comment">/* Postmultiply A*Pc by post[] */</span>
<a name="l00171"></a>00171         <span class="keywordflow">for</span> (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) iwork[post[i]] = ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a2192334a0f76d4c18784caa1f8783f01">colbeg</a>[i];
<a name="l00172"></a>00172         for (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a2192334a0f76d4c18784caa1f8783f01">colbeg</a>[i] = iwork[i];
<a name="l00173"></a>00173         for (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) iwork[post[i]] = ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a86dcc41e83595a12ecd88d57748430c0">colend</a>[i];
<a name="l00174"></a>00174         for (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) ACstore-&gt;<a class="code" href="../../d6/d92/structNCPformat.html#a86dcc41e83595a12ecd88d57748430c0">colend</a>[i] = iwork[i];
<a name="l00175"></a>00175 
<a name="l00176"></a>00176         for (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00177"></a>00177             iwork[i] = post[perm_c[i]];  <span class="comment">/* product of perm_c and post */</span>
<a name="l00178"></a>00178         <span class="keywordflow">for</span> (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) perm_c[i] = iwork[i];
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>        <a class="code" href="../../d9/d07/ssp__defs_8h.html#aac67c35b47f2aa92a3202769d3eebdeb">print_int_vec</a>(<span class="stringliteral">&quot;Pc*post:&quot;</span>, n, perm_c);
<a name="l00182"></a>00182         <a class="code" href="../../d3/d0e/sp__preorder_8c.html#acea4c23184563446c1e24428402d65f6">check_perm</a>(<span class="stringliteral">&quot;final perm_c&quot;</span>, n, perm_c);  
<a name="l00183"></a>00183 <span class="preprocessor">#endif</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>        <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a9672c5511c3efd9467e4d375a347c192">SUPERLU_FREE</a> (post);
<a name="l00185"></a>00185         <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a9672c5511c3efd9467e4d375a347c192">SUPERLU_FREE</a> (iwork);
<a name="l00186"></a>00186     } <span class="comment">/* end postordering */</span>
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     } <span class="comment">/* if options-&gt;Fact == DOFACT ... */</span>
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="../../d3/d0e/sp__preorder_8c.html#acea4c23184563446c1e24428402d65f6">00192</a> <span class="keywordtype">int</span> <a class="code" href="../../d3/d0e/sp__preorder_8c.html#acea4c23184563446c1e24428402d65f6">check_perm</a>(<span class="keywordtype">char</span> *what, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> *perm)
<a name="l00193"></a>00193 {
<a name="l00194"></a>00194     <span class="keyword">register</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00195"></a>00195     <span class="keywordtype">int</span>          *marker;
<a name="l00196"></a>00196     marker = (<span class="keywordtype">int</span> *) calloc(n, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <span class="keywordflow">for</span> (i = 0; i &lt; n; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {
<a name="l00199"></a>00199     <span class="keywordflow">if</span> ( marker[perm[i]] == 1 || perm[i] &gt;= n ) {
<a name="l00200"></a>00200         printf(<span class="stringliteral">&quot;%s: Not a valid PERM[%d] = %d\n&quot;</span>, what, i, perm[i]);
<a name="l00201"></a>00201         <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#aa4b133a54309e2c6e4ba69f3ff1141c2">ABORT</a>(<span class="stringliteral">&quot;check_perm&quot;</span>);
<a name="l00202"></a>00202     } <span class="keywordflow">else</span> {
<a name="l00203"></a>00203         marker[perm[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = 1;
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <a class="code" href="../../dd/d8b/intern_2opennl_2superlu_2util_8h.html#a9672c5511c3efd9467e4d375a347c192">SUPERLU_FREE</a>(marker);
<a name="l00208"></a>00208     <span class="keywordflow">return</span> 0;
<a name="l00209"></a>00209 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:56 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
