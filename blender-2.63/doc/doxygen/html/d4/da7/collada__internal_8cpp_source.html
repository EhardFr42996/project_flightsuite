<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: collada_internal.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">collada_internal.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../d4/da7/collada__internal_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * Contributor(s): Chingiz Dyussenov, Arystanbek Dyussenov.</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00028"></a>00028 <span class="comment">/* COLLADABU_ASSERT, may be able to remove later */</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;COLLADABUPlatform.h&quot;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/da2/collada__internal_8h.html">collada_internal.h</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#a76ac13d2d657faeac8f0ae0d020bf4a9">00033</a> <a class="code" href="../../d4/d4a/classUnitConverter.html#a76ac13d2d657faeac8f0ae0d020bf4a9">UnitConverter::UnitConverter</a>() : <a class="code" href="../../d9/d27/structScene.html#abe370ff027b47b00fb8a81620639eff4">unit</a>(), up_axis(COLLADAFW::FileInfo::Z_UP) {}
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#a1fb0b83ef45f891ed7967580d1d4d619">00035</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#a1fb0b83ef45f891ed7967580d1d4d619">UnitConverter::read_asset</a>(<span class="keyword">const</span> COLLADAFW::FileInfo* asset)
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037     <a class="code" href="../../d9/d27/structScene.html#abe370ff027b47b00fb8a81620639eff4">unit</a> = asset-&gt;getUnit();
<a name="l00038"></a>00038     up_axis = asset-&gt;getUpAxisType();
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#aa259ac430326aa00efd694f608b5884f">00041</a> <a class="code" href="../../d4/d4a/classUnitConverter.html#a32a4fdf1e429b793e779ceaf809ff5b5">UnitConverter::UnitSystem</a> <a class="code" href="../../d4/d4a/classUnitConverter.html#aa259ac430326aa00efd694f608b5884f">UnitConverter::isMetricSystem</a>()
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043     <span class="keywordflow">switch</span>(<a class="code" href="../../d9/d27/structScene.html#abe370ff027b47b00fb8a81620639eff4">unit</a>.getLinearUnitUnit()) {
<a name="l00044"></a>00044         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::MILLIMETER:
<a name="l00045"></a>00045         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::CENTIMETER:
<a name="l00046"></a>00046         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::DECIMETER:
<a name="l00047"></a>00047         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::METER:
<a name="l00048"></a>00048         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::KILOMETER:
<a name="l00049"></a>00049             <span class="keywordflow">return</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#a32a4fdf1e429b793e779ceaf809ff5b5a48ef12894dbb1dff12dfdc9c2d9b5e72">UnitConverter::Metric</a>;
<a name="l00050"></a>00050         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::INCH:
<a name="l00051"></a>00051         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::FOOT:
<a name="l00052"></a>00052         <span class="keywordflow">case</span> COLLADAFW::FileInfo::Unit::YARD:
<a name="l00053"></a>00053             <span class="keywordflow">return</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#a32a4fdf1e429b793e779ceaf809ff5b5a3210af9cd319a9c6ec1cb016e393bba9">UnitConverter::Imperial</a>;
<a name="l00054"></a>00054         <span class="keywordflow">default</span>:
<a name="l00055"></a>00055             <span class="keywordflow">return</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#a32a4fdf1e429b793e779ceaf809ff5b5aaf8409c8bac575e5bf20096b472a9a8b">UnitConverter::None</a>;
<a name="l00056"></a>00056     }
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#ad4da955c063dec83260260b9026cc0ca">00059</a> <span class="keywordtype">float</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#ad4da955c063dec83260260b9026cc0ca">UnitConverter::getLinearMeter</a>()
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061     <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)<a class="code" href="../../d9/d27/structScene.html#abe370ff027b47b00fb8a81620639eff4">unit</a>.getLinearUnitMeter();
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#a82b6b25263e3ce953ef18b788b9011ab">00064</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#a82b6b25263e3ce953ef18b788b9011ab">UnitConverter::convertVector3</a>(<a class="code" href="../../df/dc6/itasc__plugin_8cpp.html#ae72edf492db315ad02943cb9feac1c8e">COLLADABU::Math::Vector3</a> &amp;vec, <span class="keywordtype">float</span> *v)
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066     v[0] = vec.x;
<a name="l00067"></a>00067     v[1] = vec.y;
<a name="l00068"></a>00068     v[2] = vec.z;
<a name="l00069"></a>00069 }
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">// TODO need also for angle conversion, time conversion...</span>
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#af978941f29335f6349b7667446f1694f">00073</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#af978941f29335f6349b7667446f1694f">UnitConverter::dae_matrix_to_mat4_</a>(<span class="keywordtype">float</span> out[][4], <span class="keyword">const</span> COLLADABU::Math::Matrix4&amp; in)
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075     <span class="comment">// in DAE, matrices use columns vectors, (see comments in COLLADABUMathMatrix4.h)</span>
<a name="l00076"></a>00076     <span class="comment">// so here, to make a blender matrix, we swap columns and rows</span>
<a name="l00077"></a>00077     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00078"></a>00078         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++) {
<a name="l00079"></a>00079             out[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j] = in[j][<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00080"></a>00080         }
<a name="l00081"></a>00081     }
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#a5aca830a5f09108de3d8fc334121ff2c">00084</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#a5aca830a5f09108de3d8fc334121ff2c">UnitConverter::mat4_to_dae</a>(<span class="keywordtype">float</span> out[][4], <span class="keywordtype">float</span> in[][4])
<a name="l00085"></a>00085 {
<a name="l00086"></a>00086     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a54d4323b3d706eb2ad167e9551ba4414">copy_m4_m4</a>(out, in);
<a name="l00087"></a>00087     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#aed30c43fde76b6b3ecbbb7ca5b5a1f93">transpose_m4</a>(out);
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="../../d4/d4a/classUnitConverter.html#a24d019078d712e1fcdd5fa59c65bb913">00090</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d4a/classUnitConverter.html#a24d019078d712e1fcdd5fa59c65bb913">UnitConverter::mat4_to_dae_double</a>(<span class="keywordtype">double</span> out[][4], <span class="keywordtype">float</span> in[][4])
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092     <span class="keywordtype">float</span> mat[4][4];
<a name="l00093"></a>00093 
<a name="l00094"></a>00094     <a class="code" href="../../d4/d4a/classUnitConverter.html#a5aca830a5f09108de3d8fc334121ff2c">mat4_to_dae</a>(mat, in);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)
<a name="l00097"></a>00097         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)
<a name="l00098"></a>00098             out[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j] = mat[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j];
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="../../d4/d03/classTransformBase.html#ac6cf33485c1bfa99b1086dea762e578a">00101</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/d03/classTransformBase.html#ac6cf33485c1bfa99b1086dea762e578a">TransformBase::decompose</a>(<span class="keywordtype">float</span> mat[][4], <span class="keywordtype">float</span> *loc, <span class="keywordtype">float</span> eul[3], <span class="keywordtype">float</span> quat[4], <span class="keywordtype">float</span> *<a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>)
<a name="l00102"></a>00102 {
<a name="l00103"></a>00103     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a245c1bf7630bef5c065994ea56751d21">mat4_to_size</a>(size, mat);
<a name="l00104"></a>00104     <span class="keywordflow">if</span> (eul) {
<a name="l00105"></a>00105         <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#abaa23f334189d294344e4c161701ddb2">mat4_to_eul</a>(eul, mat);
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107     <span class="keywordflow">if</span> (quat) {
<a name="l00108"></a>00108         <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ad76b90158227d13beb93cf29952f78a9">mat4_to_quat</a>(quat, mat);
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(loc, mat[3]);
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00122"></a><a class="code" href="../../d4/da7/collada__internal_8cpp.html#a7f2c2aa6665f96795644cd317d0032e0">00122</a> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a7f2c2aa6665f96795644cd317d0032e0">translate_start_name_map</a>[256] = {
<a name="l00123"></a>00123 95,  95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00124"></a>00124 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00125"></a>00125 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00126"></a>00126 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00127"></a>00127 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00128"></a>00128 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00129"></a>00129 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00130"></a>00130 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00131"></a>00131 65,  66,  67,  68,  69,  70,  71,  72,
<a name="l00132"></a>00132 73,  74,  75,  76,  77,  78,  79,  80,
<a name="l00133"></a>00133 81,  82,  83,  84,  85,  86,  87,  88,
<a name="l00134"></a>00134 89,  90,  95,  95,  95,  95,  95,  95,
<a name="l00135"></a>00135 97,  98,  99,  100,  101,  102,  103,  104,
<a name="l00136"></a>00136 105,  106,  107,  108,  109,  110,  111,  112,
<a name="l00137"></a>00137 113,  114,  115,  116,  117,  118,  119,  120,
<a name="l00138"></a>00138 121,  122,  95,  95,  95,  95,  95,  95,
<a name="l00139"></a>00139 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00140"></a>00140 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00141"></a>00141 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00142"></a>00142 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00143"></a>00143 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00144"></a>00144 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00145"></a>00145 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00146"></a>00146 95,  95,  95,  95,  95,  95,  95,  192,
<a name="l00147"></a>00147 193,  194,  195,  196,  197,  198,  199,  200,
<a name="l00148"></a>00148 201,  202,  203,  204,  205,  206,  207,  208,
<a name="l00149"></a>00149 209,  210,  211,  212,  213,  214,  95,  216,
<a name="l00150"></a>00150 217,  218,  219,  220,  221,  222,  223,  224,
<a name="l00151"></a>00151 225,  226,  227,  228,  229,  230,  231,  232,
<a name="l00152"></a>00152 233,  234,  235,  236,  237,  238,  239,  240,
<a name="l00153"></a>00153 241,  242,  243,  244,  245,  246,  95,  248,
<a name="l00154"></a>00154 249,  250,  251,  252,  253,  254,  255};
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="../../d4/da7/collada__internal_8cpp.html#a2918b04a905eb205e98d8eb52231acd3">00156</a> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a2918b04a905eb205e98d8eb52231acd3">translate_name_map</a>[256] = {
<a name="l00157"></a>00157 95,  95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00158"></a>00158 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00159"></a>00159 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00160"></a>00160 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00161"></a>00161 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00162"></a>00162 95,  95,  95,  95,  45,  95,  95,  48,
<a name="l00163"></a>00163 49,  50,  51,  52,  53,  54,  55,  56,
<a name="l00164"></a>00164 57,  95,  95,  95,  95,  95,  95,  95,
<a name="l00165"></a>00165 65,  66,  67,  68,  69,  70,  71,  72,
<a name="l00166"></a>00166 73,  74,  75,  76,  77,  78,  79,  80,
<a name="l00167"></a>00167 81,  82,  83,  84,  85,  86,  87,  88,
<a name="l00168"></a>00168 89,  90,  95,  95,  95,  95,  95,  95,
<a name="l00169"></a>00169 97,  98,  99,  100,  101,  102,  103,  104,
<a name="l00170"></a>00170 105,  106,  107,  108,  109,  110,  111,  112,
<a name="l00171"></a>00171 113,  114,  115,  116,  117,  118,  119,  120,
<a name="l00172"></a>00172 121,  122,  95,  95,  95,  95,  95,  95,
<a name="l00173"></a>00173 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00174"></a>00174 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00175"></a>00175 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00176"></a>00176 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00177"></a>00177 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00178"></a>00178 95,  95,  95,  95,  95,  95,  95,  95,
<a name="l00179"></a>00179 95,  95,  95,  95,  95,  95,  183,  95,
<a name="l00180"></a>00180 95,  95,  95,  95,  95,  95,  95,  192,
<a name="l00181"></a>00181 193,  194,  195,  196,  197,  198,  199,  200,
<a name="l00182"></a>00182 201,  202,  203,  204,  205,  206,  207,  208,
<a name="l00183"></a>00183 209,  210,  211,  212,  213,  214,  95,  216,
<a name="l00184"></a>00184 217,  218,  219,  220,  221,  222,  223,  224,
<a name="l00185"></a>00185 225,  226,  227,  228,  229,  230,  231,  232,
<a name="l00186"></a>00186 233,  234,  235,  236,  237,  238,  239,  240,
<a name="l00187"></a>00187 241,  242,  243,  244,  245,  246,  95,  248,
<a name="l00188"></a>00188 249,  250,  251,  252,  253,  254,  255};
<a name="l00189"></a>00189 
<a name="l00190"></a><a class="code" href="../../d4/da7/collada__internal_8cpp.html#a698a24b52b7c508d2fbffd6fe9b57cd9">00190</a> <span class="keyword">typedef</span> std::map&lt; std::string, std::vector&lt;std::string&gt; &gt; <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a698a24b52b7c508d2fbffd6fe9b57cd9">map_string_list</a>;
<a name="l00191"></a><a class="code" href="../../d4/da7/collada__internal_8cpp.html#ae409f368c8dd39d69077174e41bc4914">00191</a> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a698a24b52b7c508d2fbffd6fe9b57cd9">map_string_list</a> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#ae409f368c8dd39d69077174e41bc4914">global_id_map</a>;
<a name="l00192"></a>00192 
<a name="l00193"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#ad02fa4f7d73f9e9b8976a40851e4ab2a">00193</a> <span class="keywordtype">void</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#ad02fa4f7d73f9e9b8976a40851e4ab2a">clear_global_id_map</a>()
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195     <a class="code" href="../../d4/da7/collada__internal_8cpp.html#ae409f368c8dd39d69077174e41bc4914">global_id_map</a>.clear();
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00199"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#a98abf572cf4e86829b8b84ad8b56446c">00199</a> std::string <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a98abf572cf4e86829b8b84ad8b56446c">translate_id</a>(<span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>)
<a name="l00200"></a>00200 {
<a name="l00201"></a>00201     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>.<a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>() == 0)
<a name="l00202"></a>00202     { <span class="keywordflow">return</span> <a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>; }
<a name="l00203"></a>00203     std::string id_translated = <a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>;
<a name="l00204"></a>00204     id_translated[0] = <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a7f2c2aa6665f96795644cd317d0032e0">translate_start_name_map</a>[(<span class="keywordtype">unsigned</span> int)id_translated[0]];
<a name="l00205"></a>00205     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; id_translated.size(); <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)
<a name="l00206"></a>00206     {
<a name="l00207"></a>00207         id_translated[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a2918b04a905eb205e98d8eb52231acd3">translate_name_map</a>[(<span class="keywordtype">unsigned</span> int)id_translated[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]];
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209     <span class="comment">// It&#39;s so much workload now, the if () should speed up things.</span>
<a name="l00210"></a>00210     <span class="keywordflow">if</span> (id_translated != <span class="keywordtype">id</span>)
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212         <span class="comment">// Search duplicates</span>
<a name="l00213"></a>00213         map_string_list::iterator iter = <a class="code" href="../../d4/da7/collada__internal_8cpp.html#ae409f368c8dd39d69077174e41bc4914">global_id_map</a>.find(id_translated);
<a name="l00214"></a>00214         <span class="keywordflow">if</span> (iter != <a class="code" href="../../d4/da7/collada__internal_8cpp.html#ae409f368c8dd39d69077174e41bc4914">global_id_map</a>.end())
<a name="l00215"></a>00215         {
<a name="l00216"></a>00216             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;
<a name="l00217"></a>00217             <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00218"></a>00218             <span class="keywordflow">for</span> (i=0; i &lt; iter-&gt;second.size(); i++)
<a name="l00219"></a>00219             {
<a name="l00220"></a>00220                 <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == iter-&gt;second[i])
<a name="l00221"></a>00221                 { 
<a name="l00222"></a>00222                     found = <span class="keyword">true</span>;
<a name="l00223"></a>00223                     <span class="keywordflow">break</span>;
<a name="l00224"></a>00224                 }
<a name="l00225"></a>00225             }
<a name="l00226"></a>00226             <span class="keywordtype">bool</span> <a class="code" href="../../d1/ded/namespacePixelFormat.html#a370df43b7b80c861bfeee383c97351fb">convert</a> = <span class="keyword">false</span>;
<a name="l00227"></a>00227             <span class="keywordflow">if</span> (found)
<a name="l00228"></a>00228             {
<a name="l00229"></a>00229               <span class="keywordflow">if</span> (i &gt; 0)
<a name="l00230"></a>00230               { convert = <span class="keyword">true</span>; }
<a name="l00231"></a>00231             }
<a name="l00232"></a>00232             <span class="keywordflow">else</span>
<a name="l00233"></a>00233             { 
<a name="l00234"></a>00234                 convert = <span class="keyword">true</span>;
<a name="l00235"></a>00235                 <a class="code" href="../../d4/da7/collada__internal_8cpp.html#ae409f368c8dd39d69077174e41bc4914">global_id_map</a>[id_translated].push_back(<span class="keywordtype">id</span>);
<a name="l00236"></a>00236             }
<a name="l00237"></a>00237             <span class="keywordflow">if</span> (convert)
<a name="l00238"></a>00238             {
<a name="l00239"></a>00239                 std::stringstream out;
<a name="l00240"></a>00240                 out &lt;&lt; ++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00241"></a>00241                 id_translated += out.str();
<a name="l00242"></a>00242             }
<a name="l00243"></a>00243         }
<a name="l00244"></a>00244         <span class="keywordflow">else</span> { <a class="code" href="../../d4/da7/collada__internal_8cpp.html#ae409f368c8dd39d69077174e41bc4914">global_id_map</a>[id_translated].push_back(<span class="keywordtype">id</span>); }
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246     <span class="keywordflow">return</span> id_translated;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#af02cfd5c1ac7414c7c1eb390ad7b9131">00249</a> std::string <a class="code" href="../../d4/da7/collada__internal_8cpp.html#af02cfd5c1ac7414c7c1eb390ad7b9131">id_name</a>(<span class="keywordtype">void</span> *<span class="keywordtype">id</span>)
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251     <span class="keywordflow">return</span> ((<a class="code" href="../../d8/d7e/structID.html">ID</a>*)<span class="keywordtype">id</span>)-&gt;name + 2;
<a name="l00252"></a>00252 }
<a name="l00253"></a>00253 
<a name="l00254"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#a8f4a168539881776cb1c04776cb50bc4">00254</a> std::string <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a8f4a168539881776cb1c04776cb50bc4">get_geometry_id</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob)
<a name="l00255"></a>00255 {
<a name="l00256"></a>00256     <span class="keywordflow">return</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a98abf572cf4e86829b8b84ad8b56446c">translate_id</a>(<a class="code" href="../../d4/da7/collada__internal_8cpp.html#af02cfd5c1ac7414c7c1eb390ad7b9131">id_name</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)) + <span class="stringliteral">&quot;-mesh&quot;</span>;
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00259"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#abc460e42c58e670932ac057c8bdc4b4b">00259</a> std::string <a class="code" href="../../d4/da7/collada__internal_8cpp.html#abc460e42c58e670932ac057c8bdc4b4b">get_light_id</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob)
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261     <span class="keywordflow">return</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a98abf572cf4e86829b8b84ad8b56446c">translate_id</a>(<a class="code" href="../../d4/da7/collada__internal_8cpp.html#af02cfd5c1ac7414c7c1eb390ad7b9131">id_name</a>(ob)) + <span class="stringliteral">&quot;-light&quot;</span>;
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00264"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#a11dfeaf7d4cd84273adc39e8afdee6e9">00264</a> std::string <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a11dfeaf7d4cd84273adc39e8afdee6e9">get_joint_id</a>(<a class="code" href="../../de/de0/structBone.html">Bone</a> *bone, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob_arm)
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266     <span class="keywordflow">return</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a98abf572cf4e86829b8b84ad8b56446c">translate_id</a>(<span class="comment">/*id_name(ob_arm) + &quot;_&quot; +*/</span> bone-&gt;<a class="code" href="../../de/de0/structBone.html#a64174a3246045ec9f985e604d30c6159">name</a>);
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#a0b748c2838aad7bf66e5e7be4ae13702">00269</a> std::string <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a0b748c2838aad7bf66e5e7be4ae13702">get_camera_id</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob)
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271     <span class="keywordflow">return</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a98abf572cf4e86829b8b84ad8b56446c">translate_id</a>(<a class="code" href="../../d4/da7/collada__internal_8cpp.html#af02cfd5c1ac7414c7c1eb390ad7b9131">id_name</a>(ob)) + <span class="stringliteral">&quot;-camera&quot;</span>;
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#a99dcec62a3af19022c777b4db7a4bb01">00274</a> std::string <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a99dcec62a3af19022c777b4db7a4bb01">get_material_id</a>(<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *mat)
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276     <span class="keywordflow">return</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a98abf572cf4e86829b8b84ad8b56446c">translate_id</a>(<a class="code" href="../../d4/da7/collada__internal_8cpp.html#af02cfd5c1ac7414c7c1eb390ad7b9131">id_name</a>(mat)) + <span class="stringliteral">&quot;-material&quot;</span>;
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="../../d7/da2/collada__internal_8h.html#a0bdba18513c245af0d0b5d78134ecc6b">00279</a> <span class="keywordtype">bool</span> <a class="code" href="../../d4/da7/collada__internal_8cpp.html#a0bdba18513c245af0d0b5d78134ecc6b">has_object_type</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <span class="keywordtype">short</span> obtype)
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281     <a class="code" href="../../d3/da9/structBase.html">Base</a> *<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>= (<a class="code" href="../../d3/da9/structBase.html">Base</a>*) sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00282"></a>00282     <span class="keywordflow">while</span>(base) {
<a name="l00283"></a>00283         <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l00284"></a>00284             
<a name="l00285"></a>00285         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == obtype &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>) {
<a name="l00286"></a>00286             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00287"></a>00287         }
<a name="l00288"></a>00288         base= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00291"></a>00291 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:11 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
