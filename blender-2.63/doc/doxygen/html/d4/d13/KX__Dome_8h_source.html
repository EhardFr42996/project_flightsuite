<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: KX_Dome.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">KX_Dome.h</div>  </div>
</div>
<div class="contents">
<a href="../../d4/d13/KX__Dome_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">-----------------------------------------------------------------------------</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">This program is free software; you can redistribute it and/or modify it under</span>
<a name="l00005"></a>00005 <span class="comment">the terms of the GNU Lesser General Public License as published by the Free Software</span>
<a name="l00006"></a>00006 <span class="comment">Foundation; either version 2 of the License, or (at your option) any later</span>
<a name="l00007"></a>00007 <span class="comment">version.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</span>
<a name="l00010"></a>00010 <span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<a name="l00011"></a>00011 <span class="comment">FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">You should have received a copy of the GNU Lesser General Public License along with</span>
<a name="l00014"></a>00014 <span class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</span>
<a name="l00015"></a>00015 <span class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</span>
<a name="l00016"></a>00016 <span class="comment">http://www.gnu.org/copyleft/lesser.txt.</span>
<a name="l00017"></a>00017 <span class="comment"></span>
<a name="l00018"></a>00018 <span class="comment">Contributor(s): Dalai Felinto</span>
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment">This source uses some of the ideas and code from Paul Bourke.</span>
<a name="l00021"></a>00021 <span class="comment">Developed as part of a Research and Development project for SAT - La Soci�t� des arts technologiques.</span>
<a name="l00022"></a>00022 <span class="comment">-----------------------------------------------------------------------------</span>
<a name="l00023"></a>00023 <span class="comment">*/</span>
<a name="l00024"></a>00024 
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef __KX_DOME_H__</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define __KX_DOME_H__</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da5/KX__Scene_8h.html">KX_Scene.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d17/KX__Camera_8h.html" title="Camera in the gameengine. Cameras are also used for views.">KX_Camera.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da4/DNA__screen__types_8h.html">DNA_screen_types.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/ded/RAS__ICanvas_8h.html">RAS_ICanvas.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d0f/RAS__IRasterizer_8h.html">RAS_IRasterizer.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/df5/RAS__IRenderTools_8h.html">RAS_IRenderTools.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/de7/KX__KetsjiEngine_8h.html">KX_KetsjiEngine.h</a>&quot;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;GL/glew.h&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d6d/BKE__text_8h.html">BKE_text.h</a>&quot;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">//Dome modes: limit hardcoded in buttons_scene.c</span>
<a name="l00047"></a><a class="code" href="../../d4/d13/KX__Dome_8h.html#a2678c86e7ed16b6b2267e7e2672216ee">00047</a> <span class="preprocessor">#define DOME_FISHEYE            1</span>
<a name="l00048"></a><a class="code" href="../../d4/d13/KX__Dome_8h.html#a413acf792cd55cda08c241246cb47d25">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define DOME_TRUNCATED_FRONT    2</span>
<a name="l00049"></a><a class="code" href="../../d4/d13/KX__Dome_8h.html#a406a0b47b22cd67648b33d968a49ece3">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define DOME_TRUNCATED_REAR     3</span>
<a name="l00050"></a><a class="code" href="../../d4/d13/KX__Dome_8h.html#a482d1b5f6adc2e73a0c9e45266693872">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define DOME_ENVMAP             4</span>
<a name="l00051"></a><a class="code" href="../../d4/d13/KX__Dome_8h.html#a1f64025c64842a86cdd00d0278dedd50">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define DOME_PANORAM_SPH        5</span>
<a name="l00052"></a><a class="code" href="../../d4/d13/KX__Dome_8h.html#aad282283d6de644d72ebc667ab9e7b27">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define DOME_NUM_MODES          6</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a>00054 
<a name="l00056"></a><a class="code" href="../../d5/d14/classKX__Dome.html">00056</a> <span class="keyword">class </span><a class="code" href="../../d5/d14/classKX__Dome.html" title="class for render 3d scene">KX_Dome</a>
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058 <span class="keyword">public</span>:
<a name="l00060"></a>00060     <a class="code" href="../../d5/d14/classKX__Dome.html#a9525c43c16193fed78ece5704d3873b6" title="constructor">KX_Dome</a> (<a class="code" href="../../d5/df6/classRAS__ICanvas.html">RAS_ICanvas</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#a45f573b199a7e2a369070fbf9951c5aa" title="canvas">m_canvas</a>,
<a name="l00062"></a>00062              <a class="code" href="../../d3/d64/classRAS__IRasterizer.html">RAS_IRasterizer</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#a2aa1a1e39b2a5ab9f3782ab221cc43c9" title="rasterizer">m_rasterizer</a>,
<a name="l00064"></a>00064              <a class="code" href="../../d0/d53/classRAS__IRenderTools.html">RAS_IRenderTools</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#a0bf798d13dff6e6bd1268a0c462d4740" title="render tools">m_rendertools</a>,
<a name="l00066"></a>00066              <a class="code" href="../../db/dcd/classKX__KetsjiEngine.html">KX_KetsjiEngine</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#af25fe03a17611ebb51d2df746b14b23f" title="engine">m_engine</a>,
<a name="l00067"></a>00067 
<a name="l00068"></a>00068              <span class="keywordtype">short</span> res,
<a name="l00069"></a>00069              <span class="keywordtype">short</span> <a class="code" href="../../d5/d14/classKX__Dome.html#aad59f45729e7e4f48c95271603019817">mode</a>,
<a name="l00070"></a>00070              <span class="keywordtype">short</span> <a class="code" href="../../d9/d42/btQuaternion_8h.html#a0dbf74d697e478378c0c48ef948cac37" title="Return the angle between two quaternions.">angle</a>,
<a name="l00071"></a>00071              <span class="keywordtype">float</span> resbuf,
<a name="l00072"></a>00072              <span class="keywordtype">short</span> tilt,
<a name="l00073"></a>00073              <span class="keyword">struct</span> <a class="code" href="../../d2/dda/structText.html">Text</a>* warptext
<a name="l00074"></a>00074              );
<a name="l00075"></a>00075 
<a name="l00077"></a>00077     <span class="keyword">virtual</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a9affa6e18d2d7e79553fe7a8bbd55786" title="destructor">~KX_Dome</a> (<span class="keywordtype">void</span>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079     <span class="comment">//openGL checks:</span>
<a name="l00080"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a6319336599a478b82cee840ddbefa5d2">00080</a>     <span class="keywordtype">bool</span>    <a class="code" href="../../d5/d14/classKX__Dome.html#a6319336599a478b82cee840ddbefa5d2">dlistSupported</a>;
<a name="l00081"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a98be8338f57430c78ed8015a34962767">00081</a>     <span class="keywordtype">bool</span>    <a class="code" href="../../d5/d14/classKX__Dome.html#a98be8338f57430c78ed8015a34962767">fboSupported</a>;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083     <span class="comment">//openGL names:</span>
<a name="l00084"></a><a class="code" href="../../d5/d14/classKX__Dome.html#aa278f83a0560420e9b647b792170ad63">00084</a>     GLuint <a class="code" href="../../d5/d14/classKX__Dome.html#aa278f83a0560420e9b647b792170ad63">domefacesId</a>[7];      <span class="comment">// ID of the images -- room for 7 images, using only 4 for 180� x 360� dome, 6 for panoramic and +1 for warp mesh</span>
<a name="l00085"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a8a6d929509c069d78fb0b1025104edc8">00085</a>     GLuint <a class="code" href="../../d5/d14/classKX__Dome.html#a8a6d929509c069d78fb0b1025104edc8">dlistId</a>;             <span class="comment">// ID of the Display Lists of the images (used as an offset)</span>
<a name="l00086"></a>00086     
<a name="l00087"></a><a class="code" href="../../db/d9f/structKX__Dome_1_1DomeFace.html">00087</a>     <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00088"></a><a class="code" href="../../db/d9f/structKX__Dome_1_1DomeFace.html#a562fd4038bb3574ed11c6501b38dac12">00088</a>         <span class="keywordtype">double</span> u[3], v[3];
<a name="l00089"></a><a class="code" href="../../db/d9f/structKX__Dome_1_1DomeFace.html#aa4ff9e998f0215f7a6c6438d0ff1a793">00089</a>         <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> verts[3]; <span class="comment">//three verts</span>
<a name="l00090"></a>00090     } <a class="code" href="../../db/d9f/structKX__Dome_1_1DomeFace.html">DomeFace</a>;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092     <span class="comment">//mesh warp functions</span>
<a name="l00093"></a><a class="code" href="../../d1/dfa/structKX__Dome_1_1WarpMeshNode.html">00093</a>     <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00094"></a><a class="code" href="../../d1/dfa/structKX__Dome_1_1WarpMeshNode.html#ac89d5b3b6c3ea1ebb4f716908ab295e4">00094</a>         <span class="keywordtype">double</span> x, <a class="code" href="../../d1/dfa/structKX__Dome_1_1WarpMeshNode.html#ac89d5b3b6c3ea1ebb4f716908ab295e4">y</a>, u, v, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00095"></a>00095     } <a class="code" href="../../d1/dfa/structKX__Dome_1_1WarpMeshNode.html">WarpMeshNode</a>;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     <span class="keyword">struct </span>{
<a name="l00098"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a294cd5d812be9c9c6496c2534e641997">00098</a>         <span class="keywordtype">bool</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a294cd5d812be9c9c6496c2534e641997">usemesh</a>;
<a name="l00099"></a><a class="code" href="../../d5/d14/classKX__Dome.html#aad59f45729e7e4f48c95271603019817">00099</a>         <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#aad59f45729e7e4f48c95271603019817">mode</a>;
<a name="l00100"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a0a1a8ca4636ff2b733f06479fabf595f">00100</a>         <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a0a1a8ca4636ff2b733f06479fabf595f">n_width</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#aff1ac4bc7485fbed5b6698ea375a1140">n_height</a>; <span class="comment">//nodes width and height</span>
<a name="l00101"></a><a class="code" href="../../d5/d14/classKX__Dome.html#ab04df7ba17aafa3fbe0d3e50a2b1e1c1">00101</a>         <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ab04df7ba17aafa3fbe0d3e50a2b1e1c1">imagesize</a>;
<a name="l00102"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a63cc10683c3080c9c21fa13361d9e7f1">00102</a>         <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a63cc10683c3080c9c21fa13361d9e7f1">bufferwidth</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a1089a83ea1bd0c3135a0775b97d3a4f4">bufferheight</a>;
<a name="l00103"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a9ecabe6008ecf4d4e7a8eed0a7d2f8d6">00103</a>         GLuint <a class="code" href="../../d5/d14/classKX__Dome.html#a9ecabe6008ecf4d4e7a8eed0a7d2f8d6">fboId</a>;
<a name="l00104"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a932ce9a1421bde6a0004b81b2f4af039">00104</a>         vector &lt;vector &lt;WarpMeshNode&gt; &gt; <a class="code" href="../../d5/d14/classKX__Dome.html#a932ce9a1421bde6a0004b81b2f4af039">nodes</a>;
<a name="l00105"></a>00105     } <a class="code" href="../../d5/d14/classKX__Dome.html#aad9060ff296e1c06a2fd999c5caef29b">warp</a>;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="keywordtype">bool</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a5d5f37778ace3563395dda7dcae7c722">ParseWarpMesh</a>(<a class="code" href="../../d6/dce/classSTR__String.html">STR_String</a> text);
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a06920b0bb723fee0058c6bc19e9fba56">00109</a>     vector &lt;DomeFace&gt; <a class="code" href="../../d5/d14/classKX__Dome.html#a06920b0bb723fee0058c6bc19e9fba56">cubetop</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#aa48fdefd488772c3b114992a3bbecb0a">cubebottom</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a33aded75ad0bc973d2b21f9086541030">cuberight</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a1a03e57fff235a7d27c1c8d8da5287fd">cubeleft</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a967f537e66fbd3a47df9155b8805954a">cubefront</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a3f865bb3a9f55296a270ce08385f3dea">cubeback</a>; <span class="comment">//for fisheye</span>
<a name="l00110"></a><a class="code" href="../../d5/d14/classKX__Dome.html#acafad231c6d7189b57291a032b35721b">00110</a>     vector &lt;DomeFace&gt; <a class="code" href="../../d5/d14/classKX__Dome.html#ac0b9831fc951892baddbdb695efd55f7">cubeleftback</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#acafad231c6d7189b57291a032b35721b">cuberightback</a>; <span class="comment">//for panorama</span>
<a name="l00111"></a>00111     
<a name="l00112"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a964367cf9c73b7846e4a356f0ad7aedb">00112</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a964367cf9c73b7846e4a356f0ad7aedb">nfacestop</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a59c2f94ba516cada399165834481e3e9">nfacesbottom</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a486b7733fc451125c320ab412e7a5d55">nfacesleft</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a87f5e23c3be91102d3eafbdde585e192">nfacesright</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#ab010cf5d159ae59465d6af8f4296cc69">nfacesfront</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#ad840fa24fa7c3f467726ecbe8acc1e50">nfacesback</a>;
<a name="l00113"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a47418884af58694c77cbb8621e01c418">00113</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a5857824d04db525502ba3a18b468fe58">nfacesleftback</a>, <a class="code" href="../../d5/d14/classKX__Dome.html#a47418884af58694c77cbb8621e01c418">nfacesrightback</a>;
<a name="l00114"></a>00114 
<a name="l00115"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a2d825ff73ec1a89902f4d31e8e63cf10">00115</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a2d825ff73ec1a89902f4d31e8e63cf10">GetNumberRenders</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d5/d14/classKX__Dome.html#acc5438e66db24aadc945df0e9c6a9534">m_numfaces</a>; }
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ac08122a12e589c2f1aa23650353f8742">RenderDome</a>(<span class="keywordtype">void</span>);
<a name="l00118"></a>00118     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ac5475aba86e0a6956a3eb133540b39ac">RenderDomeFrame</a>(<a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a>* scene, <a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a>* cam, <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);
<a name="l00119"></a>00119     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#af9ad34489c32d022a41d50db1a154810">BindImages</a>(<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a830efc5ecca596589bbea883192d730c">SetViewPort</a>(GLuint viewport[4]);
<a name="l00122"></a>00122     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a697bd130bc356e82101fd37f748909f3">CalculateFrustum</a>(<a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a>* cam);
<a name="l00123"></a>00123     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a27d9377f570b7adccd6c01a941af6feb">RotateCamera</a>(<a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a>* cam, <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     <span class="comment">//Mesh creation Functions</span>
<a name="l00126"></a>00126     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a985f3038721caad43edff1aa8b613934">CreateMeshDome180</a>(<span class="keywordtype">void</span>);
<a name="l00127"></a>00127     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a71610c4174594094fc7266eb0c6f529e">CreateMeshDome250</a>(<span class="keywordtype">void</span>);
<a name="l00128"></a>00128     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#addb4569276a118372704ede2fc483eb0">CreateMeshPanorama</a>(<span class="keywordtype">void</span>);
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a9ae6c6c6595494dab56ed2d133635315">SplitFace</a>(vector &lt;DomeFace&gt;&amp; face, <span class="keywordtype">int</span> *nfaces);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ac24b1234c731bf98f444287ad72cc7be">FlattenDome</a>(<a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> verts[3]);
<a name="l00133"></a>00133     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a2276ea9ecb4f078e22af166a80a2922d">FlattenPanorama</a>(<a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> verts[3]);
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <span class="comment">//Draw functions</span>
<a name="l00136"></a>00136     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a7103af2d51bbbe5fbb4d1a2e131c6f84">GLDrawTriangles</a>(vector &lt;DomeFace&gt;&amp; face, <span class="keywordtype">int</span> nfaces);
<a name="l00137"></a>00137     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#acedd15ee56d1fe0dcbee9bb9fbf4e3f5">GLDrawWarpQuads</a>(<span class="keywordtype">void</span>);
<a name="l00138"></a>00138     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#abea11cfcd8f2891c2f608d31373a6840">Draw</a>(<span class="keywordtype">void</span>);
<a name="l00139"></a>00139     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a9ab786098f23a33e412bd2a25976653d">DrawDomeFisheye</a>(<span class="keywordtype">void</span>);
<a name="l00140"></a>00140     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a48e3b8ad4a909be9d126b2107c907eaf">DrawEnvMap</a>(<span class="keywordtype">void</span>);
<a name="l00141"></a>00141     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a4c58c4b141a443ba8d372f53d6c72c8e">DrawPanorama</a>(<span class="keywordtype">void</span>);
<a name="l00142"></a>00142     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ae1cfb017ee131bb2554ca4c868e2eae4">DrawDomeWarped</a>(<span class="keywordtype">void</span>);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     <span class="comment">//setting up openGL</span>
<a name="l00145"></a>00145     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a594df9ab708a104b8775b02546052b9b">CreateGLImages</a>(<span class="keywordtype">void</span>);
<a name="l00146"></a>00146     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a1f8f67a04234732084b97bc0526897d7">ClearGLImages</a>(<span class="keywordtype">void</span>);<span class="comment">//called on resize</span>
<a name="l00147"></a>00147     <span class="keywordtype">bool</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ac8d31040840bd646985cd27b0bdfe9c9">CreateDL</a>(<span class="keywordtype">void</span>); <span class="comment">//create Display Lists</span>
<a name="l00148"></a>00148     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a843d2b5fa2c103217e407e1b6b9267b4">ClearDL</a>(<span class="keywordtype">void</span>);  <span class="comment">//remove Display Lists </span>
<a name="l00149"></a>00149     <span class="keywordtype">bool</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ad17e577e454e07cf8b41da0739ec8cb6">CreateFBO</a>(<span class="keywordtype">void</span>);<span class="comment">//create FBO (for warp mesh)</span>
<a name="l00150"></a>00150     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#aead44d766f74adec258949e8991e17c0">ClearFBO</a>(<span class="keywordtype">void</span>); <span class="comment">//remove FBO</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ab91b5bb3c00ff233360d5248e3373ccc">CalculateCameraOrientation</a>();
<a name="l00153"></a>00153     <span class="keywordtype">void</span> <a class="code" href="../../d5/d14/classKX__Dome.html#adb81c8b072fb2463cd7e2c84d7bce33b">CalculateImageSize</a>(); <span class="comment">//set m_imagesize</span>
<a name="l00154"></a>00154 
<a name="l00155"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a534296e4610c3fc88fdbe3501fb82348">00155</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a534296e4610c3fc88fdbe3501fb82348">canvaswidth</a>;
<a name="l00156"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a28450ee2c89121963fed2e020d7280df">00156</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a28450ee2c89121963fed2e020d7280df">canvasheight</a>;
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="keyword">protected</span>:
<a name="l00159"></a><a class="code" href="../../d5/d14/classKX__Dome.html#ac1fd10db1fbe31e2171b70994062626b">00159</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#ac1fd10db1fbe31e2171b70994062626b">m_drawingmode</a>;
<a name="l00160"></a>00160 
<a name="l00161"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a900c22f5d05cd5e809d10a92aa1a4e30">00161</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a900c22f5d05cd5e809d10a92aa1a4e30">m_imagesize</a>;
<a name="l00162"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a7729c391540f79a75b8a2dd9becfbda0">00162</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a7729c391540f79a75b8a2dd9becfbda0">m_buffersize</a>;   <span class="comment">// canvas small dimension</span>
<a name="l00163"></a><a class="code" href="../../d5/d14/classKX__Dome.html#acc5438e66db24aadc945df0e9c6a9534">00163</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#acc5438e66db24aadc945df0e9c6a9534">m_numfaces</a>;     <span class="comment">// 4 to 6 depending on the kind of dome image</span>
<a name="l00164"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a8f717331dc11575fd07f825d6d429ee8">00164</a>     <span class="keywordtype">int</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a8f717331dc11575fd07f825d6d429ee8">m_numimages</a>;    <span class="comment">//numfaces +1 if we have warp mesh</span>
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a494caa45b1135ea31fb41127beb02708">00166</a>     <span class="keywordtype">short</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a494caa45b1135ea31fb41127beb02708">m_resolution</a>; <span class="comment">//resolution to tessellate the mesh</span>
<a name="l00167"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a6a4bcdf7c5518c103ef689acbb34ff2b">00167</a>     <span class="keywordtype">short</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a6a4bcdf7c5518c103ef689acbb34ff2b">m_mode</a>;       <span class="comment">// the mode (truncated, warped, panoramic,...)</span>
<a name="l00168"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a416989aa48a9d32947f9b6ad58924e9a">00168</a>     <span class="keywordtype">short</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a416989aa48a9d32947f9b6ad58924e9a">m_angle</a>;      <span class="comment">//the angle of the fisheye</span>
<a name="l00169"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a55e54e3bf491ffc3f4e5546ec1c92236">00169</a>     <span class="keywordtype">float</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a55e54e3bf491ffc3f4e5546ec1c92236">m_radangle</a>;   <span class="comment">//the angle of the fisheye in radians</span>
<a name="l00170"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a8ea4958bacffad36003903000a8676ef">00170</a>     <span class="keywordtype">float</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a8ea4958bacffad36003903000a8676ef">m_resbuffer</a>;  <span class="comment">//the resolution of the buffer</span>
<a name="l00171"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a26a37583482cc4ed75475b926132f496">00171</a>     <span class="keywordtype">short</span> <a class="code" href="../../d5/d14/classKX__Dome.html#a26a37583482cc4ed75475b926132f496">m_tilt</a>;       <span class="comment">//the dome tilt (camera rotation on horizontal axis)</span>
<a name="l00172"></a>00172     
<a name="l00173"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a584c691a61a6f552b21a6328de7fb40a">00173</a>     <a class="code" href="../../d9/d14/classRAS__Rect.html">RAS_Rect</a> <a class="code" href="../../d5/d14/classKX__Dome.html#a584c691a61a6f552b21a6328de7fb40a">m_viewport</a>;
<a name="l00174"></a>00174 
<a name="l00175"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a362b5be04786097249d2761d306e9699">00175</a>     <a class="code" href="../../d0/d08/classMT__Matrix4x4.html">MT_Matrix4x4</a> <a class="code" href="../../d5/d14/classKX__Dome.html#a362b5be04786097249d2761d306e9699">m_projmat</a>;
<a name="l00176"></a>00176 
<a name="l00177"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a6f59295a4b90a48ab089d6ff133c595c">00177</a>     <a class="code" href="../../dd/d6f/classMT__Matrix3x3.html">MT_Matrix3x3</a> <a class="code" href="../../d5/d14/classKX__Dome.html#a6f59295a4b90a48ab089d6ff133c595c">m_locRot</a>[6]; <span class="comment">// the rotation matrix</span>
<a name="l00178"></a>00178 
<a name="l00180"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a6519be52ecdc607a439bfa6c6af95add">00180</a>     <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a> * <a class="code" href="../../d5/d14/classKX__Dome.html#a6519be52ecdc607a439bfa6c6af95add" title="rendered scene">m_scene</a>;
<a name="l00181"></a>00181 
<a name="l00183"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a45f573b199a7e2a369070fbf9951c5aa">00183</a>     <a class="code" href="../../d5/df6/classRAS__ICanvas.html">RAS_ICanvas</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#a45f573b199a7e2a369070fbf9951c5aa" title="canvas">m_canvas</a>;
<a name="l00185"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a2aa1a1e39b2a5ab9f3782ab221cc43c9">00185</a>     <a class="code" href="../../d3/d64/classRAS__IRasterizer.html">RAS_IRasterizer</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#a2aa1a1e39b2a5ab9f3782ab221cc43c9" title="rasterizer">m_rasterizer</a>;
<a name="l00187"></a><a class="code" href="../../d5/d14/classKX__Dome.html#a0bf798d13dff6e6bd1268a0c462d4740">00187</a>     <a class="code" href="../../d0/d53/classRAS__IRenderTools.html">RAS_IRenderTools</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#a0bf798d13dff6e6bd1268a0c462d4740" title="render tools">m_rendertools</a>;
<a name="l00189"></a><a class="code" href="../../d5/d14/classKX__Dome.html#af25fe03a17611ebb51d2df746b14b23f">00189</a>     <a class="code" href="../../db/dcd/classKX__KetsjiEngine.html">KX_KetsjiEngine</a>* <a class="code" href="../../d5/d14/classKX__Dome.html#af25fe03a17611ebb51d2df746b14b23f" title="engine">m_engine</a>;
<a name="l00190"></a>00190     
<a name="l00191"></a>00191     
<a name="l00192"></a>00192 <span class="preprocessor">#ifdef WITH_CXX_GUARDEDALLOC</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span><span class="keyword">public</span>:
<a name="l00194"></a>00194     <span class="keywordtype">void</span> *<a class="code" href="../../da/d12/mallocn_8cpp.html#a205ed048fdf5259c2e8e0cb60ee8f719">operator new</a>(<span class="keywordtype">size_t</span> num_bytes) { <span class="keywordflow">return</span> <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(num_bytes, <span class="stringliteral">&quot;GE:KX_Dome&quot;</span>); }
<a name="l00195"></a>00195     <span class="keywordtype">void</span> <a class="code" href="../../da/d12/mallocn_8cpp.html#a86107594327f3a001230df9802cd4422">operator delete</a>( <span class="keywordtype">void</span> *mem ) { <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(mem); }
<a name="l00196"></a>00196 <span class="preprocessor">#endif</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span>};
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="preprocessor">#endif </span><span class="comment">/* __KX_DOME_H__ */</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:28 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
