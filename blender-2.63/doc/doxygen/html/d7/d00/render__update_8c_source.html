<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: render_update.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">render_update.c</div>  </div>
</div>
<div class="contents">
<a href="../../d7/d00/render__update_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version. </span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00010"></a>00010 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00011"></a>00011 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00014"></a>00014 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00015"></a>00015 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * The Original Code is Copyright (C) 2009 Blender Foundation.</span>
<a name="l00018"></a>00018 <span class="comment"> * All rights reserved.</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * Contributor(s): Blender Foundation</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00023"></a>00023 <span class="comment"> */</span>
<a name="l00024"></a>00024 
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html">DNA_lamp_types.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../de/db2/DNA__material__types_8h.html">DNA_material_types.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d27/DNA__node__types_8h.html">DNA_node_types.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da4/DNA__screen__types_8h.html">DNA_screen_types.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5d/DNA__space__types_8h.html">DNA_space_types.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d06/DNA__view3d__types_8h.html">DNA_view3d_types.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d3b/DNA__world__types_8h.html">DNA_world_types.h</a>&quot;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dbb/BLI__threads_8h.html">BLI_threads.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d32/BKE__icons_8h.html">BKE_icons.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d77/BKE__image_8h.html">BKE_image.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d0f/BKE__material_8h.html" title="General operations, lookup, etc. for materials.">BKE_material.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d91/BKE__node_8h.html">BKE_node.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d53/BKE__scene_8h.html">BKE_scene.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d66/BKE__texture_8h.html">BKE_texture.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d35/BKE__world_8h.html">BKE_world.h</a>&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d68/GPU__material_8h.html">GPU_material.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../db/da9/RE__engine_8h.html">RE_engine.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dcc/ED__node_8h.html">ED_node.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d53/ED__render_8h.html">ED_render.h</a>&quot;</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/dac/render__intern_8h.html">render_intern.h</a>&quot;</span>  <span class="comment">// own include</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/***************************** Render Engines ********************************/</span>
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="../../d7/d00/render__update_8c.html#a1126a3935ac42d065418844a96bd5c16">00069</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/d53/ED__render_8h.html#a77b32b7ad101be703e843fb3712f95ee">ED_render_scene_update</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> updated)
<a name="l00070"></a>00070 {
<a name="l00071"></a>00071     <span class="comment">/* viewport rendering update on data changes, happens after depsgraph</span>
<a name="l00072"></a>00072 <span class="comment">     * updates if there was any change. context is set to the 3d view */</span>
<a name="l00073"></a>00073     <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>;
<a name="l00074"></a>00074     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc;
<a name="l00075"></a>00075     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l00076"></a>00076     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="comment">/* don&#39;t do this render engine update if we&#39;re updating the scene from</span>
<a name="l00079"></a>00079 <span class="comment">     * other threads doing e.g. rendering or baking jobs */</span>
<a name="l00080"></a>00080     <span class="keywordflow">if</span> (!<a class="code" href="../../df/dbb/BLI__threads_8h.html#a9f3390837d3451ee73162c329fba6e3e">BLI_thread_is_main</a>())
<a name="l00081"></a>00081         <span class="keywordflow">return</span>;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083     C = <a class="code" href="../../df/d01/BKE__context_8h.html#a5f1a57e3f1d7fbb9edd1485a439876cb">CTX_create</a>();
<a name="l00084"></a>00084     <a class="code" href="../../df/d01/BKE__context_8h.html#ab1d0bcbd1a0e5e6ae65d29b2364e8c9f">CTX_data_main_set</a>(C, bmain);
<a name="l00085"></a>00085     <a class="code" href="../../df/d01/BKE__context_8h.html#a197223f1af3429bb18e22f71ef4d4b60">CTX_data_scene_set</a>(C, scene);
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     <a class="code" href="../../df/d01/BKE__context_8h.html#ae385160ffa37348a53852ee474a8c7cb">CTX_wm_manager_set</a>(C, bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a1c415972a9fb2c7ce05e14d83affa0d8">wm</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>);
<a name="l00088"></a>00088 
<a name="l00089"></a>00089     <span class="keywordflow">for</span> (sc = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a3ab31640766afea3c151a816eb70e691">screen</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sc; sc = sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ac661d280cae6952ebc9f9c95279cf6f2">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00090"></a>00090         <span class="keywordflow">for</span> (sa = sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l00091"></a>00091             <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> != <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>)
<a name="l00092"></a>00092                 <span class="keywordflow">continue</span>;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094             <span class="keywordflow">for</span> (ar = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>) {
<a name="l00095"></a>00095                 <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d;
<a name="l00096"></a>00096                 <a class="code" href="../../d1/d10/structRenderEngine.html">RenderEngine</a> *engine;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098                 <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>)
<a name="l00099"></a>00099                     <span class="keywordflow">continue</span>;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101                 rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00102"></a>00102                 engine = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2edbfa90c097636953f1a14fb0b12115">render_engine</a>;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104                 <span class="keywordflow">if</span> (engine &amp;&amp; (updated || (engine-&gt;<a class="code" href="../../d1/d10/structRenderEngine.html#a7048ca345f75a4c7285339300c7fde7e">flag</a> &amp; <a class="code" href="../../db/da9/RE__engine_8h.html#a703520bb3027e383431d4bf37a4ff1b0">RE_ENGINE_DO_UPDATE</a>))) {
<a name="l00105"></a>00105                     <a class="code" href="../../df/d01/BKE__context_8h.html#aa738b861d07dd99111174d4aa273cb5c">CTX_wm_screen_set</a>(C, sc);
<a name="l00106"></a>00106                     <a class="code" href="../../df/d01/BKE__context_8h.html#af38e3db529bba2578831bbe57940570b">CTX_wm_area_set</a>(C, sa);
<a name="l00107"></a>00107                     <a class="code" href="../../df/d01/BKE__context_8h.html#a2406677d500d1744af5e9e56c210590b">CTX_wm_region_set</a>(C, ar);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109                     engine-&gt;<a class="code" href="../../d1/d10/structRenderEngine.html#a7048ca345f75a4c7285339300c7fde7e">flag</a> &amp;= ~<a class="code" href="../../db/da9/RE__engine_8h.html#a703520bb3027e383431d4bf37a4ff1b0">RE_ENGINE_DO_UPDATE</a>;
<a name="l00110"></a>00110                     engine-&gt;<a class="code" href="../../d1/d10/structRenderEngine.html#a1c64523867cd63df7acc20c674779545">type</a>-&gt;<a class="code" href="../../d3/dd4/structRenderEngineType.html#a8368f7fd2c6f61b8ab51d72c413a4acc">view_update</a>(engine, C);
<a name="l00111"></a>00111                 }
<a name="l00112"></a>00112             }
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <a class="code" href="../../df/d01/BKE__context_8h.html#a85379e02a080d5085e2f57c467479b51">CTX_free</a>(C);
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="../../d7/d00/render__update_8c.html#aac051d18b25fa8c3ed42503481516ff8">00119</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/d53/ED__render_8h.html#ada1e888f30b6336dc52787b6a86fcb0f">ED_render_engine_area_exit</a>(<a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa)
<a name="l00120"></a>00120 {
<a name="l00121"></a>00121     <span class="comment">/* clear all render engines in this area */</span>
<a name="l00122"></a>00122     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> != <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>)
<a name="l00125"></a>00125         <span class="keywordflow">return</span>;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127     <span class="keywordflow">for</span> (ar = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>) {
<a name="l00128"></a>00128         <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130         <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>)
<a name="l00131"></a>00131             <span class="keywordflow">continue</span>;
<a name="l00132"></a>00132         
<a name="l00133"></a>00133         rv3d = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135         <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2edbfa90c097636953f1a14fb0b12115">render_engine</a>) {
<a name="l00136"></a>00136             <a class="code" href="../../db/da9/RE__engine_8h.html#a8a292a5ca4bc5bb69055a1fe27b70d62">RE_engine_free</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2edbfa90c097636953f1a14fb0b12115">render_engine</a>);
<a name="l00137"></a>00137             rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2edbfa90c097636953f1a14fb0b12115">render_engine</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00138"></a>00138         }
<a name="l00139"></a>00139     }
<a name="l00140"></a>00140 }
<a name="l00141"></a>00141 
<a name="l00142"></a><a class="code" href="../../d7/d00/render__update_8c.html#a0bf47a6c4dfaaa4603be82394e4835c0">00142</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/d53/ED__render_8h.html#a7b00cafb49cdf10d93730386ca71ea60">ED_render_engine_changed</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain)
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144     <span class="comment">/* on changing the render engine type, clear all running render engines */</span>
<a name="l00145"></a>00145     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc;
<a name="l00146"></a>00146     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="keywordflow">for</span> (sc = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a3ab31640766afea3c151a816eb70e691">screen</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sc; sc = sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ac661d280cae6952ebc9f9c95279cf6f2">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00149"></a>00149         <span class="keywordflow">for</span> (sa = sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>)
<a name="l00150"></a>00150             <a class="code" href="../../d6/d53/ED__render_8h.html#ada1e888f30b6336dc52787b6a86fcb0f">ED_render_engine_area_exit</a>(sa);
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">/***************************** Updates ***********************************</span>
<a name="l00154"></a>00154 <span class="comment"> * ED_render_id_flush_update gets called from DAG_id_tag_update, to do   *</span>
<a name="l00155"></a>00155 <span class="comment"> * editor level updates when the ID changes. when these ID blocks are in *</span>
<a name="l00156"></a>00156 <span class="comment"> * the dependency graph, we can get rid of the manual dependency checks  */</span>
<a name="l00157"></a>00157 
<a name="l00158"></a><a class="code" href="../../d7/d00/render__update_8c.html#afda2af5a9bdeed0fb0938b123f130882">00158</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d00/render__update_8c.html#afda2af5a9bdeed0fb0938b123f130882">mtex_use_tex</a>(<a class="code" href="../../dc/ddd/structMTex.html">MTex</a> **mtex, <span class="keywordtype">int</span> tot, <a class="code" href="../../df/d2d/structTex.html">Tex</a> *<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>)
<a name="l00159"></a>00159 {
<a name="l00160"></a>00160     <span class="keywordtype">int</span> a;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162     <span class="keywordflow">if</span> (!mtex)
<a name="l00163"></a>00163         <span class="keywordflow">return</span> 0;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <span class="keywordflow">for</span> (a = 0; a &lt; tot; a++)
<a name="l00166"></a>00166         <span class="keywordflow">if</span> (mtex[a] &amp;&amp; mtex[a]-&gt;tex == tex)
<a name="l00167"></a>00167             <span class="keywordflow">return</span> 1;
<a name="l00168"></a>00168     
<a name="l00169"></a>00169     <span class="keywordflow">return</span> 0;
<a name="l00170"></a>00170 }
<a name="l00171"></a>00171 
<a name="l00172"></a><a class="code" href="../../d7/d00/render__update_8c.html#a8ec8793dbbcdfc485c3b51906a9cfcdb">00172</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d00/render__update_8c.html#a8ec8793dbbcdfc485c3b51906a9cfcdb">nodes_use_tex</a>(<a class="code" href="../../d9/da9/structbNodeTree.html">bNodeTree</a> *ntree, <a class="code" href="../../df/d2d/structTex.html">Tex</a> *<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>)
<a name="l00173"></a>00173 {
<a name="l00174"></a>00174     <a class="code" href="../../dc/daa/structbNode.html">bNode</a> *node;
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="keywordflow">for</span> (node = ntree-&gt;<a class="code" href="../../d9/da9/structbNodeTree.html#ac928f4eb3314d2b9ce2d9c6a49c1f233">nodes</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; node; node = node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a978093ed3cb2529e1f932bc8c5081968">next</a>) {
<a name="l00177"></a>00177         <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a>) {
<a name="l00178"></a>00178             <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a> == (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)tex) {
<a name="l00179"></a>00179                 <span class="keywordflow">return</span> 1;
<a name="l00180"></a>00180             }
<a name="l00181"></a>00181             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>) == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>) {
<a name="l00182"></a>00182                 <span class="keywordflow">if</span> (<a class="code" href="../../d7/d00/render__update_8c.html#afda2af5a9bdeed0fb0938b123f130882">mtex_use_tex</a>(((<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *)node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a>)-&gt;mtex, <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a5c921b6ba71dfcfa9a404e101d9bcaf4">MAX_MTEX</a>, tex))
<a name="l00183"></a>00183                     <span class="keywordflow">return</span> 1;
<a name="l00184"></a>00184             }
<a name="l00185"></a>00185             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a95416f774e5a5a27105522a1b74e5989">type</a> == <a class="code" href="../../d4/d91/BKE__node_8h.html#ab9f16ff5fded11f644b983a041c97edd">NODE_GROUP</a>) {
<a name="l00186"></a>00186                 <span class="keywordflow">if</span> (<a class="code" href="../../d7/d00/render__update_8c.html#a8ec8793dbbcdfc485c3b51906a9cfcdb">nodes_use_tex</a>((<a class="code" href="../../d9/da9/structbNodeTree.html">bNodeTree</a> *)node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a>, tex))
<a name="l00187"></a>00187                     <span class="keywordflow">return</span> 1;
<a name="l00188"></a>00188             }
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="keywordflow">return</span> 0;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="../../d7/d00/render__update_8c.html#ae91f5c40682600fb21f6f0ad30505ae8">00195</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d00/render__update_8c.html#ae91f5c40682600fb21f6f0ad30505ae8">nodes_use_material</a>(<a class="code" href="../../d9/da9/structbNodeTree.html">bNodeTree</a> *ntree, <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma)
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197     <a class="code" href="../../dc/daa/structbNode.html">bNode</a> *node;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <span class="keywordflow">for</span> (node = ntree-&gt;<a class="code" href="../../d9/da9/structbNodeTree.html#ac928f4eb3314d2b9ce2d9c6a49c1f233">nodes</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; node; node = node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a978093ed3cb2529e1f932bc8c5081968">next</a>) {
<a name="l00200"></a>00200         <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a>) {
<a name="l00201"></a>00201             <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a> == (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)ma) {
<a name="l00202"></a>00202                 <span class="keywordflow">return</span> 1;
<a name="l00203"></a>00203             }
<a name="l00204"></a>00204             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a95416f774e5a5a27105522a1b74e5989">type</a> == <a class="code" href="../../d4/d91/BKE__node_8h.html#ab9f16ff5fded11f644b983a041c97edd">NODE_GROUP</a>) {
<a name="l00205"></a>00205                 <span class="keywordflow">if</span> (<a class="code" href="../../d7/d00/render__update_8c.html#ae91f5c40682600fb21f6f0ad30505ae8">nodes_use_material</a>((<a class="code" href="../../d9/da9/structbNodeTree.html">bNodeTree</a> *)node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a>, ma))
<a name="l00206"></a>00206                     <span class="keywordflow">return</span> 1;
<a name="l00207"></a>00207             }
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     <span class="keywordflow">return</span> 0;
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00214"></a><a class="code" href="../../d7/d00/render__update_8c.html#a1024d3a85bc9ed5df5eb4b285248ce84">00214</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d00/render__update_8c.html#a1024d3a85bc9ed5df5eb4b285248ce84">material_changed</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *parent;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <span class="comment">/* icons */</span>
<a name="l00219"></a>00219     <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>));
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     <span class="comment">/* glsl */</span>
<a name="l00222"></a>00222     <span class="keywordflow">if</span> (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aa520df46803a0ee7d873664f2f1b74d0">gpumaterial</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00223"></a>00223         <a class="code" href="../../de/d68/GPU__material_8h.html#acdaa9d514ad84c86d16569bd6e328530">GPU_material_free</a>(ma);
<a name="l00224"></a>00224 
<a name="l00225"></a>00225     <span class="comment">/* find node materials using this */</span>
<a name="l00226"></a>00226     <span class="keywordflow">for</span> (parent = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#afbcb0c6e7f10e562d567fe016fc6c5a5">mat</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; parent; parent = parent-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00227"></a>00227         <span class="keywordflow">if</span> (parent-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ae5c87659b1f4bd186431d96361ade966">use_nodes</a> &amp;&amp; parent-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a535477b1fb0d8090cc56a0541c5ff467">nodetree</a> &amp;&amp; <a class="code" href="../../d7/d00/render__update_8c.html#ae91f5c40682600fb21f6f0ad30505ae8">nodes_use_material</a>(parent-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a535477b1fb0d8090cc56a0541c5ff467">nodetree</a>, ma)) ;
<a name="l00228"></a>00228         <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230         <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;parent-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>));
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         <span class="keywordflow">if</span> (parent-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aa520df46803a0ee7d873664f2f1b74d0">gpumaterial</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00233"></a>00233             <a class="code" href="../../de/d68/GPU__material_8h.html#acdaa9d514ad84c86d16569bd6e328530">GPU_material_free</a>(parent);
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235 }
<a name="l00236"></a>00236 
<a name="l00237"></a><a class="code" href="../../d7/d00/render__update_8c.html#a21f21cfb08639d5e181a967d0d966294">00237</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d00/render__update_8c.html#a21f21cfb08639d5e181a967d0d966294">texture_changed</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../df/d2d/structTex.html">Tex</a> *<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>)
<a name="l00238"></a>00238 {
<a name="l00239"></a>00239     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma;
<a name="l00240"></a>00240     <a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *la;
<a name="l00241"></a>00241     <a class="code" href="../../d7/d3f/structWorld.html">World</a> *wo;
<a name="l00242"></a>00242     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene;
<a name="l00243"></a>00243     <a class="code" href="../../dc/daa/structbNode.html">bNode</a> *node;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     <span class="comment">/* icons */</span>
<a name="l00246"></a>00246     <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a8319488bcdfe2de879476bd0f7c27aa2">id</a>));
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     <span class="comment">/* find materials */</span>
<a name="l00249"></a>00249     <span class="keywordflow">for</span> (ma = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#afbcb0c6e7f10e562d567fe016fc6c5a5">mat</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ma; ma = ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00250"></a>00250         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d00/render__update_8c.html#afda2af5a9bdeed0fb0938b123f130882">mtex_use_tex</a>(ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a738a376b474b09dba529b222ba7876d6">mtex</a>, <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a5c921b6ba71dfcfa9a404e101d9bcaf4">MAX_MTEX</a>, tex)) ;
<a name="l00251"></a>00251         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ae5c87659b1f4bd186431d96361ade966">use_nodes</a> &amp;&amp; ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a535477b1fb0d8090cc56a0541c5ff467">nodetree</a> &amp;&amp; <a class="code" href="../../d7/d00/render__update_8c.html#a8ec8793dbbcdfc485c3b51906a9cfcdb">nodes_use_tex</a>(ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a535477b1fb0d8090cc56a0541c5ff467">nodetree</a>, tex)) ;
<a name="l00252"></a>00252         <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>));
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         <span class="keywordflow">if</span> (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aa520df46803a0ee7d873664f2f1b74d0">gpumaterial</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00257"></a>00257             <a class="code" href="../../de/d68/GPU__material_8h.html#acdaa9d514ad84c86d16569bd6e328530">GPU_material_free</a>(ma);
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260     <span class="comment">/* find lamps */</span>
<a name="l00261"></a>00261     <span class="keywordflow">for</span> (la = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a5c8647f5ca9b577b50cda518ccd53b8a">lamp</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; la; la = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#add71cdc042b5fe8dc4d423f9bfcd8335">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00262"></a>00262         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d00/render__update_8c.html#afda2af5a9bdeed0fb0938b123f130882">mtex_use_tex</a>(la-&gt;<a class="code" href="../../d5/d72/structLamp.html#add02e1f88fe6e0ab0f54de00fd02b49e">mtex</a>, <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a5c921b6ba71dfcfa9a404e101d9bcaf4">MAX_MTEX</a>, tex)) ;
<a name="l00263"></a>00263         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a957058346e5bf9659eec90ba4e31d76f">nodetree</a> &amp;&amp; <a class="code" href="../../d7/d00/render__update_8c.html#a8ec8793dbbcdfc485c3b51906a9cfcdb">nodes_use_tex</a>(la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a957058346e5bf9659eec90ba4e31d76f">nodetree</a>, tex)) ;
<a name="l00264"></a>00264         <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;
<a name="l00265"></a>00265 
<a name="l00266"></a>00266         <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;la-&gt;<a class="code" href="../../d5/d72/structLamp.html#add71cdc042b5fe8dc4d423f9bfcd8335">id</a>));
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     <span class="comment">/* find worlds */</span>
<a name="l00270"></a>00270     <span class="keywordflow">for</span> (wo = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a10592adbf2eb366b863e2e60159107a4">world</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; wo; wo = wo-&gt;<a class="code" href="../../d7/d3f/structWorld.html#a4504eae7c57dff86fda73ab56264a50a">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00271"></a>00271         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d00/render__update_8c.html#afda2af5a9bdeed0fb0938b123f130882">mtex_use_tex</a>(wo-&gt;<a class="code" href="../../d7/d3f/structWorld.html#aa41e14c520e87635c6c9a748dd144e25">mtex</a>, <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a5c921b6ba71dfcfa9a404e101d9bcaf4">MAX_MTEX</a>, tex)) ;
<a name="l00272"></a>00272         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wo-&gt;<a class="code" href="../../d7/d3f/structWorld.html#a141c5c72fbf4bedfab53b9f0f091b1a9">nodetree</a> &amp;&amp; <a class="code" href="../../d7/d00/render__update_8c.html#a8ec8793dbbcdfc485c3b51906a9cfcdb">nodes_use_tex</a>(wo-&gt;<a class="code" href="../../d7/d3f/structWorld.html#a141c5c72fbf4bedfab53b9f0f091b1a9">nodetree</a>, tex)) ;
<a name="l00273"></a>00273         <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;wo-&gt;<a class="code" href="../../d7/d3f/structWorld.html#a4504eae7c57dff86fda73ab56264a50a">id</a>));
<a name="l00276"></a>00276     }
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     <span class="comment">/* find compositing nodes */</span>
<a name="l00279"></a>00279     <span class="keywordflow">for</span> (scene = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a976062774f867fa0f917c23f2ec331bb">scene</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; scene; scene = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00280"></a>00280         <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aad111279d77725d23416058f31414dd3">use_nodes</a> &amp;&amp; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>) {
<a name="l00281"></a>00281             <span class="keywordflow">for</span> (node = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>-&gt;<a class="code" href="../../d9/da9/structbNodeTree.html#ac928f4eb3314d2b9ce2d9c6a49c1f233">nodes</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; node; node = node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a978093ed3cb2529e1f932bc8c5081968">next</a>) {
<a name="l00282"></a>00282                 <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a> == &amp;tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a8319488bcdfe2de879476bd0f7c27aa2">id</a>)
<a name="l00283"></a>00283                     <a class="code" href="../../da/dcc/ED__node_8h.html#a95b3e3668704677f2f588426b9506419">ED_node_changed_update</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, node);
<a name="l00284"></a>00284             }
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a><a class="code" href="../../d7/d00/render__update_8c.html#a0ed66ee5bf58e3c14a7d894a41f68a08">00289</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d00/render__update_8c.html#a0ed66ee5bf58e3c14a7d894a41f68a08">lamp_changed</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *la)
<a name="l00290"></a>00290 {
<a name="l00291"></a>00291     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob;
<a name="l00292"></a>00292     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <span class="comment">/* icons */</span>
<a name="l00295"></a>00295     <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;la-&gt;<a class="code" href="../../d5/d72/structLamp.html#add71cdc042b5fe8dc4d423f9bfcd8335">id</a>));
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     <span class="comment">/* glsl */</span>
<a name="l00298"></a>00298     <span class="keywordflow">for</span> (ob = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#ac9c12335b530e1b3f1717bb9cbc269a4">object</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ob; ob = ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00299"></a>00299         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a> == la &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa48036a92e658b42f6e0a3f8a73e8789">gpulamp</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00300"></a>00300             <a class="code" href="../../de/d68/GPU__material_8h.html#a6cef08d987baee5ec4c317b8814aab74">GPU_lamp_free</a>(ob);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <span class="keywordflow">for</span> (ma = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#afbcb0c6e7f10e562d567fe016fc6c5a5">mat</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ma; ma = ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00303"></a>00303         <span class="keywordflow">if</span> (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aa520df46803a0ee7d873664f2f1b74d0">gpumaterial</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00304"></a>00304             <a class="code" href="../../de/d68/GPU__material_8h.html#acdaa9d514ad84c86d16569bd6e328530">GPU_material_free</a>(ma);
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 
<a name="l00307"></a><a class="code" href="../../d7/d00/render__update_8c.html#a8d1f0f3651ebdb07146890eea7c52858">00307</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d00/render__update_8c.html#a8d1f0f3651ebdb07146890eea7c52858">world_changed</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d7/d3f/structWorld.html">World</a> *wo)
<a name="l00308"></a>00308 {
<a name="l00309"></a>00309     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma;
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     <span class="comment">/* icons */</span>
<a name="l00312"></a>00312     <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;wo-&gt;<a class="code" href="../../d7/d3f/structWorld.html#a4504eae7c57dff86fda73ab56264a50a">id</a>));
<a name="l00313"></a>00313 
<a name="l00314"></a>00314     <span class="comment">/* glsl */</span>
<a name="l00315"></a>00315     <span class="keywordflow">for</span> (ma = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#afbcb0c6e7f10e562d567fe016fc6c5a5">mat</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ma; ma = ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00316"></a>00316         <span class="keywordflow">if</span> (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aa520df46803a0ee7d873664f2f1b74d0">gpumaterial</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00317"></a>00317             <a class="code" href="../../de/d68/GPU__material_8h.html#acdaa9d514ad84c86d16569bd6e328530">GPU_material_free</a>(ma);
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a><a class="code" href="../../d7/d00/render__update_8c.html#af7d8e3f788db396cde132f992b02c7e6">00320</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d00/render__update_8c.html#af7d8e3f788db396cde132f992b02c7e6">image_changed</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d8/d00/classImage.html" title="32 bit RGBA image.">Image</a> *ima)
<a name="l00321"></a>00321 {
<a name="l00322"></a>00322     <a class="code" href="../../df/d2d/structTex.html">Tex</a> *<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>;
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     <span class="comment">/* icons */</span>
<a name="l00325"></a>00325     <a class="code" href="../../d4/d32/BKE__icons_8h.html#a75fc479411d6336b043f38b19885ad90">BKE_icon_changed</a>(<a class="code" href="../../d4/d32/BKE__icons_8h.html#a7c1c9f16a87653cd5287caf99299f348">BKE_icon_getid</a>(&amp;ima-&gt;<a class="code" href="../../d8/d00/classImage.html#aaf5fcd281cf4337d6686322f82187896">id</a>));
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     <span class="comment">/* textures */</span>
<a name="l00328"></a>00328     <span class="keywordflow">for</span> (tex = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#abd9c8128d38727f789af5a4c990fe20b">tex</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; tex; tex = tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a8319488bcdfe2de879476bd0f7c27aa2">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00329"></a>00329         <span class="keywordflow">if</span> (tex-&gt;<a class="code" href="../../df/d2d/structTex.html#ad2c2c4a8437672ea77fc9cfded61ffaf">ima</a> == ima)
<a name="l00330"></a>00330             <a class="code" href="../../d7/d00/render__update_8c.html#a21f21cfb08639d5e181a967d0d966294">texture_changed</a>(bmain, tex);
<a name="l00331"></a>00331 }
<a name="l00332"></a>00332 
<a name="l00333"></a><a class="code" href="../../d7/d00/render__update_8c.html#a2c5e7963be643c1c95165cf64745809a">00333</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d00/render__update_8c.html#a2c5e7963be643c1c95165cf64745809a">scene_changed</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene))
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob;
<a name="l00336"></a>00336     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma;
<a name="l00337"></a>00337 
<a name="l00338"></a>00338     <span class="comment">/* glsl */</span>
<a name="l00339"></a>00339     <span class="keywordflow">for</span> (ob = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#ac9c12335b530e1b3f1717bb9cbc269a4">object</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ob; ob = ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00340"></a>00340         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa48036a92e658b42f6e0a3f8a73e8789">gpulamp</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00341"></a>00341             <a class="code" href="../../de/d68/GPU__material_8h.html#a6cef08d987baee5ec4c317b8814aab74">GPU_lamp_free</a>(ob);
<a name="l00342"></a>00342 
<a name="l00343"></a>00343     <span class="keywordflow">for</span> (ma = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#afbcb0c6e7f10e562d567fe016fc6c5a5">mat</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ma; ma = ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00344"></a>00344         <span class="keywordflow">if</span> (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aa520df46803a0ee7d873664f2f1b74d0">gpumaterial</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)
<a name="l00345"></a>00345             <a class="code" href="../../de/d68/GPU__material_8h.html#acdaa9d514ad84c86d16569bd6e328530">GPU_material_free</a>(ma);
<a name="l00346"></a>00346 }
<a name="l00347"></a>00347 
<a name="l00348"></a><a class="code" href="../../d7/d00/render__update_8c.html#ae2881e828b9cf0cef2ad30113b7af261">00348</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/d53/ED__render_8h.html#a9fc12a85e8a75c3f09d5a43d7114b844">ED_render_id_flush_update</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span>)
<a name="l00349"></a>00349 {
<a name="l00350"></a>00350     <span class="keywordflow">switch</span> (<a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(id-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)) {
<a name="l00351"></a>00351         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>:
<a name="l00352"></a>00352             <a class="code" href="../../d7/d00/render__update_8c.html#a1024d3a85bc9ed5df5eb4b285248ce84">material_changed</a>(bmain, (<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *)<span class="keywordtype">id</span>);
<a name="l00353"></a>00353             <span class="keywordflow">break</span>;
<a name="l00354"></a>00354         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>:
<a name="l00355"></a>00355             <a class="code" href="../../d7/d00/render__update_8c.html#a21f21cfb08639d5e181a967d0d966294">texture_changed</a>(bmain, (<a class="code" href="../../df/d2d/structTex.html">Tex</a> *)<span class="keywordtype">id</span>);
<a name="l00356"></a>00356             <span class="keywordflow">break</span>;
<a name="l00357"></a>00357         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>:
<a name="l00358"></a>00358             <a class="code" href="../../d7/d00/render__update_8c.html#a8d1f0f3651ebdb07146890eea7c52858">world_changed</a>(bmain, (<a class="code" href="../../d7/d3f/structWorld.html">World</a> *)<span class="keywordtype">id</span>);
<a name="l00359"></a>00359             <span class="keywordflow">break</span>;
<a name="l00360"></a>00360         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>:
<a name="l00361"></a>00361             <a class="code" href="../../d7/d00/render__update_8c.html#a0ed66ee5bf58e3c14a7d894a41f68a08">lamp_changed</a>(bmain, (<a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *)<span class="keywordtype">id</span>);
<a name="l00362"></a>00362             <span class="keywordflow">break</span>;
<a name="l00363"></a>00363         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a564eac75543b047cf8b2b759818529c3">ID_IM</a>:
<a name="l00364"></a>00364             <a class="code" href="../../d7/d00/render__update_8c.html#af7d8e3f788db396cde132f992b02c7e6">image_changed</a>(bmain, (<a class="code" href="../../d8/d00/classImage.html" title="32 bit RGBA image.">Image</a> *)<span class="keywordtype">id</span>);
<a name="l00365"></a>00365             <span class="keywordflow">break</span>;
<a name="l00366"></a>00366         <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac2b425dbd1f73ad1720fafad2626d974">ID_SCE</a>:
<a name="l00367"></a>00367             <a class="code" href="../../d7/d00/render__update_8c.html#a2c5e7963be643c1c95165cf64745809a">scene_changed</a>(bmain, (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)<span class="keywordtype">id</span>);
<a name="l00368"></a>00368             <span class="keywordflow">break</span>;
<a name="l00369"></a>00369         <span class="keywordflow">default</span>:
<a name="l00370"></a>00370             <span class="keywordflow">break</span>;
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372 }
<a name="l00373"></a>00373 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:47 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
