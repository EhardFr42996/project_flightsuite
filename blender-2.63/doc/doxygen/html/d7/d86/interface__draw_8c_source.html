<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: interface_draw.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">interface_draw.c</div>  </div>
</div>
<div class="contents">
<a href="../../d7/d86/interface__draw_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2001-2002 by NaN Holding BV.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * Contributor(s): Blender Foundation</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00024"></a>00024 <span class="comment"> */</span>
<a name="l00025"></a>00025 
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../da/ddd/DNA__color__types_8h.html">DNA_color_types.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da4/DNA__screen__types_8h.html">DNA_screen_types.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/dfb/DNA__movieclip__types_8h.html">DNA_movieclip_types.h</a>&quot;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d44/BLI__rect_8h.html">BLI_rect.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/db3/BLI__string_8h.html">BLI_string.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/dca/BKE__colortools_8h.html">BKE_colortools.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d66/BKE__texture_8h.html">BKE_texture.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d49/IMB__imbuf_8h.html">IMB_imbuf.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc9/IMB__imbuf__types_8h.html" title="Contains defines and structs used throughout the imbuf module.">IMB_imbuf_types.h</a>&quot;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d44/BIF__gl_8h.html">BIF_gl.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d71/BIF__glutil_8h.html">BIF_glutil.h</a>&quot;</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d5d/BLF__api_8h.html">BLF_api.h</a>&quot;</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1e/UI__interface_8h.html">UI_interface.h</a>&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="comment">/* own include */</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d2f/interface__intern_8h.html">interface_intern.h</a>&quot;</span>
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#aa7db74029d78c6ec2e477a767354948a">00061</a> <span class="preprocessor">#define UI_DISABLED_ALPHA_OFFS  -160</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span>
<a name="l00063"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">00063</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> = <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba7e9af1d815f4277196ed35a049f74148">UI_CNR_ALL</a>;
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a8fc510c8382c62a5af3a095e218d8f3d">00065</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(<span class="keywordtype">int</span> type)
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067     <span class="comment">/* Not sure the roundbox function is the best place to change this</span>
<a name="l00068"></a>00068 <span class="comment">     * if this is undone, its not that big a deal, only makes curves edges</span>
<a name="l00069"></a>00069 <span class="comment">     * square for the  */</span>
<a name="l00070"></a>00070     <a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> = type;
<a name="l00071"></a>00071     
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00074"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#ae3421791282f87b4c37e8391a66678fc">00074</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#ae3421791282f87b4c37e8391a66678fc">uiGetRoundBox</a>(<span class="keywordtype">void</span>)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076     <span class="keywordflow">return</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a>;
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a363d654a8d24625cd68b8d30e8005609">00079</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(<span class="keywordtype">int</span> mode, <span class="keywordtype">float</span> minx, <span class="keywordtype">float</span> miny, <span class="keywordtype">float</span> maxx, <span class="keywordtype">float</span> maxy, <span class="keywordtype">float</span> rad)
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081     <span class="keywordtype">float</span> vec[7][2] = {{0.195, 0.02}, {0.383, 0.067}, {0.55, 0.169}, {0.707, 0.293},
<a name="l00082"></a>00082                        {0.831, 0.45}, {0.924, 0.617}, {0.98, 0.805}};
<a name="l00083"></a>00083     <span class="keywordtype">int</span> a;
<a name="l00084"></a>00084     
<a name="l00085"></a>00085     <span class="comment">/* mult */</span>
<a name="l00086"></a>00086     <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00087"></a>00087         vec[a][0] *= rad; vec[a][1] *= rad;
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     glBegin(mode);
<a name="l00091"></a>00091 
<a name="l00092"></a>00092     <span class="comment">/* start with corner right-bottom */</span>
<a name="l00093"></a>00093     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba4faf5f6a673821f9b25ad6054e50a3a6">UI_CNR_BOTTOM_RIGHT</a>) {
<a name="l00094"></a>00094         glVertex2f(maxx - rad, miny);
<a name="l00095"></a>00095         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00096"></a>00096             glVertex2f(maxx - rad + vec[a][0], miny + vec[a][1]);
<a name="l00097"></a>00097         }
<a name="l00098"></a>00098         glVertex2f(maxx, miny + rad);
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100     <span class="keywordflow">else</span> glVertex2f(maxx, miny);
<a name="l00101"></a>00101     
<a name="l00102"></a>00102     <span class="comment">/* corner right-top */</span>
<a name="l00103"></a>00103     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649baa847b3b73afd0cc1dde8a31d8b4e3fce">UI_CNR_TOP_RIGHT</a>) {
<a name="l00104"></a>00104         glVertex2f(maxx, maxy - rad);
<a name="l00105"></a>00105         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00106"></a>00106             glVertex2f(maxx - vec[a][1], maxy - rad + vec[a][0]);
<a name="l00107"></a>00107         }
<a name="l00108"></a>00108         glVertex2f(maxx - rad, maxy);
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110     <span class="keywordflow">else</span> glVertex2f(maxx, maxy);
<a name="l00111"></a>00111     
<a name="l00112"></a>00112     <span class="comment">/* corner left-top */</span>
<a name="l00113"></a>00113     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba8caa5a82d9edf3edb0c7803ff59ccc65">UI_CNR_TOP_LEFT</a>) {
<a name="l00114"></a>00114         glVertex2f(minx + rad, maxy);
<a name="l00115"></a>00115         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00116"></a>00116             glVertex2f(minx + rad - vec[a][0], maxy - vec[a][1]);
<a name="l00117"></a>00117         }
<a name="l00118"></a>00118         glVertex2f(minx, maxy - rad);
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120     <span class="keywordflow">else</span> glVertex2f(minx, maxy);
<a name="l00121"></a>00121     
<a name="l00122"></a>00122     <span class="comment">/* corner left-bottom */</span>
<a name="l00123"></a>00123     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba20182239f010b84a5902746abfe3bdc1">UI_CNR_BOTTOM_LEFT</a>) {
<a name="l00124"></a>00124         glVertex2f(minx, miny + rad);
<a name="l00125"></a>00125         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00126"></a>00126             glVertex2f(minx + vec[a][1], miny + rad - vec[a][0]);
<a name="l00127"></a>00127         }
<a name="l00128"></a>00128         glVertex2f(minx + rad, miny);
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130     <span class="keywordflow">else</span> glVertex2f(minx, miny);
<a name="l00131"></a>00131     
<a name="l00132"></a>00132     glEnd();
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">00135</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> col1[3], <span class="keywordtype">float</span> <span class="keyword">const</span> col2[3], <span class="keyword">const</span> <span class="keywordtype">float</span> fac)
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137     <span class="keywordtype">float</span> col[3];
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     col[0] = (fac * col1[0] + (1.0f - fac) * col2[0]);
<a name="l00140"></a>00140     col[1] = (fac * col1[1] + (1.0f - fac) * col2[1]);
<a name="l00141"></a>00141     col[2] = (fac * col1[2] + (1.0f - fac) * col2[2]);
<a name="l00142"></a>00142     glColor3fv(col);
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="comment">/* linear horizontal shade within button or in outline */</span>
<a name="l00146"></a>00146 <span class="comment">/* view2d scrollers use it */</span>
<a name="l00147"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#abb6df941004869dc86d5a7d33c05f658">00147</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#abb6df941004869dc86d5a7d33c05f658">uiDrawBoxShade</a>(<span class="keywordtype">int</span> mode, <span class="keywordtype">float</span> minx, <span class="keywordtype">float</span> miny, <span class="keywordtype">float</span> maxx, <span class="keywordtype">float</span> maxy, <span class="keywordtype">float</span> rad, <span class="keywordtype">float</span> shadetop, <span class="keywordtype">float</span> shadedown)
<a name="l00148"></a>00148 {
<a name="l00149"></a>00149     <span class="keywordtype">float</span> vec[7][2] = {{0.195, 0.02}, {0.383, 0.067}, {0.55, 0.169}, {0.707, 0.293},
<a name="l00150"></a>00150                        {0.831, 0.45}, {0.924, 0.617}, {0.98, 0.805}};
<a name="l00151"></a>00151     <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../d7/d35/meshtools_8c.html#aaa0035357cda6d6d6d0e6831ce7c869a">div</a> = maxy - miny;
<a name="l00152"></a>00152     <span class="keyword">const</span> <span class="keywordtype">float</span> idiv = 1.0f / <a class="code" href="../../d7/d35/meshtools_8c.html#aaa0035357cda6d6d6d0e6831ce7c869a">div</a>;
<a name="l00153"></a>00153     <span class="keywordtype">float</span> coltop[3], coldown[3], color[4];
<a name="l00154"></a>00154     <span class="keywordtype">int</span> a;
<a name="l00155"></a>00155     
<a name="l00156"></a>00156     <span class="comment">/* mult */</span>
<a name="l00157"></a>00157     <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00158"></a>00158         vec[a][0] *= rad; vec[a][1] *= rad;
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160     <span class="comment">/* get current color, needs to be outside of glBegin/End */</span>
<a name="l00161"></a>00161     glGetFloatv(GL_CURRENT_COLOR, color);
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <span class="comment">/* &#39;shade&#39; defines strength of shading */</span>   
<a name="l00164"></a>00164     coltop[0] = color[0] + shadetop; <span class="keywordflow">if</span> (coltop[0] &gt; 1.0f) coltop[0] = 1.0f;
<a name="l00165"></a>00165     coltop[1] = color[1] + shadetop; <span class="keywordflow">if</span> (coltop[1] &gt; 1.0f) coltop[1] = 1.0f;
<a name="l00166"></a>00166     coltop[2] = color[2] + shadetop; <span class="keywordflow">if</span> (coltop[2] &gt; 1.0f) coltop[2] = 1.0f;
<a name="l00167"></a>00167     coldown[0] = color[0] + shadedown; <span class="keywordflow">if</span> (coldown[0] &lt; 0.0f) coldown[0] = 0.0f;
<a name="l00168"></a>00168     coldown[1] = color[1] + shadedown; <span class="keywordflow">if</span> (coldown[1] &lt; 0.0f) coldown[1] = 0.0f;
<a name="l00169"></a>00169     coldown[2] = color[2] + shadedown; <span class="keywordflow">if</span> (coldown[2] &lt; 0.0f) coldown[2] = 0.0f;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     glShadeModel(GL_SMOOTH);
<a name="l00172"></a>00172     glBegin(mode);
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="comment">/* start with corner right-bottom */</span>
<a name="l00175"></a>00175     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba4faf5f6a673821f9b25ad6054e50a3a6">UI_CNR_BOTTOM_RIGHT</a>) {
<a name="l00176"></a>00176         
<a name="l00177"></a>00177         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 0.0);
<a name="l00178"></a>00178         glVertex2f(maxx - rad, miny);
<a name="l00179"></a>00179         
<a name="l00180"></a>00180         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00181"></a>00181             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, vec[a][1] * idiv);
<a name="l00182"></a>00182             glVertex2f(maxx - rad + vec[a][0], miny + vec[a][1]);
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184         
<a name="l00185"></a>00185         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, rad * idiv);
<a name="l00186"></a>00186         glVertex2f(maxx, miny + rad);
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188     <span class="keywordflow">else</span> {
<a name="l00189"></a>00189         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 0.0);
<a name="l00190"></a>00190         glVertex2f(maxx, miny);
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192     
<a name="l00193"></a>00193     <span class="comment">/* corner right-top */</span>
<a name="l00194"></a>00194     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649baa847b3b73afd0cc1dde8a31d8b4e3fce">UI_CNR_TOP_RIGHT</a>) {
<a name="l00195"></a>00195         
<a name="l00196"></a>00196         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, (div - rad) * idiv);
<a name="l00197"></a>00197         glVertex2f(maxx, maxy - rad);
<a name="l00198"></a>00198         
<a name="l00199"></a>00199         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00200"></a>00200             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, (div - rad + vec[a][1]) * idiv);
<a name="l00201"></a>00201             glVertex2f(maxx - vec[a][1], maxy - rad + vec[a][0]);
<a name="l00202"></a>00202         }
<a name="l00203"></a>00203         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 1.0);
<a name="l00204"></a>00204         glVertex2f(maxx - rad, maxy);
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206     <span class="keywordflow">else</span> {
<a name="l00207"></a>00207         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 1.0);
<a name="l00208"></a>00208         glVertex2f(maxx, maxy);
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210     
<a name="l00211"></a>00211     <span class="comment">/* corner left-top */</span>
<a name="l00212"></a>00212     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba8caa5a82d9edf3edb0c7803ff59ccc65">UI_CNR_TOP_LEFT</a>) {
<a name="l00213"></a>00213         
<a name="l00214"></a>00214         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 1.0);
<a name="l00215"></a>00215         glVertex2f(minx + rad, maxy);
<a name="l00216"></a>00216         
<a name="l00217"></a>00217         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00218"></a>00218             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, (div - vec[a][1]) * idiv);
<a name="l00219"></a>00219             glVertex2f(minx + rad - vec[a][0], maxy - vec[a][1]);
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221         
<a name="l00222"></a>00222         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, (div - rad) * idiv);
<a name="l00223"></a>00223         glVertex2f(minx, maxy - rad);
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225     <span class="keywordflow">else</span> {
<a name="l00226"></a>00226         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 1.0);
<a name="l00227"></a>00227         glVertex2f(minx, maxy);
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229     
<a name="l00230"></a>00230     <span class="comment">/* corner left-bottom */</span>
<a name="l00231"></a>00231     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba20182239f010b84a5902746abfe3bdc1">UI_CNR_BOTTOM_LEFT</a>) {
<a name="l00232"></a>00232         
<a name="l00233"></a>00233         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, rad * idiv);
<a name="l00234"></a>00234         glVertex2f(minx, miny + rad);
<a name="l00235"></a>00235         
<a name="l00236"></a>00236         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00237"></a>00237             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, (rad - vec[a][1]) * idiv);
<a name="l00238"></a>00238             glVertex2f(minx + vec[a][1], miny + rad - vec[a][0]);
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240         
<a name="l00241"></a>00241         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 0.0);
<a name="l00242"></a>00242         glVertex2f(minx + rad, miny);
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244     <span class="keywordflow">else</span> {
<a name="l00245"></a>00245         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(coltop, coldown, 0.0);
<a name="l00246"></a>00246         glVertex2f(minx, miny);
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248     
<a name="l00249"></a>00249     glEnd();
<a name="l00250"></a>00250     glShadeModel(GL_FLAT);
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">/* linear vertical shade within button or in outline */</span>
<a name="l00254"></a>00254 <span class="comment">/* view2d scrollers use it */</span>
<a name="l00255"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#af80f77f232e56a17ad7f0ee034563178">00255</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#af80f77f232e56a17ad7f0ee034563178">uiDrawBoxVerticalShade</a>(<span class="keywordtype">int</span> mode, <span class="keywordtype">float</span> minx, <span class="keywordtype">float</span> miny, <span class="keywordtype">float</span> maxx, <span class="keywordtype">float</span> maxy, <span class="keywordtype">float</span> rad, <span class="keywordtype">float</span> shadeLeft, <span class="keywordtype">float</span> shadeRight)
<a name="l00256"></a>00256 {
<a name="l00257"></a>00257     <span class="keywordtype">float</span> vec[7][2] = {{0.195, 0.02}, {0.383, 0.067}, {0.55, 0.169}, {0.707, 0.293},
<a name="l00258"></a>00258                        {0.831, 0.45}, {0.924, 0.617}, {0.98, 0.805}};
<a name="l00259"></a>00259     <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../d7/d35/meshtools_8c.html#aaa0035357cda6d6d6d0e6831ce7c869a">div</a> = maxx - minx;
<a name="l00260"></a>00260     <span class="keyword">const</span> <span class="keywordtype">float</span> idiv = 1.0f / <a class="code" href="../../d7/d35/meshtools_8c.html#aaa0035357cda6d6d6d0e6831ce7c869a">div</a>;
<a name="l00261"></a>00261     <span class="keywordtype">float</span> colLeft[3], colRight[3], color[4];
<a name="l00262"></a>00262     <span class="keywordtype">int</span> a;
<a name="l00263"></a>00263     
<a name="l00264"></a>00264     <span class="comment">/* mult */</span>
<a name="l00265"></a>00265     <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00266"></a>00266         vec[a][0] *= rad; vec[a][1] *= rad;
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268     <span class="comment">/* get current color, needs to be outside of glBegin/End */</span>
<a name="l00269"></a>00269     glGetFloatv(GL_CURRENT_COLOR, color);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="comment">/* &#39;shade&#39; defines strength of shading */</span>   
<a name="l00272"></a>00272     colLeft[0] = color[0] + shadeLeft; <span class="keywordflow">if</span> (colLeft[0] &gt; 1.0f) colLeft[0] = 1.0f;
<a name="l00273"></a>00273     colLeft[1] = color[1] + shadeLeft; <span class="keywordflow">if</span> (colLeft[1] &gt; 1.0f) colLeft[1] = 1.0f;
<a name="l00274"></a>00274     colLeft[2] = color[2] + shadeLeft; <span class="keywordflow">if</span> (colLeft[2] &gt; 1.0f) colLeft[2] = 1.0f;
<a name="l00275"></a>00275     colRight[0] = color[0] + shadeRight; <span class="keywordflow">if</span> (colRight[0] &lt; 0.0f) colRight[0] = 0.0f;
<a name="l00276"></a>00276     colRight[1] = color[1] + shadeRight; <span class="keywordflow">if</span> (colRight[1] &lt; 0.0f) colRight[1] = 0.0f;
<a name="l00277"></a>00277     colRight[2] = color[2] + shadeRight; <span class="keywordflow">if</span> (colRight[2] &lt; 0.0f) colRight[2] = 0.0f;
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     glShadeModel(GL_SMOOTH);
<a name="l00280"></a>00280     glBegin(mode);
<a name="l00281"></a>00281 
<a name="l00282"></a>00282     <span class="comment">/* start with corner right-bottom */</span>
<a name="l00283"></a>00283     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba4faf5f6a673821f9b25ad6054e50a3a6">UI_CNR_BOTTOM_RIGHT</a>) {
<a name="l00284"></a>00284         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 0.0);
<a name="l00285"></a>00285         glVertex2f(maxx - rad, miny);
<a name="l00286"></a>00286         
<a name="l00287"></a>00287         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00288"></a>00288             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, vec[a][0] * idiv);
<a name="l00289"></a>00289             glVertex2f(maxx - rad + vec[a][0], miny + vec[a][1]);
<a name="l00290"></a>00290         }
<a name="l00291"></a>00291         
<a name="l00292"></a>00292         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, rad * idiv);
<a name="l00293"></a>00293         glVertex2f(maxx, miny + rad);
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295     <span class="keywordflow">else</span> {
<a name="l00296"></a>00296         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 0.0);
<a name="l00297"></a>00297         glVertex2f(maxx, miny);
<a name="l00298"></a>00298     }
<a name="l00299"></a>00299     
<a name="l00300"></a>00300     <span class="comment">/* corner right-top */</span>
<a name="l00301"></a>00301     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649baa847b3b73afd0cc1dde8a31d8b4e3fce">UI_CNR_TOP_RIGHT</a>) {
<a name="l00302"></a>00302         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 0.0);
<a name="l00303"></a>00303         glVertex2f(maxx, maxy - rad);
<a name="l00304"></a>00304         
<a name="l00305"></a>00305         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00306"></a>00306             
<a name="l00307"></a>00307             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, (div - rad - vec[a][0]) * idiv);
<a name="l00308"></a>00308             glVertex2f(maxx - vec[a][1], maxy - rad + vec[a][0]);
<a name="l00309"></a>00309         }
<a name="l00310"></a>00310         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, (div - rad) * idiv);
<a name="l00311"></a>00311         glVertex2f(maxx - rad, maxy);
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313     <span class="keywordflow">else</span> {
<a name="l00314"></a>00314         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 0.0);
<a name="l00315"></a>00315         glVertex2f(maxx, maxy);
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317     
<a name="l00318"></a>00318     <span class="comment">/* corner left-top */</span>
<a name="l00319"></a>00319     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba8caa5a82d9edf3edb0c7803ff59ccc65">UI_CNR_TOP_LEFT</a>) {
<a name="l00320"></a>00320         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, (div - rad) * idiv);
<a name="l00321"></a>00321         glVertex2f(minx + rad, maxy);
<a name="l00322"></a>00322         
<a name="l00323"></a>00323         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00324"></a>00324             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, (div - rad + vec[a][0]) * idiv);
<a name="l00325"></a>00325             glVertex2f(minx + rad - vec[a][0], maxy - vec[a][1]);
<a name="l00326"></a>00326         }
<a name="l00327"></a>00327         
<a name="l00328"></a>00328         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 1.0);
<a name="l00329"></a>00329         glVertex2f(minx, maxy - rad);
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331     <span class="keywordflow">else</span> {
<a name="l00332"></a>00332         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 1.0);
<a name="l00333"></a>00333         glVertex2f(minx, maxy);
<a name="l00334"></a>00334     }
<a name="l00335"></a>00335     
<a name="l00336"></a>00336     <span class="comment">/* corner left-bottom */</span>
<a name="l00337"></a>00337     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba20182239f010b84a5902746abfe3bdc1">UI_CNR_BOTTOM_LEFT</a>) {
<a name="l00338"></a>00338         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 1.0);
<a name="l00339"></a>00339         glVertex2f(minx, miny + rad);
<a name="l00340"></a>00340         
<a name="l00341"></a>00341         <span class="keywordflow">for</span> (a = 0; a &lt; 7; a++) {
<a name="l00342"></a>00342             <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, (vec[a][0]) * idiv);
<a name="l00343"></a>00343             glVertex2f(minx + vec[a][1], miny + rad - vec[a][0]);
<a name="l00344"></a>00344         }
<a name="l00345"></a>00345         
<a name="l00346"></a>00346         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 1.0);
<a name="l00347"></a>00347         glVertex2f(minx + rad, miny);
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349     <span class="keywordflow">else</span> {
<a name="l00350"></a>00350         <a class="code" href="../../d7/d86/interface__draw_8c.html#a77e25356476b05889744e61bf8b0a40f">round_box_shade_col</a>(colLeft, colRight, 1.0);
<a name="l00351"></a>00351         glVertex2f(minx, miny);
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353     
<a name="l00354"></a>00354     glEnd();
<a name="l00355"></a>00355     glShadeModel(GL_FLAT);
<a name="l00356"></a>00356 }
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 <span class="comment">/* plain antialiased unfilled rectangle */</span>
<a name="l00359"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#af3551ec134082184ab65e8ecad592d9a">00359</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#af3551ec134082184ab65e8ecad592d9a">uiRoundRect</a>(<span class="keywordtype">float</span> minx, <span class="keywordtype">float</span> miny, <span class="keywordtype">float</span> maxx, <span class="keywordtype">float</span> maxy, <span class="keywordtype">float</span> rad)
<a name="l00360"></a>00360 {
<a name="l00361"></a>00361     <span class="keywordtype">float</span> color[4];
<a name="l00362"></a>00362     
<a name="l00363"></a>00363     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#acf27afb01eaa6e7a6263ab874332e495">UI_RB_ALPHA</a>) {
<a name="l00364"></a>00364         glGetFloatv(GL_CURRENT_COLOR, color);
<a name="l00365"></a>00365         color[3] = 0.5;
<a name="l00366"></a>00366         glColor4fv(color);
<a name="l00367"></a>00367         glEnable(GL_BLEND);
<a name="l00368"></a>00368     }
<a name="l00369"></a>00369     
<a name="l00370"></a>00370     <span class="comment">/* set antialias line */</span>
<a name="l00371"></a>00371     glEnable(GL_LINE_SMOOTH);
<a name="l00372"></a>00372     glEnable(GL_BLEND);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_LINE_LOOP, minx, miny, maxx, maxy, rad);
<a name="l00375"></a>00375    
<a name="l00376"></a>00376     glDisable(GL_BLEND);
<a name="l00377"></a>00377     glDisable(GL_LINE_SMOOTH);
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">/* (old, used in outliner) plain antialiased filled box */</span>
<a name="l00381"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a5dc97f8bfa5592225dc4966ae18fe85d">00381</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5dc97f8bfa5592225dc4966ae18fe85d">uiRoundBox</a>(<span class="keywordtype">float</span> minx, <span class="keywordtype">float</span> miny, <span class="keywordtype">float</span> maxx, <span class="keywordtype">float</span> maxy, <span class="keywordtype">float</span> rad)
<a name="l00382"></a>00382 {
<a name="l00383"></a>00383     <span class="keywordtype">float</span> color[4];
<a name="l00384"></a>00384     
<a name="l00385"></a>00385     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d86/interface__draw_8c.html#a17ca4ae3460d8217fdcf12b3d9502fbe">roundboxtype</a> &amp; <a class="code" href="../../d8/d1e/UI__interface_8h.html#acf27afb01eaa6e7a6263ab874332e495">UI_RB_ALPHA</a>) {
<a name="l00386"></a>00386         glGetFloatv(GL_CURRENT_COLOR, color);
<a name="l00387"></a>00387         color[3] = 0.5;
<a name="l00388"></a>00388         glColor4fv(color);
<a name="l00389"></a>00389         glEnable(GL_BLEND);
<a name="l00390"></a>00390     }
<a name="l00391"></a>00391     
<a name="l00392"></a>00392     <a class="code" href="../../d1/d2f/interface__intern_8h.html#aaa9ac42a4ee2d966baf22fb548f955c5">ui_draw_anti_roundbox</a>(GL_POLYGON, minx, miny, maxx, maxy, rad);
<a name="l00393"></a>00393 }
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="comment">/* ************** generic embossed rect, for window sliders etc ************* */</span>
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="comment">/* text_draw.c uses this */</span>
<a name="l00400"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#aca7f540251968c67c16e8cdd40e53b38">00400</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#aca7f540251968c67c16e8cdd40e53b38">uiEmboss</a>(<span class="keywordtype">float</span> x1, <span class="keywordtype">float</span> y1, <span class="keywordtype">float</span> x2, <span class="keywordtype">float</span> y2, <span class="keywordtype">int</span> sel)
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402     
<a name="l00403"></a>00403     <span class="comment">/* below */</span>
<a name="l00404"></a>00404     <span class="keywordflow">if</span> (sel) glColor3ub(200, 200, 200);
<a name="l00405"></a>00405     <span class="keywordflow">else</span> glColor3ub(50, 50, 50);
<a name="l00406"></a>00406     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(x1, y1, x2, y1);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408     <span class="comment">/* right */</span>
<a name="l00409"></a>00409     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(x2, y1, x2, y2);
<a name="l00410"></a>00410     
<a name="l00411"></a>00411     <span class="comment">/* top */</span>
<a name="l00412"></a>00412     <span class="keywordflow">if</span> (sel) glColor3ub(50, 50, 50);
<a name="l00413"></a>00413     <span class="keywordflow">else</span> glColor3ub(200, 200, 200);
<a name="l00414"></a>00414     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(x1, y2, x2, y2);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416     <span class="comment">/* left */</span>
<a name="l00417"></a>00417     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(x1, y1, x1, y2);
<a name="l00418"></a>00418     
<a name="l00419"></a>00419 }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 <span class="comment">/* ************** SPECIAL BUTTON DRAWING FUNCTIONS ************* */</span>
<a name="l00422"></a>00422 
<a name="l00423"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a28b5812589f79f5898dbaacfa8417366">00423</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a28b5812589f79f5898dbaacfa8417366">ui_draw_but_IMAGE</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ar), <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(wcol), <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *rect)
<a name="l00424"></a>00424 {
<a name="l00425"></a>00425 <span class="preprocessor">#ifdef WITH_HEADLESS</span>
<a name="l00426"></a>00426 <span class="preprocessor"></span>    (void)rect;
<a name="l00427"></a>00427     (void)but;
<a name="l00428"></a>00428 <span class="preprocessor">#else</span>
<a name="l00429"></a>00429 <span class="preprocessor"></span>    <a class="code" href="../../d3/dd9/structImBuf.html">ImBuf</a> *ibuf = (<a class="code" href="../../d3/dd9/structImBuf.html">ImBuf</a> *)but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a8376dbee35a2eef4197223c5ecc18963">poin</a>;
<a name="l00430"></a>00430     <span class="comment">//GLint scissor[4];</span>
<a name="l00431"></a>00431     <span class="comment">//int w, h;</span>
<a name="l00432"></a>00432 
<a name="l00433"></a>00433     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (!ibuf) <span class="keywordflow">return</span>;
<a name="l00434"></a>00434     
<a name="l00435"></a>00435     <span class="comment">/* scissor doesn&#39;t seem to be doing the right thing...? */</span>
<a name="l00436"></a>00436 <span class="preprocessor">#if 0</span>
<a name="l00437"></a>00437 <span class="preprocessor"></span>    <span class="comment">//glColor4f(1.0, 0.f, 0.f, 1.f);</span>
<a name="l00438"></a>00438     <span class="comment">//fdrawbox(rect-&gt;xmin, rect-&gt;ymin, rect-&gt;xmax, rect-&gt;ymax)</span>
<a name="l00439"></a>00439 
<a name="l00440"></a>00440     w = (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>);
<a name="l00441"></a>00441     h = (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>);
<a name="l00442"></a>00442     <span class="comment">// prevent drawing outside widget area</span>
<a name="l00443"></a>00443     glGetIntegerv(GL_SCISSOR_BOX, scissor);
<a name="l00444"></a>00444     glScissor(ar-&gt;winrct.xmin + rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, ar-&gt;winrct.ymin + rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, w, h);
<a name="l00445"></a>00445 <span class="preprocessor">#endif</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span>    
<a name="l00447"></a>00447     glEnable(GL_BLEND);
<a name="l00448"></a>00448     glColor4f(0.0, 0.0, 0.0, 0.0);
<a name="l00449"></a>00449     
<a name="l00450"></a>00450     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#af25e117bcafaaa076b5c533978ac52f6">glaDrawPixelsSafe</a>((<span class="keywordtype">float</span>)rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, (<span class="keywordtype">float</span>)rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ae7734bc51f5e3e75be66e6f6a26f4f4e">x</a>, ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#a9b88fc1c373dd2aa0d4c174c87913050">y</a>, ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ae7734bc51f5e3e75be66e6f6a26f4f4e">x</a>, GL_RGBA, GL_UNSIGNED_BYTE, ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ade8b2f05559e57840af8d3657817f8c8">rect</a>);
<a name="l00451"></a>00451     <span class="comment">//glaDrawPixelsTex((float)rect-&gt;xmin, (float)rect-&gt;ymin, ibuf-&gt;x, ibuf-&gt;y, GL_UNSIGNED_BYTE, ibuf-&gt;rect);</span>
<a name="l00452"></a>00452     
<a name="l00453"></a>00453     glDisable(GL_BLEND);
<a name="l00454"></a>00454     
<a name="l00455"></a>00455 <span class="preprocessor">#if 0</span>
<a name="l00456"></a>00456 <span class="preprocessor"></span>    <span class="comment">// restore scissortest</span>
<a name="l00457"></a>00457     glScissor(scissor[0], scissor[1], scissor[2], scissor[3]);
<a name="l00458"></a>00458 <span class="preprocessor">#endif</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span>    
<a name="l00460"></a>00460 <span class="preprocessor">#endif</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span>}
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 <span class="preprocessor">#if 0</span>
<a name="l00464"></a>00464 <span class="preprocessor"></span><span class="preprocessor">#ifdef WITH_INTERNATIONAL</span>
<a name="l00465"></a>00465 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> ui_draw_but_CHARTAB(<a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but)
<a name="l00466"></a>00466 {
<a name="l00467"></a>00467     <span class="comment">/* XXX 2.50 bad global access */</span>
<a name="l00468"></a>00468     <span class="comment">/* Some local variables */</span>
<a name="l00469"></a>00469     <span class="keywordtype">float</span> sx, sy, ex, ey;
<a name="l00470"></a>00470     <span class="keywordtype">float</span> width, height;
<a name="l00471"></a>00471     <span class="keywordtype">float</span> butw, buth;
<a name="l00472"></a>00472     <span class="keywordtype">int</span> x, y, cs;
<a name="l00473"></a>00473     <span class="keywordtype">wchar_t</span> wstr[2];
<a name="l00474"></a>00474     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ustr[16];
<a name="l00475"></a>00475     <a class="code" href="../../dd/d77/structPackedFile.html">PackedFile</a> *<a class="code" href="../../d8/d9d/gim__memory_8h.html#aa7421a08567e946189db67fbebfb88e0" title="Prefetch 64.">pf</a>;
<a name="l00476"></a>00476     <span class="keywordtype">int</span> result = 0;
<a name="l00477"></a>00477     <span class="keywordtype">int</span> charmax = <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.charmax;
<a name="l00478"></a>00478     
<a name="l00479"></a>00479     <span class="comment">/* FO_BUILTIN_NAME font in use. There are TTF FO_BUILTIN_NAME and non-TTF FO_BUILTIN_NAME fonts */</span>
<a name="l00480"></a>00480     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;name, <a class="code" href="../../de/dcc/DNA__vfont__types_8h.html#a6c156185941e8d7776c0536b0f392201">FO_BUILTIN_NAME</a>)) {
<a name="l00481"></a>00481         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.ui_international == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l00482"></a>00482             charmax = 0xff;
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484         <span class="keywordflow">else</span> {
<a name="l00485"></a>00485             charmax = 0xff;
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487     }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <span class="comment">/* Category list exited without selecting the area */</span>
<a name="l00490"></a>00490     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.charmax == 0)
<a name="l00491"></a>00491         charmax = <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.charmax = 0xffff;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493     <span class="comment">/* Calculate the size of the button */</span>
<a name="l00494"></a>00494     width = <a class="code" href="../../d1/d22/stdosl_8h.html#a1200284b0188ff3732b55b964e5e3a25">abs</a>(rect-&gt;xmax - rect-&gt;xmin);
<a name="l00495"></a>00495     height = <a class="code" href="../../d1/d22/stdosl_8h.html#a1200284b0188ff3732b55b964e5e3a25">abs</a>(rect-&gt;ymax - rect-&gt;ymin);
<a name="l00496"></a>00496     
<a name="l00497"></a>00497     butw = floor(width / 12);
<a name="l00498"></a>00498     buth = floor(height / 6);
<a name="l00499"></a>00499     
<a name="l00500"></a>00500     <span class="comment">/* Initialize variables */</span>
<a name="l00501"></a>00501     sx = rect-&gt;xmin;
<a name="l00502"></a>00502     ex = rect-&gt;xmin + butw;
<a name="l00503"></a>00503     sy = rect-&gt;ymin + height - buth;
<a name="l00504"></a>00504     ey = rect-&gt;ymin + height;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     cs = <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.charstart;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508     <span class="comment">/* Set the font, in case it is not FO_BUILTIN_NAME font */</span>
<a name="l00509"></a>00509     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont &amp;&amp; strcmp(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;name, <a class="code" href="../../de/dcc/DNA__vfont__types_8h.html#a6c156185941e8d7776c0536b0f392201">FO_BUILTIN_NAME</a>)) {
<a name="l00510"></a>00510         <span class="comment">// Is the font file packed, if so then use the packed file</span>
<a name="l00511"></a>00511         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;packedfile) {
<a name="l00512"></a>00512             pf = <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;packedfile;     
<a name="l00513"></a>00513             FTF_SetFont(pf-&gt;<a class="code" href="../../dd/d77/structPackedFile.html#ab26282078abf88909ab32213a4290f8e">data</a>, pf-&gt;<a class="code" href="../../dd/d77/structPackedFile.html#ab46e545f88274c5c348303a84fd735d6">size</a>, 14.0);
<a name="l00514"></a>00514         }
<a name="l00515"></a>00515         <span class="keywordflow">else</span> {
<a name="l00516"></a>00516             <span class="keywordtype">char</span> tmpStr[256];
<a name="l00517"></a>00517             <span class="keywordtype">int</span> <a class="code" href="../../df/db3/freetypefont_8c.html#ab596967142db56aa5fbafe7c234eedda">err</a>;
<a name="l00518"></a>00518 
<a name="l00519"></a>00519             <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(tmpStr, <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;name, <span class="keyword">sizeof</span>(tmpStr));
<a name="l00520"></a>00520             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a779fd31715eb05e3322500e3426b03a2">BLI_path_abs</a>(tmpStr, <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name);
<a name="l00521"></a>00521             err = FTF_SetFont((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)tmpStr, 0, 14.0);
<a name="l00522"></a>00522         }
<a name="l00523"></a>00523     }
<a name="l00524"></a>00524     <span class="keywordflow">else</span> {
<a name="l00525"></a>00525         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.ui_international == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l00526"></a>00526             FTF_SetFont((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="../../d7/d05/bfont_8ttf_8c.html#a28960991de63a9f4f8911e43556a467d">datatoc_bfont_ttf</a>, <a class="code" href="../../d7/d05/bfont_8ttf_8c.html#a4b53bed62585bc7f69930f52cb8c80ea">datatoc_bfont_ttf_size</a>, 14.0);
<a name="l00527"></a>00527         }
<a name="l00528"></a>00528     }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530     <span class="comment">/* Start drawing the button itself */</span>
<a name="l00531"></a>00531     glShadeModel(GL_SMOOTH);
<a name="l00532"></a>00532 
<a name="l00533"></a>00533     glColor3ub(200,  200,  200);
<a name="l00534"></a>00534     glRectf((rect-&gt;xmin), (rect-&gt;ymin), (rect-&gt;xmax), (rect-&gt;ymax));
<a name="l00535"></a>00535 
<a name="l00536"></a>00536     glColor3ub(0,  0,  0);
<a name="l00537"></a>00537     <span class="keywordflow">for</span> (y = 0; y &lt; 6; y++) {
<a name="l00538"></a>00538         <span class="comment">// Do not draw more than the category allows</span>
<a name="l00539"></a>00539         <span class="keywordflow">if</span> (cs &gt; charmax) <span class="keywordflow">break</span>;
<a name="l00540"></a>00540 
<a name="l00541"></a>00541         <span class="keywordflow">for</span> (x = 0; x &lt; 12; x++)
<a name="l00542"></a>00542         {
<a name="l00543"></a>00543             <span class="comment">// Do not draw more than the category allows</span>
<a name="l00544"></a>00544             <span class="keywordflow">if</span> (cs &gt; charmax) <span class="keywordflow">break</span>;
<a name="l00545"></a>00545 
<a name="l00546"></a>00546             <span class="comment">// Draw one grid cell</span>
<a name="l00547"></a>00547             glBegin(GL_LINE_LOOP);
<a name="l00548"></a>00548             glVertex2f(sx, sy);
<a name="l00549"></a>00549             glVertex2f(ex, sy);
<a name="l00550"></a>00550             glVertex2f(ex, ey);
<a name="l00551"></a>00551             glVertex2f(sx, ey);
<a name="l00552"></a>00552             glEnd();    
<a name="l00553"></a>00553 
<a name="l00554"></a>00554             <span class="comment">// Draw character inside the cell</span>
<a name="l00555"></a>00555             memset(wstr, 0, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>) * 2);
<a name="l00556"></a>00556             memset(ustr, 0, 16);
<a name="l00557"></a>00557 
<a name="l00558"></a>00558             <span class="comment">// Set the font to be either unicode or FO_BUILTIN_NAME </span>
<a name="l00559"></a>00559             wstr[0] = cs;
<a name="l00560"></a>00560             <span class="keywordflow">if</span> (strcmp(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;name, <a class="code" href="../../de/dcc/DNA__vfont__types_8h.html#a6c156185941e8d7776c0536b0f392201">FO_BUILTIN_NAME</a>)) {
<a name="l00561"></a>00561                 <a class="code" href="../../dd/d83/BLI__string__utf8_8h.html#a6aa6b4adc5859c245cdb1799ced9690b">BLI_strncpy_wchar_as_utf8</a>((<span class="keywordtype">char</span> *)ustr, (<span class="keywordtype">wchar_t</span> *)wstr, <span class="keyword">sizeof</span>(ustr));
<a name="l00562"></a>00562             }
<a name="l00563"></a>00563             <span class="keywordflow">else</span> {
<a name="l00564"></a>00564                 <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.ui_international == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l00565"></a>00565                     <a class="code" href="../../dd/d83/BLI__string__utf8_8h.html#a6aa6b4adc5859c245cdb1799ced9690b">BLI_strncpy_wchar_as_utf8</a>((<span class="keywordtype">char</span> *)ustr, (<span class="keywordtype">wchar_t</span> *)wstr, <span class="keyword">sizeof</span>(ustr));
<a name="l00566"></a>00566                 }
<a name="l00567"></a>00567                 <span class="keywordflow">else</span> {
<a name="l00568"></a>00568                     ustr[0] = cs;
<a name="l00569"></a>00569                     ustr[1] = 0;
<a name="l00570"></a>00570                 }
<a name="l00571"></a>00571             }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573             <span class="keywordflow">if</span> ((<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont &amp;&amp; strcmp(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;name, <a class="code" href="../../de/dcc/DNA__vfont__types_8h.html#a6c156185941e8d7776c0536b0f392201">FO_BUILTIN_NAME</a>)) ||
<a name="l00574"></a>00574                 (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont &amp;&amp; !strcmp(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.selfont-&gt;name, <a class="code" href="../../de/dcc/DNA__vfont__types_8h.html#a6c156185941e8d7776c0536b0f392201">FO_BUILTIN_NAME</a>) &amp;&amp; <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.ui_international == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>))
<a name="l00575"></a>00575             {
<a name="l00576"></a>00576                 <span class="keywordtype">float</span> wid;
<a name="l00577"></a>00577                 <span class="keywordtype">float</span> llx, lly, llz, urx, ury, urz;
<a name="l00578"></a>00578                 <span class="keywordtype">float</span> dx, dy;
<a name="l00579"></a>00579                 <span class="keywordtype">float</span> px, py;
<a name="l00580"></a>00580     
<a name="l00581"></a>00581                 <span class="comment">// Calculate the position</span>
<a name="l00582"></a>00582                 wid = FTF_GetStringWidth((<span class="keywordtype">char</span> *) ustr, FTF_USE_GETTEXT | FTF_INPUT_UTF8);
<a name="l00583"></a>00583                 FTF_GetBoundingBox((<span class="keywordtype">char</span> *) ustr, &amp;llx, &amp;lly, &amp;llz, &amp;urx, &amp;ury, &amp;urz, FTF_USE_GETTEXT | FTF_INPUT_UTF8);
<a name="l00584"></a>00584                 dx = urx - llx;
<a name="l00585"></a>00585                 dy = ury - lly;
<a name="l00586"></a>00586 
<a name="l00587"></a>00587                 <span class="comment">// This isn&#39;t fully functional since the but-&gt;aspect isn&#39;t working like I suspected</span>
<a name="l00588"></a>00588                 px = sx + ((butw / but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a>) - dx) / 2;
<a name="l00589"></a>00589                 py = sy + ((buth / but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a>) - dy) / 2;
<a name="l00590"></a>00590 
<a name="l00591"></a>00591                 <span class="comment">// Set the position and draw the character</span>
<a name="l00592"></a>00592                 ui_rasterpos_safe(px, py, but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a>);
<a name="l00593"></a>00593                 FTF_DrawString((<span class="keywordtype">char</span> *) ustr, FTF_USE_GETTEXT | FTF_INPUT_UTF8);
<a name="l00594"></a>00594             }
<a name="l00595"></a>00595             <span class="keywordflow">else</span> {
<a name="l00596"></a>00596                 ui_rasterpos_safe(sx + butw / 2, sy + buth / 2, but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a>);
<a name="l00597"></a>00597                 <a class="code" href="../../d8/d1e/UI__interface_8h.html#a2712564246b0177fb64d88224864eeec">UI_DrawString</a>(but-&gt;font, (<span class="keywordtype">char</span> *) ustr, 0);
<a name="l00598"></a>00598             }
<a name="l00599"></a>00599     
<a name="l00600"></a>00600             <span class="comment">// Calculate the next position and character</span>
<a name="l00601"></a>00601             sx += butw; ex += butw;
<a name="l00602"></a>00602             cs++;
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604         <span class="comment">/* Add the y position and reset x position */</span>
<a name="l00605"></a>00605         sy -= buth; 
<a name="l00606"></a>00606         ey -= buth;
<a name="l00607"></a>00607         sx = rect-&gt;xmin;
<a name="l00608"></a>00608         ex = rect-&gt;xmin + butw;
<a name="l00609"></a>00609     }   
<a name="l00610"></a>00610     glShadeModel(GL_FLAT);
<a name="l00611"></a>00611 
<a name="l00612"></a>00612     <span class="comment">/* Return Font Settings to original */</span>
<a name="l00613"></a>00613     <span class="keywordflow">if</span> (<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.fontsize &amp;&amp; <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.fontname[0]) {
<a name="l00614"></a>00614         result = FTF_SetFont((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.fontname, 0, <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.fontsize);
<a name="l00615"></a>00615     }
<a name="l00616"></a>00616     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.fontsize) {
<a name="l00617"></a>00617         result = FTF_SetFont((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="../../d7/d05/bfont_8ttf_8c.html#a28960991de63a9f4f8911e43556a467d">datatoc_bfont_ttf</a>, <a class="code" href="../../d7/d05/bfont_8ttf_8c.html#a4b53bed62585bc7f69930f52cb8c80ea">datatoc_bfont_ttf_size</a>, <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.fontsize);
<a name="l00618"></a>00618     }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620     <span class="keywordflow">if</span> (result == 0) {
<a name="l00621"></a>00621         result = FTF_SetFont((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="../../d7/d05/bfont_8ttf_8c.html#a28960991de63a9f4f8911e43556a467d">datatoc_bfont_ttf</a>, <a class="code" href="../../d7/d05/bfont_8ttf_8c.html#a4b53bed62585bc7f69930f52cb8c80ea">datatoc_bfont_ttf_size</a>, 11);
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623     
<a name="l00624"></a>00624     <span class="comment">/* resets the font size */</span>
<a name="l00625"></a>00625     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.ui_international == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l00626"></a>00626         <span class="comment">// uiSetCurFont(but-&gt;block, UI_HELV);</span>
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628 }
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="preprocessor">#endif // WITH_INTERNATIONAL</span>
<a name="l00631"></a>00631 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00632"></a>00632 <span class="preprocessor"></span>
<a name="l00633"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a604dc63ba4a80cb69c19153cc220a268">00633</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a604dc63ba4a80cb69c19153cc220a268">draw_scope_end</a>(<a class="code" href="../../da/d10/structrctf.html">rctf</a> *rect, GLint *scissor)
<a name="l00634"></a>00634 {
<a name="l00635"></a>00635     <span class="keywordtype">float</span> scaler_x1, scaler_x2;
<a name="l00636"></a>00636     
<a name="l00637"></a>00637     <span class="comment">/* restore scissortest */</span>
<a name="l00638"></a>00638     glScissor(scissor[0], scissor[1], scissor[2], scissor[3]);
<a name="l00639"></a>00639     
<a name="l00640"></a>00640     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00641"></a>00641     
<a name="l00642"></a>00642     <span class="comment">/* scale widget */</span>
<a name="l00643"></a>00643     scaler_x1 = rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> + (rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) / 2 - <a class="code" href="../../d1/d2f/interface__intern_8h.html#a52b052f783f39b4ca186fc07c9a5ae28">SCOPE_RESIZE_PAD</a>;
<a name="l00644"></a>00644     scaler_x2 = rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> + (rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) / 2 + <a class="code" href="../../d1/d2f/interface__intern_8h.html#a52b052f783f39b4ca186fc07c9a5ae28">SCOPE_RESIZE_PAD</a>;
<a name="l00645"></a>00645     
<a name="l00646"></a>00646     glColor4f(0.f, 0.f, 0.f, 0.25f);
<a name="l00647"></a>00647     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(scaler_x1, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 4, scaler_x2, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 4);
<a name="l00648"></a>00648     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(scaler_x1, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 7, scaler_x2, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 7);
<a name="l00649"></a>00649     glColor4f(1.f, 1.f, 1.f, 0.25f);
<a name="l00650"></a>00650     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(scaler_x1, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 5, scaler_x2, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 5);
<a name="l00651"></a>00651     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(scaler_x1, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 8, scaler_x2, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 8);
<a name="l00652"></a>00652     
<a name="l00653"></a>00653     <span class="comment">/* outline */</span>
<a name="l00654"></a>00654     glColor4f(0.f, 0.f, 0.f, 0.5f);
<a name="l00655"></a>00655     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba7e9af1d815f4277196ed35a049f74148">UI_CNR_ALL</a>);
<a name="l00656"></a>00656     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_LINE_LOOP, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - 1, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + 1, rect-&gt;<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + 1, 3.0f);
<a name="l00657"></a>00657 }
<a name="l00658"></a>00658 
<a name="l00659"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#aabcf1a2a47ef0f702a95b6a81ed1b948">00659</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#aabcf1a2a47ef0f702a95b6a81ed1b948">histogram_draw_one</a>(<span class="keywordtype">float</span> r, <span class="keywordtype">float</span> <a class="code" href="../../dd/d05/noise_8c.html#aff056b2f79b1fecd20667df6d20f81d6">g</a>, <span class="keywordtype">float</span> b, <span class="keywordtype">float</span> alpha, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> w, <span class="keywordtype">float</span> h, <span class="keywordtype">float</span> *<a class="code" href="../../d2/d3a/AUD__JOSResampleReader_8cpp.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>, <span class="keywordtype">int</span> res)
<a name="l00660"></a>00660 {
<a name="l00661"></a>00661     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00662"></a>00662     
<a name="l00663"></a>00663     <span class="comment">/* under the curve */</span>
<a name="l00664"></a>00664     glBlendFunc(GL_SRC_ALPHA, GL_ONE);
<a name="l00665"></a>00665     glColor4f(r, g, b, alpha);
<a name="l00666"></a>00666     
<a name="l00667"></a>00667     glShadeModel(GL_FLAT);
<a name="l00668"></a>00668     glBegin(GL_QUAD_STRIP);
<a name="l00669"></a>00669     glVertex2f(x, y);
<a name="l00670"></a>00670     glVertex2f(x, y + (data[0] * h));
<a name="l00671"></a>00671     <span class="keywordflow">for</span> (i = 1; i &lt; res; i++) {
<a name="l00672"></a>00672         <span class="keywordtype">float</span> x2 = x + i * (w / (float)res);
<a name="l00673"></a>00673         glVertex2f(x2, y + (data[i] * h));
<a name="l00674"></a>00674         glVertex2f(x2, y);
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676     glEnd();
<a name="l00677"></a>00677     
<a name="l00678"></a>00678     <span class="comment">/* curve outline */</span>
<a name="l00679"></a>00679     glColor4f(0.f, 0.f, 0.f, 0.25f);
<a name="l00680"></a>00680     
<a name="l00681"></a>00681     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00682"></a>00682     glEnable(GL_LINE_SMOOTH);
<a name="l00683"></a>00683     glBegin(GL_LINE_STRIP);
<a name="l00684"></a>00684     <span class="keywordflow">for</span> (i = 0; i &lt; res; i++) {
<a name="l00685"></a>00685         <span class="keywordtype">float</span> x2 = x + i * (w / (float)res);
<a name="l00686"></a>00686         glVertex2f(x2, y + (data[i] * h));
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688     glEnd();
<a name="l00689"></a>00689     glDisable(GL_LINE_SMOOTH);
<a name="l00690"></a>00690 }
<a name="l00691"></a>00691 
<a name="l00692"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a573586c6c0c45487ff2e1ce222fc4ca7">00692</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a573586c6c0c45487ff2e1ce222fc4ca7">ui_draw_but_HISTOGRAM</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(wcol), <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *recti)
<a name="l00693"></a>00693 {
<a name="l00694"></a>00694     <a class="code" href="../../d4/d8b/structHistogram.html">Histogram</a> *hist = (<a class="code" href="../../d4/d8b/structHistogram.html">Histogram</a> *)but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a8376dbee35a2eef4197223c5ecc18963">poin</a>;
<a name="l00695"></a>00695     <span class="keywordtype">int</span> res = hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5fafc7f45c5204b858bb072494f6ccf7">x_resolution</a>;
<a name="l00696"></a>00696     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l00697"></a>00697     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l00698"></a>00698     <span class="keywordtype">float</span> w, h;
<a name="l00699"></a>00699     <span class="comment">//float alpha;</span>
<a name="l00700"></a>00700     GLint scissor[4];
<a name="l00701"></a>00701     
<a name="l00702"></a>00702     rect.xmin = (<span class="keywordtype">float</span>)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + 1;
<a name="l00703"></a>00703     rect.xmax = (float)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - 1;
<a name="l00704"></a>00704     rect.ymin = (<span class="keywordtype">float</span>)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + <a class="code" href="../../d1/d2f/interface__intern_8h.html#a52b052f783f39b4ca186fc07c9a5ae28">SCOPE_RESIZE_PAD</a> + 2;
<a name="l00705"></a>00705     rect.ymax = (float)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - 1;
<a name="l00706"></a>00706     
<a name="l00707"></a>00707     w = rect.xmax - rect.xmin;
<a name="l00708"></a>00708     h = (rect.ymax - rect.ymin) * hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#aa36a62911184433ef4d0395a1e04bfff">ymax</a>;
<a name="l00709"></a>00709     
<a name="l00710"></a>00710     glEnable(GL_BLEND);
<a name="l00711"></a>00711     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00712"></a>00712     
<a name="l00713"></a>00713     glColor4f(0.f, 0.f, 0.f, 0.3f);
<a name="l00714"></a>00714     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba7e9af1d815f4277196ed35a049f74148">UI_CNR_ALL</a>);
<a name="l00715"></a>00715     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_POLYGON, rect.xmin - 1, rect.ymin - 1, rect.xmax + 1, rect.ymax + 1, 3.0f);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717     <span class="comment">/* need scissor test, histogram can draw outside of boundary */</span>
<a name="l00718"></a>00718     glGetIntegerv(GL_VIEWPORT, scissor);
<a name="l00719"></a>00719     glScissor(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + (rect.xmin - 1), ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + (rect.ymin - 1), (rect.xmax + 1) - (rect.xmin - 1), (rect.ymax + 1) - (rect.ymin - 1));
<a name="l00720"></a>00720 
<a name="l00721"></a>00721     glColor4f(1.f, 1.f, 1.f, 0.08f);
<a name="l00722"></a>00722     <span class="comment">/* draw grid lines here */</span>
<a name="l00723"></a>00723     <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00724"></a>00724         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin, rect.ymin + (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 4.f) * h, rect.xmax, rect.ymin + (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 4.f) * h);
<a name="l00725"></a>00725         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 4.f) * w, rect.ymin, rect.xmin + (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 4.f) * w, rect.ymax);
<a name="l00726"></a>00726     }
<a name="l00727"></a>00727     
<a name="l00728"></a>00728     <span class="keywordflow">if</span> (hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5377b31aa3f6e7802a267cd036b20543">mode</a> == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a11b1f9c63793d64768c73ab2f83801df">HISTO_MODE_LUMA</a>)
<a name="l00729"></a>00729         <a class="code" href="../../d7/d86/interface__draw_8c.html#aabcf1a2a47ef0f702a95b6a81ed1b948">histogram_draw_one</a>(1.0, 1.0, 1.0, 0.75, rect.xmin, rect.ymin, w, h, hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a797e8fe830f9d465340118495bda5316">data_luma</a>, res);
<a name="l00730"></a>00730     <span class="keywordflow">else</span> {
<a name="l00731"></a>00731         <span class="keywordflow">if</span> (hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5377b31aa3f6e7802a267cd036b20543">mode</a> == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#ae90c38b3c4d6f4d4aafd0aaa5eb52805">HISTO_MODE_RGB</a> || hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5377b31aa3f6e7802a267cd036b20543">mode</a> == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a6886bceda428791923b96e33a2bf6e0e">HISTO_MODE_R</a>)
<a name="l00732"></a>00732             <a class="code" href="../../d7/d86/interface__draw_8c.html#aabcf1a2a47ef0f702a95b6a81ed1b948">histogram_draw_one</a>(1.0, 0.0, 0.0, 0.75, rect.xmin, rect.ymin, w, h, hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a98fe942996e6e97046475e3c8c26abf5">data_r</a>, res);
<a name="l00733"></a>00733         <span class="keywordflow">if</span> (hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5377b31aa3f6e7802a267cd036b20543">mode</a> == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#ae90c38b3c4d6f4d4aafd0aaa5eb52805">HISTO_MODE_RGB</a> || hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5377b31aa3f6e7802a267cd036b20543">mode</a> == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a9fe3f0f272f181916564507f7a7315d4">HISTO_MODE_G</a>)
<a name="l00734"></a>00734             <a class="code" href="../../d7/d86/interface__draw_8c.html#aabcf1a2a47ef0f702a95b6a81ed1b948">histogram_draw_one</a>(0.0, 1.0, 0.0, 0.75, rect.xmin, rect.ymin, w, h, hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#aef06ab5d471910d1656df2cf933422fb">data_g</a>, res);
<a name="l00735"></a>00735         <span class="keywordflow">if</span> (hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5377b31aa3f6e7802a267cd036b20543">mode</a> == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#ae90c38b3c4d6f4d4aafd0aaa5eb52805">HISTO_MODE_RGB</a> || hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#a5377b31aa3f6e7802a267cd036b20543">mode</a> == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#aa0721668acd963d3d28f39a3072af3bd">HISTO_MODE_B</a>)
<a name="l00736"></a>00736             <a class="code" href="../../d7/d86/interface__draw_8c.html#aabcf1a2a47ef0f702a95b6a81ed1b948">histogram_draw_one</a>(0.0, 0.0, 1.0, 0.75, rect.xmin, rect.ymin, w, h, hist-&gt;<a class="code" href="../../d4/d8b/structHistogram.html#ad6b3dd51a648ab15f1e2de154f1310db">data_b</a>, res);
<a name="l00737"></a>00737     }
<a name="l00738"></a>00738     
<a name="l00739"></a>00739     <span class="comment">/* outline, scale gripper */</span>
<a name="l00740"></a>00740     <a class="code" href="../../d7/d86/interface__draw_8c.html#a604dc63ba4a80cb69c19153cc220a268">draw_scope_end</a>(&amp;rect, scissor);
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00743"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a1a1e0775244c02e12acf0525228467d9">00743</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a1a1e0775244c02e12acf0525228467d9">ui_draw_but_WAVEFORM</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(wcol), <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *recti)
<a name="l00744"></a>00744 {
<a name="l00745"></a>00745     <a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *scopes = (<a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *)but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a8376dbee35a2eef4197223c5ecc18963">poin</a>;
<a name="l00746"></a>00746     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l00747"></a>00747     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, c;
<a name="l00748"></a>00748     <span class="keywordtype">float</span> w, w3, h, alpha, yofs;
<a name="l00749"></a>00749     GLint scissor[4];
<a name="l00750"></a>00750     <span class="keywordtype">float</span> colors[3][3] = <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a9351eb4f9017989083e1d3a7369fc9ed">MAT3_UNITY</a>;
<a name="l00751"></a>00751     <span class="keywordtype">float</span> colorsycc[3][3] = {{1, 0, 1}, {1, 1, 0}, {0, 1, 1}};
<a name="l00752"></a>00752     <span class="keywordtype">float</span> colors_alpha[3][3], colorsycc_alpha[3][3]; <span class="comment">/* colors  pre multiplied by alpha for speed up */</span>
<a name="l00753"></a>00753     <span class="keywordtype">float</span> <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>, <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>;
<a name="l00754"></a>00754     
<a name="l00755"></a>00755     <span class="keywordflow">if</span> (scopes == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l00756"></a>00756     
<a name="l00757"></a>00757     rect.xmin = (float)recti-&gt;xmin + 1;
<a name="l00758"></a>00758     rect.xmax = (<span class="keywordtype">float</span>)recti-&gt;xmax - 1;
<a name="l00759"></a>00759     rect.ymin = (float)recti-&gt;ymin + <a class="code" href="../../d1/d2f/interface__intern_8h.html#a52b052f783f39b4ca186fc07c9a5ae28">SCOPE_RESIZE_PAD</a> + 2;
<a name="l00760"></a>00760     rect.ymax = (<span class="keywordtype">float</span>)recti-&gt;ymax - 1;
<a name="l00761"></a>00761 
<a name="l00762"></a>00762     <span class="keywordflow">if</span> (scopes-&gt;wavefrm_yfac &lt; 0.5f)
<a name="l00763"></a>00763         scopes-&gt;wavefrm_yfac = 0.98f;
<a name="l00764"></a>00764     w = rect.xmax - rect.xmin - 7;
<a name="l00765"></a>00765     h = (rect.ymax - rect.ymin) * scopes-&gt;wavefrm_yfac;
<a name="l00766"></a>00766     yofs = rect.ymin + (rect.ymax - rect.ymin - h) / 2.0f;
<a name="l00767"></a>00767     w3 = w / 3.0f;
<a name="l00768"></a>00768     
<a name="l00769"></a>00769     <span class="comment">/* log scale for alpha */</span>
<a name="l00770"></a>00770     alpha = scopes-&gt;wavefrm_alpha * scopes-&gt;wavefrm_alpha;
<a name="l00771"></a>00771     
<a name="l00772"></a>00772     <span class="keywordflow">for</span> (c = 0; c &lt; 3; c++) {
<a name="l00773"></a>00773         <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00774"></a>00774             colors_alpha[c][<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = colors[c][<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] * alpha;
<a name="l00775"></a>00775             colorsycc_alpha[c][<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = colorsycc[c][<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] * alpha;
<a name="l00776"></a>00776         }
<a name="l00777"></a>00777     }
<a name="l00778"></a>00778             
<a name="l00779"></a>00779     glEnable(GL_BLEND);
<a name="l00780"></a>00780     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00781"></a>00781     
<a name="l00782"></a>00782     glColor4f(0.f, 0.f, 0.f, 0.3f);
<a name="l00783"></a>00783     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba7e9af1d815f4277196ed35a049f74148">UI_CNR_ALL</a>);
<a name="l00784"></a>00784     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_POLYGON, rect.xmin - 1, rect.ymin - 1, rect.xmax + 1, rect.ymax + 1, 3.0f);
<a name="l00785"></a>00785     
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="comment">/* need scissor test, waveform can draw outside of boundary */</span>
<a name="l00788"></a>00788     glGetIntegerv(GL_VIEWPORT, scissor);
<a name="l00789"></a>00789     glScissor(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + (rect.xmin - 1), ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + (rect.ymin - 1), (rect.xmax + 1) - (rect.xmin - 1), (rect.ymax + 1) - (rect.ymin - 1));
<a name="l00790"></a>00790 
<a name="l00791"></a>00791     glColor4f(1.f, 1.f, 1.f, 0.08f);
<a name="l00792"></a>00792     <span class="comment">/* draw grid lines here */</span>
<a name="l00793"></a>00793     <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 6; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00794"></a>00794         <span class="keywordtype">char</span> <a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>[4];
<a name="l00795"></a>00795         <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;%-3d&quot;</span>, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * 20);
<a name="l00796"></a>00796         str[3] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00797"></a>00797         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + 22, yofs + (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 5.f) * h, rect.xmax + 1, yofs + (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 5.f) * h);
<a name="l00798"></a>00798         <a class="code" href="../../df/d5d/BLF__api_8h.html#a9b623b39b9d6f9049b0777f431d8e76e">BLF_draw_default</a>(rect.xmin + 1, yofs - 5 + (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 5.f) * h, 0, str, <span class="keyword">sizeof</span>(str) - 1);
<a name="l00799"></a>00799         <span class="comment">/* in the loop because blf_draw reset it */</span>
<a name="l00800"></a>00800         glEnable(GL_BLEND);
<a name="l00801"></a>00801         glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00802"></a>00802     }
<a name="l00803"></a>00803     <span class="comment">/* 3 vertical separation */</span>
<a name="l00804"></a>00804     <span class="keywordflow">if</span> (scopes-&gt;wavefrm_mode != <a class="code" href="../../da/ddd/DNA__color__types_8h.html#ab853ea8bc504e435de28ed818b939680">SCOPES_WAVEFRM_LUMA</a>) {
<a name="l00805"></a>00805         <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00806"></a>00806             <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * w3, rect.ymin, rect.xmin + <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * w3, rect.ymax);
<a name="l00807"></a>00807         }
<a name="l00808"></a>00808     }
<a name="l00809"></a>00809     
<a name="l00810"></a>00810     <span class="comment">/* separate min max zone on the right */</span>
<a name="l00811"></a>00811     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + w, rect.ymin, rect.xmin + w, rect.ymax);
<a name="l00812"></a>00812     <span class="comment">/* 16-235-240 level in case of ITU-R BT601/709 */</span>
<a name="l00813"></a>00813     glColor4f(1.f, 0.4f, 0.f, 0.2f);
<a name="l00814"></a>00814     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(scopes-&gt;wavefrm_mode, <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a78e166fba844d88ecb1a0d8f6072273e">SCOPES_WAVEFRM_YCC_601</a>, <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a9bc1b194625e84428ae6b3d1ad794b21">SCOPES_WAVEFRM_YCC_709</a>)) {
<a name="l00815"></a>00815         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + 22, yofs + h * 16.0f / 255.0f, rect.xmax + 1, yofs + h * 16.0f / 255.0f);
<a name="l00816"></a>00816         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + 22, yofs + h * 235.0f / 255.0f, rect.xmin + w3, yofs + h * 235.0f / 255.0f);
<a name="l00817"></a>00817         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + 3 * w3, yofs + h * 235.0f / 255.0f, rect.xmax + 1, yofs + h * 235.0f / 255.0f);
<a name="l00818"></a>00818         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + w3, yofs + h * 240.0f / 255.0f, rect.xmax + 1, yofs + h * 240.0f / 255.0f);
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820     <span class="comment">/* 7.5 IRE black point level for NTSC */</span>
<a name="l00821"></a>00821     <span class="keywordflow">if</span> (scopes-&gt;wavefrm_mode == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#ab853ea8bc504e435de28ed818b939680">SCOPES_WAVEFRM_LUMA</a>)
<a name="l00822"></a>00822         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin, yofs + h * 0.075f, rect.xmax + 1, yofs + h * 0.075f);
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     <span class="keywordflow">if</span> (scopes-&gt;ok &amp;&amp; scopes-&gt;waveform_1 != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00825"></a>00825         
<a name="l00826"></a>00826         <span class="comment">/* LUMA (1 channel) */</span>
<a name="l00827"></a>00827         glBlendFunc(GL_ONE, GL_ONE);
<a name="l00828"></a>00828         glColor3f(alpha, alpha, alpha);
<a name="l00829"></a>00829         <span class="keywordflow">if</span> (scopes-&gt;wavefrm_mode == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#ab853ea8bc504e435de28ed818b939680">SCOPES_WAVEFRM_LUMA</a>) {
<a name="l00830"></a>00830 
<a name="l00831"></a>00831             glBlendFunc(GL_ONE, GL_ONE);
<a name="l00832"></a>00832             
<a name="l00833"></a>00833             glPushMatrix();
<a name="l00834"></a>00834             glEnableClientState(GL_VERTEX_ARRAY);
<a name="l00835"></a>00835             
<a name="l00836"></a>00836             glTranslatef(rect.xmin, yofs, 0.f);
<a name="l00837"></a>00837             glScalef(w, h, 0.f);
<a name="l00838"></a>00838             glVertexPointer(2, GL_FLOAT, 0, scopes-&gt;waveform_1);
<a name="l00839"></a>00839             glDrawArrays(GL_POINTS, 0, scopes-&gt;waveform_tot);
<a name="l00840"></a>00840                     
<a name="l00841"></a>00841             glDisableClientState(GL_VERTEX_ARRAY);
<a name="l00842"></a>00842             glPopMatrix();
<a name="l00843"></a>00843 
<a name="l00844"></a>00844             <span class="comment">/* min max */</span>
<a name="l00845"></a>00845             glColor3f(.5f, .5f, .5f);
<a name="l00846"></a>00846             min = yofs + scopes-&gt;minmax[0][0] * h;
<a name="l00847"></a>00847             max = yofs + scopes-&gt;minmax[0][1] * h;
<a name="l00848"></a>00848             <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(min, rect.ymin, rect.ymax);
<a name="l00849"></a>00849             <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(max, rect.ymin, rect.ymax);
<a name="l00850"></a>00850             <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmax - 3, min, rect.xmax - 3, max);
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852 
<a name="l00853"></a>00853         <span class="comment">/* RGB / YCC (3 channels) */</span>
<a name="l00854"></a>00854         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0388eda1f65113c4a15720e037c11cb4">ELEM4</a>(scopes-&gt;wavefrm_mode, <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a648eacded1b9abbf6a0e672dcfa597c6">SCOPES_WAVEFRM_RGB</a>, <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a78e166fba844d88ecb1a0d8f6072273e">SCOPES_WAVEFRM_YCC_601</a>, <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a9bc1b194625e84428ae6b3d1ad794b21">SCOPES_WAVEFRM_YCC_709</a>, <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a41171417596130a2306a709435d12d38">SCOPES_WAVEFRM_YCC_JPEG</a>)) {
<a name="l00855"></a>00855             <span class="keywordtype">int</span> rgb = (scopes-&gt;wavefrm_mode == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a648eacded1b9abbf6a0e672dcfa597c6">SCOPES_WAVEFRM_RGB</a>);
<a name="l00856"></a>00856             
<a name="l00857"></a>00857             glBlendFunc(GL_ONE, GL_ONE);
<a name="l00858"></a>00858             
<a name="l00859"></a>00859             glPushMatrix();
<a name="l00860"></a>00860             glEnableClientState(GL_VERTEX_ARRAY);
<a name="l00861"></a>00861             
<a name="l00862"></a>00862             glTranslatef(rect.xmin, yofs, 0.f);
<a name="l00863"></a>00863             glScalef(w3, h, 0.f);
<a name="l00864"></a>00864             
<a name="l00865"></a>00865             glColor3fv((rgb) ? colors_alpha[0] : colorsycc_alpha[0]);
<a name="l00866"></a>00866             glVertexPointer(2, GL_FLOAT, 0, scopes-&gt;waveform_1);
<a name="l00867"></a>00867             glDrawArrays(GL_POINTS, 0, scopes-&gt;waveform_tot);
<a name="l00868"></a>00868 
<a name="l00869"></a>00869             glTranslatef(1.f, 0.f, 0.f);
<a name="l00870"></a>00870             glColor3fv((rgb) ? colors_alpha[1] : colorsycc_alpha[1]);
<a name="l00871"></a>00871             glVertexPointer(2, GL_FLOAT, 0, scopes-&gt;waveform_2);
<a name="l00872"></a>00872             glDrawArrays(GL_POINTS, 0, scopes-&gt;waveform_tot);
<a name="l00873"></a>00873             
<a name="l00874"></a>00874             glTranslatef(1.f, 0.f, 0.f);
<a name="l00875"></a>00875             glColor3fv((rgb) ? colors_alpha[2] : colorsycc_alpha[2]);
<a name="l00876"></a>00876             glVertexPointer(2, GL_FLOAT, 0, scopes-&gt;waveform_3);
<a name="l00877"></a>00877             glDrawArrays(GL_POINTS, 0, scopes-&gt;waveform_tot);
<a name="l00878"></a>00878             
<a name="l00879"></a>00879             glDisableClientState(GL_VERTEX_ARRAY);
<a name="l00880"></a>00880             glPopMatrix();
<a name="l00881"></a>00881 
<a name="l00882"></a>00882             
<a name="l00883"></a>00883             <span class="comment">/* min max */</span>
<a name="l00884"></a>00884             <span class="keywordflow">for</span> (c = 0; c &lt; 3; c++) {
<a name="l00885"></a>00885                 <span class="keywordflow">if</span> (scopes-&gt;wavefrm_mode == <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a648eacded1b9abbf6a0e672dcfa597c6">SCOPES_WAVEFRM_RGB</a>)
<a name="l00886"></a>00886                     glColor3f(colors[c][0] * 0.75f, colors[c][1] * 0.75f, colors[c][2] * 0.75f);
<a name="l00887"></a>00887                 <span class="keywordflow">else</span>
<a name="l00888"></a>00888                     glColor3f(colorsycc[c][0] * 0.75f, colorsycc[c][1] * 0.75f, colorsycc[c][2] * 0.75f);
<a name="l00889"></a>00889                 min = yofs + scopes-&gt;minmax[c][0] * h;
<a name="l00890"></a>00890                 max = yofs + scopes-&gt;minmax[c][1] * h;
<a name="l00891"></a>00891                 <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(min, rect.ymin, rect.ymax);
<a name="l00892"></a>00892                 <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(max, rect.ymin, rect.ymax);
<a name="l00893"></a>00893                 <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(rect.xmin + w + 2 + c * 2, min, rect.xmin + w + 2 + c * 2, max);
<a name="l00894"></a>00894             }
<a name="l00895"></a>00895         }
<a name="l00896"></a>00896         
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898     
<a name="l00899"></a>00899     <span class="comment">/* outline, scale gripper */</span>
<a name="l00900"></a>00900     <a class="code" href="../../d7/d86/interface__draw_8c.html#a604dc63ba4a80cb69c19153cc220a268">draw_scope_end</a>(&amp;rect, scissor);
<a name="l00901"></a>00901 }
<a name="l00902"></a>00902 
<a name="l00903"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">00903</a> <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(<span class="keywordtype">float</span> center, <span class="keywordtype">float</span> diam, <span class="keywordtype">float</span> ampli, <span class="keywordtype">float</span> <a class="code" href="../../d9/d42/btQuaternion_8h.html#a0dbf74d697e478378c0c48ef948cac37" title="Return the angle between two quaternions.">angle</a>)
<a name="l00904"></a>00904 {
<a name="l00905"></a>00905     <span class="keywordflow">return</span> center + diam *ampli *<a class="code" href="../../dd/d06/BLI__math__base_8h.html#a2503b77b52ff481a3507a596ae1f3938">cosf</a>(angle);
<a name="l00906"></a>00906 }
<a name="l00907"></a>00907 
<a name="l00908"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">00908</a> <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(<span class="keywordtype">float</span> center, <span class="keywordtype">float</span> diam, <span class="keywordtype">float</span> ampli, <span class="keywordtype">float</span> <a class="code" href="../../d9/d42/btQuaternion_8h.html#a0dbf74d697e478378c0c48ef948cac37" title="Return the angle between two quaternions.">angle</a>)
<a name="l00909"></a>00909 {
<a name="l00910"></a>00910     <span class="keywordflow">return</span> center + diam *ampli *<a class="code" href="../../dd/d06/BLI__math__base_8h.html#a1a55e3226c270625a4bff1befa977638">sinf</a>(angle);
<a name="l00911"></a>00911 }
<a name="l00912"></a>00912 
<a name="l00913"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a6a2285363507ab7b6963e1274778ec76">00913</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a6a2285363507ab7b6963e1274778ec76">vectorscope_draw_target</a>(<span class="keywordtype">float</span> centerx, <span class="keywordtype">float</span> centery, <span class="keywordtype">float</span> diam, <span class="keyword">const</span> <span class="keywordtype">float</span> colf[3])
<a name="l00914"></a>00914 {
<a name="l00915"></a>00915     <span class="keywordtype">float</span> y, u, v;
<a name="l00916"></a>00916     <span class="keywordtype">float</span> tangle = 0.f, tampli;
<a name="l00917"></a>00917     <span class="keywordtype">float</span> dangle, dampli, dangle2, dampli2;
<a name="l00918"></a>00918 
<a name="l00919"></a>00919     <a class="code" href="../../d8/de1/BLI__math__color_8h.html#ad139f29cd591f92b82fcba59e66ae1b4">rgb_to_yuv</a>(colf[0], colf[1], colf[2], &amp;y, &amp;u, &amp;v);
<a name="l00920"></a>00920     <span class="keywordflow">if</span> (u &gt; 0 &amp;&amp; v &gt;= 0) tangle = <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a6301bd3eb834120f83458269b0730d80">atanf</a>(v / u);
<a name="l00921"></a>00921     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u &gt; 0 &amp;&amp; v &lt; 0) tangle = <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a6301bd3eb834120f83458269b0730d80">atanf</a>(v / u) + 2.0f * (float)<a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l00922"></a>00922     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u &lt; 0) tangle = <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a6301bd3eb834120f83458269b0730d80">atanf</a>(v / u) + (float)<a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l00923"></a>00923     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u == 0 &amp;&amp; v &gt; 0.0f) tangle = (float)<a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 2.0f;
<a name="l00924"></a>00924     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u == 0 &amp;&amp; v &lt; 0.0f) tangle = -(float)<a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 2.0f;
<a name="l00925"></a>00925     tampli = <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a33f9e82220f9ff9453a6557bd04bd8c5">sqrtf</a>(u * u + v * v);
<a name="l00926"></a>00926 
<a name="l00927"></a>00927     <span class="comment">/* small target vary by 2.5 degree and 2.5 IRE unit */</span>
<a name="l00928"></a>00928     glColor4f(1.0f, 1.0f, 1.0, 0.12f);
<a name="l00929"></a>00929     dangle = <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(2.5f);
<a name="l00930"></a>00930     dampli = 2.5f / 200.0f;
<a name="l00931"></a>00931     glBegin(GL_LINE_STRIP);
<a name="l00932"></a>00932     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli, tangle + dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli, tangle + dangle));
<a name="l00933"></a>00933     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli, tangle + dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli, tangle + dangle));
<a name="l00934"></a>00934     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli, tangle - dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli, tangle - dangle));
<a name="l00935"></a>00935     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli, tangle - dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli, tangle - dangle));
<a name="l00936"></a>00936     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli, tangle + dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli, tangle + dangle));
<a name="l00937"></a>00937     glEnd();
<a name="l00938"></a>00938     <span class="comment">/* big target vary by 10 degree and 20% amplitude */</span>
<a name="l00939"></a>00939     glColor4f(1.0f, 1.0f, 1.0, 0.12f);
<a name="l00940"></a>00940     dangle = <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(10.0f);
<a name="l00941"></a>00941     dampli = 0.2f * tampli;
<a name="l00942"></a>00942     dangle2 = <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(5.0f);
<a name="l00943"></a>00943     dampli2 = 0.5f * dampli;
<a name="l00944"></a>00944     glBegin(GL_LINE_STRIP);
<a name="l00945"></a>00945     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli - dampli2, tangle + dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli - dampli2, tangle + dangle));
<a name="l00946"></a>00946     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli, tangle + dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli, tangle + dangle));
<a name="l00947"></a>00947     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli, tangle + dangle - dangle2), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli, tangle + dangle - dangle2));
<a name="l00948"></a>00948     glEnd();
<a name="l00949"></a>00949     glBegin(GL_LINE_STRIP);
<a name="l00950"></a>00950     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli + dampli2, tangle + dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli + dampli2, tangle + dangle));
<a name="l00951"></a>00951     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli, tangle + dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli, tangle + dangle));
<a name="l00952"></a>00952     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli, tangle + dangle - dangle2), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli, tangle + dangle - dangle2));
<a name="l00953"></a>00953     glEnd();
<a name="l00954"></a>00954     glBegin(GL_LINE_STRIP);
<a name="l00955"></a>00955     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli + dampli2, tangle - dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli + dampli2, tangle - dangle));
<a name="l00956"></a>00956     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli, tangle - dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli, tangle - dangle));
<a name="l00957"></a>00957     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli - dampli, tangle - dangle + dangle2), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli - dampli, tangle - dangle + dangle2));
<a name="l00958"></a>00958     glEnd();
<a name="l00959"></a>00959     glBegin(GL_LINE_STRIP);
<a name="l00960"></a>00960     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli - dampli2, tangle - dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli - dampli2, tangle - dangle));
<a name="l00961"></a>00961     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli, tangle - dangle), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli, tangle - dangle));
<a name="l00962"></a>00962     glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, tampli + dampli, tangle - dangle + dangle2), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, tampli + dampli, tangle - dangle + dangle2));
<a name="l00963"></a>00963     glEnd();
<a name="l00964"></a>00964 }
<a name="l00965"></a>00965 
<a name="l00966"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#ad28e9781b90f55354d329fd6e58b67ce">00966</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#ad28e9781b90f55354d329fd6e58b67ce">ui_draw_but_VECTORSCOPE</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(wcol), <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *recti)
<a name="l00967"></a>00967 {
<a name="l00968"></a>00968     <span class="keyword">const</span> <span class="keywordtype">float</span> skin_rad = <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(123.0f); <span class="comment">/* angle in radians of the skin tone line */</span>
<a name="l00969"></a>00969     <a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *scopes = (<a class="code" href="../../dc/db8/structScopes.html">Scopes</a> *)but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a8376dbee35a2eef4197223c5ecc18963">poin</a>;
<a name="l00970"></a>00970     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l00971"></a>00971     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;
<a name="l00972"></a>00972     <span class="keywordtype">float</span> w, h, centerx, centery, diam;
<a name="l00973"></a>00973     <span class="keywordtype">float</span> alpha;
<a name="l00974"></a>00974     <span class="keyword">const</span> <span class="keywordtype">float</span> colors[6][3] = {{.75, 0, 0}, {.75, .75, 0}, {0, .75, 0}, {0, .75, .75}, {0, 0, .75}, {.75, 0, .75}};
<a name="l00975"></a>00975     GLint scissor[4];
<a name="l00976"></a>00976     
<a name="l00977"></a>00977     rect.xmin = (float)recti-&gt;xmin + 1;
<a name="l00978"></a>00978     rect.xmax = (<span class="keywordtype">float</span>)recti-&gt;xmax - 1;
<a name="l00979"></a>00979     rect.ymin = (float)recti-&gt;ymin + <a class="code" href="../../d1/d2f/interface__intern_8h.html#a52b052f783f39b4ca186fc07c9a5ae28">SCOPE_RESIZE_PAD</a> + 2;
<a name="l00980"></a>00980     rect.ymax = (<span class="keywordtype">float</span>)recti-&gt;ymax - 1;
<a name="l00981"></a>00981     
<a name="l00982"></a>00982     w = rect.xmax - rect.xmin;
<a name="l00983"></a>00983     h = rect.ymax - rect.ymin;
<a name="l00984"></a>00984     centerx = rect.xmin + w / 2;
<a name="l00985"></a>00985     centery = rect.ymin + h / 2;
<a name="l00986"></a>00986     diam = (w &lt; h) ? w : h;
<a name="l00987"></a>00987     
<a name="l00988"></a>00988     alpha = scopes-&gt;vecscope_alpha * scopes-&gt;vecscope_alpha * scopes-&gt;vecscope_alpha;
<a name="l00989"></a>00989             
<a name="l00990"></a>00990     glEnable(GL_BLEND);
<a name="l00991"></a>00991     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00992"></a>00992     
<a name="l00993"></a>00993     glColor4f(0.f, 0.f, 0.f, 0.3f);
<a name="l00994"></a>00994     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba7e9af1d815f4277196ed35a049f74148">UI_CNR_ALL</a>);
<a name="l00995"></a>00995     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_POLYGON, rect.xmin - 1, rect.ymin - 1, rect.xmax + 1, rect.ymax + 1, 3.0f);
<a name="l00996"></a>00996 
<a name="l00997"></a>00997     <span class="comment">/* need scissor test, hvectorscope can draw outside of boundary */</span>
<a name="l00998"></a>00998     glGetIntegerv(GL_VIEWPORT, scissor);
<a name="l00999"></a>00999     glScissor(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + (rect.xmin - 1), ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + (rect.ymin - 1), (rect.xmax + 1) - (rect.xmin - 1), (rect.ymax + 1) - (rect.ymin - 1));
<a name="l01000"></a>01000     
<a name="l01001"></a>01001     glColor4f(1.f, 1.f, 1.f, 0.08f);
<a name="l01002"></a>01002     <span class="comment">/* draw grid elements */</span>
<a name="l01003"></a>01003     <span class="comment">/* cross */</span>
<a name="l01004"></a>01004     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(centerx - (diam / 2) - 5, centery, centerx + (diam / 2) + 5, centery);
<a name="l01005"></a>01005     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(centerx, centery - (diam / 2) - 5, centerx, centery + (diam / 2) + 5);
<a name="l01006"></a>01006     <span class="comment">/* circles */</span>
<a name="l01007"></a>01007     <span class="keywordflow">for</span> (j = 0; j &lt; 5; j++) {
<a name="l01008"></a>01008         glBegin(GL_LINE_STRIP);
<a name="l01009"></a>01009         <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= 360; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> + 15) {
<a name="l01010"></a>01010             <span class="keyword">const</span> <span class="keywordtype">float</span> a = <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>((<span class="keywordtype">float</span>)<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);
<a name="l01011"></a>01011             <span class="keyword">const</span> <span class="keywordtype">float</span> r = (j + 1) / 10.0f;
<a name="l01012"></a>01012             glVertex2f(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, r, a), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, r, a));
<a name="l01013"></a>01013         }
<a name="l01014"></a>01014         glEnd();
<a name="l01015"></a>01015     }
<a name="l01016"></a>01016     <span class="comment">/* skin tone line */</span>
<a name="l01017"></a>01017     glColor4f(1.f, 0.4f, 0.f, 0.2f);
<a name="l01018"></a>01018     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a7354f70d0e522da34583d29bbec4d194">fdrawline</a>(<a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, 0.5f, skin_rad), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, 0.5, skin_rad),
<a name="l01019"></a>01019               <a class="code" href="../../d7/d86/interface__draw_8c.html#a23bc2d6b13033bbde7a52da6d6e124a8">polar_to_x</a>(centerx, diam, 0.1f, skin_rad), <a class="code" href="../../d7/d86/interface__draw_8c.html#a569b7af80817210486df4f5cc609ccc8">polar_to_y</a>(centery, diam, 0.1, skin_rad));
<a name="l01020"></a>01020     <span class="comment">/* saturation points */</span>
<a name="l01021"></a>01021     <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 6; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)
<a name="l01022"></a>01022         <a class="code" href="../../d7/d86/interface__draw_8c.html#a6a2285363507ab7b6963e1274778ec76">vectorscope_draw_target</a>(centerx, centery, diam, colors[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l01023"></a>01023     
<a name="l01024"></a>01024     <span class="keywordflow">if</span> (scopes-&gt;ok &amp;&amp; scopes-&gt;vecscope != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01025"></a>01025         <span class="comment">/* pixel point cloud */</span>
<a name="l01026"></a>01026         glBlendFunc(GL_ONE, GL_ONE);
<a name="l01027"></a>01027         glColor3f(alpha, alpha, alpha);
<a name="l01028"></a>01028 
<a name="l01029"></a>01029         glPushMatrix();
<a name="l01030"></a>01030         glEnableClientState(GL_VERTEX_ARRAY);
<a name="l01031"></a>01031 
<a name="l01032"></a>01032         glTranslatef(centerx, centery, 0.f);
<a name="l01033"></a>01033         glScalef(diam, diam, 0.f);
<a name="l01034"></a>01034 
<a name="l01035"></a>01035         glVertexPointer(2, GL_FLOAT, 0, scopes-&gt;vecscope);
<a name="l01036"></a>01036         glDrawArrays(GL_POINTS, 0, scopes-&gt;waveform_tot);
<a name="l01037"></a>01037         
<a name="l01038"></a>01038         glDisableClientState(GL_VERTEX_ARRAY);
<a name="l01039"></a>01039         glPopMatrix();
<a name="l01040"></a>01040     }
<a name="l01041"></a>01041 
<a name="l01042"></a>01042     <span class="comment">/* outline, scale gripper */</span>
<a name="l01043"></a>01043     <a class="code" href="../../d7/d86/interface__draw_8c.html#a604dc63ba4a80cb69c19153cc220a268">draw_scope_end</a>(&amp;rect, scissor);
<a name="l01044"></a>01044         
<a name="l01045"></a>01045     glDisable(GL_BLEND);
<a name="l01046"></a>01046 }
<a name="l01047"></a>01047 
<a name="l01048"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#afff3a4a14b38d56ff7804ad6da97109a">01048</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#afff3a4a14b38d56ff7804ad6da97109a">ui_draw_but_COLORBAND</a>(<a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(wcol), <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *rect)
<a name="l01049"></a>01049 {
<a name="l01050"></a>01050     <a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *coba;
<a name="l01051"></a>01051     <a class="code" href="../../d6/de7/structCBData.html">CBData</a> *cbd;
<a name="l01052"></a>01052     <span class="keywordtype">float</span> x1, y1, sizex, sizey;
<a name="l01053"></a>01053     <span class="keywordtype">float</span> v3[2], v1[2], v2[2], v1a[2], v2a[2];
<a name="l01054"></a>01054     <span class="keywordtype">int</span> a;
<a name="l01055"></a>01055     <span class="keywordtype">float</span> pos, colf[4] = {0, 0, 0, 0}; <span class="comment">/* initialize in case the colorband isn&#39;t valid */</span>
<a name="l01056"></a>01056         
<a name="l01057"></a>01057     coba = (<a class="code" href="../../d0/dc8/structColorBand.html">ColorBand</a> *)(but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#aa10ebb6a93a76dd67b2ebf1722cfa8bc">editcoba</a> ? but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#aa10ebb6a93a76dd67b2ebf1722cfa8bc">editcoba</a> : but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a8376dbee35a2eef4197223c5ecc18963">poin</a>);
<a name="l01058"></a>01058     <span class="keywordflow">if</span> (coba == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l01059"></a>01059     
<a name="l01060"></a>01060     x1 = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>;
<a name="l01061"></a>01061     y1 = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>;
<a name="l01062"></a>01062     sizex = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - x1;
<a name="l01063"></a>01063     sizey = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - y1;
<a name="l01064"></a>01064 
<a name="l01065"></a>01065     <span class="comment">/* first background, to show tranparency */</span>
<a name="l01066"></a>01066 
<a name="l01067"></a>01067     glColor4ub(<a class="code" href="../../d1/d2f/interface__intern_8h.html#a108da53b8f9dbd3c68d8fb133fdc8385">UI_TRANSP_DARK</a>, <a class="code" href="../../d1/d2f/interface__intern_8h.html#a108da53b8f9dbd3c68d8fb133fdc8385">UI_TRANSP_DARK</a>, <a class="code" href="../../d1/d2f/interface__intern_8h.html#a108da53b8f9dbd3c68d8fb133fdc8385">UI_TRANSP_DARK</a>, 255);
<a name="l01068"></a>01068     glRectf(x1, y1, x1 + sizex, y1 + sizey);
<a name="l01069"></a>01069     glEnable(GL_POLYGON_STIPPLE);
<a name="l01070"></a>01070     glColor4ub(<a class="code" href="../../d1/d2f/interface__intern_8h.html#a764ac15b88d0ab39978b3182887a9a2c">UI_TRANSP_LIGHT</a>, <a class="code" href="../../d1/d2f/interface__intern_8h.html#a764ac15b88d0ab39978b3182887a9a2c">UI_TRANSP_LIGHT</a>, <a class="code" href="../../d1/d2f/interface__intern_8h.html#a764ac15b88d0ab39978b3182887a9a2c">UI_TRANSP_LIGHT</a>, 255);
<a name="l01071"></a>01071     glPolygonStipple(<a class="code" href="../../d1/d2f/interface__intern_8h.html#a941d423fc9b940636d16e0fdd66a062b">checker_stipple_sml</a>);
<a name="l01072"></a>01072     glRectf(x1, y1, x1 + sizex, y1 + sizey);
<a name="l01073"></a>01073     glDisable(GL_POLYGON_STIPPLE);
<a name="l01074"></a>01074 
<a name="l01075"></a>01075     glShadeModel(GL_FLAT);
<a name="l01076"></a>01076     glEnable(GL_BLEND);
<a name="l01077"></a>01077     
<a name="l01078"></a>01078     cbd = coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>;
<a name="l01079"></a>01079     
<a name="l01080"></a>01080     v1[0] = v2[0] = x1;
<a name="l01081"></a>01081     v1[1] = y1;
<a name="l01082"></a>01082     v2[1] = y1 + sizey;
<a name="l01083"></a>01083     
<a name="l01084"></a>01084     glBegin(GL_QUAD_STRIP);
<a name="l01085"></a>01085     
<a name="l01086"></a>01086     glColor4fv(&amp;cbd-&gt;<a class="code" href="../../d6/de7/structCBData.html#aa1776eddfa93436617bb76d618dd4b43">r</a>);
<a name="l01087"></a>01087     glVertex2fv(v1); glVertex2fv(v2);
<a name="l01088"></a>01088     
<a name="l01089"></a>01089     <span class="keywordflow">for</span> (a = 1; a &lt;= sizex; a++) {
<a name="l01090"></a>01090         pos = ((float)a) / (sizex - 1);
<a name="l01091"></a>01091         <a class="code" href="../../d2/d66/BKE__texture_8h.html#a721c3ae085220a3753934ebfc4505fba">do_colorband</a>(coba, pos, colf);
<a name="l01092"></a>01092         <span class="keywordflow">if</span> (but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a6725c7e00dbc6942369ae5c0d5dd0459">block</a>-&gt;<a class="code" href="../../df/d5b/structuiBlock.html#a131bd2bf1c25288b79727cc397ac0ce8">color_profile</a> != <a class="code" href="../../d8/de1/BLI__math__color_8h.html#a74dfa2b5b58eec9cee1a1bf35c15a026">BLI_PR_NONE</a>)
<a name="l01093"></a>01093             <a class="code" href="../../d8/de1/BLI__math__color_8h.html#ac0586614af7cf4cfa2c1718015b85383">linearrgb_to_srgb_v3_v3</a>(colf, colf);
<a name="l01094"></a>01094         
<a name="l01095"></a>01095         v1[0] = v2[0] = x1 + a;
<a name="l01096"></a>01096         
<a name="l01097"></a>01097         glColor4fv(colf);
<a name="l01098"></a>01098         glVertex2fv(v1); glVertex2fv(v2);
<a name="l01099"></a>01099     }
<a name="l01100"></a>01100     
<a name="l01101"></a>01101     glEnd();
<a name="l01102"></a>01102     glShadeModel(GL_FLAT);
<a name="l01103"></a>01103     glDisable(GL_BLEND);
<a name="l01104"></a>01104     
<a name="l01105"></a>01105     <span class="comment">/* outline */</span>
<a name="l01106"></a>01106     glColor4f(0.0, 0.0, 0.0, 1.0);
<a name="l01107"></a>01107     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a927bebeabf30bfa7ca451c16fe9336e4">fdrawbox</a>(x1, y1, x1 + sizex, y1 + sizey);
<a name="l01108"></a>01108     
<a name="l01109"></a>01109     <span class="comment">/* help lines */</span>
<a name="l01110"></a>01110     v1[0] = v2[0] = v3[0] = x1;
<a name="l01111"></a>01111     v1[1] = y1;
<a name="l01112"></a>01112     v1a[1] = y1 + 0.25f * sizey;
<a name="l01113"></a>01113     v2[1] = y1 + 0.5f * sizey;
<a name="l01114"></a>01114     v2a[1] = y1 + 0.75f * sizey;
<a name="l01115"></a>01115     v3[1] = y1 + sizey;
<a name="l01116"></a>01116     
<a name="l01117"></a>01117     
<a name="l01118"></a>01118     cbd = coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a7d2f29fb0327fd1db93ad7f6e4760a28">data</a>;
<a name="l01119"></a>01119     glBegin(GL_LINES);
<a name="l01120"></a>01120     <span class="keywordflow">for</span> (a = 0; a &lt; coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a9a5aeaf310abd70ad22e33ecc7040c3c">tot</a>; a++, cbd++) {
<a name="l01121"></a>01121         v1[0] = v2[0] = v3[0] = v1a[0] = v2a[0] = x1 + cbd-&gt;<a class="code" href="../../d6/de7/structCBData.html#a2c107365b262fd93815a67a2f41c7c6d">pos</a> * sizex;
<a name="l01122"></a>01122         
<a name="l01123"></a>01123         <span class="keywordflow">if</span> (a == coba-&gt;<a class="code" href="../../d0/dc8/structColorBand.html#a68e7154ccfffe7036ebb28b37963637b">cur</a>) {
<a name="l01124"></a>01124             glColor3ub(0, 0, 0);
<a name="l01125"></a>01125             glVertex2fv(v1);
<a name="l01126"></a>01126             glVertex2fv(v3);
<a name="l01127"></a>01127             glEnd();
<a name="l01128"></a>01128             
<a name="l01129"></a>01129             <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a97e0af63da34003debb284a98403315d">setlinestyle</a>(2);
<a name="l01130"></a>01130             glBegin(GL_LINES);
<a name="l01131"></a>01131             glColor3ub(255, 255, 255);
<a name="l01132"></a>01132             glVertex2fv(v1);
<a name="l01133"></a>01133             glVertex2fv(v3);
<a name="l01134"></a>01134             glEnd();
<a name="l01135"></a>01135             <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a97e0af63da34003debb284a98403315d">setlinestyle</a>(0);
<a name="l01136"></a>01136             glBegin(GL_LINES);
<a name="l01137"></a>01137             
<a name="l01138"></a>01138 <span class="preprocessor">#if 0</span>
<a name="l01139"></a>01139 <span class="preprocessor"></span>            glColor3ub(0, 0, 0);
<a name="l01140"></a>01140             glVertex2fv(v1);
<a name="l01141"></a>01141             glVertex2fv(v1a);
<a name="l01142"></a>01142             glColor3ub(255, 255, 255);
<a name="l01143"></a>01143             glVertex2fv(v1a);
<a name="l01144"></a>01144             glVertex2fv(v2);
<a name="l01145"></a>01145             glColor3ub(0, 0, 0);
<a name="l01146"></a>01146             glVertex2fv(v2);
<a name="l01147"></a>01147             glVertex2fv(v2a);
<a name="l01148"></a>01148             glColor3ub(255, 255, 255);
<a name="l01149"></a>01149             glVertex2fv(v2a);
<a name="l01150"></a>01150             glVertex2fv(v3);
<a name="l01151"></a>01151 <span class="preprocessor">#endif</span>
<a name="l01152"></a>01152 <span class="preprocessor"></span>        }
<a name="l01153"></a>01153         <span class="keywordflow">else</span> {
<a name="l01154"></a>01154             glColor3ub(0, 0, 0);
<a name="l01155"></a>01155             glVertex2fv(v1);
<a name="l01156"></a>01156             glVertex2fv(v2);
<a name="l01157"></a>01157             
<a name="l01158"></a>01158             glColor3ub(255, 255, 255);
<a name="l01159"></a>01159             glVertex2fv(v2);
<a name="l01160"></a>01160             glVertex2fv(v3);
<a name="l01161"></a>01161         }   
<a name="l01162"></a>01162     }
<a name="l01163"></a>01163     glEnd();
<a name="l01164"></a>01164 
<a name="l01165"></a>01165 }
<a name="l01166"></a>01166 
<a name="l01167"></a><a class="code" href="../../d1/d2f/interface__intern_8h.html#ae5ac2ae546596d24219b240315b862a8">01167</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a2c674bb2452e0b16cd6179b36567c0c2">ui_draw_but_NORMAL</a>(<a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *wcol, <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *rect)
<a name="l01168"></a>01168 {
<a name="l01169"></a>01169     <span class="keyword">static</span> GLuint displist = 0;
<a name="l01170"></a>01170     <span class="keywordtype">int</span> a, old[8];
<a name="l01171"></a>01171     GLfloat <a class="code" href="../../d0/dbc/namespaceKDL.html#a0227d72a9cfff5e6065944ebb04f9e77">diff</a>[4], diffn[4] = {1.0f, 1.0f, 1.0f, 1.0f};
<a name="l01172"></a>01172     <span class="keywordtype">float</span> vec0[4] = {0.0f, 0.0f, 0.0f, 0.0f};
<a name="l01173"></a>01173     <span class="keywordtype">float</span> dir[4], <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>;
<a name="l01174"></a>01174     
<a name="l01175"></a>01175     <span class="comment">/* store stuff */</span>
<a name="l01176"></a>01176     glGetMaterialfv(GL_FRONT, GL_DIFFUSE, diff);
<a name="l01177"></a>01177         
<a name="l01178"></a>01178     <span class="comment">/* backdrop */</span>
<a name="l01179"></a>01179     glColor3ubv((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>);
<a name="l01180"></a>01180     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(<a class="code" href="../../d8/d1e/UI__interface_8h.html#ab39a415800ebd0d977c477376649649ba7e9af1d815f4277196ed35a049f74148">UI_CNR_ALL</a>);
<a name="l01181"></a>01181     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_POLYGON, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>, 5.0f);
<a name="l01182"></a>01182     
<a name="l01183"></a>01183     <span class="comment">/* sphere color */</span>
<a name="l01184"></a>01184     glMaterialfv(GL_FRONT, GL_DIFFUSE, diffn);
<a name="l01185"></a>01185     glCullFace(GL_BACK); glEnable(GL_CULL_FACE);
<a name="l01186"></a>01186     
<a name="l01187"></a>01187     <span class="comment">/* disable blender light */</span>
<a name="l01188"></a>01188     <span class="keywordflow">for</span> (a = 0; a &lt; 8; a++) {
<a name="l01189"></a>01189         old[a] = glIsEnabled(GL_LIGHT0 + a);
<a name="l01190"></a>01190         glDisable(GL_LIGHT0 + a);
<a name="l01191"></a>01191     }
<a name="l01192"></a>01192     
<a name="l01193"></a>01193     <span class="comment">/* own light */</span>
<a name="l01194"></a>01194     glEnable(GL_LIGHT7);
<a name="l01195"></a>01195     glEnable(GL_LIGHTING);
<a name="l01196"></a>01196     
<a name="l01197"></a>01197     <a class="code" href="../../dd/dda/interface_8c.html#a12cb3aabf09cc9d093a80b0bc9ed98aa">ui_get_but_vectorf</a>(but, dir);
<a name="l01198"></a>01198 
<a name="l01199"></a>01199     dir[3] = 0.0f;   <span class="comment">/* glLight needs 4 args, 0.0 is sun */</span>
<a name="l01200"></a>01200     glLightfv(GL_LIGHT7, GL_POSITION, dir); 
<a name="l01201"></a>01201     glLightfv(GL_LIGHT7, GL_DIFFUSE, diffn); 
<a name="l01202"></a>01202     glLightfv(GL_LIGHT7, GL_SPECULAR, vec0); 
<a name="l01203"></a>01203     glLightf(GL_LIGHT7, GL_CONSTANT_ATTENUATION, 1.0f);
<a name="l01204"></a>01204     glLightf(GL_LIGHT7, GL_LINEAR_ATTENUATION, 0.0f);
<a name="l01205"></a>01205     
<a name="l01206"></a>01206     <span class="comment">/* transform to button */</span>
<a name="l01207"></a>01207     glPushMatrix();
<a name="l01208"></a>01208     glTranslatef(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + 0.5f * (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + 0.5f * (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>), 0.0f);
<a name="l01209"></a>01209     
<a name="l01210"></a>01210     <span class="keywordflow">if</span> (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> &lt; rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>)
<a name="l01211"></a>01211         size = (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>) / 200.f;
<a name="l01212"></a>01212     <span class="keywordflow">else</span>
<a name="l01213"></a>01213         size = (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>) / 200.f;
<a name="l01214"></a>01214     
<a name="l01215"></a>01215     glScalef(size, size, size);
<a name="l01216"></a>01216     
<a name="l01217"></a>01217     <span class="keywordflow">if</span> (displist == 0) {
<a name="l01218"></a>01218         GLUquadricObj   *qobj;
<a name="l01219"></a>01219         
<a name="l01220"></a>01220         displist = glGenLists(1);
<a name="l01221"></a>01221         glNewList(displist, GL_COMPILE_AND_EXECUTE);
<a name="l01222"></a>01222         
<a name="l01223"></a>01223         qobj = gluNewQuadric();
<a name="l01224"></a>01224         gluQuadricDrawStyle(qobj, GLU_FILL); 
<a name="l01225"></a>01225         glShadeModel(GL_SMOOTH);
<a name="l01226"></a>01226         gluSphere(qobj, 100.0, 32, 24);
<a name="l01227"></a>01227         glShadeModel(GL_FLAT);
<a name="l01228"></a>01228         gluDeleteQuadric(qobj);  
<a name="l01229"></a>01229         
<a name="l01230"></a>01230         glEndList();
<a name="l01231"></a>01231     }
<a name="l01232"></a>01232     <span class="keywordflow">else</span> glCallList(displist);
<a name="l01233"></a>01233     
<a name="l01234"></a>01234     <span class="comment">/* restore */</span>
<a name="l01235"></a>01235     glDisable(GL_LIGHTING);
<a name="l01236"></a>01236     glDisable(GL_CULL_FACE);
<a name="l01237"></a>01237     glMaterialfv(GL_FRONT, GL_DIFFUSE, diff); 
<a name="l01238"></a>01238     glDisable(GL_LIGHT7);
<a name="l01239"></a>01239     
<a name="l01240"></a>01240     <span class="comment">/* AA circle */</span>
<a name="l01241"></a>01241     glEnable(GL_BLEND);
<a name="l01242"></a>01242     glEnable(GL_LINE_SMOOTH);
<a name="l01243"></a>01243     glColor3ubv((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>);
<a name="l01244"></a>01244     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a86d799e333a90e03d5ab783640bde74a">glutil_draw_lined_arc</a>(0.0f, <a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * 2.0, 100.0f, 32);
<a name="l01245"></a>01245     glDisable(GL_BLEND);
<a name="l01246"></a>01246     glDisable(GL_LINE_SMOOTH);
<a name="l01247"></a>01247 
<a name="l01248"></a>01248     <span class="comment">/* matrix after circle */</span>
<a name="l01249"></a>01249     glPopMatrix();
<a name="l01250"></a>01250 
<a name="l01251"></a>01251     <span class="comment">/* enable blender light */</span>
<a name="l01252"></a>01252     <span class="keywordflow">for</span> (a = 0; a &lt; 8; a++) {
<a name="l01253"></a>01253         <span class="keywordflow">if</span> (old[a])
<a name="l01254"></a>01254             glEnable(GL_LIGHT0 + a);
<a name="l01255"></a>01255     }
<a name="l01256"></a>01256 }
<a name="l01257"></a>01257 
<a name="l01258"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a6cd72ed1e84b364160ce458832d07b26">01258</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a6cd72ed1e84b364160ce458832d07b26">ui_draw_but_curve_grid</a>(<a class="code" href="../../d0/d28/structrcti.html">rcti</a> *rect, <span class="keywordtype">float</span> zoomx, <span class="keywordtype">float</span> zoomy, <span class="keywordtype">float</span> offsx, <span class="keywordtype">float</span> offsy, <span class="keywordtype">float</span> <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>)
<a name="l01259"></a>01259 {
<a name="l01260"></a>01260     <span class="keywordtype">float</span> dx, dy, fx, fy;
<a name="l01261"></a>01261     
<a name="l01262"></a>01262     glBegin(GL_LINES);
<a name="l01263"></a>01263     dx = step * zoomx;
<a name="l01264"></a>01264     fx = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (-offsx);
<a name="l01265"></a>01265     <span class="keywordflow">if</span> (fx &gt; rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>) fx -= dx * (<a class="code" href="../../dd/d06/BLI__math__base_8h.html#addfa7d645df6e3c96924f253d8fb9b48">floorf</a>(fx - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>));
<a name="l01266"></a>01266     <span class="keywordflow">while</span> (fx &lt; rect-&gt;xmax) {
<a name="l01267"></a>01267         glVertex2f(fx, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>); 
<a name="l01268"></a>01268         glVertex2f(fx, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01269"></a>01269         fx += dx;
<a name="l01270"></a>01270     }
<a name="l01271"></a>01271     
<a name="l01272"></a>01272     dy = step * zoomy;
<a name="l01273"></a>01273     fy = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (-offsy);
<a name="l01274"></a>01274     <span class="keywordflow">if</span> (fy &gt; rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>) fy -= dy * (<a class="code" href="../../dd/d06/BLI__math__base_8h.html#addfa7d645df6e3c96924f253d8fb9b48">floorf</a>(fy - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>));
<a name="l01275"></a>01275     <span class="keywordflow">while</span> (fy &lt; rect-&gt;ymax) {
<a name="l01276"></a>01276         glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, fy); 
<a name="l01277"></a>01277         glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, fy);
<a name="l01278"></a>01278         fy += dy;
<a name="l01279"></a>01279     }
<a name="l01280"></a>01280     glEnd();
<a name="l01281"></a>01281     
<a name="l01282"></a>01282 }
<a name="l01283"></a>01283 
<a name="l01284"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a7d435fc31f5a8729065a2d5cc89ba4be">01284</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a7d435fc31f5a8729065a2d5cc89ba4be">glColor3ubvShade</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *col, <span class="keywordtype">int</span> shade)
<a name="l01285"></a>01285 {
<a name="l01286"></a>01286     glColor3ub(col[0] - shade &gt; 0 ? col[0] - shade : 0,
<a name="l01287"></a>01287                col[1] - shade &gt; 0 ? col[1] - shade : 0,
<a name="l01288"></a>01288                col[2] - shade &gt; 0 ? col[2] - shade : 0);
<a name="l01289"></a>01289 }
<a name="l01290"></a>01290 
<a name="l01291"></a><a class="code" href="../../d1/d2f/interface__intern_8h.html#a90183309489b45d37b76c5522355f499">01291</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#ab14fc959ffff52dcd2183752a49b0e29">ui_draw_but_CURVE</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *wcol, <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *rect)
<a name="l01292"></a>01292 {
<a name="l01293"></a>01293     <a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *cumap;
<a name="l01294"></a>01294     <a class="code" href="../../df/d78/structCurveMap.html">CurveMap</a> *cuma;
<a name="l01295"></a>01295     <a class="code" href="../../df/dff/structCurveMapPoint.html">CurveMapPoint</a> *cmp;
<a name="l01296"></a>01296     <span class="keywordtype">float</span> fx, fy, fac[2], zoomx, zoomy, offsx, offsy;
<a name="l01297"></a>01297     GLint scissor[4];
<a name="l01298"></a>01298     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> scissor_new;
<a name="l01299"></a>01299     <span class="keywordtype">int</span> a;
<a name="l01300"></a>01300 
<a name="l01301"></a>01301     cumap = (<a class="code" href="../../d4/d40/structCurveMapping.html">CurveMapping</a> *)(but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#ad49fa037c1b45e3c5ae4675dbc57a66a">editcumap</a> ? but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#ad49fa037c1b45e3c5ae4675dbc57a66a">editcumap</a> : but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a8376dbee35a2eef4197223c5ecc18963">poin</a>);
<a name="l01302"></a>01302     cuma = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#abaeb35254b998c201c1957d67a757f7c">cm</a> + cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>;
<a name="l01303"></a>01303     
<a name="l01304"></a>01304     <span class="comment">/* need scissor test, curve can draw outside of boundary */</span>
<a name="l01305"></a>01305     glGetIntegerv(GL_VIEWPORT, scissor);
<a name="l01306"></a>01306     scissor_new.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>;
<a name="l01307"></a>01307     scissor_new.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>;
<a name="l01308"></a>01308     scissor_new.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>;
<a name="l01309"></a>01309     scissor_new.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>;
<a name="l01310"></a>01310     <a class="code" href="../../d5/d44/BLI__rect_8h.html#abefa6d62a6bf5021bb1567112c87fd09">BLI_isect_rcti</a>(&amp;scissor_new, &amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>, &amp;scissor_new);
<a name="l01311"></a>01311     glScissor(scissor_new.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, scissor_new.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, scissor_new.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - scissor_new.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, scissor_new.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - scissor_new.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>);
<a name="l01312"></a>01312     
<a name="l01313"></a>01313     <span class="comment">/* calculate offset and zoom */</span>
<a name="l01314"></a>01314     zoomx = (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> - 2.0f * but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a>) / (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>);
<a name="l01315"></a>01315     zoomy = (rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> - 2.0f * but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a>) / (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>);
<a name="l01316"></a>01316     offsx = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a> / zoomx;
<a name="l01317"></a>01317     offsy = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a88909968cf780b4ddaaa900f739eaf26">curr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a50eeaa8bd347134ebf9d7fe43a33acb4">aspect</a> / zoomy;
<a name="l01318"></a>01318     
<a name="l01319"></a>01319     <span class="comment">/* backdrop */</span>
<a name="l01320"></a>01320     <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a8649d5f9bc9f67e68cf78ffaa5b8695b">CUMA_DO_CLIP</a>) {
<a name="l01321"></a>01321         <a class="code" href="../../d7/d86/interface__draw_8c.html#a7d435fc31f5a8729065a2d5cc89ba4be">glColor3ubvShade</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>, -20);
<a name="l01322"></a>01322         glRectf(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01323"></a>01323         glColor3ubv((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>);
<a name="l01324"></a>01324         glRectf(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - offsx),
<a name="l01325"></a>01325                 rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - offsy),
<a name="l01326"></a>01326                 rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - offsx),
<a name="l01327"></a>01327                 rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a8a22e59a40d9fdd4cd46ebed31f078d4">clipr</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - offsy));
<a name="l01328"></a>01328     }
<a name="l01329"></a>01329     <span class="keywordflow">else</span> {
<a name="l01330"></a>01330         glColor3ubv((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>);
<a name="l01331"></a>01331         glRectf(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01332"></a>01332     }
<a name="l01333"></a>01333         
<a name="l01334"></a>01334     <span class="comment">/* grid, every .25 step */</span>
<a name="l01335"></a>01335     <a class="code" href="../../d7/d86/interface__draw_8c.html#a7d435fc31f5a8729065a2d5cc89ba4be">glColor3ubvShade</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>, -16);
<a name="l01336"></a>01336     <a class="code" href="../../d7/d86/interface__draw_8c.html#a6cd72ed1e84b364160ce458832d07b26">ui_draw_but_curve_grid</a>(rect, zoomx, zoomy, offsx, offsy, 0.25f);
<a name="l01337"></a>01337     <span class="comment">/* grid, every 1.0 step */</span>
<a name="l01338"></a>01338     <a class="code" href="../../d7/d86/interface__draw_8c.html#a7d435fc31f5a8729065a2d5cc89ba4be">glColor3ubvShade</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>, -24);
<a name="l01339"></a>01339     <a class="code" href="../../d7/d86/interface__draw_8c.html#a6cd72ed1e84b364160ce458832d07b26">ui_draw_but_curve_grid</a>(rect, zoomx, zoomy, offsx, offsy, 1.0f);
<a name="l01340"></a>01340     <span class="comment">/* axes */</span>
<a name="l01341"></a>01341     <a class="code" href="../../d7/d86/interface__draw_8c.html#a7d435fc31f5a8729065a2d5cc89ba4be">glColor3ubvShade</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a6de251bbc52f156af19e4e099aac76d5">inner</a>, -50);
<a name="l01342"></a>01342     glBegin(GL_LINES);
<a name="l01343"></a>01343     glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (-offsy));
<a name="l01344"></a>01344     glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (-offsy));
<a name="l01345"></a>01345     glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (-offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>);
<a name="l01346"></a>01346     glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (-offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01347"></a>01347     glEnd();
<a name="l01348"></a>01348     
<a name="l01349"></a>01349     <span class="comment">/* magic trigger for curve backgrounds */</span>
<a name="l01350"></a>01350     <span class="keywordflow">if</span> (but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a57586f98222f543b349453c1a83b4ce9">a1</a> != -1) {
<a name="l01351"></a>01351         <span class="keywordflow">if</span> (but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a57586f98222f543b349453c1a83b4ce9">a1</a> == <a class="code" href="../../d8/d1e/UI__interface_8h.html#acf9f25115e50fa96e2aea41929d3c42c">UI_GRAD_H</a>) {
<a name="l01352"></a>01352             <a class="code" href="../../d0/d28/structrcti.html">rcti</a> grid;
<a name="l01353"></a>01353             <span class="keywordtype">float</span> col[3] = {0.0f, 0.0f, 0.0f}; <span class="comment">/* dummy arg */</span>
<a name="l01354"></a>01354             
<a name="l01355"></a>01355             grid.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (-offsx);
<a name="l01356"></a>01356             grid.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> + zoomx * (-offsx);
<a name="l01357"></a>01357             grid.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (-offsy);
<a name="l01358"></a>01358             grid.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> + zoomy * (-offsy);
<a name="l01359"></a>01359             
<a name="l01360"></a>01360             glEnable(GL_BLEND);
<a name="l01361"></a>01361             <a class="code" href="../../d1/d2f/interface__intern_8h.html#a4082e557cb904506bf6cb3e47b4faf0e">ui_draw_gradient</a>(&amp;grid, col, <a class="code" href="../../d8/d1e/UI__interface_8h.html#acf9f25115e50fa96e2aea41929d3c42c">UI_GRAD_H</a>, 0.5f);
<a name="l01362"></a>01362             glDisable(GL_BLEND);
<a name="l01363"></a>01363         }
<a name="l01364"></a>01364     }
<a name="l01365"></a>01365     
<a name="l01366"></a>01366     
<a name="l01367"></a>01367     <span class="comment">/* cfra option */</span>
<a name="l01368"></a>01368     <span class="comment">/* XXX 2.48 */</span>
<a name="l01369"></a>01369 <span class="preprocessor">#if 0</span>
<a name="l01370"></a>01370 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#aefe55a13cf79a266eea2db768e085aba">CUMA_DRAW_CFRA</a>) {
<a name="l01371"></a>01371         glColor3ub(0x60, 0xc0, 0x40);
<a name="l01372"></a>01372         glBegin(GL_LINES);
<a name="l01373"></a>01373         glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a1f31dd9b63c170dd3ebaa9962f3be01f">sample</a>[0] - offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>);
<a name="l01374"></a>01374         glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a1f31dd9b63c170dd3ebaa9962f3be01f">sample</a>[0] - offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01375"></a>01375         glEnd();
<a name="l01376"></a>01376     }
<a name="l01377"></a>01377 <span class="preprocessor">#endif</span>
<a name="l01378"></a>01378 <span class="preprocessor"></span>    <span class="comment">/* sample option */</span>
<a name="l01379"></a>01379 
<a name="l01380"></a>01380     <span class="comment">/* XXX 2.48 */</span>
<a name="l01381"></a>01381 <span class="preprocessor">#if 0</span>
<a name="l01382"></a>01382 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a130f6998b7ff2069fa85e60d83b0a1f2">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a28f8d6fba0b516d11d46c5afb52ab88d">CUMA_DRAW_SAMPLE</a>) {
<a name="l01383"></a>01383         <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a> == 3) {
<a name="l01384"></a>01384             <span class="keywordtype">float</span> lum = cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a1f31dd9b63c170dd3ebaa9962f3be01f">sample</a>[0] * 0.35f + cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a1f31dd9b63c170dd3ebaa9962f3be01f">sample</a>[1] * 0.45f + cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a1f31dd9b63c170dd3ebaa9962f3be01f">sample</a>[2] * 0.2f;
<a name="l01385"></a>01385             glColor3ub(240, 240, 240);
<a name="l01386"></a>01386             
<a name="l01387"></a>01387             glBegin(GL_LINES);
<a name="l01388"></a>01388             glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (lum - offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>);
<a name="l01389"></a>01389             glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (lum - offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01390"></a>01390             glEnd();
<a name="l01391"></a>01391         }
<a name="l01392"></a>01392         <span class="keywordflow">else</span> {
<a name="l01393"></a>01393             <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a> == 0)
<a name="l01394"></a>01394                 glColor3ub(240, 100, 100);
<a name="l01395"></a>01395             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a> == 1)
<a name="l01396"></a>01396                 glColor3ub(100, 240, 100);
<a name="l01397"></a>01397             <span class="keywordflow">else</span>
<a name="l01398"></a>01398                 glColor3ub(100, 100, 240);
<a name="l01399"></a>01399             
<a name="l01400"></a>01400             glBegin(GL_LINES);
<a name="l01401"></a>01401             glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a1f31dd9b63c170dd3ebaa9962f3be01f">sample</a>[cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>] - offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>);
<a name="l01402"></a>01402             glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a1f31dd9b63c170dd3ebaa9962f3be01f">sample</a>[cumap-&gt;<a class="code" href="../../d4/d40/structCurveMapping.html#a42253f3512ecfa1a9d852cbab168d744">cur</a>] - offsx), rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01403"></a>01403             glEnd();
<a name="l01404"></a>01404         }
<a name="l01405"></a>01405     }
<a name="l01406"></a>01406 <span class="preprocessor">#endif</span>
<a name="l01407"></a>01407 <span class="preprocessor"></span>
<a name="l01408"></a>01408     <span class="comment">/* the curve */</span>
<a name="l01409"></a>01409     glColor3ubv((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a18056a96135f727bea4450b9892c799f">item</a>);
<a name="l01410"></a>01410     glEnable(GL_LINE_SMOOTH);
<a name="l01411"></a>01411     glEnable(GL_BLEND);
<a name="l01412"></a>01412     glBegin(GL_LINE_STRIP);
<a name="l01413"></a>01413     
<a name="l01414"></a>01414     <span class="keywordflow">if</span> (cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#a0223edf9524f4d5558d5e5311b25f953">table</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01415"></a>01415         <a class="code" href="../../d4/dca/BKE__colortools_8h.html#af77727c97a9f13c114da3e7dc320f41e">curvemapping_changed</a>(cumap, 0);  <span class="comment">/* 0 = no remove doubles */</span>
<a name="l01416"></a>01416     cmp = cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#a0223edf9524f4d5558d5e5311b25f953">table</a>;
<a name="l01417"></a>01417     
<a name="l01418"></a>01418     <span class="comment">/* first point */</span>
<a name="l01419"></a>01419     <span class="keywordflow">if</span> ((cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#ab8bdb4a30d4ac21edb9c7f0fe4784c9c">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a53e0b7a779b29f4940c4eae3fd37ad8d">CUMA_EXTEND_EXTRAPOLATE</a>) == 0)
<a name="l01420"></a>01420         glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cmp[0].<a class="code" href="../../df/dff/structCurveMapPoint.html#ad00139b75f5fe65b70d3dfe1c6e7eb6d">y</a> - offsy));
<a name="l01421"></a>01421     <span class="keywordflow">else</span> {
<a name="l01422"></a>01422         fx = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cmp[0].<a class="code" href="../../df/dff/structCurveMapPoint.html#ac3df3f983158221ce011fe7f925e6f05">x</a> - offsx + cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#acf81e60220bfdbc4c7ea1647c757fc76">ext_in</a>[0]);
<a name="l01423"></a>01423         fy = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cmp[0].<a class="code" href="../../df/dff/structCurveMapPoint.html#ad00139b75f5fe65b70d3dfe1c6e7eb6d">y</a> - offsy + cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#acf81e60220bfdbc4c7ea1647c757fc76">ext_in</a>[1]);
<a name="l01424"></a>01424         glVertex2f(fx, fy);
<a name="l01425"></a>01425     }
<a name="l01426"></a>01426     <span class="keywordflow">for</span> (a = 0; a &lt;= <a class="code" href="../../da/ddd/DNA__color__types_8h.html#ad104910b48f7f1f351bb3363878be80b">CM_TABLE</a>; a++) {
<a name="l01427"></a>01427         fx = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cmp[a].<a class="code" href="../../df/dff/structCurveMapPoint.html#ac3df3f983158221ce011fe7f925e6f05">x</a> - offsx);
<a name="l01428"></a>01428         fy = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cmp[a].<a class="code" href="../../df/dff/structCurveMapPoint.html#ad00139b75f5fe65b70d3dfe1c6e7eb6d">y</a> - offsy);
<a name="l01429"></a>01429         glVertex2f(fx, fy);
<a name="l01430"></a>01430     }
<a name="l01431"></a>01431     <span class="comment">/* last point */</span>
<a name="l01432"></a>01432     <span class="keywordflow">if</span> ((cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#ab8bdb4a30d4ac21edb9c7f0fe4784c9c">flag</a> &amp; <a class="code" href="../../da/ddd/DNA__color__types_8h.html#a53e0b7a779b29f4940c4eae3fd37ad8d">CUMA_EXTEND_EXTRAPOLATE</a>) == 0)
<a name="l01433"></a>01433         glVertex2f(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cmp[<a class="code" href="../../da/ddd/DNA__color__types_8h.html#ad104910b48f7f1f351bb3363878be80b">CM_TABLE</a>].<a class="code" href="../../df/dff/structCurveMapPoint.html#ad00139b75f5fe65b70d3dfe1c6e7eb6d">y</a> - offsy));
<a name="l01434"></a>01434     <span class="keywordflow">else</span> {
<a name="l01435"></a>01435         fx = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cmp[<a class="code" href="../../da/ddd/DNA__color__types_8h.html#ad104910b48f7f1f351bb3363878be80b">CM_TABLE</a>].<a class="code" href="../../df/dff/structCurveMapPoint.html#ac3df3f983158221ce011fe7f925e6f05">x</a> - offsx - cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#abb64cb9878e61a6153a6e2f561cfd87e">ext_out</a>[0]);
<a name="l01436"></a>01436         fy = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cmp[<a class="code" href="../../da/ddd/DNA__color__types_8h.html#ad104910b48f7f1f351bb3363878be80b">CM_TABLE</a>].<a class="code" href="../../df/dff/structCurveMapPoint.html#ad00139b75f5fe65b70d3dfe1c6e7eb6d">y</a> - offsy - cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#abb64cb9878e61a6153a6e2f561cfd87e">ext_out</a>[1]);
<a name="l01437"></a>01437         glVertex2f(fx, fy);
<a name="l01438"></a>01438     }
<a name="l01439"></a>01439     glEnd();
<a name="l01440"></a>01440     glDisable(GL_LINE_SMOOTH);
<a name="l01441"></a>01441     glDisable(GL_BLEND);
<a name="l01442"></a>01442 
<a name="l01443"></a>01443     <span class="comment">/* the points, use aspect to make them visible on edges */</span>
<a name="l01444"></a>01444     cmp = cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#a643068e2e4257d4d70f5759a426765c8">curve</a>;
<a name="l01445"></a>01445     glPointSize(3.0f);
<a name="l01446"></a>01446     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#acbcc8c3223d7fc13a7931b0a1744b240">bglBegin</a>(GL_POINTS);
<a name="l01447"></a>01447     <span class="keywordflow">for</span> (a = 0; a &lt; cuma-&gt;<a class="code" href="../../df/d78/structCurveMap.html#a5105395e92fbba51dbc60ec65fb0c390">totpoint</a>; a++) {
<a name="l01448"></a>01448         <span class="keywordflow">if</span> (cmp[a].flag &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l01449"></a>01449             <a class="code" href="../../de/d96/UI__resources_8h.html#af31db5d1a7c8b15e6e8a008482426f3a">UI_ThemeColor</a>(<a class="code" href="../../de/d96/UI__resources_8h.html#ae33c78feb670de33d2abf21ec0624531aff83a64859a3ca49a01a88357acaf007">TH_TEXT_HI</a>);
<a name="l01450"></a>01450         <span class="keywordflow">else</span>
<a name="l01451"></a>01451             <a class="code" href="../../de/d96/UI__resources_8h.html#af31db5d1a7c8b15e6e8a008482426f3a">UI_ThemeColor</a>(<a class="code" href="../../de/d96/UI__resources_8h.html#ae33c78feb670de33d2abf21ec0624531ade800b14585ec3bc83905fe667484c4b">TH_TEXT</a>);
<a name="l01452"></a>01452         fac[0] = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + zoomx * (cmp[a].<a class="code" href="../../df/dff/structCurveMapPoint.html#ac3df3f983158221ce011fe7f925e6f05">x</a> - offsx);
<a name="l01453"></a>01453         fac[1] = rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + zoomy * (cmp[a].<a class="code" href="../../df/dff/structCurveMapPoint.html#ad00139b75f5fe65b70d3dfe1c6e7eb6d">y</a> - offsy);
<a name="l01454"></a>01454         <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a9cedf1b12ee7e019318c2470fa0c857f">bglVertex2fv</a>(fac);
<a name="l01455"></a>01455     }
<a name="l01456"></a>01456     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a2517dcaf453d3e58af25fd4c677dad45">bglEnd</a>();
<a name="l01457"></a>01457     glPointSize(1.0f);
<a name="l01458"></a>01458     
<a name="l01459"></a>01459     <span class="comment">/* restore scissortest */</span>
<a name="l01460"></a>01460     glScissor(scissor[0], scissor[1], scissor[2], scissor[3]);
<a name="l01461"></a>01461 
<a name="l01462"></a>01462     <span class="comment">/* outline */</span>
<a name="l01463"></a>01463     glColor3ubv((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)wcol-&gt;<a class="code" href="../../df/db4/structuiWidgetColors.html#a8b28dcb12495431a69433b94ffef15b2">outline</a>);
<a name="l01464"></a>01464     <a class="code" href="../../d9/d71/BIF__glutil_8h.html#a927bebeabf30bfa7ca451c16fe9336e4">fdrawbox</a>(rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a>, rect-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a>);
<a name="l01465"></a>01465 }
<a name="l01466"></a>01466 
<a name="l01467"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a55006108cf119f729a409108612ee6fe">01467</a> <span class="keyword">static</span> <a class="code" href="../../d3/dd9/structImBuf.html">ImBuf</a> *<a class="code" href="../../d7/d86/interface__draw_8c.html#a55006108cf119f729a409108612ee6fe">scale_trackpreview_ibuf</a>(<a class="code" href="../../d3/dd9/structImBuf.html">ImBuf</a> *ibuf, <span class="keywordtype">float</span> track_pos[2], <span class="keywordtype">int</span> width, <span class="keywordtype">float</span> height, <span class="keywordtype">int</span> margin)
<a name="l01468"></a>01468 {
<a name="l01469"></a>01469     <a class="code" href="../../d3/dd9/structImBuf.html">ImBuf</a> *scaleibuf;
<a name="l01470"></a>01470     <span class="keyword">const</span> <span class="keywordtype">float</span> scalex = ((float)ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ae7734bc51f5e3e75be66e6f6a26f4f4e">x</a> - 2 * margin) / width;
<a name="l01471"></a>01471     <span class="keyword">const</span> <span class="keywordtype">float</span> scaley = ((float)ibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#a9b88fc1c373dd2aa0d4c174c87913050">y</a> - 2 * margin) / height;
<a name="l01472"></a>01472     <span class="keywordtype">float</span> off_x = (int)track_pos[0] - track_pos[0] + 0.5f;
<a name="l01473"></a>01473     <span class="keywordtype">float</span> off_y = (int)track_pos[1] - track_pos[1] + 0.5f;
<a name="l01474"></a>01474     <span class="keywordtype">int</span> x, y;
<a name="l01475"></a>01475 
<a name="l01476"></a>01476     scaleibuf = <a class="code" href="../../db/d49/IMB__imbuf_8h.html#a439680f7777db0973e76f25001cff0cd">IMB_allocImBuf</a>(width, height, 32, <a class="code" href="../../d7/dc9/IMB__imbuf__types_8h.html#aa49c3338a20e388ce6ade7af88a93d40" title="Flag defining the components of the ImBuf struct.">IB_rect</a>);
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     <span class="keywordflow">for</span> (y = 0; y &lt; height; y++) {
<a name="l01479"></a>01479         <span class="keywordflow">for</span> (x = 0; x &lt; width; x++) {
<a name="l01480"></a>01480             <span class="keywordtype">float</span> src_x = scalex * (x) + margin - off_x;
<a name="l01481"></a>01481             <span class="keywordtype">float</span> src_y = scaley * (y) + margin - off_y;
<a name="l01482"></a>01482 
<a name="l01483"></a>01483             <a class="code" href="../../db/d49/IMB__imbuf_8h.html#a0ca4482c909990236e9f98aa3b8c5256">bicubic_interpolation</a>(ibuf, scaleibuf, src_x, src_y, x, y);
<a name="l01484"></a>01484         }
<a name="l01485"></a>01485     }
<a name="l01486"></a>01486 
<a name="l01487"></a>01487     <span class="keywordflow">return</span> scaleibuf;
<a name="l01488"></a>01488 }
<a name="l01489"></a>01489 
<a name="l01490"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a6bb53c6aadb3f9c395c0269882b00f0d">01490</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a6bb53c6aadb3f9c395c0269882b00f0d">ui_draw_but_TRACKPREVIEW</a>(<a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but, <a class="code" href="../../df/db4/structuiWidgetColors.html">uiWidgetColors</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(wcol), <a class="code" href="../../d0/d28/structrcti.html">rcti</a> *recti)
<a name="l01491"></a>01491 {
<a name="l01492"></a>01492     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l01493"></a>01493     <span class="keywordtype">int</span> ok = 0;
<a name="l01494"></a>01494     GLint scissor[4];
<a name="l01495"></a>01495     <a class="code" href="../../d5/d2c/structMovieClipScopes.html">MovieClipScopes</a> *scopes = (<a class="code" href="../../d5/d2c/structMovieClipScopes.html">MovieClipScopes</a> *)but-&gt;<a class="code" href="../../d5/dd7/structuiBut.html#a8376dbee35a2eef4197223c5ecc18963">poin</a>;
<a name="l01496"></a>01496 
<a name="l01497"></a>01497     rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = (<span class="keywordtype">float</span>)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + 1;
<a name="l01498"></a>01498     rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = (float)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - 1;
<a name="l01499"></a>01499     rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = (<span class="keywordtype">float</span>)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + <a class="code" href="../../d1/d2f/interface__intern_8h.html#a52b052f783f39b4ca186fc07c9a5ae28">SCOPE_RESIZE_PAD</a> + 2;
<a name="l01500"></a>01500     rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = (float)recti-&gt;<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - 1;
<a name="l01501"></a>01501 
<a name="l01502"></a>01502     glEnable(GL_BLEND);
<a name="l01503"></a>01503     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l01504"></a>01504 
<a name="l01505"></a>01505     <span class="comment">/* need scissor test, preview image can draw outside of boundary */</span>
<a name="l01506"></a>01506     glGetIntegerv(GL_VIEWPORT, scissor);
<a name="l01507"></a>01507     glScissor(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + (rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - 1), ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + (rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 1), (rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + 1) - (rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - 1), (rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + 1) - (rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 1));
<a name="l01508"></a>01508 
<a name="l01509"></a>01509     <span class="keywordflow">if</span> (scopes-&gt;<a class="code" href="../../d5/d2c/structMovieClipScopes.html#abda63626f823626fd4c5ddf3068b3507">track_disabled</a>) {
<a name="l01510"></a>01510         glColor4f(0.7f, 0.3f, 0.3f, 0.3f);
<a name="l01511"></a>01511         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(15);
<a name="l01512"></a>01512         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_POLYGON, rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - 1, rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + 1, rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + 1, 3.0f);
<a name="l01513"></a>01513 
<a name="l01514"></a>01514         ok = 1;
<a name="l01515"></a>01515     }
<a name="l01516"></a>01516     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scopes-&gt;<a class="code" href="../../d5/d2c/structMovieClipScopes.html#a3b99ae69511066325d03727aa3423c01">track_preview</a>) {
<a name="l01517"></a>01517         <span class="comment">/* additional margin around image */</span>
<a name="l01518"></a>01518         <span class="comment">/* NOTE: should be kept in sync with value from BKE_movieclip_update_scopes */</span>
<a name="l01519"></a>01519         <span class="keyword">const</span> <span class="keywordtype">int</span> margin = 3;
<a name="l01520"></a>01520         <span class="keywordtype">float</span> zoomx, zoomy, track_pos[2], off_x, off_y;
<a name="l01521"></a>01521         <span class="keywordtype">int</span> a, width, height;
<a name="l01522"></a>01522         <a class="code" href="../../d3/dd9/structImBuf.html">ImBuf</a> *drawibuf;
<a name="l01523"></a>01523 
<a name="l01524"></a>01524         glPushMatrix();
<a name="l01525"></a>01525 
<a name="l01526"></a>01526         track_pos[0] = scopes-&gt;<a class="code" href="../../d5/d2c/structMovieClipScopes.html#a6304e1b891bbdeda1d365004e4c8e129">track_pos</a>[0] - margin;
<a name="l01527"></a>01527         track_pos[1] = scopes-&gt;<a class="code" href="../../d5/d2c/structMovieClipScopes.html#a6304e1b891bbdeda1d365004e4c8e129">track_pos</a>[1] - margin;
<a name="l01528"></a>01528 
<a name="l01529"></a>01529         <span class="comment">/* draw content of pattern area */</span>
<a name="l01530"></a>01530         glScissor(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, scissor[2], scissor[3]);
<a name="l01531"></a>01531 
<a name="l01532"></a>01532         width = rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> + 1;
<a name="l01533"></a>01533         height = rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>;
<a name="l01534"></a>01534 
<a name="l01535"></a>01535         <span class="keywordflow">if</span> (width &gt; 0 &amp;&amp; height &gt; 0) {
<a name="l01536"></a>01536             zoomx = (float)width / (scopes-&gt;<a class="code" href="../../d5/d2c/structMovieClipScopes.html#a3b99ae69511066325d03727aa3423c01">track_preview</a>-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ae7734bc51f5e3e75be66e6f6a26f4f4e">x</a> - 2 * margin);
<a name="l01537"></a>01537             zoomy = (float)height / (scopes-&gt;<a class="code" href="../../d5/d2c/structMovieClipScopes.html#a3b99ae69511066325d03727aa3423c01">track_preview</a>-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#a9b88fc1c373dd2aa0d4c174c87913050">y</a> - 2 * margin);
<a name="l01538"></a>01538 
<a name="l01539"></a>01539             off_x = ((int)track_pos[0] - track_pos[0] + 0.5f) * zoomx;
<a name="l01540"></a>01540             off_y = ((int)track_pos[1] - track_pos[1] + 0.5f) * zoomy;
<a name="l01541"></a>01541 
<a name="l01542"></a>01542             drawibuf = <a class="code" href="../../d7/d86/interface__draw_8c.html#a55006108cf119f729a409108612ee6fe">scale_trackpreview_ibuf</a>(scopes-&gt;<a class="code" href="../../d5/d2c/structMovieClipScopes.html#a3b99ae69511066325d03727aa3423c01">track_preview</a>, track_pos, width, height, margin);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544             <a class="code" href="../../d9/d71/BIF__glutil_8h.html#af25e117bcafaaa076b5c533978ac52f6">glaDrawPixelsSafe</a>(rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> + 1, drawibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ae7734bc51f5e3e75be66e6f6a26f4f4e">x</a>, drawibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#a9b88fc1c373dd2aa0d4c174c87913050">y</a>,
<a name="l01545"></a>01545                               drawibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ae7734bc51f5e3e75be66e6f6a26f4f4e">x</a>, GL_RGBA, GL_UNSIGNED_BYTE, drawibuf-&gt;<a class="code" href="../../d3/dd9/structImBuf.html#ade8b2f05559e57840af8d3657817f8c8">rect</a>);
<a name="l01546"></a>01546             <a class="code" href="../../db/d49/IMB__imbuf_8h.html#a40eceec0075863e55997a3fb210a18ae">IMB_freeImBuf</a>(drawibuf);
<a name="l01547"></a>01547 
<a name="l01548"></a>01548             <span class="comment">/* draw cross for pizel position */</span>
<a name="l01549"></a>01549             glTranslatef(off_x + rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> + track_pos[0] * zoomx, off_y + rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> + track_pos[1] * zoomy, 0.f);
<a name="l01550"></a>01550             glScissor(ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ac2944792e9f57effa923f02b3a40ac62">winrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>);
<a name="l01551"></a>01551 
<a name="l01552"></a>01552             <span class="keywordflow">for</span> (a = 0; a &lt; 2; a++) {
<a name="l01553"></a>01553                 <span class="keywordflow">if</span> (a == 1) {
<a name="l01554"></a>01554                     glLineStipple(3, 0xaaaa);
<a name="l01555"></a>01555                     glEnable(GL_LINE_STIPPLE);
<a name="l01556"></a>01556                     <a class="code" href="../../de/d96/UI__resources_8h.html#af31db5d1a7c8b15e6e8a008482426f3a">UI_ThemeColor</a>(<a class="code" href="../../de/d96/UI__resources_8h.html#ae33c78feb670de33d2abf21ec0624531acdb00b2c5e8159981da03679a3b5dbf5">TH_SEL_MARKER</a>);
<a name="l01557"></a>01557                 }
<a name="l01558"></a>01558                 <span class="keywordflow">else</span> {
<a name="l01559"></a>01559                     <a class="code" href="../../de/d96/UI__resources_8h.html#af31db5d1a7c8b15e6e8a008482426f3a">UI_ThemeColor</a>(<a class="code" href="../../de/d96/UI__resources_8h.html#ae33c78feb670de33d2abf21ec0624531a103722a8f784b4720136332e32659cde">TH_MARKER_OUTLINE</a>);
<a name="l01560"></a>01560                 }
<a name="l01561"></a>01561 
<a name="l01562"></a>01562                 glBegin(GL_LINES);
<a name="l01563"></a>01563                 glVertex2f(-10.0f, 0.0f);
<a name="l01564"></a>01564                 glVertex2f(10.0f, 0.0f);
<a name="l01565"></a>01565                 glVertex2f(0.0f, -10.0f);
<a name="l01566"></a>01566                 glVertex2f(0.0f, 10.0f);
<a name="l01567"></a>01567                 glEnd();
<a name="l01568"></a>01568             }
<a name="l01569"></a>01569         }
<a name="l01570"></a>01570 
<a name="l01571"></a>01571         glDisable(GL_LINE_STIPPLE);
<a name="l01572"></a>01572         glPopMatrix();
<a name="l01573"></a>01573 
<a name="l01574"></a>01574         ok = 1;
<a name="l01575"></a>01575     }
<a name="l01576"></a>01576 
<a name="l01577"></a>01577     <span class="keywordflow">if</span> (!ok) {
<a name="l01578"></a>01578         glColor4f(0.f, 0.f, 0.f, 0.3f);
<a name="l01579"></a>01579         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8fc510c8382c62a5af3a095e218d8f3d">uiSetRoundBox</a>(15);
<a name="l01580"></a>01580         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_POLYGON, rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - 1, rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + 1, rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + 1, 3.0f);
<a name="l01581"></a>01581     }
<a name="l01582"></a>01582 
<a name="l01583"></a>01583     <span class="comment">/* outline, scale gripper */</span>
<a name="l01584"></a>01584     <a class="code" href="../../d7/d86/interface__draw_8c.html#a604dc63ba4a80cb69c19153cc220a268">draw_scope_end</a>(&amp;rect, scissor);
<a name="l01585"></a>01585 
<a name="l01586"></a>01586     glDisable(GL_BLEND);
<a name="l01587"></a>01587 }
<a name="l01588"></a>01588 
<a name="l01589"></a>01589 <span class="comment">/* ****************************************************** */</span>
<a name="l01590"></a>01590 
<a name="l01591"></a>01591 
<a name="l01592"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#ad5110fb6c81aa5ba70f23d1183e52fa4">01592</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#ad5110fb6c81aa5ba70f23d1183e52fa4">ui_shadowbox</a>(<span class="keywordtype">float</span> minx, <span class="keywordtype">float</span> miny, <span class="keywordtype">float</span> maxx, <span class="keywordtype">float</span> maxy, <span class="keywordtype">float</span> shadsize, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> alpha)
<a name="l01593"></a>01593 {
<a name="l01594"></a>01594     glEnable(GL_BLEND);
<a name="l01595"></a>01595     glShadeModel(GL_SMOOTH);
<a name="l01596"></a>01596     
<a name="l01597"></a>01597     <span class="comment">/* right quad */</span>
<a name="l01598"></a>01598     glBegin(GL_POLYGON);
<a name="l01599"></a>01599     glColor4ub(0, 0, 0, alpha);
<a name="l01600"></a>01600     glVertex2f(maxx, miny);
<a name="l01601"></a>01601     glVertex2f(maxx, maxy - 0.3f * shadsize);
<a name="l01602"></a>01602     glColor4ub(0, 0, 0, 0);
<a name="l01603"></a>01603     glVertex2f(maxx + shadsize, maxy - 0.75f * shadsize);
<a name="l01604"></a>01604     glVertex2f(maxx + shadsize, miny);
<a name="l01605"></a>01605     glEnd();
<a name="l01606"></a>01606     
<a name="l01607"></a>01607     <span class="comment">/* corner shape */</span>
<a name="l01608"></a>01608     glBegin(GL_POLYGON);
<a name="l01609"></a>01609     glColor4ub(0, 0, 0, alpha);
<a name="l01610"></a>01610     glVertex2f(maxx, miny);
<a name="l01611"></a>01611     glColor4ub(0, 0, 0, 0);
<a name="l01612"></a>01612     glVertex2f(maxx + shadsize, miny);
<a name="l01613"></a>01613     glVertex2f(maxx + 0.7f * shadsize, miny - 0.7f * shadsize);
<a name="l01614"></a>01614     glVertex2f(maxx, miny - shadsize);
<a name="l01615"></a>01615     glEnd();
<a name="l01616"></a>01616     
<a name="l01617"></a>01617     <span class="comment">/* bottom quad */</span>       
<a name="l01618"></a>01618     glBegin(GL_POLYGON);
<a name="l01619"></a>01619     glColor4ub(0, 0, 0, alpha);
<a name="l01620"></a>01620     glVertex2f(minx + 0.3f * shadsize, miny);
<a name="l01621"></a>01621     glVertex2f(maxx, miny);
<a name="l01622"></a>01622     glColor4ub(0, 0, 0, 0);
<a name="l01623"></a>01623     glVertex2f(maxx, miny - shadsize);
<a name="l01624"></a>01624     glVertex2f(minx + 0.5f * shadsize, miny - shadsize);
<a name="l01625"></a>01625     glEnd();
<a name="l01626"></a>01626     
<a name="l01627"></a>01627     glDisable(GL_BLEND);
<a name="l01628"></a>01628     glShadeModel(GL_FLAT);
<a name="l01629"></a>01629 }
<a name="l01630"></a>01630 
<a name="l01631"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#af1cb4a2266737385dec0b5828724371b">01631</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d1e/UI__interface_8h.html#af1cb4a2266737385dec0b5828724371b">uiDrawBoxShadow</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> alpha, <span class="keywordtype">float</span> minx, <span class="keywordtype">float</span> miny, <span class="keywordtype">float</span> maxx, <span class="keywordtype">float</span> maxy)
<a name="l01632"></a>01632 {
<a name="l01633"></a>01633     <span class="comment">/* accumulated outline boxes to make shade not linear, is more pleasant */</span>
<a name="l01634"></a>01634     <a class="code" href="../../d7/d86/interface__draw_8c.html#ad5110fb6c81aa5ba70f23d1183e52fa4">ui_shadowbox</a>(minx, miny, maxx, maxy, 11.0, (20 * alpha) &gt;&gt; 8);
<a name="l01635"></a>01635     <a class="code" href="../../d7/d86/interface__draw_8c.html#ad5110fb6c81aa5ba70f23d1183e52fa4">ui_shadowbox</a>(minx, miny, maxx, maxy, 7.0, (40 * alpha) &gt;&gt; 8);
<a name="l01636"></a>01636     <a class="code" href="../../d7/d86/interface__draw_8c.html#ad5110fb6c81aa5ba70f23d1183e52fa4">ui_shadowbox</a>(minx, miny, maxx, maxy, 5.0, (80 * alpha) &gt;&gt; 8);
<a name="l01637"></a>01637     
<a name="l01638"></a>01638 }
<a name="l01639"></a>01639 
<a name="l01640"></a>01640 
<a name="l01641"></a><a class="code" href="../../d7/d86/interface__draw_8c.html#a468f37a013a4eb9c4b7d15638b66eeca">01641</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d86/interface__draw_8c.html#a468f37a013a4eb9c4b7d15638b66eeca">ui_dropshadow</a>(<a class="code" href="../../da/d10/structrctf.html">rctf</a> *rct, <span class="keywordtype">float</span> radius, <span class="keywordtype">float</span> aspect, <span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(select))
<a name="l01642"></a>01642 {
<a name="l01643"></a>01643     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l01644"></a>01644     <span class="keywordtype">float</span> rad;
<a name="l01645"></a>01645     <span class="keywordtype">float</span> a;
<a name="l01646"></a>01646     <span class="keywordtype">char</span> alpha = 2;
<a name="l01647"></a>01647     
<a name="l01648"></a>01648     glEnable(GL_BLEND);
<a name="l01649"></a>01649     
<a name="l01650"></a>01650     <span class="keywordflow">if</span> (radius &gt; (rct-&gt;<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - rct-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 10.0f) / 2.0f)
<a name="l01651"></a>01651         rad = (rct-&gt;<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - rct-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 10.0f) / 2.0f;
<a name="l01652"></a>01652     <span class="keywordflow">else</span>
<a name="l01653"></a>01653         rad = radius;
<a name="l01654"></a>01654 
<a name="l01655"></a>01655     i = 12;
<a name="l01656"></a>01656 <span class="preprocessor">#if 0</span>
<a name="l01657"></a>01657 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (select) {
<a name="l01658"></a>01658         a = i * aspect; <span class="comment">/* same as below */</span>
<a name="l01659"></a>01659     }
<a name="l01660"></a>01660     <span class="keywordflow">else</span>
<a name="l01661"></a>01661 <span class="preprocessor">#endif</span>
<a name="l01662"></a>01662 <span class="preprocessor"></span>    {
<a name="l01663"></a>01663         a = i * aspect;
<a name="l01664"></a>01664     }
<a name="l01665"></a>01665 
<a name="l01666"></a>01666     <span class="keywordflow">for</span> (; i--; a -= aspect) {
<a name="l01667"></a>01667         <span class="comment">/* alpha ranges from 2 to 20 or so */</span>
<a name="l01668"></a>01668         glColor4ub(0, 0, 0, alpha);
<a name="l01669"></a>01669         alpha += 2;
<a name="l01670"></a>01670         
<a name="l01671"></a>01671         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_POLYGON, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - a, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - a, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + a, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - 10.0f + a, rad + a);
<a name="l01672"></a>01672     }
<a name="l01673"></a>01673     
<a name="l01674"></a>01674     <span class="comment">/* outline emphasis */</span>
<a name="l01675"></a>01675     glEnable(GL_LINE_SMOOTH);
<a name="l01676"></a>01676     glColor4ub(0, 0, 0, 100);
<a name="l01677"></a>01677     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a363d654a8d24625cd68b8d30e8005609">uiDrawBox</a>(GL_LINE_LOOP, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> - 0.5f, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> - 0.5f, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> + 0.5f, rct-&gt;<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + 0.5f, radius + 0.5f);
<a name="l01678"></a>01678     glDisable(GL_LINE_SMOOTH);
<a name="l01679"></a>01679     
<a name="l01680"></a>01680     glDisable(GL_BLEND);
<a name="l01681"></a>01681 }
<a name="l01682"></a>01682 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:25 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
