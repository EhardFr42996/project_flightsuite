<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: md5.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">md5.c</div>  </div>
</div>
<div class="contents">
<a href="../../d7/d6c/md5_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00005"></a>00005 <span class="comment">/* md5.c - Functions to compute MD5 message digest of files or memory blocks</span>
<a name="l00006"></a>00006 <span class="comment">   according to the definition of MD5 in RFC 1321 from April 1992.</span>
<a name="l00007"></a>00007 <span class="comment">   Copyright (C) 1995 Software Foundation, Inc.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">   This program is free software; you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment">   it under the terms of the GNU General Public License as published by</span>
<a name="l00011"></a>00011 <span class="comment">   the Free Software Foundation; either version 2, or (at your option)</span>
<a name="l00012"></a>00012 <span class="comment">   any later version.</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
<a name="l00015"></a>00015 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00017"></a>00017 <span class="comment">   GNU General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">   You should have received a copy of the GNU General Public License</span>
<a name="l00020"></a>00020 <span class="comment">   along with this program; if not, write to the Free Software</span>
<a name="l00021"></a>00021 <span class="comment">   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="comment">/* Written by Ulrich Drepper &lt;drepper@gnu.ai.mit.edu&gt;.  */</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#if defined HAVE_LIMITS_H || defined _LIBC</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor"># include &lt;limits.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="comment">/* The following contortions are an attempt to use the C preprocessor</span>
<a name="l00035"></a>00035 <span class="comment">   to determine an unsigned integral type that is 32 bits wide.  An</span>
<a name="l00036"></a>00036 <span class="comment">   alternative approach is to use autoconf&#39;s AC_CHECK_SIZEOF macro, but</span>
<a name="l00037"></a>00037 <span class="comment">   doing that would require that the configure script compile and *run*</span>
<a name="l00038"></a>00038 <span class="comment">   the resulting executable.  Locally running cross-compiled executables</span>
<a name="l00039"></a>00039 <span class="comment">   is usually not possible.  */</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#if defined __STDC__ &amp;&amp; __STDC__</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor"># define UINT_MAX_32_BITS 4294967295U</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00044"></a><a class="code" href="../../d7/d6c/md5_8c.html#ab108c64f1909e7e25fe8f8d85acbe7d2">00044</a> <span class="preprocessor"></span><span class="preprocessor"># define UINT_MAX_32_BITS 0xFFFFFFFF</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="comment">/* If UINT_MAX isn&#39;t defined, assume it&#39;s a 32-bit type.</span>
<a name="l00048"></a>00048 <span class="comment">   This should be valid for all systems GNU cares about because</span>
<a name="l00049"></a>00049 <span class="comment">   that doesn&#39;t include 16-bit systems, and only modern systems</span>
<a name="l00050"></a>00050 <span class="comment">   (that certainly have &lt;limits.h&gt;) have 64+-bit integral types.  */</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#ifndef UINT_MAX</span>
<a name="l00053"></a><a class="code" href="../../d7/d6c/md5_8c.html#ac998ea02fbd821fc123d60445ce76f38">00053</a> <span class="preprocessor"></span><span class="preprocessor"># define UINT_MAX UINT_MAX_32_BITS</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a>00056 <span class="preprocessor">#if UINT_MAX == UINT_MAX_32_BITS</span>
<a name="l00057"></a><a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">00057</a> <span class="preprocessor"></span>  <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a>;
<a name="l00058"></a>00058 <span class="preprocessor">#else</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="preprocessor"># if USHRT_MAX == UINT_MAX_32_BITS</span>
<a name="l00060"></a>00060 <span class="preprocessor"></span>   <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a>;
<a name="l00061"></a>00061 <span class="preprocessor"># else</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span><span class="preprocessor">#  if ULONG_MAX == UINT_MAX_32_BITS</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>    <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a>;
<a name="l00064"></a>00064 <span class="preprocessor">#  else</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>    <span class="comment">/* The following line is intended to evoke an error.</span>
<a name="l00066"></a>00066 <span class="comment">       Using #error is not portable enough.  */</span>
<a name="l00067"></a>00067     <span class="stringliteral">&quot;Cannot determine unsigned 32-bit data type.&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#  endif</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00072"></a>00072 <span class="comment">/* Structure to save state of computation between the single steps.  */</span>
<a name="l00073"></a><a class="code" href="../../d0/d9a/structmd5__ctx.html">00073</a> <span class="keyword">struct </span><a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a>
<a name="l00074"></a>00074 {
<a name="l00075"></a><a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">00075</a>   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a>;
<a name="l00076"></a><a class="code" href="../../d0/d9a/structmd5__ctx.html#a0de0dd443b08898dcb19bdd20fd8e833">00076</a>   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d0/d9a/structmd5__ctx.html#a0de0dd443b08898dcb19bdd20fd8e833">B</a>;
<a name="l00077"></a><a class="code" href="../../d0/d9a/structmd5__ctx.html#a6ee98f3e18acd7f675ea33e23eb1554f">00077</a>   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d0/d9a/structmd5__ctx.html#a6ee98f3e18acd7f675ea33e23eb1554f">C</a>;
<a name="l00078"></a><a class="code" href="../../d0/d9a/structmd5__ctx.html#ae082f2d10560f0d0280c4e99d8a9d16e">00078</a>   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d0/d9a/structmd5__ctx.html#ae082f2d10560f0d0280c4e99d8a9d16e">D</a>;
<a name="l00079"></a>00079 };
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/*</span>
<a name="l00082"></a>00082 <span class="comment"> * The following three functions are build up the low level used in</span>
<a name="l00083"></a>00083 <span class="comment"> * the functions `md5_stream&#39; and `md5_buffer&#39;.</span>
<a name="l00084"></a>00084 <span class="comment"> */</span>
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="comment">/* Initialize structure containing state of computation.</span>
<a name="l00087"></a>00087 <span class="comment">   (RFC 1321, 3.3: Step 3)  */</span>
<a name="l00088"></a>00088 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d6c/md5_8c.html#a022131fa05466c80d5e251429692c8ff">md5_init_ctx</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> *ctx);
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">/* Starting with the result of former calls of this function (or the</span>
<a name="l00091"></a>00091 <span class="comment">   initialzation function update the context for the next LEN bytes</span>
<a name="l00092"></a>00092 <span class="comment">   starting at BUFFER.</span>
<a name="l00093"></a>00093 <span class="comment">   It is necessary that LEN is a multiple of 64!!! */</span>
<a name="l00094"></a>00094 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d6c/md5_8c.html#a78c2ce6f92cc655c1e00dcb1d42d2073">md5_process_block</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *buffer, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> *ctx);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">/* Put result from CTX in first 16 bytes following RESBUF.  The result is</span>
<a name="l00097"></a>00097 <span class="comment">   always in little endian byte order, so that a byte-wise output yields</span>
<a name="l00098"></a>00098 <span class="comment">   to the wanted ASCII representation of the message digest.  */</span>
<a name="l00099"></a>00099 <span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d6c/md5_8c.html#ac6d359cf02b29d20f2fb90fe629bcbdd">md5_read_ctx</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> *ctx, <span class="keywordtype">void</span> *resbuf);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="preprocessor">#ifdef __BIG_ENDIAN__</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span><span class="preprocessor">#  define SWAP(n)                           \</span>
<a name="l00104"></a>00104 <span class="preprocessor">    (((n) &lt;&lt; 24) | (((n) &amp; 0xff00) &lt;&lt; 8) | (((n) &gt;&gt; 8) &amp; 0xff00) | ((n) &gt;&gt; 24))</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00106"></a><a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">00106</a> <span class="preprocessor"></span><span class="preprocessor">#  define SWAP(n) (n)</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">/* This array contains the bytes used to pad the buffer to the next</span>
<a name="l00111"></a>00111 <span class="comment">   64-byte boundary.  (RFC 1321, 3.1: Step 1)  */</span>
<a name="l00112"></a><a class="code" href="../../d7/d6c/md5_8c.html#ae52952d1a1d91dcbd825d5f9cb980618">00112</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/d6c/md5_8c.html#ae52952d1a1d91dcbd825d5f9cb980618">fillbuf</a>[64] = { 0x80, 0 <span class="comment">/* , 0, 0, ...  */</span> };
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="comment">/* Initialize structure containing state of computation.</span>
<a name="l00116"></a>00116 <span class="comment">   (RFC 1321, 3.3: Step 3)  */</span>
<a name="l00117"></a><a class="code" href="../../d7/d6c/md5_8c.html#a022131fa05466c80d5e251429692c8ff">00117</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d6c/md5_8c.html#a022131fa05466c80d5e251429692c8ff">md5_init_ctx</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> *ctx)
<a name="l00118"></a>00118 {
<a name="l00119"></a>00119   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a> = 0x67452301;
<a name="l00120"></a>00120   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a0de0dd443b08898dcb19bdd20fd8e833">B</a> = 0xefcdab89;
<a name="l00121"></a>00121   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a6ee98f3e18acd7f675ea33e23eb1554f">C</a> = 0x98badcfe;
<a name="l00122"></a>00122   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ae082f2d10560f0d0280c4e99d8a9d16e">D</a> = 0x10325476;
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="comment">/* Put result from CTX in first 16 bytes following RESBUF.  The result must</span>
<a name="l00126"></a>00126 <span class="comment">   be in little endian byte order.  */</span>
<a name="l00127"></a><a class="code" href="../../d7/d6c/md5_8c.html#ac6d359cf02b29d20f2fb90fe629bcbdd">00127</a> <span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d6c/md5_8c.html#ac6d359cf02b29d20f2fb90fe629bcbdd">md5_read_ctx</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> *ctx, <span class="keywordtype">void</span> *resbuf)
<a name="l00128"></a>00128 {
<a name="l00129"></a>00129   ((<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) resbuf)[0] = <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> (ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a>);
<a name="l00130"></a>00130   ((<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) resbuf)[1] = <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> (ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a0de0dd443b08898dcb19bdd20fd8e833">B</a>);
<a name="l00131"></a>00131   ((<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) resbuf)[2] = <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> (ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a6ee98f3e18acd7f675ea33e23eb1554f">C</a>);
<a name="l00132"></a>00132   ((<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) resbuf)[3] = <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> (ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ae082f2d10560f0d0280c4e99d8a9d16e">D</a>);
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="keywordflow">return</span> resbuf;
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="comment">/* Compute MD5 message digest for bytes read from STREAM.  The</span>
<a name="l00138"></a>00138 <span class="comment">   resulting message digest number will be written into the 16 bytes</span>
<a name="l00139"></a>00139 <span class="comment">   beginning at RESBLOCK.  */</span>
<a name="l00140"></a><a class="code" href="../../d7/d6c/md5_8c.html#a59105467b3fc9dc939e92f16836341b4">00140</a> <span class="keywordtype">int</span> <a class="code" href="../../df/d15/BLI__md5_8h.html#a59105467b3fc9dc939e92f16836341b4">md5_stream</a>(FILE *stream, <span class="keywordtype">void</span> *resblock)
<a name="l00141"></a>00141 {
<a name="l00142"></a>00142   <span class="comment">/* Important: BLOCKSIZE must be a multiple of 64.  */</span>
<a name="l00143"></a>00143 <span class="preprocessor">#define BLOCKSIZE 4096</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span>  <span class="keyword">struct </span><a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> ctx;
<a name="l00145"></a>00145   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>[2];
<a name="l00146"></a>00146   <span class="keywordtype">char</span> buffer[<a class="code" href="../../d7/d6c/md5_8c.html#afcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> + 72];
<a name="l00147"></a>00147   <span class="keywordtype">size_t</span> pad, <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a746bfa686f2dce5b1cff46bba26ac803">sum</a>;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149   <span class="comment">/* Initialize the computation context.  */</span>
<a name="l00150"></a>00150   <a class="code" href="../../d7/d6c/md5_8c.html#a022131fa05466c80d5e251429692c8ff">md5_init_ctx</a> (&amp;ctx);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   len[0] = 0;
<a name="l00153"></a>00153   len[1] = 0;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155   <span class="comment">/* Iterate over full file contents.  */</span>
<a name="l00156"></a>00156   <span class="keywordflow">while</span> (1)
<a name="l00157"></a>00157     {
<a name="l00158"></a>00158       <span class="comment">/* We read the file in blocks of BLOCKSIZE bytes.  One call of the</span>
<a name="l00159"></a>00159 <span class="comment">     computation function processes the whole buffer so that with the</span>
<a name="l00160"></a>00160 <span class="comment">     next round of the loop another block can be read.  */</span>
<a name="l00161"></a>00161       <span class="keywordtype">size_t</span> n;
<a name="l00162"></a>00162       sum = 0;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164       <span class="comment">/* Read block.  Take care for partial reads.  */</span>
<a name="l00165"></a>00165       <span class="keywordflow">do</span>
<a name="l00166"></a>00166     {
<a name="l00167"></a>00167       n = fread (buffer, 1, <a class="code" href="../../d7/d6c/md5_8c.html#afcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> - sum, stream);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169       sum += n;
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171       <span class="keywordflow">while</span> (sum &lt; <a class="code" href="../../d7/d6c/md5_8c.html#afcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> &amp;&amp; n != 0);
<a name="l00172"></a>00172       <span class="keywordflow">if</span> (n == 0 &amp;&amp; ferror (stream))
<a name="l00173"></a>00173         <span class="keywordflow">return</span> 1;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175       <span class="comment">/* RFC 1321 specifies the possible length of the file up to 2^64 bits.</span>
<a name="l00176"></a>00176 <span class="comment">     Here we only compute the number of bytes.  Do a double word</span>
<a name="l00177"></a>00177 <span class="comment">         increment.  */</span>
<a name="l00178"></a>00178       len[0] += <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a746bfa686f2dce5b1cff46bba26ac803">sum</a>;
<a name="l00179"></a>00179       <span class="keywordflow">if</span> (len[0] &lt; sum)
<a name="l00180"></a>00180     ++len[1];
<a name="l00181"></a>00181 
<a name="l00182"></a>00182       <span class="comment">/* If end of file is reached, end the loop.  */</span>
<a name="l00183"></a>00183       <span class="keywordflow">if</span> (n == 0)
<a name="l00184"></a>00184     <span class="keywordflow">break</span>;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186       <span class="comment">/* Process buffer with BLOCKSIZE bytes.  Note that</span>
<a name="l00187"></a>00187 <span class="comment">            BLOCKSIZE % 64 == 0</span>
<a name="l00188"></a>00188 <span class="comment">       */</span>
<a name="l00189"></a>00189       <a class="code" href="../../d7/d6c/md5_8c.html#a78c2ce6f92cc655c1e00dcb1d42d2073">md5_process_block</a> (buffer, <a class="code" href="../../d7/d6c/md5_8c.html#afcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a>, &amp;ctx);
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   <span class="comment">/* We can copy 64 byte because the buffer is always big enough.  FILLBUF</span>
<a name="l00193"></a>00193 <span class="comment">     contains the needed bits.  */</span>
<a name="l00194"></a>00194   memcpy (&amp;buffer[sum], <a class="code" href="../../d7/d6c/md5_8c.html#ae52952d1a1d91dcbd825d5f9cb980618">fillbuf</a>, 64);
<a name="l00195"></a>00195 
<a name="l00196"></a>00196   <span class="comment">/* Compute amount of padding bytes needed.  Alignment is done to</span>
<a name="l00197"></a>00197 <span class="comment">        (N + PAD) % 64 == 56</span>
<a name="l00198"></a>00198 <span class="comment">     There is always at least one byte padded.  I.e. even the alignment</span>
<a name="l00199"></a>00199 <span class="comment">     is correctly aligned 64 padding bytes are added.  */</span>
<a name="l00200"></a>00200   pad = sum &amp; 63;
<a name="l00201"></a>00201   pad = pad &gt;= 56 ? 64 + 56 - pad : 56 - pad;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <span class="comment">/* Put the 64-bit file length in *bits* at the end of the buffer.  */</span>
<a name="l00204"></a>00204   *(<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) &amp;buffer[sum + pad] = <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> (len[0] &lt;&lt; 3);
<a name="l00205"></a>00205   *(<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) &amp;buffer[sum + pad + 4] = <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> ((len[1] &lt;&lt; 3)
<a name="l00206"></a>00206                          | (len[0] &gt;&gt; 29));
<a name="l00207"></a>00207 
<a name="l00208"></a>00208   <span class="comment">/* Process last bytes.  */</span>
<a name="l00209"></a>00209   <a class="code" href="../../d7/d6c/md5_8c.html#a78c2ce6f92cc655c1e00dcb1d42d2073">md5_process_block</a> (buffer, sum + pad + 8, &amp;ctx);
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   <span class="comment">/* Construct result in desired memory.  */</span>
<a name="l00212"></a>00212   <a class="code" href="../../d7/d6c/md5_8c.html#ac6d359cf02b29d20f2fb90fe629bcbdd">md5_read_ctx</a> (&amp;ctx, resblock);
<a name="l00213"></a>00213   <span class="keywordflow">return</span> 0;
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="comment">/* Compute MD5 message digest for LEN bytes beginning at BUFFER.  The</span>
<a name="l00217"></a>00217 <span class="comment">   result is always in little endian byte order, so that a byte-wise</span>
<a name="l00218"></a>00218 <span class="comment">   output yields to the wanted ASCII representation of the message</span>
<a name="l00219"></a>00219 <span class="comment">   digest.  */</span>
<a name="l00220"></a><a class="code" href="../../d7/d6c/md5_8c.html#a62c2b951082f4e72c1e09732dd087c86">00220</a> <span class="keywordtype">void</span> *<a class="code" href="../../df/d15/BLI__md5_8h.html#a62c2b951082f4e72c1e09732dd087c86">md5_buffer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buffer, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>, <span class="keywordtype">void</span> *resblock)
<a name="l00221"></a>00221 {
<a name="l00222"></a>00222   <span class="keyword">struct </span><a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> ctx;
<a name="l00223"></a>00223   <span class="keywordtype">char</span> restbuf[64 + 72];
<a name="l00224"></a>00224   <span class="keywordtype">size_t</span> blocks = len &amp; ~63;
<a name="l00225"></a>00225   <span class="keywordtype">size_t</span> pad, rest;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="comment">/* Initialize the computation context.  */</span>
<a name="l00228"></a>00228   <a class="code" href="../../d7/d6c/md5_8c.html#a022131fa05466c80d5e251429692c8ff">md5_init_ctx</a> (&amp;ctx);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="comment">/* Process whole buffer but last len % 64 bytes.  */</span>
<a name="l00231"></a>00231   <a class="code" href="../../d7/d6c/md5_8c.html#a78c2ce6f92cc655c1e00dcb1d42d2073">md5_process_block</a> (buffer, blocks, &amp;ctx);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233   <span class="comment">/* REST bytes are not processed yet.  */</span>
<a name="l00234"></a>00234   rest = len - blocks;
<a name="l00235"></a>00235   <span class="comment">/* Copy to own buffer.  */</span>
<a name="l00236"></a>00236   memcpy (restbuf, &amp;buffer[blocks], rest);
<a name="l00237"></a>00237   <span class="comment">/* Append needed fill bytes at end of buffer.  We can copy 64 byte</span>
<a name="l00238"></a>00238 <span class="comment">     because the buffer is always big enough.  */</span>
<a name="l00239"></a>00239   memcpy (&amp;restbuf[rest], <a class="code" href="../../d7/d6c/md5_8c.html#ae52952d1a1d91dcbd825d5f9cb980618">fillbuf</a>, 64);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   <span class="comment">/* PAD bytes are used for padding to correct alignment.  Note that</span>
<a name="l00242"></a>00242 <span class="comment">     always at least one byte is padded.  */</span>
<a name="l00243"></a>00243   pad = rest &gt;= 56 ? 64 + 56 - rest : 56 - rest;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245   <span class="comment">/* Put length of buffer in *bits* in last eight bytes.  */</span>
<a name="l00246"></a>00246   *(<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) &amp;restbuf[rest + pad] = (<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a>) <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> (len &lt;&lt; 3);
<a name="l00247"></a>00247   *(<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *) &amp;restbuf[rest + pad + 4] = (<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a>) <a class="code" href="../../d7/d6c/md5_8c.html#acb6d65a652365e0cba0cde50854acc08">SWAP</a> (len &gt;&gt; 29);
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   <span class="comment">/* Process last bytes.  */</span>
<a name="l00250"></a>00250   <a class="code" href="../../d7/d6c/md5_8c.html#a78c2ce6f92cc655c1e00dcb1d42d2073">md5_process_block</a> (restbuf, rest + pad + 8, &amp;ctx);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252   <span class="comment">/* Put result in desired memory area.  */</span>
<a name="l00253"></a>00253   <span class="keywordflow">return</span> <a class="code" href="../../d7/d6c/md5_8c.html#ac6d359cf02b29d20f2fb90fe629bcbdd">md5_read_ctx</a> (&amp;ctx, resblock);
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="comment">/* These are the four functions used in the four steps of the MD5 algorithm</span>
<a name="l00258"></a>00258 <span class="comment">   and defined in the RFC 1321.  The first function is a little bit optimized</span>
<a name="l00259"></a>00259 <span class="comment">   (as found in Colin Plumbs public domain implementation).  */</span>
<a name="l00260"></a>00260 <span class="comment">/* #define FF(b, c, d) ((b &amp; c) | (~b &amp; d)) */</span>
<a name="l00261"></a><a class="code" href="../../d7/d6c/md5_8c.html#abc379298e18c4c5a44fbb37e0f5a36fa">00261</a> <span class="preprocessor">#define FF(b, c, d) (d ^ (b &amp; (c ^ d)))</span>
<a name="l00262"></a><a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">00262</a> <span class="preprocessor"></span><span class="preprocessor">#define FG(b, c, d) FF (d, b, c)</span>
<a name="l00263"></a><a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">00263</a> <span class="preprocessor"></span><span class="preprocessor">#define FH(b, c, d) (b ^ c ^ d)</span>
<a name="l00264"></a><a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">00264</a> <span class="preprocessor"></span><span class="preprocessor">#define FI(b, c, d) (c ^ (b | ~d))</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span>
<a name="l00266"></a>00266 <span class="comment">/* Process LEN bytes of BUFFER, accumulating context into CTX.</span>
<a name="l00267"></a>00267 <span class="comment">   It is assumed that LEN % 64 == 0.  */</span>
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="../../d7/d6c/md5_8c.html#a78c2ce6f92cc655c1e00dcb1d42d2073">00269</a> <span class="keywordtype">void</span> <a class="code" href="../../d7/d6c/md5_8c.html#a78c2ce6f92cc655c1e00dcb1d42d2073">md5_process_block</a> (<span class="keyword">const</span> <span class="keywordtype">void</span> *buffer, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d9a/structmd5__ctx.html">md5_ctx</a> *ctx)
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> correct_words[16];
<a name="l00272"></a>00272   <span class="keyword">const</span> <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *words = buffer;
<a name="l00273"></a>00273   <span class="keywordtype">size_t</span> nwords = len / <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00274"></a>00274   <span class="keyword">const</span> <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *endp = words + nwords;
<a name="l00275"></a>00275   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a> = ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a>;
<a name="l00276"></a>00276   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a> = ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a0de0dd443b08898dcb19bdd20fd8e833">B</a>;
<a name="l00277"></a>00277   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> = ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a6ee98f3e18acd7f675ea33e23eb1554f">C</a>;
<a name="l00278"></a>00278   <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> <a class="code" href="../../da/d6c/voxel_8c.html#acd4207c685797d5be90a34456ff9d2e7">D</a> = ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ae082f2d10560f0d0280c4e99d8a9d16e">D</a>;
<a name="l00279"></a>00279 
<a name="l00280"></a>00280   <span class="comment">/* Process all bytes in the buffer with 64 bytes in each round of</span>
<a name="l00281"></a>00281 <span class="comment">     the loop.  */</span>
<a name="l00282"></a>00282   <span class="keywordflow">while</span> (words &lt; endp)
<a name="l00283"></a>00283     {
<a name="l00284"></a>00284       <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> *cwp = correct_words;
<a name="l00285"></a>00285       <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> A_save = <a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a>;
<a name="l00286"></a>00286       <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> B_save = <a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a>;
<a name="l00287"></a>00287       <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> C_save = <a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>;
<a name="l00288"></a>00288       <a class="code" href="../../d7/d6c/md5_8c.html#aa5370400843756f0b77b782bdeef2564">md5_uint32</a> D_save = <a class="code" href="../../da/d6c/voxel_8c.html#acd4207c685797d5be90a34456ff9d2e7">D</a>;
<a name="l00289"></a>00289 
<a name="l00290"></a>00290       <span class="comment">/* First round: using the given function, the context and a constant</span>
<a name="l00291"></a>00291 <span class="comment">     the next context is computed.  Because the algorithms processing</span>
<a name="l00292"></a>00292 <span class="comment">     unit is a 32-bit word and it is determined to work on words in</span>
<a name="l00293"></a>00293 <span class="comment">     little endian byte order we perhaps have to change the byte order</span>
<a name="l00294"></a>00294 <span class="comment">     before the computation.  To reduce the work for the next steps</span>
<a name="l00295"></a>00295 <span class="comment">     we store the swapped words in the array CORRECT_WORDS.  */</span>
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="preprocessor">#define OP(a, b, c, d, s, T)                        \</span>
<a name="l00298"></a>00298 <span class="preprocessor">      do                                \</span>
<a name="l00299"></a>00299 <span class="preprocessor">        {                               \</span>
<a name="l00300"></a>00300 <span class="preprocessor">      a += FF (b, c, d) + (*cwp++ = SWAP (*words)) + T;     \</span>
<a name="l00301"></a>00301 <span class="preprocessor">      ++words;                          \</span>
<a name="l00302"></a>00302 <span class="preprocessor">      CYCLIC (a, s);                        \</span>
<a name="l00303"></a>00303 <span class="preprocessor">      a += b;                           \</span>
<a name="l00304"></a>00304 <span class="preprocessor">        }                               \</span>
<a name="l00305"></a>00305 <span class="preprocessor">      while (0)</span>
<a name="l00306"></a>00306 <span class="preprocessor"></span>
<a name="l00307"></a>00307       <span class="comment">/* It is unfortunate that C does not provide an operator for</span>
<a name="l00308"></a>00308 <span class="comment">     cyclic rotation.  Hope the C compiler is smart enough.  */</span>
<a name="l00309"></a>00309 <span class="preprocessor">#define CYCLIC(w, s) (w = (w &lt;&lt; s) | (w &gt;&gt; (32 - s)))</span>
<a name="l00310"></a>00310 <span class="preprocessor"></span>
<a name="l00311"></a>00311       <span class="comment">/* Before we start, one word to the strange constants.</span>
<a name="l00312"></a>00312 <span class="comment">     They are defined in RFC 1321 as</span>
<a name="l00313"></a>00313 <span class="comment"></span>
<a name="l00314"></a>00314 <span class="comment">     T[i] = (int) (4294967296.0 * fabs (sin (i))), i=1..64</span>
<a name="l00315"></a>00315 <span class="comment">       */</span>
<a name="l00316"></a>00316 
<a name="l00317"></a>00317       <span class="comment">/* Round 1.  */</span>
<a name="l00318"></a>00318       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (A, B, C, D,  7, 0xd76aa478);
<a name="l00319"></a>00319       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (D, A, B, C, 12, 0xe8c7b756);
<a name="l00320"></a>00320       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (C, D, A, B, 17, 0x242070db);
<a name="l00321"></a>00321       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (B, C, D, A, 22, 0xc1bdceee);
<a name="l00322"></a>00322       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (A, B, C, D,  7, 0xf57c0faf);
<a name="l00323"></a>00323       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (D, A, B, C, 12, 0x4787c62a);
<a name="l00324"></a>00324       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (C, D, A, B, 17, 0xa8304613);
<a name="l00325"></a>00325       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (B, C, D, A, 22, 0xfd469501);
<a name="l00326"></a>00326       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (A, B, C, D,  7, 0x698098d8);
<a name="l00327"></a>00327       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (D, A, B, C, 12, 0x8b44f7af);
<a name="l00328"></a>00328       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (C, D, A, B, 17, 0xffff5bb1);
<a name="l00329"></a>00329       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (B, C, D, A, 22, 0x895cd7be);
<a name="l00330"></a>00330       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (A, B, C, D,  7, 0x6b901122);
<a name="l00331"></a>00331       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (D, A, B, C, 12, 0xfd987193);
<a name="l00332"></a>00332       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (C, D, A, B, 17, 0xa679438e);
<a name="l00333"></a>00333       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (B, C, D, A, 22, 0x49b40821);
<a name="l00334"></a>00334 
<a name="l00335"></a>00335       <span class="comment">/* For the second to fourth round we have the possibly swapped words</span>
<a name="l00336"></a>00336 <span class="comment">     in CORRECT_WORDS.  Redefine the macro to take an additional first</span>
<a name="l00337"></a>00337 <span class="comment">     argument specifying the function to use.  */</span>
<a name="l00338"></a>00338 <span class="preprocessor">#undef OP</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span><span class="preprocessor">#define OP(f, a, b, c, d, k, s, T)                  \</span>
<a name="l00340"></a>00340 <span class="preprocessor">      do                                \</span>
<a name="l00341"></a>00341 <span class="preprocessor">    {                               \</span>
<a name="l00342"></a>00342 <span class="preprocessor">      a += f (b, c, d) + correct_words[k] + T;          \</span>
<a name="l00343"></a>00343 <span class="preprocessor">      CYCLIC (a, s);                        \</span>
<a name="l00344"></a>00344 <span class="preprocessor">      a += b;                           \</span>
<a name="l00345"></a>00345 <span class="preprocessor">    }                               \</span>
<a name="l00346"></a>00346 <span class="preprocessor">      while (0)</span>
<a name="l00347"></a>00347 <span class="preprocessor"></span>
<a name="l00348"></a>00348       <span class="comment">/* Round 2.  */</span>
<a name="l00349"></a>00349       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D,  1,  5, 0xf61e2562);
<a name="l00350"></a>00350       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C,  6,  9, 0xc040b340);
<a name="l00351"></a>00351       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B, 11, 14, 0x265e5a51);
<a name="l00352"></a>00352       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A,  0, 20, 0xe9b6c7aa);
<a name="l00353"></a>00353       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D,  5,  5, 0xd62f105d);
<a name="l00354"></a>00354       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C, 10,  9, 0x02441453);
<a name="l00355"></a>00355       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B, 15, 14, 0xd8a1e681);
<a name="l00356"></a>00356       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A,  4, 20, 0xe7d3fbc8);
<a name="l00357"></a>00357       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D,  9,  5, 0x21e1cde6);
<a name="l00358"></a>00358       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C, 14,  9, 0xc33707d6);
<a name="l00359"></a>00359       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B,  3, 14, 0xf4d50d87);
<a name="l00360"></a>00360       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A,  8, 20, 0x455a14ed);
<a name="l00361"></a>00361       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D, 13,  5, 0xa9e3e905);
<a name="l00362"></a>00362       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C,  2,  9, 0xfcefa3f8);
<a name="l00363"></a>00363       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B,  7, 14, 0x676f02d9);
<a name="l00364"></a>00364       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A, 12, 20, 0x8d2a4c8a);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366       <span class="comment">/* Round 3.  */</span>
<a name="l00367"></a>00367       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D,  5,  4, 0xfffa3942);
<a name="l00368"></a>00368       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C,  8, 11, 0x8771f681);
<a name="l00369"></a>00369       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B, 11, 16, 0x6d9d6122);
<a name="l00370"></a>00370       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A, 14, 23, 0xfde5380c);
<a name="l00371"></a>00371       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D,  1,  4, 0xa4beea44);
<a name="l00372"></a>00372       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C,  4, 11, 0x4bdecfa9);
<a name="l00373"></a>00373       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B,  7, 16, 0xf6bb4b60);
<a name="l00374"></a>00374       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A, 10, 23, 0xbebfbc70);
<a name="l00375"></a>00375       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D, 13,  4, 0x289b7ec6);
<a name="l00376"></a>00376       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C,  0, 11, 0xeaa127fa);
<a name="l00377"></a>00377       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B,  3, 16, 0xd4ef3085);
<a name="l00378"></a>00378       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A,  6, 23, 0x04881d05);
<a name="l00379"></a>00379       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D,  9,  4, 0xd9d4d039);
<a name="l00380"></a>00380       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C, 12, 11, 0xe6db99e5);
<a name="l00381"></a>00381       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B, 15, 16, 0x1fa27cf8);
<a name="l00382"></a>00382       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#a2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A,  2, 23, 0xc4ac5665);
<a name="l00383"></a>00383 
<a name="l00384"></a>00384       <span class="comment">/* Round 4.  */</span>
<a name="l00385"></a>00385       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D,  0,  6, 0xf4292244);
<a name="l00386"></a>00386       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C,  7, 10, 0x432aff97);
<a name="l00387"></a>00387       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B, 14, 15, 0xab9423a7);
<a name="l00388"></a>00388       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A,  5, 21, 0xfc93a039);
<a name="l00389"></a>00389       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D, 12,  6, 0x655b59c3);
<a name="l00390"></a>00390       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C,  3, 10, 0x8f0ccc92);
<a name="l00391"></a>00391       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B, 10, 15, 0xffeff47d);
<a name="l00392"></a>00392       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A,  1, 21, 0x85845dd1);
<a name="l00393"></a>00393       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D,  8,  6, 0x6fa87e4f);
<a name="l00394"></a>00394       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C, 15, 10, 0xfe2ce6e0);
<a name="l00395"></a>00395       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B,  6, 15, 0xa3014314);
<a name="l00396"></a>00396       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A, 13, 21, 0x4e0811a1);
<a name="l00397"></a>00397       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D,  4,  6, 0xf7537e82);
<a name="l00398"></a>00398       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C, 11, 10, 0xbd3af235);
<a name="l00399"></a>00399       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B,  2, 15, 0x2ad7d2bb);
<a name="l00400"></a>00400       <a class="code" href="../../d7/d6c/md5_8c.html#a6945bb408d7121af76c8886e25c90ad5">OP</a> (<a class="code" href="../../d7/d6c/md5_8c.html#ac8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A,  9, 21, 0xeb86d391);
<a name="l00401"></a>00401 
<a name="l00402"></a>00402       <span class="comment">/* Add the starting values of the context.  */</span>
<a name="l00403"></a>00403       A += A_save;
<a name="l00404"></a>00404       B += B_save;
<a name="l00405"></a>00405       C += C_save;
<a name="l00406"></a>00406       D += D_save;
<a name="l00407"></a>00407     }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409   <span class="comment">/* Put checksum in context given as argument.  */</span>
<a name="l00410"></a>00410   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a> = <a class="code" href="../../d0/d9a/structmd5__ctx.html#ad3cd1fd0daca3d38ab6e12f27cb4f858">A</a>;
<a name="l00411"></a>00411   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a0de0dd443b08898dcb19bdd20fd8e833">B</a> = <a class="code" href="../../d2/d6c/mball_8c.html#a111da81ae5883147168bbb8366377b10">B</a>;
<a name="l00412"></a>00412   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#a6ee98f3e18acd7f675ea33e23eb1554f">C</a> = <a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>;
<a name="l00413"></a>00413   ctx-&gt;<a class="code" href="../../d0/d9a/structmd5__ctx.html#ae082f2d10560f0d0280c4e99d8a9d16e">D</a> = <a class="code" href="../../da/d6c/voxel_8c.html#acd4207c685797d5be90a34456ff9d2e7">D</a>;
<a name="l00414"></a>00414 }
<a name="l00415"></a>00415 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:32 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
