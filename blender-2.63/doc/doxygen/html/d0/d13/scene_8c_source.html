<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: scene.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">scene.c</div>  </div>
</div>
<div class="contents">
<a href="../../d0/d13/scene_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2001-2002 by NaN Holding BV.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * The Original Code is: all of this file.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * Contributor(s): none yet.</span>
<a name="l00024"></a>00024 <span class="comment"> *</span>
<a name="l00025"></a>00025 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;stddef.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#ifndef WIN32 </span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#else</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span><span class="preprocessor">#include &lt;io.h&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#endif</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html">DNA_anim_types.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d75/DNA__group__types_8h.html">DNA_group_types.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d27/DNA__node__types_8h.html">DNA_node_types.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da4/DNA__screen__types_8h.html">DNA_screen_types.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html">DNA_sequence_types.h</a>&quot;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d46/BLI__callbacks_8h.html">BLI_callbacks.h</a>&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dd0/BKE__anim_8h.html">BKE_anim.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d51/BKE__animsys_8h.html">BKE_animsys.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/df5/BKE__group_8h.html">BKE_group.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d95/BKE__idprop_8h.html">BKE_idprop.h</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/db1/BKE__library_8h.html">BKE_library.h</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d91/BKE__node_8h.html">BKE_node.h</a>&quot;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dac/BKE__object_8h.html" title="General operations, lookup, etc. for blender objects.">BKE_object.h</a>&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d86/BKE__paint_8h.html">BKE_paint.h</a>&quot;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d45/BKE__pointcache_8h.html">BKE_pointcache.h</a>&quot;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d53/BKE__scene_8h.html">BKE_scene.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html">BKE_sequencer.h</a>&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d35/BKE__world_8h.html">BKE_world.h</a>&quot;</span>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/db1/BKE__sound_8h.html">BKE_sound.h</a>&quot;</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="preprocessor">#include &quot;<a class="code" href="../../db/da9/RE__engine_8h.html">RE_engine.h</a>&quot;</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">//XXX #include &quot;BIF_previewrender.h&quot;</span>
<a name="l00079"></a>00079 <span class="comment">//XXX #include &quot;BIF_editseq.h&quot;</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/time.h&gt;</span>
<a name="l00084"></a>00084 <span class="preprocessor">#endif</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a><a class="code" href="../../d0/d13/scene_8c.html#a01167b96be3545a6d6d4023b258f27b2">00086</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a5263782f4b0ea3f0c8332525c6dfe716">free_avicodecdata</a>(<a class="code" href="../../d9/d3e/structAviCodecData.html">AviCodecData</a> *acd)
<a name="l00087"></a>00087 {
<a name="l00088"></a>00088     <span class="keywordflow">if</span> (acd) {
<a name="l00089"></a>00089         <span class="keywordflow">if</span> (acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a3fc87d8115240de7e27cd05d1bb1ed8b">lpFormat</a>) {
<a name="l00090"></a>00090             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a3fc87d8115240de7e27cd05d1bb1ed8b">lpFormat</a>);
<a name="l00091"></a>00091             acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a3fc87d8115240de7e27cd05d1bb1ed8b">lpFormat</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00092"></a>00092             acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a16e6f6a51ecd4f5e395c3f7d62e731d9">cbFormat</a> = 0;
<a name="l00093"></a>00093         }
<a name="l00094"></a>00094         <span class="keywordflow">if</span> (acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a426beb8964b8a27a366c28cc56588b71">lpParms</a>) {
<a name="l00095"></a>00095             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a426beb8964b8a27a366c28cc56588b71">lpParms</a>);
<a name="l00096"></a>00096             acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a426beb8964b8a27a366c28cc56588b71">lpParms</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00097"></a>00097             acd-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#ac68dffe2fe1cbc7aec60d353429221fa">cbParms</a> = 0;
<a name="l00098"></a>00098         }
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100 }
<a name="l00101"></a>00101 
<a name="l00102"></a><a class="code" href="../../d0/d13/scene_8c.html#a65b5d881e171ae40247eff762e7b6a5f">00102</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a9762d2444af0ca85ebc5b0c8cf158c04">free_qtcodecdata</a>(<a class="code" href="../../d2/d03/structQuicktimeCodecData.html">QuicktimeCodecData</a> *qcd)
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104     <span class="keywordflow">if</span> (qcd) {
<a name="l00105"></a>00105         <span class="keywordflow">if</span> (qcd-&gt;<a class="code" href="../../d2/d03/structQuicktimeCodecData.html#aba683799ebc5231dd3da28d70a5db6e9">cdParms</a>) {
<a name="l00106"></a>00106             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(qcd-&gt;<a class="code" href="../../d2/d03/structQuicktimeCodecData.html#aba683799ebc5231dd3da28d70a5db6e9">cdParms</a>);
<a name="l00107"></a>00107             qcd-&gt;<a class="code" href="../../d2/d03/structQuicktimeCodecData.html#aba683799ebc5231dd3da28d70a5db6e9">cdParms</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00108"></a>00108             qcd-&gt;<a class="code" href="../../d2/d03/structQuicktimeCodecData.html#a283c4b4ff9df6799848cb4fbf7cf0d70">cdSize</a> = 0;
<a name="l00109"></a>00109         }
<a name="l00110"></a>00110     }
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="../../d0/d13/scene_8c.html#aefb0a3d132912f0dc4c31a7fd2a27e43">00113</a> <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#af6fbc79d98fd75a7920e6794840ce32f">copy_scene</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <span class="keywordtype">int</span> type)
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scen;
<a name="l00116"></a>00116     <a class="code" href="../../d0/d65/structToolSettings.html">ToolSettings</a> *ts;
<a name="l00117"></a>00117     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base, *obase;
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <span class="keywordflow">if</span> (type == <a class="code" href="../../d8/d53/BKE__scene_8h.html#a2cfcb4fed1ae82822294c92a020c1482">SCE_COPY_EMPTY</a>) {
<a name="l00120"></a>00120         <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> lb;
<a name="l00121"></a>00121         scen= <a class="code" href="../../d8/d53/BKE__scene_8h.html#a69a66e7b13f7dc7041a82436563ee915">add_scene</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l00122"></a>00122         
<a name="l00123"></a>00123         lb= scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>;
<a name="l00124"></a>00124         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>;
<a name="l00125"></a>00125         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>= lb;
<a name="l00126"></a>00126         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#abe370ff027b47b00fb8a81620639eff4">unit</a>= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#abe370ff027b47b00fb8a81620639eff4">unit</a>;
<a name="l00127"></a>00127         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>;
<a name="l00128"></a>00128         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>;
<a name="l00129"></a>00129         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#af91931f1ea3f417f2d9ffba420e7290c">audio</a>= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af91931f1ea3f417f2d9ffba420e7290c">audio</a>;
<a name="l00130"></a>00130 
<a name="l00131"></a>00131         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>);
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133     <span class="keywordflow">else</span> {
<a name="l00134"></a>00134         scen= <a class="code" href="../../d8/db1/BKE__library_8h.html#a0c0c1987364874c73cda326eace31efd">copy_libblock</a>(&amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>);
<a name="l00135"></a>00135         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#abc6ab715e5696ec3bb40014fc55182c6">BLI_duplicatelist</a>(&amp;(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>), &amp;(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>));
<a name="l00136"></a>00136         
<a name="l00137"></a>00137         <a class="code" href="../../d8/db1/BKE__library_8h.html#a92829358dcd356f9821dc56666b3f6cf">clear_id_newpoins</a>();
<a name="l00138"></a>00138         
<a name="l00139"></a>00139         <a class="code" href="../../d8/db1/BKE__library_8h.html#a967d1ceef29b2612ef6e03194c512ad6">id_us_plus</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aefac18ed3d1ded63b012f79a3ca8ddb2">world</a>);
<a name="l00140"></a>00140         <a class="code" href="../../d8/db1/BKE__library_8h.html#a967d1ceef29b2612ef6e03194c512ad6">id_us_plus</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scen-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>);
<a name="l00141"></a>00141         <a class="code" href="../../d8/db1/BKE__library_8h.html#a967d1ceef29b2612ef6e03194c512ad6">id_us_plus</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6be618f1264d81c98fec00b879000a3a">dome</a>.<a class="code" href="../../d3/d9d/structGameDome.html#a66ee375e57bb5216b7317965976aaadf">warptext</a>);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00144"></a>00144         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa36a32a59b8c372076d113a5b532f6e4">theDag</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00145"></a>00145         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a1aa1978dba5dab99d35b6ba89e88b5bb">obedit</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00146"></a>00146         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#ab88f4efbfce140ab3cefe9eb89476282">stats</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00147"></a>00147         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a63fc7eaaf0da3042f687458e69d45de1">fps_info</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#abc6ab715e5696ec3bb40014fc55182c6">BLI_duplicatelist</a>(&amp;(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#ad75df026c409d765b297e18f988b9d93">markers</a>), &amp;(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#ad75df026c409d765b297e18f988b9d93">markers</a>));
<a name="l00150"></a>00150         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#abc6ab715e5696ec3bb40014fc55182c6">BLI_duplicatelist</a>(&amp;(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aea22a1b7c82a34733d85376ea882893d">transform_spaces</a>), &amp;(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aea22a1b7c82a34733d85376ea882893d">transform_spaces</a>));
<a name="l00151"></a>00151         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#abc6ab715e5696ec3bb40014fc55182c6">BLI_duplicatelist</a>(&amp;(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>), &amp;(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>));
<a name="l00152"></a>00152         <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a24bdd12dba28cc0fb1d6f568671640e6">BKE_keyingsets_copy</a>(&amp;(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a61668a1aa7d493a6c770b8cd7a9c9e4e">keyingsets</a>), &amp;(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a61668a1aa7d493a6c770b8cd7a9c9e4e">keyingsets</a>));
<a name="l00153"></a>00153 
<a name="l00154"></a>00154         <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>) {
<a name="l00155"></a>00155             scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>= <a class="code" href="../../d4/d91/BKE__node_8h.html#a42a2adacc98ae098c53b06a35258af8e">ntreeCopyTree</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>); <span class="comment">/* copies actions */</span>
<a name="l00156"></a>00156             <a class="code" href="../../d4/d91/BKE__node_8h.html#a8c9edc14a2b0f8f88573fe7250d05eb8">ntreeSwitchID</a>(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>, &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, &amp;scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>);
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         obase= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00160"></a>00160         base= scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00161"></a>00161         <span class="keywordflow">while</span> (base) {
<a name="l00162"></a>00162             <a class="code" href="../../d8/db1/BKE__library_8h.html#a967d1ceef29b2612ef6e03194c512ad6">id_us_plus</a>(&amp;base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>);
<a name="l00163"></a>00163             <span class="keywordflow">if</span> (obase==sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>) scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>= base;
<a name="l00164"></a>00164     
<a name="l00165"></a>00165             obase= obase-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l00166"></a>00166             base= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l00167"></a>00167         }
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     <span class="comment">/* tool settings */</span>
<a name="l00171"></a>00171     scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>= <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>);
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     ts= scen-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>;
<a name="l00174"></a>00174     <span class="keywordflow">if</span> (ts) {
<a name="l00175"></a>00175         <span class="keywordflow">if</span> (ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>) {
<a name="l00176"></a>00176             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>= <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>);
<a name="l00177"></a>00177             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#ae497340e5c727ad02e7fe31dc13dc5bd">paintcursor</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00178"></a>00178             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a2d4ad031ecb5a46c0e9622939f4c31d5">vpaint_prev</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00179"></a>00179             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a9bdd2f3cd5e7f50745693c0155492456">wpaint_prev</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00180"></a>00180             <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad963242aed7e4ff8b11e7573bacde05a">copy_paint</a>(&amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a91639c084be23729115954704b03c518">paint</a>, &amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a71507c50ae356599dfb4bafef460474c">vpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a91639c084be23729115954704b03c518">paint</a>);
<a name="l00181"></a>00181         }
<a name="l00182"></a>00182         <span class="keywordflow">if</span> (ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>) {
<a name="l00183"></a>00183             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>= <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>);
<a name="l00184"></a>00184             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#ae497340e5c727ad02e7fe31dc13dc5bd">paintcursor</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00185"></a>00185             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a2d4ad031ecb5a46c0e9622939f4c31d5">vpaint_prev</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00186"></a>00186             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a9bdd2f3cd5e7f50745693c0155492456">wpaint_prev</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00187"></a>00187             <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad963242aed7e4ff8b11e7573bacde05a">copy_paint</a>(&amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a91639c084be23729115954704b03c518">paint</a>, &amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#affa3e524b9068ff98a5f00bb56d8b4e2">wpaint</a>-&gt;<a class="code" href="../../de/d1e/structVPaint.html#a91639c084be23729115954704b03c518">paint</a>);
<a name="l00188"></a>00188         }
<a name="l00189"></a>00189         <span class="keywordflow">if</span> (ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a3d7b2bfc12195d43d8dac148e95d0281">sculpt</a>) {
<a name="l00190"></a>00190             ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a3d7b2bfc12195d43d8dac148e95d0281">sculpt</a>= <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a3d7b2bfc12195d43d8dac148e95d0281">sculpt</a>);
<a name="l00191"></a>00191             <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad963242aed7e4ff8b11e7573bacde05a">copy_paint</a>(&amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a3d7b2bfc12195d43d8dac148e95d0281">sculpt</a>-&gt;<a class="code" href="../../d2/df6/structSculpt.html#a266f9f0d61a292f88102781150d7acc5">paint</a>, &amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a3d7b2bfc12195d43d8dac148e95d0281">sculpt</a>-&gt;<a class="code" href="../../d2/df6/structSculpt.html#a266f9f0d61a292f88102781150d7acc5">paint</a>);
<a name="l00192"></a>00192         }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194         <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad963242aed7e4ff8b11e7573bacde05a">copy_paint</a>(&amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a1a36b13607238910a064c1b9b61430e5">imapaint</a>.<a class="code" href="../../d1/d54/structImagePaintSettings.html#a2ef68c48836293b4bdbddd0dcedf958b">paint</a>, &amp;ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a1a36b13607238910a064c1b9b61430e5">imapaint</a>.<a class="code" href="../../d1/d54/structImagePaintSettings.html#a2ef68c48836293b4bdbddd0dcedf958b">paint</a>);
<a name="l00195"></a>00195         ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a1a36b13607238910a064c1b9b61430e5">imapaint</a>.<a class="code" href="../../d1/d54/structImagePaintSettings.html#a0f84f3e7f50bd1a30c7cf36e52e3817a">paintcursor</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00196"></a>00196         ts-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a931875e2d55fef9de65c777431a94f31">particle</a>.<a class="code" href="../../df/db7/structParticleEditSettings.html#af0b040219b3bb5229e1f730011030fd9">paintcursor</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198     
<a name="l00199"></a>00199     <span class="comment">/* make a private copy of the avicodecdata */</span>
<a name="l00200"></a>00200     <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5bde997eb354cd32f806a2cfc82f3ac2">avicodecdata</a>) {
<a name="l00201"></a>00201         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5bde997eb354cd32f806a2cfc82f3ac2">avicodecdata</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5bde997eb354cd32f806a2cfc82f3ac2">avicodecdata</a>);
<a name="l00202"></a>00202         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5bde997eb354cd32f806a2cfc82f3ac2">avicodecdata</a>-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a3fc87d8115240de7e27cd05d1bb1ed8b">lpFormat</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5bde997eb354cd32f806a2cfc82f3ac2">avicodecdata</a>-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a3fc87d8115240de7e27cd05d1bb1ed8b">lpFormat</a>);
<a name="l00203"></a>00203         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5bde997eb354cd32f806a2cfc82f3ac2">avicodecdata</a>-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a426beb8964b8a27a366c28cc56588b71">lpParms</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5bde997eb354cd32f806a2cfc82f3ac2">avicodecdata</a>-&gt;<a class="code" href="../../d9/d3e/structAviCodecData.html#a426beb8964b8a27a366c28cc56588b71">lpParms</a>);
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205     
<a name="l00206"></a>00206     <span class="comment">/* make a private copy of the qtcodecdata */</span>
<a name="l00207"></a>00207     <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#abb4ac3dcf18fb91c934d1a330802234b">qtcodecdata</a>) {
<a name="l00208"></a>00208         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#abb4ac3dcf18fb91c934d1a330802234b">qtcodecdata</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#abb4ac3dcf18fb91c934d1a330802234b">qtcodecdata</a>);
<a name="l00209"></a>00209         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#abb4ac3dcf18fb91c934d1a330802234b">qtcodecdata</a>-&gt;<a class="code" href="../../d2/d03/structQuicktimeCodecData.html#aba683799ebc5231dd3da28d70a5db6e9">cdParms</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#a949901146866de87c434b2a6e225d2ec">MEM_dupallocN</a>(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#abb4ac3dcf18fb91c934d1a330802234b">qtcodecdata</a>-&gt;<a class="code" href="../../d2/d03/structQuicktimeCodecData.html#aba683799ebc5231dd3da28d70a5db6e9">cdParms</a>);
<a name="l00210"></a>00210     }
<a name="l00211"></a>00211     
<a name="l00212"></a>00212     <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaad814d69e4d36c2e95c2c1263f2f8f7">ffcodecdata</a>.<a class="code" href="../../d3/d4d/structFFMpegCodecData.html#a9a7dc0b9a03ebde32a65b29c1ab01d3e">properties</a>) { <span class="comment">/* intentionally check scen not sce. */</span>
<a name="l00213"></a>00213         scen-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaad814d69e4d36c2e95c2c1263f2f8f7">ffcodecdata</a>.<a class="code" href="../../d3/d4d/structFFMpegCodecData.html#a9a7dc0b9a03ebde32a65b29c1ab01d3e">properties</a>= <a class="code" href="../../d5/d95/BKE__idprop_8h.html#ae80f703da3b22ff05299c00760d1d8cc">IDP_CopyProperty</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaad814d69e4d36c2e95c2c1263f2f8f7">ffcodecdata</a>.<a class="code" href="../../d3/d4d/structFFMpegCodecData.html#a9a7dc0b9a03ebde32a65b29c1ab01d3e">properties</a>);
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     <span class="comment">/* NOTE: part of SCE_COPY_LINK_DATA and SCE_COPY_FULL operations</span>
<a name="l00217"></a>00217 <span class="comment">     * are done outside of blenkernel with ED_objects_single_users! */</span>
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     <span class="comment">/*  camera */</span>
<a name="l00220"></a>00220     <span class="keywordflow">if</span> (type == <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1cca55ee1e2f86963fd0d2ac9c7099e">SCE_COPY_LINK_DATA</a> || type == <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1c346b660cd6575ec15790ad0e0680b">SCE_COPY_FULL</a>) {
<a name="l00221"></a>00221         <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#ab1eef3c4c614c6b8c9d873721bec217e">ID_NEW</a>(scen-&gt;<a class="code" href="../../d9/d27/structScene.html#ad050647276d4d850d127173450933107">camera</a>);
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223     
<a name="l00224"></a>00224     <span class="comment">/* before scene copy */</span>
<a name="l00225"></a>00225     <a class="code" href="../../d2/db1/BKE__sound_8h.html#a49eebb03fe163031f8f117ef1cdec992">sound_create_scene</a>(scen);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     <span class="comment">/* world */</span>
<a name="l00228"></a>00228     <span class="keywordflow">if</span> (type == <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1c346b660cd6575ec15790ad0e0680b">SCE_COPY_FULL</a>) {
<a name="l00229"></a>00229         <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aca020cfa2c290052ce2ddc1612a9abfc">BKE_copy_animdata_id_action</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scen);
<a name="l00230"></a>00230         <span class="keywordflow">if</span> (scen-&gt;world) {
<a name="l00231"></a>00231             <a class="code" href="../../d8/db1/BKE__library_8h.html#a967d1ceef29b2612ef6e03194c512ad6">id_us_plus</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scen-&gt;world);
<a name="l00232"></a>00232             scen-&gt;world= <a class="code" href="../../dd/d35/BKE__world_8h.html#a481ffab754f857630b138f6f2358b548">copy_world</a>(scen-&gt;world);
<a name="l00233"></a>00233             <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aca020cfa2c290052ce2ddc1612a9abfc">BKE_copy_animdata_id_action</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scen-&gt;world);
<a name="l00234"></a>00234         }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>) {
<a name="l00237"></a>00237             scen-&gt;ed= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>( <span class="keyword">sizeof</span>(<a class="code" href="../../d5/de9/structEditing.html">Editing</a>), <span class="stringliteral">&quot;addseq&quot;</span>);
<a name="l00238"></a>00238             scen-&gt;ed-&gt;seqbasep= &amp;scen-&gt;ed-&gt;seqbase;
<a name="l00239"></a>00239             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a6a19420861bba9c05e0d73b5b54e7ff6">seqbase_dupli_recursive</a>(sce, scen, &amp;scen-&gt;ed-&gt;seqbase, &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a95cf0fcff1119964dfc0804982d43710">SEQ_DUPE_ALL</a>);
<a name="l00240"></a>00240         }
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     <span class="keywordflow">return</span> scen;
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 <span class="comment">/* do not free scene itself */</span>
<a name="l00247"></a><a class="code" href="../../d0/d13/scene_8c.html#a77070aad64264e2b4eedbf3fbcd94510">00247</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a0a86d466df6591096c16f404ba979107">free_scene</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce)
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251     base= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00252"></a>00252     <span class="keywordflow">while</span> (base) {
<a name="l00253"></a>00253         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l00254"></a>00254         base= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l00255"></a>00255     }
<a name="l00256"></a>00256     <span class="comment">/* do not free objects! */</span>
<a name="l00257"></a>00257     
<a name="l00258"></a>00258     <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa06b54d17dc1e7798392886eb3b0923a">gpd</a>) {
<a name="l00259"></a>00259 <span class="preprocessor">#if 0   // removed since this can be invalid memory when freeing everything</span>
<a name="l00260"></a>00260 <span class="preprocessor"></span>        <span class="comment">// since the grease pencil data is freed before the scene.</span>
<a name="l00261"></a>00261         <span class="comment">// since grease pencil data is not (yet?), shared between objects</span>
<a name="l00262"></a>00262         <span class="comment">// its probably safe not to do this, some save and reload will free this.</span>
<a name="l00263"></a>00263         sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa06b54d17dc1e7798392886eb3b0923a">gpd</a>-&gt;<a class="code" href="../../dd/d52/structbGPdata.html#aaec6b9082af7de201b9cd5cf7bfafcd1">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l00264"></a>00264 <span class="preprocessor">#endif</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span>        sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa06b54d17dc1e7798392886eb3b0923a">gpd</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00266"></a>00266     }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>);
<a name="l00269"></a>00269     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afff9aa2c33b42e2d2bf5331a7881a2ca">seq_free_editing</a>(sce);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a186ce67df8bf9873cc945eed480eaa49">BKE_free_animdata</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)sce);
<a name="l00272"></a>00272     <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a13f252b6bac11d9d851bed5c5e7f29a6">BKE_keyingsets_free</a>(&amp;sce-&gt;keyingsets);
<a name="l00273"></a>00273     
<a name="l00274"></a>00274     <span class="keywordflow">if</span> (sce-&gt;r.avicodecdata) {
<a name="l00275"></a>00275         <a class="code" href="../../d8/d53/BKE__scene_8h.html#a5263782f4b0ea3f0c8332525c6dfe716">free_avicodecdata</a>(sce-&gt;r.avicodecdata);
<a name="l00276"></a>00276         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;r.avicodecdata);
<a name="l00277"></a>00277         sce-&gt;r.avicodecdata = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279     <span class="keywordflow">if</span> (sce-&gt;r.qtcodecdata) {
<a name="l00280"></a>00280         <a class="code" href="../../d8/d53/BKE__scene_8h.html#a9762d2444af0ca85ebc5b0c8cf158c04">free_qtcodecdata</a>(sce-&gt;r.qtcodecdata);
<a name="l00281"></a>00281         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;r.qtcodecdata);
<a name="l00282"></a>00282         sce-&gt;r.qtcodecdata = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284     <span class="keywordflow">if</span> (sce-&gt;r.ffcodecdata.<a class="code" href="../../d8/d7e/structID.html#a9bdcd8f6ae46e613cf8d6c0b9735a039">properties</a>) {
<a name="l00285"></a>00285         <a class="code" href="../../d5/d95/BKE__idprop_8h.html#ac700fa8a94927f66ebc0c0e12378bbd1">IDP_FreeProperty</a>(sce-&gt;r.ffcodecdata.<a class="code" href="../../d8/d7e/structID.html#a9bdcd8f6ae46e613cf8d6c0b9735a039">properties</a>);
<a name="l00286"></a>00286         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;r.ffcodecdata.<a class="code" href="../../d8/d7e/structID.html#a9bdcd8f6ae46e613cf8d6c0b9735a039">properties</a>);
<a name="l00287"></a>00287         sce-&gt;r.ffcodecdata.<a class="code" href="../../d8/d7e/structID.html#a9bdcd8f6ae46e613cf8d6c0b9735a039">properties</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00288"></a>00288     }
<a name="l00289"></a>00289     
<a name="l00290"></a>00290     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;sce-&gt;markers);
<a name="l00291"></a>00291     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;sce-&gt;transform_spaces);
<a name="l00292"></a>00292     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;sce-&gt;r.layers);
<a name="l00293"></a>00293     
<a name="l00294"></a>00294     <span class="keywordflow">if</span> (sce-&gt;toolsettings) {
<a name="l00295"></a>00295         <span class="keywordflow">if</span> (sce-&gt;toolsettings-&gt;vpaint) {
<a name="l00296"></a>00296             <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad29f75ec938122c644d4caa5ce5a74d9">free_paint</a>(&amp;sce-&gt;toolsettings-&gt;vpaint-&gt;paint);
<a name="l00297"></a>00297             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;toolsettings-&gt;vpaint);
<a name="l00298"></a>00298         }
<a name="l00299"></a>00299         <span class="keywordflow">if</span> (sce-&gt;toolsettings-&gt;wpaint) {
<a name="l00300"></a>00300             <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad29f75ec938122c644d4caa5ce5a74d9">free_paint</a>(&amp;sce-&gt;toolsettings-&gt;wpaint-&gt;paint);
<a name="l00301"></a>00301             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;toolsettings-&gt;wpaint);
<a name="l00302"></a>00302         }
<a name="l00303"></a>00303         <span class="keywordflow">if</span> (sce-&gt;toolsettings-&gt;sculpt) {
<a name="l00304"></a>00304             <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad29f75ec938122c644d4caa5ce5a74d9">free_paint</a>(&amp;sce-&gt;toolsettings-&gt;sculpt-&gt;paint);
<a name="l00305"></a>00305             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;toolsettings-&gt;sculpt);
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307         <span class="keywordflow">if</span> (sce-&gt;toolsettings-&gt;uvsculpt) {
<a name="l00308"></a>00308             <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad29f75ec938122c644d4caa5ce5a74d9">free_paint</a>(&amp;sce-&gt;toolsettings-&gt;uvsculpt-&gt;paint);
<a name="l00309"></a>00309             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;toolsettings-&gt;uvsculpt);
<a name="l00310"></a>00310         }
<a name="l00311"></a>00311         <a class="code" href="../../d8/d86/BKE__paint_8h.html#ad29f75ec938122c644d4caa5ce5a74d9">free_paint</a>(&amp;sce-&gt;toolsettings-&gt;imapaint.paint);
<a name="l00312"></a>00312 
<a name="l00313"></a>00313         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;toolsettings);
<a name="l00314"></a>00314         sce-&gt;toolsettings = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316     
<a name="l00317"></a>00317     <span class="keywordflow">if</span> (sce-&gt;theDag) {
<a name="l00318"></a>00318         <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#aef295b921a94ae4818d364194a6769b1">free_forest</a>(sce-&gt;theDag);
<a name="l00319"></a>00319         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;theDag);
<a name="l00320"></a>00320     }
<a name="l00321"></a>00321     
<a name="l00322"></a>00322     <span class="keywordflow">if</span> (sce-&gt;nodetree) {
<a name="l00323"></a>00323         <a class="code" href="../../d4/d91/BKE__node_8h.html#a5f6d61a1f4a0daa3dab1624a1335f947">ntreeFreeTree</a>(sce-&gt;nodetree);
<a name="l00324"></a>00324         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;nodetree);
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     <span class="keywordflow">if</span> (sce-&gt;stats)
<a name="l00328"></a>00328         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;stats);
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (sce-&gt;fps_info)
<a name="l00330"></a>00330         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sce-&gt;fps_info);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <a class="code" href="../../d2/db1/BKE__sound_8h.html#aea3b3290ecf4d03cc5c5a9d1fb125bbe">sound_destroy_scene</a>(sce);
<a name="l00333"></a>00333 }
<a name="l00334"></a>00334 
<a name="l00335"></a><a class="code" href="../../d0/d13/scene_8c.html#aedcb57d06a40be94ee9ffaa902aadb36">00335</a> <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#a69a66e7b13f7dc7041a82436563ee915">add_scene</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00336"></a>00336 {
<a name="l00337"></a>00337     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main;
<a name="l00338"></a>00338     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce;
<a name="l00339"></a>00339     <a class="code" href="../../df/db7/structParticleEditSettings.html">ParticleEditSettings</a> *pset;
<a name="l00340"></a>00340     <span class="keywordtype">int</span> a;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     sce= <a class="code" href="../../d8/db1/BKE__library_8h.html#a0856c5e10e28cbe0b45eb00363bf8fb5">alloc_libblock</a>(&amp;bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a976062774f867fa0f917c23f2ec331bb">scene</a>, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac2b425dbd1f73ad1720fafad2626d974">ID_SCE</a>, name);
<a name="l00343"></a>00343     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a506dd867fc58506c37c1e56f6b134056">lay</a>= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af04604238d2057e2ac31625911a0f26e">layact</a>= 1;
<a name="l00344"></a>00344     
<a name="l00345"></a>00345     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad4b607d22d4e5f4c2f92dda62358d664">mode</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afdc2aa064250a4babf6e2d85ed68996e">R_GAMMA</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a2711a7abdf812fa0f1b16da25a7d6343">R_OSA</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#af0e0e8839056799ccca22fb9c4a0451e">R_SHADOW</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a516c9c9cdf6193e6556b3850eca85510">R_SSS</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#af38446c2dfb68ef620bd015cd68aebd2">R_ENVMAP</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a9ed65b3c82ee562a544923e6b9c8b41a">R_RAYTRACE</a>;
<a name="l00346"></a>00346     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>= 1;
<a name="l00347"></a>00347     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a97f52582406befb3dba13b121d886526">sfra</a>= 1;
<a name="l00348"></a>00348     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#af94766d58b62a533f851ce3f42ce026c">efra</a>= 250;
<a name="l00349"></a>00349     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a252e009f6db4a41b7efd7eb211de2963">frame_step</a>= 1;
<a name="l00350"></a>00350     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#afac89783028ff848f111de04e0c29fbe">xsch</a>= 1920;
<a name="l00351"></a>00351     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aca3c1ebdf50a6c74730e19e24983217d">ysch</a>= 1080;
<a name="l00352"></a>00352     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a7c97c9fb3ae2b02bd4ccb8c76d68811a">xasp</a>= 1;
<a name="l00353"></a>00353     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a1f4c395a81051abd055a1014e02c9f00">yasp</a>= 1;
<a name="l00354"></a>00354     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ade972d7802ccc8bd375faec2bac270a1">xparts</a>= 8;
<a name="l00355"></a>00355     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a663640f6f699dd2991f6866804d3bfa7">yparts</a>= 8;
<a name="l00356"></a>00356     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ae4796e02b0a0ef82ac519c197c7b864d">mblur_samples</a>= 1;
<a name="l00357"></a>00357     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4795ac457722fc5af529181f2c1259ab">filtertype</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a64729efcecc40a74ac819b7e43bb0d93">R_FILTER_MITCH</a>;
<a name="l00358"></a>00358     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a11d240aa637c806a992d75d43d4aded8">size</a>= 50;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a53cdd260f397aa4d2bead55f90780180">im_format</a>.<a class="code" href="../../da/d23/structImageFormatData.html#aedc2ed8969621f3903a6fee8eeb098c9">planes</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aee79a5344ad31850de44a367f28356bc">R_IMF_PLANES_RGB</a>;
<a name="l00361"></a>00361     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a53cdd260f397aa4d2bead55f90780180">im_format</a>.<a class="code" href="../../da/d23/structImageFormatData.html#a30929385debbd1ff586c9f9936895198">imtype</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a6a1d65e05ddade83407a62db2df2db0a">R_IMF_IMTYPE_PNG</a>;
<a name="l00362"></a>00362     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a53cdd260f397aa4d2bead55f90780180">im_format</a>.<a class="code" href="../../da/d23/structImageFormatData.html#a74d5dd69af52338475a267ab8493b2f7">quality</a>= 90;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5f8df0b6ae1c0235fb4a49021acbb53f">displaymode</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a77f7364aa802484c7fba221b82276e1f">R_OUTPUT_AREA</a>;
<a name="l00365"></a>00365     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a42fb1804b4e07360eb563dc0e5b17190">framapto</a>= 100;
<a name="l00366"></a>00366     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a3848b3ecab0408664df0e60bd8ae5d57">images</a>= 100;
<a name="l00367"></a>00367     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4399e01a91c6ca3e1259887c82ea0972">framelen</a>= 1.0;
<a name="l00368"></a>00368     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ab59dde67953fa33c205edf7c75041092">blurfac</a>= 0.5;
<a name="l00369"></a>00369     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a071df993e13c05fc37e6f9a82c0679f5">frs_sec</a>= 24;
<a name="l00370"></a>00370     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a11e6b08a8678f04813637f658e867193">frs_sec_base</a>= 1;
<a name="l00371"></a>00371     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a646ed0f52f6bd36495fc9a24039fe305">edgeint</a>= 10;
<a name="l00372"></a>00372     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a245118fb5febf8875cc7eeef054210f6">ocres</a> = 128;
<a name="l00373"></a>00373     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aa9a0521ac4e22707d09ddeac4bf104b2">color_mgt_flag</a> |= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aea9753cc8aec8bc51c69f789cd188848">R_COLOR_MANAGEMENT</a>;
<a name="l00374"></a>00374     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ab2470ab7f3cab6d98975373adbb740c7">gauss</a>= 1.0;
<a name="l00375"></a>00375     
<a name="l00376"></a>00376     <span class="comment">/* deprecated but keep for upwards compat */</span>
<a name="l00377"></a>00377     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5842dbf47639071588450aac819d6aa2">postgamma</a>= 1.0;
<a name="l00378"></a>00378     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aa43a0f8925b1aa087776195ff6f92464">posthue</a>= 0.0;
<a name="l00379"></a>00379     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a782edb80e49ad7bab3f58c1fd8b859f7">postsat</a>= 1.0;
<a name="l00380"></a>00380     
<a name="l00381"></a>00381     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4a91a25d74bbbdeccfa32513acbfde28">bake_mode</a>= 1;    <span class="comment">/* prevent to include render stuff here */</span>
<a name="l00382"></a>00382     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a6ad7d51845798984f1050c4314062829">bake_filter</a>= 2;
<a name="l00383"></a>00383     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a7921e15f247899a6f6cc1f9536472f62">bake_osa</a>= 5;
<a name="l00384"></a>00384     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a5af2fa5d427f5c99a21dc98b5cc4e91c">bake_flag</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a14571df5abb1ae871ad447e5cff5b967">R_BAKE_CLEAR</a>;
<a name="l00385"></a>00385     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#afbbca7a09d8e0264baea2d7ba7e79271">bake_normal_space</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a84fc984ae3235926494ece384069c1dc">R_BAKE_SPACE_TANGENT</a>;
<a name="l00386"></a>00386     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad853a19c13a6c728a07b82fbb9f52bc6">scemode</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a528d67e263365f89277519c248742cfd">R_DOCOMP</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a626d01f9b9f70a89f5f7188d30fb4555">R_DOSEQ</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a0f397dbc57d5dfaaee5dab7176f96ab6">R_EXTENSION</a>;
<a name="l00387"></a>00387     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a1a66c7d9654a5c68107ca7bef99d9cb3">stamp</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aec5030f666744fe172ea24beead1de5e">R_STAMP_TIME</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a9c2a347ca029693edbde71eed50250c7">R_STAMP_FRAME</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aa95a1b81310725285fc5e7d52aad52b1">R_STAMP_DATE</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aa36591728fead70dbc09d7ec51746f27">R_STAMP_CAMERA</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac8b51e69ec5e97a8f0f04da0860053d0">R_STAMP_SCENE</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aab2a1af29484b3cdc628408b9527f7b0">R_STAMP_FILENAME</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a13e09864bcf66a395b5e376df0e449f0">R_STAMP_RENDERTIME</a>;
<a name="l00388"></a>00388     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a551a53888d16cefa2ab21a4b92002eef">stamp_font_id</a>= 12;
<a name="l00389"></a>00389     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4093cd9ba9690451433964b247d19cc1">fg_stamp</a>[0]= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4093cd9ba9690451433964b247d19cc1">fg_stamp</a>[1]= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4093cd9ba9690451433964b247d19cc1">fg_stamp</a>[2]= 0.8f;
<a name="l00390"></a>00390     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4093cd9ba9690451433964b247d19cc1">fg_stamp</a>[3]= 1.0f;
<a name="l00391"></a>00391     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a78fed2b1e448c4d1bc03eaeba9111739">bg_stamp</a>[0]= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a78fed2b1e448c4d1bc03eaeba9111739">bg_stamp</a>[1]= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a78fed2b1e448c4d1bc03eaeba9111739">bg_stamp</a>[2]= 0.0f;
<a name="l00392"></a>00392     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a78fed2b1e448c4d1bc03eaeba9111739">bg_stamp</a>[3]= 0.25f;
<a name="l00393"></a>00393     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a2091b40836bdb6bfbf10b93417782895">raytrace_options</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a591eeb8a2b02c3f9a3bdb9cf879060a0">R_RAYTRACE_USE_INSTANCES</a>;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a2c10d6d5fc9d5bf93e2a12818a732111">seq_prev_type</a>= <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a02098d23ce96d480e90882bed52cb89d">OB_SOLID</a>;
<a name="l00396"></a>00396     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a6ec8c355af1ebf08814d85442ba6890c">seq_rend_type</a>= <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a02098d23ce96d480e90882bed52cb89d">OB_SOLID</a>;
<a name="l00397"></a>00397     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ac4840e490815f92c314cca03e9c886ef">seq_flag</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a559960551526de538aa08e6b2fe674d2">R_SEQ_GL_PREV</a>;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a9edbf2d157a2d3765e97eba62f07ff68">threads</a>= 1;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a12fa5e141ba422aa06aea847fc427b9b">simplify_subsurf</a>= 6;
<a name="l00402"></a>00402     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a2e5b16df1126f4e350a2a5e6fbee68f2">simplify_particles</a>= 1.0f;
<a name="l00403"></a>00403     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#afb2f47ff8d71fcaeb5a3e6bd1c526061">simplify_shadowsamples</a>= 16;
<a name="l00404"></a>00404     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a1cdcb1ebf20075aeeeed2335bcadcd42">simplify_aosss</a>= 1.0f;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaaf1a7daed17e111b846fe8632874e5d">border</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = 0.0f;
<a name="l00407"></a>00407     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaaf1a7daed17e111b846fe8632874e5d">border</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = 0.0f;
<a name="l00408"></a>00408     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaaf1a7daed17e111b846fe8632874e5d">border</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = 1.0f;
<a name="l00409"></a>00409     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaaf1a7daed17e111b846fe8632874e5d">border</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = 1.0f;
<a name="l00410"></a>00410     
<a name="l00411"></a>00411     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d0/d65/structToolSettings.html">ToolSettings</a>),<span class="stringliteral">&quot;Tool Settings Struct&quot;</span>);
<a name="l00412"></a>00412     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a786630a2f1ee3a74866655434692ebd8">cornertype</a>=1;
<a name="l00413"></a>00413     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a122188eb0fcc52a8bf2292d9b1c0079f">degr</a> = 90; 
<a name="l00414"></a>00414     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a20bbed20e36e465d8e57384cb061b72e">step</a> = 9;
<a name="l00415"></a>00415     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a4705c0af5b9c44d048756fc4b62f866c">turn</a> = 1;                
<a name="l00416"></a>00416     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#abcc0f759039f23e18c1ec77a35b2278f">extr_offs</a> = 1; 
<a name="l00417"></a>00417     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a8548e36a4a0ab49542ed30ad5fb0f81f">doublimit</a> = 0.001;
<a name="l00418"></a>00418     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a8c8823ebde0350c2426179feae80bf57">segments</a> = 32;
<a name="l00419"></a>00419     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a499d29637864ecd23d92ce6cddea3aac">rings</a> = 32;
<a name="l00420"></a>00420     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a23917f0127ed1a0b34592ba2e90cc4cd">vertices</a> = 32;
<a name="l00421"></a>00421     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a916ca8303e4eb90c819b292d4d2b2c45">uvcalc_radius</a> = 1.0f;
<a name="l00422"></a>00422     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#ac1718494b204549b613bd37b062fd3c5">uvcalc_cubesize</a> = 1.0f;
<a name="l00423"></a>00423     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a24cec559c90ca0ac2c634e5a6a9a91f2">uvcalc_mapdir</a> = 1;
<a name="l00424"></a>00424     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a82145a1ec37b066b0b59a188b8c885b6">uvcalc_mapalign</a> = 1;
<a name="l00425"></a>00425     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a91e80769ccac6cd72e63a8d5e04d7539">unwrapper</a> = 1;
<a name="l00426"></a>00426     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a7abdee813c5d1b69023d7652f926c03d">select_thresh</a>= 0.01f;
<a name="l00427"></a>00427     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a05de0823fbeed87c090336365b74a65a">jointrilimit</a> = 0.8f;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a85db400bd7203c7be03555b02e6c2709">selectmode</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8de5fe0f8dbf523c4699a7b54c429e2f">SCE_SELECT_VERTEX</a>;
<a name="l00430"></a>00430     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a62dc1f21975c05d9cd31510257d31fe8">uv_selectmode</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a9cb5698cc28e547454fc69e311451309">UV_SELECT_VERTEX</a>;
<a name="l00431"></a>00431     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a061a6cacabb6dda02f9bc27be4df8628">normalsize</a>= 0.1;
<a name="l00432"></a>00432     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a4b150607e8aac0ff197e193676722a8b">autokey_mode</a>= <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.autokey_mode;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#ad35016b3588c2e982a56d823d6d42931">skgen_resolution</a> = 100;
<a name="l00435"></a>00435     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#ad611fe2d827aef3a4dddb037319521ab">skgen_threshold_internal</a>     = 0.01f;
<a name="l00436"></a>00436     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a7d9c2ffcc30090dc0e2771fe98aa973d">skgen_threshold_external</a>     = 0.01f;
<a name="l00437"></a>00437     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a713edf332679a877df0768ff4483da6b">skgen_angle_limit</a>            = 45.0f;
<a name="l00438"></a>00438     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#aa7250ee91727d25fc0275bc0c24e7ab0">skgen_length_ratio</a>           = 1.3f;
<a name="l00439"></a>00439     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#aa2790c37c143dde5059ab46b2ac762b3">skgen_length_limit</a>           = 1.5f;
<a name="l00440"></a>00440     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#ac16453770a42da352046774f40bf68e8">skgen_correlation_limit</a>      = 0.98f;
<a name="l00441"></a>00441     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#ad770c942287a18f84ffc8b6020081dbc">skgen_symmetry_limit</a>         = 0.1f;
<a name="l00442"></a>00442     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#aa74543b96456a0884b16ee0a94e30621">skgen_postpro</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#acc807c5db90884d879a648f0e59ed251">SKGEN_SMOOTH</a>;
<a name="l00443"></a>00443     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#ae616d6e3ba62b191a05aac732df4c3d1">skgen_postpro_passes</a> = 1;
<a name="l00444"></a>00444     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#af0b94a84b1f5e158a318aad58c19ea4b">skgen_options</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a76f0f1e1f080a612e46a76cc88364305">SKGEN_FILTER_INTERNAL</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac4438acbff074ca6751ff8cad840e944">SKGEN_FILTER_EXTERNAL</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac6623cbafad283f059205b8d57d60d0f">SKGEN_FILTER_SMART</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a1396a8dca33b937bb73a34a9a420b45a">SKGEN_HARMONIC</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a6bc84f7c60c397a71bee8f1417469e2f">SKGEN_SUB_CORRELATION</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a7b4581056b4d550e567450f318f6cd12">SKGEN_STICK_TO_EMBEDDING</a>;
<a name="l00445"></a>00445     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a9fb75687b5956f6aff36ea0d5a6f587e">skgen_subdivisions</a>[0] = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a6bc84f7c60c397a71bee8f1417469e2f">SKGEN_SUB_CORRELATION</a>;
<a name="l00446"></a>00446     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a9fb75687b5956f6aff36ea0d5a6f587e">skgen_subdivisions</a>[1] = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aa48b85331094d01b26ad9752030db4ab">SKGEN_SUB_LENGTH</a>;
<a name="l00447"></a>00447     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a9fb75687b5956f6aff36ea0d5a6f587e">skgen_subdivisions</a>[2] = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a361c0d433ad9e037ce767c0e2993dc27">SKGEN_SUB_ANGLE</a>;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a6848be823e78cd9918fa67fb0f1de0ff">proportional_size</a> = 1.0f;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>.<a class="code" href="../../d6/d40/structPhysicsSettings.html#a1ad145e35a189d541a16b143c20f3fd6">gravity</a>[0] = 0.0f;
<a name="l00452"></a>00452     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>.<a class="code" href="../../d6/d40/structPhysicsSettings.html#a1ad145e35a189d541a16b143c20f3fd6">gravity</a>[1] = 0.0f;
<a name="l00453"></a>00453     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>.<a class="code" href="../../d6/d40/structPhysicsSettings.html#a1ad145e35a189d541a16b143c20f3fd6">gravity</a>[2] = -9.81f;
<a name="l00454"></a>00454     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>.<a class="code" href="../../d6/d40/structPhysicsSettings.html#ae4c1524b30f9e72a87543f428be1549c">flag</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a508bb80abc11d94db2661ef7f6d0cc00">PHYS_GLOBAL_GRAVITY</a>;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#abe370ff027b47b00fb8a81620639eff4">unit</a>.<a class="code" href="../../d8/da3/structUnitSettings.html#a0c970043cd1006145890fee0041a5161">scale_length</a> = 1.0f;
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     pset= &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a931875e2d55fef9de65c777431a94f31">particle</a>;
<a name="l00459"></a>00459     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a3bfdff8f61248e79650bdf43d58b165c">flag</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a4ada0b3849ba1ad9d2c52c2c08ff292b">PE_KEEP_LENGTHS</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a9244c6f7c421c6e45a53d845f21bc4a0">PE_LOCK_FIRST</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a4eb2fbeba4dbdbba518d73198e5d30a8">PE_DEFLECT_EMITTER</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#af97d5861f7f4d3e0c8781b096935e471">PE_AUTO_VELOCITY</a>;
<a name="l00460"></a>00460     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a8ddb420ffd5bfe8af837f5b41c80cbda">emitterdist</a>= 0.25f;
<a name="l00461"></a>00461     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#ace35dcd6a6e378ff34ad5d71a9763f02">totrekey</a>= 5;
<a name="l00462"></a>00462     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a6c01c6f2c45449e85d87c218b97e41c9">totaddkey</a>= 5;
<a name="l00463"></a>00463     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a5a8b3fad8136f57241b3e47e30abbec1">brushtype</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a43b3b46cd6ccc7c2058b0e949dcb6fd6">PE_BRUSH_NONE</a>;
<a name="l00464"></a>00464     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a79c4f9e844fde7d93e977da811e5ce7d">draw_step</a>= 2;
<a name="l00465"></a>00465     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#abfb82a67439a09c0e98209b54516d8e8">fade_frames</a>= 2;
<a name="l00466"></a>00466     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a1ec9fc0bf8c9038769de37144f7099da">selectmode</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a25a19c97747b2f50583d8bf6298cfc68">SCE_SELECT_PATH</a>;
<a name="l00467"></a>00467     <span class="keywordflow">for</span> (a=0; a&lt;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#adacf2d7fb008adfb64554ced30c5fd89">PE_TOT_BRUSH</a>; a++) {
<a name="l00468"></a>00468         pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a23ec19a6f795b0da2361718b51effaa6">brush</a>[a].<a class="code" href="../../d5/d14/structParticleBrushData.html#aae99022471b53d681c39d0fe3b9a583f">strength</a>= 0.5;
<a name="l00469"></a>00469         pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a23ec19a6f795b0da2361718b51effaa6">brush</a>[a].<a class="code" href="../../d5/d14/structParticleBrushData.html#af1a7856dc1b72f871243748f1b100749">size</a>= 50;
<a name="l00470"></a>00470         pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a23ec19a6f795b0da2361718b51effaa6">brush</a>[a].<a class="code" href="../../d5/d14/structParticleBrushData.html#a49ff869cc1b2fc20c59d7b76b65645ff">step</a>= 10;
<a name="l00471"></a>00471         pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a23ec19a6f795b0da2361718b51effaa6">brush</a>[a].<a class="code" href="../../d5/d14/structParticleBrushData.html#a792533d5558134e4b9b860865cdba5b3">count</a>= 10;
<a name="l00472"></a>00472     }
<a name="l00473"></a>00473     pset-&gt;<a class="code" href="../../df/db7/structParticleEditSettings.html#a23ec19a6f795b0da2361718b51effaa6">brush</a>[<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a7246fde765e285de27c4c3690c580a72">PE_BRUSH_CUT</a>].<a class="code" href="../../d5/d14/structParticleBrushData.html#aae99022471b53d681c39d0fe3b9a583f">strength</a>= 100;
<a name="l00474"></a>00474 
<a name="l00475"></a>00475     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaad814d69e4d36c2e95c2c1263f2f8f7">ffcodecdata</a>.<a class="code" href="../../d3/d4d/structFFMpegCodecData.html#a0d9a6f46aca2f92cf18b024ad8b180d6">audio_mixrate</a> = 44100;
<a name="l00476"></a>00476     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaad814d69e4d36c2e95c2c1263f2f8f7">ffcodecdata</a>.<a class="code" href="../../d3/d4d/structFFMpegCodecData.html#abf39dfb6d640659f1bf088427a8f7657">audio_volume</a> = 1.0f;
<a name="l00477"></a>00477     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaad814d69e4d36c2e95c2c1263f2f8f7">ffcodecdata</a>.<a class="code" href="../../d3/d4d/structFFMpegCodecData.html#afe7f45054922362be49fb9f1520f5f79">audio_bitrate</a> = 192;
<a name="l00478"></a>00478     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaad814d69e4d36c2e95c2c1263f2f8f7">ffcodecdata</a>.<a class="code" href="../../d3/d4d/structFFMpegCodecData.html#af3224addac00d2e3542afe1610190887">audio_channels</a> = 2;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4d4d1d058ba7c96ba3510f5101165b7f">engine</a>, <span class="stringliteral">&quot;BLENDER_RENDER&quot;</span>, <span class="keyword">sizeof</span>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4d4d1d058ba7c96ba3510f5101165b7f">engine</a>));
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af91931f1ea3f417f2d9ffba420e7290c">audio</a>.<a class="code" href="../../df/de3/structAudioData.html#a7a974ec87d9bd47263b8d5fc8f06eea9">distance_model</a> = 2.0f;
<a name="l00483"></a>00483     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af91931f1ea3f417f2d9ffba420e7290c">audio</a>.<a class="code" href="../../df/de3/structAudioData.html#a6dd724c9a669d3564bbe354c091eb82b">doppler_factor</a> = 1.0f;
<a name="l00484"></a>00484     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af91931f1ea3f417f2d9ffba420e7290c">audio</a>.<a class="code" href="../../df/de3/structAudioData.html#a9ea9a0d7307a8c05e8428a8e5656240f">speed_of_sound</a> = 343.3f;
<a name="l00485"></a>00485     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af91931f1ea3f417f2d9ffba420e7290c">audio</a>.<a class="code" href="../../df/de3/structAudioData.html#aab3bbf20b589d1bad05b40ddcb5a10f9">volume</a> = 1.0f;
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a67d0217c5d024ae2ee50bcbe547c4772">pic</a>, <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>.renderdir, <span class="keyword">sizeof</span>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a67d0217c5d024ae2ee50bcbe547c4772">pic</a>));
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <a class="code" href="../../d5/d44/BLI__rect_8h.html#a37ad8ed090965186176d4752bc1f94fb">BLI_init_rctf</a>(&amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aeca4ab8ff617728608250a7824fca4e9">safety</a>, 0.1f, 0.9f, 0.1f, 0.9f);
<a name="l00490"></a>00490     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a9f9743267b1d3ba032f5e0d1a81a4073">osa</a>= 8;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     <span class="comment">/* note; in header_info.c the scene copy happens..., if you add more to renderdata it has to be checked there */</span>
<a name="l00493"></a>00493     <a class="code" href="../../d8/d53/BKE__scene_8h.html#ad5651ef0505139e68b2e8e385427cea0">scene_add_render_layer</a>(sce, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00494"></a>00494     
<a name="l00495"></a>00495     <span class="comment">/* game data */</span>
<a name="l00496"></a>00496     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#ac2cf122f92bac27e00590265209d6e58">stereoflag</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a31f7ce778f992e5ea7d00801758564df">STEREO_NOSTEREO</a>;
<a name="l00497"></a>00497     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#af870360e52f5fc934a6bcb6cdebdc229">stereomode</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad7e901b34a0bc8b490de89009e690181">STEREO_ANAGLYPH</a>;
<a name="l00498"></a>00498     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6753d20785372215b27ee4598a779563">eyeseparation</a> = 0.10;
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6be618f1264d81c98fec00b879000a3a">dome</a>.<a class="code" href="../../d3/d9d/structGameDome.html#a73bc19da37560a524ede1435ab9f3a64">angle</a> = 180;
<a name="l00501"></a>00501     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6be618f1264d81c98fec00b879000a3a">dome</a>.<a class="code" href="../../d3/d9d/structGameDome.html#a9f8ab404d203646e515e256f9aaae20a">mode</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a2678c86e7ed16b6b2267e7e2672216ee">DOME_FISHEYE</a>;
<a name="l00502"></a>00502     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6be618f1264d81c98fec00b879000a3a">dome</a>.<a class="code" href="../../d3/d9d/structGameDome.html#acd7cb7ca7c8b775320f4c2736afefc67">res</a> = 4;
<a name="l00503"></a>00503     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6be618f1264d81c98fec00b879000a3a">dome</a>.<a class="code" href="../../d3/d9d/structGameDome.html#a0580190e61baa3d56f1cb4b57a68b032">resbuf</a> = 1.0f;
<a name="l00504"></a>00504     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6be618f1264d81c98fec00b879000a3a">dome</a>.<a class="code" href="../../d3/d9d/structGameDome.html#a0ffd41b1ff60a6db279a7adf0b4d6bc3">tilt</a> = 0;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a07a78e5e4c4adfa40a084aecb4967273">xplay</a>= 640;
<a name="l00507"></a>00507     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a8fbc9644a24b8648a46241c5e611c619">yplay</a>= 480;
<a name="l00508"></a>00508     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a2adc22c3619215553bedf4dff46c099c">freqplay</a>= 60;
<a name="l00509"></a>00509     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#afba6a54004f586435c5ced4fb246c080">depth</a>= 32;
<a name="l00510"></a>00510 
<a name="l00511"></a>00511     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a8325142eaa7981729c64e6132dccf4a9">gravity</a>= 9.8f;
<a name="l00512"></a>00512     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#ae830149c6f77170b21f7a12372722b62">physicsEngine</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a0bc314c665abe5322ee096d610eca563">WOPHY_BULLET</a>;
<a name="l00513"></a>00513     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#abb0b4ef8392647aaeab643b9e4164673">mode</a> = 32; <span class="comment">//XXX ugly harcoding, still not sure we should drop mode. 32 == 1 &lt;&lt; 5 == use_occlusion_culling </span>
<a name="l00514"></a>00514     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#ac819ad31ba0039ce7494c9aacdd05fc7">occlusionRes</a> = 128;
<a name="l00515"></a>00515     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#ae1277244e4b1793eba178169cdd1bdf3">ticrate</a> = 60;
<a name="l00516"></a>00516     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#ad39c8d791df4a2e4ad27767c34ecef9f">maxlogicstep</a> = 5;
<a name="l00517"></a>00517     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a68cf2f350be387f179d3c408eb84f25d">physubstep</a> = 1;
<a name="l00518"></a>00518     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#aa715280c28dfe18cf8f9c7a19ffe230e">maxphystep</a> = 5;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#ab5fe3ddcaef72618f1ba7a06fce36cde">flag</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a2a1783538db83d7451d84584108b10dc">GAME_DISPLAY_LISTS</a>;
<a name="l00521"></a>00521     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6cede4314df04c85946a10fbd7e109f0">matmode</a> = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a02c081d2634555f92bb39872cf6ef8d2">GAME_MAT_MULTITEX</a>;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#aaa0893dffa259ea2ee3f9553548ec9b3">obstacleSimulation</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a0f5e8e33e1eb4bf6b6037038fa66afa8">OBSTSIMULATION_NONE</a>;
<a name="l00524"></a>00524     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a6615b32747780b4b9df427eb68c19598">levelHeight</a> = 2.f;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a557011423b10a07a47a0691b796a10c3">cellsize</a> = 0.3f;
<a name="l00527"></a>00527     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a6fc3b4a44beceb190b25cf8ee3e86ba9">cellheight</a> = 0.2f;
<a name="l00528"></a>00528     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a68e56b4e9ff853c197de09eb55555abe">agentmaxslope</a> = <a class="code" href="../../d6/ddc/constraint_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/2;
<a name="l00529"></a>00529     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#ad56fb5609b01454ed2132b7827a029f5">agentmaxclimb</a> = 0.9f;
<a name="l00530"></a>00530     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a8758e27b8b0554e397060f147f93ef9e">agentheight</a> = 2.0f;
<a name="l00531"></a>00531     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#adcf0151569e354b09978eb8d39fbda60">agentradius</a> = 0.6f;
<a name="l00532"></a>00532     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#aadfa23f1ac3507ab60553f6cdd7d03cd">edgemaxlen</a> = 12.0f;
<a name="l00533"></a>00533     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a6b61f6bbfa2c13779c77f3d8788180b6">edgemaxerror</a> = 1.3f;
<a name="l00534"></a>00534     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#aed5b8f65e5e95ca13d05b994c975ab5b">regionminsize</a> = 8.f;
<a name="l00535"></a>00535     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#abd9df987166e04ff7b8a87a70ccd7a34">regionmergesize</a> = 20.f;
<a name="l00536"></a>00536     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a8accd2f8c9b77cba85d57761f872427c">vertsperpoly</a> = 6;
<a name="l00537"></a>00537     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a845f3ef148b50246c2ffb51f0910b2f7">detailsampledist</a> = 6.0f;
<a name="l00538"></a>00538     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a1d6d95b75f5fc8e765f8715043424074">recastData</a>.<a class="code" href="../../d3/de4/structRecastData.html#a2fb6d1d4a67537eb536128e14209a8df">detailsamplemaxerror</a> = 1.0f;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a2f6932759dc1dd4f11a97189aa38f088">exitkey</a> = 218; <span class="comment">// Blender key code for ESC</span>
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     <a class="code" href="../../d2/db1/BKE__sound_8h.html#a49eebb03fe163031f8f117ef1cdec992">sound_create_scene</a>(sce);
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     <span class="keywordflow">return</span> sce;
<a name="l00545"></a>00545 }
<a name="l00546"></a>00546 
<a name="l00547"></a><a class="code" href="../../d0/d13/scene_8c.html#aa8a0310658cf7d14531c8cdd3b4e8dfd">00547</a> <a class="code" href="../../d3/da9/structBase.html">Base</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#af038ab52dca2267b6418721c13b81e74">object_in_scene</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce)
<a name="l00548"></a>00548 {
<a name="l00549"></a>00549     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00550"></a>00550     
<a name="l00551"></a>00551     base= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00552"></a>00552     <span class="keywordflow">while</span> (base) {
<a name="l00553"></a>00553         <span class="keywordflow">if</span> (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a> == ob) <span class="keywordflow">return</span> base;
<a name="l00554"></a>00554         base= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l00555"></a>00555     }
<a name="l00556"></a>00556     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="../../d0/d13/scene_8c.html#afb795efc0ed0b85f051de54913b6301d">00559</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a2786d63921fc3176178dfaa36b5c814e">set_scene_bg</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00560"></a>00560 {
<a name="l00561"></a>00561     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce;
<a name="l00562"></a>00562     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00563"></a>00563     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob;
<a name="l00564"></a>00564     <a class="code" href="../../d4/d91/structGroup.html">Group</a> *group;
<a name="l00565"></a>00565     <a class="code" href="../../d3/d3b/structGroupObject.html">GroupObject</a> *go;
<a name="l00566"></a>00566     <span class="keywordtype">int</span> flag;
<a name="l00567"></a>00567     
<a name="l00568"></a>00568     <span class="comment">/* check for cyclic sets, for reading old files but also for definite security (py?) */</span>
<a name="l00569"></a>00569     <a class="code" href="../../d8/d53/BKE__scene_8h.html#a770159f5de9ca2d775ae3058a5b73cd0">scene_check_setscene</a>(bmain, scene);
<a name="l00570"></a>00570     
<a name="l00571"></a>00571     <span class="comment">/* can happen when switching modes in other scenes */</span>
<a name="l00572"></a>00572     <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a1aa1978dba5dab99d35b6ba89e88b5bb">obedit</a> &amp;&amp; !(scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a1aa1978dba5dab99d35b6ba89e88b5bb">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a4f90725f5876b309d325c84ae4f5c51b">mode</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a36fb08f71e0c90da2a0f21518ef0d550a5aed90bff10a0fd5ad47c9ee79ae4580">OB_MODE_EDIT</a>))
<a name="l00573"></a>00573         scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a1aa1978dba5dab99d35b6ba89e88b5bb">obedit</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575     <span class="comment">/* deselect objects (for dataselect) */</span>
<a name="l00576"></a>00576     <span class="keywordflow">for</span> (ob= bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#ac9c12335b530e1b3f1717bb9cbc269a4">object</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ob; ob= ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00577"></a>00577         ob-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a> &amp;= ~(<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>|<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a9588748603be4778a9197f7edbf356d4">OB_FROMGROUP</a>);
<a name="l00578"></a>00578 
<a name="l00579"></a>00579     <span class="comment">/* group flags again */</span>
<a name="l00580"></a>00580     <span class="keywordflow">for</span> (group= bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a267e87055868d88574ec121db05cc8c7">group</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; group; group= group-&gt;<a class="code" href="../../d4/d91/structGroup.html#ab7e17dc53d15eeb5f6c4c7789d92b969">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l00581"></a>00581         go= group-&gt;<a class="code" href="../../d4/d91/structGroup.html#ad757bf69b6fd15b1d4e0980089d13be1">gobject</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00582"></a>00582         <span class="keywordflow">while</span> (go) {
<a name="l00583"></a>00583             <span class="keywordflow">if</span> (go-&gt;<a class="code" href="../../d3/d3b/structGroupObject.html#aeafe134dbf1980f42045d1fc191f2967">ob</a>) go-&gt;<a class="code" href="../../d3/d3b/structGroupObject.html#aeafe134dbf1980f42045d1fc191f2967">ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a> |= <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a9588748603be4778a9197f7edbf356d4">OB_FROMGROUP</a>;
<a name="l00584"></a>00584             go= go-&gt;<a class="code" href="../../d3/d3b/structGroupObject.html#a81e7437ba90ec95c5fbb96e17e6a203d">next</a>;
<a name="l00585"></a>00585         }
<a name="l00586"></a>00586     }
<a name="l00587"></a>00587 
<a name="l00588"></a>00588     <span class="comment">/* sort baselist */</span>
<a name="l00589"></a>00589     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a1916587a9ec19eb3543b1c1bc54a8ded">DAG_scene_sort</a>(bmain, scene);
<a name="l00590"></a>00590     
<a name="l00591"></a>00591     <span class="comment">/* ensure dags are built for sets */</span>
<a name="l00592"></a>00592     <span class="keywordflow">for</span> (sce= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>; sce; sce= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>)
<a name="l00593"></a>00593         <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa36a32a59b8c372076d113a5b532f6e4">theDag</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00594"></a>00594             <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a1916587a9ec19eb3543b1c1bc54a8ded">DAG_scene_sort</a>(bmain, sce);
<a name="l00595"></a>00595 
<a name="l00596"></a>00596     <span class="comment">/* copy layers and flags from bases to objects */</span>
<a name="l00597"></a>00597     <span class="keywordflow">for</span> (base= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; base; base= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l00598"></a>00598         ob= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l00599"></a>00599         ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a>= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a>;
<a name="l00600"></a>00600         
<a name="l00601"></a>00601         <span class="comment">/* group patch... */</span>
<a name="l00602"></a>00602         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a> &amp;= ~(<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a9588748603be4778a9197f7edbf356d4">OB_FROMGROUP</a>);
<a name="l00603"></a>00603         flag= ob-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a> &amp; (<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a9588748603be4778a9197f7edbf356d4">OB_FROMGROUP</a>);
<a name="l00604"></a>00604         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a> |= flag;
<a name="l00605"></a>00605         
<a name="l00606"></a>00606         <span class="comment">/* not too nice... for recovering objects with lost data */</span>
<a name="l00607"></a>00607         <span class="comment">//if (ob-&gt;pose==NULL) base-&gt;flag &amp;= ~OB_POSEMODE;</span>
<a name="l00608"></a>00608         ob-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a>= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a>;
<a name="l00609"></a>00609         
<a name="l00610"></a>00610         ob-&gt;<a class="code" href="../../de/de7/structObject.html#a81a9ef070fc54eaa82acbbb41c99d43e">ctime</a>= -1234567.0;  <span class="comment">/* force ipo to be calculated later */</span>
<a name="l00611"></a>00611     }
<a name="l00612"></a>00612     <span class="comment">/* no full animation update, this to enable render code to work (render code calls own animation updates) */</span>
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="comment">/* called from creator.c */</span>
<a name="l00616"></a><a class="code" href="../../d0/d13/scene_8c.html#a116ed805168b8d7bafd0e9a13c23bb4c">00616</a> <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#a706eabaa59d4610a5000810b0b8219d9">set_scene_name</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00617"></a>00617 {
<a name="l00618"></a>00618     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce= (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)<a class="code" href="../../d8/db1/BKE__library_8h.html#acb5f76f4bade78a03b7328ed4944c702">find_id</a>(<span class="stringliteral">&quot;SC&quot;</span>, name);
<a name="l00619"></a>00619     <span class="keywordflow">if</span> (sce) {
<a name="l00620"></a>00620         <a class="code" href="../../d8/d53/BKE__scene_8h.html#a2786d63921fc3176178dfaa36b5c814e">set_scene_bg</a>(bmain, sce);
<a name="l00621"></a>00621         printf(<span class="stringliteral">&quot;Scene switch: &#39;%s&#39; in file: &#39;%s&#39;\n&quot;</span>, name, <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name);
<a name="l00622"></a>00622         <span class="keywordflow">return</span> sce;
<a name="l00623"></a>00623     }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     printf(<span class="stringliteral">&quot;Can&#39;t find scene: &#39;%s&#39; in file: &#39;%s&#39;\n&quot;</span>, name, <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name);
<a name="l00626"></a>00626     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00627"></a>00627 }
<a name="l00628"></a>00628 
<a name="l00629"></a><a class="code" href="../../d0/d13/scene_8c.html#a95ecdedea72ca275c28954c808a3b008">00629</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a536471d259149fb46e69fb9d04c2c884">unlink_scene</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *newsce)
<a name="l00630"></a>00630 {
<a name="l00631"></a>00631     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce1;
<a name="l00632"></a>00632     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc;
<a name="l00633"></a>00633 
<a name="l00634"></a>00634     <span class="comment">/* check all sets */</span>
<a name="l00635"></a>00635     <span class="keywordflow">for</span> (sce1= bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a976062774f867fa0f917c23f2ec331bb">scene</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sce1; sce1= sce1-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00636"></a>00636         <span class="keywordflow">if</span> (sce1-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a> == sce)
<a name="l00637"></a>00637             sce1-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00638"></a>00638     
<a name="l00639"></a>00639     <span class="comment">/* check all sequences */</span>
<a name="l00640"></a>00640     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a5b174cf21b2e1ad7284d1e6ee6276b54">clear_scene_in_allseqs</a>(bmain, sce);
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     <span class="comment">/* check render layer nodes in other scenes */</span>
<a name="l00643"></a>00643     <a class="code" href="../../d4/d91/BKE__node_8h.html#a259f4d799ba3a86f66b034c9d4693d3c">clear_scene_in_nodes</a>(bmain, sce);
<a name="l00644"></a>00644     
<a name="l00645"></a>00645     <span class="comment">/* al screens */</span>
<a name="l00646"></a>00646     <span class="keywordflow">for</span> (sc= bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a3ab31640766afea3c151a816eb70e691">screen</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sc; sc= sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ac661d280cae6952ebc9f9c95279cf6f2">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00647"></a>00647         <span class="keywordflow">if</span> (sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#a98cbd326f3b4179f769d007556e14999">scene</a> == sce)
<a name="l00648"></a>00648             sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#a98cbd326f3b4179f769d007556e14999">scene</a>= newsce;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650     <a class="code" href="../../d8/db1/BKE__library_8h.html#abdc66d0c4d8e9f6594809313b34d2843">free_libblock</a>(&amp;bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a976062774f867fa0f917c23f2ec331bb">scene</a>, sce);
<a name="l00651"></a>00651 }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 <span class="comment">/* used by metaballs</span>
<a name="l00654"></a>00654 <span class="comment"> * doesnt return the original duplicated object, only dupli&#39;s</span>
<a name="l00655"></a>00655 <span class="comment"> */</span>
<a name="l00656"></a><a class="code" href="../../d0/d13/scene_8c.html#abcf1b1c8082249dceea9a2979882cebe">00656</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#aa1af4746ec37edeb9615a009f268ff41">next_object</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> **scene, <span class="keywordtype">int</span> val, <a class="code" href="../../d3/da9/structBase.html">Base</a> **base, <a class="code" href="../../de/de7/structObject.html">Object</a> **ob)
<a name="l00657"></a>00657 {
<a name="l00658"></a>00658     <span class="keyword">static</span> <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *duplilist= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00659"></a>00659     <span class="keyword">static</span> <a class="code" href="../../d5/d47/structDupliObject.html">DupliObject</a> *dupob;
<a name="l00660"></a>00660     <span class="keyword">static</span> <span class="keywordtype">int</span> fase= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a50cdbc67fe2e5f6a1eb98bd12b8dfe3d">F_START</a>, in_next_object= 0;
<a name="l00661"></a>00661     <span class="keywordtype">int</span> run_again=1;
<a name="l00662"></a>00662     
<a name="l00663"></a>00663     <span class="comment">/* init */</span>
<a name="l00664"></a>00664     <span class="keywordflow">if</span> (val==0) {
<a name="l00665"></a>00665         fase= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a50cdbc67fe2e5f6a1eb98bd12b8dfe3d">F_START</a>;
<a name="l00666"></a>00666         dupob= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00667"></a>00667         
<a name="l00668"></a>00668         <span class="comment">/* XXX particle systems with metas+dupligroups call this recursively */</span>
<a name="l00669"></a>00669         <span class="comment">/* see bug #18725 */</span>
<a name="l00670"></a>00670         <span class="keywordflow">if</span> (in_next_object) {
<a name="l00671"></a>00671             printf(<span class="stringliteral">&quot;ERROR: Metaball generation called recursively, not supported\n&quot;</span>);
<a name="l00672"></a>00672             
<a name="l00673"></a>00673             <span class="keywordflow">return</span> <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a23288b0a29c27bdbd6455c9adcef89e6">F_ERROR</a>;
<a name="l00674"></a>00674         }
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676     <span class="keywordflow">else</span> {
<a name="l00677"></a>00677         in_next_object= 1;
<a name="l00678"></a>00678         
<a name="l00679"></a>00679         <span class="comment">/* run_again is set when a duplilist has been ended */</span>
<a name="l00680"></a>00680         <span class="keywordflow">while</span> (run_again) {
<a name="l00681"></a>00681             run_again= 0;
<a name="l00682"></a>00682 
<a name="l00683"></a>00683             <span class="comment">/* the first base */</span>
<a name="l00684"></a>00684             <span class="keywordflow">if</span> (fase==<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a50cdbc67fe2e5f6a1eb98bd12b8dfe3d">F_START</a>) {
<a name="l00685"></a>00685                 *base= (*scene)-&gt;base.first;
<a name="l00686"></a>00686                 <span class="keywordflow">if</span> (*base) {
<a name="l00687"></a>00687                     *ob= (*base)-&gt;object;
<a name="l00688"></a>00688                     fase= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aa280577ddd432dc4ece959692a742e46">F_SCENE</a>;
<a name="l00689"></a>00689                 }
<a name="l00690"></a>00690                 <span class="keywordflow">else</span> {
<a name="l00691"></a>00691                     <span class="comment">/* exception: empty scene */</span>
<a name="l00692"></a>00692                     <span class="keywordflow">while</span> ((*scene)-&gt;set) {
<a name="l00693"></a>00693                         (*scene)= (*scene)-&gt;set;
<a name="l00694"></a>00694                         <span class="keywordflow">if</span> ((*scene)-&gt;base.first) {
<a name="l00695"></a>00695                             *base= (*scene)-&gt;base.first;
<a name="l00696"></a>00696                             *ob= (*base)-&gt;object;
<a name="l00697"></a>00697                             fase= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aa280577ddd432dc4ece959692a742e46">F_SCENE</a>;
<a name="l00698"></a>00698                             <span class="keywordflow">break</span>;
<a name="l00699"></a>00699                         }
<a name="l00700"></a>00700                     }
<a name="l00701"></a>00701                 }
<a name="l00702"></a>00702             }
<a name="l00703"></a>00703             <span class="keywordflow">else</span> {
<a name="l00704"></a>00704                 <span class="keywordflow">if</span> (*base &amp;&amp; fase!=<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#add81cfffa39bfb9ffeb7ce2fe0d1481e">F_DUPLI</a>) {
<a name="l00705"></a>00705                     *base= (*base)-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l00706"></a>00706                     <span class="keywordflow">if</span> (*base) *ob= (*base)-&gt;object;
<a name="l00707"></a>00707                     <span class="keywordflow">else</span> {
<a name="l00708"></a>00708                         <span class="keywordflow">if</span> (fase==<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aa280577ddd432dc4ece959692a742e46">F_SCENE</a>) {
<a name="l00709"></a>00709                             <span class="comment">/* (*scene) is finished, now do the set */</span>
<a name="l00710"></a>00710                             <span class="keywordflow">while</span> ((*scene)-&gt;set) {
<a name="l00711"></a>00711                                 (*scene)= (*scene)-&gt;set;
<a name="l00712"></a>00712                                 <span class="keywordflow">if</span> ((*scene)-&gt;base.first) {
<a name="l00713"></a>00713                                     *base= (*scene)-&gt;base.first;
<a name="l00714"></a>00714                                     *ob= (*base)-&gt;object;
<a name="l00715"></a>00715                                     <span class="keywordflow">break</span>;
<a name="l00716"></a>00716                                 }
<a name="l00717"></a>00717                             }
<a name="l00718"></a>00718                         }
<a name="l00719"></a>00719                     }
<a name="l00720"></a>00720                 }
<a name="l00721"></a>00721             }
<a name="l00722"></a>00722             
<a name="l00723"></a>00723             <span class="keywordflow">if</span> (*base == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) fase= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a50cdbc67fe2e5f6a1eb98bd12b8dfe3d">F_START</a>;
<a name="l00724"></a>00724             <span class="keywordflow">else</span> {
<a name="l00725"></a>00725                 <span class="keywordflow">if</span> (fase!=<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#add81cfffa39bfb9ffeb7ce2fe0d1481e">F_DUPLI</a>) {
<a name="l00726"></a>00726                     <span class="keywordflow">if</span> ( (*base)-&gt;object-&gt;transflag &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a09b56b47e42a59a4266c995ded542ea6">OB_DUPLI</a>) {
<a name="l00727"></a>00727                         <span class="comment">/* groups cannot be duplicated for mballs yet, </span>
<a name="l00728"></a>00728 <span class="comment">                         * this enters eternal loop because of </span>
<a name="l00729"></a>00729 <span class="comment">                         * makeDispListMBall getting called inside of group_duplilist */</span>
<a name="l00730"></a>00730                         <span class="keywordflow">if</span> ((*base)-&gt;object-&gt;dup_group == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00731"></a>00731                             duplilist= <a class="code" href="../../df/dd0/BKE__anim_8h.html#a8e20fdaf71c0bc4466b67ec835807bbf">object_duplilist</a>((*scene), (*base)-&gt;object);
<a name="l00732"></a>00732                             
<a name="l00733"></a>00733                             dupob= duplilist-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00734"></a>00734 
<a name="l00735"></a>00735                             <span class="keywordflow">if</span> (!dupob)
<a name="l00736"></a>00736                                 <a class="code" href="../../df/dd0/BKE__anim_8h.html#a6e75b271f0e0049858eadb8122d87626">free_object_duplilist</a>(duplilist);
<a name="l00737"></a>00737                         }
<a name="l00738"></a>00738                     }
<a name="l00739"></a>00739                 }
<a name="l00740"></a>00740                 <span class="comment">/* handle dupli&#39;s */</span>
<a name="l00741"></a>00741                 <span class="keywordflow">if</span> (dupob) {
<a name="l00742"></a>00742                     
<a name="l00743"></a>00743                     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a54d4323b3d706eb2ad167e9551ba4414">copy_m4_m4</a>(dupob-&gt;<a class="code" href="../../d5/d47/structDupliObject.html#af01d1a6578e81fc3b06c31d41aecbc28">ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, dupob-&gt;<a class="code" href="../../d5/d47/structDupliObject.html#a30eca7be3df2308e3e320b7e80159689">mat</a>);
<a name="l00744"></a>00744                     
<a name="l00745"></a>00745                     (*base)-&gt;flag |= <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ac31d50d415c660a44c0ccdc6b4854721">OB_FROMDUPLI</a>;
<a name="l00746"></a>00746                     *ob= dupob-&gt;<a class="code" href="../../d5/d47/structDupliObject.html#af01d1a6578e81fc3b06c31d41aecbc28">ob</a>;
<a name="l00747"></a>00747                     fase= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#add81cfffa39bfb9ffeb7ce2fe0d1481e">F_DUPLI</a>;
<a name="l00748"></a>00748                     
<a name="l00749"></a>00749                     dupob= dupob-&gt;<a class="code" href="../../d5/d47/structDupliObject.html#af87591f8d98950df0cb823aaf5775877">next</a>;
<a name="l00750"></a>00750                 }
<a name="l00751"></a>00751                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fase==<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#add81cfffa39bfb9ffeb7ce2fe0d1481e">F_DUPLI</a>) {
<a name="l00752"></a>00752                     fase= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aa280577ddd432dc4ece959692a742e46">F_SCENE</a>;
<a name="l00753"></a>00753                     (*base)-&gt;flag &amp;= ~<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ac31d50d415c660a44c0ccdc6b4854721">OB_FROMDUPLI</a>;
<a name="l00754"></a>00754                     
<a name="l00755"></a>00755                     <span class="keywordflow">for</span> (dupob= duplilist-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; dupob; dupob= dupob-&gt;<a class="code" href="../../d5/d47/structDupliObject.html#af87591f8d98950df0cb823aaf5775877">next</a>) {
<a name="l00756"></a>00756                         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a54d4323b3d706eb2ad167e9551ba4414">copy_m4_m4</a>(dupob-&gt;<a class="code" href="../../d5/d47/structDupliObject.html#af01d1a6578e81fc3b06c31d41aecbc28">ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, dupob-&gt;<a class="code" href="../../d5/d47/structDupliObject.html#af547c5e7af68fd96cdfa4614bd77d47e">omat</a>);
<a name="l00757"></a>00757                     }
<a name="l00758"></a>00758                     
<a name="l00759"></a>00759                     <a class="code" href="../../df/dd0/BKE__anim_8h.html#a6e75b271f0e0049858eadb8122d87626">free_object_duplilist</a>(duplilist);
<a name="l00760"></a>00760                     duplilist= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00761"></a>00761                     run_again= 1;
<a name="l00762"></a>00762                 }
<a name="l00763"></a>00763             }
<a name="l00764"></a>00764         }
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767 <span class="preprocessor">#if 0</span>
<a name="l00768"></a>00768 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (ob &amp;&amp; *ob) {
<a name="l00769"></a>00769         printf(<span class="stringliteral">&quot;Scene: &#39;%s&#39;, &#39;%s&#39;\n&quot;</span>, (*scene)-&gt;id.name+2, (*ob)-&gt;id.name+2);
<a name="l00770"></a>00770     }
<a name="l00771"></a>00771 <span class="preprocessor">#endif</span>
<a name="l00772"></a>00772 <span class="preprocessor"></span>
<a name="l00773"></a>00773     <span class="comment">/* reset recursion test */</span>
<a name="l00774"></a>00774     in_next_object= 0;
<a name="l00775"></a>00775     
<a name="l00776"></a>00776     <span class="keywordflow">return</span> fase;
<a name="l00777"></a>00777 }
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="../../d0/d13/scene_8c.html#a0413b5113536a53c61b1088e18b2507b">00779</a> <a class="code" href="../../de/de7/structObject.html">Object</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#abb034059e60f19f508f88bc867e01760">scene_find_camera</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sc)
<a name="l00780"></a>00780 {
<a name="l00781"></a>00781     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00782"></a>00782     
<a name="l00783"></a>00783     <span class="keywordflow">for</span> (base= sc-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; base; base= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>)
<a name="l00784"></a>00784         <span class="keywordflow">if</span> (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#afd7fa4376c670f245aeed7a7116c7005">OB_CAMERA</a>)
<a name="l00785"></a>00785             <span class="keywordflow">return</span> base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00788"></a>00788 }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790 <span class="preprocessor">#ifdef DURIAN_CAMERA_SWITCH</span>
<a name="l00791"></a>00791 <span class="preprocessor"></span><a class="code" href="../../de/de7/structObject.html">Object</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1edcb8a9d2580801dc0879c52cc3c23">scene_camera_switch_find</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00792"></a>00792 {
<a name="l00793"></a>00793     <a class="code" href="../../d2/d3e/structTimeMarker.html">TimeMarker</a> *m;
<a name="l00794"></a>00794     <span class="keywordtype">int</span> cfra = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>;
<a name="l00795"></a>00795     <span class="keywordtype">int</span> frame = -(<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a> + 1);
<a name="l00796"></a>00796     <a class="code" href="../../de/de7/structObject.html">Object</a> *camera= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="keywordflow">for</span> (m= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad75df026c409d765b297e18f988b9d93">markers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; m; m= m-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#ae24b020d13fed8c505c8c6405e31d6a6">next</a>) {
<a name="l00799"></a>00799         <span class="keywordflow">if</span> (m-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a59288a08cb5faa51652fc302366feeab">camera</a> &amp;&amp; (m-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a59288a08cb5faa51652fc302366feeab">camera</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ab94b52225b1bb3d5083e9855b32902d0">OB_RESTRICT_RENDER</a>)==0 &amp;&amp; (m-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a> &lt;= cfra) &amp;&amp; (m-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a> &gt; frame)) {
<a name="l00800"></a>00800             camera= m-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a59288a08cb5faa51652fc302366feeab">camera</a>;
<a name="l00801"></a>00801             frame= m-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a>;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803             <span class="keywordflow">if</span> (frame == cfra)
<a name="l00804"></a>00804                 <span class="keywordflow">break</span>;
<a name="l00805"></a>00805 
<a name="l00806"></a>00806         }
<a name="l00807"></a>00807     }
<a name="l00808"></a>00808     <span class="keywordflow">return</span> camera;
<a name="l00809"></a>00809 }
<a name="l00810"></a>00810 <span class="preprocessor">#endif</span>
<a name="l00811"></a>00811 <span class="preprocessor"></span>
<a name="l00812"></a><a class="code" href="../../d0/d13/scene_8c.html#aed8ceca5d69f2f7f07f0b64e532cc3e3">00812</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a8ad1fb79420724f8a8750df3767b8cf7">scene_camera_switch_update</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00813"></a>00813 {
<a name="l00814"></a>00814 <span class="preprocessor">#ifdef DURIAN_CAMERA_SWITCH</span>
<a name="l00815"></a>00815 <span class="preprocessor"></span>    <a class="code" href="../../de/de7/structObject.html">Object</a> *camera= <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1edcb8a9d2580801dc0879c52cc3c23">scene_camera_switch_find</a>(scene);
<a name="l00816"></a>00816     <span class="keywordflow">if</span> (camera) {
<a name="l00817"></a>00817         scene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad050647276d4d850d127173450933107">camera</a>= camera;
<a name="l00818"></a>00818         <span class="keywordflow">return</span> 1;
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820 <span class="preprocessor">#else</span>
<a name="l00821"></a>00821 <span class="preprocessor"></span>    (void)scene;
<a name="l00822"></a>00822 <span class="preprocessor">#endif</span>
<a name="l00823"></a>00823 <span class="preprocessor"></span>    <span class="keywordflow">return</span> 0;
<a name="l00824"></a>00824 }
<a name="l00825"></a>00825 
<a name="l00826"></a><a class="code" href="../../d0/d13/scene_8c.html#a4794bd817c86292df7ad0f23423088cc">00826</a> <span class="keywordtype">char</span> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#a445f2eea7e4e6bae699e484d61e49838">scene_find_marker_name</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> frame)
<a name="l00827"></a>00827 {
<a name="l00828"></a>00828     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *markers= &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad75df026c409d765b297e18f988b9d93">markers</a>;
<a name="l00829"></a>00829     <a class="code" href="../../d2/d3e/structTimeMarker.html">TimeMarker</a> *m1, *m2;
<a name="l00830"></a>00830 
<a name="l00831"></a>00831     <span class="comment">/* search through markers for match */</span>
<a name="l00832"></a>00832     <span class="keywordflow">for</span> (m1=markers-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>, m2=markers-&gt;<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>; m1 &amp;&amp; m2; m1=m1-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#ae24b020d13fed8c505c8c6405e31d6a6">next</a>, m2=m2-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a215947af81eab6cb2334f6198bf80f6c">prev</a>) {
<a name="l00833"></a>00833         <span class="keywordflow">if</span> (m1-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a>==frame)
<a name="l00834"></a>00834             <span class="keywordflow">return</span> m1-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a089fa2176ee0f26a588e016cebb882ec">name</a>;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836         <span class="keywordflow">if</span> (m1 == m2)
<a name="l00837"></a>00837             <span class="keywordflow">break</span>;
<a name="l00838"></a>00838 
<a name="l00839"></a>00839         <span class="keywordflow">if</span> (m2-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a>==frame)
<a name="l00840"></a>00840             <span class="keywordflow">return</span> m2-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a089fa2176ee0f26a588e016cebb882ec">name</a>;
<a name="l00841"></a>00841     }
<a name="l00842"></a>00842 
<a name="l00843"></a>00843     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00844"></a>00844 }
<a name="l00845"></a>00845 
<a name="l00846"></a>00846 <span class="comment">/* return the current marker for this frame,</span>
<a name="l00847"></a>00847 <span class="comment"> * we can have more then 1 marker per frame, this just returns the first :/ */</span>
<a name="l00848"></a><a class="code" href="../../d0/d13/scene_8c.html#a0daca389fbe77194b128489d1177ade6">00848</a> <span class="keywordtype">char</span> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#a4fc132ae34930cbf120129d0ce0f425c">scene_find_last_marker_name</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> frame)
<a name="l00849"></a>00849 {
<a name="l00850"></a>00850     <a class="code" href="../../d2/d3e/structTimeMarker.html">TimeMarker</a> *marker, *best_marker = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00851"></a>00851     <span class="keywordtype">int</span> best_frame = -<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a>*2;
<a name="l00852"></a>00852     <span class="keywordflow">for</span> (marker= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad75df026c409d765b297e18f988b9d93">markers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; marker; marker= marker-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#ae24b020d13fed8c505c8c6405e31d6a6">next</a>) {
<a name="l00853"></a>00853         <span class="keywordflow">if</span> (marker-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a>==frame) {
<a name="l00854"></a>00854             <span class="keywordflow">return</span> marker-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a089fa2176ee0f26a588e016cebb882ec">name</a>;
<a name="l00855"></a>00855         }
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         <span class="keywordflow">if</span> ( marker-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a> &gt; best_frame &amp;&amp; marker-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a> &lt; frame) {
<a name="l00858"></a>00858             best_marker = marker;
<a name="l00859"></a>00859             best_frame = marker-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a63f34b0e44a21b9e0a7d43d8cbc44700">frame</a>;
<a name="l00860"></a>00860         }
<a name="l00861"></a>00861     }
<a name="l00862"></a>00862 
<a name="l00863"></a>00863     <span class="keywordflow">return</span> best_marker ? best_marker-&gt;<a class="code" href="../../d2/d3e/structTimeMarker.html#a089fa2176ee0f26a588e016cebb882ec">name</a> : <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00864"></a>00864 }
<a name="l00865"></a>00865 
<a name="l00866"></a>00866 
<a name="l00867"></a><a class="code" href="../../d0/d13/scene_8c.html#aa0ff01ca12471c16b074be69da6c0276">00867</a> <a class="code" href="../../d3/da9/structBase.html">Base</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#a193ea92ce1fbcb89b8320ed73463819b">scene_add_base</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob)
<a name="l00868"></a>00868 {
<a name="l00869"></a>00869     <a class="code" href="../../d3/da9/structBase.html">Base</a> *b= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(*b), <span class="stringliteral">&quot;scene_add_base&quot;</span>);
<a name="l00870"></a>00870     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>, b);
<a name="l00871"></a>00871 
<a name="l00872"></a>00872     b-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>= ob;
<a name="l00873"></a>00873     b-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a>= ob-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a>;
<a name="l00874"></a>00874     b-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a>= ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a>;
<a name="l00875"></a>00875 
<a name="l00876"></a>00876     <span class="keywordflow">return</span> b;
<a name="l00877"></a>00877 }
<a name="l00878"></a>00878 
<a name="l00879"></a><a class="code" href="../../d0/d13/scene_8c.html#a09dd186dce8d76e8535c19afbce516bf">00879</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac2e80ba6ed63182218a0ba58c1f5d93e">scene_deselect_all</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce)
<a name="l00880"></a>00880 {
<a name="l00881"></a>00881     <a class="code" href="../../d3/da9/structBase.html">Base</a> *b;
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="keywordflow">for</span> (b= sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; b; b= b-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l00884"></a>00884         b-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a>&amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00885"></a>00885         b-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a>= b-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a>;
<a name="l00886"></a>00886     }
<a name="l00887"></a>00887 }
<a name="l00888"></a>00888 
<a name="l00889"></a><a class="code" href="../../d0/d13/scene_8c.html#a4ba111637fd70e3bd99ee0a18783a1ec">00889</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#ad9094ed96798e2a0cd46025c43ad0098">scene_select_base</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <a class="code" href="../../d3/da9/structBase.html">Base</a> *selbase)
<a name="l00890"></a>00890 {
<a name="l00891"></a>00891     <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac2e80ba6ed63182218a0ba58c1f5d93e">scene_deselect_all</a>(sce);
<a name="l00892"></a>00892 
<a name="l00893"></a>00893     selbase-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00894"></a>00894     selbase-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a>= selbase-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a>;
<a name="l00895"></a>00895 
<a name="l00896"></a>00896     sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a040bbb56eb7746d04c4ae455e5b1c638">basact</a>= selbase;
<a name="l00897"></a>00897 }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899 <span class="comment">/* checks for cycle, returns 1 if it&#39;s all OK */</span>
<a name="l00900"></a><a class="code" href="../../d0/d13/scene_8c.html#a1cfea0649867fefe3b03b548fb7bb527">00900</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a770159f5de9ca2d775ae3058a5b73cd0">scene_check_setscene</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce)
<a name="l00901"></a>00901 {
<a name="l00902"></a>00902     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene;
<a name="l00903"></a>00903     <span class="keywordtype">int</span> a, totscene;
<a name="l00904"></a>00904     
<a name="l00905"></a>00905     <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 1;
<a name="l00906"></a>00906     
<a name="l00907"></a>00907     totscene= 0;
<a name="l00908"></a>00908     <span class="keywordflow">for</span> (scene= bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a976062774f867fa0f917c23f2ec331bb">scene</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; scene; scene= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l00909"></a>00909         totscene++;
<a name="l00910"></a>00910     
<a name="l00911"></a>00911     <span class="keywordflow">for</span> (a=0, scene=sce; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>; scene=scene-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>, a++) {
<a name="l00912"></a>00912         <span class="comment">/* more iterations than scenes means we have a cycle */</span>
<a name="l00913"></a>00913         <span class="keywordflow">if</span> (a &gt; totscene) {
<a name="l00914"></a>00914             <span class="comment">/* the tested scene gets zero&#39;ed, that&#39;s typically current scene */</span>
<a name="l00915"></a>00915             sce-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00916"></a>00916             <span class="keywordflow">return</span> 0;
<a name="l00917"></a>00917         }
<a name="l00918"></a>00918     }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920     <span class="keywordflow">return</span> 1;
<a name="l00921"></a>00921 }
<a name="l00922"></a>00922 
<a name="l00923"></a>00923 <span class="comment">/* This function is needed to cope with fractional frames - including two Blender rendering features</span>
<a name="l00924"></a>00924 <span class="comment"> * mblur (motion blur that renders &#39;subframes&#39; and blurs them together), and fields rendering. </span>
<a name="l00925"></a>00925 <span class="comment"> */</span>
<a name="l00926"></a><a class="code" href="../../d0/d13/scene_8c.html#a83e721af72be0de8a7d78fc51d79821b">00926</a> <span class="keywordtype">float</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#aa1d515c11776decf154b4b1684408586">BKE_curframe</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00927"></a>00927 {
<a name="l00928"></a>00928     <span class="keywordflow">return</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a1e54633ecd61cd6275ecbe94ab341c2f">BKE_frame_to_ctime</a>(scene, scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>);
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 
<a name="l00931"></a>00931 <span class="comment">/* This function is used to obtain arbitrary fractional frames */</span>
<a name="l00932"></a><a class="code" href="../../d0/d13/scene_8c.html#a2cd51627a58243c9882f662f7425547c">00932</a> <span class="keywordtype">float</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a1e54633ecd61cd6275ecbe94ab341c2f">BKE_frame_to_ctime</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <span class="keyword">const</span> <span class="keywordtype">float</span> frame)
<a name="l00933"></a>00933 {
<a name="l00934"></a>00934     <span class="keywordtype">float</span> ctime = frame;
<a name="l00935"></a>00935     ctime += scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a1b2f8b32641bb4d043a3c8c820a6755d">subframe</a>;
<a name="l00936"></a>00936     ctime *= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4399e01a91c6ca3e1259887c82ea0972">framelen</a>; 
<a name="l00937"></a>00937     
<a name="l00938"></a>00938     <span class="keywordflow">return</span> ctime;
<a name="l00939"></a>00939 }
<a name="l00940"></a>00940 
<a name="l00941"></a>00941 <span class="comment">/* drivers support/hacks </span>
<a name="l00942"></a>00942 <span class="comment"> *  - this method is called from scene_update_tagged_recursive(), so gets included in viewport + render</span>
<a name="l00943"></a>00943 <span class="comment"> *  - these are always run since the depsgraph can&#39;t handle non-object data</span>
<a name="l00944"></a>00944 <span class="comment"> *  - these happen after objects are all done so that we can read in their final transform values,</span>
<a name="l00945"></a>00945 <span class="comment"> *    though this means that objects can&#39;t refer to scene info for guidance...</span>
<a name="l00946"></a>00946 <span class="comment"> */</span>
<a name="l00947"></a><a class="code" href="../../d0/d13/scene_8c.html#abbfec8b8f4671c258259d256deebac55">00947</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d13/scene_8c.html#abbfec8b8f4671c258259d256deebac55">scene_update_drivers</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(bmain), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00948"></a>00948 {
<a name="l00949"></a>00949     <span class="keywordtype">float</span> ctime = <a class="code" href="../../d8/d53/BKE__scene_8h.html#aa1d515c11776decf154b4b1684408586">BKE_curframe</a>(scene);
<a name="l00950"></a>00950     
<a name="l00951"></a>00951     <span class="comment">/* scene itself */</span>
<a name="l00952"></a>00952     <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#abdea91c45720e729d4fd49b37fee664e">adt</a> &amp;&amp; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#abdea91c45720e729d4fd49b37fee664e">adt</a>-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#aaca565f031ee1209087422d8a5d77769">drivers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) {
<a name="l00953"></a>00953         <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a0e72e8e868390e4ad0e7efe64499a207">BKE_animsys_evaluate_animdata</a>(scene, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, scene-&gt;<a class="code" href="../../d9/d27/structScene.html#abdea91c45720e729d4fd49b37fee664e">adt</a>, ctime, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a7cc2212e3e0823a3ce68c0ada63fdca8af8b60644f7baff691944ebfdb8b39d03">ADT_RECALC_DRIVERS</a>);
<a name="l00954"></a>00954     }
<a name="l00955"></a>00955     
<a name="l00956"></a>00956     <span class="comment">/* world */</span>
<a name="l00957"></a>00957     <span class="comment">// TODO: what about world textures? but then those have nodes too...</span>
<a name="l00958"></a>00958     <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aefac18ed3d1ded63b012f79a3ca8ddb2">world</a>) {
<a name="l00959"></a>00959         <a class="code" href="../../d8/d7e/structID.html">ID</a> *wid = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aefac18ed3d1ded63b012f79a3ca8ddb2">world</a>;
<a name="l00960"></a>00960         <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(wid);
<a name="l00961"></a>00961         
<a name="l00962"></a>00962         <span class="keywordflow">if</span> (adt &amp;&amp; adt-&gt;drivers.first)
<a name="l00963"></a>00963             <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a0e72e8e868390e4ad0e7efe64499a207">BKE_animsys_evaluate_animdata</a>(scene, wid, adt, ctime, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a7cc2212e3e0823a3ce68c0ada63fdca8af8b60644f7baff691944ebfdb8b39d03">ADT_RECALC_DRIVERS</a>);
<a name="l00964"></a>00964     }
<a name="l00965"></a>00965     
<a name="l00966"></a>00966     <span class="comment">/* nodes */</span>
<a name="l00967"></a>00967     <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>) {
<a name="l00968"></a>00968         <a class="code" href="../../d8/d7e/structID.html">ID</a> *nid = (<a class="code" href="../../d8/d7e/structID.html">ID</a> *)scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>;
<a name="l00969"></a>00969         <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(nid);
<a name="l00970"></a>00970         
<a name="l00971"></a>00971         <span class="keywordflow">if</span> (adt &amp;&amp; adt-&gt;drivers.first)
<a name="l00972"></a>00972             <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a0e72e8e868390e4ad0e7efe64499a207">BKE_animsys_evaluate_animdata</a>(scene, nid, adt, ctime, <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a7cc2212e3e0823a3ce68c0ada63fdca8af8b60644f7baff691944ebfdb8b39d03">ADT_RECALC_DRIVERS</a>);
<a name="l00973"></a>00973     }
<a name="l00974"></a>00974 }
<a name="l00975"></a>00975 
<a name="l00976"></a><a class="code" href="../../d0/d13/scene_8c.html#a1fba8d56fd360a59f3227c07c78699e0">00976</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d13/scene_8c.html#a1fba8d56fd360a59f3227c07c78699e0">scene_update_tagged_recursive</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene_parent)
<a name="l00977"></a>00977 {
<a name="l00978"></a>00978     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00979"></a>00979     
<a name="l00980"></a>00980     
<a name="l00981"></a>00981     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a3a4f81e0f2023f6834ccb638ed26cd0c">customdata_mask</a>= scene_parent-&gt;<a class="code" href="../../d9/d27/structScene.html#a3a4f81e0f2023f6834ccb638ed26cd0c">customdata_mask</a>;
<a name="l00982"></a>00982 
<a name="l00983"></a>00983     <span class="comment">/* sets first, we allow per definition current scene to have</span>
<a name="l00984"></a>00984 <span class="comment">     * dependencies on sets, but not the other way around. */</span>
<a name="l00985"></a>00985     <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>)
<a name="l00986"></a>00986         <a class="code" href="../../d0/d13/scene_8c.html#a1fba8d56fd360a59f3227c07c78699e0">scene_update_tagged_recursive</a>(bmain, scene-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>, scene_parent);
<a name="l00987"></a>00987     
<a name="l00988"></a>00988     <span class="comment">/* scene objects */</span>
<a name="l00989"></a>00989     <span class="keywordflow">for</span> (base= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; base; base= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l00990"></a>00990         <a class="code" href="../../de/de7/structObject.html">Object</a> *ob= base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l00991"></a>00991         
<a name="l00992"></a>00992         <a class="code" href="../../df/dac/BKE__object_8h.html#aa3a62a478e6c8cc25d8d49fd0eb25c21">object_handle_update</a>(scene_parent, ob);
<a name="l00993"></a>00993         
<a name="l00994"></a>00994         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a3f0daef111a437533e48f6209429b49f">dup_group</a> &amp;&amp; (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a1091cd84d4d7227ab41b167e84be3065">transflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#aa1086c43316c4611714f7e459356873e">OB_DUPLIGROUP</a>))
<a name="l00995"></a>00995             <a class="code" href="../../d2/df5/BKE__group_8h.html#ac77aaca708f0b8fd44292e1604d30c87">group_handle_recalc_and_update</a>(scene_parent, ob, ob-&gt;<a class="code" href="../../de/de7/structObject.html#a3f0daef111a437533e48f6209429b49f">dup_group</a>);
<a name="l00996"></a>00996             
<a name="l00997"></a>00997         <span class="comment">/* always update layer, so that animating layers works */</span>
<a name="l00998"></a>00998         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a8c3a6cb18ff56393b617978c497c54aa">lay</a>= ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a>;
<a name="l00999"></a>00999     }
<a name="l01000"></a>01000     
<a name="l01001"></a>01001     <span class="comment">/* scene drivers... */</span>
<a name="l01002"></a>01002     <a class="code" href="../../d0/d13/scene_8c.html#abbfec8b8f4671c258259d256deebac55">scene_update_drivers</a>(bmain, scene);
<a name="l01003"></a>01003 
<a name="l01004"></a>01004     <span class="comment">/* update sound system animation */</span>
<a name="l01005"></a>01005     <a class="code" href="../../d2/db1/BKE__sound_8h.html#aa3f4dfa731fc4fa7cfc9d89b59de796b">sound_update_scene</a>(scene);
<a name="l01006"></a>01006 }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 <span class="comment">/* this is called in main loop, doing tagged updates before redraw */</span>
<a name="l01009"></a><a class="code" href="../../d0/d13/scene_8c.html#a4dfafad7394042dc48e4647f56e92258">01009</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#af5a89c5f90e68841a7f06e0239f6bcae">scene_update_tagged</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l01010"></a>01010 {
<a name="l01011"></a>01011     <span class="comment">/* keep this first */</span>
<a name="l01012"></a>01012     <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#ac00d81556a541d5b44cafe0ab7ecdb00">BLI_exec_cb</a>(bmain, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#a94b84005b164ad76c69f588c6500f13aaa8b695757a76f2a96bdb06cc769881b8">BLI_CB_EVT_SCENE_UPDATE_PRE</a>);
<a name="l01013"></a>01013 
<a name="l01014"></a>01014     <span class="comment">/* flush recalc flags to dependencies */</span>
<a name="l01015"></a>01015     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#ab873d6a825b9fbed4bceea816820c614">DAG_ids_flush_tagged</a>(bmain);
<a name="l01016"></a>01016 
<a name="l01017"></a>01017     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>.<a class="code" href="../../d6/d40/structPhysicsSettings.html#a616231d82a7300eb96690c86d6141bb3">quick_cache_step</a>= 0;
<a name="l01018"></a>01018 
<a name="l01019"></a>01019     <span class="comment">/* update all objects: drivers, matrices, displists, etc. flags set</span>
<a name="l01020"></a>01020 <span class="comment">     * by depgraph or manual, no layer check here, gets correct flushed</span>
<a name="l01021"></a>01021 <span class="comment">     *</span>
<a name="l01022"></a>01022 <span class="comment">     * in the future this should handle updates for all datablocks, not</span>
<a name="l01023"></a>01023 <span class="comment">     * only objects and scenes. - brecht */</span>
<a name="l01024"></a>01024     <a class="code" href="../../d0/d13/scene_8c.html#a1fba8d56fd360a59f3227c07c78699e0">scene_update_tagged_recursive</a>(bmain, scene, scene);
<a name="l01025"></a>01025 
<a name="l01026"></a>01026     <span class="comment">/* extra call here to recalc scene animation (for sequencer) */</span>
<a name="l01027"></a>01027     {
<a name="l01028"></a>01028         <a class="code" href="../../d1/d5c/structAnimData.html">AnimData</a> *adt= <a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>);
<a name="l01029"></a>01029         <span class="keywordtype">float</span> ctime = <a class="code" href="../../d8/d53/BKE__scene_8h.html#aa1d515c11776decf154b4b1684408586">BKE_curframe</a>(scene);
<a name="l01030"></a>01030         
<a name="l01031"></a>01031         <span class="keywordflow">if</span> (adt &amp;&amp; (adt-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#a5d3b8f8deeacc6da23fd6adc05ad60e3">recalc</a> &amp; <a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#a7cc2212e3e0823a3ce68c0ada63fdca8a1bce4262e3f1016c7b92e1ac709e4bec">ADT_RECALC_ANIM</a>))
<a name="l01032"></a>01032             <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a0e72e8e868390e4ad0e7efe64499a207">BKE_animsys_evaluate_animdata</a>(scene, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, adt, ctime, 0);
<a name="l01033"></a>01033     }
<a name="l01034"></a>01034     
<a name="l01035"></a>01035     <span class="comment">/* quick point cache updates */</span>
<a name="l01036"></a>01036     <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a2af54e63511dbe75e7b3c736288ed4d4">physics_settings</a>.<a class="code" href="../../d6/d40/structPhysicsSettings.html#a616231d82a7300eb96690c86d6141bb3">quick_cache_step</a>)
<a name="l01037"></a>01037         <a class="code" href="../../db/d45/BKE__pointcache_8h.html#a1e3e742d9a6cead7514f01fab86f5a84">BKE_ptcache_quick_cache_all</a>(bmain, scene);
<a name="l01038"></a>01038 
<a name="l01039"></a>01039     <span class="comment">/* notify editors and python about recalc */</span>
<a name="l01040"></a>01040     <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#ac00d81556a541d5b44cafe0ab7ecdb00">BLI_exec_cb</a>(bmain, &amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#a94b84005b164ad76c69f588c6500f13aa1f7982089acfa7fc3f6e239a96b952c8">BLI_CB_EVT_SCENE_UPDATE_POST</a>);
<a name="l01041"></a>01041     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#ab86848fbbcd34a5d9ab59c882b6a91f9">DAG_ids_check_recalc</a>(bmain, scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01042"></a>01042 
<a name="l01043"></a>01043     <span class="comment">/* clear recalc flags */</span>
<a name="l01044"></a>01044     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#ac9ece2ba2eac6aed8692e01dcee28d58">DAG_ids_clear_recalc</a>(bmain);
<a name="l01045"></a>01045 }
<a name="l01046"></a>01046 
<a name="l01047"></a>01047 <span class="comment">/* applies changes right away, does all sets too */</span>
<a name="l01048"></a><a class="code" href="../../d0/d13/scene_8c.html#aed62d306d80cbf691dc1289ade5422f9">01048</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#af6ab7bd3a6bb91b84e1b6cffc995640f">scene_update_for_newframe</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lay)
<a name="l01049"></a>01049 {
<a name="l01050"></a>01050     <span class="keywordtype">float</span> ctime = <a class="code" href="../../d8/d53/BKE__scene_8h.html#aa1d515c11776decf154b4b1684408586">BKE_curframe</a>(sce);
<a name="l01051"></a>01051     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce_iter;
<a name="l01052"></a>01052 
<a name="l01053"></a>01053     <span class="comment">/* keep this first */</span>
<a name="l01054"></a>01054     <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#ac00d81556a541d5b44cafe0ab7ecdb00">BLI_exec_cb</a>(bmain, &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#a94b84005b164ad76c69f588c6500f13aa733c7b2f8a633f4e43a8ea6cae7371ba">BLI_CB_EVT_FRAME_CHANGE_PRE</a>);
<a name="l01055"></a>01055     <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#ac00d81556a541d5b44cafe0ab7ecdb00">BLI_exec_cb</a>(bmain, &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#a94b84005b164ad76c69f588c6500f13aaa8b695757a76f2a96bdb06cc769881b8">BLI_CB_EVT_SCENE_UPDATE_PRE</a>);
<a name="l01056"></a>01056 
<a name="l01057"></a>01057     <a class="code" href="../../d2/db1/BKE__sound_8h.html#a50b7c68d297ab7cb41cc0fa72de427ca">sound_set_cfra</a>(sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>);
<a name="l01058"></a>01058     
<a name="l01059"></a>01059     <span class="comment">/* clear animation overrides */</span>
<a name="l01060"></a>01060     <span class="comment">// XXX TODO...</span>
<a name="l01061"></a>01061 
<a name="l01062"></a>01062     <span class="keywordflow">for</span> (sce_iter= sce; sce_iter; sce_iter= sce_iter-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>) {
<a name="l01063"></a>01063         <span class="keywordflow">if</span> (sce_iter-&gt;<a class="code" href="../../d9/d27/structScene.html#aa36a32a59b8c372076d113a5b532f6e4">theDag</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01064"></a>01064             <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a1916587a9ec19eb3543b1c1bc54a8ded">DAG_scene_sort</a>(bmain, sce_iter);
<a name="l01065"></a>01065     }
<a name="l01066"></a>01066 
<a name="l01067"></a>01067     <span class="comment">/* flush recalc flags to dependencies, if we were only changing a frame</span>
<a name="l01068"></a>01068 <span class="comment">     * this would not be necessary, but if a user or a script has modified</span>
<a name="l01069"></a>01069 <span class="comment">     * some datablock before scene_update_tagged was called, we need the flush */</span>
<a name="l01070"></a>01070     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#ab873d6a825b9fbed4bceea816820c614">DAG_ids_flush_tagged</a>(bmain);
<a name="l01071"></a>01071 
<a name="l01072"></a>01072     <span class="comment">/* Following 2 functions are recursive</span>
<a name="l01073"></a>01073 <span class="comment">     * so don&#39;t call within &#39;scene_update_tagged_recursive&#39; */</span>
<a name="l01074"></a>01074     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a876c6c937800c0e665b8e781abbaa65c">DAG_scene_update_flags</a>(bmain, sce, lay, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);   <span class="comment">// only stuff that moves or needs display still</span>
<a name="l01075"></a>01075 
<a name="l01076"></a>01076     <span class="comment">/* All &#39;standard&#39; (i.e. without any dependencies) animation is handled here,</span>
<a name="l01077"></a>01077 <span class="comment">     * with an &#39;local&#39; to &#39;macro&#39; order of evaluation. This should ensure that</span>
<a name="l01078"></a>01078 <span class="comment">     * settings stored nestled within a hierarchy (i.e. settings in a Texture block</span>
<a name="l01079"></a>01079 <span class="comment">     * can be overridden by settings from Scene, which owns the Texture through a hierarchy</span>
<a name="l01080"></a>01080 <span class="comment">     * such as Scene-&gt;World-&gt;MTex/Texture) can still get correctly overridden.</span>
<a name="l01081"></a>01081 <span class="comment">     */</span>
<a name="l01082"></a>01082     <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a7998bfa4c2a31552089478f154f9f8e0">BKE_animsys_evaluate_all_animation</a>(bmain, sce, ctime);
<a name="l01083"></a>01083     <span class="comment">/*...done with recusrive funcs */</span>
<a name="l01084"></a>01084 
<a name="l01085"></a>01085     <span class="comment">/* object_handle_update() on all objects, groups and sets */</span>
<a name="l01086"></a>01086     <a class="code" href="../../d0/d13/scene_8c.html#a1fba8d56fd360a59f3227c07c78699e0">scene_update_tagged_recursive</a>(bmain, sce, sce);
<a name="l01087"></a>01087 
<a name="l01088"></a>01088     <span class="comment">/* notify editors and python about recalc */</span>
<a name="l01089"></a>01089     <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#ac00d81556a541d5b44cafe0ab7ecdb00">BLI_exec_cb</a>(bmain, &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#a94b84005b164ad76c69f588c6500f13aa1f7982089acfa7fc3f6e239a96b952c8">BLI_CB_EVT_SCENE_UPDATE_POST</a>);
<a name="l01090"></a>01090     <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#ac00d81556a541d5b44cafe0ab7ecdb00">BLI_exec_cb</a>(bmain, &amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, <a class="code" href="../../d7/d46/BLI__callbacks_8h.html#a94b84005b164ad76c69f588c6500f13aaf175b92ea1ce3ff06f0905b481882c8a">BLI_CB_EVT_FRAME_CHANGE_POST</a>);
<a name="l01091"></a>01091 
<a name="l01092"></a>01092     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#ab86848fbbcd34a5d9ab59c882b6a91f9">DAG_ids_check_recalc</a>(bmain, sce, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01093"></a>01093 
<a name="l01094"></a>01094     <span class="comment">/* clear recalc flags */</span>
<a name="l01095"></a>01095     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#ac9ece2ba2eac6aed8692e01dcee28d58">DAG_ids_clear_recalc</a>(bmain);
<a name="l01096"></a>01096 }
<a name="l01097"></a>01097 
<a name="l01098"></a>01098 <span class="comment">/* return default layer, also used to patch old files */</span>
<a name="l01099"></a><a class="code" href="../../d0/d13/scene_8c.html#afc7ec9c19f02deb27982cbf801777c7f">01099</a> <a class="code" href="../../d1/d51/structSceneRenderLayer.html">SceneRenderLayer</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#ad5651ef0505139e68b2e8e385427cea0">scene_add_render_layer</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l01100"></a>01100 {
<a name="l01101"></a>01101     <a class="code" href="../../d1/d51/structSceneRenderLayer.html">SceneRenderLayer</a> *srl;
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     <span class="keywordflow">if</span> (!name)
<a name="l01104"></a>01104         name= <span class="stringliteral">&quot;RenderLayer&quot;</span>;
<a name="l01105"></a>01105 
<a name="l01106"></a>01106     srl= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d51/structSceneRenderLayer.html">SceneRenderLayer</a>), <span class="stringliteral">&quot;new render layer&quot;</span>);
<a name="l01107"></a>01107     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(srl-&gt;<a class="code" href="../../d1/d51/structSceneRenderLayer.html#afd4367d69e75f800a0feb539c8f71c0f">name</a>, name, <span class="keyword">sizeof</span>(srl-&gt;<a class="code" href="../../d1/d51/structSceneRenderLayer.html#afd4367d69e75f800a0feb539c8f71c0f">name</a>));
<a name="l01108"></a>01108     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a584e08e337965c8bb232cf7ff28a0e13">BLI_uniquename</a>(&amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>, srl, <span class="stringliteral">&quot;RenderLayer&quot;</span>, <span class="charliteral">&#39;.&#39;</span>, offsetof(<a class="code" href="../../d1/d51/structSceneRenderLayer.html">SceneRenderLayer</a>, name), <span class="keyword">sizeof</span>(srl-&gt;<a class="code" href="../../d1/d51/structSceneRenderLayer.html#afd4367d69e75f800a0feb539c8f71c0f">name</a>));
<a name="l01109"></a>01109     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;sce-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>, srl);
<a name="l01110"></a>01110 
<a name="l01111"></a>01111     <span class="comment">/* note, this is also in render, pipeline.c, to make layer when scenedata doesnt have it */</span>
<a name="l01112"></a>01112     srl-&gt;<a class="code" href="../../d1/d51/structSceneRenderLayer.html#add5911ed3ed1caae5224b8c063be6939">lay</a>= (1&lt;&lt;20) -1;
<a name="l01113"></a>01113     srl-&gt;<a class="code" href="../../d1/d51/structSceneRenderLayer.html#a2152a87154b064e13a9b335933505cc6">layflag</a>= 0x7FFF;   <span class="comment">/* solid ztra halo edge strand */</span>
<a name="l01114"></a>01114     srl-&gt;<a class="code" href="../../d1/d51/structSceneRenderLayer.html#a88f32fbd005f0f6204f0ed0ffc625b36">passflag</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a4e038919a7298d42281bcef6eef0840d">SCE_PASS_COMBINED</a>|<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a1ae908c61cd1d871b33f30bc2b16c13c">SCE_PASS_Z</a>;
<a name="l01115"></a>01115 
<a name="l01116"></a>01116     <span class="keywordflow">return</span> srl;
<a name="l01117"></a>01117 }
<a name="l01118"></a>01118 
<a name="l01119"></a><a class="code" href="../../d0/d13/scene_8c.html#a50fc9911413f0cba30c3c37686cdb932">01119</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a286c39380c6759f63e6de4aa307be902">scene_remove_render_layer</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d1/d51/structSceneRenderLayer.html">SceneRenderLayer</a> *srl)
<a name="l01120"></a>01120 {
<a name="l01121"></a>01121     <span class="keyword">const</span> <span class="keywordtype">int</span> act= <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a0a004822554284f0bb32fdc70cfeee1f">BLI_findindex</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>, srl);
<a name="l01122"></a>01122     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce;
<a name="l01123"></a>01123 
<a name="l01124"></a>01124     <span class="keywordflow">if</span> (act == -1) {
<a name="l01125"></a>01125         <span class="keywordflow">return</span> 0;
<a name="l01126"></a>01126     }
<a name="l01127"></a>01127     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> == scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>) &amp;&amp;
<a name="l01128"></a>01128               (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> == srl))
<a name="l01129"></a>01129     {
<a name="l01130"></a>01130         <span class="comment">/* ensure 1 layer is kept */</span>
<a name="l01131"></a>01131         <span class="keywordflow">return</span> 0;
<a name="l01132"></a>01132     }
<a name="l01133"></a>01133 
<a name="l01134"></a>01134     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a235b7b4bed2d2d73189d3e12c219672a">layers</a>, srl);
<a name="l01135"></a>01135     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(srl);
<a name="l01136"></a>01136 
<a name="l01137"></a>01137     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a74466739f51a2d037494278cd2c9dd97">actlay</a>= 0;
<a name="l01138"></a>01138 
<a name="l01139"></a>01139     <span class="keywordflow">for</span> (sce = bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a976062774f867fa0f917c23f2ec331bb">scene</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sce; sce = sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l01140"></a>01140         <span class="keywordflow">if</span> (sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>) {
<a name="l01141"></a>01141             <a class="code" href="../../dc/daa/structbNode.html">bNode</a> *node;
<a name="l01142"></a>01142             <span class="keywordflow">for</span> (node = sce-&gt;<a class="code" href="../../d9/d27/structScene.html#a09a194ec2fd08925c48b3d0a692bd14d">nodetree</a>-&gt;<a class="code" href="../../d9/da9/structbNodeTree.html#ac928f4eb3314d2b9ce2d9c6a49c1f233">nodes</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; node; node = node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a978093ed3cb2529e1f932bc8c5081968">next</a>) {
<a name="l01143"></a>01143                 <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a95416f774e5a5a27105522a1b74e5989">type</a>==<a class="code" href="../../d4/d91/BKE__node_8h.html#ad757ff9a25034f9e939a65aaea8d1cce">CMP_NODE_R_LAYERS</a> &amp;&amp; (<a class="code" href="../../d9/d27/structScene.html">Scene</a>*)node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a4054a28b64f94943286ab0e0df99afba">id</a>==scene) {
<a name="l01144"></a>01144                     <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a0a55bc501c3ee93e75427b84f309d9b7">custom1</a>==act)
<a name="l01145"></a>01145                         node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a0a55bc501c3ee93e75427b84f309d9b7">custom1</a>= 0;
<a name="l01146"></a>01146                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a0a55bc501c3ee93e75427b84f309d9b7">custom1</a>&gt;act)
<a name="l01147"></a>01147                         node-&gt;<a class="code" href="../../dc/daa/structbNode.html#a0a55bc501c3ee93e75427b84f309d9b7">custom1</a>--;
<a name="l01148"></a>01148                 }
<a name="l01149"></a>01149             }
<a name="l01150"></a>01150         }
<a name="l01151"></a>01151     }
<a name="l01152"></a>01152 
<a name="l01153"></a>01153     <span class="keywordflow">return</span> 1;
<a name="l01154"></a>01154 }
<a name="l01155"></a>01155 
<a name="l01156"></a>01156 <span class="comment">/* render simplification */</span>
<a name="l01157"></a>01157 
<a name="l01158"></a><a class="code" href="../../d0/d13/scene_8c.html#ab99f58683e474fa115980510b5c9bd6d">01158</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a5569680fe605835684a114ac08faf9eb">get_render_subsurf_level</a>(<a class="code" href="../../d3/d27/structRenderData.html">RenderData</a> *r, <span class="keywordtype">int</span> lvl)
<a name="l01159"></a>01159 {
<a name="l01160"></a>01160     <span class="keywordflow">if</span> (r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#ad4b607d22d4e5f4c2f92dda62358d664">mode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad445d144465b42b6486adb0297fd77f8">R_SIMPLIFY</a>)
<a name="l01161"></a>01161         <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#a12fa5e141ba422aa06aea847fc427b9b">simplify_subsurf</a>, lvl);
<a name="l01162"></a>01162     <span class="keywordflow">else</span>
<a name="l01163"></a>01163         <span class="keywordflow">return</span> lvl;
<a name="l01164"></a>01164 }
<a name="l01165"></a>01165 
<a name="l01166"></a><a class="code" href="../../d0/d13/scene_8c.html#a17f78ba8ec02b8ab30e374f19c01dcf8">01166</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a58d08c0421cb2decdec707e313ab26ed">get_render_child_particle_number</a>(<a class="code" href="../../d3/d27/structRenderData.html">RenderData</a> *r, <span class="keywordtype">int</span> num)
<a name="l01167"></a>01167 {
<a name="l01168"></a>01168     <span class="keywordflow">if</span> (r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#ad4b607d22d4e5f4c2f92dda62358d664">mode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad445d144465b42b6486adb0297fd77f8">R_SIMPLIFY</a>)
<a name="l01169"></a>01169         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#a2e5b16df1126f4e350a2a5e6fbee68f2">simplify_particles</a>*num);
<a name="l01170"></a>01170     <span class="keywordflow">else</span>
<a name="l01171"></a>01171         <span class="keywordflow">return</span> num;
<a name="l01172"></a>01172 }
<a name="l01173"></a>01173 
<a name="l01174"></a><a class="code" href="../../d0/d13/scene_8c.html#ae2f8d3b9edca6ffa7712cdf373a0c578">01174</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a3794116b5c2e9ce6c720c460c61f8000">get_render_shadow_samples</a>(<a class="code" href="../../d3/d27/structRenderData.html">RenderData</a> *r, <span class="keywordtype">int</span> samples)
<a name="l01175"></a>01175 {
<a name="l01176"></a>01176     <span class="keywordflow">if</span> ((r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#ad4b607d22d4e5f4c2f92dda62358d664">mode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad445d144465b42b6486adb0297fd77f8">R_SIMPLIFY</a>) &amp;&amp; samples &gt; 0)
<a name="l01177"></a>01177         <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#afb2f47ff8d71fcaeb5a3e6bd1c526061">simplify_shadowsamples</a>, samples);
<a name="l01178"></a>01178     <span class="keywordflow">else</span>
<a name="l01179"></a>01179         <span class="keywordflow">return</span> samples;
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 
<a name="l01182"></a><a class="code" href="../../d0/d13/scene_8c.html#a1f8c4ddb0ad579b4899ab8202d265bda">01182</a> <span class="keywordtype">float</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#ade9cc4e19dfd3c786b4d8637e649cf61">get_render_aosss_error</a>(<a class="code" href="../../d3/d27/structRenderData.html">RenderData</a> *r, <span class="keywordtype">float</span> <a class="code" href="../../d3/d22/seqeffects_8c.html#a7b34dac1400e04787532993b40ad9814">error</a>)
<a name="l01183"></a>01183 {
<a name="l01184"></a>01184     <span class="keywordflow">if</span> (r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#ad4b607d22d4e5f4c2f92dda62358d664">mode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad445d144465b42b6486adb0297fd77f8">R_SIMPLIFY</a>)
<a name="l01185"></a>01185         <span class="keywordflow">return</span> ((1.0f-r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#a1cdcb1ebf20075aeeeed2335bcadcd42">simplify_aosss</a>)*10.0f + 1.0f)*<a class="code" href="../../d3/d22/seqeffects_8c.html#a7b34dac1400e04787532993b40ad9814">error</a>;
<a name="l01186"></a>01186     <span class="keywordflow">else</span>
<a name="l01187"></a>01187         <span class="keywordflow">return</span> <a class="code" href="../../d3/d22/seqeffects_8c.html#a7b34dac1400e04787532993b40ad9814">error</a>;
<a name="l01188"></a>01188 }
<a name="l01189"></a>01189 
<a name="l01190"></a>01190 <span class="comment">/* helper function for the SETLOOPER macro */</span>
<a name="l01191"></a><a class="code" href="../../d0/d13/scene_8c.html#a5a8a5abc86163fc01fa9421d8eaace41">01191</a> <a class="code" href="../../d3/da9/structBase.html">Base</a> *<a class="code" href="../../d8/d53/BKE__scene_8h.html#a3edce0b6497e6767d645051f195900d0">_setlooper_base_step</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> **sce_iter, <a class="code" href="../../d3/da9/structBase.html">Base</a> *base)
<a name="l01192"></a>01192 {
<a name="l01193"></a>01193     <span class="keywordflow">if</span> (base &amp;&amp; base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>) {
<a name="l01194"></a>01194         <span class="comment">/* common case, step to the next */</span>
<a name="l01195"></a>01195         <span class="keywordflow">return</span> base-&gt;<a class="code" href="../../d3/da9/structBase.html#a25befa992d0ce8876b7d62176212be68">next</a>;
<a name="l01196"></a>01196     }
<a name="l01197"></a>01197     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (base==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; (*sce_iter)-&gt;base.first) {
<a name="l01198"></a>01198         <span class="comment">/* first time looping, return the scenes first base */</span>
<a name="l01199"></a>01199         <span class="keywordflow">return</span> (<a class="code" href="../../d3/da9/structBase.html">Base</a> *)(*sce_iter)-&gt;base.first;
<a name="l01200"></a>01200     }
<a name="l01201"></a>01201     <span class="keywordflow">else</span> {
<a name="l01202"></a>01202         <span class="comment">/* reached the end, get the next base in the set */</span>
<a name="l01203"></a>01203         <span class="keywordflow">while</span> ((*sce_iter= (*sce_iter)-&gt;<a class="code" href="../../d9/d27/structScene.html#af89a023123108ed72002144681d7621b">set</a>)) {
<a name="l01204"></a>01204             base= (<a class="code" href="../../d3/da9/structBase.html">Base</a> *)(*sce_iter)-&gt;base.first;
<a name="l01205"></a>01205             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (base) {
<a name="l01206"></a>01206                 <span class="keywordflow">return</span> base;
<a name="l01207"></a>01207             }
<a name="l01208"></a>01208         }
<a name="l01209"></a>01209     }
<a name="l01210"></a>01210 
<a name="l01211"></a>01211     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01212"></a>01212 }
<a name="l01213"></a>01213 
<a name="l01214"></a><a class="code" href="../../d0/d13/scene_8c.html#a3a18e4ad9f8d8e2a3a5fadd4e24f3b96">01214</a> <span class="keywordtype">int</span> <a class="code" href="../../d8/d53/BKE__scene_8h.html#a041ff0e68dd0152e85ceddddc9b53cdc">scene_use_new_shading_nodes</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l01215"></a>01215 {
<a name="l01216"></a>01216     <a class="code" href="../../d3/dd4/structRenderEngineType.html">RenderEngineType</a> *type= <a class="code" href="../../db/da9/RE__engine_8h.html#a089bd866025f458b251f1f643d13d065">RE_engines_find</a>(scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a4d4d1d058ba7c96ba3510f5101165b7f">engine</a>);
<a name="l01217"></a>01217     <span class="keywordflow">return</span> (type &amp;&amp; type-&gt;<a class="code" href="../../d3/dd4/structRenderEngineType.html#ab9086365473ba93f7f0c7554f39970fe">flag</a> &amp; <a class="code" href="../../db/da9/RE__engine_8h.html#a04cdc2246c954cc6d1dfc0737f73af4b">RE_USE_SHADING_NODES</a>);
<a name="l01218"></a>01218 }
<a name="l01219"></a>01219 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:53 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
