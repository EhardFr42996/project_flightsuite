<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: editmesh_tools.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">editmesh_tools.c</div>  </div>
</div>
<div class="contents">
<a href="../../d0/d85/editmesh__tools_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2004 by Blender Foundation.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * The Original Code is: all of this file.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * Contributor(s): Joseph Eagar</span>
<a name="l00024"></a>00024 <span class="comment"> *</span>
<a name="l00025"></a>00025 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../de/db2/DNA__material__types_8h.html">DNA_material_types.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d96/DNA__mesh__types_8h.html">DNA_mesh_types.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../da/df0/DNA__modifier__types_8h.html">DNA_modifier_types.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/RNA__define_8h.html">RNA_define.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d88/BLI__rand_8h.html" title="Random number functions.">BLI_rand.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d0f/BKE__material_8h.html" title="General operations, lookup, etc. for materials.">BKE_material.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html">BKE_cdderivedmesh.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dac/BKE__object_8h.html" title="General operations, lookup, etc. for blender objects.">BKE_object.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/BKE__report_8h.html">BKE_report.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d66/BKE__texture_8h.html">BKE_texture.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html">BKE_tessmesh.h</a>&quot;</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/dd6/ED__mesh_8h.html">ED_mesh.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7a/ED__object_8h.html">ED_object.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/df2/ED__transform_8h.html">ED_transform.h</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d25/ED__uvedit_8h.html">ED_uvedit.h</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d6a/ED__view3d_8h.html">ED_view3d.h</a>&quot;</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/de4/RE__render__ext_8h.html">RE_render_ext.h</a>&quot;</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d5c/mesh__intern_8h.html">mesh_intern.h</a>&quot;</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">/* allow accumulated normals to form a new direction but don&#39;t</span>
<a name="l00072"></a>00072 <span class="comment"> * accept direct opposite directions else they will cancel each other out */</span>
<a name="l00073"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af914b89d2404cd3fcd05615eefcea53e">00073</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af914b89d2404cd3fcd05615eefcea53e">add_normal_aligned</a>(<span class="keywordtype">float</span> nor[3], <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a9a801fa87c9bf3472c399696366fe81c">add</a>[3])
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a76629ccfe891bccda30f790ed501e959">dot_v3v3</a>(nor, add) &lt; -0.9999f) {
<a name="l00076"></a>00076         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a3d305087815afcd193f1d6e561537c34">sub_v3_v3</a>(nor, add);
<a name="l00077"></a>00077     }
<a name="l00078"></a>00078     <span class="keywordflow">else</span> {
<a name="l00079"></a>00079         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#ae0067c77927da3b22dec1de77ac8ba78">add_v3_v3</a>(nor, add);
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab753e53a31a061806be713b89b7907d8">00083</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab753e53a31a061806be713b89b7907d8">edbm_subdivide_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00084"></a>00084 {
<a name="l00085"></a>00085     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00086"></a>00086     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00087"></a>00087     <span class="keywordtype">int</span> cuts = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>);
<a name="l00088"></a>00088     <span class="keywordtype">float</span> <a class="code" href="../../d2/df6/sculpt_8c.html#a11919b8f48badb89cbb5b795722c22e3">smooth</a> = 0.292f * <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;smoothness&quot;</span>);
<a name="l00089"></a>00089     <span class="keywordtype">float</span> fractal = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;fractal&quot;</span>) / 2.5f;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;quadtri&quot;</span>) &amp;&amp; 
<a name="l00092"></a>00092         <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;quadcorner&quot;</span>) == <a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a6f39f1e617c741d6456153cab7c3468d">SUBD_STRAIGHT_CUT</a>)
<a name="l00093"></a>00093     {
<a name="l00094"></a>00094         <a class="code" href="../../d3/d10/rna__access_8c.html#ad70d450cec9fe951de69b8c9128b8cc4">RNA_enum_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;quadcorner&quot;</span>, <a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a85548f236f2f005c9e088fc3ee78f6bc">SUBD_INNERVERT</a>);
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096     
<a name="l00097"></a>00097     <a class="code" href="../../de/d95/bmesh__operators_8h.html#a67d0dbd86f796d8ad1176c1a98632d69">BM_mesh_esubdivide</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>,
<a name="l00098"></a>00098                        smooth, fractal,
<a name="l00099"></a>00099                        cuts,
<a name="l00100"></a>00100                        <a class="code" href="../../de/d95/bmesh__operators_8h.html#a84627a72058502328269676b81780f89a5333e0493ee0886cd6caa234d1188a3b">SUBDIV_SELECT_ORIG</a>, <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;quadcorner&quot;</span>),
<a name="l00101"></a>00101                        <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;quadtri&quot;</span>), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,
<a name="l00102"></a>00102                        <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;seed&quot;</span>));
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">/* Note, these values must match delete_mesh() event values */</span>
<a name="l00110"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af4ed37470320eb22255466b8c64788d3">00110</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af4ed37470320eb22255466b8c64788d3">prop_mesh_cornervert_types</a>[] = {
<a name="l00111"></a>00111     {<a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a85548f236f2f005c9e088fc3ee78f6bc">SUBD_INNERVERT</a>,     <span class="stringliteral">&quot;INNERVERT&quot;</span>, 0,      <span class="stringliteral">&quot;Inner Vert&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00112"></a>00112     {<a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122ad508caa163258378cd395cb502737496">SUBD_PATH</a>,          <span class="stringliteral">&quot;PATH&quot;</span>, 0,           <span class="stringliteral">&quot;Path&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00113"></a>00113     {<a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a6f39f1e617c741d6456153cab7c3468d">SUBD_STRAIGHT_CUT</a>,  <span class="stringliteral">&quot;STRAIGHT_CUT&quot;</span>, 0,   <span class="stringliteral">&quot;Straight Cut&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00114"></a>00114     {<a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a53c987b84acfb8e6bf744a9208328a80">SUBD_FAN</a>,           <span class="stringliteral">&quot;FAN&quot;</span>, 0,            <span class="stringliteral">&quot;Fan&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00115"></a>00115     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00116"></a>00116 };
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aa7abebadc91df9f28d7109ebee73d1d6">00118</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a97d2c62e6a0bb97aa60e4e8b2fbb8a81">MESH_OT_subdivide</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="comment">/* identifiers */</span>
<a name="l00123"></a>00123     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Subdivide&quot;</span>;
<a name="l00124"></a>00124     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Subdivide selected edges&quot;</span>;
<a name="l00125"></a>00125     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_subdivide&quot;</span>;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127     <span class="comment">/* api callbacks */</span>
<a name="l00128"></a>00128     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab753e53a31a061806be713b89b7907d8">edbm_subdivide_exec</a>;
<a name="l00129"></a>00129     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <span class="comment">/* flags */</span>
<a name="l00132"></a>00132     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00133"></a>00133 
<a name="l00134"></a>00134     <span class="comment">/* properties */</span>
<a name="l00135"></a>00135     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;number_cuts&quot;</span>, 1, 1, INT_MAX, <span class="stringliteral">&quot;Number of Cuts&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 1, 10);
<a name="l00136"></a>00136     <span class="comment">/* avoid re-using last var because it can cause _very_ high poly meshes and annoy users (or worse crash) */</span>
<a name="l00137"></a>00137     <a class="code" href="../../dc/d7e/rna__define_8c.html#a97e75cad8daa0d94523c8df118947191">RNA_def_property_flag</a>(prop, <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ac49bd36c069e337f7ee269c672ef1332">PROP_SKIP_SAVE</a>);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;smoothness&quot;</span>, 0.0f, 0.0f, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Smoothness&quot;</span>, <span class="stringliteral">&quot;Smoothness factor&quot;</span>, 0.0f, 1.0f);
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;quadtri&quot;</span>, 0, <span class="stringliteral">&quot;Quad/Tri Mode&quot;</span>, <span class="stringliteral">&quot;Tries to prevent ngons&quot;</span>);
<a name="l00142"></a>00142     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;quadcorner&quot;</span>, prop_mesh_cornervert_types, <a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a6f39f1e617c741d6456153cab7c3468d">SUBD_STRAIGHT_CUT</a>,
<a name="l00143"></a>00143                  <span class="stringliteral">&quot;Quad Corner Type&quot;</span>, <span class="stringliteral">&quot;How to subdivide quad corners (anything other than Straight Cut will prevent ngons)&quot;</span>);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;fractal&quot;</span>, 0.0f, 0.0f, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Fractal&quot;</span>, <span class="stringliteral">&quot;Fractal randomness factor&quot;</span>, 0.0f, 1000.0f);
<a name="l00146"></a>00146     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;seed&quot;</span>, 0, 0, 10000, <span class="stringliteral">&quot;Random Seed&quot;</span>, <span class="stringliteral">&quot;Seed for the random number generator&quot;</span>, 0, 50);
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a996a59aefafaa595015505f3faa4018b">00150</a> <span class="keywordtype">void</span> <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ae7828cf5634205da2001786ddf347150">EMBM_project_snap_verts</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit, <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em)
<a name="l00151"></a>00151 {
<a name="l00152"></a>00152     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l00153"></a>00153     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *eve;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eve, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l00156"></a>00156         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eve, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l00157"></a>00157             <span class="keywordtype">float</span> mval[2], vec[3], no_dummy[3];
<a name="l00158"></a>00158             <span class="keywordtype">int</span> dist_dummy;
<a name="l00159"></a>00159             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad7be0179ee8a128512e2c7f0ad11c8d8">mul_v3_m4v3</a>(vec, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l00160"></a>00160             <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a4551d98f490ec042932367ef422a8ba1">project_float_noclip</a>(ar, vec, mval);
<a name="l00161"></a>00161             <span class="keywordflow">if</span> (<a class="code" href="../../d8/df2/ED__transform_8h.html#aa21730b18d1d1c696f950521e9138511">snapObjectsContext</a>(C, mval, &amp;dist_dummy, vec, no_dummy, <a class="code" href="../../d8/df2/ED__transform_8h.html#ad6af205d4643f7a9ff2ed777d3b858f6a5e7183a683a758ffbf9f90f7a9c8453d">SNAP_NOT_OBEDIT</a>)) {
<a name="l00162"></a>00162                 <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad7be0179ee8a128512e2c7f0ad11c8d8">mul_v3_m4v3</a>(eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>, vec);
<a name="l00163"></a>00163             }
<a name="l00164"></a>00164         }
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="comment">/* individual face extrude */</span>
<a name="l00170"></a>00170 <span class="comment">/* will use vertex normals for extrusion directions, so *nor is unaffected */</span>
<a name="l00171"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#acc2c6d94c25b2e8293f644270da94ff1">00171</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acc2c6d94c25b2e8293f644270da94ff1">edbm_extrude_face_indiv</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <span class="keyword">const</span> <span class="keywordtype">char</span> hflag, <span class="keywordtype">float</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(nor))
<a name="l00172"></a>00172 {
<a name="l00173"></a>00173     <a class="code" href="../../d6/d38/structBMOIter.html">BMOIter</a> siter;
<a name="l00174"></a>00174     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> liter;
<a name="l00175"></a>00175     <a class="code" href="../../d0/d23/structBMFace.html">BMFace</a> *f;
<a name="l00176"></a>00176     <a class="code" href="../../dc/dd5/structBMLoop.html">BMLoop</a> *l;
<a name="l00177"></a>00177     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;extrude_face_indiv faces=%hf&quot;</span>, hflag);
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <span class="comment">/* deselect original verts */</span>
<a name="l00182"></a>00182     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l00185"></a>00185     
<a name="l00186"></a>00186     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#aceabf419741150f3784043c9d081ac2e">BMO_ITER</a> (f, &amp;siter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;faceout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>) {
<a name="l00187"></a>00187         <a class="code" href="../../d5/def/bmesh__marking_8c.html#a1fa6831f1e900dac7a2d426f3a5c1f76" title="Select Face.">BM_face_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, f, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189         <span class="comment">/* set face vertex normals to face normal */</span>
<a name="l00190"></a>00190         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a5e5c4d17117bdcca9ab959ebf43a174f">BM_ITER_ELEM</a> (l, &amp;liter, f, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1faf52ecdfb30814f26ead38881b29c7375">BM_LOOPS_OF_FACE</a>) {
<a name="l00191"></a>00191             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(l-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a2da088cf339e17dafd9f5e7ee0bf3771">v</a>-&gt;<a class="code" href="../../df/d18/structBMVert.html#a9ca56d4719d409f8a96fce9a1be562b6">no</a>, f-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a9401deff8be300468964ca48850ff702">no</a>);
<a name="l00192"></a>00192         }
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l00196"></a>00196         <span class="keywordflow">return</span> 0;
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <span class="keywordflow">return</span> <span class="charliteral">&#39;s&#39;</span>; <span class="comment">// s is shrink/fatten</span>
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 <span class="comment">/* extrudes individual edges */</span>
<a name="l00203"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4846816ddf4a04338f2a0ad1dc6c7d81">00203</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4846816ddf4a04338f2a0ad1dc6c7d81">edbm_extrude_edges_indiv</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <span class="keyword">const</span> <span class="keywordtype">char</span> hflag, <span class="keywordtype">float</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(nor))
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;extrude_edge_only edges=%he&quot;</span>, hflag);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="comment">/* deselect original verts */</span>
<a name="l00210"></a>00210     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l00213"></a>00213     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;geomout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a> | <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l00216"></a>00216         <span class="keywordflow">return</span> 0;
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     <span class="keywordflow">return</span> <span class="charliteral">&#39;n&#39;</span>; <span class="comment">// n is normal grab</span>
<a name="l00220"></a>00220 }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 <span class="comment">/* extrudes individual vertices */</span>
<a name="l00223"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ae00f2a8ec0490255689e0dbb185d6e">00223</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ae00f2a8ec0490255689e0dbb185d6e">edbm_extrude_verts_indiv</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <span class="keyword">const</span> <span class="keywordtype">char</span> hflag, <span class="keywordtype">float</span> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(nor))
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;extrude_vert_indiv verts=%hv&quot;</span>, hflag);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="comment">/* deselect original verts */</span>
<a name="l00230"></a>00230     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a1738215546cdb3e92aec2b09328dad3d" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_disable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;verts&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l00233"></a>00233     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;vertout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l00236"></a>00236         <span class="keywordflow">return</span> 0;
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     <span class="keywordflow">return</span> <span class="charliteral">&#39;g&#39;</span>; <span class="comment">// g is grab</span>
<a name="l00240"></a>00240 }
<a name="l00241"></a>00241 
<a name="l00242"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a25403be13b78b38a529e57a9eab3ae3b">00242</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a25403be13b78b38a529e57a9eab3ae3b">edbm_extrude_edge</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *obedit, <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <span class="keyword">const</span> <span class="keywordtype">char</span> hflag, <span class="keywordtype">float</span> nor[3])
<a name="l00243"></a>00243 {
<a name="l00244"></a>00244     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l00245"></a>00245     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l00246"></a>00246     <a class="code" href="../../d6/d38/structBMOIter.html">BMOIter</a> siter;
<a name="l00247"></a>00247     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> extop;
<a name="l00248"></a>00248     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *edge;
<a name="l00249"></a>00249     <a class="code" href="../../d0/d23/structBMFace.html">BMFace</a> *f;
<a name="l00250"></a>00250     <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md;
<a name="l00251"></a>00251     <a class="code" href="../../da/d7e/structBMElem.html">BMElem</a> *ele;
<a name="l00252"></a>00252     
<a name="l00253"></a>00253     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a022f5ed9fd4c92f527b661975c66e89b" title="BMESH OPSTACK INIT OP.">BMO_op_init</a>(bm, &amp;extop, <span class="stringliteral">&quot;extrude_face_region&quot;</span>);
<a name="l00254"></a>00254     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ab46b0ba0c23f5b2987e6b111213bea59">BMO_slot_buffer_from_enabled_hflag</a>(bm, &amp;extop, <span class="stringliteral">&quot;edgefacein&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a> | <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a> | <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, hflag);
<a name="l00255"></a>00255 
<a name="l00256"></a>00256     <span class="comment">/* If a mirror modifier with clipping is on, we need to adjust some </span>
<a name="l00257"></a>00257 <span class="comment">     * of the cases above to handle edges on the line of symmetry.</span>
<a name="l00258"></a>00258 <span class="comment">     */</span>
<a name="l00259"></a>00259     md = obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a31fdd585d66951dfd084a8e8ee624a8d">modifiers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00260"></a>00260     <span class="keywordflow">for</span> (; md; md = md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a3021bdd74b5a4d99e4ea5ee3a19f8560">next</a>) {
<a name="l00261"></a>00261         <span class="keywordflow">if</span> ((md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> == <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a251aba7f50f4d9b2d085279bd96d6ee6">eModifierType_Mirror</a>) &amp;&amp; (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601ac434becb714d73f6821cafeeb5b22995">eModifierMode_Realtime</a>)) {
<a name="l00262"></a>00262             <a class="code" href="../../d3/dcc/structMirrorModifierData.html">MirrorModifierData</a> *mmd = (<a class="code" href="../../d3/dcc/structMirrorModifierData.html">MirrorModifierData</a> *) md;
<a name="l00263"></a>00263         
<a name="l00264"></a>00264             <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#ae953c75c2e1ea297d06e64803b25dc93">MOD_MIR_CLIPPING</a>) {
<a name="l00265"></a>00265                 <span class="keywordtype">float</span> mtx[4][4];
<a name="l00266"></a>00266                 <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a57d2da44d54370ef23cb3d4a514fdca6">mirror_ob</a>) {
<a name="l00267"></a>00267                     <span class="keywordtype">float</span> imtx[4][4];
<a name="l00268"></a>00268                     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#aab557e66ccdc3534593b413d9b2d7fe8">invert_m4_m4</a>(imtx, mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a57d2da44d54370ef23cb3d4a514fdca6">mirror_ob</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00269"></a>00269                     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ae41a59d6db4a10a85f8fbf1e3842ba81">mult_m4_m4m4</a>(mtx, imtx, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00270"></a>00270                 }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272                 <span class="keywordflow">for</span> (edge = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00273"></a>00273                      edge;
<a name="l00274"></a>00274                      edge = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;iter))
<a name="l00275"></a>00275                 {
<a name="l00276"></a>00276                     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(edge, hflag) &amp;&amp;
<a name="l00277"></a>00277                         <a class="code" href="../../d9/ddf/bmesh__queries_8c.html#ac55826e51ebcf18ee22170101cda8ff2">BM_edge_is_boundary</a>(edge) &amp;&amp;
<a name="l00278"></a>00278                         <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(edge-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab9029150e1f571daf0c3e21c0bf6f797">l</a>-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a91ef300365e03d63842c7b694626bbb7">f</a>, hflag))
<a name="l00279"></a>00279                     {
<a name="l00280"></a>00280                         <span class="keywordtype">float</span> co1[3], co2[3];
<a name="l00281"></a>00281 
<a name="l00282"></a>00282                         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(co1, edge-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l00283"></a>00283                         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(co2, edge-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285                         <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a57d2da44d54370ef23cb3d4a514fdca6">mirror_ob</a>) {
<a name="l00286"></a>00286                             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad7be0179ee8a128512e2c7f0ad11c8d8">mul_v3_m4v3</a>(co1, mtx, co1);
<a name="l00287"></a>00287                             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad7be0179ee8a128512e2c7f0ad11c8d8">mul_v3_m4v3</a>(co2, mtx, co2);
<a name="l00288"></a>00288                         }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290                         <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#ac5478fa035ffe227f719b371488e3ec4">MOD_MIR_AXIS_X</a>) {
<a name="l00291"></a>00291                             <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(co1[0]) &lt; mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a68253eb078151a9b36485cc365d2ffa1">tolerance</a>) &amp;&amp;
<a name="l00292"></a>00292                                 (<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(co2[0]) &lt; mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a68253eb078151a9b36485cc365d2ffa1">tolerance</a>))
<a name="l00293"></a>00293                             {
<a name="l00294"></a>00294                                 <a class="code" href="../../d6/d21/bmesh__operator__api__inline_8h.html#a1ff1714c9c8269b07b0213c71c258c14">BMO_slot_map_ptr_insert</a>(bm, &amp;extop, <span class="stringliteral">&quot;exclude&quot;</span>, edge, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00295"></a>00295                             }
<a name="l00296"></a>00296                         }
<a name="l00297"></a>00297                         <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#abd93abc70f2b4064c6f3c2173e0f67e8">MOD_MIR_AXIS_Y</a>) {
<a name="l00298"></a>00298                             <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(co1[1]) &lt; mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a68253eb078151a9b36485cc365d2ffa1">tolerance</a>) &amp;&amp;
<a name="l00299"></a>00299                                 (<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(co2[1]) &lt; mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a68253eb078151a9b36485cc365d2ffa1">tolerance</a>))
<a name="l00300"></a>00300                             {
<a name="l00301"></a>00301                                 <a class="code" href="../../d6/d21/bmesh__operator__api__inline_8h.html#a1ff1714c9c8269b07b0213c71c258c14">BMO_slot_map_ptr_insert</a>(bm, &amp;extop, <span class="stringliteral">&quot;exclude&quot;</span>, edge, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00302"></a>00302                             }
<a name="l00303"></a>00303                         }
<a name="l00304"></a>00304                         <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a622f972032eead375e5efb14e63bbcac">MOD_MIR_AXIS_Z</a>) {
<a name="l00305"></a>00305                             <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(co1[2]) &lt; mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a68253eb078151a9b36485cc365d2ffa1">tolerance</a>) &amp;&amp;
<a name="l00306"></a>00306                                 (<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(co2[2]) &lt; mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a68253eb078151a9b36485cc365d2ffa1">tolerance</a>))
<a name="l00307"></a>00307                             {
<a name="l00308"></a>00308                                 <a class="code" href="../../d6/d21/bmesh__operator__api__inline_8h.html#a1ff1714c9c8269b07b0213c71c258c14">BMO_slot_map_ptr_insert</a>(bm, &amp;extop, <span class="stringliteral">&quot;exclude&quot;</span>, edge, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00309"></a>00309                             }
<a name="l00310"></a>00310                         }
<a name="l00311"></a>00311                     }
<a name="l00312"></a>00312                 }
<a name="l00313"></a>00313             }
<a name="l00314"></a>00314         }
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(bm, &amp;extop);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#acd4d89007c860a4c74d459ac72593065">zero_v3</a>(nor);
<a name="l00322"></a>00322     
<a name="l00323"></a>00323     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#aceabf419741150f3784043c9d081ac2e">BMO_ITER</a> (ele, &amp;siter, bm, &amp;extop, <span class="stringliteral">&quot;geomout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a9bf8085857e7d4a80f0a7218f714652c">BM_ALL</a>) {
<a name="l00324"></a>00324         <a class="code" href="../../d5/def/bmesh__marking_8c.html#a4ae75f0cde91878366054c6aff6d9276">BM_elem_select_set</a>(bm, ele, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         <span class="keywordflow">if</span> (ele-&gt;<a class="code" href="../../da/d7e/structBMElem.html#af43ccadee22be1cdcc1e9c33a6e79e85">head</a>.<a class="code" href="../../d5/d3a/structBMHeader.html#a19df90ed3e1d2792d504ae74d3bb06da">htype</a> == <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>) {
<a name="l00327"></a>00327             f = (<a class="code" href="../../d0/d23/structBMFace.html">BMFace</a> *)ele;
<a name="l00328"></a>00328             <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af914b89d2404cd3fcd05615eefcea53e">add_normal_aligned</a>(nor, f-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a9401deff8be300468964ca48850ff702">no</a>);
<a name="l00329"></a>00329         };
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a3b49789e4776d019ff5756b73df2f3a1">normalize_v3</a>(nor);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ab6f764453b1419d3dfca2aec5943a381" title="BMESH OPSTACK FINISH OP.">BMO_op_finish</a>(bm, &amp;extop);
<a name="l00335"></a>00335 
<a name="l00336"></a>00336     <span class="comment">/* grab / normal constraint */</span>
<a name="l00337"></a>00337     <span class="keywordflow">return</span> <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a212d65c08323cdf9e10d72e1775e94c2">is_zero_v3</a>(nor) ? <span class="charliteral">&#39;g&#39;</span> : <span class="charliteral">&#39;n&#39;</span>;
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#aeab0e4e332759888cc1277cdd142897e">00340</a> <span class="keyword">static</span> <span class="keywordtype">short</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aeab0e4e332759888cc1277cdd142897e">edbm_extrude_vert</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *obedit, <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <span class="keyword">const</span> <span class="keywordtype">char</span> hflag, <span class="keywordtype">float</span> nor[3])
<a name="l00341"></a>00341 {
<a name="l00342"></a>00342     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l00343"></a>00343     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l00344"></a>00344         
<a name="l00345"></a>00345     <span class="comment">/* ensure vert flags are consistent for edge selections */</span>
<a name="l00346"></a>00346     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l00347"></a>00347         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, hflag)) {
<a name="l00348"></a>00348             <span class="keywordflow">if</span> (hflag &amp; <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) {
<a name="l00349"></a>00349                 <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00350"></a>00350                 <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00351"></a>00351             }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353             <a class="code" href="../../d8/d74/bmesh__inline_8h.html#ae3e692a09518f835ef5b770ecff8acd2">BM_elem_flag_enable</a>(eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>, hflag &amp; ~BM_ELEM_SELECT);
<a name="l00354"></a>00354             <a class="code" href="../../d8/d74/bmesh__inline_8h.html#ae3e692a09518f835ef5b770ecff8acd2">BM_elem_flag_enable</a>(eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>, hflag &amp; ~BM_ELEM_SELECT);
<a name="l00355"></a>00355         }
<a name="l00356"></a>00356         <span class="keywordflow">else</span> {
<a name="l00357"></a>00357             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>, hflag) &amp;&amp; <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>, hflag)) {
<a name="l00358"></a>00358                 <span class="keywordflow">if</span> (hflag &amp; <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) {
<a name="l00359"></a>00359                     <a class="code" href="../../d5/def/bmesh__marking_8c.html#a36117bf878409d6e7a6025d5fc7d2c50" title="Select Edge.">BM_edge_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, eed, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00360"></a>00360                 }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362                 <a class="code" href="../../d8/d74/bmesh__inline_8h.html#ae3e692a09518f835ef5b770ecff8acd2">BM_elem_flag_enable</a>(eed, hflag &amp; ~BM_ELEM_SELECT);
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364         }
<a name="l00365"></a>00365     }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367     <span class="keywordflow">return</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a25403be13b78b38a529e57a9eab3ae3b">edbm_extrude_edge</a>(obedit, em, hflag, nor);
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#aac470a23b74a654bc9bdf7022caf44da">00370</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aac470a23b74a654bc9bdf7022caf44da">edbm_extrude_repeat_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00371"></a>00371 {
<a name="l00372"></a>00372     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00373"></a>00373     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00374"></a>00374     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = <a class="code" href="../../df/d01/BKE__context_8h.html#af03543cb8e3fa2c39bb777962a6eae13">CTX_wm_region_view3d</a>(C);
<a name="l00375"></a>00375         
<a name="l00376"></a>00376     <span class="keywordtype">int</span> steps = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;steps&quot;</span>);
<a name="l00377"></a>00377     
<a name="l00378"></a>00378     <span class="keywordtype">float</span> <a class="code" href="../../d7/d35/meshtools_8c.html#a95306f188b8885dc64be154d19f1232c">offs</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;offset&quot;</span>);
<a name="l00379"></a>00379     <span class="keywordtype">float</span> dvec[3], tmat[3][3], bmat[3][3], nor[3] = {0.0, 0.0, 0.0};
<a name="l00380"></a>00380     <span class="keywordtype">short</span> a;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="comment">/* dvec */</span>
<a name="l00383"></a>00383     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#aaa8b4ca59d77eb2612341c608507e087">normalize_v3_v3</a>(dvec, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ac8b049c589a4159afee5f4d0114dbed7">persinv</a>[2]);
<a name="l00384"></a>00384     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a614c21caf4e6d770c7a49006a7f734b4">mul_v3_fl</a>(dvec, offs);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <span class="comment">/* base correction */</span>
<a name="l00387"></a>00387     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a36f8fd23b3f7785d0396ea7a93683d09">copy_m3_m4</a>(bmat, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00388"></a>00388     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#acc9f8cab0ea2c5993f2c9bdeaca6b788">invert_m3_m3</a>(tmat, bmat);
<a name="l00389"></a>00389     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a8ffa2d992371e11fad87ffbb55f034c8">mul_m3_v3</a>(tmat, dvec);
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <span class="keywordflow">for</span> (a = 0; a &lt; steps; a++) {
<a name="l00392"></a>00392         <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a25403be13b78b38a529e57a9eab3ae3b">edbm_extrude_edge</a>(obedit, em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00393"></a>00393         <span class="comment">//BMO_op_callf(em-&gt;bm, &quot;extrude_face_region edgefacein=%hef&quot;, BM_ELEM_SELECT);</span>
<a name="l00394"></a>00394         <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a5113211e19fe53429699444369f258aa">BMO_op_callf</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <span class="stringliteral">&quot;translate vec=%v verts=%hv&quot;</span>, (<span class="keywordtype">float</span> *)dvec, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00395"></a>00395         <span class="comment">//extrudeflag(obedit, em, SELECT, nor);</span>
<a name="l00396"></a>00396         <span class="comment">//translateflag(em, SELECT, dvec);</span>
<a name="l00397"></a>00397     }
<a name="l00398"></a>00398     
<a name="l00399"></a>00399     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afc818d571d27864536e18764e9c44a86">EDBM_mesh_normals_update</a>(em);
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a56787a07c31cdfc63f2229a1a5276149">00406</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af9779505cfd9646818fab91ee52b6768">MESH_OT_extrude_repeat</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00407"></a>00407 {
<a name="l00408"></a>00408     <span class="comment">/* identifiers */</span>
<a name="l00409"></a>00409     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Extrude Repeat Mesh&quot;</span>;
<a name="l00410"></a>00410     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Extrude selected vertices, edges or faces repeatedly&quot;</span>;
<a name="l00411"></a>00411     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_extrude_repeat&quot;</span>;
<a name="l00412"></a>00412     
<a name="l00413"></a>00413     <span class="comment">/* api callbacks */</span>
<a name="l00414"></a>00414     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aac470a23b74a654bc9bdf7022caf44da">edbm_extrude_repeat_exec</a>;
<a name="l00415"></a>00415     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a1c12c45b3e8ba8060cdeea963881947b">ED_operator_editmesh_view3d</a>;
<a name="l00416"></a>00416     
<a name="l00417"></a>00417     <span class="comment">/* flags */</span>
<a name="l00418"></a>00418     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00419"></a>00419     
<a name="l00420"></a>00420     <span class="comment">/* props */</span>
<a name="l00421"></a>00421     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;offset&quot;</span>, 2.0f, 0.0f, 100.0f, <span class="stringliteral">&quot;Offset&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0.0f, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>);
<a name="l00422"></a>00422     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;steps&quot;</span>, 10, 0, 180, <span class="stringliteral">&quot;Steps&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0, INT_MAX);
<a name="l00423"></a>00423 }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="comment">/* generic extern called extruder */</span>
<a name="l00426"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0d94ff60c51bff059e2040854135eff5">00426</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0d94ff60c51bff059e2040854135eff5">edbm_extrude_mesh</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit, <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <span class="keywordtype">float</span> *norin)
<a name="l00427"></a>00427 {
<a name="l00428"></a>00428     <span class="keywordtype">short</span> nr, transmode = 0;
<a name="l00429"></a>00429     <span class="keywordtype">float</span> stacknor[3] = {0.0f, 0.0f, 0.0f};
<a name="l00430"></a>00430     <span class="keywordtype">float</span> *nor = norin ? norin : stacknor;
<a name="l00431"></a>00431 
<a name="l00432"></a>00432     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#acd4d89007c860a4c74d459ac72593065">zero_v3</a>(nor);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8de5fe0f8dbf523c4699a7b54c429e2f">SCE_SELECT_VERTEX</a>) {
<a name="l00435"></a>00435         <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a63cca38a2559df39fd49e10a02f96f3b">totvertsel</a> == 0) nr = 0;
<a name="l00436"></a>00436         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a63cca38a2559df39fd49e10a02f96f3b">totvertsel</a> == 1) nr = 4;
<a name="l00437"></a>00437         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#ab7c58bf63d064b3c60054c66d51d193a">totedgesel</a> == 0) nr = 4;
<a name="l00438"></a>00438         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a1dd07eb2ac0b586cd437a5a687d11a8a">totfacesel</a> == 0)
<a name="l00439"></a>00439             nr = 3;  <span class="comment">// pupmenu(&quot;Extrude %t|Only Edges%x3|Only Vertices%x4&quot;);</span>
<a name="l00440"></a>00440         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a1dd07eb2ac0b586cd437a5a687d11a8a">totfacesel</a> == 1)
<a name="l00441"></a>00441             nr = 1;  <span class="comment">// pupmenu(&quot;Extrude %t|Region %x1|Only Edges%x3|Only Vertices%x4&quot;);</span>
<a name="l00442"></a>00442         <span class="keywordflow">else</span> 
<a name="l00443"></a>00443             nr = 1;  <span class="comment">// pupmenu(&quot;Extrude %t|Region %x1||Individual Faces %x2|Only Edges%x3|Only Vertices%x4&quot;);</span>
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad6cb358a5c5612c639f998b0601e0865">SCE_SELECT_EDGE</a>) {
<a name="l00446"></a>00446         <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#ab7c58bf63d064b3c60054c66d51d193a">totedgesel</a> == 0) nr = 0;
<a name="l00447"></a>00447         
<a name="l00448"></a>00448         nr = 1;
<a name="l00449"></a>00449 <span class="preprocessor">#if 0</span>
<a name="l00450"></a>00450 <span class="preprocessor"></span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;totedgesel == 1) nr = 3;
<a name="l00451"></a>00451         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;totfacesel == 0) nr = 3;
<a name="l00452"></a>00452         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;totfacesel == 1)
<a name="l00453"></a>00453             nr = 1;  <span class="comment">// pupmenu(&quot;Extrude %t|Region %x1|Only Edges%x3&quot;);</span>
<a name="l00454"></a>00454         <span class="keywordflow">else</span>
<a name="l00455"></a>00455             nr = 1;  <span class="comment">// pupmenu(&quot;Extrude %t|Region %x1||Individual Faces %x2|Only Edges%x3&quot;);</span>
<a name="l00456"></a>00456 <span class="preprocessor">#endif</span>
<a name="l00457"></a>00457 <span class="preprocessor"></span>    }
<a name="l00458"></a>00458     <span class="keywordflow">else</span> {
<a name="l00459"></a>00459         <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a1dd07eb2ac0b586cd437a5a687d11a8a">totfacesel</a> == 0) nr = 0;
<a name="l00460"></a>00460         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a1dd07eb2ac0b586cd437a5a687d11a8a">totfacesel</a> == 1) nr = 1;
<a name="l00461"></a>00461         <span class="keywordflow">else</span>
<a name="l00462"></a>00462             nr = 1;  <span class="comment">// pupmenu(&quot;Extrude %t|Region %x1||Individual Faces %x2&quot;);</span>
<a name="l00463"></a>00463     }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <span class="keywordflow">if</span> (nr &lt; 1) <span class="keywordflow">return</span> <span class="charliteral">&#39;g&#39;</span>;
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <span class="keywordflow">if</span> (nr == 1 &amp;&amp; (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8de5fe0f8dbf523c4699a7b54c429e2f">SCE_SELECT_VERTEX</a>))
<a name="l00468"></a>00468         transmode = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aeab0e4e332759888cc1277cdd142897e">edbm_extrude_vert</a>(obedit, em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00469"></a>00469     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nr == 1) transmode = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a25403be13b78b38a529e57a9eab3ae3b">edbm_extrude_edge</a>(obedit, em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00470"></a>00470     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nr == 4) transmode = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ae00f2a8ec0490255689e0dbb185d6e">edbm_extrude_verts_indiv</a>(em, op, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00471"></a>00471     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nr == 3) transmode = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4846816ddf4a04338f2a0ad1dc6c7d81">edbm_extrude_edges_indiv</a>(em, op, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00472"></a>00472     <span class="keywordflow">else</span> transmode = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acc2c6d94c25b2e8293f644270da94ff1">edbm_extrude_face_indiv</a>(em, op, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00473"></a>00473     
<a name="l00474"></a>00474     <span class="keywordflow">if</span> (transmode == 0) {
<a name="l00475"></a>00475         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Not a valid selection for extrude&quot;</span>);
<a name="l00476"></a>00476     }
<a name="l00477"></a>00477     <span class="keywordflow">else</span> {
<a name="l00478"></a>00478         
<a name="l00479"></a>00479         <span class="comment">/* We need to force immediate calculation here because</span>
<a name="l00480"></a>00480 <span class="comment">         * transform may use derived objects (which are now stale).</span>
<a name="l00481"></a>00481 <span class="comment">         *</span>
<a name="l00482"></a>00482 <span class="comment">         * This shouldn&#39;t be necessary, derived queries should be</span>
<a name="l00483"></a>00483 <span class="comment">         * automatically building this data if invalid. Or something.</span>
<a name="l00484"></a>00484 <span class="comment">         */</span>
<a name="l00485"></a>00485 <span class="comment">//      DAG_object_flush_update(scene, obedit, OB_RECALC_DATA);</span>
<a name="l00486"></a>00486         <a class="code" href="../../df/dac/BKE__object_8h.html#aa3a62a478e6c8cc25d8d49fd0eb25c21">object_handle_update</a>(scene, obedit);
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         <span class="comment">/* individual faces? */</span>
<a name="l00489"></a>00489 <span class="comment">//      BIF_TransformSetUndo(&quot;Extrude&quot;);</span>
<a name="l00490"></a>00490         <span class="keywordflow">if</span> (nr == 2) {
<a name="l00491"></a>00491 <span class="comment">//          initTransform(TFM_SHRINKFATTEN, CTX_NO_PET|CTX_NO_MIRROR);</span>
<a name="l00492"></a>00492 <span class="comment">//          Transform();</span>
<a name="l00493"></a>00493         }
<a name="l00494"></a>00494         <span class="keywordflow">else</span> {
<a name="l00495"></a>00495 <span class="comment">//          initTransform(TFM_TRANSLATION, CTX_NO_PET|CTX_NO_MIRROR);</span>
<a name="l00496"></a>00496             <span class="keywordflow">if</span> (transmode == <span class="charliteral">&#39;n&#39;</span>) {
<a name="l00497"></a>00497                 <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2fc1e6236f291e8cf3b62c8e0541eb00">mul_m4_v3</a>(obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, nor);
<a name="l00498"></a>00498                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a55cc5423278e715951545237ac71fb8b">sub_v3_v3v3</a>(nor, nor, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>[3]);
<a name="l00499"></a>00499 <span class="comment">//              BIF_setSingleAxisConstraint(nor, &quot;along normal&quot;);</span>
<a name="l00500"></a>00500             }
<a name="l00501"></a>00501 <span class="comment">//          Transform();</span>
<a name="l00502"></a>00502         }
<a name="l00503"></a>00503     }
<a name="l00504"></a>00504     
<a name="l00505"></a>00505     <span class="keywordflow">return</span> transmode;
<a name="l00506"></a>00506 }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 <span class="comment">/* extrude without transform */</span>
<a name="l00509"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a1eac18c3007f5b22f146c9165cfe9af3">00509</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a1eac18c3007f5b22f146c9165cfe9af3">edbm_extrude_region_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00510"></a>00510 {
<a name="l00511"></a>00511     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00512"></a>00512     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00513"></a>00513     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00514"></a>00514     
<a name="l00515"></a>00515     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0d94ff60c51bff059e2040854135eff5">edbm_extrude_mesh</a>(scene, obedit, em, op, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="comment">/* This normally happens when pushing undo but modal operators</span>
<a name="l00518"></a>00518 <span class="comment">     * like this one don&#39;t push undo data until after modal mode is</span>
<a name="l00519"></a>00519 <span class="comment">     * done.*/</span>
<a name="l00520"></a>00520     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afc818d571d27864536e18764e9c44a86">EDBM_mesh_normals_update</a>(em);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00523"></a>00523     
<a name="l00524"></a>00524     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00525"></a>00525 }
<a name="l00526"></a>00526 
<a name="l00527"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aa84a2339127aea4d128e5954b5f7b61a">00527</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad7e4b689b69d6348071d8d9a2c94b7f1">MESH_OT_extrude_region</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00528"></a>00528 {
<a name="l00529"></a>00529     <span class="comment">/* identifiers */</span>
<a name="l00530"></a>00530     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Extrude Region&quot;</span>;
<a name="l00531"></a>00531     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_extrude_region&quot;</span>;
<a name="l00532"></a>00532     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Extrude region of faces&quot;</span>;
<a name="l00533"></a>00533     
<a name="l00534"></a>00534     <span class="comment">/* api callbacks */</span>
<a name="l00535"></a>00535     <span class="comment">//ot-&gt;invoke = mesh_extrude_region_invoke;</span>
<a name="l00536"></a>00536     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a1eac18c3007f5b22f146c9165cfe9af3">edbm_extrude_region_exec</a>;
<a name="l00537"></a>00537     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00538"></a>00538     
<a name="l00539"></a>00539     <span class="comment">/* flags */</span>
<a name="l00540"></a>00540     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mirror&quot;</span>, 0, <span class="stringliteral">&quot;Mirror Editing&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00543"></a>00543 }
<a name="l00544"></a>00544 
<a name="l00545"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#acb5714ef0e42415c9b9aabb2f7fd72ef">00545</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acb5714ef0e42415c9b9aabb2f7fd72ef">edbm_extrude_verts_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00546"></a>00546 {
<a name="l00547"></a>00547     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00548"></a>00548     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00549"></a>00549     <span class="keywordtype">float</span> nor[3];
<a name="l00550"></a>00550 
<a name="l00551"></a>00551     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ae00f2a8ec0490255689e0dbb185d6e">edbm_extrude_verts_indiv</a>(em, op, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00552"></a>00552     
<a name="l00553"></a>00553     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit);
<a name="l00554"></a>00554     
<a name="l00555"></a>00555     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
<a name="l00558"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a621b4e174bdc5593c74744924db13b56">00558</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afd307804c525c719c926cdf6b6f0777b">MESH_OT_extrude_verts_indiv</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00559"></a>00559 {
<a name="l00560"></a>00560     <span class="comment">/* identifiers */</span>
<a name="l00561"></a>00561     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Extrude Only Vertices&quot;</span>;
<a name="l00562"></a>00562     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_extrude_verts_indiv&quot;</span>;
<a name="l00563"></a>00563     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Extrude individual vertices only&quot;</span>;
<a name="l00564"></a>00564     
<a name="l00565"></a>00565     <span class="comment">/* api callbacks */</span>
<a name="l00566"></a>00566     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acb5714ef0e42415c9b9aabb2f7fd72ef">edbm_extrude_verts_exec</a>;
<a name="l00567"></a>00567     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00568"></a>00568     
<a name="l00569"></a>00569     <span class="comment">/* flags */</span>
<a name="l00570"></a>00570     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="comment">/* to give to transform */</span>
<a name="l00573"></a>00573     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mirror&quot;</span>, 0, <span class="stringliteral">&quot;Mirror Editing&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00574"></a>00574 }
<a name="l00575"></a>00575 
<a name="l00576"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#abb5fbddff0d34e9200d29c5aa512900c">00576</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#abb5fbddff0d34e9200d29c5aa512900c">edbm_extrude_edges_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00577"></a>00577 {
<a name="l00578"></a>00578     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00579"></a>00579     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00580"></a>00580     <span class="keywordtype">float</span> nor[3];
<a name="l00581"></a>00581 
<a name="l00582"></a>00582     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4846816ddf4a04338f2a0ad1dc6c7d81">edbm_extrude_edges_indiv</a>(em, op, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00583"></a>00583     
<a name="l00584"></a>00584     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit);
<a name="l00585"></a>00585     
<a name="l00586"></a>00586     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00587"></a>00587 }
<a name="l00588"></a>00588 
<a name="l00589"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a28c4c9820ca26fc00507fb667f7e4af4">00589</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af52e9409da822588a5094e25d8c05d6d">MESH_OT_extrude_edges_indiv</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00590"></a>00590 {
<a name="l00591"></a>00591     <span class="comment">/* identifiers */</span>
<a name="l00592"></a>00592     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Extrude Only Edges&quot;</span>;
<a name="l00593"></a>00593     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_extrude_edges_indiv&quot;</span>;
<a name="l00594"></a>00594     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Extrude individual edges only&quot;</span>;
<a name="l00595"></a>00595     
<a name="l00596"></a>00596     <span class="comment">/* api callbacks */</span>
<a name="l00597"></a>00597     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#abb5fbddff0d34e9200d29c5aa512900c">edbm_extrude_edges_exec</a>;
<a name="l00598"></a>00598     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00599"></a>00599     
<a name="l00600"></a>00600     <span class="comment">/* flags */</span>
<a name="l00601"></a>00601     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603     <span class="comment">/* to give to transform */</span>
<a name="l00604"></a>00604     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mirror&quot;</span>, 0, <span class="stringliteral">&quot;Mirror Editing&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00605"></a>00605 }
<a name="l00606"></a>00606 
<a name="l00607"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a647b456535da44923ad27433d084004d">00607</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a647b456535da44923ad27433d084004d">edbm_extrude_faces_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00608"></a>00608 {
<a name="l00609"></a>00609     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00610"></a>00610     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00611"></a>00611     <span class="keywordtype">float</span> nor[3];
<a name="l00612"></a>00612 
<a name="l00613"></a>00613     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acc2c6d94c25b2e8293f644270da94ff1">edbm_extrude_face_indiv</a>(em, op, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00614"></a>00614     
<a name="l00615"></a>00615     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit);
<a name="l00616"></a>00616     
<a name="l00617"></a>00617     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00620"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aa57da02a8c9d448da0239e2ad73a119a">00620</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab59ea82dc4782fa1e1f8e054eacd6528">MESH_OT_extrude_faces_indiv</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00621"></a>00621 {
<a name="l00622"></a>00622     <span class="comment">/* identifiers */</span>
<a name="l00623"></a>00623     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Extrude Individual Faces&quot;</span>;
<a name="l00624"></a>00624     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_extrude_faces_indiv&quot;</span>;
<a name="l00625"></a>00625     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Extrude individual faces only&quot;</span>;
<a name="l00626"></a>00626     
<a name="l00627"></a>00627     <span class="comment">/* api callbacks */</span>
<a name="l00628"></a>00628     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a647b456535da44923ad27433d084004d">edbm_extrude_faces_exec</a>;
<a name="l00629"></a>00629     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00630"></a>00630     
<a name="l00631"></a>00631     <span class="comment">/* flags */</span>
<a name="l00632"></a>00632     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00633"></a>00633 
<a name="l00634"></a>00634     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mirror&quot;</span>, 0, <span class="stringliteral">&quot;Mirror Editing&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00635"></a>00635 }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 <span class="comment">/* ******************** (de)select all operator **************** */</span>
<a name="l00638"></a>00638 
<a name="l00639"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a024601c104e4dd255b4a26d4aa59783a">00639</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a024601c104e4dd255b4a26d4aa59783a">edbm_select_all_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00640"></a>00640 {
<a name="l00641"></a>00641     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00642"></a>00642     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00643"></a>00643     <span class="keywordtype">int</span> action = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;action&quot;</span>);
<a name="l00644"></a>00644     
<a name="l00645"></a>00645     <span class="keywordflow">switch</span> (action) {
<a name="l00646"></a>00646         <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#a070b8f09bd544f3d0bd5786ca00cda02">SEL_TOGGLE</a>:
<a name="l00647"></a>00647             <a class="code" href="../../d5/dd6/ED__mesh_8h.html#abf013f80d335a9a465e8130f9660bc11">EDBM_select_toggle_all</a>(em);
<a name="l00648"></a>00648             <span class="keywordflow">break</span>;
<a name="l00649"></a>00649         <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#af76323cc5b70d4cbeca6b3887e166fb8">SEL_SELECT</a>:
<a name="l00650"></a>00650             <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a91005733b0c49b5af24f2019ceebaee7">EDBM_flag_enable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00651"></a>00651             <span class="keywordflow">break</span>;
<a name="l00652"></a>00652         <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#a94dcbe0e237e6d615cad805221261370">SEL_DESELECT</a>:
<a name="l00653"></a>00653             <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00654"></a>00654             <span class="keywordflow">break</span>;
<a name="l00655"></a>00655         <span class="keywordflow">case</span> <a class="code" href="../../d4/d7f/WM__api_8h.html#ac906797cc9a2787004c6ad16b8151913">SEL_INVERT</a>:
<a name="l00656"></a>00656             <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ac5f182699abe3a94819d59bad89f1359">EDBM_select_swap</a>(em);
<a name="l00657"></a>00657             <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(em);
<a name="l00658"></a>00658             <span class="keywordflow">break</span>;
<a name="l00659"></a>00659     }
<a name="l00660"></a>00660 
<a name="l00661"></a>00661     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00664"></a>00664 }
<a name="l00665"></a>00665 
<a name="l00666"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#af01b8575918aca90d20f4ab13a243735">00666</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ae0ef45058abd707e47f4e29cd69de02c">MESH_OT_select_all</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00667"></a>00667 {
<a name="l00668"></a>00668     <span class="comment">/* identifiers */</span>
<a name="l00669"></a>00669     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;(De)select All&quot;</span>;
<a name="l00670"></a>00670     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_select_all&quot;</span>;
<a name="l00671"></a>00671     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;(De)select all vertices, edges or faces&quot;</span>;
<a name="l00672"></a>00672     
<a name="l00673"></a>00673     <span class="comment">/* api callbacks */</span>
<a name="l00674"></a>00674     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a024601c104e4dd255b4a26d4aa59783a">edbm_select_all_exec</a>;
<a name="l00675"></a>00675     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00676"></a>00676     
<a name="l00677"></a>00677     <span class="comment">/* flags */</span>
<a name="l00678"></a>00678     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680     <a class="code" href="../../d6/dae/wm__operators_8c.html#ab59cd94616324bb4f3668be8f64bdcd8">WM_operator_properties_select_all</a>(ot);
<a name="l00681"></a>00681 }
<a name="l00682"></a>00682 
<a name="l00683"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af092ca3bed09ee6f13f03e9fd5b68854">00683</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af092ca3bed09ee6f13f03e9fd5b68854">edbm_faces_select_interior_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l00684"></a>00684 {
<a name="l00685"></a>00685     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00686"></a>00686     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00687"></a>00687 
<a name="l00688"></a>00688     <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd6/ED__mesh_8h.html#a5cb10a8181caf2ebd3524911ba2872de">EDBM_select_interior_faces</a>(em)) {
<a name="l00689"></a>00689         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit);
<a name="l00690"></a>00690 
<a name="l00691"></a>00691         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00692"></a>00692     }
<a name="l00693"></a>00693     <span class="keywordflow">else</span> {
<a name="l00694"></a>00694         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 
<a name="l00699"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a8f4ec39901f84ad3762fac33701aba3f">00699</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad3fc8d76752a6fa71ff195adebe7281e">MESH_OT_select_interior_faces</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00700"></a>00700 {
<a name="l00701"></a>00701     <span class="comment">/* identifiers */</span>
<a name="l00702"></a>00702     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select Interior Faces&quot;</span>;
<a name="l00703"></a>00703     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_select_interior_faces&quot;</span>;
<a name="l00704"></a>00704     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select faces where all edges have more than 2 face users&quot;</span>;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706     <span class="comment">/* api callbacks */</span>
<a name="l00707"></a>00707     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af092ca3bed09ee6f13f03e9fd5b68854">edbm_faces_select_interior_exec</a>;
<a name="l00708"></a>00708     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710     <span class="comment">/* flags */</span>
<a name="l00711"></a>00711     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00712"></a>00712 }
<a name="l00713"></a>00713 
<a name="l00714"></a>00714 <span class="comment">/* *************** add-click-mesh (extrude) operator ************** */</span>
<a name="l00715"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a51a48257fbe76d4b25ef34e38a304059">00715</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a51a48257fbe76d4b25ef34e38a304059">edbm_dupli_extrude_cursor_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00716"></a>00716 {
<a name="l00717"></a>00717     <a class="code" href="../../d8/d30/structViewContext.html">ViewContext</a> vc;
<a name="l00718"></a>00718     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *v1;
<a name="l00719"></a>00719     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l00720"></a>00720     <span class="keywordtype">float</span> <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>[3], <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>[3];
<a name="l00721"></a>00721     <span class="keywordtype">int</span> done = 0;
<a name="l00722"></a>00722     <span class="keywordtype">short</span> use_proj;
<a name="l00723"></a>00723     
<a name="l00724"></a>00724     <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a23a15b03b570d870fde800400a009714">em_setup_viewcontext</a>(C, &amp;vc);
<a name="l00725"></a>00725     
<a name="l00726"></a>00726     use_proj = ((vc.<a class="code" href="../../d8/d30/structViewContext.html#a318ac2fefa5f4e6ad6faa0a7249d7e73">scene</a>-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a753542d0c510180f622f335a359c9b43">snap_flag</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3b43ed19c4ceb5efbb2d20215536819d">SCE_SNAP</a>) &amp;&amp;
<a name="l00727"></a>00727                 (vc.<a class="code" href="../../d8/d30/structViewContext.html#a318ac2fefa5f4e6ad6faa0a7249d7e73">scene</a>-&gt;<a class="code" href="../../d9/d27/structScene.html#a6723b2b9cc9129060c7b2b5c3de1cc77">toolsettings</a>-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a949506996d3839db0ad369c30374fa6a">snap_mode</a> == <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a40f93d2a2b12ccca7295d1194dfd5351">SCE_SNAP_MODE_FACE</a>));
<a name="l00728"></a>00728 
<a name="l00729"></a>00729     <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a329751705c70a4b2fd8a24744f172bb2">INIT_MINMAX</a>(min, max);
<a name="l00730"></a>00730     
<a name="l00731"></a>00731     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (v1, &amp;iter, vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l00732"></a>00732         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(v1, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l00733"></a>00733             <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a56471388e0045022014f3a365af6b34a">DO_MINMAX</a>(v1-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, min, max);
<a name="l00734"></a>00734             done = 1;
<a name="l00735"></a>00735         }
<a name="l00736"></a>00736     }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738     <span class="comment">/* call extrude? */</span>
<a name="l00739"></a>00739     <span class="keywordflow">if</span> (done) {
<a name="l00740"></a>00740         <span class="keyword">const</span> <span class="keywordtype">short</span> rot_src = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;rotate_source&quot;</span>);
<a name="l00741"></a>00741         <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l00742"></a>00742         <span class="keywordtype">float</span> vec[3], cent[3], mat[3][3];
<a name="l00743"></a>00743         <span class="keywordtype">float</span> nor[3] = {0.0, 0.0, 0.0};
<a name="l00744"></a>00744 
<a name="l00745"></a>00745         <span class="comment">/* 2D normal calc */</span>
<a name="l00746"></a>00746         <span class="keywordtype">float</span> mval_f[2];
<a name="l00747"></a>00747 
<a name="l00748"></a>00748         mval_f[0] = (float)event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[0];
<a name="l00749"></a>00749         mval_f[1] = (<span class="keywordtype">float</span>)<span class="keyword">event</span>-&gt;mval[1];
<a name="l00750"></a>00750 
<a name="l00751"></a>00751         <span class="comment">/* check for edges that are half selected, use for rotation */</span>
<a name="l00752"></a>00752         done = 0;
<a name="l00753"></a>00753         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l00754"></a>00754             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l00755"></a>00755                 <span class="keywordtype">float</span> co1[3], co2[3];
<a name="l00756"></a>00756                 <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad7be0179ee8a128512e2c7f0ad11c8d8">mul_v3_m4v3</a>(co1, vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l00757"></a>00757                 <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad7be0179ee8a128512e2c7f0ad11c8d8">mul_v3_m4v3</a>(co2, vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l00758"></a>00758                 <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a4551d98f490ec042932367ef422a8ba1">project_float_noclip</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a6f44641101d37b3ad843fabd70e185c8">ar</a>, co1, co1);
<a name="l00759"></a>00759                 <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a4551d98f490ec042932367ef422a8ba1">project_float_noclip</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a6f44641101d37b3ad843fabd70e185c8">ar</a>, co2, co2);
<a name="l00760"></a>00760 
<a name="l00761"></a>00761                 <span class="comment">/* 2D rotate by 90d while adding.</span>
<a name="l00762"></a>00762 <span class="comment">                 *  (x, y) = (y, -x)</span>
<a name="l00763"></a>00763 <span class="comment">                 *</span>
<a name="l00764"></a>00764 <span class="comment">                 * accumulate the screenspace normal in 2D,</span>
<a name="l00765"></a>00765 <span class="comment">                 * with screenspace edge length weighting the result. */</span>
<a name="l00766"></a>00766                 <span class="keywordflow">if</span> (<a class="code" href="../../d3/d86/BLI__math__vector_8h.html#add9c817e9a33440a66811533cccb45cc">line_point_side_v2</a>(co1, co2, mval_f) &gt;= 0.0f) {
<a name="l00767"></a>00767                     nor[0] +=  (co1[1] - co2[1]);
<a name="l00768"></a>00768                     nor[1] += -(co1[0] - co2[0]);
<a name="l00769"></a>00769                 }
<a name="l00770"></a>00770                 <span class="keywordflow">else</span> {
<a name="l00771"></a>00771                     nor[0] +=  (co2[1] - co1[1]);
<a name="l00772"></a>00772                     nor[1] += -(co2[0] - co1[0]);
<a name="l00773"></a>00773                 }
<a name="l00774"></a>00774             }
<a name="l00775"></a>00775             done = 1;
<a name="l00776"></a>00776         }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778         <span class="keywordflow">if</span> (done) {
<a name="l00779"></a>00779             <span class="keywordtype">float</span> view_vec[3], <a class="code" href="../../d1/d22/stdosl_8h.html#af89a44efb4de11d737647ee46ef3d304">cross</a>[3];
<a name="l00780"></a>00780 
<a name="l00781"></a>00781             <span class="comment">/* convert the 2D nomal into 3D */</span>
<a name="l00782"></a>00782             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad5cae73de10c30273f8c0fdc00fa648c">mul_mat3_m4_v3</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#ae849219034a130d5a58b5164ab8fc960">rv3d</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aef4739e48c5265fc0185283cd9f92303">viewinv</a>, nor); <span class="comment">/* worldspace */</span>
<a name="l00783"></a>00783             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad5cae73de10c30273f8c0fdc00fa648c">mul_mat3_m4_v3</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>, nor); <span class="comment">/* local space */</span>
<a name="l00784"></a>00784 
<a name="l00785"></a>00785             <span class="comment">/* correct the normal to be aligned on the view plane */</span>
<a name="l00786"></a>00786             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(view_vec, vc.<a class="code" href="../../d8/d30/structViewContext.html#ae849219034a130d5a58b5164ab8fc960">rv3d</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aef4739e48c5265fc0185283cd9f92303">viewinv</a>[2]);
<a name="l00787"></a>00787             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ad5cae73de10c30273f8c0fdc00fa648c">mul_mat3_m4_v3</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>, view_vec);
<a name="l00788"></a>00788             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a8828e92cd5d3d481c95a1745c94c1c6f">cross_v3_v3v3</a>(cross, nor, view_vec);
<a name="l00789"></a>00789             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a8828e92cd5d3d481c95a1745c94c1c6f">cross_v3_v3v3</a>(nor, view_vec, cross);
<a name="l00790"></a>00790             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a3b49789e4776d019ff5756b73df2f3a1">normalize_v3</a>(nor);
<a name="l00791"></a>00791         }
<a name="l00792"></a>00792         
<a name="l00793"></a>00793         <span class="comment">/* center */</span>
<a name="l00794"></a>00794         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#ac3186a97188a3cf15bc5e2f8b0e97ad2">mid_v3_v3v3</a>(cent, min, max);
<a name="l00795"></a>00795         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(min, cent);
<a name="l00796"></a>00796 
<a name="l00797"></a>00797         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2fc1e6236f291e8cf3b62c8e0541eb00">mul_m4_v3</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, min);  <span class="comment">/* view space */</span>
<a name="l00798"></a>00798         <a class="code" href="../../d8/d6a/ED__view3d_8h.html#abd95d019b4c65c5fa61f12f4c665c455">view3d_get_view_aligned_coordinate</a>(&amp;vc, min, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00799"></a>00799         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2fc1e6236f291e8cf3b62c8e0541eb00">mul_m4_v3</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>, min); <span class="comment">// back in object space</span>
<a name="l00800"></a>00800 
<a name="l00801"></a>00801         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a3d305087815afcd193f1d6e561537c34">sub_v3_v3</a>(min, cent);
<a name="l00802"></a>00802         
<a name="l00803"></a>00803         <span class="comment">/* calculate rotation */</span>
<a name="l00804"></a>00804         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ac2ec10af660a2f1d912816c842f37bfb">unit_m3</a>(mat);
<a name="l00805"></a>00805         <span class="keywordflow">if</span> (done) {
<a name="l00806"></a>00806             <span class="keywordtype">float</span> <a class="code" href="../../d9/d42/btQuaternion_8h.html#a0dbf74d697e478378c0c48ef948cac37" title="Return the angle between two quaternions.">angle</a>;
<a name="l00807"></a>00807 
<a name="l00808"></a>00808             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#aaa8b4ca59d77eb2612341c608507e087">normalize_v3_v3</a>(vec, min);
<a name="l00809"></a>00809 
<a name="l00810"></a>00810             angle = <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a4a2003033c639cab3de101b1cfe7a595">angle_normalized_v3v3</a>(vec, nor);
<a name="l00811"></a>00811 
<a name="l00812"></a>00812             <span class="keywordflow">if</span> (angle != 0.0f) {
<a name="l00813"></a>00813                 <span class="keywordtype">float</span> axis[3];
<a name="l00814"></a>00814 
<a name="l00815"></a>00815                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a8828e92cd5d3d481c95a1745c94c1c6f">cross_v3_v3v3</a>(axis, nor, vec);
<a name="l00816"></a>00816 
<a name="l00817"></a>00817                 <span class="comment">/* halve the rotation if its applied twice */</span>
<a name="l00818"></a>00818                 <span class="keywordflow">if</span> (rot_src) {
<a name="l00819"></a>00819                     angle *= 0.5f;
<a name="l00820"></a>00820                 }
<a name="l00821"></a>00821 
<a name="l00822"></a>00822                 <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#aa804c4cef742fd7a1dd820bf0128ad4a">axis_angle_to_mat3</a>(mat, axis, angle);
<a name="l00823"></a>00823             }
<a name="l00824"></a>00824         }
<a name="l00825"></a>00825         
<a name="l00826"></a>00826         <span class="keywordflow">if</span> (rot_src) {
<a name="l00827"></a>00827             <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>, op, <span class="stringliteral">&quot;rotate verts=%hv cent=%v mat=%m3&quot;</span>,
<a name="l00828"></a>00828                           <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, cent, mat);
<a name="l00829"></a>00829 
<a name="l00830"></a>00830             <span class="comment">/* also project the source, for retopo workflow */</span>
<a name="l00831"></a>00831             <span class="keywordflow">if</span> (use_proj)
<a name="l00832"></a>00832                 <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ae7828cf5634205da2001786ddf347150">EMBM_project_snap_verts</a>(C, vc.<a class="code" href="../../d8/d30/structViewContext.html#a6f44641101d37b3ad843fabd70e185c8">ar</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>);
<a name="l00833"></a>00833         }
<a name="l00834"></a>00834 
<a name="l00835"></a>00835         <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a25403be13b78b38a529e57a9eab3ae3b">edbm_extrude_edge</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, nor);
<a name="l00836"></a>00836         <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>, op, <span class="stringliteral">&quot;rotate verts=%hv cent=%v mat=%m3&quot;</span>,
<a name="l00837"></a>00837                       <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, cent, mat);
<a name="l00838"></a>00838         <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>, op, <span class="stringliteral">&quot;translate verts=%hv vec=%v&quot;</span>,
<a name="l00839"></a>00839                       <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, min);
<a name="l00840"></a>00840     }
<a name="l00841"></a>00841     <span class="keywordflow">else</span> {
<a name="l00842"></a>00842         <span class="keywordtype">float</span> *curs = <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a56c6dfa9088d0f90552a67074a359c97">give_cursor</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a318ac2fefa5f4e6ad6faa0a7249d7e73">scene</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#ac33fdbda0e0b759a8f12a889216d6945">v3d</a>);
<a name="l00843"></a>00843         <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l00844"></a>00844         <a class="code" href="../../d6/d38/structBMOIter.html">BMOIter</a> oiter;
<a name="l00845"></a>00845         
<a name="l00846"></a>00846         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(min, curs);
<a name="l00847"></a>00847         <a class="code" href="../../d8/d6a/ED__view3d_8h.html#abd95d019b4c65c5fa61f12f4c665c455">view3d_get_view_aligned_coordinate</a>(&amp;vc, min, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>, 0);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#aab557e66ccdc3534593b413d9b2d7fe8">invert_m4_m4</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>);
<a name="l00850"></a>00850         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2fc1e6236f291e8cf3b62c8e0541eb00">mul_m4_v3</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>, min); <span class="comment">// back in object space</span>
<a name="l00851"></a>00851         
<a name="l00852"></a>00852         <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>, &amp;bmop, op, <span class="stringliteral">&quot;makevert co=%v&quot;</span>, min);
<a name="l00853"></a>00853         <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l00854"></a>00854 
<a name="l00855"></a>00855         <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#aceabf419741150f3784043c9d081ac2e">BMO_ITER</a> (v1, &amp;oiter, vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;newvertout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>) {
<a name="l00856"></a>00856             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, v1, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00857"></a>00857         }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l00860"></a>00860             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00861"></a>00861         }
<a name="l00862"></a>00862     }
<a name="l00863"></a>00863 
<a name="l00864"></a>00864     <span class="keywordflow">if</span> (use_proj)
<a name="l00865"></a>00865         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ae7828cf5634205da2001786ddf347150">EMBM_project_snap_verts</a>(C, vc.<a class="code" href="../../d8/d30/structViewContext.html#a6f44641101d37b3ad843fabd70e185c8">ar</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>);
<a name="l00866"></a>00866 
<a name="l00867"></a>00867     <span class="comment">/* This normally happens when pushing undo but modal operators</span>
<a name="l00868"></a>00868 <span class="comment">     * like this one don&#39;t push undo data until after modal mode is</span>
<a name="l00869"></a>00869 <span class="comment">     * done. */</span>
<a name="l00870"></a>00870     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afc818d571d27864536e18764e9c44a86">EDBM_mesh_normals_update</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>);
<a name="l00871"></a>00871 
<a name="l00872"></a>00872     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00873"></a>00873 
<a name="l00874"></a>00874     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00875"></a>00875 }
<a name="l00876"></a>00876 
<a name="l00877"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a6ccbbb09482261aff8cbc6de8ad06b1f">00877</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a015e30f32ce3bc2b4b67b06a012032c0">MESH_OT_dupli_extrude_cursor</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00878"></a>00878 {
<a name="l00879"></a>00879     <span class="comment">/* identifiers */</span>
<a name="l00880"></a>00880     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Duplicate or Extrude at 3D Cursor&quot;</span>;
<a name="l00881"></a>00881     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_dupli_extrude_cursor&quot;</span>;
<a name="l00882"></a>00882     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Duplicate and extrude selected vertices, edges or faces towards the mouse cursor&quot;</span>;
<a name="l00883"></a>00883     
<a name="l00884"></a>00884     <span class="comment">/* api callbacks */</span>
<a name="l00885"></a>00885     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a51a48257fbe76d4b25ef34e38a304059">edbm_dupli_extrude_cursor_invoke</a>;
<a name="l00886"></a>00886     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00887"></a>00887     
<a name="l00888"></a>00888     <span class="comment">/* flags */</span>
<a name="l00889"></a>00889     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00890"></a>00890 
<a name="l00891"></a>00891     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;rotate_source&quot;</span>, 1, <span class="stringliteral">&quot;Rotate Source&quot;</span>, <span class="stringliteral">&quot;Rotate initial selection giving better shape&quot;</span>);
<a name="l00892"></a>00892 }
<a name="l00893"></a>00893 
<a name="l00894"></a>00894 <span class="comment">/* Note, these values must match delete_mesh() event values */</span>
<a name="l00895"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6eb516ba7cd4e483d99afb8c42773071">00895</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6eb516ba7cd4e483d99afb8c42773071">prop_mesh_delete_types</a>[] = {
<a name="l00896"></a>00896     {0, <span class="stringliteral">&quot;VERT&quot;</span>,      0, <span class="stringliteral">&quot;Vertices&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00897"></a>00897     {1,  <span class="stringliteral">&quot;EDGE&quot;</span>,      0, <span class="stringliteral">&quot;Edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00898"></a>00898     {2,  <span class="stringliteral">&quot;FACE&quot;</span>,      0, <span class="stringliteral">&quot;Faces&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00899"></a>00899     {3,  <span class="stringliteral">&quot;EDGE_FACE&quot;</span>, 0, <span class="stringliteral">&quot;Edges &amp; Faces&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00900"></a>00900     {4,  <span class="stringliteral">&quot;ONLY_FACE&quot;</span>, 0, <span class="stringliteral">&quot;Only Faces&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00901"></a>00901     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00902"></a>00902 };
<a name="l00903"></a>00903 
<a name="l00904"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a81dbb6cc1ef2952bfb3b78646d3a17bd">00904</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a81dbb6cc1ef2952bfb3b78646d3a17bd">edbm_delete_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00905"></a>00905 {
<a name="l00906"></a>00906     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00907"></a>00907     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00908"></a>00908     <span class="keywordtype">int</span> type = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l00909"></a>00909 
<a name="l00910"></a>00910     <span class="keywordflow">if</span> (type == 0) {
<a name="l00911"></a>00911         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;del geom=%hv context=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87eddaa0158e5b0ed23eeeb6d2c84d9f7ec21b">DEL_VERTS</a>)) <span class="comment">/* Erase Vertices */</span>
<a name="l00912"></a>00912             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00913"></a>00913     }
<a name="l00914"></a>00914     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 1) {
<a name="l00915"></a>00915         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;del geom=%he context=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87edda17039e8ade216c79cb1bfa77901f6b3b">DEL_EDGES</a>)) <span class="comment">/* Erase Edges */</span>
<a name="l00916"></a>00916             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00917"></a>00917     }
<a name="l00918"></a>00918     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 2) {
<a name="l00919"></a>00919         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;del geom=%hf context=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87edda5677f7b6066364293961f44ed1eb9a33">DEL_FACES</a>)) <span class="comment">/* Erase Faces */</span>
<a name="l00920"></a>00920             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00921"></a>00921     }
<a name="l00922"></a>00922     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 3) {
<a name="l00923"></a>00923         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;del geom=%hef context=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87edda0db25d26f6a5ca6150685983308c4f2d">DEL_EDGESFACES</a>)) <span class="comment">/* Edges and Faces */</span>
<a name="l00924"></a>00924             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00925"></a>00925     }
<a name="l00926"></a>00926     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 4) {
<a name="l00927"></a>00927         <span class="comment">//&quot;Erase Only Faces&quot;;</span>
<a name="l00928"></a>00928         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;del geom=%hf context=%i&quot;</span>,
<a name="l00929"></a>00929                            <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87edda8795e553eeb826902e3d217fc7e6fed7">DEL_ONLYFACES</a>))
<a name="l00930"></a>00930             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00931"></a>00931     }
<a name="l00932"></a>00932 
<a name="l00933"></a>00933     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l00934"></a>00934 
<a name="l00935"></a>00935     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00936"></a>00936     
<a name="l00937"></a>00937     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00938"></a>00938 }
<a name="l00939"></a>00939 
<a name="l00940"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a74d92384a637772d755173f3e120d376">00940</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3d862e8df938e2a4cb04c78b7a30e13f">MESH_OT_delete</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00941"></a>00941 {
<a name="l00942"></a>00942     <span class="comment">/* identifiers */</span>
<a name="l00943"></a>00943     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Delete&quot;</span>;
<a name="l00944"></a>00944     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Delete selected vertices, edges or faces&quot;</span>;
<a name="l00945"></a>00945     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_delete&quot;</span>;
<a name="l00946"></a>00946     
<a name="l00947"></a>00947     <span class="comment">/* api callbacks */</span>
<a name="l00948"></a>00948     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l00949"></a>00949     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a81dbb6cc1ef2952bfb3b78646d3a17bd">edbm_delete_exec</a>;
<a name="l00950"></a>00950     
<a name="l00951"></a>00951     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00952"></a>00952     
<a name="l00953"></a>00953     <span class="comment">/* flags */</span>
<a name="l00954"></a>00954     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00955"></a>00955 
<a name="l00956"></a>00956     <span class="comment">/* props */</span>
<a name="l00957"></a>00957     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_mesh_delete_types, 0, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Method used for deleting mesh data&quot;</span>);
<a name="l00958"></a>00958 }
<a name="l00959"></a>00959 
<a name="l00960"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9d9f3233c464d50f327ae1fc2312462e">00960</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9d9f3233c464d50f327ae1fc2312462e">edbm_collapse_edge_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00961"></a>00961 {
<a name="l00962"></a>00962     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00963"></a>00963     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;collapse edges=%he&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l00966"></a>00966         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00967"></a>00967 
<a name="l00968"></a>00968     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00969"></a>00969 
<a name="l00970"></a>00970     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00971"></a>00971 }
<a name="l00972"></a>00972 
<a name="l00973"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aaa3f17b1973a59eb3aed40b13a951581">00973</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af0c1b53cee2e0a7a93a792c13772bba1">MESH_OT_edge_collapse</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00974"></a>00974 {
<a name="l00975"></a>00975     <span class="comment">/* identifiers */</span>
<a name="l00976"></a>00976     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Edge Collapse&quot;</span>;
<a name="l00977"></a>00977     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Collapse selected edges&quot;</span>;
<a name="l00978"></a>00978     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_edge_collapse&quot;</span>;
<a name="l00979"></a>00979 
<a name="l00980"></a>00980     <span class="comment">/* api callbacks */</span>
<a name="l00981"></a>00981     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9d9f3233c464d50f327ae1fc2312462e">edbm_collapse_edge_exec</a>;
<a name="l00982"></a>00982     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l00983"></a>00983 
<a name="l00984"></a>00984     <span class="comment">/* flags */</span>
<a name="l00985"></a>00985     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l00986"></a>00986 }
<a name="l00987"></a>00987 
<a name="l00988"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#afdd44feb9a041beb047e00ba9eafc377">00988</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afdd44feb9a041beb047e00ba9eafc377">edbm_collapse_edge_loop_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00989"></a>00989 {
<a name="l00990"></a>00990     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00991"></a>00991     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00992"></a>00992 
<a name="l00993"></a>00993     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;dissolve_edge_loop edges=%he&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l00994"></a>00994         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00995"></a>00995 
<a name="l00996"></a>00996     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00997"></a>00997 
<a name="l00998"></a>00998     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00999"></a>00999 }
<a name="l01000"></a>01000 
<a name="l01001"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a76cdebe6ea150ec86ce8dba112d720d1">01001</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aea1cbc022b7530eb7a67c2e037817ffa">MESH_OT_edge_collapse_loop</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01002"></a>01002 {
<a name="l01003"></a>01003     <span class="comment">/* identifiers */</span>
<a name="l01004"></a>01004     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Edge Collapse Loop&quot;</span>;
<a name="l01005"></a>01005     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Collapse selected edge loops&quot;</span>;
<a name="l01006"></a>01006     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_edge_collapse_loop&quot;</span>;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     <span class="comment">/* api callbacks */</span>
<a name="l01009"></a>01009     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afdd44feb9a041beb047e00ba9eafc377">edbm_collapse_edge_loop_exec</a>;
<a name="l01010"></a>01010     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01011"></a>01011 
<a name="l01012"></a>01012     <span class="comment">/* flags */</span>
<a name="l01013"></a>01013     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01014"></a>01014 }
<a name="l01015"></a>01015 
<a name="l01016"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#add037b0abb3a770bb9df787f6776000b">01016</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#add037b0abb3a770bb9df787f6776000b">edbm_add_edge_face__smooth_get</a>(<a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm)
<a name="l01017"></a>01017 {
<a name="l01018"></a>01018     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *e;
<a name="l01019"></a>01019     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l01020"></a>01020 
<a name="l01021"></a>01021     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vote_on_smooth[2] = {0, 0};
<a name="l01022"></a>01022 
<a name="l01023"></a>01023     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (e, &amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l01024"></a>01024         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(e, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) &amp;&amp; e-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab9029150e1f571daf0c3e21c0bf6f797">l</a>)
<a name="l01025"></a>01025         {
<a name="l01026"></a>01026             vote_on_smooth[<a class="code" href="../../d8/d74/bmesh__inline_8h.html#acc9aa5235499806894038b264030dab9">BM_elem_flag_test_bool</a>(e-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab9029150e1f571daf0c3e21c0bf6f797">l</a>-&gt;<a class="code" href="../../dc/dd5/structBMLoop.html#a91ef300365e03d63842c7b694626bbb7">f</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a7856d7ed2a68a3204cbc021ec2e57017">BM_ELEM_SMOOTH</a>)]++;
<a name="l01027"></a>01027         }
<a name="l01028"></a>01028     }
<a name="l01029"></a>01029 
<a name="l01030"></a>01030     <span class="keywordflow">return</span> (vote_on_smooth[0] &lt; vote_on_smooth[1]);
<a name="l01031"></a>01031 }
<a name="l01032"></a>01032 
<a name="l01033"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#abeef9d3943165e0e0fadc338b8f28654">01033</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#abeef9d3943165e0e0fadc338b8f28654">edbm_add_edge_face_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01034"></a>01034 {
<a name="l01035"></a>01035     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01036"></a>01036     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01037"></a>01037     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01038"></a>01038     <span class="keyword">const</span> <span class="keywordtype">short</span> use_smooth = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#add037b0abb3a770bb9df787f6776000b">edbm_add_edge_face__smooth_get</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>);
<a name="l01039"></a>01039     <span class="comment">/* when this is used to dissolve we could avoid this, but checking isnt too slow */</span>
<a name="l01040"></a>01040 
<a name="l01041"></a>01041     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op,
<a name="l01042"></a>01042                       <span class="stringliteral">&quot;contextual_create geom=%hfev mat_nr=%i use_smooth=%b&quot;</span>,
<a name="l01043"></a>01043                       <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a60da1c4cfed512004a8b694a5372c8ad">mat_nr</a>, use_smooth))
<a name="l01044"></a>01044     {
<a name="l01045"></a>01045         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01046"></a>01046     }
<a name="l01047"></a>01047     
<a name="l01048"></a>01048     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l01049"></a>01049     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;faceout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01050"></a>01050 
<a name="l01051"></a>01051     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01052"></a>01052         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01053"></a>01053     }
<a name="l01054"></a>01054 
<a name="l01055"></a>01055     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01056"></a>01056     
<a name="l01057"></a>01057     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01058"></a>01058 }
<a name="l01059"></a>01059 
<a name="l01060"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a3ef87ee7b7e240e73e13922ccc9aa245">01060</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af0516a4a79e88717130c85df4a378d8a">MESH_OT_edge_face_add</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01061"></a>01061 {
<a name="l01062"></a>01062     <span class="comment">/* identifiers */</span>
<a name="l01063"></a>01063     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Make Edge/Face&quot;</span>;
<a name="l01064"></a>01064     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Add an edge or face to selected&quot;</span>;
<a name="l01065"></a>01065     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_edge_face_add&quot;</span>;
<a name="l01066"></a>01066     
<a name="l01067"></a>01067     <span class="comment">/* api callbacks */</span>
<a name="l01068"></a>01068     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#abeef9d3943165e0e0fadc338b8f28654">edbm_add_edge_face_exec</a>;
<a name="l01069"></a>01069     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01070"></a>01070     
<a name="l01071"></a>01071     <span class="comment">/* flags */</span>
<a name="l01072"></a>01072     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01073"></a>01073 }
<a name="l01074"></a>01074 
<a name="l01075"></a>01075 <span class="comment">/* ************************* SEAMS AND EDGES **************** */</span>
<a name="l01076"></a>01076 
<a name="l01077"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a35ba89fa0e83be1eab4aa6f72941d1c6">01077</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a35ba89fa0e83be1eab4aa6f72941d1c6">edbm_mark_seam</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01078"></a>01078 {
<a name="l01079"></a>01079     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01080"></a>01080     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01081"></a>01081     <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me = ((<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l01082"></a>01082     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01083"></a>01083     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l01084"></a>01084     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l01085"></a>01085     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l01086"></a>01086     <span class="keywordtype">int</span> <a class="code" href="../../d1/d79/btDbvtBroadphase_8cpp.html#a19b1dda96df6332570b535a0683d8076">clear</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;clear&quot;</span>);
<a name="l01087"></a>01087     
<a name="l01088"></a>01088     <span class="comment">/* auto-enable seams drawing */</span>
<a name="l01089"></a>01089     <span class="keywordflow">if</span> (clear == 0) {
<a name="l01090"></a>01090         me-&gt;<a class="code" href="../../da/d29/structMesh.html#ad595684991ea05e3a160d1b1f523158c">drawflag</a> |= <a class="code" href="../../df/d96/DNA__mesh__types_8h.html#adacf5e88838f2b4f436a14bf1fb3802c">ME_DRAWSEAMS</a>;
<a name="l01091"></a>01091     }
<a name="l01092"></a>01092 
<a name="l01093"></a>01093     <span class="keywordflow">if</span> (clear) {
<a name="l01094"></a>01094         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l01095"></a>01095             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) || <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l01096"></a>01096                 <span class="keywordflow">continue</span>;
<a name="l01097"></a>01097             
<a name="l01098"></a>01098             <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a0d62b989e13c71d9bd5c2ae3f4477591">BM_elem_flag_disable</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a2cc0b5f9695e7e38ce7b0bed337e55d2">BM_ELEM_SEAM</a>);
<a name="l01099"></a>01099         }
<a name="l01100"></a>01100     }
<a name="l01101"></a>01101     <span class="keywordflow">else</span> {
<a name="l01102"></a>01102         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l01103"></a>01103             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) || <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l01104"></a>01104                 <span class="keywordflow">continue</span>;
<a name="l01105"></a>01105             <a class="code" href="../../d8/d74/bmesh__inline_8h.html#ae3e692a09518f835ef5b770ecff8acd2">BM_elem_flag_enable</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a2cc0b5f9695e7e38ce7b0bed337e55d2">BM_ELEM_SEAM</a>);
<a name="l01106"></a>01106         }
<a name="l01107"></a>01107     }
<a name="l01108"></a>01108 
<a name="l01109"></a>01109     <a class="code" href="../../dd/d25/ED__uvedit_8h.html#a1e7ede371a9da505ba14c4570e7950d4">ED_uvedit_live_unwrap</a>(scene, obedit);
<a name="l01110"></a>01110     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01111"></a>01111 
<a name="l01112"></a>01112     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01113"></a>01113 }
<a name="l01114"></a>01114 
<a name="l01115"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a9a01cf00dac73841c5d50932851f00f7">01115</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a640c1e9fc62a91a5a888cb2dc293759b">MESH_OT_mark_seam</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01116"></a>01116 {
<a name="l01117"></a>01117     <span class="comment">/* identifiers */</span>
<a name="l01118"></a>01118     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Mark Seam&quot;</span>;
<a name="l01119"></a>01119     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_mark_seam&quot;</span>;
<a name="l01120"></a>01120     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;(Un)mark selected edges as a seam&quot;</span>;
<a name="l01121"></a>01121     
<a name="l01122"></a>01122     <span class="comment">/* api callbacks */</span>
<a name="l01123"></a>01123     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a35ba89fa0e83be1eab4aa6f72941d1c6">edbm_mark_seam</a>;
<a name="l01124"></a>01124     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01125"></a>01125     
<a name="l01126"></a>01126     <span class="comment">/* flags */</span>
<a name="l01127"></a>01127     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01128"></a>01128     
<a name="l01129"></a>01129     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;clear&quot;</span>, 0, <span class="stringliteral">&quot;Clear&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01130"></a>01130 }
<a name="l01131"></a>01131 
<a name="l01132"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad324c5631c2f50766d8a23e498dd6d3d">01132</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad324c5631c2f50766d8a23e498dd6d3d">edbm_mark_sharp</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01133"></a>01133 {
<a name="l01134"></a>01134     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01135"></a>01135     <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me = ((<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l01136"></a>01136     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01137"></a>01137     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l01138"></a>01138     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l01139"></a>01139     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l01140"></a>01140     <span class="keywordtype">int</span> <a class="code" href="../../d1/d79/btDbvtBroadphase_8cpp.html#a19b1dda96df6332570b535a0683d8076">clear</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;clear&quot;</span>);
<a name="l01141"></a>01141 
<a name="l01142"></a>01142     <span class="comment">/* auto-enable sharp edge drawing */</span>
<a name="l01143"></a>01143     <span class="keywordflow">if</span> (clear == 0) {
<a name="l01144"></a>01144         me-&gt;<a class="code" href="../../da/d29/structMesh.html#ad595684991ea05e3a160d1b1f523158c">drawflag</a> |= <a class="code" href="../../df/d96/DNA__mesh__types_8h.html#a01ec7b5aae5c0f983d57da052c2d4a60">ME_DRAWSHARP</a>;
<a name="l01145"></a>01145     }
<a name="l01146"></a>01146 
<a name="l01147"></a>01147     <span class="keywordflow">if</span> (!clear) {
<a name="l01148"></a>01148         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l01149"></a>01149             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) || <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l01150"></a>01150                 <span class="keywordflow">continue</span>;
<a name="l01151"></a>01151             
<a name="l01152"></a>01152             <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a0d62b989e13c71d9bd5c2ae3f4477591">BM_elem_flag_disable</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a7856d7ed2a68a3204cbc021ec2e57017">BM_ELEM_SMOOTH</a>);
<a name="l01153"></a>01153         }
<a name="l01154"></a>01154     }
<a name="l01155"></a>01155     <span class="keywordflow">else</span> {
<a name="l01156"></a>01156         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l01157"></a>01157             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) || <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l01158"></a>01158                 <span class="keywordflow">continue</span>;
<a name="l01159"></a>01159             
<a name="l01160"></a>01160             <a class="code" href="../../d8/d74/bmesh__inline_8h.html#ae3e692a09518f835ef5b770ecff8acd2">BM_elem_flag_enable</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a7856d7ed2a68a3204cbc021ec2e57017">BM_ELEM_SMOOTH</a>);
<a name="l01161"></a>01161         }
<a name="l01162"></a>01162     }
<a name="l01163"></a>01163 
<a name="l01164"></a>01164     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01165"></a>01165 
<a name="l01166"></a>01166     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01167"></a>01167 }
<a name="l01168"></a>01168 
<a name="l01169"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a33c59175392f8962cadcd353ec8027a3">01169</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aacf4bbe1148429844ac28a323b186cf3">MESH_OT_mark_sharp</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01170"></a>01170 {
<a name="l01171"></a>01171     <span class="comment">/* identifiers */</span>
<a name="l01172"></a>01172     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Mark Sharp&quot;</span>;
<a name="l01173"></a>01173     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_mark_sharp&quot;</span>;
<a name="l01174"></a>01174     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;(Un)mark selected edges as sharp&quot;</span>;
<a name="l01175"></a>01175     
<a name="l01176"></a>01176     <span class="comment">/* api callbacks */</span>
<a name="l01177"></a>01177     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad324c5631c2f50766d8a23e498dd6d3d">edbm_mark_sharp</a>;
<a name="l01178"></a>01178     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01179"></a>01179     
<a name="l01180"></a>01180     <span class="comment">/* flags */</span>
<a name="l01181"></a>01181     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01182"></a>01182     
<a name="l01183"></a>01183     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;clear&quot;</span>, 0, <span class="stringliteral">&quot;Clear&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01184"></a>01184 }
<a name="l01185"></a>01185 
<a name="l01186"></a>01186 
<a name="l01187"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a361685c8580d15e8c04c62c178944051">01187</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a361685c8580d15e8c04c62c178944051">edbm_vert_connect</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01188"></a>01188 {
<a name="l01189"></a>01189     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01190"></a>01190     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01191"></a>01191     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l01192"></a>01192     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01193"></a>01193     <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = 0;
<a name="l01194"></a>01194     
<a name="l01195"></a>01195     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;connectverts verts=%hv&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l01196"></a>01196         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01197"></a>01197     }
<a name="l01198"></a>01198     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(bm, &amp;bmop);
<a name="l01199"></a>01199     len = <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#acb9627a81cc959e16522cfc98456d5ee" title="BMESH OPSTACK GET SLOT.">BMO_slot_get</a>(&amp;bmop, <span class="stringliteral">&quot;edgeout&quot;</span>)-&gt;<a class="code" href="../../db/d91/structBMOpSlot.html#a4b97936c6bb1a32009dd80f5134624ca">len</a>;
<a name="l01200"></a>01200     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01201"></a>01201         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01202"></a>01202     }
<a name="l01203"></a>01203     
<a name="l01204"></a>01204     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01205"></a>01205 
<a name="l01206"></a>01206     <span class="keywordflow">return</span> len ? <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a> : <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01207"></a>01207 }
<a name="l01208"></a>01208 
<a name="l01209"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a4e3fb2568f971f2c4875cda56cc55460">01209</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a55908561a2823993c2b4c03340ed52cd">MESH_OT_vert_connect</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01210"></a>01210 {
<a name="l01211"></a>01211     <span class="comment">/* identifiers */</span>
<a name="l01212"></a>01212     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Vertex Connect&quot;</span>;
<a name="l01213"></a>01213     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_vert_connect&quot;</span>;
<a name="l01214"></a>01214     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Connect 2 vertices of a face by an edge, splitting the face in two&quot;</span>;
<a name="l01215"></a>01215     
<a name="l01216"></a>01216     <span class="comment">/* api callbacks */</span>
<a name="l01217"></a>01217     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a361685c8580d15e8c04c62c178944051">edbm_vert_connect</a>;
<a name="l01218"></a>01218     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01219"></a>01219     
<a name="l01220"></a>01220     <span class="comment">/* flags */</span>
<a name="l01221"></a>01221     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01222"></a>01222 }
<a name="l01223"></a>01223 
<a name="l01224"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3f7bccaf7fc47502c0639ddea5cb8506">01224</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3f7bccaf7fc47502c0639ddea5cb8506">edbm_edge_split_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01225"></a>01225 {
<a name="l01226"></a>01226     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01227"></a>01227     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01228"></a>01228     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l01229"></a>01229     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01230"></a>01230     <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = 0;
<a name="l01231"></a>01231     
<a name="l01232"></a>01232     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;edgesplit edges=%he&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l01233"></a>01233         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01234"></a>01234     }
<a name="l01235"></a>01235     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(bm, &amp;bmop);
<a name="l01236"></a>01236     len = <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#acb9627a81cc959e16522cfc98456d5ee" title="BMESH OPSTACK GET SLOT.">BMO_slot_get</a>(&amp;bmop, <span class="stringliteral">&quot;edgeout&quot;</span>)-&gt;<a class="code" href="../../db/d91/structBMOpSlot.html#a4b97936c6bb1a32009dd80f5134624ca">len</a>;
<a name="l01237"></a>01237     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01238"></a>01238         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01239"></a>01239     }
<a name="l01240"></a>01240     
<a name="l01241"></a>01241     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01242"></a>01242 
<a name="l01243"></a>01243     <span class="keywordflow">return</span> len ? <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a> : <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01244"></a>01244 }
<a name="l01245"></a>01245 
<a name="l01246"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a1884e4d4c94639990f43c7f465c33932">01246</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a36a39428af4b5dec5c11a8ba82fc03ec">MESH_OT_edge_split</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01247"></a>01247 {
<a name="l01248"></a>01248     <span class="comment">/* identifiers */</span>
<a name="l01249"></a>01249     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Edge Split&quot;</span>;
<a name="l01250"></a>01250     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_edge_split&quot;</span>;
<a name="l01251"></a>01251     
<a name="l01252"></a>01252     <span class="comment">/* api callbacks */</span>
<a name="l01253"></a>01253     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3f7bccaf7fc47502c0639ddea5cb8506">edbm_edge_split_exec</a>;
<a name="l01254"></a>01254     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01255"></a>01255     
<a name="l01256"></a>01256     <span class="comment">/* flags */</span>
<a name="l01257"></a>01257     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01258"></a>01258 }
<a name="l01259"></a>01259 
<a name="l01260"></a>01260 <span class="comment">/****************** add duplicate operator ***************/</span>
<a name="l01261"></a>01261 
<a name="l01262"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a379832f63c3571529be14e202e8af477">01262</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a379832f63c3571529be14e202e8af477">edbm_duplicate_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01263"></a>01263 {
<a name="l01264"></a>01264     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01265"></a>01265     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(ob);
<a name="l01266"></a>01266     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01267"></a>01267 
<a name="l01268"></a>01268     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;dupe geom=%hvef&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l01269"></a>01269     
<a name="l01270"></a>01270     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l01271"></a>01271     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l01272"></a>01272 
<a name="l01273"></a>01273     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;newout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a9bf8085857e7d4a80f0a7218f714652c">BM_ALL</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01274"></a>01274 
<a name="l01275"></a>01275     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01276"></a>01276         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01277"></a>01277     }
<a name="l01278"></a>01278 
<a name="l01279"></a>01279     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01280"></a>01280     
<a name="l01281"></a>01281     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01282"></a>01282 }
<a name="l01283"></a>01283 
<a name="l01284"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af615c3cb6f1384ae0b5e8638d5607a72">01284</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af615c3cb6f1384ae0b5e8638d5607a72">edbm_duplicate_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l01285"></a>01285 {
<a name="l01286"></a>01286     <a class="code" href="../../de/d3c/wm__cursors_8c.html#ae5b57427153f1f60f6638a537465c805">WM_cursor_wait</a>(1);
<a name="l01287"></a>01287     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a379832f63c3571529be14e202e8af477">edbm_duplicate_exec</a>(C, op);
<a name="l01288"></a>01288     <a class="code" href="../../de/d3c/wm__cursors_8c.html#ae5b57427153f1f60f6638a537465c805">WM_cursor_wait</a>(0);
<a name="l01289"></a>01289     
<a name="l01290"></a>01290     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01291"></a>01291 }
<a name="l01292"></a>01292 
<a name="l01293"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a4656a1e4047078dc5ad1b558fb850e87">01293</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9d41c04b879a130f750b05cb7f9be344">MESH_OT_duplicate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01294"></a>01294 {
<a name="l01295"></a>01295     <span class="comment">/* identifiers */</span>
<a name="l01296"></a>01296     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Duplicate&quot;</span>;
<a name="l01297"></a>01297     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Duplicate selected vertices, edges or faces&quot;</span>;
<a name="l01298"></a>01298     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_duplicate&quot;</span>;
<a name="l01299"></a>01299     
<a name="l01300"></a>01300     <span class="comment">/* api callbacks */</span>
<a name="l01301"></a>01301     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af615c3cb6f1384ae0b5e8638d5607a72">edbm_duplicate_invoke</a>;
<a name="l01302"></a>01302     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a379832f63c3571529be14e202e8af477">edbm_duplicate_exec</a>;
<a name="l01303"></a>01303     
<a name="l01304"></a>01304     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01305"></a>01305     
<a name="l01306"></a>01306     <span class="comment">/* to give to transform */</span>
<a name="l01307"></a>01307     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mode&quot;</span>, <a class="code" href="../../d8/df2/ED__transform_8h.html#aa57e16cd48de3b9a989056ff8df26f84ac6708d3325ae542bd46d599286c1cf90">TFM_TRANSLATION</a>, 0, INT_MAX, <span class="stringliteral">&quot;Mode&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0, INT_MAX);
<a name="l01308"></a>01308 }
<a name="l01309"></a>01309 
<a name="l01310"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4d0522e2f5e3d06223d4e06f051fb2fa">01310</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4d0522e2f5e3d06223d4e06f051fb2fa">edbm_flip_normals_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01311"></a>01311 {
<a name="l01312"></a>01312     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01313"></a>01313     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01314"></a>01314     
<a name="l01315"></a>01315     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;reversefaces faces=%hf&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l01316"></a>01316         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01317"></a>01317     
<a name="l01318"></a>01318     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01319"></a>01319 
<a name="l01320"></a>01320     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01321"></a>01321 }
<a name="l01322"></a>01322 
<a name="l01323"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#ac3c0619e9e88ceceb2b8191facd2ac89">01323</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aa6ff1414a0e0d2763fff29108ce37c18">MESH_OT_flip_normals</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01324"></a>01324 {
<a name="l01325"></a>01325     <span class="comment">/* identifiers */</span>
<a name="l01326"></a>01326     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Flip Normals&quot;</span>;
<a name="l01327"></a>01327     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Flip the direction of selected faces&#39; normals (and of their vertices)&quot;</span>;
<a name="l01328"></a>01328     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_flip_normals&quot;</span>;
<a name="l01329"></a>01329     
<a name="l01330"></a>01330     <span class="comment">/* api callbacks */</span>
<a name="l01331"></a>01331     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4d0522e2f5e3d06223d4e06f051fb2fa">edbm_flip_normals_exec</a>;
<a name="l01332"></a>01332     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01333"></a>01333     
<a name="l01334"></a>01334     <span class="comment">/* flags */</span>
<a name="l01335"></a>01335     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01336"></a>01336 }
<a name="l01337"></a>01337 
<a name="l01338"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#acc0ca7eba6ad393abd6ef1d4592a738c">01338</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acc0ca7eba6ad393abd6ef1d4592a738c">direction_items</a>[] = {
<a name="l01339"></a>01339     {<a class="code" href="../../de/d95/bmesh__operators_8h.html#afccd240f973cf154952fb917c9209719a0f98509d24ebeef4508c20b9d8bfa0a6">DIRECTION_CW</a>, <span class="stringliteral">&quot;CW&quot;</span>, 0, <span class="stringliteral">&quot;Clockwise&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01340"></a>01340     {<a class="code" href="../../de/d95/bmesh__operators_8h.html#afccd240f973cf154952fb917c9209719ad8096a357e6a61f6746147d0b19467c2">DIRECTION_CCW</a>, <span class="stringliteral">&quot;CCW&quot;</span>, 0, <span class="stringliteral">&quot;Counter Clockwise&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01341"></a>01341     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l01342"></a>01342 
<a name="l01343"></a>01343 <span class="comment">/* only accepts 1 selected edge, or 2 selected faces */</span>
<a name="l01344"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6b6a881800a0e6f1bd25e98dc1bc2c05">01344</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6b6a881800a0e6f1bd25e98dc1bc2c05">edbm_edge_rotate_selected_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01345"></a>01345 {
<a name="l01346"></a>01346     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01347"></a>01347     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01348"></a>01348     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01349"></a>01349     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l01350"></a>01350     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l01351"></a>01351     <span class="keyword">const</span> <span class="keywordtype">int</span> do_ccw = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>) == 1;
<a name="l01352"></a>01352     <span class="keywordtype">int</span> tot = 0;
<a name="l01353"></a>01353 
<a name="l01354"></a>01354     <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#ab7c58bf63d064b3c60054c66d51d193a">totedgesel</a> == 0) {
<a name="l01355"></a>01355         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Select edges or face pairs for edge loops to rotate about&quot;</span>);
<a name="l01356"></a>01356         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01357"></a>01357     }
<a name="l01358"></a>01358 
<a name="l01359"></a>01359     <span class="comment">/* first see if we have two adjacent faces */</span>
<a name="l01360"></a>01360     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l01361"></a>01361         <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a0d62b989e13c71d9bd5c2ae3f4477591">BM_elem_flag_disable</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462ab2324d74ff6431a7851b74c3591044fb">BM_ELEM_TAG</a>);
<a name="l01362"></a>01362         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l01363"></a>01363             <a class="code" href="../../d0/d23/structBMFace.html">BMFace</a> *fa, *<a class="code" href="../../dc/d53/implicit_8c.html#a6593817fe20dfc95a3fb3f71c7b8c996">fb</a>;
<a name="l01364"></a>01364             <span class="keywordflow">if</span> (<a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a08c360aafd2e7b2504160663a52b9f08">BM_edge_face_pair</a>(eed, &amp;fa, &amp;fb)) {
<a name="l01365"></a>01365                 <span class="comment">/* if both faces are selected we rotate between them,</span>
<a name="l01366"></a>01366 <span class="comment">                 * otherwise - rotate between 2 unselected - but not mixed */</span>
<a name="l01367"></a>01367                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(fa, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) == <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(fb, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l01368"></a>01368                     <a class="code" href="../../d8/d74/bmesh__inline_8h.html#ae3e692a09518f835ef5b770ecff8acd2">BM_elem_flag_enable</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462ab2324d74ff6431a7851b74c3591044fb">BM_ELEM_TAG</a>);
<a name="l01369"></a>01369                     tot++;
<a name="l01370"></a>01370                 }
<a name="l01371"></a>01371             }
<a name="l01372"></a>01372         }
<a name="l01373"></a>01373     }
<a name="l01374"></a>01374     
<a name="l01375"></a>01375     <span class="comment">/* ok, we don&#39;t have two adjacent faces, but we do have two selected ones.</span>
<a name="l01376"></a>01376 <span class="comment">     * that&#39;s an error condition.*/</span>
<a name="l01377"></a>01377     <span class="keywordflow">if</span> (tot == 0) {
<a name="l01378"></a>01378         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Could not find any selected edges that can be rotated&quot;</span>);
<a name="l01379"></a>01379         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01380"></a>01380     }
<a name="l01381"></a>01381     
<a name="l01382"></a>01382     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;edgerotate edges=%he ccw=%b&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462ab2324d74ff6431a7851b74c3591044fb">BM_ELEM_TAG</a>, do_ccw);
<a name="l01383"></a>01383 
<a name="l01384"></a>01384     <span class="comment">/* avoids leaving old verts selected which can be a problem running multiple times,</span>
<a name="l01385"></a>01385 <span class="comment">     * since this means the edges become selected around the face which then attempt to rotate */</span>
<a name="l01386"></a>01386     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a1738215546cdb3e92aec2b09328dad3d" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_disable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;edges&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01387"></a>01387 
<a name="l01388"></a>01388     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l01389"></a>01389     <span class="comment">/* edges may rotate into hidden vertices, if this does _not_ run we get an ilogical state */</span>
<a name="l01390"></a>01390     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a1738215546cdb3e92aec2b09328dad3d" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_disable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;edgeout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01391"></a>01391     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;edgeout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01392"></a>01392     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(em);
<a name="l01393"></a>01393 
<a name="l01394"></a>01394     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01395"></a>01395         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01396"></a>01396     }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01399"></a>01399 
<a name="l01400"></a>01400     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01401"></a>01401 }
<a name="l01402"></a>01402 
<a name="l01403"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#ab20b28afd29bfa7d10c2bc5d02341255">01403</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2d62870083b6bba615d8807c666c25b6">MESH_OT_edge_rotate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01404"></a>01404 {
<a name="l01405"></a>01405     <span class="comment">/* identifiers */</span>
<a name="l01406"></a>01406     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Rotate Selected Edge&quot;</span>;
<a name="l01407"></a>01407     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Rotate selected edge or adjoining faces&quot;</span>;
<a name="l01408"></a>01408     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_edge_rotate&quot;</span>;
<a name="l01409"></a>01409 
<a name="l01410"></a>01410     <span class="comment">/* api callbacks */</span>
<a name="l01411"></a>01411     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6b6a881800a0e6f1bd25e98dc1bc2c05">edbm_edge_rotate_selected_exec</a>;
<a name="l01412"></a>01412     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01413"></a>01413 
<a name="l01414"></a>01414     <span class="comment">/* flags */</span>
<a name="l01415"></a>01415     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01416"></a>01416 
<a name="l01417"></a>01417     <span class="comment">/* props */</span>
<a name="l01418"></a>01418     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;direction&quot;</span>, direction_items, <a class="code" href="../../de/d95/bmesh__operators_8h.html#afccd240f973cf154952fb917c9209719a0f98509d24ebeef4508c20b9d8bfa0a6">DIRECTION_CW</a>, <span class="stringliteral">&quot;Direction&quot;</span>, <span class="stringliteral">&quot;Direction to rotate edge around&quot;</span>);
<a name="l01419"></a>01419 }
<a name="l01420"></a>01420 
<a name="l01421"></a>01421 
<a name="l01422"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a72e597ca9a5455089a6a5df4dfda1630">01422</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a72e597ca9a5455089a6a5df4dfda1630">edbm_hide_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01423"></a>01423 {
<a name="l01424"></a>01424     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01425"></a>01425     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01426"></a>01426     
<a name="l01427"></a>01427     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a1b4669783a5813f0330e9aff78907bbf">EDBM_mesh_hide</a>(em, <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;unselected&quot;</span>));
<a name="l01428"></a>01428 
<a name="l01429"></a>01429     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01430"></a>01430 
<a name="l01431"></a>01431     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01432"></a>01432 }
<a name="l01433"></a>01433 
<a name="l01434"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aa72ff2cd0c8b1ab9a974cc531777f679">01434</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0cfb96a209c6c07a449f022b6bab3806">MESH_OT_hide</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01435"></a>01435 {
<a name="l01436"></a>01436     <span class="comment">/* identifiers */</span>
<a name="l01437"></a>01437     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Hide Selection&quot;</span>;
<a name="l01438"></a>01438     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_hide&quot;</span>;
<a name="l01439"></a>01439     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Hide (un)selected vertices, edges or faces&quot;</span>;
<a name="l01440"></a>01440     
<a name="l01441"></a>01441     <span class="comment">/* api callbacks */</span>
<a name="l01442"></a>01442     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a72e597ca9a5455089a6a5df4dfda1630">edbm_hide_exec</a>;
<a name="l01443"></a>01443     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01444"></a>01444 
<a name="l01445"></a>01445     <span class="comment">/* flags */</span>
<a name="l01446"></a>01446     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01447"></a>01447     
<a name="l01448"></a>01448     <span class="comment">/* props */</span>
<a name="l01449"></a>01449     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;unselected&quot;</span>, 0, <span class="stringliteral">&quot;Unselected&quot;</span>, <span class="stringliteral">&quot;Hide unselected rather than selected&quot;</span>);
<a name="l01450"></a>01450 }
<a name="l01451"></a>01451 
<a name="l01452"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3a9d5a239cac2199c10603ad9e6345ec">01452</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3a9d5a239cac2199c10603ad9e6345ec">edbm_reveal_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01453"></a>01453 {
<a name="l01454"></a>01454     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01455"></a>01455     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01456"></a>01456     
<a name="l01457"></a>01457     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a92276b944f0e6bc1847d13d8f5b5c9f7">EDBM_mesh_reveal</a>(em);
<a name="l01458"></a>01458 
<a name="l01459"></a>01459     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01460"></a>01460 
<a name="l01461"></a>01461     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01462"></a>01462 }
<a name="l01463"></a>01463 
<a name="l01464"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a595338cc9aa9cea27e6e87f75366c836">01464</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab26779dcbcb3057e625e5194b95844dc">MESH_OT_reveal</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01465"></a>01465 {
<a name="l01466"></a>01466     <span class="comment">/* identifiers */</span>
<a name="l01467"></a>01467     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Reveal Hidden&quot;</span>;
<a name="l01468"></a>01468     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_reveal&quot;</span>;
<a name="l01469"></a>01469     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Reveal all hidden vertices, edges and faces&quot;</span>;
<a name="l01470"></a>01470     
<a name="l01471"></a>01471     <span class="comment">/* api callbacks */</span>
<a name="l01472"></a>01472     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3a9d5a239cac2199c10603ad9e6345ec">edbm_reveal_exec</a>;
<a name="l01473"></a>01473     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01474"></a>01474     
<a name="l01475"></a>01475     <span class="comment">/* flags */</span>
<a name="l01476"></a>01476     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01477"></a>01477 }
<a name="l01478"></a>01478 
<a name="l01479"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a742683f347fc8e0baa6af1186b0f183e">01479</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a742683f347fc8e0baa6af1186b0f183e">edbm_normals_make_consistent_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01480"></a>01480 {
<a name="l01481"></a>01481     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01482"></a>01482     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01483"></a>01483     
<a name="l01484"></a>01484     <span class="comment">/* doflip has to do with bmesh_rationalize_normals, it&#39;s an internal</span>
<a name="l01485"></a>01485 <span class="comment">     * thing */</span>
<a name="l01486"></a>01486     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;righthandfaces faces=%hf do_flip=%b&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>))
<a name="l01487"></a>01487         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01488"></a>01488 
<a name="l01489"></a>01489     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;inside&quot;</span>))
<a name="l01490"></a>01490         <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;reversefaces faces=%hf&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l01491"></a>01491 
<a name="l01492"></a>01492     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01493"></a>01493 
<a name="l01494"></a>01494     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01495"></a>01495 }
<a name="l01496"></a>01496 
<a name="l01497"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aa4d57050e33c1b0f854d9dbf83ca2478">01497</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9fdd7323302f666702b64ada91e963e5">MESH_OT_normals_make_consistent</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01498"></a>01498 {
<a name="l01499"></a>01499     <span class="comment">/* identifiers */</span>
<a name="l01500"></a>01500     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Make Normals Consistent&quot;</span>;
<a name="l01501"></a>01501     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Make face and vertex normals point either outside or inside the mesh&quot;</span>;
<a name="l01502"></a>01502     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_normals_make_consistent&quot;</span>;
<a name="l01503"></a>01503     
<a name="l01504"></a>01504     <span class="comment">/* api callbacks */</span>
<a name="l01505"></a>01505     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a742683f347fc8e0baa6af1186b0f183e">edbm_normals_make_consistent_exec</a>;
<a name="l01506"></a>01506     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01507"></a>01507     
<a name="l01508"></a>01508     <span class="comment">/* flags */</span>
<a name="l01509"></a>01509     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01510"></a>01510     
<a name="l01511"></a>01511     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;inside&quot;</span>, 0, <span class="stringliteral">&quot;Inside&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01512"></a>01512 }
<a name="l01513"></a>01513 
<a name="l01514"></a>01514 
<a name="l01515"></a>01515 
<a name="l01516"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a099b9fae95e08074e006d66dc376c5d0">01516</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a099b9fae95e08074e006d66dc376c5d0">edbm_do_smooth_vertex_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01517"></a>01517 {
<a name="l01518"></a>01518     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01519"></a>01519     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01520"></a>01520     <a class="code" href="../../db/ddd/structModifierData.html">ModifierData</a> *md;
<a name="l01521"></a>01521     <span class="keywordtype">int</span> mirrx = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, mirry = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, mirrz = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01522"></a>01522     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, repeat;
<a name="l01523"></a>01523     <span class="keywordtype">float</span> clipdist = 0.0f;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525     <span class="comment">/* mirror before smooth */</span>
<a name="l01526"></a>01526     <span class="keywordflow">if</span> (((<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editflag &amp; <a class="code" href="../../df/d96/DNA__mesh__types_8h.html#a5932a31a907f7856e4b33c8617982df4">ME_EDIT_MIRROR_X</a>) {
<a name="l01527"></a>01527         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a8562f3fbedef4b00a94279babfc429f2">EDBM_verts_mirror_cache_begin</a>(em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01528"></a>01528     }
<a name="l01529"></a>01529 
<a name="l01530"></a>01530     <span class="comment">/* if there is a mirror modifier with clipping, flag the verts that</span>
<a name="l01531"></a>01531 <span class="comment">     * are within tolerance of the plane(s) of reflection </span>
<a name="l01532"></a>01532 <span class="comment">     */</span>
<a name="l01533"></a>01533     <span class="keywordflow">for</span> (md = obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a31fdd585d66951dfd084a8e8ee624a8d">modifiers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; md; md = md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a3021bdd74b5a4d99e4ea5ee3a19f8560">next</a>) {
<a name="l01534"></a>01534         <span class="keywordflow">if</span> (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a06b3bfe88f9205bc474fa4a267732b8e">type</a> == <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a96ba018ea46fb28e626c3b573aca5435a251aba7f50f4d9b2d085279bd96d6ee6">eModifierType_Mirror</a> &amp;&amp; (md-&gt;<a class="code" href="../../db/ddd/structModifierData.html#a905ab5cd625053441b2e82efe47e95d1">mode</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a1cab93646b1d30a0ad79c4448bb06601ac434becb714d73f6821cafeeb5b22995">eModifierMode_Realtime</a>)) {
<a name="l01535"></a>01535             <a class="code" href="../../d3/dcc/structMirrorModifierData.html">MirrorModifierData</a> *mmd = (<a class="code" href="../../d3/dcc/structMirrorModifierData.html">MirrorModifierData</a> *)md;
<a name="l01536"></a>01536         
<a name="l01537"></a>01537             <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#ae953c75c2e1ea297d06e64803b25dc93">MOD_MIR_CLIPPING</a>) {
<a name="l01538"></a>01538                 <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#ac5478fa035ffe227f719b371488e3ec4">MOD_MIR_AXIS_X</a>)
<a name="l01539"></a>01539                     mirrx = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01540"></a>01540                 <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#abd93abc70f2b4064c6f3c2173e0f67e8">MOD_MIR_AXIS_Y</a>)
<a name="l01541"></a>01541                     mirry = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01542"></a>01542                 <span class="keywordflow">if</span> (mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#af03c809f339e58d3ce476b4bc46bd4e4">flag</a> &amp; <a class="code" href="../../da/df0/DNA__modifier__types_8h.html#a622f972032eead375e5efb14e63bbcac">MOD_MIR_AXIS_Z</a>)
<a name="l01543"></a>01543                     mirrz = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01544"></a>01544 
<a name="l01545"></a>01545                 clipdist = mmd-&gt;<a class="code" href="../../d3/dcc/structMirrorModifierData.html#a68253eb078151a9b36485cc365d2ffa1">tolerance</a>;
<a name="l01546"></a>01546             }
<a name="l01547"></a>01547         }
<a name="l01548"></a>01548     }
<a name="l01549"></a>01549 
<a name="l01550"></a>01550     repeat = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;repeat&quot;</span>);
<a name="l01551"></a>01551     <span class="keywordflow">if</span> (!repeat)
<a name="l01552"></a>01552         repeat = 1;
<a name="l01553"></a>01553     
<a name="l01554"></a>01554     <span class="keywordflow">for</span> (i = 0; i &lt; repeat; i++) {
<a name="l01555"></a>01555         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op,
<a name="l01556"></a>01556                            <span class="stringliteral">&quot;vertexsmooth verts=%hv mirror_clip_x=%b mirror_clip_y=%b mirror_clip_z=%b clipdist=%f&quot;</span>,
<a name="l01557"></a>01557                            <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, mirrx, mirry, mirrz, clipdist))
<a name="l01558"></a>01558         {
<a name="l01559"></a>01559             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01560"></a>01560         }
<a name="l01561"></a>01561     }
<a name="l01562"></a>01562 
<a name="l01563"></a>01563     <span class="comment">/* apply mirror */</span>
<a name="l01564"></a>01564     <span class="keywordflow">if</span> (((<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editflag &amp; ME_EDIT_MIRROR_X) {
<a name="l01565"></a>01565         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a0b147d2c3ec2aec47aa11ea258052c5d">EDBM_verts_mirror_apply</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, 0);
<a name="l01566"></a>01566         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#aa76ecba29f4840071504d2f8d6cba488">EDBM_verts_mirror_cache_end</a>(em);
<a name="l01567"></a>01567     }
<a name="l01568"></a>01568 
<a name="l01569"></a>01569     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01570"></a>01570 
<a name="l01571"></a>01571     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01572"></a>01572 }   
<a name="l01573"></a>01573     
<a name="l01574"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a7fd25d5b90bca06159bcd13713d83bb7">01574</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a570c6e39d0ea5b15180765a95aeda97d">MESH_OT_vertices_smooth</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01575"></a>01575 {
<a name="l01576"></a>01576     <span class="comment">/* identifiers */</span>
<a name="l01577"></a>01577     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Smooth Vertex&quot;</span>;
<a name="l01578"></a>01578     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Flatten angles of selected vertices&quot;</span>;
<a name="l01579"></a>01579     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_vertices_smooth&quot;</span>;
<a name="l01580"></a>01580     
<a name="l01581"></a>01581     <span class="comment">/* api callbacks */</span>
<a name="l01582"></a>01582     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a099b9fae95e08074e006d66dc376c5d0">edbm_do_smooth_vertex_exec</a>;
<a name="l01583"></a>01583     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01584"></a>01584     
<a name="l01585"></a>01585     <span class="comment">/* flags */</span>
<a name="l01586"></a>01586     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01587"></a>01587 
<a name="l01588"></a>01588     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;repeat&quot;</span>, 1, 1, 100, <span class="stringliteral">&quot;Number of times to smooth the mesh&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 1, INT_MAX);
<a name="l01589"></a>01589 }
<a name="l01590"></a>01590 
<a name="l01591"></a>01591 <span class="comment">/********************** Smooth/Solid Operators *************************/</span>
<a name="l01592"></a>01592 
<a name="l01593"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a92e5f1cd54c8f231e6d445f27fcf6c2c">01593</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a92e5f1cd54c8f231e6d445f27fcf6c2c">mesh_set_smooth_faces</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <span class="keywordtype">short</span> <a class="code" href="../../d2/df6/sculpt_8c.html#a11919b8f48badb89cbb5b795722c22e3">smooth</a>)
<a name="l01594"></a>01594 {
<a name="l01595"></a>01595     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l01596"></a>01596     <a class="code" href="../../d0/d23/structBMFace.html">BMFace</a> *efa;
<a name="l01597"></a>01597 
<a name="l01598"></a>01598     <span class="keywordflow">if</span> (em == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l01599"></a>01599     
<a name="l01600"></a>01600     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (efa, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fabe0fe60283f43cd8ce697d52d24a3c1e">BM_FACES_OF_MESH</a>) {
<a name="l01601"></a>01601         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(efa, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l01602"></a>01602             <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a86447ee04a947592c5b005aea27cebfe">BM_elem_flag_set</a>(efa, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a7856d7ed2a68a3204cbc021ec2e57017">BM_ELEM_SMOOTH</a>, smooth);
<a name="l01603"></a>01603         }
<a name="l01604"></a>01604     }
<a name="l01605"></a>01605 }
<a name="l01606"></a>01606 
<a name="l01607"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac72e96d4fca310c4df5c6b9d9088aa6a">01607</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac72e96d4fca310c4df5c6b9d9088aa6a">edbm_faces_shade_smooth_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01608"></a>01608 {
<a name="l01609"></a>01609     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01610"></a>01610     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01611"></a>01611 
<a name="l01612"></a>01612     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a92e5f1cd54c8f231e6d445f27fcf6c2c">mesh_set_smooth_faces</a>(em, 1);
<a name="l01613"></a>01613 
<a name="l01614"></a>01614     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01615"></a>01615 
<a name="l01616"></a>01616     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01617"></a>01617 }
<a name="l01618"></a>01618 
<a name="l01619"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a24fe355b9b30542266ca5323de2e1134">01619</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad713f417ed9d0d2c669e471ed14f5a37">MESH_OT_faces_shade_smooth</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01620"></a>01620 {
<a name="l01621"></a>01621     <span class="comment">/* identifiers */</span>
<a name="l01622"></a>01622     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Shade Smooth&quot;</span>;
<a name="l01623"></a>01623     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Display faces smooth (using vertex normals)&quot;</span>;
<a name="l01624"></a>01624     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_faces_shade_smooth&quot;</span>;
<a name="l01625"></a>01625 
<a name="l01626"></a>01626     <span class="comment">/* api callbacks */</span>
<a name="l01627"></a>01627     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac72e96d4fca310c4df5c6b9d9088aa6a">edbm_faces_shade_smooth_exec</a>;
<a name="l01628"></a>01628     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01629"></a>01629 
<a name="l01630"></a>01630     <span class="comment">/* flags */</span>
<a name="l01631"></a>01631     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01632"></a>01632 }
<a name="l01633"></a>01633 
<a name="l01634"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a203324c265e431b9dbd8315d32341d95">01634</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a203324c265e431b9dbd8315d32341d95">edbm_faces_shade_flat_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01635"></a>01635 {
<a name="l01636"></a>01636     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01637"></a>01637     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01638"></a>01638 
<a name="l01639"></a>01639     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a92e5f1cd54c8f231e6d445f27fcf6c2c">mesh_set_smooth_faces</a>(em, 0);
<a name="l01640"></a>01640 
<a name="l01641"></a>01641     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01642"></a>01642 
<a name="l01643"></a>01643     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01644"></a>01644 }
<a name="l01645"></a>01645 
<a name="l01646"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#ad6e57a58b766a1bf02189b4964b53ae3">01646</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a29e1ba07c317c11e9f1716b01ba8c2a8">MESH_OT_faces_shade_flat</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01647"></a>01647 {
<a name="l01648"></a>01648     <span class="comment">/* identifiers */</span>
<a name="l01649"></a>01649     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Shade Flat&quot;</span>;
<a name="l01650"></a>01650     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Display faces flat&quot;</span>;
<a name="l01651"></a>01651     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_faces_shade_flat&quot;</span>;
<a name="l01652"></a>01652 
<a name="l01653"></a>01653     <span class="comment">/* api callbacks */</span>
<a name="l01654"></a>01654     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a203324c265e431b9dbd8315d32341d95">edbm_faces_shade_flat_exec</a>;
<a name="l01655"></a>01655     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01656"></a>01656 
<a name="l01657"></a>01657     <span class="comment">/* flags */</span>
<a name="l01658"></a>01658     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01659"></a>01659 }
<a name="l01660"></a>01660 
<a name="l01661"></a>01661 
<a name="l01662"></a>01662 <span class="comment">/********************** UV/Color Operators *************************/</span>
<a name="l01663"></a>01663 
<a name="l01664"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3d9c33266b73387a7f65d97e16b49589">01664</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3d9c33266b73387a7f65d97e16b49589">edbm_rotate_uvs_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01665"></a>01665 {
<a name="l01666"></a>01666     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01667"></a>01667     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(ob);
<a name="l01668"></a>01668     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01669"></a>01669 
<a name="l01670"></a>01670     <span class="comment">/* get the direction from RNA */</span>
<a name="l01671"></a>01671     <span class="keywordtype">int</span> dir = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l01672"></a>01672 
<a name="l01673"></a>01673     <span class="comment">/* initialize the bmop using EDBM api, which does various ui error reporting and other stuff */</span>
<a name="l01674"></a>01674     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;face_rotateuvs faces=%hf dir=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, dir);
<a name="l01675"></a>01675 
<a name="l01676"></a>01676     <span class="comment">/* execute the operator */</span>
<a name="l01677"></a>01677     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l01678"></a>01678 
<a name="l01679"></a>01679     <span class="comment">/* finish the operator */</span>
<a name="l01680"></a>01680     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01681"></a>01681         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01682"></a>01682     }
<a name="l01683"></a>01683 
<a name="l01684"></a>01684     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01685"></a>01685 
<a name="l01686"></a>01686     <span class="comment">/* we succeeded */</span>
<a name="l01687"></a>01687     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01688"></a>01688 }
<a name="l01689"></a>01689 
<a name="l01690"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2032a6d46fd38d089fe4954a608084af">01690</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2032a6d46fd38d089fe4954a608084af">edbm_reverse_uvs_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01691"></a>01691 {
<a name="l01692"></a>01692     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01693"></a>01693     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(ob);
<a name="l01694"></a>01694     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01695"></a>01695 
<a name="l01696"></a>01696     <span class="comment">/* initialize the bmop using EDBM api, which does various ui error reporting and other stuff */</span>
<a name="l01697"></a>01697     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;face_reverseuvs faces=%hf&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l01698"></a>01698 
<a name="l01699"></a>01699     <span class="comment">/* execute the operator */</span>
<a name="l01700"></a>01700     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l01701"></a>01701 
<a name="l01702"></a>01702     <span class="comment">/* finish the operator */</span>
<a name="l01703"></a>01703     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01704"></a>01704         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01705"></a>01705     }
<a name="l01706"></a>01706 
<a name="l01707"></a>01707     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01708"></a>01708 
<a name="l01709"></a>01709     <span class="comment">/* we succeeded */</span>
<a name="l01710"></a>01710     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01711"></a>01711 }
<a name="l01712"></a>01712 
<a name="l01713"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a12d3dfaed9e2659cb626e0565da3fc01">01713</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a12d3dfaed9e2659cb626e0565da3fc01">edbm_rotate_colors_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01714"></a>01714 {
<a name="l01715"></a>01715     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01716"></a>01716     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(ob);
<a name="l01717"></a>01717     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01718"></a>01718 
<a name="l01719"></a>01719     <span class="comment">/* get the direction from RNA */</span>
<a name="l01720"></a>01720     <span class="keywordtype">int</span> dir = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l01721"></a>01721 
<a name="l01722"></a>01722     <span class="comment">/* initialize the bmop using EDBM api, which does various ui error reporting and other stuff */</span>
<a name="l01723"></a>01723     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;face_rotatecolors faces=%hf dir=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, dir);
<a name="l01724"></a>01724 
<a name="l01725"></a>01725     <span class="comment">/* execute the operator */</span>
<a name="l01726"></a>01726     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l01727"></a>01727 
<a name="l01728"></a>01728     <span class="comment">/* finish the operator */</span>
<a name="l01729"></a>01729     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01730"></a>01730         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01731"></a>01731     }
<a name="l01732"></a>01732 
<a name="l01733"></a>01733     <span class="comment">/* dependencies graph and notification stuff */</span>
<a name="l01734"></a>01734     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01735"></a>01735 
<a name="l01736"></a>01736     <span class="comment">/* we succeeded */</span>
<a name="l01737"></a>01737     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01738"></a>01738 }
<a name="l01739"></a>01739 
<a name="l01740"></a>01740 
<a name="l01741"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#afbdb516708774d22450f506d2bd02c7b">01741</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afbdb516708774d22450f506d2bd02c7b">edbm_reverse_colors_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01742"></a>01742 {
<a name="l01743"></a>01743     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01744"></a>01744     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(ob);
<a name="l01745"></a>01745     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l01746"></a>01746 
<a name="l01747"></a>01747     <span class="comment">/* initialize the bmop using EDBM api, which does various ui error reporting and other stuff */</span>
<a name="l01748"></a>01748     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;face_reversecolors faces=%hf&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l01749"></a>01749 
<a name="l01750"></a>01750     <span class="comment">/* execute the operator */</span>
<a name="l01751"></a>01751     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l01752"></a>01752 
<a name="l01753"></a>01753     <span class="comment">/* finish the operator */</span>
<a name="l01754"></a>01754     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l01755"></a>01755         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01756"></a>01756     }
<a name="l01757"></a>01757 
<a name="l01758"></a>01758     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01759"></a>01759 
<a name="l01760"></a>01760     <span class="comment">/* we succeeded */</span>
<a name="l01761"></a>01761     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01762"></a>01762 }
<a name="l01763"></a>01763 
<a name="l01764"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a2f93e3095b0a97014b66587317304b12">01764</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a5e9c36acb063181c0f0317e914b11400">MESH_OT_uvs_rotate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01765"></a>01765 {
<a name="l01766"></a>01766     <span class="comment">/* identifiers */</span>
<a name="l01767"></a>01767     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Rotate UVs&quot;</span>;
<a name="l01768"></a>01768     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_uvs_rotate&quot;</span>;
<a name="l01769"></a>01769     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Rotate UV coordinates inside faces&quot;</span>;
<a name="l01770"></a>01770 
<a name="l01771"></a>01771     <span class="comment">/* api callbacks */</span>
<a name="l01772"></a>01772     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3d9c33266b73387a7f65d97e16b49589">edbm_rotate_uvs_exec</a>;
<a name="l01773"></a>01773     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01774"></a>01774 
<a name="l01775"></a>01775     <span class="comment">/* flags */</span>
<a name="l01776"></a>01776     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01777"></a>01777 
<a name="l01778"></a>01778     <span class="comment">/* props */</span>
<a name="l01779"></a>01779     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;direction&quot;</span>, direction_items, <a class="code" href="../../de/d95/bmesh__operators_8h.html#afccd240f973cf154952fb917c9209719a0f98509d24ebeef4508c20b9d8bfa0a6">DIRECTION_CW</a>, <span class="stringliteral">&quot;Direction&quot;</span>, <span class="stringliteral">&quot;Direction to rotate UVs around&quot;</span>);
<a name="l01780"></a>01780 }
<a name="l01781"></a>01781 
<a name="l01782"></a>01782 <span class="comment">//void MESH_OT_uvs_mirror(wmOperatorType *ot)</span>
<a name="l01783"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a79c55320497bc5f070892fa521dc9de8">01783</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a10d40e49d524fd3b8e1659994de93ccb">MESH_OT_uvs_reverse</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01784"></a>01784 {
<a name="l01785"></a>01785     <span class="comment">/* identifiers */</span>
<a name="l01786"></a>01786     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Reverse UVs&quot;</span>;
<a name="l01787"></a>01787     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_uvs_reverse&quot;</span>;
<a name="l01788"></a>01788     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Flip direction of UV coordinates inside faces&quot;</span>;
<a name="l01789"></a>01789 
<a name="l01790"></a>01790     <span class="comment">/* api callbacks */</span>
<a name="l01791"></a>01791     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2032a6d46fd38d089fe4954a608084af">edbm_reverse_uvs_exec</a>;
<a name="l01792"></a>01792     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01793"></a>01793 
<a name="l01794"></a>01794     <span class="comment">/* flags */</span>
<a name="l01795"></a>01795     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01796"></a>01796 
<a name="l01797"></a>01797     <span class="comment">/* props */</span>
<a name="l01798"></a>01798     <span class="comment">//RNA_def_enum(ot-&gt;srna, &quot;axis&quot;, axis_items, DIRECTION_CW, &quot;Axis&quot;, &quot;Axis to mirror UVs around&quot;);</span>
<a name="l01799"></a>01799 }
<a name="l01800"></a>01800 
<a name="l01801"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a505505c4d3b44b9bdea65e237b6c9f50">01801</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a5009f8c853afe67c42d3ad848b6bdbec">MESH_OT_colors_rotate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01802"></a>01802 {
<a name="l01803"></a>01803     <span class="comment">/* identifiers */</span>
<a name="l01804"></a>01804     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Rotate Colors&quot;</span>;
<a name="l01805"></a>01805     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_colors_rotate&quot;</span>;
<a name="l01806"></a>01806     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Rotate vertex colors inside faces&quot;</span>;
<a name="l01807"></a>01807 
<a name="l01808"></a>01808     <span class="comment">/* api callbacks */</span>
<a name="l01809"></a>01809     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a12d3dfaed9e2659cb626e0565da3fc01">edbm_rotate_colors_exec</a>;
<a name="l01810"></a>01810     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01811"></a>01811 
<a name="l01812"></a>01812     <span class="comment">/* flags */</span>
<a name="l01813"></a>01813     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01814"></a>01814 
<a name="l01815"></a>01815     <span class="comment">/* props */</span>
<a name="l01816"></a>01816     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;direction&quot;</span>, direction_items, <a class="code" href="../../de/d95/bmesh__operators_8h.html#afccd240f973cf154952fb917c9209719ad8096a357e6a61f6746147d0b19467c2">DIRECTION_CCW</a>, <span class="stringliteral">&quot;Direction&quot;</span>, <span class="stringliteral">&quot;Direction to rotate edge around&quot;</span>);
<a name="l01817"></a>01817 }
<a name="l01818"></a>01818 
<a name="l01819"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a9074481dd250144fc778ba69ee425c8e">01819</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad8495da1a9b6b8e37af83603e6a634d9">MESH_OT_colors_reverse</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01820"></a>01820 {
<a name="l01821"></a>01821     <span class="comment">/* identifiers */</span>
<a name="l01822"></a>01822     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Reverse Colors&quot;</span>;
<a name="l01823"></a>01823     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_colors_reverse&quot;</span>;
<a name="l01824"></a>01824     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Flip direction of vertex colors inside faces&quot;</span>;
<a name="l01825"></a>01825 
<a name="l01826"></a>01826     <span class="comment">/* api callbacks */</span>
<a name="l01827"></a>01827     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afbdb516708774d22450f506d2bd02c7b">edbm_reverse_colors_exec</a>;
<a name="l01828"></a>01828     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l01829"></a>01829 
<a name="l01830"></a>01830     <span class="comment">/* flags */</span>
<a name="l01831"></a>01831     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01832"></a>01832 
<a name="l01833"></a>01833     <span class="comment">/* props */</span>
<a name="l01834"></a>01834     <span class="comment">//RNA_def_enum(ot-&gt;srna, &quot;axis&quot;, axis_items, DIRECTION_CW, &quot;Axis&quot;, &quot;Axis to mirror colors around&quot;);</span>
<a name="l01835"></a>01835 }
<a name="l01836"></a>01836 
<a name="l01837"></a>01837 
<a name="l01838"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a14c51aa84ae9440d293eb99fbf58e3d3">01838</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a14c51aa84ae9440d293eb99fbf58e3d3">merge_firstlast</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <span class="keywordtype">int</span> first, <span class="keywordtype">int</span> uvmerge, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *wmop)
<a name="l01839"></a>01839 {
<a name="l01840"></a>01840     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *mergevert;
<a name="l01841"></a>01841     <a class="code" href="../../da/dc8/structBMEditSelection.html">BMEditSelection</a> *ese;
<a name="l01842"></a>01842 
<a name="l01843"></a>01843     <span class="comment">/* do sanity check in mergemenu in edit.c ?*/</span>
<a name="l01844"></a>01844     <span class="keywordflow">if</span> (first == 0) {
<a name="l01845"></a>01845         ese = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01846"></a>01846         mergevert = (<a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *)ese-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#ae86356a64630dfee041388916476f782">ele</a>;
<a name="l01847"></a>01847     }
<a name="l01848"></a>01848     <span class="keywordflow">else</span> {
<a name="l01849"></a>01849         ese = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01850"></a>01850         mergevert = (<a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *)ese-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#ae86356a64630dfee041388916476f782">ele</a>;
<a name="l01851"></a>01851     }
<a name="l01852"></a>01852 
<a name="l01853"></a>01853     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(mergevert, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l01854"></a>01854         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01855"></a>01855     
<a name="l01856"></a>01856     <span class="keywordflow">if</span> (uvmerge) {
<a name="l01857"></a>01857         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;pointmerge_facedata verts=%hv snapv=%e&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, mergevert))
<a name="l01858"></a>01858             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01859"></a>01859     }
<a name="l01860"></a>01860 
<a name="l01861"></a>01861     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;pointmerge verts=%hv mergeco=%v&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, mergevert-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>))
<a name="l01862"></a>01862         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01863"></a>01863 
<a name="l01864"></a>01864     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01865"></a>01865 }
<a name="l01866"></a>01866 
<a name="l01867"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8cafe592a23283792d38faf0f2080af5">01867</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8cafe592a23283792d38faf0f2080af5">merge_target</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d, <a class="code" href="../../de/de7/structObject.html">Object</a> *ob, 
<a name="l01868"></a>01868                         <span class="keywordtype">int</span> target, <span class="keywordtype">int</span> uvmerge, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *wmop)
<a name="l01869"></a>01869 {
<a name="l01870"></a>01870     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l01871"></a>01871     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *v;
<a name="l01872"></a>01872     <span class="keywordtype">float</span> *vco = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[3], cent[3] = {0.0f, 0.0f, 0.0f};
<a name="l01873"></a>01873 
<a name="l01874"></a>01874     <span class="keywordflow">if</span> (target) {
<a name="l01875"></a>01875         vco = <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a56c6dfa9088d0f90552a67074a359c97">give_cursor</a>(scene, v3d);
<a name="l01876"></a>01876         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(co, vco);
<a name="l01877"></a>01877         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2fc1e6236f291e8cf3b62c8e0541eb00">mul_m4_v3</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>, co);
<a name="l01878"></a>01878     }
<a name="l01879"></a>01879     <span class="keywordflow">else</span> {
<a name="l01880"></a>01880         <span class="keywordtype">float</span> fac;
<a name="l01881"></a>01881         <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;
<a name="l01882"></a>01882         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (v, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l01883"></a>01883             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(v, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l01884"></a>01884                 <span class="keywordflow">continue</span>;
<a name="l01885"></a>01885             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#ae0067c77927da3b22dec1de77ac8ba78">add_v3_v3</a>(cent, v-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l01886"></a>01886             i++;
<a name="l01887"></a>01887         }
<a name="l01888"></a>01888         
<a name="l01889"></a>01889         <span class="keywordflow">if</span> (!i)
<a name="l01890"></a>01890             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01891"></a>01891 
<a name="l01892"></a>01892         fac = 1.0f / (float)i;
<a name="l01893"></a>01893         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a614c21caf4e6d770c7a49006a7f734b4">mul_v3_fl</a>(cent, fac);
<a name="l01894"></a>01894         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(co, cent);
<a name="l01895"></a>01895         vco = <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>;
<a name="l01896"></a>01896     }
<a name="l01897"></a>01897 
<a name="l01898"></a>01898     <span class="keywordflow">if</span> (!vco)
<a name="l01899"></a>01899         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01900"></a>01900     
<a name="l01901"></a>01901     <span class="keywordflow">if</span> (uvmerge) {
<a name="l01902"></a>01902         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;vert_average_facedata verts=%hv&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l01903"></a>01903             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01904"></a>01904     }
<a name="l01905"></a>01905 
<a name="l01906"></a>01906     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;pointmerge verts=%hv mergeco=%v&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, co))
<a name="l01907"></a>01907         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01908"></a>01908 
<a name="l01909"></a>01909     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01910"></a>01910 }
<a name="l01911"></a>01911 
<a name="l01912"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab2e67d0564681a07df4d2de6611f8fd7">01912</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab2e67d0564681a07df4d2de6611f8fd7">edbm_merge_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01913"></a>01913 {
<a name="l01914"></a>01914     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01915"></a>01915     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = <a class="code" href="../../df/d01/BKE__context_8h.html#a88ab4a564441708766a6b4ace3b17908">CTX_wm_view3d</a>(C);
<a name="l01916"></a>01916     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01917"></a>01917     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01918"></a>01918     <span class="keywordtype">int</span> status = 0, uvs = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;uvs&quot;</span>);
<a name="l01919"></a>01919 
<a name="l01920"></a>01920     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>)) {
<a name="l01921"></a>01921         <span class="keywordflow">case</span> 3:
<a name="l01922"></a>01922             status = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8cafe592a23283792d38faf0f2080af5">merge_target</a>(em, scene, v3d, obedit, 0, uvs, op);
<a name="l01923"></a>01923             <span class="keywordflow">break</span>;
<a name="l01924"></a>01924         <span class="keywordflow">case</span> 4:
<a name="l01925"></a>01925             status = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8cafe592a23283792d38faf0f2080af5">merge_target</a>(em, scene, v3d, obedit, 1, uvs, op);
<a name="l01926"></a>01926             <span class="keywordflow">break</span>;
<a name="l01927"></a>01927         <span class="keywordflow">case</span> 1:
<a name="l01928"></a>01928             status = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a14c51aa84ae9440d293eb99fbf58e3d3">merge_firstlast</a>(em, 0, uvs, op);
<a name="l01929"></a>01929             <span class="keywordflow">break</span>;
<a name="l01930"></a>01930         <span class="keywordflow">case</span> 6:
<a name="l01931"></a>01931             status = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a14c51aa84ae9440d293eb99fbf58e3d3">merge_firstlast</a>(em, 1, uvs, op);
<a name="l01932"></a>01932             <span class="keywordflow">break</span>;
<a name="l01933"></a>01933         <span class="keywordflow">case</span> 5:
<a name="l01934"></a>01934             status = 1;
<a name="l01935"></a>01935             <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;collapse edges=%he&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l01936"></a>01936                 status = 0;
<a name="l01937"></a>01937             <span class="keywordflow">break</span>;
<a name="l01938"></a>01938     }
<a name="l01939"></a>01939 
<a name="l01940"></a>01940     <span class="keywordflow">if</span> (!status)
<a name="l01941"></a>01941         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01942"></a>01942 
<a name="l01943"></a>01943     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01944"></a>01944 
<a name="l01945"></a>01945     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01946"></a>01946 }
<a name="l01947"></a>01947 
<a name="l01948"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ff54d3d19c358e3e3cb7ef4f077eba1">01948</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ff54d3d19c358e3e3cb7ef4f077eba1">merge_type_items</a>[] = {
<a name="l01949"></a>01949     {6, <span class="stringliteral">&quot;FIRST&quot;</span>, 0, <span class="stringliteral">&quot;At First&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01950"></a>01950     {1, <span class="stringliteral">&quot;LAST&quot;</span>, 0, <span class="stringliteral">&quot;At Last&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01951"></a>01951     {3, <span class="stringliteral">&quot;CENTER&quot;</span>, 0, <span class="stringliteral">&quot;At Center&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01952"></a>01952     {4, <span class="stringliteral">&quot;CURSOR&quot;</span>, 0, <span class="stringliteral">&quot;At Cursor&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01953"></a>01953     {5, <span class="stringliteral">&quot;COLLAPSE&quot;</span>, 0, <span class="stringliteral">&quot;Collapse&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01954"></a>01954     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l01955"></a>01955 
<a name="l01956"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#accd628a43ab6d6279cee92624d2b1afc">01956</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> *<a class="code" href="../../d0/d85/editmesh__tools_8c.html#accd628a43ab6d6279cee92624d2b1afc">merge_type_itemf</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ptr),  <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(prop), <span class="keywordtype">int</span> *free)
<a name="l01957"></a>01957 {   
<a name="l01958"></a>01958     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit;
<a name="l01959"></a>01959     <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> *item = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01960"></a>01960     <span class="keywordtype">int</span> totitem = 0;
<a name="l01961"></a>01961     
<a name="l01962"></a>01962     <span class="keywordflow">if</span> (!C) <span class="comment">/* needed for docs */</span>
<a name="l01963"></a>01963         <span class="keywordflow">return</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ff54d3d19c358e3e3cb7ef4f077eba1">merge_type_items</a>;
<a name="l01964"></a>01964     
<a name="l01965"></a>01965     obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l01966"></a>01966     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>) {
<a name="l01967"></a>01967         <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l01968"></a>01968 
<a name="l01969"></a>01969         <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8de5fe0f8dbf523c4699a7b54c429e2f">SCE_SELECT_VERTEX</a>) {
<a name="l01970"></a>01970             <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> &amp;&amp; em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a> &amp;&amp;
<a name="l01971"></a>01971                 ((<a class="code" href="../../da/dc8/structBMEditSelection.html">BMEditSelection</a> *)em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)-&gt;htype == <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a> &amp;&amp;
<a name="l01972"></a>01972                 ((<a class="code" href="../../da/dc8/structBMEditSelection.html">BMEditSelection</a> *)em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>)-&gt;htype == <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>)
<a name="l01973"></a>01973             {
<a name="l01974"></a>01974                 <a class="code" href="../../dc/d7e/rna__define_8c.html#aba7e0419099ea38e4cecba9c520a26dc">RNA_enum_items_add_value</a>(&amp;item, &amp;totitem, merge_type_items, 6);
<a name="l01975"></a>01975                 <a class="code" href="../../dc/d7e/rna__define_8c.html#aba7e0419099ea38e4cecba9c520a26dc">RNA_enum_items_add_value</a>(&amp;item, &amp;totitem, merge_type_items, 1);
<a name="l01976"></a>01976             }
<a name="l01977"></a>01977             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> &amp;&amp; ((<a class="code" href="../../da/dc8/structBMEditSelection.html">BMEditSelection</a> *)em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>)-&gt;htype == <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>) {
<a name="l01978"></a>01978                 <a class="code" href="../../dc/d7e/rna__define_8c.html#aba7e0419099ea38e4cecba9c520a26dc">RNA_enum_items_add_value</a>(&amp;item, &amp;totitem, merge_type_items, 6);
<a name="l01979"></a>01979             }
<a name="l01980"></a>01980             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a> &amp;&amp; ((<a class="code" href="../../da/dc8/structBMEditSelection.html">BMEditSelection</a> *)em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>)-&gt;htype == <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>) {
<a name="l01981"></a>01981                 <a class="code" href="../../dc/d7e/rna__define_8c.html#aba7e0419099ea38e4cecba9c520a26dc">RNA_enum_items_add_value</a>(&amp;item, &amp;totitem, merge_type_items, 1);
<a name="l01982"></a>01982             }
<a name="l01983"></a>01983         }
<a name="l01984"></a>01984 
<a name="l01985"></a>01985         <a class="code" href="../../dc/d7e/rna__define_8c.html#aba7e0419099ea38e4cecba9c520a26dc">RNA_enum_items_add_value</a>(&amp;item, &amp;totitem, merge_type_items, 3);
<a name="l01986"></a>01986         <a class="code" href="../../dc/d7e/rna__define_8c.html#aba7e0419099ea38e4cecba9c520a26dc">RNA_enum_items_add_value</a>(&amp;item, &amp;totitem, merge_type_items, 4);
<a name="l01987"></a>01987         <a class="code" href="../../dc/d7e/rna__define_8c.html#aba7e0419099ea38e4cecba9c520a26dc">RNA_enum_items_add_value</a>(&amp;item, &amp;totitem, merge_type_items, 5);
<a name="l01988"></a>01988         <a class="code" href="../../dc/d7e/rna__define_8c.html#a9c356736035ce93183d416c437a40d1c">RNA_enum_item_end</a>(&amp;item, &amp;totitem);
<a name="l01989"></a>01989 
<a name="l01990"></a>01990         *free = 1;
<a name="l01991"></a>01991 
<a name="l01992"></a>01992         <span class="keywordflow">return</span> item;
<a name="l01993"></a>01993     }
<a name="l01994"></a>01994     
<a name="l01995"></a>01995     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01996"></a>01996 }
<a name="l01997"></a>01997 
<a name="l01998"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a763db1f65be66aa6acf2a7aeaf22447b">01998</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab47e245734fe290d9b4cb8f9752da0e1">MESH_OT_merge</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01999"></a>01999 {
<a name="l02000"></a>02000     <span class="comment">/* identifiers */</span>
<a name="l02001"></a>02001     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Merge&quot;</span>;
<a name="l02002"></a>02002     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Merge selected vertices&quot;</span>;
<a name="l02003"></a>02003     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_merge&quot;</span>;
<a name="l02004"></a>02004 
<a name="l02005"></a>02005     <span class="comment">/* api callbacks */</span>
<a name="l02006"></a>02006     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab2e67d0564681a07df4d2de6611f8fd7">edbm_merge_exec</a>;
<a name="l02007"></a>02007     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l02008"></a>02008     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02009"></a>02009 
<a name="l02010"></a>02010     <span class="comment">/* flags */</span>
<a name="l02011"></a>02011     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02012"></a>02012 
<a name="l02013"></a>02013     <span class="comment">/* properties */</span>
<a name="l02014"></a>02014     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, merge_type_items, 3, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Merge method to use&quot;</span>);
<a name="l02015"></a>02015     <a class="code" href="../../dc/d7e/rna__define_8c.html#adb30c6a3157cbd3193ff1a8de159389f">RNA_def_enum_funcs</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a>, <a class="code" href="../../d0/d85/editmesh__tools_8c.html#accd628a43ab6d6279cee92624d2b1afc">merge_type_itemf</a>);
<a name="l02016"></a>02016     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;uvs&quot;</span>, 1, <span class="stringliteral">&quot;UVs&quot;</span>, <span class="stringliteral">&quot;Move UVs according to merge&quot;</span>);
<a name="l02017"></a>02017 }
<a name="l02018"></a>02018 
<a name="l02019"></a>02019 
<a name="l02020"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af4af7a3f066b4f9e26148b4774ef5b97">02020</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af4af7a3f066b4f9e26148b4774ef5b97">edbm_remove_doubles_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02021"></a>02021 {
<a name="l02022"></a>02022     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02023"></a>02023     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l02024"></a>02024     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l02025"></a>02025     <span class="keywordtype">int</span> count;
<a name="l02026"></a>02026 
<a name="l02027"></a>02027     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;finddoubles verts=%hv dist=%f&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;mergedist&quot;</span>));
<a name="l02028"></a>02028     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l02029"></a>02029 
<a name="l02030"></a>02030     count = <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac29721c862dddfcdc2e8d992caf73991">BMO_slot_map_count</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;targetmapout&quot;</span>);
<a name="l02031"></a>02031 
<a name="l02032"></a>02032     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;weldverts targetmap=%s&quot;</span>, &amp;bmop, <span class="stringliteral">&quot;targetmapout&quot;</span>)) {
<a name="l02033"></a>02033         <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ab6f764453b1419d3dfca2aec5943a381" title="BMESH OPSTACK FINISH OP.">BMO_op_finish</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l02034"></a>02034         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02035"></a>02035     }
<a name="l02036"></a>02036 
<a name="l02037"></a>02037     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l02038"></a>02038         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02039"></a>02039     }
<a name="l02040"></a>02040     
<a name="l02041"></a>02041     <a class="code" href="../../d2/d40/BKE__report_8h.html#af25c247b3b620d13cef87ec2bed1698e">BKE_reportf</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a1c418509aad2eb64fd806b8a99d29f7d">RPT_INFO</a>, <span class="stringliteral">&quot;Removed %d vert%s&quot;</span>, count, (count == 1) ? <span class="stringliteral">&quot;ex&quot;</span> : <span class="stringliteral">&quot;ices&quot;</span>);
<a name="l02042"></a>02042 
<a name="l02043"></a>02043     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02044"></a>02044 
<a name="l02045"></a>02045     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02046"></a>02046 }
<a name="l02047"></a>02047 
<a name="l02048"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a9ebdbdbad304e962c252687cc73cc76b">02048</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a682740ea908636a095012185f79e2b0f">MESH_OT_remove_doubles</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02049"></a>02049 {
<a name="l02050"></a>02050     <span class="comment">/* identifiers */</span>
<a name="l02051"></a>02051     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Remove Doubles&quot;</span>;
<a name="l02052"></a>02052     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Remove duplicate vertices&quot;</span>;
<a name="l02053"></a>02053     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_remove_doubles&quot;</span>;
<a name="l02054"></a>02054 
<a name="l02055"></a>02055     <span class="comment">/* api callbacks */</span>
<a name="l02056"></a>02056     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af4af7a3f066b4f9e26148b4774ef5b97">edbm_remove_doubles_exec</a>;
<a name="l02057"></a>02057     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02058"></a>02058 
<a name="l02059"></a>02059     <span class="comment">/* flags */</span>
<a name="l02060"></a>02060     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02061"></a>02061 
<a name="l02062"></a>02062     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mergedist&quot;</span>, 0.0001f, 0.000001f, 50.0f, 
<a name="l02063"></a>02063                   <span class="stringliteral">&quot;Merge Distance&quot;</span>,
<a name="l02064"></a>02064                   <span class="stringliteral">&quot;Minimum distance between elements to merge&quot;</span>, 0.00001, 10.0);
<a name="l02065"></a>02065 }
<a name="l02066"></a>02066 
<a name="l02067"></a>02067 <span class="comment">/************************ Vertex Path Operator *************************/</span>
<a name="l02068"></a>02068 
<a name="l02069"></a><a class="code" href="../../de/d75/structPathNode.html">02069</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../de/d75/structPathNode.html">PathNode</a> {
<a name="l02070"></a>02070     <span class="comment">/* int u; */</span>       <span class="comment">/* UNUSED */</span>
<a name="l02071"></a>02071     <span class="comment">/* int visited; */</span> <span class="comment">/* UNUSED */</span>
<a name="l02072"></a><a class="code" href="../../de/d75/structPathNode.html#ad92d2aeb1810e1bbab8286c3f96377e1">02072</a>     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> <a class="code" href="../../de/d75/structPathNode.html#ad92d2aeb1810e1bbab8286c3f96377e1">edges</a>;
<a name="l02073"></a>02073 } <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a7d9e796130b246b82ce0526b99d47178">PathNode</a>;
<a name="l02074"></a>02074 
<a name="l02075"></a><a class="code" href="../../d4/d9e/structPathEdge.html">02075</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d9e/structPathEdge.html">PathEdge</a> {
<a name="l02076"></a><a class="code" href="../../d4/d9e/structPathEdge.html#abbc70798a6bd22957013dc97317adab7">02076</a>     <span class="keyword">struct </span><a class="code" href="../../d4/d9e/structPathEdge.html">PathEdge</a> *<a class="code" href="../../d4/d9e/structPathEdge.html#a59c47ed391df1bd64d453d1b27b25866">next</a>, *<a class="code" href="../../d4/d9e/structPathEdge.html#abbc70798a6bd22957013dc97317adab7">prev</a>;
<a name="l02077"></a><a class="code" href="../../d4/d9e/structPathEdge.html#a5fb81ff6e7bb806c0e0b402072f23a71">02077</a>     <span class="keywordtype">int</span> <a class="code" href="../../d4/d9e/structPathEdge.html#a5fb81ff6e7bb806c0e0b402072f23a71">v</a>;
<a name="l02078"></a><a class="code" href="../../d4/d9e/structPathEdge.html#abb1b7c35ab2ce50c4387eca11181ef1d">02078</a>     <span class="keywordtype">float</span> <a class="code" href="../../d4/d9e/structPathEdge.html#abb1b7c35ab2ce50c4387eca11181ef1d">w</a>;
<a name="l02079"></a>02079 } <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9226b89e705b0884268552c41bfdafe7">PathEdge</a>;
<a name="l02080"></a>02080 
<a name="l02081"></a>02081 
<a name="l02082"></a>02082 
<a name="l02083"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#aae01f430984e653e6ffcee90a68f5515">02083</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aae01f430984e653e6ffcee90a68f5515">edbm_select_vertex_path_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02084"></a>02084 {
<a name="l02085"></a>02085     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02086"></a>02086     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(ob);
<a name="l02087"></a>02087     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l02088"></a>02088     <a class="code" href="../../da/dc8/structBMEditSelection.html">BMEditSelection</a> *sv, *ev;
<a name="l02089"></a>02089 
<a name="l02090"></a>02090     <span class="comment">/* get the type from RNA */</span>
<a name="l02091"></a>02091     <span class="keywordtype">int</span> type = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l02092"></a>02092 
<a name="l02093"></a>02093     sv = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l02094"></a>02094     <span class="keywordflow">if</span> (sv != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02095"></a>02095         ev = sv-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#ac23a7a561e7bf133003ce52291e8874c">prev</a>;
<a name="l02096"></a>02096     <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02097"></a>02097     <span class="keywordflow">if</span> (ev == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02098"></a>02098         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02099"></a>02099 
<a name="l02100"></a>02100     <span class="keywordflow">if</span> ((sv-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#aa56cdbb8125a847ea3c6327a9e82997c">htype</a> != <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>) || (ev-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#aa56cdbb8125a847ea3c6327a9e82997c">htype</a> != <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>))
<a name="l02101"></a>02101         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02102"></a>02102 
<a name="l02103"></a>02103     <span class="comment">/* initialize the bmop using EDBM api, which does various ui error reporting and other stuff */</span>
<a name="l02104"></a>02104     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;vertexshortestpath startv=%e endv=%e type=%i&quot;</span>, sv-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#ae86356a64630dfee041388916476f782">ele</a>, ev-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#ae86356a64630dfee041388916476f782">ele</a>, type);
<a name="l02105"></a>02105 
<a name="l02106"></a>02106     <span class="comment">/* execute the operator */</span>
<a name="l02107"></a>02107     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l02108"></a>02108 
<a name="l02109"></a>02109     <span class="comment">/* DO NOT clear the existing selection */</span>
<a name="l02110"></a>02110     <span class="comment">/* EDBM_flag_disable_all(em, BM_ELEM_SELECT); */</span>
<a name="l02111"></a>02111 
<a name="l02112"></a>02112     <span class="comment">/* select the output */</span>
<a name="l02113"></a>02113     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;vertout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a9bf8085857e7d4a80f0a7218f714652c">BM_ALL</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02114"></a>02114 
<a name="l02115"></a>02115     <span class="comment">/* finish the operator */</span>
<a name="l02116"></a>02116     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l02117"></a>02117         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02118"></a>02118     }
<a name="l02119"></a>02119 
<a name="l02120"></a>02120     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(em);
<a name="l02121"></a>02121 
<a name="l02122"></a>02122     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02123"></a>02123 
<a name="l02124"></a>02124     <span class="comment">/* we succeeded */</span>
<a name="l02125"></a>02125     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02126"></a>02126 }
<a name="l02127"></a>02127 
<a name="l02128"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a185c474d24247941982986541bdb30b0">02128</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aae152e16762f8874cb78cead34603a4d">MESH_OT_select_vertex_path</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02129"></a>02129 {
<a name="l02130"></a>02130     <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> type_items[] = {
<a name="l02131"></a>02131         {<a class="code" href="../../de/d95/bmesh__operators_8h.html#a7cc2e4244ca368f68e5746185eda6c4aa1dc1442ccfd4ebbe1917b00d97e319d7">VPATH_SELECT_EDGE_LENGTH</a>, <span class="stringliteral">&quot;EDGE_LENGTH&quot;</span>, 0, <span class="stringliteral">&quot;Edge Length&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>},
<a name="l02132"></a>02132         {<a class="code" href="../../de/d95/bmesh__operators_8h.html#a7cc2e4244ca368f68e5746185eda6c4aa9f1bb5a6a7b493cedc1e537372877c11">VPATH_SELECT_TOPOLOGICAL</a>, <span class="stringliteral">&quot;TOPOLOGICAL&quot;</span>, 0, <span class="stringliteral">&quot;Topological&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>},
<a name="l02133"></a>02133         {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l02134"></a>02134     };
<a name="l02135"></a>02135 
<a name="l02136"></a>02136     <span class="comment">/* identifiers */</span>
<a name="l02137"></a>02137     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select Vertex Path&quot;</span>;
<a name="l02138"></a>02138     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_select_vertex_path&quot;</span>;
<a name="l02139"></a>02139     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Selected vertex path between two vertices&quot;</span>;
<a name="l02140"></a>02140 
<a name="l02141"></a>02141     <span class="comment">/* api callbacks */</span>
<a name="l02142"></a>02142     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aae01f430984e653e6ffcee90a68f5515">edbm_select_vertex_path_exec</a>;
<a name="l02143"></a>02143     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02144"></a>02144 
<a name="l02145"></a>02145     <span class="comment">/* flags */</span>
<a name="l02146"></a>02146     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02147"></a>02147 
<a name="l02148"></a>02148     <span class="comment">/* properties */</span>
<a name="l02149"></a>02149     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, type_items, <a class="code" href="../../de/d95/bmesh__operators_8h.html#a7cc2e4244ca368f68e5746185eda6c4aa1dc1442ccfd4ebbe1917b00d97e319d7">VPATH_SELECT_EDGE_LENGTH</a>, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Method to compute distance&quot;</span>);
<a name="l02150"></a>02150 }
<a name="l02151"></a>02151 <span class="comment">/********************** Rip Operator *************************/</span>
<a name="l02152"></a>02152 
<a name="l02153"></a>02153 <span class="comment">/************************ Shape Operators *************************/</span>
<a name="l02154"></a>02154 
<a name="l02155"></a>02155 <span class="comment">/* BMESH_TODO this should be properly encapsulated in a bmop.  but later.*/</span>
<a name="l02156"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af6dc404ee525a04b0693823632a9e94c">02156</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af6dc404ee525a04b0693823632a9e94c">shape_propagate</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02157"></a>02157 {
<a name="l02158"></a>02158     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l02159"></a>02159     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *eve = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02160"></a>02160     <span class="keywordtype">float</span> *<a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>;
<a name="l02161"></a>02161     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, totshape = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a1952483728c254dddff6523fba919538">CustomData_number_of_layers</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#aa9fa683ff8192cbd1897c3f9e50861ff">CD_SHAPEKEY</a>);
<a name="l02162"></a>02162 
<a name="l02163"></a>02163     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6474531880fa81739ccdb10fdffd1866">CustomData_has_layer</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#aa9fa683ff8192cbd1897c3f9e50861ff">CD_SHAPEKEY</a>)) {
<a name="l02164"></a>02164         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Mesh does not have shape keys&quot;</span>);
<a name="l02165"></a>02165         <span class="keywordflow">return</span>;
<a name="l02166"></a>02166     }
<a name="l02167"></a>02167     
<a name="l02168"></a>02168     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eve, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l02169"></a>02169         <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eve, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) || <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eve, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l02170"></a>02170             <span class="keywordflow">continue</span>;
<a name="l02171"></a>02171 
<a name="l02172"></a>02172         <span class="keywordflow">for</span> (i = 0; i &lt; totshape; i++) {
<a name="l02173"></a>02173             co = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#afeb6e9fe67d614f29bc78750b95111da">CustomData_bmesh_get_n</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#ae60b9e519f421cdd79d5e3309853d7f5">head</a>.<a class="code" href="../../d5/d3a/structBMHeader.html#aab6fc118de69cdb678fe6aaba4ec75be">data</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#aa9fa683ff8192cbd1897c3f9e50861ff">CD_SHAPEKEY</a>, i);
<a name="l02174"></a>02174             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(co, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l02175"></a>02175         }
<a name="l02176"></a>02176     }
<a name="l02177"></a>02177 
<a name="l02178"></a>02178 <span class="preprocessor">#if 0</span>
<a name="l02179"></a>02179 <span class="preprocessor"></span>    <span class="comment">//TAG Mesh Objects that share this data</span>
<a name="l02180"></a>02180     <span class="keywordflow">for</span> (base = scene-&gt;base.first; base; base = base-&gt;next) {
<a name="l02181"></a>02181         <span class="keywordflow">if</span> (base-&gt;object &amp;&amp; base-&gt;object-&gt;data == me) {
<a name="l02182"></a>02182             base-&gt;object-&gt;recalc = <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a5753f311c53d8a8f72b1937f33ebb527">OB_RECALC_DATA</a>;
<a name="l02183"></a>02183         }
<a name="l02184"></a>02184     }
<a name="l02185"></a>02185 <span class="preprocessor">#endif</span>
<a name="l02186"></a>02186 <span class="preprocessor"></span>}
<a name="l02187"></a>02187 
<a name="l02188"></a>02188 
<a name="l02189"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af771441026cb273bfa0e6d6641218275">02189</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af771441026cb273bfa0e6d6641218275">edbm_shape_propagate_to_all_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02190"></a>02190 {
<a name="l02191"></a>02191     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02192"></a>02192     <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me = obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l02193"></a>02193     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = me-&gt;<a class="code" href="../../da/d29/structMesh.html#a1b0a1797d0b3927b83f36b2d8d579ddb">edit_btmesh</a>;
<a name="l02194"></a>02194 
<a name="l02195"></a>02195     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af6dc404ee525a04b0693823632a9e94c">shape_propagate</a>(em, op);
<a name="l02196"></a>02196 
<a name="l02197"></a>02197     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02198"></a>02198 
<a name="l02199"></a>02199     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02200"></a>02200 }
<a name="l02201"></a>02201 
<a name="l02202"></a>02202 
<a name="l02203"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a6bf8d43e14d2335603a7f5b92c5a7edb">02203</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0dad9c5311abce857e7bcd05a342a6e2">MESH_OT_shape_propagate_to_all</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02204"></a>02204 {
<a name="l02205"></a>02205     <span class="comment">/* identifiers */</span>
<a name="l02206"></a>02206     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Shape Propagate&quot;</span>;
<a name="l02207"></a>02207     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Apply selected vertex locations to all other shape keys&quot;</span>;
<a name="l02208"></a>02208     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_shape_propagate_to_all&quot;</span>;
<a name="l02209"></a>02209 
<a name="l02210"></a>02210     <span class="comment">/* api callbacks */</span>
<a name="l02211"></a>02211     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af771441026cb273bfa0e6d6641218275">edbm_shape_propagate_to_all_exec</a>;
<a name="l02212"></a>02212     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02213"></a>02213 
<a name="l02214"></a>02214     <span class="comment">/* flags */</span>
<a name="l02215"></a>02215     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02216"></a>02216 }
<a name="l02217"></a>02217 
<a name="l02218"></a>02218 <span class="comment">/* BMESH_TODO this should be properly encapsulated in a bmop.  but later.*/</span>
<a name="l02219"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#acffb18cfc1463cdcf7deb34d34e84fa6">02219</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acffb18cfc1463cdcf7deb34d34e84fa6">edbm_blend_from_shape_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02220"></a>02220 {
<a name="l02221"></a>02221     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02222"></a>02222     <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me = obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l02223"></a>02223     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = me-&gt;<a class="code" href="../../da/d29/structMesh.html#a1b0a1797d0b3927b83f36b2d8d579ddb">edit_btmesh</a>;
<a name="l02224"></a>02224     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *eve;
<a name="l02225"></a>02225     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l02226"></a>02226     <span class="keywordtype">float</span> <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[3], *sco;
<a name="l02227"></a>02227     <span class="keywordtype">float</span> <a class="code" href="../../db/d0d/render__texture_8c.html#a85b57d4b9680af22ac05b4a6fb623d7c">blend</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;blend&quot;</span>);
<a name="l02228"></a>02228     <span class="keywordtype">int</span> shape = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;shape&quot;</span>);
<a name="l02229"></a>02229     <span class="keywordtype">int</span> <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a9a801fa87c9bf3472c399696366fe81c">add</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;add&quot;</span>);
<a name="l02230"></a>02230     <span class="keywordtype">int</span> totshape;
<a name="l02231"></a>02231 
<a name="l02232"></a>02232     <span class="comment">/* sanity check */</span>
<a name="l02233"></a>02233     totshape = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a1952483728c254dddff6523fba919538">CustomData_number_of_layers</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#aa9fa683ff8192cbd1897c3f9e50861ff">CD_SHAPEKEY</a>);
<a name="l02234"></a>02234     <span class="keywordflow">if</span> (totshape == 0 || shape &lt; 0 || shape &gt;= totshape)
<a name="l02235"></a>02235         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02236"></a>02236 
<a name="l02237"></a>02237     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eve, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l02238"></a>02238         <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eve, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>) || <a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eve, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l02239"></a>02239             <span class="keywordflow">continue</span>;
<a name="l02240"></a>02240 
<a name="l02241"></a>02241         sco = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#afeb6e9fe67d614f29bc78750b95111da">CustomData_bmesh_get_n</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#ae60b9e519f421cdd79d5e3309853d7f5">head</a>.<a class="code" href="../../d5/d3a/structBMHeader.html#aab6fc118de69cdb678fe6aaba4ec75be">data</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#aa9fa683ff8192cbd1897c3f9e50861ff">CD_SHAPEKEY</a>, shape);
<a name="l02242"></a>02242         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(co, sco);
<a name="l02243"></a>02243 
<a name="l02244"></a>02244 
<a name="l02245"></a>02245         <span class="keywordflow">if</span> (add) {
<a name="l02246"></a>02246             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a614c21caf4e6d770c7a49006a7f734b4">mul_v3_fl</a>(co, blend);
<a name="l02247"></a>02247             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a870d4342840636e86ed7966cd883cebc">add_v3_v3v3</a>(eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, co);
<a name="l02248"></a>02248         }
<a name="l02249"></a>02249         <span class="keywordflow">else</span> {
<a name="l02250"></a>02250             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a1527309f09525ae91ed04692da13ba98">interp_v3_v3v3</a>(eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, co, blend);
<a name="l02251"></a>02251         }
<a name="l02252"></a>02252         
<a name="l02253"></a>02253         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(sco, co);
<a name="l02254"></a>02254     }
<a name="l02255"></a>02255 
<a name="l02256"></a>02256     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02257"></a>02257 
<a name="l02258"></a>02258     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02259"></a>02259 }
<a name="l02260"></a>02260 
<a name="l02261"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a38e58a854f51dd272d641ad25ceba30b">02261</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> *<a class="code" href="../../d0/d85/editmesh__tools_8c.html#a38e58a854f51dd272d641ad25ceba30b">shape_itemf</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ptr),  <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(prop), <span class="keywordtype">int</span> *free)
<a name="l02262"></a>02262 {   
<a name="l02263"></a>02263     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02264"></a>02264     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em;
<a name="l02265"></a>02265     <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> *item = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02266"></a>02266     <span class="keywordtype">int</span> totitem = 0;
<a name="l02267"></a>02267 
<a name="l02268"></a>02268     <span class="keywordflow">if</span> ((obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>) &amp;&amp;
<a name="l02269"></a>02269         (em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit)) &amp;&amp;
<a name="l02270"></a>02270         <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6474531880fa81739ccdb10fdffd1866">CustomData_has_layer</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#aa9fa683ff8192cbd1897c3f9e50861ff">CD_SHAPEKEY</a>))
<a name="l02271"></a>02271     {
<a name="l02272"></a>02272         <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> tmp = {0, <span class="stringliteral">&quot;&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>};
<a name="l02273"></a>02273         <span class="keywordtype">int</span> a;
<a name="l02274"></a>02274 
<a name="l02275"></a>02275         <span class="keywordflow">for</span> (a = 0; a &lt; em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>.<a class="code" href="../../df/d04/structCustomData.html#ae5b4833527392742d84e8f7b46f5f264">totlayer</a>; a++) {
<a name="l02276"></a>02276             <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>.<a class="code" href="../../df/d04/structCustomData.html#a91813d4d92a1349830c9b1e554cf7af6">layers</a>[a].<a class="code" href="../../d5/d97/structCustomDataLayer.html#a1ba604969c785bba31ef501e7a06cc9c">type</a> != <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#aa9fa683ff8192cbd1897c3f9e50861ff">CD_SHAPEKEY</a>)
<a name="l02277"></a>02277                 <span class="keywordflow">continue</span>;
<a name="l02278"></a>02278 
<a name="l02279"></a>02279             tmp.<a class="code" href="../../d1/d8a/structEnumPropertyItem.html#a9877ecc8d1c18ef7c8c1a79fee82998e">value</a> = totitem;
<a name="l02280"></a>02280             tmp.<a class="code" href="../../d1/d8a/structEnumPropertyItem.html#a63a2e651d1ec3c62fca4064e6ebf32f0">identifier</a> = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>.<a class="code" href="../../df/d04/structCustomData.html#a91813d4d92a1349830c9b1e554cf7af6">layers</a>[a].<a class="code" href="../../d5/d97/structCustomDataLayer.html#aa8ef26f614b5037233d4ba102e3286d8">name</a>;
<a name="l02281"></a>02281             tmp.<a class="code" href="../../d1/d8a/structEnumPropertyItem.html#a7b7b028a28c6f9f13a9a1289ceabe8e8">name</a> = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>.<a class="code" href="../../df/d04/structCustomData.html#a91813d4d92a1349830c9b1e554cf7af6">layers</a>[a].<a class="code" href="../../d5/d97/structCustomDataLayer.html#aa8ef26f614b5037233d4ba102e3286d8">name</a>;
<a name="l02282"></a>02282             <span class="comment">/* RNA_enum_item_add sets totitem itself! */</span>
<a name="l02283"></a>02283             <a class="code" href="../../dc/d7e/rna__define_8c.html#aac347b3d7d22bc34be1afcea3a155550">RNA_enum_item_add</a>(&amp;item, &amp;totitem, &amp;tmp);
<a name="l02284"></a>02284         }
<a name="l02285"></a>02285     }
<a name="l02286"></a>02286 
<a name="l02287"></a>02287     <a class="code" href="../../dc/d7e/rna__define_8c.html#a9c356736035ce93183d416c437a40d1c">RNA_enum_item_end</a>(&amp;item, &amp;totitem);
<a name="l02288"></a>02288     *free = 1;
<a name="l02289"></a>02289 
<a name="l02290"></a>02290     <span class="keywordflow">return</span> item;
<a name="l02291"></a>02291 }
<a name="l02292"></a>02292 
<a name="l02293"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a174146a8b995930865a2dcd4b3c137c0">02293</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a7761376de713f49be94e48b617776559">MESH_OT_blend_from_shape</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02294"></a>02294 {
<a name="l02295"></a>02295     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l02296"></a>02296     <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> shape_items[] = {{0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l02297"></a>02297 
<a name="l02298"></a>02298     <span class="comment">/* identifiers */</span>
<a name="l02299"></a>02299     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Blend From Shape&quot;</span>;
<a name="l02300"></a>02300     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Blend in shape from a shape key&quot;</span>;
<a name="l02301"></a>02301     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_blend_from_shape&quot;</span>;
<a name="l02302"></a>02302 
<a name="l02303"></a>02303     <span class="comment">/* api callbacks */</span>
<a name="l02304"></a>02304     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#acffb18cfc1463cdcf7deb34d34e84fa6">edbm_blend_from_shape_exec</a>;
<a name="l02305"></a>02305     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a26031163e8a1a0edac5b55f2ecdf115d">WM_operator_props_popup</a>;
<a name="l02306"></a>02306     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02307"></a>02307 
<a name="l02308"></a>02308     <span class="comment">/* flags */</span>
<a name="l02309"></a>02309     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02310"></a>02310 
<a name="l02311"></a>02311     <span class="comment">/* properties */</span>
<a name="l02312"></a>02312     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;shape&quot;</span>, shape_items, 0, <span class="stringliteral">&quot;Shape&quot;</span>, <span class="stringliteral">&quot;Shape key to use for blending&quot;</span>);
<a name="l02313"></a>02313     <a class="code" href="../../dc/d7e/rna__define_8c.html#adb30c6a3157cbd3193ff1a8de159389f">RNA_def_enum_funcs</a>(prop, <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a38e58a854f51dd272d641ad25ceba30b">shape_itemf</a>);
<a name="l02314"></a>02314     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;blend&quot;</span>, 1.0f, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Blend&quot;</span>, <span class="stringliteral">&quot;Blending factor&quot;</span>, -2.0f, 2.0f);
<a name="l02315"></a>02315     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;add&quot;</span>, 1, <span class="stringliteral">&quot;Add&quot;</span>, <span class="stringliteral">&quot;Add rather than blend between shapes&quot;</span>);
<a name="l02316"></a>02316 }
<a name="l02317"></a>02317 
<a name="l02318"></a>02318 <span class="comment">/* BMESH_TODO - some way to select on an arbitrary axis */</span>
<a name="l02319"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a887c3676f7c2e83d04d242b5ca85fb56">02319</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a887c3676f7c2e83d04d242b5ca85fb56">edbm_select_axis_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02320"></a>02320 {
<a name="l02321"></a>02321     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02322"></a>02322     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l02323"></a>02323     <a class="code" href="../../da/dc8/structBMEditSelection.html">BMEditSelection</a> *ese = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a4fed1ad7bcc6ca3497864569912a131e">selected</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l02324"></a>02324     <span class="keywordtype">int</span> axis = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;axis&quot;</span>);
<a name="l02325"></a>02325     <span class="keywordtype">int</span> mode = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;mode&quot;</span>); <span class="comment">/* -1 == aligned, 0 == neg, 1 == pos */</span>
<a name="l02326"></a>02326 
<a name="l02327"></a>02327     <span class="keywordflow">if</span> (ese == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || ese-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#aa56cdbb8125a847ea3c6327a9e82997c">htype</a> != <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>) {
<a name="l02328"></a>02328         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;This operator requires an active vertex (last selected)&quot;</span>);
<a name="l02329"></a>02329         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02330"></a>02330     }
<a name="l02331"></a>02331     <span class="keywordflow">else</span> {
<a name="l02332"></a>02332         <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *ev, *act_vert = (<a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *)ese-&gt;<a class="code" href="../../da/dc8/structBMEditSelection.html#ae86356a64630dfee041388916476f782">ele</a>;
<a name="l02333"></a>02333         <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l02334"></a>02334         <span class="keywordtype">float</span> value = act_vert-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[axis];
<a name="l02335"></a>02335         <span class="keywordtype">float</span> limit =  <a class="code" href="../../df/d01/BKE__context_8h.html#ae91ddb50e1e5a0888a5636ce717a8ef3">CTX_data_tool_settings</a>(C)-&gt;<a class="code" href="../../d0/d65/structToolSettings.html#a8548e36a4a0ab49542ed30ad5fb0f81f">doublimit</a>; <span class="comment">// XXX</span>
<a name="l02336"></a>02336 
<a name="l02337"></a>02337         <span class="keywordflow">if</span> (mode == 0)
<a name="l02338"></a>02338             value -= limit;
<a name="l02339"></a>02339         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mode == 1)
<a name="l02340"></a>02340             value += limit;
<a name="l02341"></a>02341 
<a name="l02342"></a>02342         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (ev, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l02343"></a>02343             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(ev, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>)) {
<a name="l02344"></a>02344                 <span class="keywordflow">switch</span> (mode) {
<a name="l02345"></a>02345                     <span class="keywordflow">case</span> -1: <span class="comment">/* aligned */</span>
<a name="l02346"></a>02346                         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/stdosl_8h.html#a706cbf0492993ed1d280ccf8e9b56682">fabs</a>(ev-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[axis] - value) &lt; limit)
<a name="l02347"></a>02347                             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, ev, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02348"></a>02348                         <span class="keywordflow">break</span>;
<a name="l02349"></a>02349                     <span class="keywordflow">case</span> 0: <span class="comment">/* neg */</span>
<a name="l02350"></a>02350                         <span class="keywordflow">if</span> (ev-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[axis] &gt; value)
<a name="l02351"></a>02351                             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, ev, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02352"></a>02352                         <span class="keywordflow">break</span>;
<a name="l02353"></a>02353                     <span class="keywordflow">case</span> 1: <span class="comment">/* pos */</span>
<a name="l02354"></a>02354                         <span class="keywordflow">if</span> (ev-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[axis] &lt; value)
<a name="l02355"></a>02355                             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, ev, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02356"></a>02356                         <span class="keywordflow">break</span>;
<a name="l02357"></a>02357                 }
<a name="l02358"></a>02358             }
<a name="l02359"></a>02359         }
<a name="l02360"></a>02360     }
<a name="l02361"></a>02361 
<a name="l02362"></a>02362     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(em);
<a name="l02363"></a>02363     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a25383f13197df9bda823d34736df4d82">ND_DATA</a>, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l02364"></a>02364 
<a name="l02365"></a>02365     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02366"></a>02366 }
<a name="l02367"></a>02367 
<a name="l02368"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a5ea8ff3810bf291aff1bdde5f6923e35">02368</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aa5cc7e483c7b45c37d3faa1f337372a8">MESH_OT_select_axis</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02369"></a>02369 {
<a name="l02370"></a>02370     <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> axis_mode_items[] = {
<a name="l02371"></a>02371         {0,  <span class="stringliteral">&quot;POSITIVE&quot;</span>, 0, <span class="stringliteral">&quot;Positive Axis&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02372"></a>02372         {1,  <span class="stringliteral">&quot;NEGATIVE&quot;</span>, 0, <span class="stringliteral">&quot;Negative Axis&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02373"></a>02373         {-1, <span class="stringliteral">&quot;ALIGNED&quot;</span>,  0, <span class="stringliteral">&quot;Aligned Axis&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02374"></a>02374         {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l02375"></a>02375 
<a name="l02376"></a>02376     <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> axis_items_xyz[] = {
<a name="l02377"></a>02377         {0, <span class="stringliteral">&quot;X_AXIS&quot;</span>, 0, <span class="stringliteral">&quot;X Axis&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02378"></a>02378         {1, <span class="stringliteral">&quot;Y_AXIS&quot;</span>, 0, <span class="stringliteral">&quot;Y Axis&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02379"></a>02379         {2, <span class="stringliteral">&quot;Z_AXIS&quot;</span>, 0, <span class="stringliteral">&quot;Z Axis&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02380"></a>02380         {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l02381"></a>02381 
<a name="l02382"></a>02382     <span class="comment">/* identifiers */</span>
<a name="l02383"></a>02383     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select Axis&quot;</span>;
<a name="l02384"></a>02384     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select all data in the mesh on a single axis&quot;</span>;
<a name="l02385"></a>02385     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_select_axis&quot;</span>;
<a name="l02386"></a>02386 
<a name="l02387"></a>02387     <span class="comment">/* api callbacks */</span>
<a name="l02388"></a>02388     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a887c3676f7c2e83d04d242b5ca85fb56">edbm_select_axis_exec</a>;
<a name="l02389"></a>02389     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02390"></a>02390 
<a name="l02391"></a>02391     <span class="comment">/* flags */</span>
<a name="l02392"></a>02392     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02393"></a>02393 
<a name="l02394"></a>02394     <span class="comment">/* properties */</span>
<a name="l02395"></a>02395     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mode&quot;</span>, axis_mode_items, 0, <span class="stringliteral">&quot;Axis Mode&quot;</span>, <span class="stringliteral">&quot;Axis side to use when selecting&quot;</span>);
<a name="l02396"></a>02396     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;axis&quot;</span>, axis_items_xyz, 0, <span class="stringliteral">&quot;Axis&quot;</span>, <span class="stringliteral">&quot;Select the axis to compare each vertex on&quot;</span>);
<a name="l02397"></a>02397 }
<a name="l02398"></a>02398 
<a name="l02399"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a1c4772b4451ebe2cb70904a0f5687793">02399</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a1c4772b4451ebe2cb70904a0f5687793">edbm_solidify_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02400"></a>02400 {
<a name="l02401"></a>02401     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02402"></a>02402     <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me = obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l02403"></a>02403     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = me-&gt;<a class="code" href="../../da/d29/structMesh.html#a1b0a1797d0b3927b83f36b2d8d579ddb">edit_btmesh</a>;
<a name="l02404"></a>02404     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l02405"></a>02405     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l02406"></a>02406 
<a name="l02407"></a>02407     <span class="keywordtype">float</span> thickness = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;thickness&quot;</span>);
<a name="l02408"></a>02408 
<a name="l02409"></a>02409     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;solidify geom=%hf thickness=%f&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, thickness)) {
<a name="l02410"></a>02410         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02411"></a>02411     }
<a name="l02412"></a>02412 
<a name="l02413"></a>02413     <span class="comment">/* deselect only the faces in the region to be solidified (leave wire</span>
<a name="l02414"></a>02414 <span class="comment">     * edges and loose verts selected, as there will be no corresponding</span>
<a name="l02415"></a>02415 <span class="comment">     * geometry selected below) */</span>
<a name="l02416"></a>02416     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a1738215546cdb3e92aec2b09328dad3d" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_disable</a>(bm, &amp;bmop, <span class="stringliteral">&quot;geom&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02417"></a>02417 
<a name="l02418"></a>02418     <span class="comment">/* run the solidify operator */</span>
<a name="l02419"></a>02419     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(bm, &amp;bmop);
<a name="l02420"></a>02420 
<a name="l02421"></a>02421     <span class="comment">/* select the newly generated faces */</span>
<a name="l02422"></a>02422     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(bm, &amp;bmop, <span class="stringliteral">&quot;geomout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02423"></a>02423 
<a name="l02424"></a>02424     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l02425"></a>02425         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02426"></a>02426     }
<a name="l02427"></a>02427 
<a name="l02428"></a>02428     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02429"></a>02429 
<a name="l02430"></a>02430     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02431"></a>02431 }
<a name="l02432"></a>02432 
<a name="l02433"></a>02433 
<a name="l02434"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#ad835b2f7b5eb4b0ff0116b2973c53950">02434</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab9f44d0ee7bf0db3aa92442183d51792">MESH_OT_solidify</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02435"></a>02435 {
<a name="l02436"></a>02436     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l02437"></a>02437     <span class="comment">/* identifiers */</span>
<a name="l02438"></a>02438     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Solidify&quot;</span>;
<a name="l02439"></a>02439     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Create a solid skin by extruding, compensating for sharp angles&quot;</span>;
<a name="l02440"></a>02440     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_solidify&quot;</span>;
<a name="l02441"></a>02441 
<a name="l02442"></a>02442     <span class="comment">/* api callbacks */</span>
<a name="l02443"></a>02443     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a1c4772b4451ebe2cb70904a0f5687793">edbm_solidify_exec</a>;
<a name="l02444"></a>02444     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02445"></a>02445 
<a name="l02446"></a>02446     <span class="comment">/* flags */</span>
<a name="l02447"></a>02447     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02448"></a>02448 
<a name="l02449"></a>02449     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;thickness&quot;</span>, 0.01f, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;thickness&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, -10.0f, 10.0f);
<a name="l02450"></a>02450     <a class="code" href="../../dc/d7e/rna__define_8c.html#aeb47f39a68432b5d1758c3b6922a2fd4">RNA_def_property_ui_range</a>(prop, -10, 10, 0.1, 4);
<a name="l02451"></a>02451 }
<a name="l02452"></a>02452 
<a name="l02453"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af72f8f37dc548b77d2abd5de82b87af7">02453</a> <span class="preprocessor">#define TRAIL_POLYLINE 1 </span><span class="comment">/* For future use, They don&#39;t do anything yet */</span>
<a name="l02454"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a991c53cca44bb2879dcf0e1c7f44076c">02454</a> <span class="preprocessor">#define TRAIL_FREEHAND 2</span>
<a name="l02455"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a7af15edbc916eda730026556f557c2b4">02455</a> <span class="preprocessor"></span><span class="preprocessor">#define TRAIL_MIXED    3 </span><span class="comment">/* (1|2) */</span>
<a name="l02456"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a683e744c5bd680fb2d3e1806747986c7">02456</a> <span class="preprocessor">#define TRAIL_AUTO     4 </span>
<a name="l02457"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ae7cca72e4d2744052daab115d4e3ec84">02457</a> <span class="preprocessor"></span><span class="preprocessor">#define TRAIL_MIDPOINTS 8</span>
<a name="l02458"></a>02458 <span class="preprocessor"></span>
<a name="l02459"></a><a class="code" href="../../d5/d04/structCutCurve.html">02459</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d04/structCutCurve.html">CutCurve</a> {
<a name="l02460"></a><a class="code" href="../../d5/d04/structCutCurve.html#aa3c76e926d0fff7efb37fc4b1d0a5666">02460</a>     <span class="keywordtype">float</span> <a class="code" href="../../d5/d04/structCutCurve.html#aa3c76e926d0fff7efb37fc4b1d0a5666">x</a>;
<a name="l02461"></a><a class="code" href="../../d5/d04/structCutCurve.html#a65ba3ba854965e01a08b997c0eb682e4">02461</a>     <span class="keywordtype">float</span> <a class="code" href="../../d5/d04/structCutCurve.html#a65ba3ba854965e01a08b997c0eb682e4">y</a>;
<a name="l02462"></a>02462 } <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab53ebe49260b014f1e2d1b49387ac7c4">CutCurve</a>;
<a name="l02463"></a>02463 
<a name="l02464"></a>02464 <span class="comment">/* ******************************************************************** */</span>
<a name="l02465"></a>02465 <span class="comment">/* Knife Subdivide Tool.  Subdivides edges intersected by a mouse trail</span>
<a name="l02466"></a>02466 <span class="comment"> * drawn by user.</span>
<a name="l02467"></a>02467 <span class="comment"> *</span>
<a name="l02468"></a>02468 <span class="comment"> * Currently mapped to KKey when in MeshEdit mode.</span>
<a name="l02469"></a>02469 <span class="comment"> * Usage:</span>
<a name="l02470"></a>02470 <span class="comment"> * - Hit Shift K, Select Centers or Exact</span>
<a name="l02471"></a>02471 <span class="comment"> * - Hold LMB down to draw path, hit RETKEY.</span>
<a name="l02472"></a>02472 <span class="comment"> * - ESC cancels as expected.</span>
<a name="l02473"></a>02473 <span class="comment"> *</span>
<a name="l02474"></a>02474 <span class="comment"> * Contributed by Robert Wenzlaff (Det. Thorn).</span>
<a name="l02475"></a>02475 <span class="comment"> *</span>
<a name="l02476"></a>02476 <span class="comment"> * 2.5 Revamp:</span>
<a name="l02477"></a>02477 <span class="comment"> *  - non modal (no menu before cutting)</span>
<a name="l02478"></a>02478 <span class="comment"> *  - exit on mouse release</span>
<a name="l02479"></a>02479 <span class="comment"> *  - polygon/segment drawing can become handled by WM cb later</span>
<a name="l02480"></a>02480 <span class="comment"> *</span>
<a name="l02481"></a>02481 <span class="comment"> * bmesh port version</span>
<a name="l02482"></a>02482 <span class="comment"> */</span>
<a name="l02483"></a>02483 
<a name="l02484"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a59bb0a91cebde32d96ba1c47f736e0d0">02484</a> <span class="preprocessor">#define KNIFE_EXACT     1</span>
<a name="l02485"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a85300959f0210768543a7aacb1f798bc">02485</a> <span class="preprocessor"></span><span class="preprocessor">#define KNIFE_MIDPOINT  2</span>
<a name="l02486"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a683ddf2100cac3c2aff5824bdb07f7e8">02486</a> <span class="preprocessor"></span><span class="preprocessor">#define KNIFE_MULTICUT  3</span>
<a name="l02487"></a>02487 <span class="preprocessor"></span>
<a name="l02488"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a24b23bd11e26b096c427654f9eea0eb8">02488</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a24b23bd11e26b096c427654f9eea0eb8">knife_items</a>[] = {
<a name="l02489"></a>02489     {<a class="code" href="../../d0/d85/editmesh__tools_8c.html#a59bb0a91cebde32d96ba1c47f736e0d0">KNIFE_EXACT</a>, <span class="stringliteral">&quot;EXACT&quot;</span>, 0, <span class="stringliteral">&quot;Exact&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02490"></a>02490     {<a class="code" href="../../d0/d85/editmesh__tools_8c.html#a85300959f0210768543a7aacb1f798bc">KNIFE_MIDPOINT</a>, <span class="stringliteral">&quot;MIDPOINTS&quot;</span>, 0, <span class="stringliteral">&quot;Midpoints&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02491"></a>02491     {<a class="code" href="../../d0/d85/editmesh__tools_8c.html#a683ddf2100cac3c2aff5824bdb07f7e8">KNIFE_MULTICUT</a>, <span class="stringliteral">&quot;MULTICUT&quot;</span>, 0, <span class="stringliteral">&quot;Multicut&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02492"></a>02492     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l02493"></a>02493 };
<a name="l02494"></a>02494 
<a name="l02495"></a>02495 <span class="comment">/* bm_edge_seg_isect() Determines if and where a mouse trail intersects an BMEdge */</span>
<a name="l02496"></a>02496 
<a name="l02497"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#aee9c8653ea40ae0f53979c9d3f26df8e">02497</a> <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aee9c8653ea40ae0f53979c9d3f26df8e">bm_edge_seg_isect</a>(<a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *e, <a class="code" href="../../d5/d04/structCutCurve.html">CutCurve</a> *c, <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>, <span class="keywordtype">char</span> mode,
<a name="l02498"></a>02498                                <span class="keyword">struct</span> <a class="code" href="../../df/da0/structGHash.html">GHash</a> *gh, <span class="keywordtype">int</span> *isected)
<a name="l02499"></a>02499 {
<a name="l02500"></a>02500 <span class="preprocessor">#define MAXSLOPE 100000</span>
<a name="l02501"></a>02501 <span class="preprocessor"></span>    <span class="keywordtype">float</span> x11, y11, x12 = 0, y12 = 0, x2max, x2min, y2max;
<a name="l02502"></a>02502     <span class="keywordtype">float</span> y2min, dist, lastdist = 0, xdiff2, xdiff1;
<a name="l02503"></a>02503     <span class="keywordtype">float</span> m1, b1, m2, b2, x21, x22, y21, y22, xi;
<a name="l02504"></a>02504     <span class="keywordtype">float</span> yi, x1min, x1max, y1max, y1min, perc = 0;
<a name="l02505"></a>02505     <span class="keywordtype">float</span>  *scr;
<a name="l02506"></a>02506     <span class="keywordtype">float</span> threshold = 0.0;
<a name="l02507"></a>02507     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l02508"></a>02508     
<a name="l02509"></a>02509     <span class="comment">//threshold = 0.000001; /* tolerance for vertex intersection */</span>
<a name="l02510"></a>02510     <span class="comment">// XXX threshold = scene-&gt;toolsettings-&gt;select_thresh / 100;</span>
<a name="l02511"></a>02511     
<a name="l02512"></a>02512     <span class="comment">/* Get screen coords of verts */</span>
<a name="l02513"></a>02513     scr = <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#ac3bdece51152c2b9d4deff6771958b69">BLI_ghash_lookup</a>(gh, e-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>);
<a name="l02514"></a>02514     x21 = scr[0];
<a name="l02515"></a>02515     y21 = scr[1];
<a name="l02516"></a>02516     
<a name="l02517"></a>02517     scr = <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#ac3bdece51152c2b9d4deff6771958b69">BLI_ghash_lookup</a>(gh, e-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>);
<a name="l02518"></a>02518     x22 = scr[0];
<a name="l02519"></a>02519     y22 = scr[1];
<a name="l02520"></a>02520     
<a name="l02521"></a>02521     xdiff2 = (x22 - x21);
<a name="l02522"></a>02522     <span class="keywordflow">if</span> (xdiff2) {
<a name="l02523"></a>02523         m2 = (y22 - y21) / xdiff2;
<a name="l02524"></a>02524         b2 = ((x22 * y21) - (x21 * y22)) / xdiff2;
<a name="l02525"></a>02525     }
<a name="l02526"></a>02526     <span class="keywordflow">else</span> {
<a name="l02527"></a>02527         m2 = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a98a7ee57801e9fcdf6947d933e18a8c2">MAXSLOPE</a>;  <span class="comment">/* Verticle slope  */</span>
<a name="l02528"></a>02528         b2 = x22;
<a name="l02529"></a>02529     }
<a name="l02530"></a>02530 
<a name="l02531"></a>02531     *isected = 0;
<a name="l02532"></a>02532 
<a name="l02533"></a>02533     <span class="comment">/* check for _exact_ vertex intersection first */</span>
<a name="l02534"></a>02534     <span class="keywordflow">if</span> (mode != <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a683ddf2100cac3c2aff5824bdb07f7e8">KNIFE_MULTICUT</a>) {
<a name="l02535"></a>02535         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>; i++) {
<a name="l02536"></a>02536             <span class="keywordflow">if</span> (i &gt; 0) {
<a name="l02537"></a>02537                 x11 = x12;
<a name="l02538"></a>02538                 y11 = y12;
<a name="l02539"></a>02539             }
<a name="l02540"></a>02540             <span class="keywordflow">else</span> {
<a name="l02541"></a>02541                 x11 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#aa3c76e926d0fff7efb37fc4b1d0a5666">x</a>;
<a name="l02542"></a>02542                 y11 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#a65ba3ba854965e01a08b997c0eb682e4">y</a>;
<a name="l02543"></a>02543             }
<a name="l02544"></a>02544             x12 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#aa3c76e926d0fff7efb37fc4b1d0a5666">x</a>;
<a name="l02545"></a>02545             y12 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#a65ba3ba854965e01a08b997c0eb682e4">y</a>;
<a name="l02546"></a>02546             
<a name="l02547"></a>02547             <span class="comment">/* test e-&gt;v1 */</span>
<a name="l02548"></a>02548             <span class="keywordflow">if</span> ((x11 == x21 &amp;&amp; y11 == y21) || (x12 == x21 &amp;&amp; y12 == y21)) {
<a name="l02549"></a>02549                 perc = 0;
<a name="l02550"></a>02550                 *isected = 1;
<a name="l02551"></a>02551                 <span class="keywordflow">return</span> perc;
<a name="l02552"></a>02552             }
<a name="l02553"></a>02553             <span class="comment">/* test e-&gt;v2 */</span>
<a name="l02554"></a>02554             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x11 == x22 &amp;&amp; y11 == y22) || (x12 == x22 &amp;&amp; y12 == y22)) {
<a name="l02555"></a>02555                 perc = 0;
<a name="l02556"></a>02556                 *isected = 2;
<a name="l02557"></a>02557                 <span class="keywordflow">return</span> perc;
<a name="l02558"></a>02558             }
<a name="l02559"></a>02559         }
<a name="l02560"></a>02560     }
<a name="l02561"></a>02561     
<a name="l02562"></a>02562     <span class="comment">/* now check for edge intersect (may produce vertex intersection as well) */</span>
<a name="l02563"></a>02563     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>; i++) {
<a name="l02564"></a>02564         <span class="keywordflow">if</span> (i &gt; 0) {
<a name="l02565"></a>02565             x11 = x12;
<a name="l02566"></a>02566             y11 = y12;
<a name="l02567"></a>02567         }
<a name="l02568"></a>02568         <span class="keywordflow">else</span> {
<a name="l02569"></a>02569             x11 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#aa3c76e926d0fff7efb37fc4b1d0a5666">x</a>;
<a name="l02570"></a>02570             y11 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#a65ba3ba854965e01a08b997c0eb682e4">y</a>;
<a name="l02571"></a>02571         }
<a name="l02572"></a>02572         x12 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#aa3c76e926d0fff7efb37fc4b1d0a5666">x</a>;
<a name="l02573"></a>02573         y12 = c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d04/structCutCurve.html#a65ba3ba854965e01a08b997c0eb682e4">y</a>;
<a name="l02574"></a>02574         
<a name="l02575"></a>02575         <span class="comment">/* Perp. Distance from point to line */</span>
<a name="l02576"></a>02576         <span class="keywordflow">if</span> (m2 != <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a98a7ee57801e9fcdf6947d933e18a8c2">MAXSLOPE</a>) dist = (y12 - m2 * x12 - b2);  <span class="comment">/* /sqrt(m2 * m2 + 1); Only looking for */</span>
<a name="l02577"></a>02577         <span class="comment">/* change in sign.  Skip extra math */</span>
<a name="l02578"></a>02578         <span class="keywordflow">else</span> dist = x22 - x12;
<a name="l02579"></a>02579         
<a name="l02580"></a>02580         <span class="keywordflow">if</span> (i == 0) lastdist = dist;
<a name="l02581"></a>02581         
<a name="l02582"></a>02582         <span class="comment">/* if dist changes sign, and intersect point in edge&#39;s Bound Box */</span>
<a name="l02583"></a>02583         <span class="keywordflow">if</span> ((lastdist * dist) &lt;= 0) {
<a name="l02584"></a>02584             xdiff1 = (x12 - x11); <span class="comment">/* Equation of line between last 2 points */</span>
<a name="l02585"></a>02585             <span class="keywordflow">if</span> (xdiff1) {
<a name="l02586"></a>02586                 m1 = (y12 - y11) / xdiff1;
<a name="l02587"></a>02587                 b1 = ((x12 * y11) - (x11 * y12)) / xdiff1;
<a name="l02588"></a>02588             }
<a name="l02589"></a>02589             <span class="keywordflow">else</span> {
<a name="l02590"></a>02590                 m1 = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a98a7ee57801e9fcdf6947d933e18a8c2">MAXSLOPE</a>;
<a name="l02591"></a>02591                 b1 = x12;
<a name="l02592"></a>02592             }
<a name="l02593"></a>02593             x2max = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(x21, x22) + 0.001; <span class="comment">/* prevent missed edges   */</span>
<a name="l02594"></a>02594             x2min = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(x21, x22) - 0.001; <span class="comment">/* due to round off error */</span>
<a name="l02595"></a>02595             y2max = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(y21, y22) + 0.001;
<a name="l02596"></a>02596             y2min = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(y21, y22) - 0.001;
<a name="l02597"></a>02597             
<a name="l02598"></a>02598             <span class="comment">/* Found an intersect,  calc intersect point */</span>
<a name="l02599"></a>02599             <span class="keywordflow">if</span> (m1 == m2) { <span class="comment">/* co-incident lines */</span>
<a name="l02600"></a>02600                 <span class="comment">/* cut at 50% of overlap area */</span>
<a name="l02601"></a>02601                 x1max = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(x11, x12);
<a name="l02602"></a>02602                 x1min = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(x11, x12);
<a name="l02603"></a>02603                 xi = (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(x2max, x1max) + <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(x2min, x1min)) / 2.0;
<a name="l02604"></a>02604                 
<a name="l02605"></a>02605                 y1max = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(y11, y12);
<a name="l02606"></a>02606                 y1min = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(y11, y12);
<a name="l02607"></a>02607                 yi = (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(y2max, y1max) + <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(y2min, y1min)) / 2.0;
<a name="l02608"></a>02608             }
<a name="l02609"></a>02609             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m2 == <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a98a7ee57801e9fcdf6947d933e18a8c2">MAXSLOPE</a>) {
<a name="l02610"></a>02610                 xi = x22;
<a name="l02611"></a>02611                 yi = m1 * x22 + b1;
<a name="l02612"></a>02612             }
<a name="l02613"></a>02613             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m1 == <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a98a7ee57801e9fcdf6947d933e18a8c2">MAXSLOPE</a>) {
<a name="l02614"></a>02614                 xi = x12;
<a name="l02615"></a>02615                 yi = m2 * x12 + b2;
<a name="l02616"></a>02616             }
<a name="l02617"></a>02617             <span class="keywordflow">else</span> {
<a name="l02618"></a>02618                 xi = (b1 - b2) / (m2 - m1);
<a name="l02619"></a>02619                 yi = (b1 * m2 - m1 * b2) / (m2 - m1);
<a name="l02620"></a>02620             }
<a name="l02621"></a>02621             
<a name="l02622"></a>02622             <span class="comment">/* Intersect inside bounding box of edge?*/</span>
<a name="l02623"></a>02623             <span class="keywordflow">if</span> ((xi &gt;= x2min) &amp;&amp; (xi &lt;= x2max) &amp;&amp; (yi &lt;= y2max) &amp;&amp; (yi &gt;= y2min)) {
<a name="l02624"></a>02624                 <span class="comment">/* test for vertex intersect that may be &#39;close enough&#39;*/</span>
<a name="l02625"></a>02625                 <span class="keywordflow">if</span> (mode != <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a683ddf2100cac3c2aff5824bdb07f7e8">KNIFE_MULTICUT</a>) {
<a name="l02626"></a>02626                     <span class="keywordflow">if</span> (xi &lt;= (x21 + threshold) &amp;&amp; xi &gt;= (x21 - threshold)) {
<a name="l02627"></a>02627                         <span class="keywordflow">if</span> (yi &lt;= (y21 + threshold) &amp;&amp; yi &gt;= (y21 - threshold)) {
<a name="l02628"></a>02628                             *isected = 1;
<a name="l02629"></a>02629                             perc = 0;
<a name="l02630"></a>02630                             <span class="keywordflow">break</span>;
<a name="l02631"></a>02631                         }
<a name="l02632"></a>02632                     }
<a name="l02633"></a>02633                     <span class="keywordflow">if</span> (xi &lt;= (x22 + threshold) &amp;&amp; xi &gt;= (x22 - threshold)) {
<a name="l02634"></a>02634                         <span class="keywordflow">if</span> (yi &lt;= (y22 + threshold) &amp;&amp; yi &gt;= (y22 - threshold)) {
<a name="l02635"></a>02635                             *isected = 2;
<a name="l02636"></a>02636                             perc = 0;
<a name="l02637"></a>02637                             <span class="keywordflow">break</span>;
<a name="l02638"></a>02638                         }
<a name="l02639"></a>02639                     }
<a name="l02640"></a>02640                 }
<a name="l02641"></a>02641                 <span class="keywordflow">if</span> ((m2 &lt;= 1.0f) &amp;&amp; (m2 &gt;= -1.0f)) perc = (xi - x21) / (x22 - x21);
<a name="l02642"></a>02642                 <span class="keywordflow">else</span> perc = (yi - y21) / (y22 - y21);  <span class="comment">/* lower slope more accurate */</span>
<a name="l02643"></a>02643                 <span class="comment">//isect = 32768.0 * (perc + 0.0000153); /* Percentage in 1 / 32768ths */</span>
<a name="l02644"></a>02644                 
<a name="l02645"></a>02645                 <span class="keywordflow">break</span>;
<a name="l02646"></a>02646             }
<a name="l02647"></a>02647         }   
<a name="l02648"></a>02648         lastdist = dist;
<a name="l02649"></a>02649     }
<a name="l02650"></a>02650     <span class="keywordflow">return</span> perc;
<a name="l02651"></a>02651 } 
<a name="l02652"></a>02652 
<a name="l02653"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#abad9f44b81595a48c19e50f61318edb7">02653</a> <span class="preprocessor">#define MAX_CUTS 2048</span>
<a name="l02654"></a>02654 <span class="preprocessor"></span>
<a name="l02655"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2b99b83d28ee6bb44cce4992b5311532">02655</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2b99b83d28ee6bb44cce4992b5311532">edbm_knife_cut_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02656"></a>02656 {
<a name="l02657"></a>02657     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l02658"></a>02658     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l02659"></a>02659     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l02660"></a>02660     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l02661"></a>02661     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *bv;
<a name="l02662"></a>02662     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l02663"></a>02663     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *be;
<a name="l02664"></a>02664     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l02665"></a>02665     <a class="code" href="../../d5/d04/structCutCurve.html">CutCurve</a> curve[<a class="code" href="../../d0/d85/editmesh__tools_8c.html#abad9f44b81595a48c19e50f61318edb7">MAX_CUTS</a>];
<a name="l02666"></a>02666     <span class="keyword">struct </span><a class="code" href="../../df/da0/structGHash.html">GHash</a> *gh;
<a name="l02667"></a>02667     <span class="keywordtype">float</span> isect = 0.0f;
<a name="l02668"></a>02668     <span class="keywordtype">float</span>  *scr, <a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>[4];
<a name="l02669"></a>02669     <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = 0, isected;
<a name="l02670"></a>02670     <span class="keywordtype">short</span> numcuts = 1, mode = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l02671"></a>02671     
<a name="l02672"></a>02672     <span class="comment">/* edit-object needed for matrix, and ar-&gt;regiondata for projections to work */</span>
<a name="l02673"></a>02673     <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, obedit, ar, ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>))
<a name="l02674"></a>02674         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02675"></a>02675     
<a name="l02676"></a>02676     <span class="keywordflow">if</span> (bm-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a63cca38a2559df39fd49e10a02f96f3b">totvertsel</a> &lt; 2) {
<a name="l02677"></a>02677         <span class="comment">//error(&quot;No edges are selected to operate on&quot;);</span>
<a name="l02678"></a>02678         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02679"></a>02679     }
<a name="l02680"></a>02680 
<a name="l02681"></a>02681     <span class="comment">/* get the cut curve */</span>
<a name="l02682"></a>02682     <a class="code" href="../../de/ddf/RNA__access_8h.html#a0310a34930fc9ac8d15a39c38d3dd429">RNA_BEGIN</a> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, itemptr, <span class="stringliteral">&quot;path&quot;</span>) {
<a name="l02683"></a>02683         <a class="code" href="../../d3/d10/rna__access_8c.html#a5d95f86ccce314676ae750034fb56709">RNA_float_get_array</a>(&amp;itemptr, <span class="stringliteral">&quot;loc&quot;</span>, (<span class="keywordtype">float</span> *)&amp;curve[len]);
<a name="l02684"></a>02684         len++;
<a name="l02685"></a>02685         <span class="keywordflow">if</span> (len &gt;= <a class="code" href="../../d0/d85/editmesh__tools_8c.html#abad9f44b81595a48c19e50f61318edb7">MAX_CUTS</a>) {
<a name="l02686"></a>02686             <span class="keywordflow">break</span>;
<a name="l02687"></a>02687         }
<a name="l02688"></a>02688     }
<a name="l02689"></a>02689     <a class="code" href="../../de/ddf/RNA__access_8h.html#a245d0341a908eab74fc30b93cf24a74d">RNA_END</a>;
<a name="l02690"></a>02690     
<a name="l02691"></a>02691     <span class="keywordflow">if</span> (len &lt; 2) {
<a name="l02692"></a>02692         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02693"></a>02693     }
<a name="l02694"></a>02694 
<a name="l02695"></a>02695     <span class="comment">/* the floating point coordinates of verts in screen space will be stored in a hash table according to the vertices pointer */</span>
<a name="l02696"></a>02696     gh = <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#af2fb34af7b99547b33a34380451a963d">BLI_ghash_new</a>(<a class="code" href="../../d7/dc5/BLI__ghash_8h.html#a371913beecfb01de3d0a8d5f0bb598d4">BLI_ghashutil_ptrhash</a>, <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#a51865a4bfcfc2502e01a9369bfb72877">BLI_ghashutil_ptrcmp</a>, <span class="stringliteral">&quot;knife cut exec&quot;</span>);
<a name="l02697"></a>02697     <span class="keywordflow">for</span> (bv = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); bv; bv = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;iter)) {
<a name="l02698"></a>02698         scr = <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * 2, <span class="stringliteral">&quot;Vertex Screen Coordinates&quot;</span>);
<a name="l02699"></a>02699         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(co, bv-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l02700"></a>02700         co[3] = 1.0f;
<a name="l02701"></a>02701         <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a0317104b02abeeb617a3d53af7070820">mul_m4_v4</a>(obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>, co);
<a name="l02702"></a>02702         <a class="code" href="../../d8/d6a/ED__view3d_8h.html#af20708c74cee9dd6a964e68911246ef8">project_float</a>(ar, co, scr);
<a name="l02703"></a>02703         <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#ad72f3a6d9b88bc494c6a279d1b7b9165">BLI_ghash_insert</a>(gh, bv, scr);
<a name="l02704"></a>02704     }
<a name="l02705"></a>02705 
<a name="l02706"></a>02706     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;esubd&quot;</span>)) {
<a name="l02707"></a>02707         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02708"></a>02708     }
<a name="l02709"></a>02709 
<a name="l02710"></a>02710     <span class="comment">/* store percentage of edge cut for KNIFE_EXACT here.*/</span>
<a name="l02711"></a>02711     <span class="keywordflow">for</span> (be = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); be; be = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;iter)) {
<a name="l02712"></a>02712         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(be, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l02713"></a>02713             isect = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aee9c8653ea40ae0f53979c9d3f26df8e">bm_edge_seg_isect</a>(be, curve, len, mode, gh, &amp;isected);
<a name="l02714"></a>02714             
<a name="l02715"></a>02715             <span class="keywordflow">if</span> (isect != 0.0f) {
<a name="l02716"></a>02716                 <span class="keywordflow">if</span> (mode != <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a683ddf2100cac3c2aff5824bdb07f7e8">KNIFE_MULTICUT</a> &amp;&amp; mode != <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a85300959f0210768543a7aacb1f798bc">KNIFE_MIDPOINT</a>) {
<a name="l02717"></a>02717                     <a class="code" href="../../d6/d21/bmesh__operator__api__inline_8h.html#af7199dd9307694e23c23bc3d0759680e">BMO_slot_map_float_insert</a>(bm, &amp;bmop,
<a name="l02718"></a>02718                                               <span class="stringliteral">&quot;edgepercents&quot;</span>,
<a name="l02719"></a>02719                                               be, isect);
<a name="l02720"></a>02720 
<a name="l02721"></a>02721                 }
<a name="l02722"></a>02722                 <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac8b0b897ab30ade097cd0b9b5a8817c2">BMO_elem_flag_enable</a>(bm, be, 1);
<a name="l02723"></a>02723             }
<a name="l02724"></a>02724             <span class="keywordflow">else</span> {
<a name="l02725"></a>02725                 <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a045007133673a18b6e8f120f533a129e">BMO_elem_flag_disable</a>(bm, be, 1);
<a name="l02726"></a>02726             }
<a name="l02727"></a>02727         }
<a name="l02728"></a>02728         <span class="keywordflow">else</span> {
<a name="l02729"></a>02729             <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a045007133673a18b6e8f120f533a129e">BMO_elem_flag_disable</a>(bm, be, 1);
<a name="l02730"></a>02730         }
<a name="l02731"></a>02731     }
<a name="l02732"></a>02732     
<a name="l02733"></a>02733     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ad8258ef654a8fcfcd20255bff6bac832">BMO_slot_buffer_from_enabled_flag</a>(bm, &amp;bmop, <span class="stringliteral">&quot;edges&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>, 1);
<a name="l02734"></a>02734 
<a name="l02735"></a>02735     <span class="keywordflow">if</span> (mode == <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a85300959f0210768543a7aacb1f798bc">KNIFE_MIDPOINT</a>) numcuts = 1;
<a name="l02736"></a>02736     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a30493a59a997d67f36d2c82ee44ebc8b">BMO_slot_int_set</a>(&amp;bmop, <span class="stringliteral">&quot;numcuts&quot;</span>, numcuts);
<a name="l02737"></a>02737 
<a name="l02738"></a>02738     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a30493a59a997d67f36d2c82ee44ebc8b">BMO_slot_int_set</a>(&amp;bmop, <span class="stringliteral">&quot;quadcornertype&quot;</span>, <a class="code" href="../../de/d95/bmesh__operators_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a6f39f1e617c741d6456153cab7c3468d">SUBD_STRAIGHT_CUT</a>);
<a name="l02739"></a>02739     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ae3937314a4a4857d5382397e6619e463">BMO_slot_bool_set</a>(&amp;bmop, <span class="stringliteral">&quot;use_singleedge&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02740"></a>02740     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ae3937314a4a4857d5382397e6619e463">BMO_slot_bool_set</a>(&amp;bmop, <span class="stringliteral">&quot;use_gridfill&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02741"></a>02741 
<a name="l02742"></a>02742     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a18e39efb71e69449f3ffdaa948fb9b97">BMO_slot_float_set</a>(&amp;bmop, <span class="stringliteral">&quot;radius&quot;</span>, 0);
<a name="l02743"></a>02743     
<a name="l02744"></a>02744     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(bm, &amp;bmop);
<a name="l02745"></a>02745     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l02746"></a>02746         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02747"></a>02747     }
<a name="l02748"></a>02748     
<a name="l02749"></a>02749     <a class="code" href="../../d7/dc5/BLI__ghash_8h.html#adc20ede3cd08276d25c11f2d02768119">BLI_ghash_free</a>(gh, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, (<a class="code" href="../../d7/dc5/BLI__ghash_8h.html#a53210a0b5c7bd4568f50f16dd85f04a6">GHashValFreeFP</a>)<a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>);
<a name="l02750"></a>02750 
<a name="l02751"></a>02751     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02752"></a>02752 
<a name="l02753"></a>02753     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02754"></a>02754 }
<a name="l02755"></a>02755 
<a name="l02756"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a5acba01598683797a22c81acc3d0e3ef">02756</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8ad5799cedd8ce3a4b918056a266f598">MESH_OT_knife_cut</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02757"></a>02757 {
<a name="l02758"></a>02758     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l02759"></a>02759     
<a name="l02760"></a>02760     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Knife Cut&quot;</span>;
<a name="l02761"></a>02761     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Cut selected edges and faces into parts&quot;</span>;
<a name="l02762"></a>02762     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_knife_cut&quot;</span>;
<a name="l02763"></a>02763     
<a name="l02764"></a>02764     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a6e3d94d2b105cd626ec262e2de31c6d7">WM_gesture_lines_invoke</a>;
<a name="l02765"></a>02765     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#ac64d748df121db8d3126cc72910289b9">WM_gesture_lines_modal</a>;
<a name="l02766"></a>02766     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2b99b83d28ee6bb44cce4992b5311532">edbm_knife_cut_exec</a>;
<a name="l02767"></a>02767     
<a name="l02768"></a>02768     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a3a39013ec4b54ccfd2a9506bfca5b0b5">EM_view3d_poll</a>;
<a name="l02769"></a>02769     
<a name="l02770"></a>02770     <span class="comment">/* flags */</span>
<a name="l02771"></a>02771     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02772"></a>02772     
<a name="l02773"></a>02773     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, knife_items, <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a59bb0a91cebde32d96ba1c47f736e0d0">KNIFE_EXACT</a>, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02774"></a>02774     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a91cb4d1ec0eb64b77f2e193607eaec4c">RNA_def_property</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;path&quot;</span>, <a class="code" href="../../de/d7e/RNA__types_8h.html#a7ff5a5c54f182b86d1cd993cf4512c87af6747d14516095c7da178bdce8ec547e">PROP_COLLECTION</a>, <a class="code" href="../../de/d7e/RNA__types_8h.html#afc8d3af46d7ce49bb3e75305354fd9bca8134bae8bb64b7bab4a27a4b504f8081">PROP_NONE</a>);
<a name="l02775"></a>02775     <a class="code" href="../../dc/d7e/rna__define_8c.html#a3b6e29f6229322ce084b6a9df34dfe5d">RNA_def_property_struct_runtime</a>(prop, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#adc48d820579cb86b1e06c0e9f10a22b2">RNA_OperatorMousePath</a>);
<a name="l02776"></a>02776     
<a name="l02777"></a>02777     <span class="comment">/* internal */</span>
<a name="l02778"></a>02778     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;cursor&quot;</span>, <a class="code" href="../../db/da6/wm__cursors_8h.html#a737c1bdca78a4eec48fa026fcca3dd9ba7f8faa1caf5643f093157898591ccb6d">BC_KNIFECURSOR</a>, 0, INT_MAX, <span class="stringliteral">&quot;Cursor&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0, INT_MAX);
<a name="l02779"></a>02779 }
<a name="l02780"></a>02780 
<a name="l02781"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a47e93f44a0f99a2ab9f4c335a8f40c16">02781</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a47e93f44a0f99a2ab9f4c335a8f40c16">mesh_separate_selected</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d3/da9/structBase.html">Base</a> *editbase, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *wmop)
<a name="l02782"></a>02782 {
<a name="l02783"></a>02783     <a class="code" href="../../d3/da9/structBase.html">Base</a> *basenew;
<a name="l02784"></a>02784     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l02785"></a>02785     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *v;
<a name="l02786"></a>02786     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *e;
<a name="l02787"></a>02787     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = editbase-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l02788"></a>02788     <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me = obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l02789"></a>02789     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = me-&gt;<a class="code" href="../../da/d29/structMesh.html#a1b0a1797d0b3927b83f36b2d8d579ddb">edit_btmesh</a>;
<a name="l02790"></a>02790     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm_new;
<a name="l02791"></a>02791     
<a name="l02792"></a>02792     <span class="keywordflow">if</span> (!em)
<a name="l02793"></a>02793         <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02794"></a>02794         
<a name="l02795"></a>02795     bm_new = <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#a6f9c120579fc0fa39567d1c2add3a21d" title="BMesh Make Mesh.">BM_mesh_create</a>(&amp;<a class="code" href="../../d5/db9/bmesh__mesh_8c.html#a0b96f95bc7f4f95e93d1ac953cd2f041">bm_mesh_allocsize_default</a>);
<a name="l02796"></a>02796     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a3c46f1ea248ceb0f206d49b24b162cff">CustomData_copy</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, &amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6b280c14c851f614ba59d87cc272de49">CD_MASK_BMESH</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a05108c9597b8051246fc8fbc09caa56d">CD_CALLOC</a>, 0);
<a name="l02797"></a>02797     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a3c46f1ea248ceb0f206d49b24b162cff">CustomData_copy</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a5004aa4bd19e25b6479f21ae3bf32cbc">edata</a>, &amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a5004aa4bd19e25b6479f21ae3bf32cbc">edata</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6b280c14c851f614ba59d87cc272de49">CD_MASK_BMESH</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a05108c9597b8051246fc8fbc09caa56d">CD_CALLOC</a>, 0);
<a name="l02798"></a>02798     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a3c46f1ea248ceb0f206d49b24b162cff">CustomData_copy</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#abee9716c152e57c29af7d211ced0e178">ldata</a>, &amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#abee9716c152e57c29af7d211ced0e178">ldata</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6b280c14c851f614ba59d87cc272de49">CD_MASK_BMESH</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a05108c9597b8051246fc8fbc09caa56d">CD_CALLOC</a>, 0);
<a name="l02799"></a>02799     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a3c46f1ea248ceb0f206d49b24b162cff">CustomData_copy</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#abda690b32c834c8ee41e225cfd2d9e49">pdata</a>, &amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#abda690b32c834c8ee41e225cfd2d9e49">pdata</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6b280c14c851f614ba59d87cc272de49">CD_MASK_BMESH</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a05108c9597b8051246fc8fbc09caa56d">CD_CALLOC</a>, 0);
<a name="l02800"></a>02800 
<a name="l02801"></a>02801     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6076f1c570b49532276c81d31056914b">CustomData_bmesh_init_pool</a>(&amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a3d10124795ce1025cd86a29fb3c8819c">vdata</a>, <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#a0b96f95bc7f4f95e93d1ac953cd2f041">bm_mesh_allocsize_default</a>.<a class="code" href="../../de/d11/structBMAllocTemplate.html#afb4547cee137a4feab9580b5cc2fc0e3">totvert</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a>);
<a name="l02802"></a>02802     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6076f1c570b49532276c81d31056914b">CustomData_bmesh_init_pool</a>(&amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a5004aa4bd19e25b6479f21ae3bf32cbc">edata</a>, <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#a0b96f95bc7f4f95e93d1ac953cd2f041">bm_mesh_allocsize_default</a>.<a class="code" href="../../de/d11/structBMAllocTemplate.html#afc2247cd626638e6fed14fd19a7ec91b">totedge</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>);
<a name="l02803"></a>02803     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6076f1c570b49532276c81d31056914b">CustomData_bmesh_init_pool</a>(&amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#abee9716c152e57c29af7d211ced0e178">ldata</a>, <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#a0b96f95bc7f4f95e93d1ac953cd2f041">bm_mesh_allocsize_default</a>.<a class="code" href="../../de/d11/structBMAllocTemplate.html#aa9fe33e2aa555b4d5ec07c12ecda897a">totloop</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a0e6e081b5fbd87ab04436dcecf84e1ec">BM_LOOP</a>);
<a name="l02804"></a>02804     <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a6076f1c570b49532276c81d31056914b">CustomData_bmesh_init_pool</a>(&amp;bm_new-&gt;<a class="code" href="../../d7/d18/structBMesh.html#abda690b32c834c8ee41e225cfd2d9e49">pdata</a>, <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#a0b96f95bc7f4f95e93d1ac953cd2f041">bm_mesh_allocsize_default</a>.<a class="code" href="../../de/d11/structBMAllocTemplate.html#a847926cf70f263c0097ea20f07c52ed9">totface</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>);
<a name="l02805"></a>02805         
<a name="l02806"></a>02806     basenew = <a class="code" href="../../da/d7a/ED__object_8h.html#aa93e8afe3780f669ae8fe17af3ebcfe6">ED_object_add_duplicate</a>(bmain, scene, editbase, <a class="code" href="../../d7/de4/DNA__userdef__types_8h.html#a3eec673916981806e6797f0cf5c1e7e5">USER_DUP_MESH</a>);   <span class="comment">/* 0 = fully linked */</span>
<a name="l02807"></a>02807     <a class="code" href="../../d4/d0f/BKE__material_8h.html#ae162fa7cf7da6ff12ea6723d63bf8617">assign_matarar</a>(basenew-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>, <a class="code" href="../../d4/d0f/BKE__material_8h.html#a3c6ad3e5c07858e4809487fc11af38eb">give_matarar</a>(obedit), *<a class="code" href="../../d4/d0f/BKE__material_8h.html#a11593c21969f7c374bb82b5aa75630b3">give_totcolp</a>(obedit)); <span class="comment">/* new in 2.5 */</span>
<a name="l02808"></a>02808 
<a name="l02809"></a>02809     <a class="code" href="../../da/d7a/ED__object_8h.html#a01ac0829970381f4f64f23ca405f8ab1">ED_base_object_select</a>(basenew, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a4df561d775f9f3c0df70f202f357eabb">BA_DESELECT</a>);
<a name="l02810"></a>02810     
<a name="l02811"></a>02811     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;dupe geom=%hvef dest=%p&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, bm_new);
<a name="l02812"></a>02812     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;del geom=%hvef context=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87edda5677f7b6066364293961f44ed1eb9a33">DEL_FACES</a>);
<a name="l02813"></a>02813 
<a name="l02814"></a>02814     <span class="comment">/* clean up any loose edges */</span>
<a name="l02815"></a>02815     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (e, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l02816"></a>02816         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(e, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l02817"></a>02817             <span class="keywordflow">continue</span>;
<a name="l02818"></a>02818 
<a name="l02819"></a>02819         <span class="keywordflow">if</span> (!<a class="code" href="../../d9/ddf/bmesh__queries_8c.html#ae522d6d5d1107bd273d7fccdf1d93278">BM_edge_is_wire</a>(e)) {
<a name="l02820"></a>02820             <a class="code" href="../../d5/def/bmesh__marking_8c.html#a36117bf878409d6e7a6025d5fc7d2c50" title="Select Edge.">BM_edge_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, e, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02821"></a>02821         }
<a name="l02822"></a>02822     }
<a name="l02823"></a>02823     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;del geom=%hvef context=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87edda17039e8ade216c79cb1bfa77901f6b3b">DEL_EDGES</a>);
<a name="l02824"></a>02824 
<a name="l02825"></a>02825     <span class="comment">/* clean up any loose verts */</span>
<a name="l02826"></a>02826     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (v, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l02827"></a>02827         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(v, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a0f4942a13726e12780bb5a0c07219953">BM_ELEM_HIDDEN</a>))
<a name="l02828"></a>02828             <span class="keywordflow">continue</span>;
<a name="l02829"></a>02829 
<a name="l02830"></a>02830         <span class="keywordflow">if</span> (<a class="code" href="../../d9/ddf/bmesh__queries_8c.html#a8ed7371bf3af4e8e62e5315ecf1995ad">BM_vert_edge_count</a>(v) != 0) {
<a name="l02831"></a>02831             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, v, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02832"></a>02832         }
<a name="l02833"></a>02833     }
<a name="l02834"></a>02834 
<a name="l02835"></a>02835     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, wmop, <span class="stringliteral">&quot;del geom=%hvef context=%i&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#ac205be2172292384dd687b5471a87eddaa0158e5b0ed23eeeb6d2c84d9f7ec21b">DEL_VERTS</a>);
<a name="l02836"></a>02836 
<a name="l02837"></a>02837     <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#ac71038cf4336c3efd8a7d2a247091571" title="BMesh Compute Normals.">BM_mesh_normals_update</a>(bm_new, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02838"></a>02838 
<a name="l02839"></a>02839     <a class="code" href="../../d4/da7/bmesh__mesh__conv_8c.html#ad842bcf863e2244f3aec1a1c9a7c84b5">BM_mesh_bm_to_me</a>(bm_new, basenew-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02840"></a>02840         
<a name="l02841"></a>02841     <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#a700bb69bd485fdc687c01e72cd80f24c" title="BMesh Free Mesh.">BM_mesh_free</a>(bm_new);
<a name="l02842"></a>02842     ((<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)basenew-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;edit_btmesh = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02843"></a>02843     
<a name="l02844"></a>02844     <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02845"></a>02845 }
<a name="l02846"></a>02846 
<a name="l02847"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab080c1c12c9fecb429af46332a766362">02847</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab080c1c12c9fecb429af46332a766362">mesh_separate_material</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d3/da9/structBase.html">Base</a> *editbase, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *wmop)
<a name="l02848"></a>02848 {
<a name="l02849"></a>02849     <a class="code" href="../../d0/d23/structBMFace.html">BMFace</a> *f_cmp, *f;
<a name="l02850"></a>02850     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l02851"></a>02851     <span class="keywordtype">int</span> result = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02852"></a>02852     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = editbase-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l02853"></a>02853     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l02854"></a>02854     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l02855"></a>02855 
<a name="l02856"></a>02856     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l02857"></a>02857 
<a name="l02858"></a>02858     <span class="keywordflow">while</span> ((f_cmp = <a class="code" href="../../d1/db3/bmesh__iterators_8c.html#a8a0b0b976bc8f5305864afcf9a599bb5">BM_iter_at_index</a>(bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fabe0fe60283f43cd8ce697d52d24a3c1e">BM_FACES_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0))) {
<a name="l02859"></a>02859         <span class="keyword">const</span> <span class="keywordtype">short</span> mat_nr = f_cmp-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a11d30c8a528fb993a7c111a8e957de5a">mat_nr</a>;
<a name="l02860"></a>02860         <span class="keywordtype">int</span> tot = 0;
<a name="l02861"></a>02861 
<a name="l02862"></a>02862         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (f, &amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fabe0fe60283f43cd8ce697d52d24a3c1e">BM_FACES_OF_MESH</a>) {
<a name="l02863"></a>02863             <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a11d30c8a528fb993a7c111a8e957de5a">mat_nr</a> == mat_nr) {
<a name="l02864"></a>02864                 <a class="code" href="../../d5/def/bmesh__marking_8c.html#a1fa6831f1e900dac7a2d426f3a5c1f76" title="Select Face.">BM_face_select_set</a>(bm, f, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02865"></a>02865                 tot++;
<a name="l02866"></a>02866             }
<a name="l02867"></a>02867         }
<a name="l02868"></a>02868 
<a name="l02869"></a>02869         <span class="comment">/* leave the current object with some materials */</span>
<a name="l02870"></a>02870         <span class="keywordflow">if</span> (tot == bm-&gt;<a class="code" href="../../d7/d18/structBMesh.html#ae4e0288302780574590bab5f8ff43fa4">totface</a>) {
<a name="l02871"></a>02871             <span class="keywordflow">break</span>;
<a name="l02872"></a>02872         }
<a name="l02873"></a>02873 
<a name="l02874"></a>02874         <span class="comment">/* Move selection into a separate object */</span>
<a name="l02875"></a>02875         result |= <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a47e93f44a0f99a2ab9f4c335a8f40c16">mesh_separate_selected</a>(bmain, scene, editbase, wmop);
<a name="l02876"></a>02876     }
<a name="l02877"></a>02877 
<a name="l02878"></a>02878     <span class="keywordflow">return</span> result;
<a name="l02879"></a>02879 }
<a name="l02880"></a>02880 
<a name="l02881"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6e279d91ce66ca437290942c2c7393c9">02881</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6e279d91ce66ca437290942c2c7393c9">mesh_separate_loose</a>(<a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d3/da9/structBase.html">Base</a> *editbase, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *wmop)
<a name="l02882"></a>02882 {
<a name="l02883"></a>02883     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l02884"></a>02884     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *v;
<a name="l02885"></a>02885     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *e;
<a name="l02886"></a>02886     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *v_seed;
<a name="l02887"></a>02887     <a class="code" href="../../d6/d0e/structBMWalker.html">BMWalker</a> walker;
<a name="l02888"></a>02888     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l02889"></a>02889     <span class="keywordtype">int</span> result = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02890"></a>02890     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = editbase-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l02891"></a>02891     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l02892"></a>02892     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l02893"></a>02893     <span class="keywordtype">int</span> max_iter = bm-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a003a55069d35eec157e4dfb5a0d78165">totvert</a>;
<a name="l02894"></a>02894 
<a name="l02895"></a>02895     <span class="comment">/* Clear all selected vertices */</span>
<a name="l02896"></a>02896     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l02897"></a>02897 
<a name="l02898"></a>02898     <span class="comment">/* A &quot;while (true)&quot; loop should work here as each iteration should</span>
<a name="l02899"></a>02899 <span class="comment">     * select and remove at least one vertex and when all vertices</span>
<a name="l02900"></a>02900 <span class="comment">     * are selected the loop will break out. But guard against bad</span>
<a name="l02901"></a>02901 <span class="comment">     * behavior by limiting iterations to the number of vertices in the</span>
<a name="l02902"></a>02902 <span class="comment">     * original mesh.*/</span>
<a name="l02903"></a>02903     <span class="keywordflow">for</span> (i = 0; i &lt; max_iter; i++) {
<a name="l02904"></a>02904         <span class="comment">/* Get a seed vertex to start the walk */</span>
<a name="l02905"></a>02905         v_seed = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02906"></a>02906         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (v, &amp;iter, bm, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l02907"></a>02907             v_seed = v;
<a name="l02908"></a>02908             <span class="keywordflow">break</span>;
<a name="l02909"></a>02909         }
<a name="l02910"></a>02910 
<a name="l02911"></a>02911         <span class="comment">/* No vertices available, can&#39;t do anything */</span>
<a name="l02912"></a>02912         <span class="keywordflow">if</span> (v_seed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l02913"></a>02913             <span class="keywordflow">break</span>;
<a name="l02914"></a>02914         }
<a name="l02915"></a>02915 
<a name="l02916"></a>02916         <span class="comment">/* Select the seed explicitly, in case it has no edges */</span>
<a name="l02917"></a>02917         <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(bm, v_seed, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02918"></a>02918 
<a name="l02919"></a>02919         <span class="comment">/* Walk from the single vertex, selecting everything connected</span>
<a name="l02920"></a>02920 <span class="comment">         * to it */</span>
<a name="l02921"></a>02921         <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a255f04e329b6a69cd64a6fe4ef4fc8f4" title="Init Walker.">BMW_init</a>(&amp;walker, bm, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#aedcf2109f459315e1a7f2af73ec9b603a18546ce5ce18616191ace8e76d38a1e9">BMW_SHELL</a>,
<a name="l02922"></a>02922                  <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>, <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a99601418885cb13c2365067504fd6ffb">BMW_MASK_NOP</a>,
<a name="l02923"></a>02923                  <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a94afa7b7a898f52e57cb96eb86a6506fa53cf162d3e791ca5126a5b9073bcf442">BMW_FLAG_NOP</a>, <span class="comment">/* BMESH_TODO - should be BMW_FLAG_TEST_HIDDEN ? */</span>
<a name="l02924"></a>02924                  <a class="code" href="../../db/d2c/bmesh__walkers_8h.html#a377591c19d65f85395a3409f304f7b71">BMW_NIL_LAY</a>);
<a name="l02925"></a>02925 
<a name="l02926"></a>02926         e = <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a725d1d5ae468a41811602645a85357f6">BMW_begin</a>(&amp;walker, v_seed);
<a name="l02927"></a>02927         <span class="keywordflow">for</span> (; e; e = <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#ac10013e80d092bcbe5c601754fb420ac" title="Step Walker.">BMW_step</a>(&amp;walker)) {
<a name="l02928"></a>02928             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(bm, e-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02929"></a>02929             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(bm, e-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02930"></a>02930         }
<a name="l02931"></a>02931         <a class="code" href="../../d8/d0e/bmesh__walkers_8c.html#a4aa4dae1cd457b22816e9d767592ce11" title="End Walker.">BMW_end</a>(&amp;walker);
<a name="l02932"></a>02932                 
<a name="l02933"></a>02933         <span class="comment">/* Flush the selection to get edge/face selections matching</span>
<a name="l02934"></a>02934 <span class="comment">         * the vertex selection */</span>
<a name="l02935"></a>02935         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a6a13c21e96dcafdff46182c80a8591c2">EDBM_selectmode_flush_ex</a>(em, <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8de5fe0f8dbf523c4699a7b54c429e2f">SCE_SELECT_VERTEX</a>);
<a name="l02936"></a>02936 
<a name="l02937"></a>02937         <span class="keywordflow">if</span> (bm-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a003a55069d35eec157e4dfb5a0d78165">totvert</a> == bm-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a63cca38a2559df39fd49e10a02f96f3b">totvertsel</a>) {
<a name="l02938"></a>02938             <span class="comment">/* Every vertex selected, nothing to separate, work is done */</span>
<a name="l02939"></a>02939             <span class="keywordflow">break</span>;
<a name="l02940"></a>02940         }
<a name="l02941"></a>02941 
<a name="l02942"></a>02942         <span class="comment">/* Move selection into a separate object */</span>
<a name="l02943"></a>02943         result |= <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a47e93f44a0f99a2ab9f4c335a8f40c16">mesh_separate_selected</a>(bmain, scene, editbase, wmop);
<a name="l02944"></a>02944     }
<a name="l02945"></a>02945 
<a name="l02946"></a>02946     <span class="keywordflow">return</span> result;
<a name="l02947"></a>02947 }
<a name="l02948"></a>02948 
<a name="l02949"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af5e66ca2e0fcd1a5de0bd6c8f60bbe6e">02949</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af5e66ca2e0fcd1a5de0bd6c8f60bbe6e">edbm_separate_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02950"></a>02950 {
<a name="l02951"></a>02951     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain = <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l02952"></a>02952     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02953"></a>02953     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base = <a class="code" href="../../df/d01/BKE__context_8h.html#a4f87fdb14b102e8da3f6ce0cfd5db7b4">CTX_data_active_base</a>(C);
<a name="l02954"></a>02954     <span class="keywordtype">int</span> retval = 0, type = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l02955"></a>02955     
<a name="l02956"></a>02956     <span class="keywordflow">if</span> (type == 0)
<a name="l02957"></a>02957         retval = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a47e93f44a0f99a2ab9f4c335a8f40c16">mesh_separate_selected</a>(bmain, scene, base, op);
<a name="l02958"></a>02958     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 1)
<a name="l02959"></a>02959         retval = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab080c1c12c9fecb429af46332a766362">mesh_separate_material</a>(bmain, scene, base, op);
<a name="l02960"></a>02960     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 2)
<a name="l02961"></a>02961         retval = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6e279d91ce66ca437290942c2c7393c9">mesh_separate_loose</a>(bmain, scene, base, op);
<a name="l02962"></a>02962 
<a name="l02963"></a>02963     <span class="keywordflow">if</span> (retval) {
<a name="l02964"></a>02964         <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>);
<a name="l02965"></a>02965         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02966"></a>02966 
<a name="l02967"></a>02967         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02968"></a>02968     }
<a name="l02969"></a>02969 
<a name="l02970"></a>02970     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02971"></a>02971 }
<a name="l02972"></a>02972 
<a name="l02973"></a>02973 <span class="comment">/* *************** Operator: separate parts *************/</span>
<a name="l02974"></a>02974 
<a name="l02975"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#aa760c679dbddacbcc87e822fa3ecf290">02975</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aa760c679dbddacbcc87e822fa3ecf290">prop_separate_types</a>[] = {
<a name="l02976"></a>02976     {0, <span class="stringliteral">&quot;SELECTED&quot;</span>, 0, <span class="stringliteral">&quot;Selection&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02977"></a>02977     {1, <span class="stringliteral">&quot;MATERIAL&quot;</span>, 0, <span class="stringliteral">&quot;By Material&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02978"></a>02978     {2, <span class="stringliteral">&quot;LOOSE&quot;</span>, 0, <span class="stringliteral">&quot;By loose parts&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02979"></a>02979     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l02980"></a>02980 };
<a name="l02981"></a>02981 
<a name="l02982"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a5230befa9688e0748ebb8ce984405bb1">02982</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a73e3fefe4f427816f7b5c7a8048cadac">MESH_OT_separate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02983"></a>02983 {
<a name="l02984"></a>02984     <span class="comment">/* identifiers */</span>
<a name="l02985"></a>02985     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Separate&quot;</span>;
<a name="l02986"></a>02986     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Separate selected geometry into a new mesh&quot;</span>;
<a name="l02987"></a>02987     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_separate&quot;</span>;
<a name="l02988"></a>02988     
<a name="l02989"></a>02989     <span class="comment">/* api callbacks */</span>
<a name="l02990"></a>02990     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l02991"></a>02991     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af5e66ca2e0fcd1a5de0bd6c8f60bbe6e">edbm_separate_exec</a>;
<a name="l02992"></a>02992     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l02993"></a>02993     
<a name="l02994"></a>02994     <span class="comment">/* flags */</span>
<a name="l02995"></a>02995     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02996"></a>02996     
<a name="l02997"></a>02997     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_separate_types, 0, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02998"></a>02998 }
<a name="l02999"></a>02999 
<a name="l03000"></a>03000 
<a name="l03001"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0b195649c7525f6fb504f321af8212d4">03001</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0b195649c7525f6fb504f321af8212d4">edbm_fill_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03002"></a>03002 {
<a name="l03003"></a>03003     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03004"></a>03004     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03005"></a>03005     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l03006"></a>03006     
<a name="l03007"></a>03007     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;triangle_fill edges=%he&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l03008"></a>03008         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03009"></a>03009     }
<a name="l03010"></a>03010     
<a name="l03011"></a>03011     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l03012"></a>03012     
<a name="l03013"></a>03013     <span class="comment">/* select new geometry */</span>
<a name="l03014"></a>03014     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;geomout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a> | <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03015"></a>03015     
<a name="l03016"></a>03016     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l03017"></a>03017         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03018"></a>03018     }
<a name="l03019"></a>03019 
<a name="l03020"></a>03020     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03021"></a>03021     
<a name="l03022"></a>03022     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03023"></a>03023 
<a name="l03024"></a>03024 }
<a name="l03025"></a>03025 
<a name="l03026"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a34f1efe55458c7ed47a2e7eb6b31cec5">03026</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a62ffab9450270477ad1f13b4a36cd08d">MESH_OT_fill</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03027"></a>03027 {
<a name="l03028"></a>03028     <span class="comment">/* identifiers */</span>
<a name="l03029"></a>03029     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Fill&quot;</span>;
<a name="l03030"></a>03030     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_fill&quot;</span>;
<a name="l03031"></a>03031     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Fill a selected edge loop with faces&quot;</span>;
<a name="l03032"></a>03032 
<a name="l03033"></a>03033     <span class="comment">/* api callbacks */</span>
<a name="l03034"></a>03034     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0b195649c7525f6fb504f321af8212d4">edbm_fill_exec</a>;
<a name="l03035"></a>03035     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03036"></a>03036 
<a name="l03037"></a>03037     <span class="comment">/* flags */</span>
<a name="l03038"></a>03038     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03039"></a>03039 }
<a name="l03040"></a>03040 
<a name="l03041"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a7028115b6fe14055e0c4acf82cffd0a2">03041</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a7028115b6fe14055e0c4acf82cffd0a2">edbm_beautify_fill_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03042"></a>03042 {
<a name="l03043"></a>03043     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03044"></a>03044     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03045"></a>03045 
<a name="l03046"></a>03046     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;beautify_fill faces=%hf&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l03047"></a>03047         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03048"></a>03048 
<a name="l03049"></a>03049     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03050"></a>03050     
<a name="l03051"></a>03051     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03052"></a>03052 }
<a name="l03053"></a>03053 
<a name="l03054"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a9f3e6f69dab2da9478f37642a69bb9be">03054</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a470f297cf95e6780a2558f6f8a4b8741">MESH_OT_beautify_fill</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03055"></a>03055 {
<a name="l03056"></a>03056     <span class="comment">/* identifiers */</span>
<a name="l03057"></a>03057     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Beautify Fill&quot;</span>;
<a name="l03058"></a>03058     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_beautify_fill&quot;</span>;
<a name="l03059"></a>03059 
<a name="l03060"></a>03060     <span class="comment">/* api callbacks */</span>
<a name="l03061"></a>03061     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a7028115b6fe14055e0c4acf82cffd0a2">edbm_beautify_fill_exec</a>;
<a name="l03062"></a>03062     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03063"></a>03063 
<a name="l03064"></a>03064     <span class="comment">/* flags */</span>
<a name="l03065"></a>03065     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03066"></a>03066 }
<a name="l03067"></a>03067 
<a name="l03068"></a>03068 <span class="comment">/********************** Quad/Tri Operators *************************/</span>
<a name="l03069"></a>03069 
<a name="l03070"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8443641683f73df4cf9c412001c98e53">03070</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8443641683f73df4cf9c412001c98e53">edbm_quads_convert_to_tris_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03071"></a>03071 {
<a name="l03072"></a>03072     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03073"></a>03073     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03074"></a>03074     <span class="keywordtype">int</span> use_beauty = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_beauty&quot;</span>);
<a name="l03075"></a>03075 
<a name="l03076"></a>03076     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;triangulate faces=%hf use_beauty=%b&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, use_beauty))
<a name="l03077"></a>03077         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03078"></a>03078 
<a name="l03079"></a>03079     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03080"></a>03080 
<a name="l03081"></a>03081     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03082"></a>03082 }
<a name="l03083"></a>03083 
<a name="l03084"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a1526d88b9c952f8f5d7fd3a8911b8d09">03084</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a502a7a461953ff78760c6e7ecae1bdc0">MESH_OT_quads_convert_to_tris</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03085"></a>03085 {
<a name="l03086"></a>03086     <span class="comment">/* identifiers */</span>
<a name="l03087"></a>03087     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Triangulate Faces&quot;</span>;
<a name="l03088"></a>03088     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_quads_convert_to_tris&quot;</span>;
<a name="l03089"></a>03089     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Triangulate selected faces&quot;</span>;
<a name="l03090"></a>03090 
<a name="l03091"></a>03091     <span class="comment">/* api callbacks */</span>
<a name="l03092"></a>03092     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8443641683f73df4cf9c412001c98e53">edbm_quads_convert_to_tris_exec</a>;
<a name="l03093"></a>03093     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03094"></a>03094 
<a name="l03095"></a>03095     <span class="comment">/* flags */</span>
<a name="l03096"></a>03096     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03097"></a>03097 
<a name="l03098"></a>03098     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_beauty&quot;</span>, 1, <span class="stringliteral">&quot;Beauty&quot;</span>, <span class="stringliteral">&quot;Use best triangulation division (currently quads only)&quot;</span>);
<a name="l03099"></a>03099 }
<a name="l03100"></a>03100 
<a name="l03101"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a07bca3760b6f4e67bc39e7a10724c3e0">03101</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a07bca3760b6f4e67bc39e7a10724c3e0">edbm_tris_convert_to_quads_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03102"></a>03102 {
<a name="l03103"></a>03103     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03104"></a>03104     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03105"></a>03105     <span class="keywordtype">int</span> dosharp, douvs, dovcols, domaterials;
<a name="l03106"></a>03106     <span class="keywordtype">float</span> limit = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;limit&quot;</span>);
<a name="l03107"></a>03107 
<a name="l03108"></a>03108     dosharp = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;sharp&quot;</span>);
<a name="l03109"></a>03109     douvs = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;uvs&quot;</span>);
<a name="l03110"></a>03110     dovcols = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;vcols&quot;</span>);
<a name="l03111"></a>03111     domaterials = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;materials&quot;</span>);
<a name="l03112"></a>03112 
<a name="l03113"></a>03113     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op,
<a name="l03114"></a>03114                        <span class="stringliteral">&quot;join_triangles faces=%hf limit=%f cmp_sharp=%b cmp_uvs=%b cmp_vcols=%b cmp_materials=%b&quot;</span>,
<a name="l03115"></a>03115                        <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, limit, dosharp, douvs, dovcols, domaterials))
<a name="l03116"></a>03116     {
<a name="l03117"></a>03117         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03118"></a>03118     }
<a name="l03119"></a>03119 
<a name="l03120"></a>03120     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03121"></a>03121 
<a name="l03122"></a>03122     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03123"></a>03123 }
<a name="l03124"></a>03124 
<a name="l03125"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a91c2192a8bfe0acd4f667177379c8ded">03125</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aa1a84dc652789f3731b932fe5c035545">MESH_OT_tris_convert_to_quads</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03126"></a>03126 {
<a name="l03127"></a>03127     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l03128"></a>03128 
<a name="l03129"></a>03129     <span class="comment">/* identifiers */</span>
<a name="l03130"></a>03130     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Tris to Quads&quot;</span>;
<a name="l03131"></a>03131     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_tris_convert_to_quads&quot;</span>;
<a name="l03132"></a>03132     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Join triangles into quads&quot;</span>;
<a name="l03133"></a>03133 
<a name="l03134"></a>03134     <span class="comment">/* api callbacks */</span>
<a name="l03135"></a>03135     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a07bca3760b6f4e67bc39e7a10724c3e0">edbm_tris_convert_to_quads_exec</a>;
<a name="l03136"></a>03136     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03137"></a>03137 
<a name="l03138"></a>03138     <span class="comment">/* flags */</span>
<a name="l03139"></a>03139     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03140"></a>03140 
<a name="l03141"></a>03141     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#aebb7b60fca704c324e3e479954a42ebb">RNA_def_float_rotation</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;limit&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(180.0f),
<a name="l03142"></a>03142                                   <span class="stringliteral">&quot;Max Angle&quot;</span>, <span class="stringliteral">&quot;Angle Limit&quot;</span>, 0.0f, <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(180.0f));
<a name="l03143"></a>03143     <a class="code" href="../../dc/d7e/rna__define_8c.html#a23a9b7283d1bdd1df1ba1fe1d204a6e5">RNA_def_property_float_default</a>(prop, <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(40.0f));
<a name="l03144"></a>03144 
<a name="l03145"></a>03145     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;uvs&quot;</span>, 0, <span class="stringliteral">&quot;Compare UVs&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l03146"></a>03146     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;vcols&quot;</span>, 0, <span class="stringliteral">&quot;Compare VCols&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l03147"></a>03147     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;sharp&quot;</span>, 0, <span class="stringliteral">&quot;Compare Sharp&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l03148"></a>03148     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;materials&quot;</span>, 0, <span class="stringliteral">&quot;Compare Materials&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l03149"></a>03149 }
<a name="l03150"></a>03150 
<a name="l03151"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a196c1ea31e79d13311c17601c29aa922">03151</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a196c1ea31e79d13311c17601c29aa922">edbm_dissolve_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03152"></a>03152 {
<a name="l03153"></a>03153     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03154"></a>03154     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03155"></a>03155 
<a name="l03156"></a>03156     <span class="keywordtype">int</span> use_verts = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_verts&quot;</span>);
<a name="l03157"></a>03157 
<a name="l03158"></a>03158     <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a616adf2bfd4117c15663a28e464a5100">SCE_SELECT_FACE</a>) {
<a name="l03159"></a>03159         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;dissolve_faces faces=%hf use_verts=%b&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, use_verts))
<a name="l03160"></a>03160             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03161"></a>03161     }
<a name="l03162"></a>03162     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad6cb358a5c5612c639f998b0601e0865">SCE_SELECT_EDGE</a>) {
<a name="l03163"></a>03163         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;dissolve_edges edges=%he use_verts=%b&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, use_verts))
<a name="l03164"></a>03164             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03165"></a>03165     }
<a name="l03166"></a>03166     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a4ead55e843584fbde374a460c7d0cba8">selectmode</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8de5fe0f8dbf523c4699a7b54c429e2f">SCE_SELECT_VERTEX</a>) {
<a name="l03167"></a>03167         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;dissolve_verts verts=%hv&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l03168"></a>03168             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03169"></a>03169     }
<a name="l03170"></a>03170 
<a name="l03171"></a>03171     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03172"></a>03172 
<a name="l03173"></a>03173     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03174"></a>03174 }
<a name="l03175"></a>03175 
<a name="l03176"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#ab4b9594d4e3c47eeaaa62fb498354590">03176</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a5c65afd97a46cc86814cb4e29ba4e299">MESH_OT_dissolve</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03177"></a>03177 {
<a name="l03178"></a>03178     <span class="comment">/* identifiers */</span>
<a name="l03179"></a>03179     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Dissolve&quot;</span>;
<a name="l03180"></a>03180     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Dissolve geometry&quot;</span>;
<a name="l03181"></a>03181     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_dissolve&quot;</span>;
<a name="l03182"></a>03182 
<a name="l03183"></a>03183     <span class="comment">/* api callbacks */</span>
<a name="l03184"></a>03184     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a196c1ea31e79d13311c17601c29aa922">edbm_dissolve_exec</a>;
<a name="l03185"></a>03185     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03186"></a>03186 
<a name="l03187"></a>03187     <span class="comment">/* flags */</span>
<a name="l03188"></a>03188     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03189"></a>03189 
<a name="l03190"></a>03190     <span class="comment">/* TODO, move dissolve into its own operator so this doesnt confuse non-dissolve options */</span>
<a name="l03191"></a>03191     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_verts&quot;</span>, 0, <span class="stringliteral">&quot;Dissolve Verts&quot;</span>,
<a name="l03192"></a>03192                     <span class="stringliteral">&quot;When dissolving faces/edges, also dissolve remaining vertices&quot;</span>);
<a name="l03193"></a>03193 }
<a name="l03194"></a>03194 
<a name="l03195"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac8c4d8703578533d053f87779250938c">03195</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac8c4d8703578533d053f87779250938c">edbm_dissolve_limited_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03196"></a>03196 {
<a name="l03197"></a>03197     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03198"></a>03198     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03199"></a>03199     <span class="keywordtype">float</span> angle_limit = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;angle_limit&quot;</span>);
<a name="l03200"></a>03200 
<a name="l03201"></a>03201     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op,
<a name="l03202"></a>03202                        <span class="stringliteral">&quot;dissolve_limit edges=%he verts=%hv angle_limit=%f&quot;</span>,
<a name="l03203"></a>03203                        <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, angle_limit))
<a name="l03204"></a>03204     {
<a name="l03205"></a>03205         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03206"></a>03206     }
<a name="l03207"></a>03207 
<a name="l03208"></a>03208     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03209"></a>03209 
<a name="l03210"></a>03210     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03211"></a>03211 }
<a name="l03212"></a>03212 
<a name="l03213"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a69bf7f96b69cbcf75e19b60e06cb97a2">03213</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a75a6cdf0be3e9e82322ab5c5e4d59b94">MESH_OT_dissolve_limited</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03214"></a>03214 {
<a name="l03215"></a>03215     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l03216"></a>03216 
<a name="l03217"></a>03217     <span class="comment">/* identifiers */</span>
<a name="l03218"></a>03218     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Limited Dissolve&quot;</span>;
<a name="l03219"></a>03219     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_dissolve_limited&quot;</span>;
<a name="l03220"></a>03220     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Dissolve selected edges and verts, limited by the angle of surrounding geometry&quot;</span>;
<a name="l03221"></a>03221 
<a name="l03222"></a>03222     <span class="comment">/* api callbacks */</span>
<a name="l03223"></a>03223     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac8c4d8703578533d053f87779250938c">edbm_dissolve_limited_exec</a>;
<a name="l03224"></a>03224     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03225"></a>03225 
<a name="l03226"></a>03226     <span class="comment">/* flags */</span>
<a name="l03227"></a>03227     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03228"></a>03228 
<a name="l03229"></a>03229     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#aebb7b60fca704c324e3e479954a42ebb">RNA_def_float_rotation</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;angle_limit&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0f, <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(180.0f),
<a name="l03230"></a>03230                                   <span class="stringliteral">&quot;Max Angle&quot;</span>, <span class="stringliteral">&quot;Angle Limit in Degrees&quot;</span>, 0.0f, <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(180.0f));
<a name="l03231"></a>03231     <a class="code" href="../../dc/d7e/rna__define_8c.html#a23a9b7283d1bdd1df1ba1fe1d204a6e5">RNA_def_property_float_default</a>(prop, <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#a5f7516f6821a4fe7671e385b9b01f6cb">DEG2RADF</a>(15.0f));
<a name="l03232"></a>03232 }
<a name="l03233"></a>03233 
<a name="l03234"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#afa07b12dc1b6c8eb55ac797a07caca13">03234</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afa07b12dc1b6c8eb55ac797a07caca13">edbm_split_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03235"></a>03235 {
<a name="l03236"></a>03236     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03237"></a>03237     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(ob);
<a name="l03238"></a>03238     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l03239"></a>03239 
<a name="l03240"></a>03240     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op, <span class="stringliteral">&quot;split geom=%hvef use_only_faces=%b&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03241"></a>03241     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l03242"></a>03242     <a class="code" href="../../d5/def/bmesh__marking_8c.html#a38d355744ee2bbd8c413709c693775f4">BM_mesh_elem_hflag_disable_all</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a> | <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a> | <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03243"></a>03243     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;geomout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a9bf8085857e7d4a80f0a7218f714652c">BM_ALL</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03244"></a>03244     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l03245"></a>03245         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03246"></a>03246     }
<a name="l03247"></a>03247 
<a name="l03248"></a>03248     <span class="comment">/* Geometry has changed, need to recalc normals and looptris */</span>
<a name="l03249"></a>03249     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afc818d571d27864536e18764e9c44a86">EDBM_mesh_normals_update</a>(em);
<a name="l03250"></a>03250 
<a name="l03251"></a>03251     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03252"></a>03252 
<a name="l03253"></a>03253     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03254"></a>03254 }
<a name="l03255"></a>03255 
<a name="l03256"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a458e051beb2aa5735f0e0c22ff527978">03256</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afdbab5e31f23e412b33d2934071de4ff">MESH_OT_split</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03257"></a>03257 {
<a name="l03258"></a>03258     <span class="comment">/* identifiers */</span>
<a name="l03259"></a>03259     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Split&quot;</span>;
<a name="l03260"></a>03260     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_split&quot;</span>;
<a name="l03261"></a>03261     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Split off selected geometry from connected unselected geometry&quot;</span>;
<a name="l03262"></a>03262 
<a name="l03263"></a>03263     <span class="comment">/* api callbacks */</span>
<a name="l03264"></a>03264     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#afa07b12dc1b6c8eb55ac797a07caca13">edbm_split_exec</a>;
<a name="l03265"></a>03265     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03266"></a>03266 
<a name="l03267"></a>03267     <span class="comment">/* flags */</span>
<a name="l03268"></a>03268     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03269"></a>03269 }
<a name="l03270"></a>03270 
<a name="l03271"></a>03271 
<a name="l03272"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2f082e0717da9f91772fb7a780d653b5">03272</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2f082e0717da9f91772fb7a780d653b5">edbm_spin_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03273"></a>03273 {
<a name="l03274"></a>03274     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03275"></a>03275     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03276"></a>03276     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l03277"></a>03277     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> spinop;
<a name="l03278"></a>03278     <span class="keywordtype">float</span> cent[3], axis[3], imat[3][3];
<a name="l03279"></a>03279     <span class="keywordtype">float</span> d[3] = {0.0f, 0.0f, 0.0f};
<a name="l03280"></a>03280     <span class="keywordtype">int</span> steps, dupli;
<a name="l03281"></a>03281     <span class="keywordtype">float</span> degr;
<a name="l03282"></a>03282 
<a name="l03283"></a>03283     <a class="code" href="../../d3/d10/rna__access_8c.html#a5d95f86ccce314676ae750034fb56709">RNA_float_get_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;center&quot;</span>, cent);
<a name="l03284"></a>03284     <a class="code" href="../../d3/d10/rna__access_8c.html#a5d95f86ccce314676ae750034fb56709">RNA_float_get_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;axis&quot;</span>, axis);
<a name="l03285"></a>03285     steps = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;steps&quot;</span>);
<a name="l03286"></a>03286     degr = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;degrees&quot;</span>);
<a name="l03287"></a>03287     <span class="comment">//if (ts-&gt;editbutflag &amp; B_CLOCKWISE)</span>
<a name="l03288"></a>03288     degr = -degr;
<a name="l03289"></a>03289     dupli = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;dupli&quot;</span>);
<a name="l03290"></a>03290 
<a name="l03291"></a>03291     <span class="comment">/* undo object transformation */</span>
<a name="l03292"></a>03292     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a36f8fd23b3f7785d0396ea7a93683d09">copy_m3_m4</a>(imat, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>);
<a name="l03293"></a>03293     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a3d305087815afcd193f1d6e561537c34">sub_v3_v3</a>(cent, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>[3]);
<a name="l03294"></a>03294     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a8ffa2d992371e11fad87ffbb55f034c8">mul_m3_v3</a>(imat, cent);
<a name="l03295"></a>03295     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a8ffa2d992371e11fad87ffbb55f034c8">mul_m3_v3</a>(imat, axis);
<a name="l03296"></a>03296 
<a name="l03297"></a>03297     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;spinop, op,
<a name="l03298"></a>03298                       <span class="stringliteral">&quot;spin geom=%hvef cent=%v axis=%v dvec=%v steps=%i ang=%f do_dupli=%b&quot;</span>,
<a name="l03299"></a>03299                       <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, cent, axis, d, steps, degr, dupli))
<a name="l03300"></a>03300     {
<a name="l03301"></a>03301         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03302"></a>03302     }
<a name="l03303"></a>03303     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(bm, &amp;spinop);
<a name="l03304"></a>03304     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l03305"></a>03305     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(bm, &amp;spinop, <span class="stringliteral">&quot;lastout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a9bf8085857e7d4a80f0a7218f714652c">BM_ALL</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03306"></a>03306     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;spinop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l03307"></a>03307         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03308"></a>03308     }
<a name="l03309"></a>03309 
<a name="l03310"></a>03310     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03311"></a>03311 
<a name="l03312"></a>03312     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03313"></a>03313 }
<a name="l03314"></a>03314 
<a name="l03315"></a>03315 <span class="comment">/* get center and axis, in global coords */</span>
<a name="l03316"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8d502c4ec20ce4b731146ad52e48a43f">03316</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8d502c4ec20ce4b731146ad52e48a43f">edbm_spin_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l03317"></a>03317 {
<a name="l03318"></a>03318     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03319"></a>03319     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = <a class="code" href="../../df/d01/BKE__context_8h.html#a88ab4a564441708766a6b4ace3b17908">CTX_wm_view3d</a>(C);
<a name="l03320"></a>03320     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad7a31725b14f8332b355403058e71019">ED_view3d_context_rv3d</a>(C);
<a name="l03321"></a>03321 
<a name="l03322"></a>03322     <a class="code" href="../../d3/d10/rna__access_8c.html#ad8067a3fc34e361ac2283352ff2f906c">RNA_float_set_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;center&quot;</span>, <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a56c6dfa9088d0f90552a67074a359c97">give_cursor</a>(scene, v3d));
<a name="l03323"></a>03323     <a class="code" href="../../d3/d10/rna__access_8c.html#ad8067a3fc34e361ac2283352ff2f906c">RNA_float_set_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;axis&quot;</span>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aef4739e48c5265fc0185283cd9f92303">viewinv</a>[2]);
<a name="l03324"></a>03324 
<a name="l03325"></a>03325     <span class="keywordflow">return</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2f082e0717da9f91772fb7a780d653b5">edbm_spin_exec</a>(C, op);
<a name="l03326"></a>03326 }
<a name="l03327"></a>03327 
<a name="l03328"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a2faf1605c8a05c4fc47bdf00f02765b1">03328</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#addbe5d61b6f92cd8497284d0f592bad1">MESH_OT_spin</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03329"></a>03329 {
<a name="l03330"></a>03330     <span class="comment">/* identifiers */</span>
<a name="l03331"></a>03331     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Spin&quot;</span>;
<a name="l03332"></a>03332     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Extrude selected vertices in a circle around the cursor in indicated viewport&quot;</span>;
<a name="l03333"></a>03333     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_spin&quot;</span>;
<a name="l03334"></a>03334 
<a name="l03335"></a>03335     <span class="comment">/* api callbacks */</span>
<a name="l03336"></a>03336     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8d502c4ec20ce4b731146ad52e48a43f">edbm_spin_invoke</a>;
<a name="l03337"></a>03337     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a2f082e0717da9f91772fb7a780d653b5">edbm_spin_exec</a>;
<a name="l03338"></a>03338     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a3a39013ec4b54ccfd2a9506bfca5b0b5">EM_view3d_poll</a>;
<a name="l03339"></a>03339 
<a name="l03340"></a>03340     <span class="comment">/* flags */</span>
<a name="l03341"></a>03341     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03342"></a>03342 
<a name="l03343"></a>03343     <span class="comment">/* props */</span>
<a name="l03344"></a>03344     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;steps&quot;</span>, 9, 0, INT_MAX, <span class="stringliteral">&quot;Steps&quot;</span>, <span class="stringliteral">&quot;Steps&quot;</span>, 0, INT_MAX);
<a name="l03345"></a>03345     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;dupli&quot;</span>, 0, <span class="stringliteral">&quot;Dupli&quot;</span>, <span class="stringliteral">&quot;Make Duplicates&quot;</span>);
<a name="l03346"></a>03346     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;degrees&quot;</span>, 90.0f, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Degrees&quot;</span>, <span class="stringliteral">&quot;Degrees&quot;</span>, -360.0f, 360.0f);
<a name="l03347"></a>03347 
<a name="l03348"></a>03348     <a class="code" href="../../dc/d7e/rna__define_8c.html#a60e910dcfdccf2a1ede6471837912011">RNA_def_float_vector</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;center&quot;</span>, 3, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Center&quot;</span>, <span class="stringliteral">&quot;Center in global view space&quot;</span>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>);
<a name="l03349"></a>03349     <a class="code" href="../../dc/d7e/rna__define_8c.html#a60e910dcfdccf2a1ede6471837912011">RNA_def_float_vector</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;axis&quot;</span>, 3, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1.0f, 1.0f, <span class="stringliteral">&quot;Axis&quot;</span>, <span class="stringliteral">&quot;Axis in global view space&quot;</span>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>);
<a name="l03350"></a>03350 
<a name="l03351"></a>03351 }
<a name="l03352"></a>03352 
<a name="l03353"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8eb67ef76c15714d12d061d5a6e9d258">03353</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8eb67ef76c15714d12d061d5a6e9d258">edbm_screw_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03354"></a>03354 {
<a name="l03355"></a>03355     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03356"></a>03356     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03357"></a>03357     <a class="code" href="../../d7/d18/structBMesh.html">BMesh</a> *bm = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>;
<a name="l03358"></a>03358     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l03359"></a>03359     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *eve, *v1, *v2;
<a name="l03360"></a>03360     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter, eiter;
<a name="l03361"></a>03361     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> spinop;
<a name="l03362"></a>03362     <span class="keywordtype">float</span> dvec[3], nor[3], cent[3], axis[3];
<a name="l03363"></a>03363     <span class="keywordtype">float</span> imat[3][3];
<a name="l03364"></a>03364     <span class="keywordtype">int</span> steps, turns;
<a name="l03365"></a>03365     <span class="keywordtype">int</span> valence;
<a name="l03366"></a>03366 
<a name="l03367"></a>03367 
<a name="l03368"></a>03368     turns = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;turns&quot;</span>);
<a name="l03369"></a>03369     steps = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;steps&quot;</span>);
<a name="l03370"></a>03370     <a class="code" href="../../d3/d10/rna__access_8c.html#a5d95f86ccce314676ae750034fb56709">RNA_float_get_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;center&quot;</span>, cent);
<a name="l03371"></a>03371     <a class="code" href="../../d3/d10/rna__access_8c.html#a5d95f86ccce314676ae750034fb56709">RNA_float_get_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;axis&quot;</span>, axis);
<a name="l03372"></a>03372 
<a name="l03373"></a>03373     <span class="comment">/* undo object transformation */</span>
<a name="l03374"></a>03374     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a36f8fd23b3f7785d0396ea7a93683d09">copy_m3_m4</a>(imat, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a65d360837f87824d49ed08caf44dccb3">imat</a>);
<a name="l03375"></a>03375     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a3d305087815afcd193f1d6e561537c34">sub_v3_v3</a>(cent, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#aa29519ce424b73cbb5a638814f1080ea">obmat</a>[3]);
<a name="l03376"></a>03376     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a8ffa2d992371e11fad87ffbb55f034c8">mul_m3_v3</a>(imat, cent);
<a name="l03377"></a>03377     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a8ffa2d992371e11fad87ffbb55f034c8">mul_m3_v3</a>(imat, axis);
<a name="l03378"></a>03378 
<a name="l03379"></a>03379 
<a name="l03380"></a>03380     <span class="comment">/* find two vertices with valence count == 1, more or less is wrong */</span>
<a name="l03381"></a>03381     v1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l03382"></a>03382     v2 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l03383"></a>03383     <span class="keywordflow">for</span> (eve = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); eve; eve = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;iter)) {
<a name="l03384"></a>03384 
<a name="l03385"></a>03385         valence = 0;
<a name="l03386"></a>03386 
<a name="l03387"></a>03387         <span class="keywordflow">for</span> (eed = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;eiter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fae7bcabb6ce8c89d63c863eae870b97eb">BM_EDGES_OF_VERT</a>, eve); eed; eed = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;eiter)) {
<a name="l03388"></a>03388 
<a name="l03389"></a>03389             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eed, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l03390"></a>03390                 valence++;
<a name="l03391"></a>03391             }
<a name="l03392"></a>03392 
<a name="l03393"></a>03393         }
<a name="l03394"></a>03394 
<a name="l03395"></a>03395         <span class="keywordflow">if</span> (valence == 1) {
<a name="l03396"></a>03396             <span class="keywordflow">if</span> (v1 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l03397"></a>03397                 v1 = eve;
<a name="l03398"></a>03398             }
<a name="l03399"></a>03399             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v2 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l03400"></a>03400                 v2 = eve;
<a name="l03401"></a>03401             }
<a name="l03402"></a>03402             <span class="keywordflow">else</span> {
<a name="l03403"></a>03403                 v1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l03404"></a>03404                 <span class="keywordflow">break</span>;
<a name="l03405"></a>03405             }
<a name="l03406"></a>03406         }
<a name="l03407"></a>03407     }
<a name="l03408"></a>03408 
<a name="l03409"></a>03409     <span class="keywordflow">if</span> (v1 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || v2 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l03410"></a>03410         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;You have to select a string of connected vertices too&quot;</span>);
<a name="l03411"></a>03411         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03412"></a>03412     }
<a name="l03413"></a>03413 
<a name="l03414"></a>03414     <span class="comment">/* calculate dvec */</span>
<a name="l03415"></a>03415     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a55cc5423278e715951545237ac71fb8b">sub_v3_v3v3</a>(dvec, v1-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, v2-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l03416"></a>03416     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a614c21caf4e6d770c7a49006a7f734b4">mul_v3_fl</a>(dvec, 1.0f / steps);
<a name="l03417"></a>03417 
<a name="l03418"></a>03418     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a76629ccfe891bccda30f790ed501e959">dot_v3v3</a>(nor, dvec) &gt; 0.000f)
<a name="l03419"></a>03419         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a9ac9a5dd319bfe481c973431de10a815">negate_v3</a>(dvec);
<a name="l03420"></a>03420 
<a name="l03421"></a>03421     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;spinop, op,
<a name="l03422"></a>03422                       <span class="stringliteral">&quot;spin geom=%hvef cent=%v axis=%v dvec=%v steps=%i ang=%f do_dupli=%b&quot;</span>,
<a name="l03423"></a>03423                       <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, cent, axis, dvec, turns * steps, 360.0f * turns, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>))
<a name="l03424"></a>03424     {
<a name="l03425"></a>03425         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03426"></a>03426     }
<a name="l03427"></a>03427     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(bm, &amp;spinop);
<a name="l03428"></a>03428     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l03429"></a>03429     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(bm, &amp;spinop, <span class="stringliteral">&quot;lastout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a9bf8085857e7d4a80f0a7218f714652c">BM_ALL</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03430"></a>03430     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;spinop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l03431"></a>03431         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03432"></a>03432     }
<a name="l03433"></a>03433 
<a name="l03434"></a>03434     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03435"></a>03435 
<a name="l03436"></a>03436     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03437"></a>03437 }
<a name="l03438"></a>03438 
<a name="l03439"></a>03439 <span class="comment">/* get center and axis, in global coords */</span>
<a name="l03440"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad8bbeddd6d87a3dcc0bb02da8ffb788b">03440</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad8bbeddd6d87a3dcc0bb02da8ffb788b">edbm_screw_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l03441"></a>03441 {
<a name="l03442"></a>03442     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03443"></a>03443     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = <a class="code" href="../../df/d01/BKE__context_8h.html#a88ab4a564441708766a6b4ace3b17908">CTX_wm_view3d</a>(C);
<a name="l03444"></a>03444     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad7a31725b14f8332b355403058e71019">ED_view3d_context_rv3d</a>(C);
<a name="l03445"></a>03445 
<a name="l03446"></a>03446     <a class="code" href="../../d3/d10/rna__access_8c.html#ad8067a3fc34e361ac2283352ff2f906c">RNA_float_set_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;center&quot;</span>, <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a56c6dfa9088d0f90552a67074a359c97">give_cursor</a>(scene, v3d));
<a name="l03447"></a>03447     <a class="code" href="../../d3/d10/rna__access_8c.html#ad8067a3fc34e361ac2283352ff2f906c">RNA_float_set_array</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;axis&quot;</span>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aef4739e48c5265fc0185283cd9f92303">viewinv</a>[1]);
<a name="l03448"></a>03448 
<a name="l03449"></a>03449     <span class="keywordflow">return</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8eb67ef76c15714d12d061d5a6e9d258">edbm_screw_exec</a>(C, op);
<a name="l03450"></a>03450 }
<a name="l03451"></a>03451 
<a name="l03452"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a7145e7af4c13daab51684f7fc005b869">03452</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9ea2d4f512b0650b6713956bc51a6e49">MESH_OT_screw</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03453"></a>03453 {
<a name="l03454"></a>03454     <span class="comment">/* identifiers */</span>
<a name="l03455"></a>03455     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Screw&quot;</span>;
<a name="l03456"></a>03456     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Extrude selected vertices in screw-shaped rotation around the cursor in indicated viewport&quot;</span>;
<a name="l03457"></a>03457     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_screw&quot;</span>;
<a name="l03458"></a>03458 
<a name="l03459"></a>03459     <span class="comment">/* api callbacks */</span>
<a name="l03460"></a>03460     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad8bbeddd6d87a3dcc0bb02da8ffb788b">edbm_screw_invoke</a>;
<a name="l03461"></a>03461     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8eb67ef76c15714d12d061d5a6e9d258">edbm_screw_exec</a>;
<a name="l03462"></a>03462     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a3a39013ec4b54ccfd2a9506bfca5b0b5">EM_view3d_poll</a>;
<a name="l03463"></a>03463 
<a name="l03464"></a>03464     <span class="comment">/* flags */</span>
<a name="l03465"></a>03465     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03466"></a>03466 
<a name="l03467"></a>03467     <span class="comment">/* props */</span>
<a name="l03468"></a>03468     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;steps&quot;</span>, 9, 0, INT_MAX, <span class="stringliteral">&quot;Steps&quot;</span>, <span class="stringliteral">&quot;Steps&quot;</span>, 0, 256);
<a name="l03469"></a>03469     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;turns&quot;</span>, 1, 0, INT_MAX, <span class="stringliteral">&quot;Turns&quot;</span>, <span class="stringliteral">&quot;Turns&quot;</span>, 0, 256);
<a name="l03470"></a>03470 
<a name="l03471"></a>03471     <a class="code" href="../../dc/d7e/rna__define_8c.html#a60e910dcfdccf2a1ede6471837912011">RNA_def_float_vector</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;center&quot;</span>, 3, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>,
<a name="l03472"></a>03472                          <span class="stringliteral">&quot;Center&quot;</span>, <span class="stringliteral">&quot;Center in global view space&quot;</span>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>);
<a name="l03473"></a>03473     <a class="code" href="../../dc/d7e/rna__define_8c.html#a60e910dcfdccf2a1ede6471837912011">RNA_def_float_vector</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;axis&quot;</span>, 3, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1.0f, 1.0f,
<a name="l03474"></a>03474                          <span class="stringliteral">&quot;Axis&quot;</span>, <span class="stringliteral">&quot;Axis in global view space&quot;</span>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>);
<a name="l03475"></a>03475 }
<a name="l03476"></a>03476 
<a name="l03477"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0edf02366b223941c9d1ffedac1299b7">03477</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0edf02366b223941c9d1ffedac1299b7">edbm_select_by_number_vertices_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03478"></a>03478 {
<a name="l03479"></a>03479     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03480"></a>03480     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03481"></a>03481     <a class="code" href="../../d0/d23/structBMFace.html">BMFace</a> *efa;
<a name="l03482"></a>03482     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l03483"></a>03483     <span class="keywordtype">int</span> numverts = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;number&quot;</span>);
<a name="l03484"></a>03484     <span class="keywordtype">int</span> type = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l03485"></a>03485 
<a name="l03486"></a>03486     <span class="keywordflow">for</span> (efa = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fabe0fe60283f43cd8ce697d52d24a3c1e">BM_FACES_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l03487"></a>03487          efa; efa = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;iter)) {
<a name="l03488"></a>03488 
<a name="l03489"></a>03489         <span class="keywordtype">int</span> select = 0;
<a name="l03490"></a>03490 
<a name="l03491"></a>03491         <span class="keywordflow">if</span> (type == 0 &amp;&amp; efa-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a221be6c99989ead8ee0e1bba1eb0272e">len</a> &lt; numverts) {
<a name="l03492"></a>03492             select = 1;
<a name="l03493"></a>03493         }
<a name="l03494"></a>03494         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 1 &amp;&amp; efa-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a221be6c99989ead8ee0e1bba1eb0272e">len</a> == numverts) {
<a name="l03495"></a>03495             select = 1;
<a name="l03496"></a>03496         }
<a name="l03497"></a>03497         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 2 &amp;&amp; efa-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a221be6c99989ead8ee0e1bba1eb0272e">len</a> &gt; numverts) {
<a name="l03498"></a>03498             select = 1;
<a name="l03499"></a>03499         }
<a name="l03500"></a>03500         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 3 &amp;&amp; efa-&gt;<a class="code" href="../../d0/d23/structBMFace.html#a221be6c99989ead8ee0e1bba1eb0272e">len</a> != numverts) {
<a name="l03501"></a>03501             select = 1;
<a name="l03502"></a>03502         }
<a name="l03503"></a>03503 
<a name="l03504"></a>03504         <span class="keywordflow">if</span> (select) {
<a name="l03505"></a>03505             <a class="code" href="../../d5/def/bmesh__marking_8c.html#a1fa6831f1e900dac7a2d426f3a5c1f76" title="Select Face.">BM_face_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, efa, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03506"></a>03506         }
<a name="l03507"></a>03507     }
<a name="l03508"></a>03508 
<a name="l03509"></a>03509     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(em);
<a name="l03510"></a>03510 
<a name="l03511"></a>03511     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l03512"></a>03512     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03513"></a>03513 }
<a name="l03514"></a>03514 
<a name="l03515"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aa0e8d6f56cc97313a45e7937ae9b7968">03515</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a481bcd97b5ed2bdc6f6a4490ab7e7c79">MESH_OT_select_by_number_vertices</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03516"></a>03516 {
<a name="l03517"></a>03517     <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> type_items[] = {
<a name="l03518"></a>03518         {0, <span class="stringliteral">&quot;LESS&quot;</span>, 0, <span class="stringliteral">&quot;Less Than&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03519"></a>03519         {1, <span class="stringliteral">&quot;EQUAL&quot;</span>, 0, <span class="stringliteral">&quot;Equal To&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03520"></a>03520         {2, <span class="stringliteral">&quot;GREATER&quot;</span>, 0, <span class="stringliteral">&quot;Greater Than&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03521"></a>03521         {3, <span class="stringliteral">&quot;NOTEQUAL&quot;</span>, 0, <span class="stringliteral">&quot;Not Equal To&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03522"></a>03522         {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l03523"></a>03523 
<a name="l03524"></a>03524     <span class="comment">/* identifiers */</span>
<a name="l03525"></a>03525     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select by Number of Vertices&quot;</span>;
<a name="l03526"></a>03526     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select vertices or faces by vertex count&quot;</span>;
<a name="l03527"></a>03527     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_select_by_number_vertices&quot;</span>;
<a name="l03528"></a>03528     
<a name="l03529"></a>03529     <span class="comment">/* api callbacks */</span>
<a name="l03530"></a>03530     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0edf02366b223941c9d1ffedac1299b7">edbm_select_by_number_vertices_exec</a>;
<a name="l03531"></a>03531     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03532"></a>03532     
<a name="l03533"></a>03533     <span class="comment">/* flags */</span>
<a name="l03534"></a>03534     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03535"></a>03535 
<a name="l03536"></a>03536     <span class="comment">/* properties */</span>
<a name="l03537"></a>03537     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;number&quot;</span>, 4, 3, INT_MAX, <span class="stringliteral">&quot;Number of Vertices&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 3, INT_MAX);
<a name="l03538"></a>03538     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, type_items, 1, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Type of comparison to make&quot;</span>);
<a name="l03539"></a>03539 }
<a name="l03540"></a>03540 
<a name="l03541"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad64507d573dd608836f3b9923140cb7b">03541</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad64507d573dd608836f3b9923140cb7b">edbm_select_loose_verts_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l03542"></a>03542 {
<a name="l03543"></a>03543     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03544"></a>03544     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03545"></a>03545     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *eve;
<a name="l03546"></a>03546     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l03547"></a>03547     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l03548"></a>03548 
<a name="l03549"></a>03549     <span class="keywordflow">for</span> (eve = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l03550"></a>03550          eve; eve = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;iter)) {
<a name="l03551"></a>03551 
<a name="l03552"></a>03552         <span class="keywordflow">if</span> (!eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a8af18783bda7bed16775802118c7e642">e</a>) {
<a name="l03553"></a>03553             <a class="code" href="../../d5/def/bmesh__marking_8c.html#aa30fa3c2c4755442886ab2373f3d80ac" title="Select Vert.">BM_vert_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, eve, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03554"></a>03554         }
<a name="l03555"></a>03555     }
<a name="l03556"></a>03556 
<a name="l03557"></a>03557     <span class="keywordflow">for</span> (eed = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#aba8c82365003c5fcbb34bbcb4e50f8f6" title="Iterator New.">BM_iter_new</a>(&amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l03558"></a>03558          eed; eed = <a class="code" href="../../d5/d48/bmesh__iterators__inline_8h.html#a0fc839bb30650592541b47e20669a995" title="Iterator Step.">BM_iter_step</a>(&amp;iter)) {
<a name="l03559"></a>03559 
<a name="l03560"></a>03560         <span class="keywordflow">if</span> (!eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab9029150e1f571daf0c3e21c0bf6f797">l</a>) {
<a name="l03561"></a>03561             <a class="code" href="../../d5/def/bmesh__marking_8c.html#a36117bf878409d6e7a6025d5fc7d2c50" title="Select Edge.">BM_edge_select_set</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, eed, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03562"></a>03562         }
<a name="l03563"></a>03563     }
<a name="l03564"></a>03564 
<a name="l03565"></a>03565     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(em);
<a name="l03566"></a>03566 
<a name="l03567"></a>03567     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l03568"></a>03568     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03569"></a>03569 }
<a name="l03570"></a>03570 
<a name="l03571"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a4ca61f8031d891239b8bcdf161f8b5b3">03571</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a19c62a77a20a0a9d40e23c55f6769e57">MESH_OT_select_loose_verts</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03572"></a>03572 {
<a name="l03573"></a>03573     <span class="comment">/* identifiers */</span>
<a name="l03574"></a>03574     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select Loose Vertices/Edges&quot;</span>;
<a name="l03575"></a>03575     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select vertices with no edges nor faces, and edges with no faces&quot;</span>;
<a name="l03576"></a>03576     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_select_loose_verts&quot;</span>;
<a name="l03577"></a>03577 
<a name="l03578"></a>03578     <span class="comment">/* api callbacks */</span>
<a name="l03579"></a>03579     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ad64507d573dd608836f3b9923140cb7b">edbm_select_loose_verts_exec</a>;
<a name="l03580"></a>03580     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03581"></a>03581 
<a name="l03582"></a>03582     <span class="comment">/* flags */</span>
<a name="l03583"></a>03583     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03584"></a>03584 }
<a name="l03585"></a>03585 
<a name="l03586"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6fbebbf5616dfe7d1e7ac82f48114807">03586</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6fbebbf5616dfe7d1e7ac82f48114807">edbm_select_mirror_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03587"></a>03587 {
<a name="l03588"></a>03588     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03589"></a>03589     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03590"></a>03590     <span class="keywordtype">int</span> extend = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;extend&quot;</span>);
<a name="l03591"></a>03591 
<a name="l03592"></a>03592     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ac729e67e5ea18a0537ae7e1f62480c01">EDBM_select_mirrored</a>(obedit, em, extend);
<a name="l03593"></a>03593     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afa2daa39e2c58399963b222c607783c1">EDBM_selectmode_flush</a>(em);
<a name="l03594"></a>03594     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a185e97978ae45ed1d3b3ff4d442c567c">NC_GEOM</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#aa1eaeb409fe6a81df91467aaeb289a07">ND_SELECT</a>, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l03595"></a>03595 
<a name="l03596"></a>03596     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03597"></a>03597 }
<a name="l03598"></a>03598 
<a name="l03599"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#af031afee069fb98e80af85c25538066d">03599</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aaca3543edb4ad62856a3fbc583a65d4a">MESH_OT_select_mirror</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03600"></a>03600 {
<a name="l03601"></a>03601     <span class="comment">/* identifiers */</span>
<a name="l03602"></a>03602     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Select Mirror&quot;</span>;
<a name="l03603"></a>03603     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Select mesh items at mirrored locations&quot;</span>;
<a name="l03604"></a>03604     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_select_mirror&quot;</span>;
<a name="l03605"></a>03605 
<a name="l03606"></a>03606     <span class="comment">/* api callbacks */</span>
<a name="l03607"></a>03607     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a6fbebbf5616dfe7d1e7ac82f48114807">edbm_select_mirror_exec</a>;
<a name="l03608"></a>03608     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03609"></a>03609 
<a name="l03610"></a>03610     <span class="comment">/* flags */</span>
<a name="l03611"></a>03611     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03612"></a>03612 
<a name="l03613"></a>03613     <span class="comment">/* props */</span>
<a name="l03614"></a>03614     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;extend&quot;</span>, 0, <span class="stringliteral">&quot;Extend&quot;</span>, <span class="stringliteral">&quot;Extend the existing selection&quot;</span>);
<a name="l03615"></a>03615 }
<a name="l03616"></a>03616 
<a name="l03617"></a>03617 <span class="comment">/* qsort routines.  not sure how to make these</span>
<a name="l03618"></a>03618 <span class="comment"> * work, since we aren&#39;t using linked lists for</span>
<a name="l03619"></a>03619 <span class="comment"> * geometry anymore.  might need a sort of &quot;swap&quot;</span>
<a name="l03620"></a>03620 <span class="comment"> * function for bmesh elements. */</span>
<a name="l03621"></a>03621 
<a name="l03622"></a>03622 <span class="comment">/* TODO All this section could probably use a refresh...</span>
<a name="l03623"></a>03623 <span class="comment"> *      face code works in object mode, does everything in one op, while vert uses several...</span>
<a name="l03624"></a>03624 <span class="comment"> */</span>
<a name="l03625"></a>03625 
<a name="l03626"></a><a class="code" href="../../d7/dc1/structxvertsort.html">03626</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/dc1/structxvertsort.html">xvertsort</a> {
<a name="l03627"></a><a class="code" href="../../d7/dc1/structxvertsort.html#a39b6761c028b3fe793c4ab613e042019">03627</a>     <span class="keywordtype">int</span> <a class="code" href="../../d7/dc1/structxvertsort.html#a39b6761c028b3fe793c4ab613e042019">x</a>; <span class="comment">/* X screen-coordinate */</span>
<a name="l03628"></a><a class="code" href="../../d7/dc1/structxvertsort.html#acf25a501cfbcbeec133e34be16f29ed3">03628</a>     <span class="keywordtype">int</span> <a class="code" href="../../d7/dc1/structxvertsort.html#acf25a501cfbcbeec133e34be16f29ed3">org_idx</a>; <span class="comment">/* Original index of this vertex _in the mempool_ */</span>
<a name="l03629"></a>03629 } <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af235c0f7847e7472f4b86583cfb3af94">xvertsort</a>;
<a name="l03630"></a>03630 
<a name="l03631"></a>03631 
<a name="l03632"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a81cbad9089495579fca18a5374c12f54">03632</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a81cbad9089495579fca18a5374c12f54">vergxco</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *v1, <span class="keyword">const</span> <span class="keywordtype">void</span> *v2)
<a name="l03633"></a>03633 {
<a name="l03634"></a>03634     <span class="keyword">const</span> <a class="code" href="../../d7/dc1/structxvertsort.html">xvertsort</a> *x1 = v1, *x2 = v2;
<a name="l03635"></a>03635 
<a name="l03636"></a>03636     <span class="comment">/* We move unchanged vertices (org_idx &lt; 0) at the begining of the sorted list. */</span>
<a name="l03637"></a>03637     <span class="keywordflow">if</span> (x1-&gt;<a class="code" href="../../d7/dc1/structxvertsort.html#acf25a501cfbcbeec133e34be16f29ed3">org_idx</a> &gt;= 0 &amp;&amp; x2-&gt;org_idx &gt;= 0)
<a name="l03638"></a>03638         <span class="keywordflow">return</span> (x1-&gt;<a class="code" href="../../d7/dc1/structxvertsort.html#a39b6761c028b3fe793c4ab613e042019">x</a> &gt; x2-&gt;x) - (x1-&gt;<a class="code" href="../../d7/dc1/structxvertsort.html#a39b6761c028b3fe793c4ab613e042019">x</a> &lt; x2-&gt;x);
<a name="l03639"></a>03639     <span class="keywordflow">return</span> (x2-&gt;org_idx &lt; 0) - (x1-&gt;<a class="code" href="../../d7/dc1/structxvertsort.html#acf25a501cfbcbeec133e34be16f29ed3">org_idx</a> &lt; 0);
<a name="l03640"></a>03640 }
<a name="l03641"></a>03641 
<a name="l03642"></a>03642 <span class="preprocessor">#if 0 </span><span class="comment">/* Unused */</span>
<a name="l03643"></a>03643 <span class="keyword">struct </span>facesort {
<a name="l03644"></a>03644     uintptr_t x;
<a name="l03645"></a>03645     <span class="keyword">struct </span><a class="code" href="../../df/de3/structEditFace.html">EditFace</a> *efa;
<a name="l03646"></a>03646 };
<a name="l03647"></a>03647 
<a name="l03648"></a>03648 <span class="keyword">static</span> <span class="keywordtype">int</span> vergface(<span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../df/de3/structEditFace.html#a526da9c225d6f109b01ae72c3e2e91cc">v1</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../df/de3/structEditFace.html#a19439c713d04457bf6fa775e7db7e76f">v2</a>)
<a name="l03649"></a>03649 {
<a name="l03650"></a>03650     <span class="keyword">const</span> <span class="keyword">struct </span>facesort *x1 = v1, *x2 = v2;
<a name="l03651"></a>03651 
<a name="l03652"></a>03652     <span class="keywordflow">if</span> (x1-&gt;x &gt; x2-&gt;x) <span class="keywordflow">return</span> 1;
<a name="l03653"></a>03653     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x1-&gt;x &lt; x2-&gt;x) <span class="keywordflow">return</span> -1;
<a name="l03654"></a>03654     <span class="keywordflow">return</span> 0;
<a name="l03655"></a>03655 }
<a name="l03656"></a>03656 <span class="preprocessor">#endif</span>
<a name="l03657"></a>03657 <span class="preprocessor"></span>
<a name="l03658"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#af98e56c726f8b8c210ba8f02b14f6d20">03658</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af98e56c726f8b8c210ba8f02b14f6d20">xsortvert_flag__doSetX</a>(<span class="keywordtype">void</span> *userData, <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(eve), <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(y), <span class="keywordtype">int</span> index)
<a name="l03659"></a>03659 {
<a name="l03660"></a>03660     <a class="code" href="../../d7/dc1/structxvertsort.html">xvertsort</a> *sortblock = userData;
<a name="l03661"></a>03661 
<a name="l03662"></a>03662     sortblock[index].<a class="code" href="../../d7/dc1/structxvertsort.html#a39b6761c028b3fe793c4ab613e042019">x</a> = x;
<a name="l03663"></a>03663 }
<a name="l03664"></a>03664 
<a name="l03665"></a>03665 <span class="comment">/* all verts with (flag &amp; &#39;flag&#39;) are sorted */</span>
<a name="l03666"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab8a0e66e9312c0e46f5acfd42ced9c87">03666</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab8a0e66e9312c0e46f5acfd42ced9c87">xsortvert_flag</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">int</span> flag)
<a name="l03667"></a>03667 {
<a name="l03668"></a>03668     <a class="code" href="../../d8/d30/structViewContext.html">ViewContext</a> vc;
<a name="l03669"></a>03669     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em;
<a name="l03670"></a>03670     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *ve;
<a name="l03671"></a>03671     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l03672"></a>03672     <a class="code" href="../../d7/dc1/structxvertsort.html">xvertsort</a> *sortblock;
<a name="l03673"></a>03673     <span class="keywordtype">int</span> *unchangedblock, *vmap;
<a name="l03674"></a>03674     <span class="keywordtype">int</span> totvert, sorted = 0, unchanged = 0, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03675"></a>03675 
<a name="l03676"></a>03676     <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a23a15b03b570d870fde800400a009714">em_setup_viewcontext</a>(C, &amp;vc);
<a name="l03677"></a>03677     em = vc.<a class="code" href="../../d8/d30/structViewContext.html#a779850db8a807574ddb22da4e3a5e38d">em</a>;
<a name="l03678"></a>03678 
<a name="l03679"></a>03679     totvert = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a003a55069d35eec157e4dfb5a0d78165">totvert</a>;
<a name="l03680"></a>03680 
<a name="l03681"></a>03681     sortblock = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/dc1/structxvertsort.html">xvertsort</a>) * totvert, <span class="stringliteral">&quot;xsort sorted&quot;</span>);
<a name="l03682"></a>03682     <span class="comment">/* Stores unchanged verts, will be reused as final old2new vert mapping... */</span>
<a name="l03683"></a>03683     unchangedblock = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * totvert, <span class="stringliteral">&quot;xsort unchanged&quot;</span>);
<a name="l03684"></a>03684     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a7cef0a79a202ac7893088acc8ac70dc0">BM_ITER_MESH_INDEX</a> (ve, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {
<a name="l03685"></a>03685         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(ve, flag)) {
<a name="l03686"></a>03686             sortblock[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d7/dc1/structxvertsort.html#acf25a501cfbcbeec133e34be16f29ed3">org_idx</a> = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03687"></a>03687             sorted++;
<a name="l03688"></a>03688         }
<a name="l03689"></a>03689         <span class="keywordflow">else</span> {
<a name="l03690"></a>03690             unchangedblock[unchanged++] = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03691"></a>03691             sortblock[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d7/dc1/structxvertsort.html#acf25a501cfbcbeec133e34be16f29ed3">org_idx</a> = -1;
<a name="l03692"></a>03692         }
<a name="l03693"></a>03693     }
<a name="l03694"></a>03694 <span class="comment">/*  printf(&quot;%d verts: %d to be sorted, %d unchanged…\n&quot;, totvert, sorted, unchanged);*/</span>
<a name="l03695"></a>03695     <span class="keywordflow">if</span> (sorted == 0)
<a name="l03696"></a>03696         <span class="keywordflow">return</span>;
<a name="l03697"></a>03697 
<a name="l03698"></a>03698     <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a24e3af8e001ec247ef564377a403c05a">ED_view3d_init_mats_rv3d</a>(vc.<a class="code" href="../../d8/d30/structViewContext.html#aa802aba424149fb5c03e34795a836810">obedit</a>, vc.<a class="code" href="../../d8/d30/structViewContext.html#ae849219034a130d5a58b5164ab8fc960">rv3d</a>);
<a name="l03699"></a>03699     <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a3b1f35aee37942c9e53c46c1d296a69a">mesh_foreachScreenVert</a>(&amp;vc, <a class="code" href="../../d0/d85/editmesh__tools_8c.html#af98e56c726f8b8c210ba8f02b14f6d20">xsortvert_flag__doSetX</a>, sortblock, <a class="code" href="../../d8/d6a/ED__view3d_8h.html#a578b283de8cc09dcb1fa8331d7519156abe21c7953047595210084549499ff3ce">V3D_CLIP_TEST_OFF</a>);
<a name="l03700"></a>03700 
<a name="l03701"></a>03701     qsort(sortblock, totvert, <span class="keyword">sizeof</span>(<a class="code" href="../../d7/dc1/structxvertsort.html">xvertsort</a>), <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a81cbad9089495579fca18a5374c12f54">vergxco</a>);
<a name="l03702"></a>03702 
<a name="l03703"></a>03703     <span class="comment">/* Convert sortblock into an array mapping old idx to new. */</span>
<a name="l03704"></a>03704     vmap = unchangedblock;
<a name="l03705"></a>03705     unchangedblock = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l03706"></a>03706     <span class="keywordflow">if</span> (unchanged) {
<a name="l03707"></a>03707         unchangedblock = <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * unchanged, <span class="stringliteral">&quot;xsort unchanged&quot;</span>);
<a name="l03708"></a>03708         memcpy(unchangedblock, vmap, unchanged * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03709"></a>03709     }
<a name="l03710"></a>03710     <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = totvert; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>--; ) {
<a name="l03711"></a>03711         <span class="keywordflow">if</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; unchanged)
<a name="l03712"></a>03712             vmap[unchangedblock[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03713"></a>03713         <span class="keywordflow">else</span>
<a name="l03714"></a>03714             vmap[sortblock[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d7/dc1/structxvertsort.html#acf25a501cfbcbeec133e34be16f29ed3">org_idx</a>] = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03715"></a>03715     }
<a name="l03716"></a>03716 
<a name="l03717"></a>03717     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(sortblock);
<a name="l03718"></a>03718     <span class="keywordflow">if</span> (unchangedblock)
<a name="l03719"></a>03719         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(unchangedblock);
<a name="l03720"></a>03720 
<a name="l03721"></a>03721     <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#aa057b09fa5e44f77bdf661be55d71c8b">BM_mesh_remap</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, vmap, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l03722"></a>03722 
<a name="l03723"></a>03723     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(vmap);
<a name="l03724"></a>03724 }
<a name="l03725"></a>03725 
<a name="l03726"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#addc4c3672738b89db19138b240478a35">03726</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#addc4c3672738b89db19138b240478a35">edbm_vertices_sort_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l03727"></a>03727 {
<a name="l03728"></a>03728     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ab8a0e66e9312c0e46f5acfd42ced9c87">xsortvert_flag</a>(C, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l03729"></a>03729     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03730"></a>03730 }
<a name="l03731"></a>03731 
<a name="l03732"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aa0d36a4a0c6359f66e4b4a112f3b5a7b">03732</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a66a9c3e7b30e015a87b213136c3e28c0">MESH_OT_vertices_sort</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03733"></a>03733 {
<a name="l03734"></a>03734     <span class="comment">/* identifiers */</span>
<a name="l03735"></a>03735     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Vertex Sort&quot;</span>;
<a name="l03736"></a>03736     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Sort vertex order&quot;</span>;
<a name="l03737"></a>03737     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_vertices_sort&quot;</span>;
<a name="l03738"></a>03738 
<a name="l03739"></a>03739     <span class="comment">/* api callbacks */</span>
<a name="l03740"></a>03740     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#addc4c3672738b89db19138b240478a35">edbm_vertices_sort_exec</a>;
<a name="l03741"></a>03741 
<a name="l03742"></a>03742     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d7/dc0/editmesh__select_8c.html#a3a39013ec4b54ccfd2a9506bfca5b0b5">EM_view3d_poll</a>; <span class="comment">/* uses view relative X axis to sort verts */</span>
<a name="l03743"></a>03743 
<a name="l03744"></a>03744     <span class="comment">/* flags */</span>
<a name="l03745"></a>03745     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03746"></a>03746 }
<a name="l03747"></a>03747 
<a name="l03748"></a>03748 <span class="comment">/* ********************** SORT FACES ******************* */</span>
<a name="l03749"></a>03749 
<a name="l03750"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac4c288d2ebb125c9af7d3539e03ee4de">03750</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac4c288d2ebb125c9af7d3539e03ee4de">permutate</a>(<span class="keywordtype">void</span> *list, <span class="keywordtype">int</span> num, <span class="keywordtype">int</span> <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>, <span class="keywordtype">int</span> *index)
<a name="l03751"></a>03751 {
<a name="l03752"></a>03752     <span class="keywordtype">void</span> *buf;
<a name="l03753"></a>03753     <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a>;
<a name="l03754"></a>03754     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03755"></a>03755 
<a name="l03756"></a>03756     len = num * <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>;
<a name="l03757"></a>03757 
<a name="l03758"></a>03758     buf = <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(len, <span class="stringliteral">&quot;permutate&quot;</span>);
<a name="l03759"></a>03759     memcpy(buf, list, len);
<a name="l03760"></a>03760     
<a name="l03761"></a>03761     <span class="keywordflow">for</span> (i = 0; i &lt; num; i++) {
<a name="l03762"></a>03762         memcpy((<span class="keywordtype">char</span> *)list + (i * size), (<span class="keywordtype">char</span> *)buf + (index[i] * size), size);
<a name="l03763"></a>03763     }
<a name="l03764"></a>03764     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(buf);
<a name="l03765"></a>03765 }
<a name="l03766"></a>03766 
<a name="l03767"></a>03767 <span class="comment">/* sort faces on view axis */</span>
<a name="l03768"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#aa9a8d4a7db4a21ad0ef6209a7f7c1e09">03768</a> <span class="keyword">static</span> <span class="keywordtype">float</span> *<a class="code" href="../../d0/d85/editmesh__tools_8c.html#aa9a8d4a7db4a21ad0ef6209a7f7c1e09">face_sort_floats</a>;
<a name="l03769"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3f52868ee143f1f69f6e409f48a696ea">03769</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3f52868ee143f1f69f6e409f48a696ea">float_sort</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *v1, <span class="keyword">const</span> <span class="keywordtype">void</span> *v2)
<a name="l03770"></a>03770 {
<a name="l03771"></a>03771     <span class="keywordtype">float</span> x1, x2;
<a name="l03772"></a>03772     
<a name="l03773"></a>03773     x1 = face_sort_floats[((<span class="keywordtype">int</span> *) v1)[0]];
<a name="l03774"></a>03774     x2 = face_sort_floats[((<span class="keywordtype">int</span> *) v2)[0]];
<a name="l03775"></a>03775     
<a name="l03776"></a>03776     <span class="keywordflow">if</span>      (x1 &gt; x2) <span class="keywordflow">return</span>  1;
<a name="l03777"></a>03777     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x1 &lt; x2) <span class="keywordflow">return</span> -1;
<a name="l03778"></a>03778     <span class="keywordflow">return</span> 0;
<a name="l03779"></a>03779 }
<a name="l03780"></a>03780 
<a name="l03781"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a09064f55a991a460ce83e23250b13a2c">03781</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a09064f55a991a460ce83e23250b13a2c">edbm_sort_faces_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03782"></a>03782 {
<a name="l03783"></a>03783     <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d = <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad7a31725b14f8332b355403058e71019">ED_view3d_context_rv3d</a>(C);
<a name="l03784"></a>03784     <a class="code" href="../../d6/deb/structView3D.html">View3D</a> *v3d = <a class="code" href="../../df/d01/BKE__context_8h.html#a88ab4a564441708766a6b4ace3b17908">CTX_wm_view3d</a>(C);
<a name="l03785"></a>03785     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03786"></a>03786     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03787"></a>03787     <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me;
<a name="l03788"></a>03788     <a class="code" href="../../d5/d97/structCustomDataLayer.html">CustomDataLayer</a> *layer;
<a name="l03789"></a>03789     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, *index;
<a name="l03790"></a>03790     <span class="keywordtype">int</span> event;
<a name="l03791"></a>03791     <span class="keywordtype">float</span> reverse = 1;
<a name="l03792"></a>03792     <span class="comment">// XXX int ctrl = 0;</span>
<a name="l03793"></a>03793     
<a name="l03794"></a>03794     <span class="keywordflow">if</span> (!v3d) <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03795"></a>03795 
<a name="l03796"></a>03796     <span class="comment">/* This operator work in Object Mode, not in edit mode.</span>
<a name="l03797"></a>03797 <span class="comment">     * After talk with Campbell we agree that there is no point to port this to EditMesh right now.</span>
<a name="l03798"></a>03798 <span class="comment">     * so for now, we just exit_editmode and enter_editmode at the end of this function.</span>
<a name="l03799"></a>03799 <span class="comment">     */</span>
<a name="l03800"></a>03800     <a class="code" href="../../da/d7a/ED__object_8h.html#a3dc41f10c2da040464140768d2898865">ED_object_exit_editmode</a>(C, <a class="code" href="../../da/d7a/ED__object_8h.html#a56f58f037f42277d234426571ee2de12">EM_FREEDATA</a>);
<a name="l03801"></a>03801 
<a name="l03802"></a>03802     me = ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l03803"></a>03803     <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a> == 0) {
<a name="l03804"></a>03804         <a class="code" href="../../da/d7a/ED__object_8h.html#abf5a8346ea6543e8d977bfe1358c5c35">ED_object_enter_editmode</a>(C, 0);
<a name="l03805"></a>03805         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03806"></a>03806     }
<a name="l03807"></a>03807 
<a name="l03808"></a>03808     <span class="keyword">event</span> = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l03809"></a>03809 
<a name="l03810"></a>03810     <span class="comment">// XXX</span>
<a name="l03811"></a>03811     <span class="comment">//if (ctrl)</span>
<a name="l03812"></a>03812     <span class="comment">//  reverse = -1;</span>
<a name="l03813"></a>03813     
<a name="l03814"></a>03814     <span class="comment">/* create index list */</span>
<a name="l03815"></a>03815     index = (<span class="keywordtype">int</span> *)<a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>, <span class="stringliteral">&quot;sort faces&quot;</span>);
<a name="l03816"></a>03816     <span class="keywordflow">for</span> (i = 0; i &lt; me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>; i++) {
<a name="l03817"></a>03817         index[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03818"></a>03818     }
<a name="l03819"></a>03819     
<a name="l03820"></a>03820     face_sort_floats = (<span class="keywordtype">float</span> *) <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>, <span class="stringliteral">&quot;sort faces float&quot;</span>);
<a name="l03821"></a>03821 
<a name="l03822"></a>03822     <span class="comment">/* sort index list instead of faces itself </span>
<a name="l03823"></a>03823 <span class="comment">     * and apply this permutation to all face layers</span>
<a name="l03824"></a>03824 <span class="comment">     */</span>
<a name="l03825"></a>03825     <span class="keywordflow">if</span> (event == 5) {
<a name="l03826"></a>03826         <span class="comment">/* Random */</span>
<a name="l03827"></a>03827         <span class="keywordflow">for</span> (i = 0; i &lt; me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>; i++) {
<a name="l03828"></a>03828             face_sort_floats[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d3/d88/BLI__rand_8h.html#a28a49a5f3f27a0875de8142fdcab7bd2">BLI_frand</a>();
<a name="l03829"></a>03829         }
<a name="l03830"></a>03830         qsort(index, me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3f52868ee143f1f69f6e409f48a696ea">float_sort</a>);
<a name="l03831"></a>03831     }
<a name="l03832"></a>03832     <span class="keywordflow">else</span> {
<a name="l03833"></a>03833         <a class="code" href="../../d2/dca/structMPoly.html">MPoly</a> *mp;
<a name="l03834"></a>03834         <a class="code" href="../../d7/d72/structMLoop.html">MLoop</a> *ml;
<a name="l03835"></a>03835         <a class="code" href="../../d8/de5/structMVert.html">MVert</a> *mv;
<a name="l03836"></a>03836         <span class="keywordtype">float</span> vec[3];
<a name="l03837"></a>03837         <span class="keywordtype">float</span> mat[4][4];
<a name="l03838"></a>03838         <span class="keywordtype">float</span> cur[3];
<a name="l03839"></a>03839         
<a name="l03840"></a>03840         <span class="keywordflow">if</span> (event == 1)
<a name="l03841"></a>03841             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#ae41a59d6db4a10a85f8fbf1e3842ba81">mult_m4_m4m4</a>(mat, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ad04178a1375cc4ef5c59a76b723f822f">viewmat</a>, <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a119935c54737bd111df8fd516c390000">OBACT</a>-&gt;obmat);  <span class="comment">/* apply the view matrix to the object matrix */</span>
<a name="l03842"></a>03842         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event == 2) { <span class="comment">/* sort from cursor */</span>
<a name="l03843"></a>03843             <span class="keywordflow">if</span> (v3d &amp;&amp; v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a7e87bb98f5f62744d30d1accb87cc664">localvd</a>) {
<a name="l03844"></a>03844                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(cur, v3d-&gt;<a class="code" href="../../d6/deb/structView3D.html#a35be8a263193298873c9aca13fedc7c9">cursor</a>);
<a name="l03845"></a>03845             }
<a name="l03846"></a>03846             <span class="keywordflow">else</span> {
<a name="l03847"></a>03847                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(cur, scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a237f7209bae91bebb60015a0fb2001fe">cursor</a>);
<a name="l03848"></a>03848             }
<a name="l03849"></a>03849             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#aab557e66ccdc3534593b413d9b2d7fe8">invert_m4_m4</a>(mat, <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a119935c54737bd111df8fd516c390000">OBACT</a>-&gt;obmat);
<a name="l03850"></a>03850             <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2fc1e6236f291e8cf3b62c8e0541eb00">mul_m4_v3</a>(mat, cur);
<a name="l03851"></a>03851         }
<a name="l03852"></a>03852         
<a name="l03853"></a>03853         mp = me-&gt;<a class="code" href="../../da/d29/structMesh.html#aed0e442be859c2a4f8067eda4f81c064">mpoly</a>;
<a name="l03854"></a>03854 
<a name="l03855"></a>03855         <span class="keywordflow">for</span> (i = 0; i &lt; me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>; i++, mp++) {
<a name="l03856"></a>03856             <span class="keywordflow">if</span> (event == 3) {
<a name="l03857"></a>03857                 face_sort_floats[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = ((float)mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#afaa3e20eadbc3dfe52d47c0a10dd0c7f">mat_nr</a>) * reverse;
<a name="l03858"></a>03858             }
<a name="l03859"></a>03859             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event == 4) {
<a name="l03860"></a>03860                 <span class="comment">/* selected first */</span>
<a name="l03861"></a>03861                 <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#a208492a1db60c4d108f51334e5e80d53">flag</a> &amp; <a class="code" href="../../d4/d36/DNA__meshdata__types_8h.html#a893637457f3055c76b2bddc12f1b5d52">ME_FACE_SEL</a>)
<a name="l03862"></a>03862                     face_sort_floats[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0.0;
<a name="l03863"></a>03863                 <span class="keywordflow">else</span>
<a name="l03864"></a>03864                     face_sort_floats[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = reverse;
<a name="l03865"></a>03865             }
<a name="l03866"></a>03866             <span class="keywordflow">else</span> {
<a name="l03867"></a>03867                 <span class="comment">/* find the face&#39;s center */</span>
<a name="l03868"></a>03868                 ml = me-&gt;<a class="code" href="../../da/d29/structMesh.html#a9ae8024c777dd16443d6fc13a8b30880">mloop</a> + mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#af553fa511f9a5475e5ff8cca8fa0b115">loopstart</a>;
<a name="l03869"></a>03869                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#acd4d89007c860a4c74d459ac72593065">zero_v3</a>(vec);
<a name="l03870"></a>03870                 <span class="keywordflow">for</span> (j = 0; j &lt; mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#a056a6dcc2dd557fc8b14db5aa6dfa8b0">totloop</a>; j++, ml++) {
<a name="l03871"></a>03871                     mv = me-&gt;<a class="code" href="../../da/d29/structMesh.html#a422181e95f8eeb611b58ca26b5f62bdf">mvert</a> + ml-&gt;<a class="code" href="../../d7/d72/structMLoop.html#ae5aa5a4861aba2bd5145f0b2c4ab4412">v</a>;
<a name="l03872"></a>03872                     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#ae0067c77927da3b22dec1de77ac8ba78">add_v3_v3</a>(vec, mv-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l03873"></a>03873                 }
<a name="l03874"></a>03874                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a614c21caf4e6d770c7a49006a7f734b4">mul_v3_fl</a>(vec, 1.0f / (<span class="keywordtype">float</span>)mp-&gt;<a class="code" href="../../d2/dca/structMPoly.html#a056a6dcc2dd557fc8b14db5aa6dfa8b0">totloop</a>);
<a name="l03875"></a>03875                 
<a name="l03876"></a>03876                 <span class="keywordflow">if</span> (event == 1) { <span class="comment">/* sort on view axis */</span>
<a name="l03877"></a>03877                     <a class="code" href="../../d3/d8c/BLI__math__matrix_8h.html#a2fc1e6236f291e8cf3b62c8e0541eb00">mul_m4_v3</a>(mat, vec);
<a name="l03878"></a>03878                     face_sort_floats[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = vec[2] * reverse;
<a name="l03879"></a>03879                 }
<a name="l03880"></a>03880                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event == 2) { <span class="comment">/* distance from cursor */</span>
<a name="l03881"></a>03881                     face_sort_floats[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a97ecadbef10e5cc3decc2c02c3b96824">len_v3v3</a>(cur, vec) * reverse; <span class="comment">/* back to front */</span>
<a name="l03882"></a>03882                 }
<a name="l03883"></a>03883             }
<a name="l03884"></a>03884         }
<a name="l03885"></a>03885         qsort(index, me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a3f52868ee143f1f69f6e409f48a696ea">float_sort</a>);
<a name="l03886"></a>03886     }
<a name="l03887"></a>03887     
<a name="l03888"></a>03888     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(face_sort_floats);
<a name="l03889"></a>03889     <span class="keywordflow">for</span> (i = 0; i &lt; me-&gt;pdata.totlayer; i++) {
<a name="l03890"></a>03890         layer = &amp;me-&gt;pdata.layers[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l03891"></a>03891         <a class="code" href="../../d0/d85/editmesh__tools_8c.html#ac4c288d2ebb125c9af7d3539e03ee4de">permutate</a>(layer-&gt;<a class="code" href="../../d5/d97/structCustomDataLayer.html#a96b03d545e94aacd77c467efb04b1153">data</a>, me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac26ffb56473851155dc77789a012c5d9">totpoly</a>, <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#ab0c12e026f263d0d8bfd11a85cc93d00">CustomData_sizeof</a>(layer-&gt;<a class="code" href="../../d5/d97/structCustomDataLayer.html#a1ba604969c785bba31ef501e7a06cc9c">type</a>), index);
<a name="l03892"></a>03892     }
<a name="l03893"></a>03893 
<a name="l03894"></a>03894     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(index);
<a name="l03895"></a>03895     <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a70d8c170e1f4bbcc010d94405d6a9817">DAG_id_tag_update</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>, 0);
<a name="l03896"></a>03896 
<a name="l03897"></a>03897     <span class="comment">/* Return to editmode. */</span>
<a name="l03898"></a>03898     <a class="code" href="../../da/d7a/ED__object_8h.html#abf5a8346ea6543e8d977bfe1358c5c35">ED_object_enter_editmode</a>(C, 0);
<a name="l03899"></a>03899 
<a name="l03900"></a>03900     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03901"></a>03901 }
<a name="l03902"></a>03902 
<a name="l03903"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#ae527989dc8934404eadbd7766e00ffef">03903</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a52667682a3e265a9d03a5e2e5f810b78">MESH_OT_sort_faces</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03904"></a>03904 {
<a name="l03905"></a>03905     <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> type_items[] = {
<a name="l03906"></a>03906         { 1, <span class="stringliteral">&quot;VIEW_AXIS&quot;</span>, 0, <span class="stringliteral">&quot;View Axis&quot;</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l03907"></a>03907         { 2, <span class="stringliteral">&quot;CURSOR_DISTANCE&quot;</span>, 0, <span class="stringliteral">&quot;Cursor Distance&quot;</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l03908"></a>03908         { 3, <span class="stringliteral">&quot;MATERIAL&quot;</span>, 0, <span class="stringliteral">&quot;Material&quot;</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l03909"></a>03909         { 4, <span class="stringliteral">&quot;SELECTED&quot;</span>, 0, <span class="stringliteral">&quot;Selected&quot;</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l03910"></a>03910         { 5, <span class="stringliteral">&quot;RANDOMIZE&quot;</span>, 0, <span class="stringliteral">&quot;Randomize&quot;</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l03911"></a>03911         { 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL }};
<a name="l03912"></a>03912 
<a name="l03913"></a>03913     <span class="comment">/* identifiers */</span>
<a name="l03914"></a>03914     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Sort Faces&quot;</span>; <span class="comment">// XXX (Ctrl to reverse)%t|</span>
<a name="l03915"></a>03915     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;The faces of the active Mesh Object are sorted, based on the current view&quot;</span>;
<a name="l03916"></a>03916     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_sort_faces&quot;</span>;
<a name="l03917"></a>03917 
<a name="l03918"></a>03918     <span class="comment">/* api callbacks */</span>
<a name="l03919"></a>03919     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l03920"></a>03920     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a09064f55a991a460ce83e23250b13a2c">edbm_sort_faces_exec</a>;
<a name="l03921"></a>03921     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l03922"></a>03922 
<a name="l03923"></a>03923     <span class="comment">/* flags */</span>
<a name="l03924"></a>03924     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03925"></a>03925 
<a name="l03926"></a>03926     <span class="comment">/* properties */</span>
<a name="l03927"></a>03927     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, type_items, 0, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l03928"></a>03928 }
<a name="l03929"></a>03929 
<a name="l03930"></a>03930 <span class="comment">/* ******************************* Randomize verts ************************* */</span>
<a name="l03931"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a67d393568932b1c42fb25dee3954cb27">03931</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a67d393568932b1c42fb25dee3954cb27">hashvert_flag</a>(<a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em, <span class="keywordtype">int</span> flag, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seed)
<a name="l03932"></a>03932 {
<a name="l03933"></a>03933     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *ve;
<a name="l03934"></a>03934     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l03935"></a>03935     <span class="keywordtype">char</span> *block <span class="comment">/* Just to mark protected vertices */</span>, *t_blk;
<a name="l03936"></a>03936     <span class="keywordtype">int</span> *randblock, *vmap, *t_idx, *r_idx;
<a name="l03937"></a>03937     <span class="keywordtype">int</span> totvert, randomized = 0, <span class="comment">/*protected = 0, */</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03938"></a>03938 
<a name="l03939"></a>03939     totvert = em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a003a55069d35eec157e4dfb5a0d78165">totvert</a>;
<a name="l03940"></a>03940 
<a name="l03941"></a>03941     block = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * totvert, <span class="stringliteral">&quot;randvert block&quot;</span>);
<a name="l03942"></a>03942     randblock = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * totvert, <span class="stringliteral">&quot;randvert randblock&quot;</span>);
<a name="l03943"></a>03943     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a7cef0a79a202ac7893088acc8ac70dc0">BM_ITER_MESH_INDEX</a> (ve, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {
<a name="l03944"></a>03944         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(ve, flag)) {
<a name="l03945"></a>03945             block[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l03946"></a>03946             randblock[randomized++] = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03947"></a>03947         }
<a name="l03948"></a>03948         <span class="keywordflow">else</span> {
<a name="l03949"></a>03949             block[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l03950"></a>03950         }
<a name="l03951"></a>03951     }
<a name="l03952"></a>03952 <span class="comment">/*  protected = totvert - randomized;*/</span>
<a name="l03953"></a>03953 <span class="comment">/*  printf(&quot;%d verts: %d to be randomized, %d protected…\n&quot;, totvert, randomized, protected);*/</span>
<a name="l03954"></a>03954     <span class="keywordflow">if</span> (randomized == 0)
<a name="l03955"></a>03955         <span class="keywordflow">return</span>;
<a name="l03956"></a>03956 
<a name="l03957"></a>03957     
<a name="l03958"></a>03958     <span class="comment">/* Randomize non-protected vertices indices, and create an array mapping old idx to new</span>
<a name="l03959"></a>03959 <span class="comment">     *  from both blocks, keeping protected vertices at the same indices. */</span>
<a name="l03960"></a>03960     vmap = randblock;
<a name="l03961"></a>03961     randblock = <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * randomized, <span class="stringliteral">&quot;randvert randblock&quot;</span>);
<a name="l03962"></a>03962     memcpy(randblock, vmap, randomized * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03963"></a>03963     <a class="code" href="../../d3/d88/BLI__rand_8h.html#ac2f28f8410100a0a1a6d72e04c6eb956">BLI_array_randomize</a>((<span class="keywordtype">void</span> *)randblock, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), randomized, seed);
<a name="l03964"></a>03964     t_blk = block + totvert - 1;
<a name="l03965"></a>03965     t_idx = vmap + totvert - 1;
<a name="l03966"></a>03966     r_idx = randblock + randomized - 1;
<a name="l03967"></a>03967     <span class="keywordflow">for</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = totvert; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>--; t_blk--, t_idx--) {
<a name="l03968"></a>03968         <span class="keywordflow">if</span> (*t_blk) <span class="comment">/* Protected! */</span>
<a name="l03969"></a>03969             *t_idx = <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l03970"></a>03970         <span class="keywordflow">else</span>
<a name="l03971"></a>03971             *t_idx = *r_idx--;
<a name="l03972"></a>03972     }
<a name="l03973"></a>03973 
<a name="l03974"></a>03974     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(randblock);
<a name="l03975"></a>03975     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(block);
<a name="l03976"></a>03976 
<a name="l03977"></a>03977     <a class="code" href="../../d5/db9/bmesh__mesh_8c.html#aa057b09fa5e44f77bdf661be55d71c8b">BM_mesh_remap</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, vmap, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l03978"></a>03978 
<a name="l03979"></a>03979     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(vmap);
<a name="l03980"></a>03980 }
<a name="l03981"></a>03981 
<a name="l03982"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0820c0a3e05b43fe9b229adb457fd690">03982</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0820c0a3e05b43fe9b229adb457fd690">edbm_vertices_randomize_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03983"></a>03983 {
<a name="l03984"></a>03984     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l03985"></a>03985     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l03986"></a>03986     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seed = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;seed&quot;</span>);
<a name="l03987"></a>03987 
<a name="l03988"></a>03988     <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a67d393568932b1c42fb25dee3954cb27">hashvert_flag</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, seed);
<a name="l03989"></a>03989 
<a name="l03990"></a>03990     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03991"></a>03991 }
<a name="l03992"></a>03992 
<a name="l03993"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a2b4822a17a53243f515c4dd94409334c">03993</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0619d776443e2e7d5092469b6c8c5236">MESH_OT_vertices_randomize</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03994"></a>03994 {
<a name="l03995"></a>03995     <span class="comment">/* identifiers */</span>
<a name="l03996"></a>03996     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Vertex Randomize&quot;</span>;
<a name="l03997"></a>03997     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Randomize vertex order&quot;</span>;
<a name="l03998"></a>03998     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_vertices_randomize&quot;</span>;
<a name="l03999"></a>03999 
<a name="l04000"></a>04000     <span class="comment">/* api callbacks */</span>
<a name="l04001"></a>04001     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a0820c0a3e05b43fe9b229adb457fd690">edbm_vertices_randomize_exec</a>;
<a name="l04002"></a>04002 
<a name="l04003"></a>04003     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l04004"></a>04004 
<a name="l04005"></a>04005     <span class="comment">/* flags */</span>
<a name="l04006"></a>04006     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l04007"></a>04007 
<a name="l04008"></a>04008     <span class="comment">/* Properties */</span>
<a name="l04009"></a>04009     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;seed&quot;</span>, 0, 0, INT_MAX, <span class="stringliteral">&quot;Seed&quot;</span>, <span class="stringliteral">&quot;Seed for the random generator&quot;</span>, 0, 255);
<a name="l04010"></a>04010 }
<a name="l04011"></a>04011 
<a name="l04012"></a>04012 <span class="comment">/******end of qsort stuff ****/</span>
<a name="l04013"></a>04013 
<a name="l04014"></a>04014 
<a name="l04015"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a800567c711d829f8845c998dc5eb94f9">04015</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a800567c711d829f8845c998dc5eb94f9">edbm_noise_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l04016"></a>04016 {
<a name="l04017"></a>04017     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l04018"></a>04018     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l04019"></a>04019     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma;
<a name="l04020"></a>04020     <a class="code" href="../../df/d2d/structTex.html">Tex</a> *tex;
<a name="l04021"></a>04021     <a class="code" href="../../df/d18/structBMVert.html">BMVert</a> *eve;
<a name="l04022"></a>04022     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l04023"></a>04023     <span class="keywordtype">float</span> fac = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;factor&quot;</span>);
<a name="l04024"></a>04024 
<a name="l04025"></a>04025     <span class="keywordflow">if</span> (em == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l04026"></a>04026         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l04027"></a>04027     }
<a name="l04028"></a>04028 
<a name="l04029"></a>04029     <span class="keywordflow">if</span> ((ma  = <a class="code" href="../../d4/d0f/BKE__material_8h.html#a941f5112d1047bcbcf3e2212685296a5">give_current_material</a>(obedit, obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a7f7913949235b61d1cd0b8f343d0cbfc">actcol</a>)) == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
<a name="l04030"></a>04030         (tex = <a class="code" href="../../d2/d66/BKE__texture_8h.html#ac426e689c2d69649d35bc14a0f926001">give_current_material_texture</a>(ma)) == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l04031"></a>04031     {
<a name="l04032"></a>04032         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;Mesh has no material or texture assigned&quot;</span>);
<a name="l04033"></a>04033         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l04034"></a>04034     }
<a name="l04035"></a>04035 
<a name="l04036"></a>04036     <span class="keywordflow">if</span> (tex-&gt;<a class="code" href="../../df/d2d/structTex.html#aa7daf61fa1146d430403e81db6acb7cb">type</a> == <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a8c188992ebde707d32773f09a2d03d8f">TEX_STUCCI</a>) {
<a name="l04037"></a>04037         <span class="keywordtype">float</span> b2, vec[3];
<a name="l04038"></a>04038         <span class="keywordtype">float</span> ofs = tex-&gt;<a class="code" href="../../df/d2d/structTex.html#ae3baa785e689a228223b989c9c51ed85">turbul</a> / 200.0;
<a name="l04039"></a>04039         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eve, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l04040"></a>04040             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eve, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l04041"></a>04041                 b2 = <a class="code" href="../../d1/d65/BLI__noise_8h.html#aa355e2a2ce32a48ca3793e37cd2922a0">BLI_hnoise</a>(tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a10d31271eb9bf27b184c404ac6352714">noisesize</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0], eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1], eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2]);
<a name="l04042"></a>04042                 <span class="keywordflow">if</span> (tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a8232165bb3210ad106bdc7880f801eb2">stype</a>) ofs *= (b2 * b2);
<a name="l04043"></a>04043                 vec[0] = fac * (b2 - <a class="code" href="../../d1/d65/BLI__noise_8h.html#aa355e2a2ce32a48ca3793e37cd2922a0">BLI_hnoise</a>(tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a10d31271eb9bf27b184c404ac6352714">noisesize</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0] + ofs, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1], eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2]));
<a name="l04044"></a>04044                 vec[1] = fac * (b2 - <a class="code" href="../../d1/d65/BLI__noise_8h.html#aa355e2a2ce32a48ca3793e37cd2922a0">BLI_hnoise</a>(tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a10d31271eb9bf27b184c404ac6352714">noisesize</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0], eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1] + ofs, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2]));
<a name="l04045"></a>04045                 vec[2] = fac * (b2 - <a class="code" href="../../d1/d65/BLI__noise_8h.html#aa355e2a2ce32a48ca3793e37cd2922a0">BLI_hnoise</a>(tex-&gt;<a class="code" href="../../df/d2d/structTex.html#a10d31271eb9bf27b184c404ac6352714">noisesize</a>, eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[0], eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[1], eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2] + ofs));
<a name="l04046"></a>04046                 
<a name="l04047"></a>04047                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#ae0067c77927da3b22dec1de77ac8ba78">add_v3_v3</a>(eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, vec);
<a name="l04048"></a>04048             }
<a name="l04049"></a>04049         }
<a name="l04050"></a>04050     }
<a name="l04051"></a>04051     <span class="keywordflow">else</span> {
<a name="l04052"></a>04052         <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eve, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa40e4413e8bcf7618b57cbbbc6b56382b">BM_VERTS_OF_MESH</a>) {
<a name="l04053"></a>04053             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d74/bmesh__inline_8h.html#a94748f531b63177f476a182c01fb43b1">BM_elem_flag_test</a>(eve, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>)) {
<a name="l04054"></a>04054                 <span class="keywordtype">float</span> tin, dum;
<a name="l04055"></a>04055                 <a class="code" href="../../d1/de4/RE__render__ext_8h.html#a833cb47a92698779f8873ec22ba1fad1">externtex</a>(ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a738a376b474b09dba529b222ba7876d6">mtex</a>[0], eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, &amp;tin, &amp;dum, &amp;dum, &amp;dum, &amp;dum, 0);
<a name="l04056"></a>04056                 eve-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>[2] += fac * tin;
<a name="l04057"></a>04057             }
<a name="l04058"></a>04058         }
<a name="l04059"></a>04059     }
<a name="l04060"></a>04060 
<a name="l04061"></a>04061     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afc818d571d27864536e18764e9c44a86">EDBM_mesh_normals_update</a>(em);
<a name="l04062"></a>04062 
<a name="l04063"></a>04063     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04064"></a>04064 
<a name="l04065"></a>04065     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l04066"></a>04066 }
<a name="l04067"></a>04067 
<a name="l04068"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#aac7f6e0df830a7b0de3cd0e5d5e47bc0">04068</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a25bf42f6a1d8b940aad60438c890c8d2">MESH_OT_noise</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l04069"></a>04069 {
<a name="l04070"></a>04070     <span class="comment">/* identifiers */</span>
<a name="l04071"></a>04071     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Noise&quot;</span>;
<a name="l04072"></a>04072     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Use vertex coordinate as texture coordinate&quot;</span>;
<a name="l04073"></a>04073     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_noise&quot;</span>;
<a name="l04074"></a>04074 
<a name="l04075"></a>04075     <span class="comment">/* api callbacks */</span>
<a name="l04076"></a>04076     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a800567c711d829f8845c998dc5eb94f9">edbm_noise_exec</a>;
<a name="l04077"></a>04077     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l04078"></a>04078 
<a name="l04079"></a>04079     <span class="comment">/* flags */</span>
<a name="l04080"></a>04080     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l04081"></a>04081 
<a name="l04082"></a>04082     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;factor&quot;</span>, 0.1f, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Factor&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0.0f, 1.0f);
<a name="l04083"></a>04083 }
<a name="l04084"></a>04084 
<a name="l04085"></a>04085 <span class="comment">/* bevel! yay!!*/</span>
<a name="l04086"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a58aaa44301e7b4d11bf7fbcaeb80e10d">04086</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a58aaa44301e7b4d11bf7fbcaeb80e10d">edbm_bevel_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l04087"></a>04087 {
<a name="l04088"></a>04088     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l04089"></a>04089     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l04090"></a>04090     <a class="code" href="../../de/d88/structBMIter.html">BMIter</a> iter;
<a name="l04091"></a>04091     <a class="code" href="../../de/d6e/structBMEdge.html">BMEdge</a> *eed;
<a name="l04092"></a>04092     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l04093"></a>04093     <span class="keywordtype">float</span> factor = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;percent&quot;</span>) <span class="comment">/*, dfac */</span> <span class="comment">/* UNUSED */</span>, df, s;
<a name="l04094"></a>04094     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, recursion = 1; <span class="comment">/* RNA_int_get(op-&gt;ptr, &quot;recursion&quot;); */</span> <span class="comment">/* temp removed, see comment below */</span>
<a name="l04095"></a>04095     <span class="keyword">const</span> <span class="keywordtype">int</span> use_even = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_even&quot;</span>);
<a name="l04096"></a>04096     <span class="keyword">const</span> <span class="keywordtype">int</span> use_dist = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_dist&quot;</span>);
<a name="l04097"></a>04097     <span class="keywordtype">float</span> *w = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ftot;
<a name="l04098"></a>04098     <span class="keywordtype">int</span> li;
<a name="l04099"></a>04099     
<a name="l04100"></a>04100     <a class="code" href="../../de/d02/bmesh__interp_8c.html#a7f95f944761c33d4e381c67798ce1bd4">BM_data_layer_add</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a5004aa4bd19e25b6479f21ae3bf32cbc">edata</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a800931318528181e23c78cca7949c332">CD_PROP_FLT</a>);
<a name="l04101"></a>04101     li = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#a1952483728c254dddff6523fba919538">CustomData_number_of_layers</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a5004aa4bd19e25b6479f21ae3bf32cbc">edata</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a800931318528181e23c78cca7949c332">CD_PROP_FLT</a>) - 1;
<a name="l04102"></a>04102     
<a name="l04103"></a>04103     <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a79af59cc6dcf476dee88507d90e316e9">BM_ITER_MESH</a> (eed, &amp;iter, em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d8/d17/bmesh__iterators_8h.html#a8b86da2394e306625bbfd94190505d1fa38e0ad1c62821fba188c45ddd39d6723">BM_EDGES_OF_MESH</a>) {
<a name="l04104"></a>04104         <span class="keywordtype">float</span> d = <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a97ecadbef10e5cc3decc2c02c3b96824">len_v3v3</a>(eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#ab6378c5ea7e85917c389a1dfdff790ea">v1</a>-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>, eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a00090f09abd0ef12bcf279cb0c41c0ca">v2</a>-&gt;<a class="code" href="../../df/d18/structBMVert.html#a69422c1e633b64cb13937a2e70a160a8">co</a>);
<a name="l04105"></a>04105         <span class="keywordtype">float</span> *dv = <a class="code" href="../../d5/d5e/BKE__customdata_8h.html#afeb6e9fe67d614f29bc78750b95111da">CustomData_bmesh_get_n</a>(&amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a5004aa4bd19e25b6479f21ae3bf32cbc">edata</a>, eed-&gt;<a class="code" href="../../de/d6e/structBMEdge.html#a0217baa3eaeea6474b67327a32044284">head</a>.<a class="code" href="../../d5/d3a/structBMHeader.html#aab6fc118de69cdb678fe6aaba4ec75be">data</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a800931318528181e23c78cca7949c332">CD_PROP_FLT</a>, li);
<a name="l04106"></a>04106         
<a name="l04107"></a>04107         *dv = d;
<a name="l04108"></a>04108     }
<a name="l04109"></a>04109     
<a name="l04110"></a>04110     <span class="keywordflow">if</span> (em == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l04111"></a>04111         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l04112"></a>04112     }
<a name="l04113"></a>04113     
<a name="l04114"></a>04114     w = <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * recursion, <span class="stringliteral">&quot;bevel weights&quot;</span>);
<a name="l04115"></a>04115 
<a name="l04116"></a>04116     <span class="comment">/* ugh, stupid math depends somewhat on angles!*/</span>
<a name="l04117"></a>04117     <span class="comment">/* dfac = 1.0/(float)(recursion + 1); */</span> <span class="comment">/* UNUSED */</span>
<a name="l04118"></a>04118     df = 1.0;
<a name="l04119"></a>04119     <span class="keywordflow">for</span> (i = 0, ftot = 0.0f; i &lt; recursion; i++) {
<a name="l04120"></a>04120         s = <a class="code" href="../../dd/d06/BLI__math__base_8h.html#acc9eed6743d69a0f62071dc0c7dd6ae8">powf</a>(df, 1.25f);
<a name="l04121"></a>04121 
<a name="l04122"></a>04122         w[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = s;
<a name="l04123"></a>04123         ftot += s;
<a name="l04124"></a>04124 
<a name="l04125"></a>04125         df *= 2.0;
<a name="l04126"></a>04126     }
<a name="l04127"></a>04127 
<a name="l04128"></a>04128     <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#ae3a60146ad99ea33c297e467dfa48c00">mul_vn_fl</a>(w, recursion, 1.0f / (<span class="keywordtype">float</span>)ftot);
<a name="l04129"></a>04129 
<a name="l04130"></a>04130     <span class="keywordflow">for</span> (i = 0; i &lt; recursion; i++) {
<a name="l04131"></a>04131         <span class="keywordtype">float</span> fac = w[recursion - i - 1] * factor;
<a name="l04132"></a>04132 
<a name="l04133"></a>04133         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op,
<a name="l04134"></a>04134                           <span class="stringliteral">&quot;bevel geom=%hev percent=%f lengthlayer=%i use_lengths=%b use_even=%b use_dist=%b&quot;</span>,
<a name="l04135"></a>04135                           <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, fac, li, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, use_even, use_dist))
<a name="l04136"></a>04136         {
<a name="l04137"></a>04137             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l04138"></a>04138         }
<a name="l04139"></a>04139         
<a name="l04140"></a>04140         <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l04141"></a>04141         <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>))
<a name="l04142"></a>04142             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l04143"></a>04143     }
<a name="l04144"></a>04144     
<a name="l04145"></a>04145     <a class="code" href="../../de/d02/bmesh__interp_8c.html#a224fc18156271a635812f294c9e4c948">BM_data_layer_free_n</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#a5004aa4bd19e25b6479f21ae3bf32cbc">edata</a>, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a800931318528181e23c78cca7949c332">CD_PROP_FLT</a>, li);
<a name="l04146"></a>04146     
<a name="l04147"></a>04147     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(w);
<a name="l04148"></a>04148 
<a name="l04149"></a>04149     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#afc818d571d27864536e18764e9c44a86">EDBM_mesh_normals_update</a>(em);
<a name="l04150"></a>04150 
<a name="l04151"></a>04151     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04152"></a>04152 
<a name="l04153"></a>04153     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l04154"></a>04154 }
<a name="l04155"></a>04155 
<a name="l04156"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#ac83c3dee0d84ddb5427f2d6c1c97a47d">04156</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#aab6128c8ec3491a7ec6b3cbda623f940">MESH_OT_bevel</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l04157"></a>04157 {
<a name="l04158"></a>04158     <span class="comment">/* identifiers */</span>
<a name="l04159"></a>04159     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Bevel&quot;</span>;
<a name="l04160"></a>04160     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Edge Bevel&quot;</span>;
<a name="l04161"></a>04161     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_bevel&quot;</span>;
<a name="l04162"></a>04162 
<a name="l04163"></a>04163     <span class="comment">/* api callbacks */</span>
<a name="l04164"></a>04164     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a58aaa44301e7b4d11bf7fbcaeb80e10d">edbm_bevel_exec</a>;
<a name="l04165"></a>04165     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l04166"></a>04166 
<a name="l04167"></a>04167     <span class="comment">/* flags */</span>
<a name="l04168"></a>04168     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l04169"></a>04169 
<a name="l04170"></a>04170     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;percent&quot;</span>, 0.5f, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Percentage&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0.0f, 1.0f);
<a name="l04171"></a>04171 <span class="comment">//  XXX, disabled for 2.63 release, needs to work much better without overlap before we can give to users.</span>
<a name="l04172"></a>04172 <span class="comment">//  RNA_def_int(ot-&gt;srna, &quot;recursion&quot;, 1, 1, 50, &quot;Recursion Level&quot;, &quot;Recursion Level&quot;, 1, 8);</span>
<a name="l04173"></a>04173 
<a name="l04174"></a>04174     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_even&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="stringliteral">&quot;Even&quot;</span>,     <span class="stringliteral">&quot;Calculate evenly spaced bevel&quot;</span>);
<a name="l04175"></a>04175     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_dist&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="stringliteral">&quot;Distance&quot;</span>, <span class="stringliteral">&quot;Interpret the percent in blender units&quot;</span>);
<a name="l04176"></a>04176 
<a name="l04177"></a>04177 }
<a name="l04178"></a>04178 
<a name="l04179"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8b0154a8ef21a417a59024233d509998">04179</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8b0154a8ef21a417a59024233d509998">edbm_bridge_edge_loops_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l04180"></a>04180 {
<a name="l04181"></a>04181     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l04182"></a>04182     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l04183"></a>04183     
<a name="l04184"></a>04184     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#a12387cad667ed9bf79eaf6ab7911db92">EDBM_op_callf</a>(em, op, <span class="stringliteral">&quot;bridge_loops edges=%he&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>))
<a name="l04185"></a>04185         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l04186"></a>04186     
<a name="l04187"></a>04187     <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04188"></a>04188 
<a name="l04189"></a>04189     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l04190"></a>04190 }
<a name="l04191"></a>04191 
<a name="l04192"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a10545273fe2b49607ade887faae7e5ab">04192</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a9303dc38a27edd8b299191a3583f5ef5">MESH_OT_bridge_edge_loops</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l04193"></a>04193 {
<a name="l04194"></a>04194     <span class="comment">/* identifiers */</span>
<a name="l04195"></a>04195     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Bridge Two Edge Loops&quot;</span>;
<a name="l04196"></a>04196     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Make faces between two edge loops&quot;</span>;
<a name="l04197"></a>04197     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_bridge_edge_loops&quot;</span>;
<a name="l04198"></a>04198     
<a name="l04199"></a>04199     <span class="comment">/* api callbacks */</span>
<a name="l04200"></a>04200     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a8b0154a8ef21a417a59024233d509998">edbm_bridge_edge_loops_exec</a>;
<a name="l04201"></a>04201     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l04202"></a>04202     
<a name="l04203"></a>04203     <span class="comment">/* flags */</span>
<a name="l04204"></a>04204     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l04205"></a>04205     
<a name="l04206"></a>04206     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;inside&quot;</span>, 0, <span class="stringliteral">&quot;Inside&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l04207"></a>04207 }
<a name="l04208"></a>04208 
<a name="l04209"></a>04209 
<a name="l04210"></a>04210 
<a name="l04211"></a><a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4af1a3204fb819ff78d3908169d86d03">04211</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4af1a3204fb819ff78d3908169d86d03">edbm_inset_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l04212"></a>04212 {
<a name="l04213"></a>04213     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l04214"></a>04214     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l04215"></a>04215     <a class="code" href="../../d0/d92/structBMOperator.html">BMOperator</a> bmop;
<a name="l04216"></a>04216     <span class="keyword">const</span> <span class="keywordtype">int</span> use_boundary        = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_boundary&quot;</span>);
<a name="l04217"></a>04217     <span class="keyword">const</span> <span class="keywordtype">int</span> use_even_offset     = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_even_offset&quot;</span>);
<a name="l04218"></a>04218     <span class="keyword">const</span> <span class="keywordtype">int</span> use_relative_offset = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_relative_offset&quot;</span>);
<a name="l04219"></a>04219     <span class="keyword">const</span> <span class="keywordtype">float</span> thickness         = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>,   <span class="stringliteral">&quot;thickness&quot;</span>);
<a name="l04220"></a>04220     <span class="keyword">const</span> <span class="keywordtype">float</span> depth             = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>,   <span class="stringliteral">&quot;depth&quot;</span>);
<a name="l04221"></a>04221     <span class="keyword">const</span> <span class="keywordtype">int</span> use_outset          = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_outset&quot;</span>);
<a name="l04222"></a>04222     <span class="keyword">const</span> <span class="keywordtype">int</span> use_select_inset    = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;use_select_inset&quot;</span>); <span class="comment">/* not passed onto the BMO */</span>
<a name="l04223"></a>04223 
<a name="l04224"></a>04224     <a class="code" href="../../db/d9e/editmesh__utils_8c.html#a561ee9fbf78e4d1e00c4d60071b3b183">EDBM_op_init</a>(em, &amp;bmop, op,
<a name="l04225"></a>04225                  <span class="stringliteral">&quot;inset faces=%hf use_boundary=%b use_even_offset=%b use_relative_offset=%b &quot;</span>
<a name="l04226"></a>04226                  <span class="stringliteral">&quot;thickness=%f depth=%f use_outset=%b&quot;</span>,
<a name="l04227"></a>04227                  <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, use_boundary, use_even_offset, use_relative_offset,
<a name="l04228"></a>04228                  thickness, depth, use_outset);
<a name="l04229"></a>04229 
<a name="l04230"></a>04230     <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a72fc55143180f21895f7ce90da0e8ca2" title="BMESH OPSTACK EXEC OP.">BMO_op_exec</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop);
<a name="l04231"></a>04231 
<a name="l04232"></a>04232     <span class="keywordflow">if</span> (use_select_inset) {
<a name="l04233"></a>04233         <span class="comment">/* deselect original faces/verts */</span>
<a name="l04234"></a>04234         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#ad41c90158b6c2ef698cb56722a5baf36">EDBM_flag_disable_all</a>(em, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l04235"></a>04235         <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a6a701aef471b7b63bc03f2bba717fe9a" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_enable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;faceout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04236"></a>04236     }
<a name="l04237"></a>04237     <span class="keywordflow">else</span> {
<a name="l04238"></a>04238         <a class="code" href="../../d5/def/bmesh__marking_8c.html#a38d355744ee2bbd8c413709c693775f4">BM_mesh_elem_hflag_disable_all</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a69729bc1555e82d32291f917fcb7350c">BM_VERT</a> | <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a9c98dbf43c8b979e7c2b4224eaf18c94">BM_EDGE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l04239"></a>04239         <a class="code" href="../../d5/d70/bmesh__operator__api_8h.html#a1738215546cdb3e92aec2b09328dad3d" title="BMO_FLAG_BUFFER.">BMO_slot_buffer_hflag_disable</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, &amp;bmop, <span class="stringliteral">&quot;faceout&quot;</span>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l04240"></a>04240         <span class="comment">/* re-select faces so the verts and edges get selected too */</span>
<a name="l04241"></a>04241         <a class="code" href="../../d5/def/bmesh__marking_8c.html#a724cc43118de27abe908e9ffad46bbfa">BM_mesh_elem_hflag_enable_test</a>(em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a77867ab4129f63159b37bca3b652a798a279a53b6bc9b4dd104fa2607f8439075">BM_FACE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d1/d77/bmesh__class_8h.html#a16685eea158879e41b101ca3634de462a6afc5d1391fd30b47036817b139a85ed">BM_ELEM_SELECT</a>);
<a name="l04242"></a>04242     }
<a name="l04243"></a>04243 
<a name="l04244"></a>04244     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d9e/editmesh__utils_8c.html#ac99aaa31d04c904bb8845e0578133db1">EDBM_op_finish</a>(em, &amp;bmop, op, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)) {
<a name="l04245"></a>04245         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l04246"></a>04246     }
<a name="l04247"></a>04247     <span class="keywordflow">else</span> {
<a name="l04248"></a>04248         <a class="code" href="../../d5/dd6/ED__mesh_8h.html#a13d0b5662b3a6db159da122eaced50ab">EDBM_update_generic</a>(C, em, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04249"></a>04249         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l04250"></a>04250     }
<a name="l04251"></a>04251 }
<a name="l04252"></a>04252 
<a name="l04253"></a><a class="code" href="../../d3/d5c/mesh__intern_8h.html#a79409e9b2e2ed869bfab5aaa25c10535">04253</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a7accd1e89543e2cd9708f77c628993b9">MESH_OT_inset</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l04254"></a>04254 {
<a name="l04255"></a>04255     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l04256"></a>04256 
<a name="l04257"></a>04257     <span class="comment">/* identifiers */</span>
<a name="l04258"></a>04258     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Inset Faces&quot;</span>;
<a name="l04259"></a>04259     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;MESH_OT_inset&quot;</span>;
<a name="l04260"></a>04260     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Inset new faces into selected faces&quot;</span>;
<a name="l04261"></a>04261 
<a name="l04262"></a>04262     <span class="comment">/* api callbacks */</span>
<a name="l04263"></a>04263     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d85/editmesh__tools_8c.html#a4af1a3204fb819ff78d3908169d86d03">edbm_inset_exec</a>;
<a name="l04264"></a>04264     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>;
<a name="l04265"></a>04265 
<a name="l04266"></a>04266     <span class="comment">/* flags */</span>
<a name="l04267"></a>04267     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l04268"></a>04268 
<a name="l04269"></a>04269     <span class="comment">/* properties */</span>
<a name="l04270"></a>04270     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_boundary&quot;</span>,        <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="stringliteral">&quot;Boundary&quot;</span>,  <span class="stringliteral">&quot;Inset face boundaries&quot;</span>);
<a name="l04271"></a>04271     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_even_offset&quot;</span>,     <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="stringliteral">&quot;Offset Even&quot;</span>,      <span class="stringliteral">&quot;Scale the offset to give more even thickness&quot;</span>);
<a name="l04272"></a>04272     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_relative_offset&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="stringliteral">&quot;Offset Relative&quot;</span>, <span class="stringliteral">&quot;Scale the offset by surrounding geometry&quot;</span>);
<a name="l04273"></a>04273 
<a name="l04274"></a>04274     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;thickness&quot;</span>, 0.01f, 0.0f, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Thickness&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0.0f, 10.0f);
<a name="l04275"></a>04275     <span class="comment">/* use 1 rather then 10 for max else dragging the button moves too far */</span>
<a name="l04276"></a>04276     <a class="code" href="../../dc/d7e/rna__define_8c.html#aeb47f39a68432b5d1758c3b6922a2fd4">RNA_def_property_ui_range</a>(prop, 0.0, 1.0, 0.01, 4);
<a name="l04277"></a>04277     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;depth&quot;</span>, 0.0f, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <span class="stringliteral">&quot;Depth&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, -10.0f, 10.0f);
<a name="l04278"></a>04278     <a class="code" href="../../dc/d7e/rna__define_8c.html#aeb47f39a68432b5d1758c3b6922a2fd4">RNA_def_property_ui_range</a>(prop, -10.0f, 10.0f, 0.01, 4);
<a name="l04279"></a>04279 
<a name="l04280"></a>04280     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_outset&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="stringliteral">&quot;Outset&quot;</span>, <span class="stringliteral">&quot;Outset rather than inset&quot;</span>);
<a name="l04281"></a>04281     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;use_select_inset&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="stringliteral">&quot;Select Outer&quot;</span>, <span class="stringliteral">&quot;Select the new inset faces&quot;</span>);
<a name="l04282"></a>04282 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:16 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
