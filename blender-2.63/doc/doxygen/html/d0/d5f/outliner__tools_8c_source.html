<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: outliner_tools.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">outliner_tools.c</div>  </div>
</div>
<div class="contents">
<a href="../../d0/d5f/outliner__tools_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version. </span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2004 Blender Foundation.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * The Original Code is: all of this file.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * Contributor(s): Joshua Leung</span>
<a name="l00024"></a>00024 <span class="comment"> *</span>
<a name="l00025"></a>00025 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html">DNA_anim_types.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d93/DNA__armature__types_8h.html">DNA_armature_types.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d75/DNA__group__types_8h.html">DNA_group_types.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html">DNA_lamp_types.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../de/db2/DNA__material__types_8h.html">DNA_material_types.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d96/DNA__mesh__types_8h.html">DNA_mesh_types.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d40/DNA__meta__types_8h.html">DNA_meta_types.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d3b/DNA__world__types_8h.html">DNA_world_types.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d51/BKE__animsys_8h.html">BKE_animsys.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da0/BKE__depsgraph_8h.html">BKE_depsgraph.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dba/BKE__fcurve_8h.html">BKE_fcurve.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/df5/BKE__group_8h.html">BKE_group.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/db1/BKE__library_8h.html">BKE_library.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/BKE__report_8h.html">BKE_report.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d53/BKE__scene_8h.html">BKE_scene.h</a>&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d98/ED__armature_8h.html">ED_armature.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7a/ED__object_8h.html">ED_object.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/df1/ED__util_8h.html">ED_util.h</a>&quot;</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1e/UI__interface_8h.html">UI_interface.h</a>&quot;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d63/UI__view2d_8h.html">UI_view2d.h</a>&quot;</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/RNA__define_8h.html">RNA_define.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d68/RNA__enum__types_8h.html">RNA_enum_types.h</a>&quot;</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="../../df/def/outliner__intern_8h.html">outliner_intern.h</a>&quot;</span>
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="comment">/* ****************************************************** */</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">/* ************ SELECTION OPERATIONS ********* */</span>
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">00079</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">set_operation_types</a>(<a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb,
<a name="l00080"></a>00080                 <span class="keywordtype">int</span> *scenelevel,
<a name="l00081"></a>00081                 <span class="keywordtype">int</span> *objectlevel,
<a name="l00082"></a>00082                 <span class="keywordtype">int</span> *idlevel,
<a name="l00083"></a>00083                 <span class="keywordtype">int</span> *datalevel)
<a name="l00084"></a>00084 {
<a name="l00085"></a>00085     <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te;
<a name="l00086"></a>00086     <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem;
<a name="l00087"></a>00087     
<a name="l00088"></a>00088     <span class="keywordflow">for</span> (te= lb-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; te; te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#af4294bd483fda182e33ddd33ad757581">next</a>) {
<a name="l00089"></a>00089         tselem= <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te);
<a name="l00090"></a>00090         <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a104426a340d0c42828c65f86ed21dd80">flag</a> &amp; <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>) {
<a name="l00091"></a>00091             <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a>) {
<a name="l00092"></a>00092                 <span class="keywordflow">if</span> (*datalevel==0)
<a name="l00093"></a>00093                     *datalevel= tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a>;
<a name="l00094"></a>00094                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*datalevel!=tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a>)
<a name="l00095"></a>00095                     *datalevel= -1;
<a name="l00096"></a>00096             }
<a name="l00097"></a>00097             <span class="keywordflow">else</span> {
<a name="l00098"></a>00098                 <span class="keywordtype">int</span> idcode= <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>);
<a name="l00099"></a>00099                 <span class="keywordflow">switch</span>(idcode) {
<a name="l00100"></a>00100                     <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac2b425dbd1f73ad1720fafad2626d974">ID_SCE</a>:
<a name="l00101"></a>00101                         *scenelevel= 1;
<a name="l00102"></a>00102                         <span class="keywordflow">break</span>;
<a name="l00103"></a>00103                     <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>:
<a name="l00104"></a>00104                         *objectlevel= 1;
<a name="l00105"></a>00105                         <span class="keywordflow">break</span>;
<a name="l00106"></a>00106                         
<a name="l00107"></a>00107                     <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a2e6c796d1f9370e5fd552166098cdd27">ID_ME</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ace150506eaf644d92a5110cf45978379">ID_CU</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a3e4005eef9876a2cb9d799bdb2a43998">ID_MB</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ad058b07954b2795eadc855a7a354578b">ID_LT</a>:
<a name="l00108"></a>00108                     <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ae4ba19f70b08895557ef00b489e7d255">ID_AR</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82bdb2fdea7abee55d993c0210101273">ID_CA</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a0cd81e8a0b1724426ed2d1e36218cdf6">ID_SPK</a>:
<a name="l00109"></a>00109                     <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a5856d1dba712ee1a816c279762743c1b">ID_IP</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a564eac75543b047cf8b2b759818529c3">ID_IM</a>:
<a name="l00110"></a>00110                     <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a3bae74282a62fb44842ff3767a86ec70">ID_SO</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a46c0b029a6e8fc3d7ebb18311b83397d">ID_KE</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a20fe08f8d0b2a4e6c0dbb2371aacadb0">ID_AC</a>:
<a name="l00111"></a>00111                     <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a7cef82cbfbffecc607b9ecec3c16f2d1">ID_NLA</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aedc19b629c5c0b30dd7697cd4ac4dc20">ID_TXT</a>: <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#afc8c3d5178b4130eee3e7542ef0dcae7">ID_GR</a>:
<a name="l00112"></a>00112                         <span class="keywordflow">if</span> (*idlevel==0) *idlevel= idcode;
<a name="l00113"></a>00113                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*idlevel!=idcode) *idlevel= -1;
<a name="l00114"></a>00114                             <span class="keywordflow">break</span>;
<a name="l00115"></a>00115                 }
<a name="l00116"></a>00116             }
<a name="l00117"></a>00117         }
<a name="l00118"></a>00118         <span class="keywordflow">if</span> (<a class="code" href="../../df/def/outliner__intern_8h.html#ace613b13228d89a1db39371e551432af">TSELEM_OPEN</a>(tselem,soops)) {
<a name="l00119"></a>00119             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">set_operation_types</a>(soops, &amp;te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9d11a8301593c5ada35845e59ceb2853">subtree</a>,
<a name="l00120"></a>00120                                 scenelevel, objectlevel, idlevel, datalevel);
<a name="l00121"></a>00121         }
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00125"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a4925be944fb2827f747044cd6710bfaa">00125</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a4925be944fb2827f747044cd6710bfaa">unlink_action_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tselem))
<a name="l00126"></a>00126 {
<a name="l00127"></a>00127     <span class="comment">/* just set action to NULL */</span>
<a name="l00128"></a>00128     <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a894e4c32b7cc4abe5cc3d1bc535b0749">BKE_animdata_set_action</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#ac83792b6e00e841cdb896c9c0230bde7">CTX_wm_reports</a>(C), tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#aa3a567a681339760211c7cc3ce674f44">00131</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aa3a567a681339760211c7cc3ce674f44">unlink_material_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tselem))
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> **matar=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00134"></a>00134     <span class="keywordtype">int</span> a, totcol=0;
<a name="l00135"></a>00135     
<a name="l00136"></a>00136     <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) {
<a name="l00137"></a>00137         <a class="code" href="../../de/de7/structObject.html">Object</a> *ob= (<a class="code" href="../../de/de7/structObject.html">Object</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00138"></a>00138         totcol= ob-&gt;<a class="code" href="../../de/de7/structObject.html#ad3bbabfca98cb47923254dd04d6961ac">totcol</a>;
<a name="l00139"></a>00139         matar= ob-&gt;<a class="code" href="../../de/de7/structObject.html#a545b54048d299d5d9b5f49d6a80f1a9f">mat</a>;
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a2e6c796d1f9370e5fd552166098cdd27">ID_ME</a>) {
<a name="l00142"></a>00142         <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me= (<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00143"></a>00143         totcol= me-&gt;<a class="code" href="../../da/d29/structMesh.html#ac7bd892579cf8a793973b2ce2491ec06">totcol</a>;
<a name="l00144"></a>00144         matar= me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4fdee04a24d1a821f3bfa659b3bd8156">mat</a>;
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#ace150506eaf644d92a5110cf45978379">ID_CU</a>) {
<a name="l00147"></a>00147         <a class="code" href="../../da/d10/structCurve.html">Curve</a> *cu= (<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00148"></a>00148         totcol= cu-&gt;<a class="code" href="../../da/d10/structCurve.html#a178aa2fd33adfb5df2b311a7d398ac36">totcol</a>;
<a name="l00149"></a>00149         matar= cu-&gt;<a class="code" href="../../da/d10/structCurve.html#a0ff0285ca29eef8bf650f0746ac9a84a">mat</a>;
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a3e4005eef9876a2cb9d799bdb2a43998">ID_MB</a>) {
<a name="l00152"></a>00152         <a class="code" href="../../d3/d6c/structMetaBall.html">MetaBall</a> *mb= (<a class="code" href="../../d3/d6c/structMetaBall.html">MetaBall</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00153"></a>00153         totcol= mb-&gt;<a class="code" href="../../d3/d6c/structMetaBall.html#ab8971ac14c6143431474bce14b1ea887">totcol</a>;
<a name="l00154"></a>00154         matar= mb-&gt;<a class="code" href="../../d3/d6c/structMetaBall.html#ae78577af3d79eea5d59be6f39a9c768d">mat</a>;
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="keywordflow">for</span> (a=0; a&lt;totcol; a++) {
<a name="l00158"></a>00158         <span class="keywordflow">if</span> (a==te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a8256cd06a838e948fb2afb9debe03d32">index</a> &amp;&amp; matar[a]) {
<a name="l00159"></a>00159             matar[a]-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l00160"></a>00160             matar[a]= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a88a74922748522c33b056f90a4ea03ad">00165</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a88a74922748522c33b056f90a4ea03ad">unlink_texture_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tselem))
<a name="l00166"></a>00166 {
<a name="l00167"></a>00167     <a class="code" href="../../dc/ddd/structMTex.html">MTex</a> **mtex= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00168"></a>00168     <span class="keywordtype">int</span> a;
<a name="l00169"></a>00169     
<a name="l00170"></a>00170     <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>) {
<a name="l00171"></a>00171         <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *ma= (<a class="code" href="../../d2/d10/structMaterial.html">Material</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00172"></a>00172         mtex= ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a738a376b474b09dba529b222ba7876d6">mtex</a>;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a82e259dda95124fd771a23f105f52810">ID_LA</a>) {
<a name="l00175"></a>00175         <a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *la= (<a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00176"></a>00176         mtex= la-&gt;<a class="code" href="../../d5/d72/structLamp.html#add02e1f88fe6e0ab0f54de00fd02b49e">mtex</a>;
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>) {
<a name="l00179"></a>00179         <a class="code" href="../../d7/d3f/structWorld.html">World</a> *wrld= (<a class="code" href="../../d7/d3f/structWorld.html">World</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00180"></a>00180         mtex= wrld-&gt;<a class="code" href="../../d7/d3f/structWorld.html#aa41e14c520e87635c6c9a748dd144e25">mtex</a>;
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182     <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
<a name="l00183"></a>00183     
<a name="l00184"></a>00184     <span class="keywordflow">for</span> (a=0; a&lt;<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a5c921b6ba71dfcfa9a404e101d9bcaf4">MAX_MTEX</a>; a++) {
<a name="l00185"></a>00185         <span class="keywordflow">if</span> (a==te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a8256cd06a838e948fb2afb9debe03d32">index</a> &amp;&amp; mtex[a]) {
<a name="l00186"></a>00186             <span class="keywordflow">if</span> (mtex[a]-&gt;tex) {
<a name="l00187"></a>00187                 mtex[a]-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a8319488bcdfe2de879476bd0f7c27aa2">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>--;
<a name="l00188"></a>00188                 mtex[a]-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00189"></a>00189             }
<a name="l00190"></a>00190         }
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00194"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a5af0714d49337d2906c4127e7bb6e978">00194</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a5af0714d49337d2906c4127e7bb6e978">unlink_group_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00195"></a>00195 {
<a name="l00196"></a>00196     <a class="code" href="../../d4/d91/structGroup.html">Group</a> *group= (<a class="code" href="../../d4/d91/structGroup.html">Group</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00197"></a>00197     
<a name="l00198"></a>00198     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (tsep) {
<a name="l00199"></a>00199         <span class="keywordflow">if</span> ( <a class="code" href="../../db/ddc/icons_8c.html#adcd5f4a8d30b31ea3612fab180fa3338">GS</a>(tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>)==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) {
<a name="l00200"></a>00200             <a class="code" href="../../de/de7/structObject.html">Object</a> *ob= (<a class="code" href="../../de/de7/structObject.html">Object</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00201"></a>00201             ob-&gt;<a class="code" href="../../de/de7/structObject.html#a3f0daef111a437533e48f6209429b49f">dup_group</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00202"></a>00202         }
<a name="l00203"></a>00203     }
<a name="l00204"></a>00204     <span class="keywordflow">else</span> {
<a name="l00205"></a>00205         <a class="code" href="../../d2/df5/BKE__group_8h.html#aa3e7a2e4f80c656b3528fc7f3a9e4f03">unlink_group</a>(group);
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00209"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#abe1502aef8a52d98e30e3871e5c7fc5c">00209</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#abe1502aef8a52d98e30e3871e5c7fc5c">unlink_world_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *parscene = (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00212"></a>00212     <a class="code" href="../../d7/d3f/structWorld.html">World</a> *wo = (<a class="code" href="../../d7/d3f/structWorld.html">World</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00213"></a>00213     
<a name="l00214"></a>00214     <span class="comment">/* need to use parent scene not just scene, otherwise may end up getting wrong one */</span>
<a name="l00215"></a>00215     <a class="code" href="../../d8/db1/BKE__library_8h.html#a2caead3c3bda9441d1a4affbbe0d328b">id_us_min</a>(&amp;wo-&gt;id);
<a name="l00216"></a>00216     parscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aefac18ed3d1ded63b012f79a3ca8ddb2">world</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00217"></a>00217 }
<a name="l00218"></a>00218 
<a name="l00219"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">00219</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb, 
<a name="l00220"></a>00220                                          <span class="keywordtype">void</span> (*operation_cb)(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *))
<a name="l00221"></a>00221 {
<a name="l00222"></a>00222     <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te;
<a name="l00223"></a>00223     <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem;
<a name="l00224"></a>00224     
<a name="l00225"></a>00225     <span class="keywordflow">for</span> (te=lb-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; te; te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#af4294bd483fda182e33ddd33ad757581">next</a>) {
<a name="l00226"></a>00226         tselem= <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te);
<a name="l00227"></a>00227         <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a104426a340d0c42828c65f86ed21dd80">flag</a> &amp; <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>) {
<a name="l00228"></a>00228             <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a>==0) {
<a name="l00229"></a>00229                 <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep= <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a2531c368b60c64064a070e9f2888408d">parent</a>);
<a name="l00230"></a>00230                 operation_cb(C, scene, te, tsep, tselem);
<a name="l00231"></a>00231             }
<a name="l00232"></a>00232         }
<a name="l00233"></a>00233         <span class="keywordflow">if</span> (<a class="code" href="../../df/def/outliner__intern_8h.html#ace613b13228d89a1db39371e551432af">TSELEM_OPEN</a>(tselem,soops)) {
<a name="l00234"></a>00234             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9d11a8301593c5ada35845e59ceb2853">subtree</a>, operation_cb);
<a name="l00235"></a>00235         }
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="comment">/* */</span>
<a name="l00240"></a>00240 
<a name="l00241"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a510900be82abe028c2f53686b890e0c7">00241</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a510900be82abe028c2f53686b890e0c7">object_select_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tsep), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00242"></a>00242 {
<a name="l00243"></a>00243     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base= (<a class="code" href="../../d3/da9/structBase.html">Base</a> *)te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#ac4c4f07fcb2ed46300b3f08bd47887b2">directdata</a>;
<a name="l00244"></a>00244     
<a name="l00245"></a>00245     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (base==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) base= <a class="code" href="../../d8/d53/BKE__scene_8h.html#af038ab52dca2267b6418721c13b81e74">object_in_scene</a>((<a class="code" href="../../de/de7/structObject.html">Object</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, scene);
<a name="l00246"></a>00246     <span class="keywordflow">if</span> (base &amp;&amp; ((base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>)==0)) {
<a name="l00247"></a>00247         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00248"></a>00248         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00249"></a>00249     }
<a name="l00250"></a>00250 }
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a148519f04b4fb775d50dff4ffe09dbe5">00252</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a148519f04b4fb775d50dff4ffe09dbe5">object_deselect_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tsep), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base= (<a class="code" href="../../d3/da9/structBase.html">Base</a> *)te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#ac4c4f07fcb2ed46300b3f08bd47887b2">directdata</a>;
<a name="l00255"></a>00255     
<a name="l00256"></a>00256     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (base==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) base= <a class="code" href="../../d8/d53/BKE__scene_8h.html#af038ab52dca2267b6418721c13b81e74">object_in_scene</a>((<a class="code" href="../../de/de7/structObject.html">Object</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, scene);
<a name="l00257"></a>00257     <span class="keywordflow">if</span> (base) {
<a name="l00258"></a>00258         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a0e10616272837fff209501e1cd7fb26b">flag</a> &amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00259"></a>00259         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a4cb926ee8d882f0a18f0a2dbdea46e73">flag</a> &amp;= ~<a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261 }
<a name="l00262"></a>00262 
<a name="l00263"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#aa65889012be847263cc0010baad68395">00263</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aa65889012be847263cc0010baad68395">object_delete_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tsep), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00264"></a>00264 {
<a name="l00265"></a>00265     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base= (<a class="code" href="../../d3/da9/structBase.html">Base</a> *)te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#ac4c4f07fcb2ed46300b3f08bd47887b2">directdata</a>;
<a name="l00266"></a>00266     
<a name="l00267"></a>00267     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (base==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00268"></a>00268         base= <a class="code" href="../../d8/d53/BKE__scene_8h.html#af038ab52dca2267b6418721c13b81e74">object_in_scene</a>((<a class="code" href="../../de/de7/structObject.html">Object</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, scene);
<a name="l00269"></a>00269     <span class="keywordflow">if</span> (base) {
<a name="l00270"></a>00270         <span class="comment">// check also library later</span>
<a name="l00271"></a>00271         <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a1aa1978dba5dab99d35b6ba89e88b5bb">obedit</a>==base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>)
<a name="l00272"></a>00272             <a class="code" href="../../da/d7a/ED__object_8h.html#a3dc41f10c2da040464140768d2898865">ED_object_exit_editmode</a>(C, <a class="code" href="../../da/d7a/ED__object_8h.html#a56f58f037f42277d234426571ee2de12">EM_FREEDATA</a>|<a class="code" href="../../da/d7a/ED__object_8h.html#a29af110c1f2bdde18ce63daf6c3575f5">EM_FREEUNDO</a>|<a class="code" href="../../da/d7a/ED__object_8h.html#a660a08f2196e720360e276ccf8125171">EM_WAITCURSOR</a>|<a class="code" href="../../da/d7a/ED__object_8h.html#a58e84e1ebbb3942ca4d7722b6c19c61d">EM_DO_UNDO</a>);
<a name="l00273"></a>00273         
<a name="l00274"></a>00274         <a class="code" href="../../da/d7a/ED__object_8h.html#af606d9df3349e6cc4267296011bf4f12">ED_base_object_free_and_unlink</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C), scene, base);
<a name="l00275"></a>00275         te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#ac4c4f07fcb2ed46300b3f08bd47887b2">directdata</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00276"></a>00276         tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a36f2087f36aa3d79e495aaf476713352">00280</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a36f2087f36aa3d79e495aaf476713352">id_local_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tsep), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00281"></a>00281 {
<a name="l00282"></a>00282     <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a> &amp;&amp; (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp; <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a48cc004c21e097c0d7c1c5fa8dc03b96">LIB_EXTERN</a>)) {
<a name="l00283"></a>00283         <span class="comment">/* if the ID type has no special local function,</span>
<a name="l00284"></a>00284 <span class="comment">         * just clear the lib */</span>
<a name="l00285"></a>00285         <span class="keywordflow">if</span> (<a class="code" href="../../d8/db1/BKE__library_8h.html#aa39db829246321d923eefd92d56b29e6">id_make_local</a>(tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
<a name="l00286"></a>00286             <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l00287"></a>00287             <a class="code" href="../../d8/db1/BKE__library_8h.html#a668f0934d813d85c7920735e681fb2b1">id_clear_lib_data</a>(bmain, tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>);
<a name="l00288"></a>00288         }
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290 }
<a name="l00291"></a>00291 
<a name="l00292"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a58e8fd760c9bd70fe3765622da2149ab">00292</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a58e8fd760c9bd70fe3765622da2149ab">id_fake_user_set_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tsep), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00293"></a>00293 {
<a name="l00294"></a>00294     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00295"></a>00295     
<a name="l00296"></a>00296     <span class="keywordflow">if</span> ((<span class="keywordtype">id</span>) &amp;&amp; ((id-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp; <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac7a490f7c486f67fa46961f920fc8e26">LIB_FAKEUSER</a>) == 0)) {
<a name="l00297"></a>00297         <span class="keywordtype">id</span>-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> |= <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac7a490f7c486f67fa46961f920fc8e26">LIB_FAKEUSER</a>;
<a name="l00298"></a>00298         <a class="code" href="../../d8/db1/BKE__library_8h.html#a967d1ceef29b2612ef6e03194c512ad6">id_us_plus</a>(<span class="keywordtype">id</span>);
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae6dd1411479b25493103d44efd045de8">00302</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae6dd1411479b25493103d44efd045de8">id_fake_user_clear_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tsep), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00305"></a>00305     
<a name="l00306"></a>00306     <span class="keywordflow">if</span> ((<span class="keywordtype">id</span>) &amp;&amp; (id-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp; <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac7a490f7c486f67fa46961f920fc8e26">LIB_FAKEUSER</a>)) {
<a name="l00307"></a>00307         <span class="keywordtype">id</span>-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp;= ~<a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac7a490f7c486f67fa46961f920fc8e26">LIB_FAKEUSER</a>;
<a name="l00308"></a>00308         <a class="code" href="../../d8/db1/BKE__library_8h.html#a2caead3c3bda9441d1a4affbbe0d328b">id_us_min</a>(<span class="keywordtype">id</span>);
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 
<a name="l00312"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a52e04f112176d9f4a98b5182ed18a2e7">00312</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a52e04f112176d9f4a98b5182ed18a2e7">singleuser_action_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00313"></a>00313 {
<a name="l00314"></a>00314     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00315"></a>00315     
<a name="l00316"></a>00316     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l00317"></a>00317         <a class="code" href="../../d7/dba/structIdAdtTemplate.html">IdAdtTemplate</a> *iat = (<a class="code" href="../../d7/dba/structIdAdtTemplate.html">IdAdtTemplate</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00318"></a>00318         <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr = {{<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>}};
<a name="l00319"></a>00319         <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00320"></a>00320         
<a name="l00321"></a>00321         <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(&amp;iat-&gt;id, &amp;RNA_AnimData, iat-&gt;adt, &amp;ptr);
<a name="l00322"></a>00322         prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(&amp;ptr, <span class="stringliteral">&quot;action&quot;</span>);
<a name="l00323"></a>00323         
<a name="l00324"></a>00324         <a class="code" href="../../d8/db1/BKE__library_8h.html#a4d786d1f0b083fc9679d4801725f0ae4">id_single_user</a>(C, <span class="keywordtype">id</span>, &amp;ptr, prop);
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#acc5952c7446140a83a45c1bcec2e7be0">00328</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#acc5952c7446140a83a45c1bcec2e7be0">singleuser_world_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(scene), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330     <a class="code" href="../../d8/d7e/structID.html">ID</a> *<span class="keywordtype">id</span> = tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00331"></a>00331     
<a name="l00332"></a>00332     <span class="comment">/* need to use parent scene not just scene, otherwise may end up getting wrong one */</span>
<a name="l00333"></a>00333     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {
<a name="l00334"></a>00334         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *parscene = (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00335"></a>00335         <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr = {{<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>}};
<a name="l00336"></a>00336         <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00337"></a>00337         
<a name="l00338"></a>00338         <a class="code" href="../../d3/d10/rna__access_8c.html#a2ce5c1d9b520b00730820e0e118dd4e1">RNA_id_pointer_create</a>(&amp;parscene-&gt;id, &amp;ptr);
<a name="l00339"></a>00339         prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(&amp;ptr, <span class="stringliteral">&quot;world&quot;</span>);
<a name="l00340"></a>00340         
<a name="l00341"></a>00341         <a class="code" href="../../d8/db1/BKE__library_8h.html#a4d786d1f0b083fc9679d4801725f0ae4">id_single_user</a>(C, <span class="keywordtype">id</span>, &amp;ptr, prop);
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9ce8a26b4a0ee97b6e74cb2a8542f338">00345</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9ce8a26b4a0ee97b6e74cb2a8542f338">group_linkobs2scene_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tsep), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00346"></a>00346 {
<a name="l00347"></a>00347     <a class="code" href="../../d4/d91/structGroup.html">Group</a> *group= (<a class="code" href="../../d4/d91/structGroup.html">Group</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00348"></a>00348     <a class="code" href="../../d3/d3b/structGroupObject.html">GroupObject</a> *gob;
<a name="l00349"></a>00349     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00350"></a>00350     
<a name="l00351"></a>00351     for (gob=group-&gt;<a class="code" href="../../d4/d91/structGroup.html#ad757bf69b6fd15b1d4e0980089d13be1">gobject</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; gob; gob=gob-&gt;next) {
<a name="l00352"></a>00352         base= <a class="code" href="../../d8/d53/BKE__scene_8h.html#af038ab52dca2267b6418721c13b81e74">object_in_scene</a>(gob-&gt;ob, scene);
<a name="l00353"></a>00353         <span class="keywordflow">if</span> (base) {
<a name="l00354"></a>00354             base-&gt;object-&gt;flag |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00355"></a>00355             base-&gt;flag |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00356"></a>00356         }
<a name="l00357"></a>00357         <span class="keywordflow">else</span> {
<a name="l00358"></a>00358             <span class="comment">/* link to scene */</span>
<a name="l00359"></a>00359             base= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>( <span class="keyword">sizeof</span>(<a class="code" href="../../d3/da9/structBase.html">Base</a>), <span class="stringliteral">&quot;add_base&quot;</span>);
<a name="l00360"></a>00360             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#ab5b5ec121d2522c0e8e74e01d6517feb">BLI_addhead</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a21ace55307d1ca141e265b3f55fa37d9">base</a>, base);
<a name="l00361"></a>00361             base-&gt;lay= (1&lt;&lt;20)-1; <span class="comment">/*v3d-&gt;lay;*/</span> <span class="comment">/* would be nice to use the 3d layer but the include&#39;s not here */</span>
<a name="l00362"></a>00362             gob-&gt;ob-&gt;flag |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00363"></a>00363             base-&gt;flag = gob-&gt;ob-&gt;flag;
<a name="l00364"></a>00364             base-&gt;object= gob-&gt;ob;
<a name="l00365"></a>00365             <a class="code" href="../../d8/db1/BKE__library_8h.html#a43e37bd819b3a44520ff6fbfd9e8962d">id_lib_extern</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)gob-&gt;ob); <span class="comment">/* in case these are from a linked group */</span>
<a name="l00366"></a>00366         }
<a name="l00367"></a>00367     }
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#ac9f36184c4717a9b940ea72af31a5cbd">00370</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene_act, <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb, 
<a name="l00371"></a>00371                                   <span class="keywordtype">void</span> (*operation_cb)(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *))
<a name="l00372"></a>00372 {
<a name="l00373"></a>00373     <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te;
<a name="l00374"></a>00374     <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem;
<a name="l00375"></a>00375     
<a name="l00376"></a>00376     <span class="keywordflow">for</span> (te=lb-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; te; te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#af4294bd483fda182e33ddd33ad757581">next</a>) {
<a name="l00377"></a>00377         tselem= <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te);
<a name="l00378"></a>00378         <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a104426a340d0c42828c65f86ed21dd80">flag</a> &amp; <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>) {
<a name="l00379"></a>00379             <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a>==0 &amp;&amp; te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a4cef745e1603ebb380601d64bca9e8bd">idcode</a>==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#a1f263dac7c79853c097b8ebde25cb0c1">ID_OB</a>) {
<a name="l00380"></a>00380                 <span class="comment">// when objects selected in other scenes... dunno if that should be allowed</span>
<a name="l00381"></a>00381                 <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene_owner= (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)<a class="code" href="../../df/def/outliner__intern_8h.html#ad0e15ec55be8a79bcc305f926d84c8d9">outliner_search_back</a>(soops, te, <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac2b425dbd1f73ad1720fafad2626d974">ID_SCE</a>);
<a name="l00382"></a>00382                 <span class="keywordflow">if</span> (scene_owner &amp;&amp; scene_act != scene_owner) {
<a name="l00383"></a>00383                     <a class="code" href="../../d1/d12/ED__screen_8h.html#a9f5966663a764f73d1c95182c9ded365">ED_screen_set_scene</a>(C, <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), scene_owner);
<a name="l00384"></a>00384                 }
<a name="l00385"></a>00385                 <span class="comment">/* important to use &#39;scene_owner&#39; not scene_act else deleting objects can crash.</span>
<a name="l00386"></a>00386 <span class="comment">                 * only use &#39;scene_act&#39; when &#39;scene_owner&#39; is NULL, which can happen when the</span>
<a name="l00387"></a>00387 <span class="comment">                 * outliner isn&#39;t showing scenes: Visible Layer draw mode for eg. */</span>
<a name="l00388"></a>00388                 operation_cb(C, scene_owner ? scene_owner : scene_act, te, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, tselem);
<a name="l00389"></a>00389             }
<a name="l00390"></a>00390         }
<a name="l00391"></a>00391         <span class="keywordflow">if</span> (<a class="code" href="../../df/def/outliner__intern_8h.html#ace613b13228d89a1db39371e551432af">TSELEM_OPEN</a>(tselem,soops)) {
<a name="l00392"></a>00392             <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene_act, soops, &amp;te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9d11a8301593c5ada35845e59ceb2853">subtree</a>, operation_cb);
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">/* ******************************************** */</span>
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a66ae4ee5b4efccdb177a807ce735d695">00399</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a66ae4ee5b4efccdb177a807ce735d695">unlinkact_animdata_cb</a>(<span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401     <span class="comment">/* just set action to NULL */</span>
<a name="l00402"></a>00402     <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a894e4c32b7cc4abe5cc3d1bc535b0749">BKE_animdata_set_action</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a34b8c06d907dfcea29c9e9f612c2dc06">00405</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a34b8c06d907dfcea29c9e9f612c2dc06">cleardrivers_animdata_cb</a>(<span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00406"></a>00406 {
<a name="l00407"></a>00407     <a class="code" href="../../d7/dba/structIdAdtTemplate.html">IdAdtTemplate</a> *iat = (<a class="code" href="../../d7/dba/structIdAdtTemplate.html">IdAdtTemplate</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00408"></a>00408     
<a name="l00409"></a>00409     <span class="comment">/* just free drivers - stored as a list of F-Curves */</span>
<a name="l00410"></a>00410     <a class="code" href="../../da/dba/BKE__fcurve_8h.html#ab62d82f0242ead6ce4d83cf4e5d26774">free_fcurves</a>(&amp;iat-&gt;<a class="code" href="../../d7/dba/structIdAdtTemplate.html#a579759a29be9c069044fd0e91faa7d33">adt</a>-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#aaca565f031ee1209087422d8a5d77769">drivers</a>);
<a name="l00411"></a>00411 }
<a name="l00412"></a>00412 
<a name="l00413"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a7deb741b625b782273b8e78d7ce15c31">00413</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a7deb741b625b782273b8e78d7ce15c31">refreshdrivers_animdata_cb</a>(<span class="keywordtype">int</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event), <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem)
<a name="l00414"></a>00414 {
<a name="l00415"></a>00415     <a class="code" href="../../d7/dba/structIdAdtTemplate.html">IdAdtTemplate</a> *iat = (<a class="code" href="../../d7/dba/structIdAdtTemplate.html">IdAdtTemplate</a> *)tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>;
<a name="l00416"></a>00416     <a class="code" href="../../d6/df2/structFCurve.html">FCurve</a> *fcu;
<a name="l00417"></a>00417     
<a name="l00418"></a>00418     <span class="comment">/* loop over drivers, performing refresh (i.e. check graph_buttons.c and rna_fcurve.c for details) */</span>
<a name="l00419"></a>00419     for (fcu = iat-&gt;<a class="code" href="../../d7/dba/structIdAdtTemplate.html#a579759a29be9c069044fd0e91faa7d33">adt</a>-&gt;<a class="code" href="../../d1/d5c/structAnimData.html#aaca565f031ee1209087422d8a5d77769">drivers</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; fcu; fcu= fcu-&gt;next) {
<a name="l00420"></a>00420         fcu-&gt;<a class="code" href="../../d6/df2/structFCurve.html#ad6eecd82ed24f053525b459881e405ea">flag</a> &amp;= ~<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#ac0aededd6dcdcaa6f2dcf7d0f812e464a08981f44fd5fba6615e561ed5d1c7d67">FCURVE_DISABLED</a>;
<a name="l00421"></a>00421         
<a name="l00422"></a>00422         <span class="keywordflow">if</span> (fcu-&gt;driver)
<a name="l00423"></a>00423             fcu-&gt;driver-&gt;flag &amp;= ~<a class="code" href="../../d5/ddb/DNA__anim__types_8h.html#aac7cb5ac3a18e0d26ee4bf5f22464a2fa199e1528ba0e102857fc8f1414057af6">DRIVER_FLAG_INVALID</a>;
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425 }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427 <span class="comment">/* --------------------------------- */</span>
<a name="l00428"></a>00428 
<a name="l00429"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a1906deb11b356009b02ffd5a4057c581">00429</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a1906deb11b356009b02ffd5a4057c581">pchan_cb</a>(<span class="keywordtype">int</span> event, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tselem))
<a name="l00430"></a>00430 {
<a name="l00431"></a>00431     <a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *pchan= (<a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *)te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#ac4c4f07fcb2ed46300b3f08bd47887b2">directdata</a>;
<a name="l00432"></a>00432     
<a name="l00433"></a>00433     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (event==1)
<a name="l00434"></a>00434         pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a31291bac57d8e3b0edaac489c94ed8b4">bone</a>-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> |= <a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00435"></a>00435     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==2)
<a name="l00436"></a>00436         pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a31291bac57d8e3b0edaac489c94ed8b4">bone</a>-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00437"></a>00437     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==3) {
<a name="l00438"></a>00438         pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a31291bac57d8e3b0edaac489c94ed8b4">bone</a>-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> |= <a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50ab23a8cde9f34efaef713308cc72166de">BONE_HIDDEN_P</a>;
<a name="l00439"></a>00439         pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a31291bac57d8e3b0edaac489c94ed8b4">bone</a>-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==4)
<a name="l00442"></a>00442         pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a31291bac57d8e3b0edaac489c94ed8b4">bone</a>-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50ab23a8cde9f34efaef713308cc72166de">BONE_HIDDEN_P</a>;
<a name="l00443"></a>00443 }
<a name="l00444"></a>00444 
<a name="l00445"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a42f941ea21c74e958cefa461bec67673">00445</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a42f941ea21c74e958cefa461bec67673">bone_cb</a>(<span class="keywordtype">int</span> event, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tselem))
<a name="l00446"></a>00446 {
<a name="l00447"></a>00447     <a class="code" href="../../de/de0/structBone.html">Bone</a> *bone= (<a class="code" href="../../de/de0/structBone.html">Bone</a> *)te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#ac4c4f07fcb2ed46300b3f08bd47887b2">directdata</a>;
<a name="l00448"></a>00448     
<a name="l00449"></a>00449     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (event==1)
<a name="l00450"></a>00450         bone-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> |= <a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00451"></a>00451     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==2)
<a name="l00452"></a>00452         bone-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00453"></a>00453     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==3) {
<a name="l00454"></a>00454         bone-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> |= <a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50ab23a8cde9f34efaef713308cc72166de">BONE_HIDDEN_P</a>;
<a name="l00455"></a>00455         bone-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00456"></a>00456     }
<a name="l00457"></a>00457     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==4)
<a name="l00458"></a>00458         bone-&gt;<a class="code" href="../../de/de0/structBone.html#a5b5e463a4ba414686cfe2954ada482fb">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50ab23a8cde9f34efaef713308cc72166de">BONE_HIDDEN_P</a>;
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a4d5dc91017fbf9261524edaf743b9d99">00461</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a4d5dc91017fbf9261524edaf743b9d99">ebone_cb</a>(<span class="keywordtype">int</span> event, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tselem))
<a name="l00462"></a>00462 {
<a name="l00463"></a>00463     <a class="code" href="../../da/d29/structEditBone.html">EditBone</a> *ebone= (<a class="code" href="../../da/d29/structEditBone.html">EditBone</a> *)te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#ac4c4f07fcb2ed46300b3f08bd47887b2">directdata</a>;
<a name="l00464"></a>00464     
<a name="l00465"></a>00465     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (event==1)
<a name="l00466"></a>00466         ebone-&gt;<a class="code" href="../../da/d29/structEditBone.html#a6c7db9597e20d97ea4ae61eaacdc41fe">flag</a> |= <a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00467"></a>00467     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==2)
<a name="l00468"></a>00468         ebone-&gt;<a class="code" href="../../da/d29/structEditBone.html#a6c7db9597e20d97ea4ae61eaacdc41fe">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>;
<a name="l00469"></a>00469     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==3) {
<a name="l00470"></a>00470         ebone-&gt;<a class="code" href="../../da/d29/structEditBone.html#a6c7db9597e20d97ea4ae61eaacdc41fe">flag</a> |= <a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a5dcf60e8cd1c7c56a906d7a01fc01327">BONE_HIDDEN_A</a>;
<a name="l00471"></a>00471         ebone-&gt;<a class="code" href="../../da/d29/structEditBone.html#a6c7db9597e20d97ea4ae61eaacdc41fe">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a176833e258350f5e845cfb780a4c280c">BONE_SELECTED</a>|<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50abd540848fbcdcaf33141f6ce27766114">BONE_TIPSEL</a>|<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a0349b6b0b0156b6fb460e29f870bb443">BONE_ROOTSEL</a>;
<a name="l00472"></a>00472     }
<a name="l00473"></a>00473     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==4)
<a name="l00474"></a>00474         ebone-&gt;<a class="code" href="../../da/d29/structEditBone.html#a6c7db9597e20d97ea4ae61eaacdc41fe">flag</a> &amp;= ~<a class="code" href="../../d2/d93/DNA__armature__types_8h.html#ad26c2b448f0e416cffc8cd84065c3b50a5dcf60e8cd1c7c56a906d7a01fc01327">BONE_HIDDEN_A</a>;
<a name="l00475"></a>00475 }
<a name="l00476"></a>00476 
<a name="l00477"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#afca09a4710cace7dd0531bf509965b35">00477</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#afca09a4710cace7dd0531bf509965b35">sequence_cb</a>(<span class="keywordtype">int</span> event, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(tselem))
<a name="l00478"></a>00478 {
<a name="l00479"></a>00479 <span class="comment">//  Sequence *seq= (Sequence*) te-&gt;directdata;</span>
<a name="l00480"></a>00480     <span class="keywordflow">if</span> (event==1) {
<a name="l00481"></a>00481 <span class="comment">// XXX      select_single_seq(seq, 1);</span>
<a name="l00482"></a>00482     }
<a name="l00483"></a>00483 }
<a name="l00484"></a>00484 
<a name="l00485"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">00485</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(<a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops, <span class="keywordtype">int</span> type, <span class="keywordtype">int</span> event, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb, 
<a name="l00486"></a>00486                                          <span class="keywordtype">void</span> (*operation_cb)(<span class="keywordtype">int</span>, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *))
<a name="l00487"></a>00487 {
<a name="l00488"></a>00488     <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te;
<a name="l00489"></a>00489     <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem;
<a name="l00490"></a>00490     
<a name="l00491"></a>00491     <span class="keywordflow">for</span> (te=lb-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; te; te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#af4294bd483fda182e33ddd33ad757581">next</a>) {
<a name="l00492"></a>00492         tselem= <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te);
<a name="l00493"></a>00493         <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a104426a340d0c42828c65f86ed21dd80">flag</a> &amp; <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>) {
<a name="l00494"></a>00494             <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a>==type) {
<a name="l00495"></a>00495                 operation_cb(event, te, tselem);
<a name="l00496"></a>00496             }
<a name="l00497"></a>00497         }
<a name="l00498"></a>00498         <span class="keywordflow">if</span> (<a class="code" href="../../df/def/outliner__intern_8h.html#ace613b13228d89a1db39371e551432af">TSELEM_OPEN</a>(tselem,soops)) {
<a name="l00499"></a>00499             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, type, event, &amp;te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9d11a8301593c5ada35845e59ceb2853">subtree</a>, operation_cb);
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502 }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="comment">/* **************************************** */</span>
<a name="l00505"></a>00505 
<a name="l00506"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9ed5b2fbe5913871f9afa993ce68fc0e">00506</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9ed5b2fbe5913871f9afa993ce68fc0e">prop_object_op_types</a>[] = {
<a name="l00507"></a>00507     {1, <span class="stringliteral">&quot;SELECT&quot;</span>, 0, <span class="stringliteral">&quot;Select&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00508"></a>00508     {2, <span class="stringliteral">&quot;DESELECT&quot;</span>, 0, <span class="stringliteral">&quot;Deselect&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00509"></a>00509     {4, <span class="stringliteral">&quot;DELETE&quot;</span>, 0, <span class="stringliteral">&quot;Delete&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00510"></a>00510     {6, <span class="stringliteral">&quot;TOGVIS&quot;</span>, 0, <span class="stringliteral">&quot;Toggle Visible&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00511"></a>00511     {7, <span class="stringliteral">&quot;TOGSEL&quot;</span>, 0, <span class="stringliteral">&quot;Toggle Selectable&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00512"></a>00512     {8, <span class="stringliteral">&quot;TOGREN&quot;</span>, 0, <span class="stringliteral">&quot;Toggle Renderable&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00513"></a>00513     {9, <span class="stringliteral">&quot;RENAME&quot;</span>, 0, <span class="stringliteral">&quot;Rename&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00514"></a>00514     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00515"></a>00515 };
<a name="l00516"></a>00516 
<a name="l00517"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#ac54731ebdceab2c257eb90269ea6b5a2">00517</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ac54731ebdceab2c257eb90269ea6b5a2">outliner_object_operation_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00518"></a>00518 {
<a name="l00519"></a>00519     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l00520"></a>00520     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00521"></a>00521     <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops= <a class="code" href="../../df/d01/BKE__context_8h.html#a757b3be66ff99f2d3f92e0486c3eb381">CTX_wm_space_outliner</a>(C);
<a name="l00522"></a>00522     <span class="keywordtype">int</span> event;
<a name="l00523"></a>00523     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00524"></a>00524     
<a name="l00525"></a>00525     <span class="comment">/* check for invalid states */</span>
<a name="l00526"></a>00526     <span class="keywordflow">if</span> (soops == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00527"></a>00527         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00528"></a>00528     
<a name="l00529"></a>00529     <span class="keyword">event</span>= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     <span class="keywordflow">if</span> (event==1) {
<a name="l00532"></a>00532         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce= scene;  <span class="comment">// to be able to delete, scenes are set...</span>
<a name="l00533"></a>00533         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a510900be82abe028c2f53686b890e0c7">object_select_cb</a>);
<a name="l00534"></a>00534         <span class="keywordflow">if</span> (scene != sce) {
<a name="l00535"></a>00535             <a class="code" href="../../d1/d12/ED__screen_8h.html#a9f5966663a764f73d1c95182c9ded365">ED_screen_set_scene</a>(C, <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), sce);
<a name="l00536"></a>00536         }
<a name="l00537"></a>00537         
<a name="l00538"></a>00538         str= <span class="stringliteral">&quot;Select Objects&quot;</span>;
<a name="l00539"></a>00539         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a59ea6c7f4b5448c4c4912e8893a031f4">ND_OB_SELECT</a>, scene);
<a name="l00540"></a>00540     }
<a name="l00541"></a>00541     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==2) {
<a name="l00542"></a>00542         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a148519f04b4fb775d50dff4ffe09dbe5">object_deselect_cb</a>);
<a name="l00543"></a>00543         str= <span class="stringliteral">&quot;Deselect Objects&quot;</span>;
<a name="l00544"></a>00544         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a59ea6c7f4b5448c4c4912e8893a031f4">ND_OB_SELECT</a>, scene);
<a name="l00545"></a>00545     }
<a name="l00546"></a>00546     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==4) {
<a name="l00547"></a>00547         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aa65889012be847263cc0010baad68395">object_delete_cb</a>);
<a name="l00548"></a>00548 
<a name="l00549"></a>00549         <span class="comment">/* XXX: tree management normally happens from draw_outliner(), but when</span>
<a name="l00550"></a>00550 <span class="comment">         *      you&#39;re clicking to fast on Delete object from context menu in</span>
<a name="l00551"></a>00551 <span class="comment">         *      outliner several mouse events can be handled in one cycle without</span>
<a name="l00552"></a>00552 <span class="comment">         *      handling notifiers/redraw which leads to deleting the same object twice.</span>
<a name="l00553"></a>00553 <span class="comment">         *      cleanup tree here to prevent such cases. */</span>
<a name="l00554"></a>00554         <a class="code" href="../../df/def/outliner__intern_8h.html#af856ca315c9e809fbd0389e42560ab44">outliner_cleanup_tree</a>(soops);
<a name="l00555"></a>00555 
<a name="l00556"></a>00556         <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a1916587a9ec19eb3543b1c1bc54a8ded">DAG_scene_sort</a>(bmain, scene);
<a name="l00557"></a>00557         str= <span class="stringliteral">&quot;Delete Objects&quot;</span>;
<a name="l00558"></a>00558         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a2072407a0c536bf373bd0b6b7c159c5c">ND_OB_ACTIVE</a>, scene);
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==5) {    <span class="comment">/* disabled, see above enum (ton) */</span>
<a name="l00561"></a>00561         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a36f2087f36aa3d79e495aaf476713352">id_local_cb</a>);
<a name="l00562"></a>00562         str= <span class="stringliteral">&quot;Localized Objects&quot;</span>;
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==6) {
<a name="l00565"></a>00565         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#a54c9f8ff242dff447d0cff0b912bc270">object_toggle_visibility_cb</a>);
<a name="l00566"></a>00566         str= <span class="stringliteral">&quot;Toggle Visibility&quot;</span>;
<a name="l00567"></a>00567         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a68804434f856105d55ed44db0225cbca">ND_OB_VISIBLE</a>, scene);
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==7) {
<a name="l00570"></a>00570         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#ae493cf0f32be9c66c631f1c0fd3c2b85">object_toggle_selectability_cb</a>);
<a name="l00571"></a>00571         str= <span class="stringliteral">&quot;Toggle Selectability&quot;</span>;
<a name="l00572"></a>00572         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a59ea6c7f4b5448c4c4912e8893a031f4">ND_OB_SELECT</a>, scene);
<a name="l00573"></a>00573     }
<a name="l00574"></a>00574     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==8) {
<a name="l00575"></a>00575         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#a8f7b5814b22e656f9309b1526bf395ea">object_toggle_renderability_cb</a>);
<a name="l00576"></a>00576         str= <span class="stringliteral">&quot;Toggle Renderability&quot;</span>;
<a name="l00577"></a>00577         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#aabc832153f8f4f494a023ff88505726d">ND_OB_RENDER</a>, scene);
<a name="l00578"></a>00578     }
<a name="l00579"></a>00579     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==9) {
<a name="l00580"></a>00580         <a class="code" href="../../df/def/outliner__intern_8h.html#a743ff51839c0eafd98cecc1a26d688e6">outliner_do_object_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#abba05c035fa46cf9f968ad353a7681a7">item_rename_cb</a>);
<a name="l00581"></a>00581         str= <span class="stringliteral">&quot;Rename Object&quot;</span>;
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, str);
<a name="l00585"></a>00585     
<a name="l00586"></a>00586     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00587"></a>00587 }
<a name="l00588"></a>00588 
<a name="l00589"></a>00589 
<a name="l00590"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a11446b247311b70a42df21ada0c62e78">00590</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#aa05d0408573851ea1f1e13a3d5dec1ba">OUTLINER_OT_object_operation</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00591"></a>00591 {
<a name="l00592"></a>00592     <span class="comment">/* identifiers */</span>
<a name="l00593"></a>00593     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Outliner Object Operation&quot;</span>;
<a name="l00594"></a>00594     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;OUTLINER_OT_object_operation&quot;</span>;
<a name="l00595"></a>00595     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00596"></a>00596     
<a name="l00597"></a>00597     <span class="comment">/* callbacks */</span>
<a name="l00598"></a>00598     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l00599"></a>00599     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ac54731ebdceab2c257eb90269ea6b5a2">outliner_object_operation_exec</a>;
<a name="l00600"></a>00600     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>;
<a name="l00601"></a>00601     
<a name="l00602"></a>00602     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_object_op_types, 0, <span class="stringliteral">&quot;Object Operation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00605"></a>00605 }
<a name="l00606"></a>00606 
<a name="l00607"></a>00607 <span class="comment">/* **************************************** */</span>
<a name="l00608"></a>00608 
<a name="l00609"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a42019a9dd75bca04fbfa0db3c2bdf219">00609</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a42019a9dd75bca04fbfa0db3c2bdf219">prop_group_op_types</a>[] = {
<a name="l00610"></a>00610     {1, <span class="stringliteral">&quot;UNLINK&quot;</span>, 0, <span class="stringliteral">&quot;Unlink&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00611"></a>00611     {2, <span class="stringliteral">&quot;LOCAL&quot;</span>, 0, <span class="stringliteral">&quot;Make Local&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00612"></a>00612     {3, <span class="stringliteral">&quot;LINK&quot;</span>, 0, <span class="stringliteral">&quot;Link Group Objects to Scene&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00613"></a>00613     {4, <span class="stringliteral">&quot;TOGVIS&quot;</span>, 0, <span class="stringliteral">&quot;Toggle Visible&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00614"></a>00614     {5, <span class="stringliteral">&quot;TOGSEL&quot;</span>, 0, <span class="stringliteral">&quot;Toggle Selectable&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00615"></a>00615     {6, <span class="stringliteral">&quot;TOGREN&quot;</span>, 0, <span class="stringliteral">&quot;Toggle Renderable&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00616"></a>00616     {7, <span class="stringliteral">&quot;RENAME&quot;</span>, 0, <span class="stringliteral">&quot;Rename&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00617"></a>00617     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00618"></a>00618 };
<a name="l00619"></a>00619 
<a name="l00620"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae9cd975a5c3de783cf3b9b2e0bcb79d6">00620</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae9cd975a5c3de783cf3b9b2e0bcb79d6">outliner_group_operation_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00621"></a>00621 {
<a name="l00622"></a>00622     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00623"></a>00623     <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops= <a class="code" href="../../df/d01/BKE__context_8h.html#a757b3be66ff99f2d3f92e0486c3eb381">CTX_wm_space_outliner</a>(C);
<a name="l00624"></a>00624     <span class="keywordtype">int</span> event;
<a name="l00625"></a>00625     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00626"></a>00626     
<a name="l00627"></a>00627     <span class="comment">/* check for invalid states */</span>
<a name="l00628"></a>00628     <span class="keywordflow">if</span> (soops == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00629"></a>00629         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00630"></a>00630     
<a name="l00631"></a>00631     <span class="keyword">event</span>= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l00632"></a>00632     
<a name="l00633"></a>00633     <span class="keywordflow">if</span> (event==1) {
<a name="l00634"></a>00634         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a5af0714d49337d2906c4127e7bb6e978">unlink_group_cb</a>);
<a name="l00635"></a>00635         str= <span class="stringliteral">&quot;Unlink group&quot;</span>;
<a name="l00636"></a>00636     }
<a name="l00637"></a>00637     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==2) {
<a name="l00638"></a>00638         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a36f2087f36aa3d79e495aaf476713352">id_local_cb</a>);
<a name="l00639"></a>00639         str= <span class="stringliteral">&quot;Localized Data&quot;</span>;
<a name="l00640"></a>00640     }
<a name="l00641"></a>00641     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==3) {
<a name="l00642"></a>00642         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9ce8a26b4a0ee97b6e74cb2a8542f338">group_linkobs2scene_cb</a>);
<a name="l00643"></a>00643         str= <span class="stringliteral">&quot;Link Group Objects to Scene&quot;</span>;
<a name="l00644"></a>00644     }
<a name="l00645"></a>00645     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==4) {
<a name="l00646"></a>00646         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#a272bfcb900afcc12cb6869afa0d220ba">group_toggle_visibility_cb</a>);
<a name="l00647"></a>00647         str= <span class="stringliteral">&quot;Toggle Visibility&quot;</span>;
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==5) {
<a name="l00650"></a>00650         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#a9f69295208741e3b1144a78ce49cde45">group_toggle_selectability_cb</a>);
<a name="l00651"></a>00651         str= <span class="stringliteral">&quot;Toggle Selectability&quot;</span>;
<a name="l00652"></a>00652     }
<a name="l00653"></a>00653     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==6) {
<a name="l00654"></a>00654         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#a53477ab147772e58b46a4e9603a18c4f">group_toggle_renderability_cb</a>);
<a name="l00655"></a>00655         str= <span class="stringliteral">&quot;Toggle Renderability&quot;</span>;
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event==7) {
<a name="l00658"></a>00658         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#abba05c035fa46cf9f968ad353a7681a7">item_rename_cb</a>);
<a name="l00659"></a>00659         str= <span class="stringliteral">&quot;Rename&quot;</span>;
<a name="l00660"></a>00660     }
<a name="l00661"></a>00661     
<a name="l00662"></a>00662     
<a name="l00663"></a>00663     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, str);
<a name="l00664"></a>00664     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a6c8e772001142e55673ee490ce4c2b78">NC_GROUP</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00665"></a>00665     
<a name="l00666"></a>00666     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00667"></a>00667 }
<a name="l00668"></a>00668 
<a name="l00669"></a>00669 
<a name="l00670"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a65bc2711ba3d673b765bef5e9cec354e">00670</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#ade3f002d31ef0d55c6a4f60858048810">OUTLINER_OT_group_operation</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00671"></a>00671 {
<a name="l00672"></a>00672     <span class="comment">/* identifiers */</span>
<a name="l00673"></a>00673     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Outliner Group Operation&quot;</span>;
<a name="l00674"></a>00674     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;OUTLINER_OT_group_operation&quot;</span>;
<a name="l00675"></a>00675     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00676"></a>00676     
<a name="l00677"></a>00677     <span class="comment">/* callbacks */</span>
<a name="l00678"></a>00678     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l00679"></a>00679     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae9cd975a5c3de783cf3b9b2e0bcb79d6">outliner_group_operation_exec</a>;
<a name="l00680"></a>00680     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>;
<a name="l00681"></a>00681     
<a name="l00682"></a>00682     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l00683"></a>00683     
<a name="l00684"></a>00684     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_group_op_types, 0, <span class="stringliteral">&quot;Group Operation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 <span class="comment">/* **************************************** */</span>
<a name="l00688"></a>00688 
<a name="l00689"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896">00689</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896">eOutlinerIdOpTypes</a> {
<a name="l00690"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a2ca18f484a2b13975399b85000b77baf">00690</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a2ca18f484a2b13975399b85000b77baf">OUTLINER_IDOP_INVALID</a> = 0,
<a name="l00691"></a>00691     
<a name="l00692"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a2e4fe2d5b093d853703fa1b31c6b7a">00692</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a2e4fe2d5b093d853703fa1b31c6b7a">OUTLINER_IDOP_UNLINK</a>,
<a name="l00693"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896aa777294af819002c8a14b356252d2861">00693</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896aa777294af819002c8a14b356252d2861">OUTLINER_IDOP_LOCAL</a>,
<a name="l00694"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a11d12be625de94dc24199358fd1307df">00694</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a11d12be625de94dc24199358fd1307df">OUTLINER_IDOP_SINGLE</a>,
<a name="l00695"></a>00695     
<a name="l00696"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a99a494f452baf246dc0b0d0a736cc3">00696</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a99a494f452baf246dc0b0d0a736cc3">OUTLINER_IDOP_FAKE_ADD</a>,
<a name="l00697"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a48770523bee0caad3f4e03df1534fa26">00697</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a48770523bee0caad3f4e03df1534fa26">OUTLINER_IDOP_FAKE_CLEAR</a>,
<a name="l00698"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896adb3f9472004b6ab0617a56f023d7798f">00698</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896adb3f9472004b6ab0617a56f023d7798f">OUTLINER_IDOP_RENAME</a>
<a name="l00699"></a>00699 } <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896">eOutlinerIdOpTypes</a>;
<a name="l00700"></a>00700 
<a name="l00701"></a>00701 <span class="comment">// TODO: implement support for changing the ID-block used</span>
<a name="l00702"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9698626a8db86fca15cb7568cb354268">00702</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9698626a8db86fca15cb7568cb354268">prop_id_op_types</a>[] = {
<a name="l00703"></a>00703     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a2e4fe2d5b093d853703fa1b31c6b7a">OUTLINER_IDOP_UNLINK</a>, <span class="stringliteral">&quot;UNLINK&quot;</span>, 0, <span class="stringliteral">&quot;Unlink&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00704"></a>00704     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896aa777294af819002c8a14b356252d2861">OUTLINER_IDOP_LOCAL</a>, <span class="stringliteral">&quot;LOCAL&quot;</span>, 0, <span class="stringliteral">&quot;Make Local&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00705"></a>00705     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a11d12be625de94dc24199358fd1307df">OUTLINER_IDOP_SINGLE</a>, <span class="stringliteral">&quot;SINGLE&quot;</span>, 0, <span class="stringliteral">&quot;Make Single User&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00706"></a>00706     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a99a494f452baf246dc0b0d0a736cc3">OUTLINER_IDOP_FAKE_ADD</a>, <span class="stringliteral">&quot;ADD_FAKE&quot;</span>, 0, <span class="stringliteral">&quot;Add Fake User&quot;</span>, <span class="stringliteral">&quot;Ensure datablock gets saved even if it isn&#39;t in use (e.g. for motion and material libraries)&quot;</span>},
<a name="l00707"></a>00707     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a48770523bee0caad3f4e03df1534fa26">OUTLINER_IDOP_FAKE_CLEAR</a>, <span class="stringliteral">&quot;CLEAR_FAKE&quot;</span>, 0, <span class="stringliteral">&quot;Clear Fake User&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00708"></a>00708     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896adb3f9472004b6ab0617a56f023d7798f">OUTLINER_IDOP_RENAME</a>, <span class="stringliteral">&quot;RENAME&quot;</span>, 0, <span class="stringliteral">&quot;Rename&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00709"></a>00709     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00710"></a>00710 };
<a name="l00711"></a>00711 
<a name="l00712"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#adf7312960e3406cf427d535f2895cab4">00712</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#adf7312960e3406cf427d535f2895cab4">outliner_id_operation_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00713"></a>00713 {
<a name="l00714"></a>00714     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00715"></a>00715     <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops= <a class="code" href="../../df/d01/BKE__context_8h.html#a757b3be66ff99f2d3f92e0486c3eb381">CTX_wm_space_outliner</a>(C);
<a name="l00716"></a>00716     <span class="keywordtype">int</span> scenelevel=0, objectlevel=0, idlevel=0, datalevel=0;
<a name="l00717"></a>00717     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896">eOutlinerIdOpTypes</a> event;
<a name="l00718"></a>00718     
<a name="l00719"></a>00719     <span class="comment">/* check for invalid states */</span>
<a name="l00720"></a>00720     <span class="keywordflow">if</span> (soops == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00721"></a>00721         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00722"></a>00722     
<a name="l00723"></a>00723     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">set_operation_types</a>(soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, &amp;scenelevel, &amp;objectlevel, &amp;idlevel, &amp;datalevel);
<a name="l00724"></a>00724     
<a name="l00725"></a>00725     <span class="keyword">event</span>= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l00726"></a>00726     
<a name="l00727"></a>00727     <span class="keywordflow">switch</span> (event) {
<a name="l00728"></a>00728         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a2e4fe2d5b093d853703fa1b31c6b7a">OUTLINER_IDOP_UNLINK</a>:
<a name="l00729"></a>00729         {
<a name="l00730"></a>00730             <span class="comment">/* unlink datablock from its parent */</span>
<a name="l00731"></a>00731             <span class="keywordflow">switch</span> (idlevel) {
<a name="l00732"></a>00732                 <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a20fe08f8d0b2a4e6c0dbb2371aacadb0">ID_AC</a>:
<a name="l00733"></a>00733                     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a4925be944fb2827f747044cd6710bfaa">unlink_action_cb</a>);
<a name="l00734"></a>00734                     
<a name="l00735"></a>00735                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a1ae48304ab1b5da96c5319a62f9b3b80">ND_NLA_ACTCHANGE</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00736"></a>00736                     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Unlink action&quot;</span>);
<a name="l00737"></a>00737                     <span class="keywordflow">break</span>;
<a name="l00738"></a>00738                 <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#acf5020c901e2793a056ffca95ec8195a">ID_MA</a>:
<a name="l00739"></a>00739                     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aa3a567a681339760211c7cc3ce674f44">unlink_material_cb</a>);
<a name="l00740"></a>00740                     
<a name="l00741"></a>00741                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#acbf5a628954d73fabbcd6ee7996590a6">ND_OB_SHADING</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00742"></a>00742                     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Unlink material&quot;</span>);
<a name="l00743"></a>00743                     <span class="keywordflow">break</span>;
<a name="l00744"></a>00744                 <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#ac850344bf7854d7860b43adb1e65e228">ID_TE</a>:
<a name="l00745"></a>00745                     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a88a74922748522c33b056f90a4ea03ad">unlink_texture_cb</a>);
<a name="l00746"></a>00746                     
<a name="l00747"></a>00747                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#acbf5a628954d73fabbcd6ee7996590a6">ND_OB_SHADING</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00748"></a>00748                     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Unlink texture&quot;</span>);
<a name="l00749"></a>00749                     <span class="keywordflow">break</span>;
<a name="l00750"></a>00750                 <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>:
<a name="l00751"></a>00751                     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#abe1502aef8a52d98e30e3871e5c7fc5c">unlink_world_cb</a>);
<a name="l00752"></a>00752                     
<a name="l00753"></a>00753                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0792c1b48c7575e8da04a53df4ac5e69">ND_WORLD</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00754"></a>00754                     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Unlink world&quot;</span>);
<a name="l00755"></a>00755                     <span class="keywordflow">break</span>;
<a name="l00756"></a>00756                 <span class="keywordflow">default</span>:
<a name="l00757"></a>00757                     <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;Not Yet&quot;</span>);
<a name="l00758"></a>00758                     <span class="keywordflow">break</span>;
<a name="l00759"></a>00759             }
<a name="l00760"></a>00760         }
<a name="l00761"></a>00761             <span class="keywordflow">break</span>;
<a name="l00762"></a>00762             
<a name="l00763"></a>00763         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896aa777294af819002c8a14b356252d2861">OUTLINER_IDOP_LOCAL</a>:
<a name="l00764"></a>00764         {
<a name="l00765"></a>00765             <span class="comment">/* make local */</span>
<a name="l00766"></a>00766             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a36f2087f36aa3d79e495aaf476713352">id_local_cb</a>);
<a name="l00767"></a>00767             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Localized Data&quot;</span>);
<a name="l00768"></a>00768         }
<a name="l00769"></a>00769             <span class="keywordflow">break</span>;
<a name="l00770"></a>00770             
<a name="l00771"></a>00771         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a11d12be625de94dc24199358fd1307df">OUTLINER_IDOP_SINGLE</a>:
<a name="l00772"></a>00772         {
<a name="l00773"></a>00773             <span class="comment">/* make single user */</span>
<a name="l00774"></a>00774             <span class="keywordflow">switch</span> (idlevel) {
<a name="l00775"></a>00775                 <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a20fe08f8d0b2a4e6c0dbb2371aacadb0">ID_AC</a>:
<a name="l00776"></a>00776                     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a52e04f112176d9f4a98b5182ed18a2e7">singleuser_action_cb</a>);
<a name="l00777"></a>00777                     
<a name="l00778"></a>00778                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a1ae48304ab1b5da96c5319a62f9b3b80">ND_NLA_ACTCHANGE</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00779"></a>00779                     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Single-User Action&quot;</span>);
<a name="l00780"></a>00780                     <span class="keywordflow">break</span>;
<a name="l00781"></a>00781                     
<a name="l00782"></a>00782                 <span class="keywordflow">case</span> <a class="code" href="../../d3/dfb/DNA__ID_8h.html#aa1ab8c153d4a007f72d37a2106ecbfa0">ID_WO</a>:
<a name="l00783"></a>00783                     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#acc5952c7446140a83a45c1bcec2e7be0">singleuser_world_cb</a>);
<a name="l00784"></a>00784                     
<a name="l00785"></a>00785                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0792c1b48c7575e8da04a53df4ac5e69">ND_WORLD</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00786"></a>00786                     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Single-User World&quot;</span>);
<a name="l00787"></a>00787                     <span class="keywordflow">break</span>;
<a name="l00788"></a>00788                     
<a name="l00789"></a>00789                 <span class="keywordflow">default</span>:
<a name="l00790"></a>00790                     <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;Not Yet&quot;</span>);
<a name="l00791"></a>00791                     <span class="keywordflow">break</span>;
<a name="l00792"></a>00792             }
<a name="l00793"></a>00793         }
<a name="l00794"></a>00794             <span class="keywordflow">break</span>;
<a name="l00795"></a>00795             
<a name="l00796"></a>00796         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a1a99a494f452baf246dc0b0d0a736cc3">OUTLINER_IDOP_FAKE_ADD</a>:
<a name="l00797"></a>00797         {
<a name="l00798"></a>00798             <span class="comment">/* set fake user */</span>
<a name="l00799"></a>00799             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a58e8fd760c9bd70fe3765622da2149ab">id_fake_user_set_cb</a>);
<a name="l00800"></a>00800             
<a name="l00801"></a>00801             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a12ff8b13081ef1c126861ed65582f8fa">NC_ID</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00802"></a>00802             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Add Fake User&quot;</span>);
<a name="l00803"></a>00803         }
<a name="l00804"></a>00804             <span class="keywordflow">break</span>;
<a name="l00805"></a>00805             
<a name="l00806"></a>00806         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896a48770523bee0caad3f4e03df1534fa26">OUTLINER_IDOP_FAKE_CLEAR</a>:
<a name="l00807"></a>00807         {
<a name="l00808"></a>00808             <span class="comment">/* clear fake user */</span>
<a name="l00809"></a>00809             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae6dd1411479b25493103d44efd045de8">id_fake_user_clear_cb</a>);
<a name="l00810"></a>00810             
<a name="l00811"></a>00811             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a12ff8b13081ef1c126861ed65582f8fa">NC_ID</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00812"></a>00812             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Clear Fake User&quot;</span>);
<a name="l00813"></a>00813         }
<a name="l00814"></a>00814             <span class="keywordflow">break</span>;
<a name="l00815"></a>00815         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8adf329ff2e2c228410716979921a896adb3f9472004b6ab0617a56f023d7798f">OUTLINER_IDOP_RENAME</a>:
<a name="l00816"></a>00816         {
<a name="l00817"></a>00817             <span class="comment">/* rename */</span>
<a name="l00818"></a>00818             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#ae5efbbdff1b7945c75dd9fadf9bf2d15">outliner_do_libdata_operation</a>(C, scene, soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d3/d9e/outliner__edit_8c.html#abba05c035fa46cf9f968ad353a7681a7">item_rename_cb</a>);
<a name="l00819"></a>00819             
<a name="l00820"></a>00820             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a12ff8b13081ef1c126861ed65582f8fa">NC_ID</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00821"></a>00821             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Rename&quot;</span>);
<a name="l00822"></a>00822         }
<a name="l00823"></a>00823             <span class="keywordflow">break</span>;
<a name="l00824"></a>00824             
<a name="l00825"></a>00825         <span class="keywordflow">default</span>:
<a name="l00826"></a>00826             <span class="comment">// invalid - unhandled</span>
<a name="l00827"></a>00827             <span class="keywordflow">break</span>;
<a name="l00828"></a>00828     }
<a name="l00829"></a>00829     
<a name="l00830"></a>00830     <span class="comment">/* wrong notifier still... */</span>
<a name="l00831"></a>00831     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a12ff8b13081ef1c126861ed65582f8fa">NC_ID</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00832"></a>00832     
<a name="l00833"></a>00833     <span class="comment">// XXX: this is just so that outliner is always up to date </span>
<a name="l00834"></a>00834     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#af1c384817f70d0a752fc68681535fcc9">NC_SPACE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#af89de1656e97955a4c54b2ae3c1c5171">ND_SPACE_OUTLINER</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00835"></a>00835     
<a name="l00836"></a>00836     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00837"></a>00837 }
<a name="l00838"></a>00838 
<a name="l00839"></a>00839 
<a name="l00840"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#ac1ebb54fb5ebf670126deafd8c8f49d2">00840</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#a3890ae5192244efc504548cbe2e6fb27">OUTLINER_OT_id_operation</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00841"></a>00841 {
<a name="l00842"></a>00842     <span class="comment">/* identifiers */</span>
<a name="l00843"></a>00843     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Outliner ID data Operation&quot;</span>;
<a name="l00844"></a>00844     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;OUTLINER_OT_id_operation&quot;</span>;
<a name="l00845"></a>00845     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00846"></a>00846     
<a name="l00847"></a>00847     <span class="comment">/* callbacks */</span>
<a name="l00848"></a>00848     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l00849"></a>00849     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d5f/outliner__tools_8c.html#adf7312960e3406cf427d535f2895cab4">outliner_id_operation_exec</a>;
<a name="l00850"></a>00850     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>;
<a name="l00851"></a>00851     
<a name="l00852"></a>00852     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l00853"></a>00853     
<a name="l00854"></a>00854     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_id_op_types, 0, <span class="stringliteral">&quot;ID data Operation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00855"></a>00855 }
<a name="l00856"></a>00856 
<a name="l00857"></a>00857 <span class="comment">/* **************************************** */</span>
<a name="l00858"></a>00858 
<a name="l00859"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a683ad379f9aa8ab7fcfa1aa384556e35">00859</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a683ad379f9aa8ab7fcfa1aa384556e35">outliner_do_id_set_operation</a>(<a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops, <span class="keywordtype">int</span> type, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb, <a class="code" href="../../d8/d7e/structID.html">ID</a> *<a class="code" href="../../d8/d7e/structID.html#a96fb6af141bd029b29a0fe1fc69775d8">newid</a>,
<a name="l00860"></a>00860                                          <span class="keywordtype">void</span> (*operation_cb)(<a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *, <a class="code" href="../../d8/d7e/structID.html">ID</a> *))
<a name="l00861"></a>00861 {
<a name="l00862"></a>00862     <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te;
<a name="l00863"></a>00863     <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem;
<a name="l00864"></a>00864     
<a name="l00865"></a>00865     <span class="keywordflow">for</span> (te=lb-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; te; te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#af4294bd483fda182e33ddd33ad757581">next</a>) {
<a name="l00866"></a>00866         tselem= <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te);
<a name="l00867"></a>00867         <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a104426a340d0c42828c65f86ed21dd80">flag</a> &amp; <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>) {
<a name="l00868"></a>00868             <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a>==type) {
<a name="l00869"></a>00869                 <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep = <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a2531c368b60c64064a070e9f2888408d">parent</a>);
<a name="l00870"></a>00870                 operation_cb(te, tselem, tsep, newid);
<a name="l00871"></a>00871             }
<a name="l00872"></a>00872         }
<a name="l00873"></a>00873         <span class="keywordflow">if</span> (<a class="code" href="../../df/def/outliner__intern_8h.html#ace613b13228d89a1db39371e551432af">TSELEM_OPEN</a>(tselem,soops)) {
<a name="l00874"></a>00874             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a683ad379f9aa8ab7fcfa1aa384556e35">outliner_do_id_set_operation</a>(soops, type, &amp;te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9d11a8301593c5ada35845e59ceb2853">subtree</a>, newid, operation_cb);
<a name="l00875"></a>00875         }
<a name="l00876"></a>00876     }
<a name="l00877"></a>00877 }
<a name="l00878"></a>00878 
<a name="l00879"></a>00879 <span class="comment">/* ------------------------------------------ */</span>
<a name="l00880"></a>00880 
<a name="l00881"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a25ac731e9e57b20e750d7e6ebcc1522d">00881</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a25ac731e9e57b20e750d7e6ebcc1522d">actionset_id_cb</a>(<a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(te), <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem, <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tsep, <a class="code" href="../../d8/d7e/structID.html">ID</a> *actId)
<a name="l00882"></a>00882 {
<a name="l00883"></a>00883     <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *act = (<a class="code" href="../../d1/d48/structbAction.html">bAction</a> *)actId;
<a name="l00884"></a>00884     
<a name="l00885"></a>00885     <span class="keywordflow">if</span> (tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a> == <a class="code" href="../../df/def/outliner__intern_8h.html#aa5ab0ee486c33393877990902b4054d1">TSE_ANIM_DATA</a>) {
<a name="l00886"></a>00886         <span class="comment">/* &quot;animation&quot; entries - action is child of this */</span>
<a name="l00887"></a>00887         <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a894e4c32b7cc4abe5cc3d1bc535b0749">BKE_animdata_set_action</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, act);
<a name="l00888"></a>00888     }
<a name="l00889"></a>00889     <span class="comment">/* TODO: if any other &quot;expander&quot; channels which own actions need to support this menu, </span>
<a name="l00890"></a>00890 <span class="comment">     * add: tselem-&gt;type = ...</span>
<a name="l00891"></a>00891 <span class="comment">     */</span>
<a name="l00892"></a>00892     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tsep &amp;&amp; (tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#ad2d5548ad1b676fedbde7e0bf110d3cd">type</a> == <a class="code" href="../../df/def/outliner__intern_8h.html#aa5ab0ee486c33393877990902b4054d1">TSE_ANIM_DATA</a>)) {
<a name="l00893"></a>00893         <span class="comment">/* &quot;animation&quot; entries case again */</span>
<a name="l00894"></a>00894         <a class="code" href="../../dc/d51/BKE__animsys_8h.html#a894e4c32b7cc4abe5cc3d1bc535b0749">BKE_animdata_set_action</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, tsep-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a2c7bc60159a1dc474327527b72e50483">id</a>, act);
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896     <span class="comment">// TODO: other cases not supported yet</span>
<a name="l00897"></a>00897 }
<a name="l00898"></a>00898 
<a name="l00899"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2e0ee371cf5584b1b989efabf00380a9">00899</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2e0ee371cf5584b1b989efabf00380a9">outliner_action_set_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00900"></a>00900 {
<a name="l00901"></a>00901     <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops= <a class="code" href="../../df/d01/BKE__context_8h.html#a757b3be66ff99f2d3f92e0486c3eb381">CTX_wm_space_outliner</a>(C);
<a name="l00902"></a>00902     <span class="keywordtype">int</span> scenelevel=0, objectlevel=0, idlevel=0, datalevel=0;
<a name="l00903"></a>00903     
<a name="l00904"></a>00904     <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *act;
<a name="l00905"></a>00905     
<a name="l00906"></a>00906     <span class="comment">/* check for invalid states */</span>
<a name="l00907"></a>00907     <span class="keywordflow">if</span> (soops == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00908"></a>00908         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00909"></a>00909     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">set_operation_types</a>(soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, &amp;scenelevel, &amp;objectlevel, &amp;idlevel, &amp;datalevel);
<a name="l00910"></a>00910     
<a name="l00911"></a>00911     <span class="comment">/* get action to use */</span>
<a name="l00912"></a>00912     act= <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a09f13df59d10774f0bcf69a054f9d865">BLI_findlink</a>(&amp;<a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C)-&gt;action, <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;action&quot;</span>));
<a name="l00913"></a>00913     
<a name="l00914"></a>00914     <span class="keywordflow">if</span> (act == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00915"></a>00915         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;No valid Action to add&quot;</span>);
<a name="l00916"></a>00916         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00917"></a>00917     }
<a name="l00918"></a>00918     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act-&gt;<a class="code" href="../../d1/d48/structbAction.html#ae1a06e3eae33f2a10deaa28a62c3997a">idroot</a> == 0) {
<a name="l00919"></a>00919         <span class="comment">/* hopefully in this case (i.e. library of userless actions), the user knows what they&#39;re doing... */</span>
<a name="l00920"></a>00920         <a class="code" href="../../d2/d40/BKE__report_8h.html#af25c247b3b620d13cef87ec2bed1698e">BKE_reportf</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>,
<a name="l00921"></a>00921             <span class="stringliteral">&quot;Action &#39;%s&#39; does not specify what datablocks it can be used on. Try setting the &#39;ID Root Type&#39; setting from the Datablocks Editor for this Action to avoid future problems&quot;</span>,
<a name="l00922"></a>00922             act-&gt;<a class="code" href="../../d1/d48/structbAction.html#ad0f2d8efde1fdd4f81ee9fe471313bd6">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l00923"></a>00923     }
<a name="l00924"></a>00924     
<a name="l00925"></a>00925     <span class="comment">/* perform action if valid channel */</span>
<a name="l00926"></a>00926     <span class="keywordflow">if</span> (datalevel == <a class="code" href="../../df/def/outliner__intern_8h.html#aa5ab0ee486c33393877990902b4054d1">TSE_ANIM_DATA</a>)
<a name="l00927"></a>00927         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a683ad379f9aa8ab7fcfa1aa384556e35">outliner_do_id_set_operation</a>(soops, datalevel, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, (<a class="code" href="../../d8/d7e/structID.html">ID</a>*)act, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a25ac731e9e57b20e750d7e6ebcc1522d">actionset_id_cb</a>);
<a name="l00928"></a>00928     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idlevel == <a class="code" href="../../d3/dfb/DNA__ID_8h.html#a20fe08f8d0b2a4e6c0dbb2371aacadb0">ID_AC</a>)
<a name="l00929"></a>00929         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a683ad379f9aa8ab7fcfa1aa384556e35">outliner_do_id_set_operation</a>(soops, idlevel, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, (<a class="code" href="../../d8/d7e/structID.html">ID</a>*)act, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a25ac731e9e57b20e750d7e6ebcc1522d">actionset_id_cb</a>);
<a name="l00930"></a>00930     <span class="keywordflow">else</span>
<a name="l00931"></a>00931         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00932"></a>00932         
<a name="l00933"></a>00933     <span class="comment">/* set notifier that things have changed */</span>
<a name="l00934"></a>00934     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a1ae48304ab1b5da96c5319a62f9b3b80">ND_NLA_ACTCHANGE</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00935"></a>00935     <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Set action&quot;</span>);
<a name="l00936"></a>00936     
<a name="l00937"></a>00937     <span class="comment">/* done */</span>
<a name="l00938"></a>00938     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00939"></a>00939 }
<a name="l00940"></a>00940 
<a name="l00941"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a616b1c5f1a3e5cfb479100420e1ff6e5">00941</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#a21c477ca1a188c24c8dfce0480c9bcf6">OUTLINER_OT_action_set</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00942"></a>00942 {
<a name="l00943"></a>00943     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l00944"></a>00944 
<a name="l00945"></a>00945     <span class="comment">/* identifiers */</span>
<a name="l00946"></a>00946     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Outliner Set Action&quot;</span>;
<a name="l00947"></a>00947     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;OUTLINER_OT_action_set&quot;</span>;
<a name="l00948"></a>00948     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Change the active action used&quot;</span>;
<a name="l00949"></a>00949     
<a name="l00950"></a>00950     <span class="comment">/* api callbacks */</span>
<a name="l00951"></a>00951     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a7fed5b2a4bd4179895d2e90c882ca3dd">WM_enum_search_invoke</a>;
<a name="l00952"></a>00952     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2e0ee371cf5584b1b989efabf00380a9">outliner_action_set_exec</a>;
<a name="l00953"></a>00953     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>;
<a name="l00954"></a>00954     
<a name="l00955"></a>00955     <span class="comment">/* flags */</span>
<a name="l00956"></a>00956     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l00957"></a>00957     
<a name="l00958"></a>00958     <span class="comment">/* props */</span>
<a name="l00959"></a>00959         <span class="comment">// TODO: this would be nicer as an ID-pointer...</span>
<a name="l00960"></a>00960     prop= <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;action&quot;</span>, <a class="code" href="../../d3/d10/rna__access_8c.html#abf24cbff0dda06cfad896088d53288fe">DummyRNA_NULL_items</a>, 0, <span class="stringliteral">&quot;Action&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00961"></a>00961     <a class="code" href="../../dc/d7e/rna__define_8c.html#adb30c6a3157cbd3193ff1a8de159389f">RNA_def_enum_funcs</a>(prop, <a class="code" href="../../d5/d68/RNA__enum__types_8h.html#a3aa4b2de944c849160ea793110442830">RNA_action_itemf</a>);
<a name="l00962"></a>00962     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = prop;
<a name="l00963"></a>00963 }
<a name="l00964"></a>00964 
<a name="l00965"></a>00965 <span class="comment">/* **************************************** */</span>
<a name="l00966"></a>00966 
<a name="l00967"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5c">00967</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5c">eOutliner_AnimDataOps</a> {
<a name="l00968"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca2ed13626e9811dd19ec281f07290ece2">00968</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca2ed13626e9811dd19ec281f07290ece2">OUTLINER_ANIMOP_INVALID</a> = 0,
<a name="l00969"></a>00969     
<a name="l00970"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cadbccd95346b22ef44f225e751a45cf48">00970</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cadbccd95346b22ef44f225e751a45cf48">OUTLINER_ANIMOP_SET_ACT</a>,
<a name="l00971"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cad5e079e803ef186b0968676ebb04a858">00971</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cad5e079e803ef186b0968676ebb04a858">OUTLINER_ANIMOP_CLEAR_ACT</a>,
<a name="l00972"></a>00972     
<a name="l00973"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9d142eddee5f1134418becef5a1e3200">00973</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9d142eddee5f1134418becef5a1e3200">OUTLINER_ANIMOP_REFRESH_DRV</a>,
<a name="l00974"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9816d4b915f71d52bafe5e08edb678ea">00974</a>     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9816d4b915f71d52bafe5e08edb678ea">OUTLINER_ANIMOP_CLEAR_DRV</a>
<a name="l00975"></a>00975     
<a name="l00976"></a>00976     <span class="comment">//OUTLINER_ANIMOP_COPY_DRIVERS,</span>
<a name="l00977"></a>00977     <span class="comment">//OUTLINER_ANIMOP_PASTE_DRIVERS</span>
<a name="l00978"></a>00978 } <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5c">eOutliner_AnimDataOps</a>;
<a name="l00979"></a>00979 
<a name="l00980"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a7afaf65ce5e414f1d8b033c6b6ceb96f">00980</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a7afaf65ce5e414f1d8b033c6b6ceb96f">prop_animdata_op_types</a>[] = {
<a name="l00981"></a>00981     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cadbccd95346b22ef44f225e751a45cf48">OUTLINER_ANIMOP_SET_ACT</a>, <span class="stringliteral">&quot;SET_ACT&quot;</span>, 0, <span class="stringliteral">&quot;Set Action&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00982"></a>00982     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cad5e079e803ef186b0968676ebb04a858">OUTLINER_ANIMOP_CLEAR_ACT</a>, <span class="stringliteral">&quot;CLEAR_ACT&quot;</span>, 0, <span class="stringliteral">&quot;Unlink Action&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00983"></a>00983     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9d142eddee5f1134418becef5a1e3200">OUTLINER_ANIMOP_REFRESH_DRV</a>, <span class="stringliteral">&quot;REFRESH_DRIVERS&quot;</span>, 0, <span class="stringliteral">&quot;Refresh Drivers&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00984"></a>00984     <span class="comment">//{OUTLINER_ANIMOP_COPY_DRIVERS, &quot;COPY_DRIVERS&quot;, 0, &quot;Copy Drivers&quot;, &quot;&quot;},</span>
<a name="l00985"></a>00985     <span class="comment">//{OUTLINER_ANIMOP_PASTE_DRIVERS, &quot;PASTE_DRIVERS&quot;, 0, &quot;Paste Drivers&quot;, &quot;&quot;},</span>
<a name="l00986"></a>00986     {<a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9816d4b915f71d52bafe5e08edb678ea">OUTLINER_ANIMOP_CLEAR_DRV</a>, <span class="stringliteral">&quot;CLEAR_DRIVERS&quot;</span>, 0, <span class="stringliteral">&quot;Clear Drivers&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00987"></a>00987     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00988"></a>00988 };
<a name="l00989"></a>00989 
<a name="l00990"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8b11c47d59fa26ca61ff38aaefbc84fc">00990</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8b11c47d59fa26ca61ff38aaefbc84fc">outliner_animdata_operation_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00991"></a>00991 {
<a name="l00992"></a>00992     <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops= <a class="code" href="../../df/d01/BKE__context_8h.html#a757b3be66ff99f2d3f92e0486c3eb381">CTX_wm_space_outliner</a>(C);
<a name="l00993"></a>00993     <span class="keywordtype">int</span> scenelevel=0, objectlevel=0, idlevel=0, datalevel=0;
<a name="l00994"></a>00994     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5c">eOutliner_AnimDataOps</a> event;
<a name="l00995"></a>00995     <span class="keywordtype">short</span> updateDeps = 0;
<a name="l00996"></a>00996     
<a name="l00997"></a>00997     <span class="comment">/* check for invalid states */</span>
<a name="l00998"></a>00998     <span class="keywordflow">if</span> (soops == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00999"></a>00999         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01000"></a>01000     
<a name="l01001"></a>01001     <span class="keyword">event</span>= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l01002"></a>01002     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">set_operation_types</a>(soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, &amp;scenelevel, &amp;objectlevel, &amp;idlevel, &amp;datalevel);
<a name="l01003"></a>01003     
<a name="l01004"></a>01004     <span class="keywordflow">if</span> (datalevel != <a class="code" href="../../df/def/outliner__intern_8h.html#aa5ab0ee486c33393877990902b4054d1">TSE_ANIM_DATA</a>)
<a name="l01005"></a>01005         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01006"></a>01006     
<a name="l01007"></a>01007     <span class="comment">/* perform the core operation */</span>
<a name="l01008"></a>01008     <span class="keywordflow">switch</span> (event) {
<a name="l01009"></a>01009         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cadbccd95346b22ef44f225e751a45cf48">OUTLINER_ANIMOP_SET_ACT</a>:
<a name="l01010"></a>01010             <span class="comment">/* delegate once again... */</span>
<a name="l01011"></a>01011             <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;OUTLINER_OT_action_set&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01012"></a>01012             <span class="keywordflow">break</span>;
<a name="l01013"></a>01013         
<a name="l01014"></a>01014         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5cad5e079e803ef186b0968676ebb04a858">OUTLINER_ANIMOP_CLEAR_ACT</a>:
<a name="l01015"></a>01015             <span class="comment">/* clear active action - using standard rules */</span>
<a name="l01016"></a>01016             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, datalevel, event, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a66ae4ee5b4efccdb177a807ce735d695">unlinkact_animdata_cb</a>);
<a name="l01017"></a>01017             
<a name="l01018"></a>01018             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a1ae48304ab1b5da96c5319a62f9b3b80">ND_NLA_ACTCHANGE</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01019"></a>01019             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Unlink action&quot;</span>);
<a name="l01020"></a>01020             <span class="keywordflow">break</span>;
<a name="l01021"></a>01021             
<a name="l01022"></a>01022         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9d142eddee5f1134418becef5a1e3200">OUTLINER_ANIMOP_REFRESH_DRV</a>:
<a name="l01023"></a>01023             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, datalevel, event, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a7deb741b625b782273b8e78d7ce15c31">refreshdrivers_animdata_cb</a>);
<a name="l01024"></a>01024             
<a name="l01025"></a>01025             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae33d7b6d741944268e2e95aa7416d97f">ND_ANIMCHAN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01026"></a>01026             <span class="comment">//ED_undo_push(C, &quot;Refresh Drivers&quot;); /* no undo needed - shouldn&#39;t have any impact? */</span>
<a name="l01027"></a>01027             updateDeps = 1;
<a name="l01028"></a>01028             <span class="keywordflow">break</span>;
<a name="l01029"></a>01029             
<a name="l01030"></a>01030         <span class="keywordflow">case</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a2a6bb60e35ec1d22bb9719fb77d6df5ca9816d4b915f71d52bafe5e08edb678ea">OUTLINER_ANIMOP_CLEAR_DRV</a>:
<a name="l01031"></a>01031             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, datalevel, event, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a34b8c06d907dfcea29c9e9f612c2dc06">cleardrivers_animdata_cb</a>);
<a name="l01032"></a>01032             
<a name="l01033"></a>01033             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a367b640edd611357ec6de8d1923d027e">NC_ANIMATION</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ae33d7b6d741944268e2e95aa7416d97f">ND_ANIMCHAN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01034"></a>01034             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Clear Drivers&quot;</span>);
<a name="l01035"></a>01035             updateDeps = 1;
<a name="l01036"></a>01036             <span class="keywordflow">break</span>;
<a name="l01037"></a>01037             
<a name="l01038"></a>01038         <span class="keywordflow">default</span>: <span class="comment">// invalid</span>
<a name="l01039"></a>01039             <span class="keywordflow">break</span>;
<a name="l01040"></a>01040     }
<a name="l01041"></a>01041     
<a name="l01042"></a>01042     <span class="comment">/* update dependencies */</span>
<a name="l01043"></a>01043     <span class="keywordflow">if</span> (updateDeps) {
<a name="l01044"></a>01044         <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain = <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l01045"></a>01045         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01046"></a>01046         
<a name="l01047"></a>01047         <span class="comment">/* rebuild depsgraph for the new deps */</span>
<a name="l01048"></a>01048         <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#a1916587a9ec19eb3543b1c1bc54a8ded">DAG_scene_sort</a>(bmain, scene);
<a name="l01049"></a>01049         
<a name="l01050"></a>01050         <span class="comment">/* force an update of depsgraph */</span>
<a name="l01051"></a>01051         <a class="code" href="../../d2/da0/BKE__depsgraph_8h.html#ac7bea022d30913f94c94aff54e0fc186">DAG_ids_flush_update</a>(bmain, 0);
<a name="l01052"></a>01052     }
<a name="l01053"></a>01053     
<a name="l01054"></a>01054     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 
<a name="l01057"></a>01057 
<a name="l01058"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8155ded275d023536bd0047346657260">01058</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#a8e68edaae8407c8cd7b04177a963ae80">OUTLINER_OT_animdata_operation</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01059"></a>01059 {
<a name="l01060"></a>01060     <span class="comment">/* identifiers */</span>
<a name="l01061"></a>01061     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Outliner Animation Data Operation&quot;</span>;
<a name="l01062"></a>01062     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;OUTLINER_OT_animdata_operation&quot;</span>;
<a name="l01063"></a>01063     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01064"></a>01064     
<a name="l01065"></a>01065     <span class="comment">/* callbacks */</span>
<a name="l01066"></a>01066     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l01067"></a>01067     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a8b11c47d59fa26ca61ff38aaefbc84fc">outliner_animdata_operation_exec</a>;
<a name="l01068"></a>01068     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>;
<a name="l01069"></a>01069     
<a name="l01070"></a>01070     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l01071"></a>01071     
<a name="l01072"></a>01072     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_animdata_op_types, 0, <span class="stringliteral">&quot;Animation Operation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01073"></a>01073 }
<a name="l01074"></a>01074 
<a name="l01075"></a>01075 <span class="comment">/* **************************************** */</span>
<a name="l01076"></a>01076 
<a name="l01077"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a03177e833230bf901cbcb5f47dc5f21a">01077</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a03177e833230bf901cbcb5f47dc5f21a">prop_data_op_types</a>[] = {
<a name="l01078"></a>01078     {1, <span class="stringliteral">&quot;SELECT&quot;</span>, 0, <span class="stringliteral">&quot;Select&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01079"></a>01079     {2, <span class="stringliteral">&quot;DESELECT&quot;</span>, 0, <span class="stringliteral">&quot;Deselect&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01080"></a>01080     {3, <span class="stringliteral">&quot;HIDE&quot;</span>, 0, <span class="stringliteral">&quot;Hide&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01081"></a>01081     {4, <span class="stringliteral">&quot;UNHIDE&quot;</span>, 0, <span class="stringliteral">&quot;Unhide&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01082"></a>01082     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l01083"></a>01083 };
<a name="l01084"></a>01084 
<a name="l01085"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9821fe19e5353503c5b49a22cc0409ce">01085</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9821fe19e5353503c5b49a22cc0409ce">outliner_data_operation_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01086"></a>01086 {
<a name="l01087"></a>01087     <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops= <a class="code" href="../../df/d01/BKE__context_8h.html#a757b3be66ff99f2d3f92e0486c3eb381">CTX_wm_space_outliner</a>(C);
<a name="l01088"></a>01088     <span class="keywordtype">int</span> scenelevel=0, objectlevel=0, idlevel=0, datalevel=0;
<a name="l01089"></a>01089     <span class="keywordtype">int</span> event;
<a name="l01090"></a>01090     
<a name="l01091"></a>01091     <span class="comment">/* check for invalid states */</span>
<a name="l01092"></a>01092     <span class="keywordflow">if</span> (soops == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01093"></a>01093         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01094"></a>01094     
<a name="l01095"></a>01095     <span class="keyword">event</span>= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l01096"></a>01096     <a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">set_operation_types</a>(soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, &amp;scenelevel, &amp;objectlevel, &amp;idlevel, &amp;datalevel);
<a name="l01097"></a>01097     
<a name="l01098"></a>01098     <span class="keywordflow">if</span> (datalevel==<a class="code" href="../../df/def/outliner__intern_8h.html#aef097b3ecfcabd0f460b586b9de5c57b">TSE_POSE_CHANNEL</a>) {
<a name="l01099"></a>01099         <span class="keywordflow">if</span> (event&gt;0) {
<a name="l01100"></a>01100             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, datalevel, event, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a1906deb11b356009b02ffd5a4057c581">pchan_cb</a>);
<a name="l01101"></a>01101             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a72e1ed3dc8d04e8bc84328ec6ef6ce80">ND_POSE</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01102"></a>01102             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;PoseChannel operation&quot;</span>);
<a name="l01103"></a>01103         }
<a name="l01104"></a>01104     }
<a name="l01105"></a>01105     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalevel==<a class="code" href="../../df/def/outliner__intern_8h.html#a0a9b46b4bb403fb950bcd09bc1ec8700">TSE_BONE</a>) {
<a name="l01106"></a>01106         <span class="keywordflow">if</span> (event&gt;0) {
<a name="l01107"></a>01107             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, datalevel, event, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a42f941ea21c74e958cefa461bec67673">bone_cb</a>);
<a name="l01108"></a>01108             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a72e1ed3dc8d04e8bc84328ec6ef6ce80">ND_POSE</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01109"></a>01109             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;Bone operation&quot;</span>);
<a name="l01110"></a>01110         }
<a name="l01111"></a>01111     }
<a name="l01112"></a>01112     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalevel==<a class="code" href="../../df/def/outliner__intern_8h.html#ac1c3342737bb388d2fd4f65ebcb200f4">TSE_EBONE</a>) {
<a name="l01113"></a>01113         <span class="keywordflow">if</span> (event&gt;0) {
<a name="l01114"></a>01114             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, datalevel, event, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a4d5dc91017fbf9261524edaf743b9d99">ebone_cb</a>);
<a name="l01115"></a>01115             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#ad7623342a2e6e2b7e66123bbdf2975da">NC_OBJECT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a72e1ed3dc8d04e8bc84328ec6ef6ce80">ND_POSE</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01116"></a>01116             <a class="code" href="../../d6/df1/ED__util_8h.html#aa768644f80c2e60cce352dcc11970d1f">ED_undo_push</a>(C, <span class="stringliteral">&quot;EditBone operation&quot;</span>);
<a name="l01117"></a>01117         }
<a name="l01118"></a>01118     }
<a name="l01119"></a>01119     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalevel==<a class="code" href="../../df/def/outliner__intern_8h.html#a890f00cb1f219d91a8523812334d3656">TSE_SEQUENCE</a>) {
<a name="l01120"></a>01120         <span class="keywordflow">if</span> (event&gt;0) {
<a name="l01121"></a>01121             <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aedc53b6fe448ba4f00c24a0f5b3accf1">outliner_do_data_operation</a>(soops, datalevel, event, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d0/d5f/outliner__tools_8c.html#afca09a4710cace7dd0531bf509965b35">sequence_cb</a>);
<a name="l01122"></a>01122         }
<a name="l01123"></a>01123     }
<a name="l01124"></a>01124     
<a name="l01125"></a>01125     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01126"></a>01126 }
<a name="l01127"></a>01127 
<a name="l01128"></a>01128 
<a name="l01129"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a5de3f070390db8f395823764aaedeb02">01129</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#a9ec95b39dd239e5ad31e8b4a68666fb6">OUTLINER_OT_data_operation</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01130"></a>01130 {
<a name="l01131"></a>01131     <span class="comment">/* identifiers */</span>
<a name="l01132"></a>01132     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Outliner Data Operation&quot;</span>;
<a name="l01133"></a>01133     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;OUTLINER_OT_data_operation&quot;</span>;
<a name="l01134"></a>01134     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01135"></a>01135     
<a name="l01136"></a>01136     <span class="comment">/* callbacks */</span>
<a name="l01137"></a>01137     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l01138"></a>01138     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a9821fe19e5353503c5b49a22cc0409ce">outliner_data_operation_exec</a>;
<a name="l01139"></a>01139     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>;
<a name="l01140"></a>01140     
<a name="l01141"></a>01141     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l01142"></a>01142     
<a name="l01143"></a>01143     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_data_op_types, 0, <span class="stringliteral">&quot;Data Operation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01144"></a>01144 }
<a name="l01145"></a>01145 
<a name="l01146"></a>01146 
<a name="l01147"></a>01147 <span class="comment">/* ******************** */</span>
<a name="l01148"></a>01148 
<a name="l01149"></a>01149 
<a name="l01150"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#aeab2e377a3d26a52e1edc9962f9dc41f">01150</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#aeab2e377a3d26a52e1edc9962f9dc41f">do_outliner_operation_event</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar, <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops, <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event, <span class="keyword">const</span> <span class="keywordtype">float</span> mval[2])
<a name="l01151"></a>01151 {
<a name="l01152"></a>01152     <a class="code" href="../../df/df0/structReportList.html">ReportList</a> *reports = <a class="code" href="../../df/d01/BKE__context_8h.html#ac83792b6e00e841cdb896c9c0230bde7">CTX_wm_reports</a>(C); <span class="comment">// XXX...</span>
<a name="l01153"></a>01153     
<a name="l01154"></a>01154     <span class="keywordflow">if</span> (mval[1]&gt;te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9841fb74d1dff64fa9593c902a0c1d6a">ys</a> &amp;&amp; mval[1]&lt;te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9841fb74d1dff64fa9593c902a0c1d6a">ys</a>+<a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>) {
<a name="l01155"></a>01155         <span class="keywordtype">int</span> scenelevel=0, objectlevel=0, idlevel=0, datalevel=0;
<a name="l01156"></a>01156         <a class="code" href="../../da/d20/structTreeStoreElem.html">TreeStoreElem</a> *tselem= <a class="code" href="../../df/def/outliner__intern_8h.html#a804fa5954c5c38273764b024eefa251f">TREESTORE</a>(te);
<a name="l01157"></a>01157         
<a name="l01158"></a>01158         <span class="comment">/* select object that&#39;s clicked on and popup context menu */</span>
<a name="l01159"></a>01159         <span class="keywordflow">if</span> (!(tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a104426a340d0c42828c65f86ed21dd80">flag</a> &amp; <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>)) {
<a name="l01160"></a>01160             
<a name="l01161"></a>01161             <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d9e/outliner__edit_8c.html#a8390439d2c372d78aeb3ed4908bccd4e">outliner_has_one_flag</a>(soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>, 1) )
<a name="l01162"></a>01162                 <a class="code" href="../../d3/d9e/outliner__edit_8c.html#ae1483bf1e1869cb96c9fbfb89f554caf">outliner_set_flag</a>(soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>, 0);
<a name="l01163"></a>01163             
<a name="l01164"></a>01164             tselem-&gt;<a class="code" href="../../da/d20/structTreeStoreElem.html#a104426a340d0c42828c65f86ed21dd80">flag</a> |= <a class="code" href="../../d7/d51/DNA__outliner__types_8h.html#ab03a51728349ab4e125215da52916a93">TSE_SELECTED</a>;
<a name="l01165"></a>01165             <span class="comment">/* redraw, same as outliner_select function */</span>
<a name="l01166"></a>01166             soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#afa5f6723bdfa80b2c1b91dcd74942d21">storeflag</a> |= <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a75887cd4f4fe3e6149b78e43230360a5">SO_TREESTORE_REDRAW</a>;
<a name="l01167"></a>01167             <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l01168"></a>01168         }
<a name="l01169"></a>01169         
<a name="l01170"></a>01170         <a class="code" href="../../d0/d5f/outliner__tools_8c.html#af7fb258ef0ef98c11acfe4853fb67998">set_operation_types</a>(soops, &amp;soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>, &amp;scenelevel, &amp;objectlevel, &amp;idlevel, &amp;datalevel);
<a name="l01171"></a>01171         
<a name="l01172"></a>01172         <span class="keywordflow">if</span> (scenelevel) {
<a name="l01173"></a>01173             <span class="comment">//if (objectlevel || datalevel || idlevel) error(&quot;Mixed selection&quot;);</span>
<a name="l01174"></a>01174             <span class="comment">//else pupmenu(&quot;Scene Operations%t|Delete&quot;);</span>
<a name="l01175"></a>01175         }
<a name="l01176"></a>01176         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (objectlevel) {
<a name="l01177"></a>01177             <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;OUTLINER_OT_object_operation&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01178"></a>01178         }
<a name="l01179"></a>01179         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idlevel) {
<a name="l01180"></a>01180             <span class="keywordflow">if</span> (idlevel==-1 || datalevel) <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(reports, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;Mixed selection&quot;</span>);
<a name="l01181"></a>01181             <span class="keywordflow">else</span> {
<a name="l01182"></a>01182                 <span class="keywordflow">if</span> (idlevel==<a class="code" href="../../d3/dfb/DNA__ID_8h.html#afc8c3d5178b4130eee3e7542ef0dcae7">ID_GR</a>)
<a name="l01183"></a>01183                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;OUTLINER_OT_group_operation&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01184"></a>01184                 <span class="keywordflow">else</span>
<a name="l01185"></a>01185                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;OUTLINER_OT_id_operation&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01186"></a>01186             }
<a name="l01187"></a>01187         }
<a name="l01188"></a>01188         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalevel) {
<a name="l01189"></a>01189             <span class="keywordflow">if</span> (datalevel==-1) <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(reports, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68aa7428e90bb3916896145e5eb14a7dd7b">RPT_WARNING</a>, <span class="stringliteral">&quot;Mixed selection&quot;</span>);
<a name="l01190"></a>01190             <span class="keywordflow">else</span> {
<a name="l01191"></a>01191                 <span class="keywordflow">if</span> (datalevel == <a class="code" href="../../df/def/outliner__intern_8h.html#aa5ab0ee486c33393877990902b4054d1">TSE_ANIM_DATA</a>)
<a name="l01192"></a>01192                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;OUTLINER_OT_animdata_operation&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01193"></a>01193                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalevel == <a class="code" href="../../df/def/outliner__intern_8h.html#aec49c0e59af853f18705f9c0c43fa5c6">TSE_DRIVER_BASE</a>)
<a name="l01194"></a>01194                     <span class="comment">/* do nothing... no special ops needed yet */</span>;
<a name="l01195"></a>01195                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(datalevel, <a class="code" href="../../df/def/outliner__intern_8h.html#a7e69c2fed1b0393220bdaab367a951c8">TSE_R_LAYER_BASE</a>, <a class="code" href="../../df/def/outliner__intern_8h.html#a9eb17f6c3e4003be1ff9a6fe0aac78aa">TSE_R_LAYER</a>, <a class="code" href="../../df/def/outliner__intern_8h.html#aaeb107e1a7d65641ab5bd21c88e2bc66">TSE_R_PASS</a>))
<a name="l01196"></a>01196                     <span class="comment">/*WM_operator_name_call(C, &quot;OUTLINER_OT_renderdata_operation&quot;, WM_OP_INVOKE_REGION_WIN, NULL)*/</span>;
<a name="l01197"></a>01197                 <span class="keywordflow">else</span>
<a name="l01198"></a>01198                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;OUTLINER_OT_data_operation&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01199"></a>01199             }
<a name="l01200"></a>01200         }
<a name="l01201"></a>01201         
<a name="l01202"></a>01202         <span class="keywordflow">return</span> 1;
<a name="l01203"></a>01203     }
<a name="l01204"></a>01204     
<a name="l01205"></a>01205     <span class="keywordflow">for</span> (te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#a9d11a8301593c5ada35845e59ceb2853">subtree</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; te; te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#af4294bd483fda182e33ddd33ad757581">next</a>) {
<a name="l01206"></a>01206         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d5f/outliner__tools_8c.html#aeab2e377a3d26a52e1edc9962f9dc41f">do_outliner_operation_event</a>(C, scene, ar, soops, te, event, mval))
<a name="l01207"></a>01207             <span class="keywordflow">return</span> 1;
<a name="l01208"></a>01208     }
<a name="l01209"></a>01209     <span class="keywordflow">return</span> 0;
<a name="l01210"></a>01210 }
<a name="l01211"></a>01211 
<a name="l01212"></a>01212 
<a name="l01213"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#a43f683a94e5f730bfd6b2dc151627f15">01213</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a43f683a94e5f730bfd6b2dc151627f15">outliner_operation</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op), <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01214"></a>01214 {
<a name="l01215"></a>01215     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01216"></a>01216     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l01217"></a>01217     <a class="code" href="../../d3/d88/structSpaceOops.html">SpaceOops</a> *soops= <a class="code" href="../../df/d01/BKE__context_8h.html#a757b3be66ff99f2d3f92e0486c3eb381">CTX_wm_space_outliner</a>(C);
<a name="l01218"></a>01218     <a class="code" href="../../da/d12/structTreeElement.html">TreeElement</a> *te;
<a name="l01219"></a>01219     <span class="keywordtype">float</span> fmval[2];
<a name="l01220"></a>01220     
<a name="l01221"></a>01221     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(&amp;ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a3abcb927aedd966f98e3417897e2c243">v2d</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[0], event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[1], fmval, fmval+1);
<a name="l01222"></a>01222     
<a name="l01223"></a>01223     <span class="keywordflow">for</span> (te= soops-&gt;<a class="code" href="../../d3/d88/structSpaceOops.html#adccabcddd402b182d47fa100c645fc16">tree</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; te; te= te-&gt;<a class="code" href="../../da/d12/structTreeElement.html#af4294bd483fda182e33ddd33ad757581">next</a>) {
<a name="l01224"></a>01224         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d5f/outliner__tools_8c.html#aeab2e377a3d26a52e1edc9962f9dc41f">do_outliner_operation_event</a>(C, scene, ar, soops, te, event, fmval)) <span class="keywordflow">break</span>;
<a name="l01225"></a>01225     }
<a name="l01226"></a>01226     
<a name="l01227"></a>01227     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01228"></a>01228 }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230 <span class="comment">/* Menu only! Calls other operators */</span>
<a name="l01231"></a><a class="code" href="../../d0/d5f/outliner__tools_8c.html#acbd21915dc1742a80593c91afee5cf3d">01231</a> <span class="keywordtype">void</span> <a class="code" href="../../df/def/outliner__intern_8h.html#a509c5b9994c40695de1cfcb75005bd04">OUTLINER_OT_operation</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01232"></a>01232 {
<a name="l01233"></a>01233     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Execute Operation&quot;</span>;
<a name="l01234"></a>01234     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;OUTLINER_OT_operation&quot;</span>;
<a name="l01235"></a>01235     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Context menu for item operations&quot;</span>;
<a name="l01236"></a>01236     
<a name="l01237"></a>01237     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d5f/outliner__tools_8c.html#a43f683a94e5f730bfd6b2dc151627f15">outliner_operation</a>;
<a name="l01238"></a>01238     
<a name="l01239"></a>01239     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>;
<a name="l01240"></a>01240 }
<a name="l01241"></a>01241 
<a name="l01242"></a>01242 <span class="comment">/* ****************************************************** */</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:42 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
