<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: sequencer_edit.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">sequencer_edit.c</div>  </div>
</div>
<div class="contents">
<a href="../../d0/d97/sequencer__edit_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2001-2002 by NaN Holding BV.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * Contributor(s): Blender Foundation, 2003-2009</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00024"></a>00024 <span class="comment"> */</span>
<a name="l00025"></a>00025 
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#ifndef WIN32</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#else</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#include &lt;io.h&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#endif</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dbb/BLI__threads_8h.html">BLI_threads.h</a>&quot;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/de4/DNA__userdef__types_8h.html">DNA_userdef_types.h</a>&quot;</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html">BKE_sequencer.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/BKE__report_8h.html">BKE_report.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/db1/BKE__sound_8h.html">BKE_sound.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd4/BKE__movieclip_8h.html">BKE_movieclip.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d49/IMB__imbuf_8h.html">IMB_imbuf.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/RNA__define_8h.html">RNA_define.h</a>&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d68/RNA__enum__types_8h.html">RNA_enum_types.h</a>&quot;</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">/* for menu/popup icons etc etc*/</span>
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/df2/ED__transform_8h.html">ED_transform.h</a>&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d85/ED__sequencer_8h.html">ED_sequencer.h</a>&quot;</span>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d63/UI__view2d_8h.html">UI_view2d.h</a>&quot;</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="comment">/* own include */</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d4a/sequencer__intern_8h.html">sequencer_intern.h</a>&quot;</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">/* XXX */</span>
<a name="l00080"></a>00080 <span class="comment">/* RNA Enums, used in multiple files */</span>
<a name="l00081"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a27d67cfdd45e602a1fea3ed06e8570d3">00081</a> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a27d67cfdd45e602a1fea3ed06e8570d3">sequencer_prop_effect_types</a>[] = {
<a name="l00082"></a>00082     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ae38fc4065fd82d15b5cd46c3526691aa">SEQ_CROSS</a>, <span class="stringliteral">&quot;CROSS&quot;</span>, 0, <span class="stringliteral">&quot;Crossfade&quot;</span>, <span class="stringliteral">&quot;Crossfade effect strip type&quot;</span>},
<a name="l00083"></a>00083     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a20eff4ce3bcf30210f4ff861d7ff9a15">SEQ_ADD</a>, <span class="stringliteral">&quot;ADD&quot;</span>, 0, <span class="stringliteral">&quot;Add&quot;</span>, <span class="stringliteral">&quot;Add effect strip type&quot;</span>},
<a name="l00084"></a>00084     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a1774ca1fb6cc200d73c04d23bb351bab">SEQ_SUB</a>, <span class="stringliteral">&quot;SUBTRACT&quot;</span>, 0, <span class="stringliteral">&quot;Subtract&quot;</span>, <span class="stringliteral">&quot;Subtract effect strip type&quot;</span>},
<a name="l00085"></a>00085     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4b4f219864173dee05d5620f9d50fa79">SEQ_ALPHAOVER</a>, <span class="stringliteral">&quot;ALPHA_OVER&quot;</span>, 0, <span class="stringliteral">&quot;Alpha Over&quot;</span>, <span class="stringliteral">&quot;Alpha Over effect strip type&quot;</span>},
<a name="l00086"></a>00086     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#aa34752b3fcf84a685799389c4f000dcd">SEQ_ALPHAUNDER</a>, <span class="stringliteral">&quot;ALPHA_UNDER&quot;</span>, 0, <span class="stringliteral">&quot;Alpha Under&quot;</span>, <span class="stringliteral">&quot;Alpha Under effect strip type&quot;</span>},
<a name="l00087"></a>00087     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#adabb8ea2d2c98a733a3f63a4852fbc9a">SEQ_GAMCROSS</a>, <span class="stringliteral">&quot;GAMMA_CROSS&quot;</span>, 0, <span class="stringliteral">&quot;Gamma Cross&quot;</span>, <span class="stringliteral">&quot;Gamma Cross effect strip type&quot;</span>},
<a name="l00088"></a>00088     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0e9f61a31000b94f1f5dccbce9c2c644">SEQ_MUL</a>, <span class="stringliteral">&quot;MULTIPLY&quot;</span>, 0, <span class="stringliteral">&quot;Multiply&quot;</span>, <span class="stringliteral">&quot;Multiply effect strip type&quot;</span>},
<a name="l00089"></a>00089     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a24a49b5c6800794da85b4a72bdddc220">SEQ_OVERDROP</a>, <span class="stringliteral">&quot;OVER_DROP&quot;</span>, 0, <span class="stringliteral">&quot;Alpha Over Drop&quot;</span>, <span class="stringliteral">&quot;Alpha Over Drop effect strip type&quot;</span>},
<a name="l00090"></a>00090     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a2849e22219b01b9faf475e5f42b796cd">SEQ_PLUGIN</a>, <span class="stringliteral">&quot;PLUGIN&quot;</span>, 0, <span class="stringliteral">&quot;Plugin&quot;</span>, <span class="stringliteral">&quot;Plugin effect strip type&quot;</span>},
<a name="l00091"></a>00091     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ad57bedfd5a49ccaa1ff517002848a88c">SEQ_WIPE</a>, <span class="stringliteral">&quot;WIPE&quot;</span>, 0, <span class="stringliteral">&quot;Wipe&quot;</span>, <span class="stringliteral">&quot;Wipe effect strip type&quot;</span>},
<a name="l00092"></a>00092     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af593d215afebd3a83ac6b88730be150c">SEQ_GLOW</a>, <span class="stringliteral">&quot;GLOW&quot;</span>, 0, <span class="stringliteral">&quot;Glow&quot;</span>, <span class="stringliteral">&quot;Glow effect strip type&quot;</span>},
<a name="l00093"></a>00093     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a05e3ebe8d311ebda786fd4c99dc71b6e">SEQ_TRANSFORM</a>, <span class="stringliteral">&quot;TRANSFORM&quot;</span>, 0, <span class="stringliteral">&quot;Transform&quot;</span>, <span class="stringliteral">&quot;Transform effect strip type&quot;</span>},
<a name="l00094"></a>00094     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ae712fce1b76be5f0eb730367e48ac0fd">SEQ_COLOR</a>, <span class="stringliteral">&quot;COLOR&quot;</span>, 0, <span class="stringliteral">&quot;Color&quot;</span>, <span class="stringliteral">&quot;Color effect strip type&quot;</span>},
<a name="l00095"></a>00095     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a83413469cce986fba23ad6412baa63c6">SEQ_SPEED</a>, <span class="stringliteral">&quot;SPEED&quot;</span>, 0, <span class="stringliteral">&quot;Speed&quot;</span>, <span class="stringliteral">&quot;Color effect strip type&quot;</span>},
<a name="l00096"></a>00096     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a01fb1ac17a99f1056a4b8313f07ee5d6">SEQ_MULTICAM</a>, <span class="stringliteral">&quot;MULTICAM&quot;</span>, 0, <span class="stringliteral">&quot;Multicam Selector&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00097"></a>00097     {<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ad9d6c15b92adbb4809f82de7a48a6a7c">SEQ_ADJUSTMENT</a>, <span class="stringliteral">&quot;ADJUSTMENT&quot;</span>, 0, <span class="stringliteral">&quot;Adjustment Layer&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00098"></a>00098     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00099"></a>00099 };
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="comment">/* mute operator */</span>
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a7fbc4eb3f9491456301612c5ae745aee">00103</a> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7fbc4eb3f9491456301612c5ae745aee">prop_side_types</a>[] = {
<a name="l00104"></a>00104     {<a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>, <span class="stringliteral">&quot;LEFT&quot;</span>, 0, <span class="stringliteral">&quot;Left&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00105"></a>00105     {<a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>, <span class="stringliteral">&quot;RIGHT&quot;</span>, 0, <span class="stringliteral">&quot;Right&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00106"></a>00106     {<a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a1dbe295d258279a487794ff49fe4fda6">SEQ_SIDE_BOTH</a>, <span class="stringliteral">&quot;BOTH&quot;</span>, 0, <span class="stringliteral">&quot;Both&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00107"></a>00107     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00108"></a>00108 };
<a name="l00109"></a>00109 
<a name="l00110"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7262877effdf9c9231185efe4e765684">00110</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7262877effdf9c9231185efe4e765684">prop_side_lr_types</a>[] = {
<a name="l00111"></a>00111     {<a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>, <span class="stringliteral">&quot;LEFT&quot;</span>, 0, <span class="stringliteral">&quot;Left&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00112"></a>00112     {<a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>, <span class="stringliteral">&quot;RIGHT&quot;</span>, 0, <span class="stringliteral">&quot;Right&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l00113"></a>00113     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l00114"></a>00114 };
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="../../dd/d49/structTransSeq.html">00116</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../dd/d49/structTransSeq.html">TransSeq</a> {
<a name="l00117"></a><a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">00117</a>     <span class="keywordtype">int</span> <a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a>, <a class="code" href="../../dd/d49/structTransSeq.html#a5ac9501875d40e3254239d45d756d821">machine</a>;
<a name="l00118"></a><a class="code" href="../../dd/d49/structTransSeq.html#a036e113e5a2a0febc448c7b10b544e8e">00118</a>     <span class="keywordtype">int</span> <a class="code" href="../../dd/d49/structTransSeq.html#a036e113e5a2a0febc448c7b10b544e8e">startstill</a>, <a class="code" href="../../dd/d49/structTransSeq.html#a3a625fe8a1e50cae4586cc9970ed2d9d">endstill</a>;
<a name="l00119"></a><a class="code" href="../../dd/d49/structTransSeq.html#a91cb7e10ac49439dd3d66651b17edfb2">00119</a>     <span class="keywordtype">int</span> <a class="code" href="../../dd/d49/structTransSeq.html#a91cb7e10ac49439dd3d66651b17edfb2">startdisp</a>, <a class="code" href="../../dd/d49/structTransSeq.html#a0c70bd77482503c3d6fdae9e9c363aaa">enddisp</a>;
<a name="l00120"></a><a class="code" href="../../dd/d49/structTransSeq.html#a26eec102174f95ae4740f6da3a801a85">00120</a>     <span class="keywordtype">int</span> <a class="code" href="../../dd/d49/structTransSeq.html#a26eec102174f95ae4740f6da3a801a85">startofs</a>, <a class="code" href="../../dd/d49/structTransSeq.html#a51b1f03d33ed535009eaecbbdbeafae7">endofs</a>;
<a name="l00121"></a><a class="code" href="../../dd/d49/structTransSeq.html#a308550dc7c08b1c1cff90b3570e2c003">00121</a>     <span class="keywordtype">int</span> <a class="code" href="../../dd/d49/structTransSeq.html#a308550dc7c08b1c1cff90b3570e2c003">anim_startofs</a>, <a class="code" href="../../dd/d49/structTransSeq.html#a016cacdb86a63326ea238e4dddce92c3">anim_endofs</a>;
<a name="l00122"></a>00122     <span class="comment">/* int final_left, final_right; */</span> <span class="comment">/* UNUSED */</span>
<a name="l00123"></a><a class="code" href="../../dd/d49/structTransSeq.html#aff955747045227010eae91fb6ea50fbd">00123</a>     <span class="keywordtype">int</span> <a class="code" href="../../dd/d49/structTransSeq.html#aff955747045227010eae91fb6ea50fbd">len</a>;
<a name="l00124"></a>00124 } <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0089216bb465ea3654ecd0c61fda9b44">TransSeq</a>;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="comment">/* ********************************************************************** */</span>
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">/* ***************** proxy job manager ********************** */</span>
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d3b/structProxyBuildJob.html">ProxyBuildJob</a> {
<a name="l00131"></a>00131     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a7a67995dfb6b1a7cfd09753ba5792c8f">scene</a>; 
<a name="l00132"></a>00132     <span class="keyword">struct </span><a class="code" href="../../d0/dc0/structMain.html">Main</a> *<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a9cb38df1a7781b3d4e6aaa765d5e57d3">main</a>;
<a name="l00133"></a><a class="code" href="../../d6/d3b/structProxyBuildJob.html#aed99995ba7009db5a111a2b35a108783">00133</a>     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> <a class="code" href="../../d6/d3b/structProxyBuildJob.html#aed99995ba7009db5a111a2b35a108783">queue</a>;
<a name="l00134"></a>00134     <span class="keywordtype">int</span> <a class="code" href="../../d6/d3b/structProxyBuildJob.html#a22e4f50dce1f37073d795b57b6eef834">stop</a>;
<a name="l00135"></a>00135 } <a class="code" href="../../d1/d43/clip__ops_8c.html#a2594540ee5ad74573f7ffc4f1e170b1d">ProxyJob</a>;
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a116291ce6121fe329f2efce2b77e42ba">00137</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a116291ce6121fe329f2efce2b77e42ba">proxy_freejob</a>(<span class="keywordtype">void</span> *pjv)
<a name="l00138"></a>00138 {
<a name="l00139"></a>00139     <a class="code" href="../../d6/d3b/structProxyBuildJob.html">ProxyJob</a> *pj = pjv;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#af94280dc0a245719304fdff91327b1e0">BLI_freelistN</a>(&amp;pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#aed99995ba7009db5a111a2b35a108783">queue</a>);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(pj);
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="comment">/* only this runs inside thread */</span>
<a name="l00147"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac5f8dcd86c3f3a8ccdac0c872956b9b5">00147</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac5f8dcd86c3f3a8ccdac0c872956b9b5">proxy_startjob</a>(<span class="keywordtype">void</span> *pjv, <span class="keywordtype">short</span> *stop, <span class="keywordtype">short</span> *do_update, <span class="keywordtype">float</span> *progress)
<a name="l00148"></a>00148 {
<a name="l00149"></a>00149     <a class="code" href="../../d6/d3b/structProxyBuildJob.html">ProxyJob</a> *pj = pjv;
<a name="l00150"></a>00150     <a class="code" href="../../d0/df2/structLinkData.html">LinkData</a> *<a class="code" href="../../d0/dea/sp__coletree_8c.html#aaa63f127f8b967960d824c4cf6e93ca0">link</a>;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="keywordflow">for</span> (link = pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#aed99995ba7009db5a111a2b35a108783">queue</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; link; link = link-&gt;<a class="code" href="../../d0/df2/structLinkData.html#a5e24b2a72895050a8c968e55b8dce1e3">next</a>) {
<a name="l00153"></a>00153         <span class="keyword">struct </span><a class="code" href="../../da/d4a/structSeqIndexBuildContext.html">SeqIndexBuildContext</a> *context = link-&gt;<a class="code" href="../../d0/df2/structLinkData.html#a3591ce65917fa263d5e3c0586e90bf40">data</a>;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a525befe56857b48d5e359f56235a2497">seq_proxy_rebuild</a>(context, stop, do_update, progress);
<a name="l00156"></a>00156     }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158     <span class="keywordflow">if</span> (*stop) {
<a name="l00159"></a>00159         pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a22e4f50dce1f37073d795b57b6eef834">stop</a> = 1;
<a name="l00160"></a>00160         fprintf(stderr,  <span class="stringliteral">&quot;Canceling proxy rebuild on users request...\n&quot;</span>);
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 
<a name="l00164"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a60f23511b6b2794f60db2d987c081258">00164</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a60f23511b6b2794f60db2d987c081258">proxy_endjob</a>(<span class="keywordtype">void</span> *pjv)
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166     <a class="code" href="../../d6/d3b/structProxyBuildJob.html">ProxyJob</a> *pj = pjv;
<a name="l00167"></a>00167     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a7a67995dfb6b1a7cfd09753ba5792c8f">scene</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00168"></a>00168     <a class="code" href="../../d0/df2/structLinkData.html">LinkData</a> *<a class="code" href="../../d0/dea/sp__coletree_8c.html#aaa63f127f8b967960d824c4cf6e93ca0">link</a>;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     <span class="keywordflow">for</span> (link = pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#aed99995ba7009db5a111a2b35a108783">queue</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; link; link = link-&gt;<a class="code" href="../../d0/df2/structLinkData.html#a5e24b2a72895050a8c968e55b8dce1e3">next</a>) {
<a name="l00171"></a>00171         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a88999631865b9561e6b79e95084c157a">seq_proxy_rebuild_finish</a>(link-&gt;<a class="code" href="../../d0/df2/structLinkData.html#a3591ce65917fa263d5e3c0586e90bf40">data</a>, pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a22e4f50dce1f37073d795b57b6eef834">stop</a>);
<a name="l00172"></a>00172     }
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a4dee98589098f19747a1caaecf7c0b9c">free_imbuf_seq</a>(pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a7a67995dfb6b1a7cfd09753ba5792c8f">scene</a>, &amp;ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <a class="code" href="../../df/db0/wm__event__system_8c.html#a2d4bab7477e1a026061d578f19247457">WM_main_add_notifier</a>(<a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a7a67995dfb6b1a7cfd09753ba5792c8f">scene</a>);
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a9570344a5cf8ecc6b880381e0a40002a">00179</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a9570344a5cf8ecc6b880381e0a40002a">seq_proxy_build_job</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00180"></a>00180 {
<a name="l00181"></a>00181     <a class="code" href="../../df/da1/structwmJob.html">wmJob</a> *steve;
<a name="l00182"></a>00182     <a class="code" href="../../d6/d3b/structProxyBuildJob.html">ProxyJob</a> *pj;
<a name="l00183"></a>00183     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *<a class="code" href="../../da/d4a/structSeqIndexBuildContext.html#a380518042ed4b49a28e5e17efa16555e">scene</a> = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00184"></a>00184     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00185"></a>00185     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00186"></a>00186     <span class="keyword">struct </span><a class="code" href="../../da/d4a/structSeqIndexBuildContext.html">SeqIndexBuildContext</a> *context;
<a name="l00187"></a>00187     <a class="code" href="../../d0/df2/structLinkData.html">LinkData</a> *<a class="code" href="../../d0/dea/sp__coletree_8c.html#aaa63f127f8b967960d824c4cf6e93ca0">link</a>;
<a name="l00188"></a>00188     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../da/d4a/structSeqIndexBuildContext.html#a0946bb68ea367f2464331ba424128a7b">seq</a>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     steve = <a class="code" href="../../d6/ddf/wm__jobs_8c.html#a03e66c0464fe9538f2be29d10983a54b">WM_jobs_get</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C), sa, <span class="stringliteral">&quot;Building Proxies&quot;</span>, <a class="code" href="../../d4/d7f/WM__api_8h.html#a465c1325f2e6a043e462d7cb9af39731">WM_JOB_PROGRESS</a>);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     pj = <a class="code" href="../../d6/ddf/wm__jobs_8c.html#ac42ad8d0e7d8c3f2135dac8c2676c84e">WM_jobs_get_customdata</a>(steve);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <span class="keywordflow">if</span> (!pj) {
<a name="l00195"></a>00195         pj = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d6/d3b/structProxyBuildJob.html">ProxyJob</a>), <span class="stringliteral">&quot;proxy rebuild job&quot;</span>);
<a name="l00196"></a>00196     
<a name="l00197"></a>00197         pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a7a67995dfb6b1a7cfd09753ba5792c8f">scene</a> = <a class="code" href="../../da/d4a/structSeqIndexBuildContext.html#a380518042ed4b49a28e5e17efa16555e">scene</a>;
<a name="l00198"></a>00198         pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a9cb38df1a7781b3d4e6aaa765d5e57d3">main</a> = <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         <a class="code" href="../../d6/ddf/wm__jobs_8c.html#a32861c1bffe82b79764b704b38ef0751">WM_jobs_customdata</a>(steve, pj, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a116291ce6121fe329f2efce2b77e42ba">proxy_freejob</a>);
<a name="l00201"></a>00201         <a class="code" href="../../d6/ddf/wm__jobs_8c.html#a61b5493e2cc31b7445290f3bd26be5ef">WM_jobs_timer</a>(steve, 0.1, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>);
<a name="l00202"></a>00202         <a class="code" href="../../d6/ddf/wm__jobs_8c.html#ad483f8df6cb0321204a4f98c645db4ba">WM_jobs_callbacks</a>(steve, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac5f8dcd86c3f3a8ccdac0c872956b9b5">proxy_startjob</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a60f23511b6b2794f60db2d987c081258">proxy_endjob</a>);
<a name="l00203"></a>00203     }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aec8906c47a30af947fb6945abd9d0dab">SEQP_BEGIN</a>(ed, seq) {
<a name="l00206"></a>00206         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) {
<a name="l00207"></a>00207             context = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ad71be999ac682984a40e053c98ad784c">seq_proxy_rebuild_context</a>(pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a9cb38df1a7781b3d4e6aaa765d5e57d3">main</a>, pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#a7a67995dfb6b1a7cfd09753ba5792c8f">scene</a>, seq);
<a name="l00208"></a>00208             link = <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a45c2880c1c8f58f11583cf0ddcc06697">BLI_genericNodeN</a>(context);
<a name="l00209"></a>00209             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;pj-&gt;<a class="code" href="../../d6/d3b/structProxyBuildJob.html#aed99995ba7009db5a111a2b35a108783">queue</a>, link);
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/ddf/wm__jobs_8c.html#ae92cab16bbb95de49bab786d298cd499">WM_jobs_is_running</a>(steve)) {
<a name="l00215"></a>00215         <a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.afbreek = 0;
<a name="l00216"></a>00216         <a class="code" href="../../d6/ddf/wm__jobs_8c.html#a6b58050bebd06f6dcf195967da599bf0">WM_jobs_start</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C), steve);
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l00220"></a>00220 }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 <span class="comment">/* ********************************************************************** */</span>
<a name="l00223"></a>00223 
<a name="l00224"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#aa32559daa0eccacdd15e519b298cb0c1">00224</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aba5e424646cdd45fd832d1c6df19c031">seq_rectf</a>(<a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../da/d4a/structSeqIndexBuildContext.html#a0946bb68ea367f2464331ba424128a7b">seq</a>, <a class="code" href="../../da/d10/structrctf.html">rctf</a> *rectf)
<a name="l00225"></a>00225 {
<a name="l00226"></a>00226     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>) rectf-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>;
<a name="l00227"></a>00227     <span class="keywordflow">else</span> rectf-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>;
<a name="l00228"></a>00228     rectf-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> + <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ad417f49a9bb4dc2599b0d313c184409b">SEQ_STRIP_OFSBOTTOM</a>;
<a name="l00229"></a>00229     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a>) rectf-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>;
<a name="l00230"></a>00230     <span class="keywordflow">else</span> rectf-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>;
<a name="l00231"></a>00231     rectf-&gt;<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> + <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#afef216b37dc6f8f6eca89d4829bad023">SEQ_STRIP_OFSTOP</a>;
<a name="l00232"></a>00232 }
<a name="l00233"></a>00233 
<a name="l00234"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea37b902bbb0a7bb824b02b63c8d140c">00234</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a26aa3564d15ae9e56cce569a324df5da">UNUSED_FUNCTION</a>(<a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea37b902bbb0a7bb824b02b63c8d140c">change_plugin_seq</a>) (<a class="code" href="../../d9/d27/structScene.html">Scene</a> * <a class="code" href="../../da/d4a/structSeqIndexBuildContext.html#a380518042ed4b49a28e5e17efa16555e">scene</a>, <span class="keywordtype">char</span> *<a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>) <span class="comment">/* called from fileselect */</span>
<a name="l00235"></a>00235 {
<a name="l00236"></a>00236     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(<a class="code" href="../../da/d4a/structSeqIndexBuildContext.html#a380518042ed4b49a28e5e17efa16555e">scene</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00237"></a>00237     <span class="keyword">struct </span><a class="code" href="../../d5/d8e/structSeqEffectHandle.html">SeqEffectHandle</a> sh;
<a name="l00238"></a>00238     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240     <span class="keywordflow">if</span> (last_seq == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || last_seq-&gt;type != <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a2849e22219b01b9faf475e5f42b796cd">SEQ_PLUGIN</a>) <span class="keywordflow">return</span>;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     sh = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a619b9587c8fc27bb04b8058b950a6ff4">get_sequence_effect</a>(last_seq);
<a name="l00243"></a>00243     sh.<a class="code" href="../../d5/d8e/structSeqEffectHandle.html#acf63e37b5acf8f298dac6a747e59e5f9">free</a>(last_seq);
<a name="l00244"></a>00244     sh.<a class="code" href="../../d5/d8e/structSeqEffectHandle.html#a3b8bc67d509c1219c19db0e8f3d4c2af">init_plugin</a>(last_seq, <a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     last_seq-&gt;machine = <a class="code" href="../../dd/d46/IMAGE_8h.html#a87a519a4901f827aca98fa11601a739c">MAX3</a>(last_seq-&gt;seq1-&gt;machine,
<a name="l00247"></a>00247                              last_seq-&gt;seq2-&gt;machine,
<a name="l00248"></a>00248                              last_seq-&gt;seq3-&gt;machine);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, last_seq) ) <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, last_seq, scene);
<a name="l00251"></a>00251     
<a name="l00252"></a>00252 }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 
<a name="l00255"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a3ca055ed00ab85dd3c75a1eb25f2e9be">00255</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acfbe850abc894d4eaf91eced22a2bb8d">boundbox_seq</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../da/d10/structrctf.html">rctf</a> *rect)
<a name="l00256"></a>00256 {
<a name="l00257"></a>00257     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00258"></a>00258     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00259"></a>00259     <span class="keywordtype">float</span> <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>[2], <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>[2];
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     
<a name="l00262"></a>00262     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     min[0] = 0.0;
<a name="l00265"></a>00265     max[0] = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad256bf7a37ebe6e72d9ac63d4a4cea7a">EFRA</a> + 1;
<a name="l00266"></a>00266     min[1] = 0.0;
<a name="l00267"></a>00267     max[1] = 8.0;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00270"></a>00270     <span class="keywordflow">while</span> (seq) {
<a name="l00271"></a>00271 
<a name="l00272"></a>00272         <span class="keywordflow">if</span> (min[0] &gt; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - 1) min[0] = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - 1;
<a name="l00273"></a>00273         <span class="keywordflow">if</span> (max[0] &lt; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> + 1) max[0] = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> + 1;
<a name="l00274"></a>00274         <span class="keywordflow">if</span> (max[1] &lt; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> + 2) max[1] = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> + 2;
<a name="l00275"></a>00275 
<a name="l00276"></a>00276         seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = min[0];
<a name="l00280"></a>00280     rect-&gt;<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = max[0];
<a name="l00281"></a>00281     rect-&gt;<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = min[1];
<a name="l00282"></a>00282     rect-&gt;<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = max[1];
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 }
<a name="l00285"></a>00285 
<a name="l00286"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab145ac90a396fd9ce2384c7b068f2dfb">00286</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab145ac90a396fd9ce2384c7b068f2dfb">mouse_frame_side</a>(<a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d, <span class="keywordtype">short</span> mouse_x, <span class="keywordtype">int</span> frame)
<a name="l00287"></a>00287 {
<a name="l00288"></a>00288     <span class="keywordtype">int</span> mval[2];
<a name="l00289"></a>00289     <span class="keywordtype">float</span> mouseloc[2];
<a name="l00290"></a>00290     
<a name="l00291"></a>00291     mval[0] = mouse_x;
<a name="l00292"></a>00292     mval[1] = 0;
<a name="l00293"></a>00293     
<a name="l00294"></a>00294     <span class="comment">/* choose the side based on which side of the playhead the mouse is on */</span>
<a name="l00295"></a>00295     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, mval[0], mval[1], &amp;mouseloc[0], &amp;mouseloc[1]);
<a name="l00296"></a>00296     
<a name="l00297"></a>00297     <span class="keywordflow">return</span> mouseloc[0] &gt; frame ? <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a> : <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>;
<a name="l00298"></a>00298 }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 
<a name="l00301"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#aa84bd4fe45b342e9d034c31487e70afb">00301</a> <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../d0/d97/sequencer__edit_8c.html#aab3399ab4fc1874640d44fd2076db57b">find_neighboring_sequence</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *test, <span class="keywordtype">int</span> lr, <span class="keywordtype">int</span> sel) 
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303     <span class="comment">/* sel - 0==unselected, 1==selected, -1==done care*/</span>
<a name="l00304"></a>00304     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00305"></a>00305     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00306"></a>00306 
<a name="l00307"></a>00307     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309     <span class="keywordflow">if</span> (sel &gt; 0) sel = <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00310"></a>00310     
<a name="l00311"></a>00311     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l00312"></a>00312         <span class="keywordflow">if</span> ((seq != test) &amp;&amp;
<a name="l00313"></a>00313             (test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> == seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a>) &amp;&amp;
<a name="l00314"></a>00314             ((sel == -1) || (sel &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) || (sel == 0 &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) == 0)  ))
<a name="l00315"></a>00315         {
<a name="l00316"></a>00316             <span class="keywordflow">switch</span> (lr) {
<a name="l00317"></a>00317                 <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>:
<a name="l00318"></a>00318                     <span class="keywordflow">if</span> (test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> == (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>)) {
<a name="l00319"></a>00319                         <span class="keywordflow">return</span> seq;
<a name="l00320"></a>00320                     }
<a name="l00321"></a>00321                     <span class="keywordflow">break</span>;
<a name="l00322"></a>00322                 <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>:
<a name="l00323"></a>00323                     <span class="keywordflow">if</span> (test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> == (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>)) {
<a name="l00324"></a>00324                         <span class="keywordflow">return</span> seq;
<a name="l00325"></a>00325                     }
<a name="l00326"></a>00326                     <span class="keywordflow">break</span>;
<a name="l00327"></a>00327             }
<a name="l00328"></a>00328         }
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00331"></a>00331 }
<a name="l00332"></a>00332 
<a name="l00333"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a17d918739a38fb9ce8b9a1ff791abaa1">00333</a> <span class="keyword">static</span> <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../d0/d97/sequencer__edit_8c.html#a17d918739a38fb9ce8b9a1ff791abaa1">find_next_prev_sequence</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *test, <span class="keywordtype">int</span> lr, <span class="keywordtype">int</span> sel) 
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335     <span class="comment">/* sel - 0==unselected, 1==selected, -1==done care*/</span>
<a name="l00336"></a>00336     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *best_seq = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00337"></a>00337     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00338"></a>00338     
<a name="l00339"></a>00339     <span class="keywordtype">int</span> dist, best_dist;
<a name="l00340"></a>00340     best_dist = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a> * 2;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     
<a name="l00343"></a>00343     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00344"></a>00344 
<a name="l00345"></a>00345     seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00346"></a>00346     <span class="keywordflow">while</span> (seq) {
<a name="l00347"></a>00347         <span class="keywordflow">if</span> ((seq != test) &amp;&amp;
<a name="l00348"></a>00348             (test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> == seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a>) &amp;&amp;
<a name="l00349"></a>00349             (test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a0d2507c3a5dc4105ce8b2b85fc33e54b">depth</a> == seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a0d2507c3a5dc4105ce8b2b85fc33e54b">depth</a>) &amp;&amp;
<a name="l00350"></a>00350             ((sel == -1) || (sel == (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>))))
<a name="l00351"></a>00351         {
<a name="l00352"></a>00352             dist = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a> * 2;
<a name="l00353"></a>00353             
<a name="l00354"></a>00354             <span class="keywordflow">switch</span> (lr) {
<a name="l00355"></a>00355                 <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>:
<a name="l00356"></a>00356                     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> &lt;= test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>) {
<a name="l00357"></a>00357                         dist = test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> - seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>;
<a name="l00358"></a>00358                     }
<a name="l00359"></a>00359                     <span class="keywordflow">break</span>;
<a name="l00360"></a>00360                 <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>:
<a name="l00361"></a>00361                     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt;= test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>) {
<a name="l00362"></a>00362                         dist = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - test-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>;
<a name="l00363"></a>00363                     }
<a name="l00364"></a>00364                     <span class="keywordflow">break</span>;
<a name="l00365"></a>00365             }
<a name="l00366"></a>00366             
<a name="l00367"></a>00367             <span class="keywordflow">if</span> (dist == 0) {
<a name="l00368"></a>00368                 best_seq = seq;
<a name="l00369"></a>00369                 <span class="keywordflow">break</span>;
<a name="l00370"></a>00370             }
<a name="l00371"></a>00371             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dist &lt; best_dist) {
<a name="l00372"></a>00372                 best_dist = dist;
<a name="l00373"></a>00373                 best_seq = seq;
<a name="l00374"></a>00374             }
<a name="l00375"></a>00375         }
<a name="l00376"></a>00376         seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l00377"></a>00377     }
<a name="l00378"></a>00378     <span class="keywordflow">return</span> best_seq; <span class="comment">/* can be null */</span>
<a name="l00379"></a>00379 }
<a name="l00380"></a>00380 
<a name="l00381"></a>00381 
<a name="l00382"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#af97eba549f33d8848477788b046bcdcf">00382</a> <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../d0/d97/sequencer__edit_8c.html#a84c9860d05e11ea622bf7dbd0a61439a">find_nearest_seq</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d, <span class="keywordtype">int</span> *hand, <span class="keyword">const</span> <span class="keywordtype">int</span> mval[2])
<a name="l00383"></a>00383 {
<a name="l00384"></a>00384     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00385"></a>00385     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00386"></a>00386     <span class="keywordtype">float</span> x, y;
<a name="l00387"></a>00387     <span class="keywordtype">float</span> pixelx;
<a name="l00388"></a>00388     <span class="keywordtype">float</span> handsize;
<a name="l00389"></a>00389     <span class="keywordtype">float</span> displen;
<a name="l00390"></a>00390     *hand = <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004ac4d7ffa907da0020862dfb11b954e544">SEQ_SIDE_NONE</a>;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392     
<a name="l00393"></a>00393     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00394"></a>00394     
<a name="l00395"></a>00395     pixelx = (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>) / (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>);
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, mval[0], mval[1], &amp;x, &amp;y);
<a name="l00398"></a>00398     
<a name="l00399"></a>00399     seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00400"></a>00400     
<a name="l00401"></a>00401     <span class="keywordflow">while</span> (seq) {
<a name="l00402"></a>00402         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> == (<span class="keywordtype">int</span>)y) {
<a name="l00403"></a>00403             <span class="comment">/* check for both normal strips, and strips that have been flipped horizontally */</span>
<a name="l00404"></a>00404             <span class="keywordflow">if</span> ( ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &lt; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>) &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &lt;= x &amp;&amp; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> &gt;= x)) ||
<a name="l00405"></a>00405                  ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>) &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt;= x &amp;&amp; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> &lt;= x)) )
<a name="l00406"></a>00406             {
<a name="l00407"></a>00407                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ae82ab3eea87645e2fa3c1d294c3a922c">seq_tx_test</a>(seq)) {
<a name="l00408"></a>00408                     
<a name="l00409"></a>00409                     <span class="comment">/* clamp handles to defined size in pixel space */</span>
<a name="l00410"></a>00410                     
<a name="l00411"></a>00411                     handsize = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a9ea43c47738c79a7ca75bf4011c7a67b">handsize</a>;
<a name="l00412"></a>00412                     displen = (float)<a class="code" href="../../d1/d22/stdosl_8h.html#a1200284b0188ff3732b55b964e5e3a25">abs</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>);
<a name="l00413"></a>00413                     
<a name="l00414"></a>00414                     <span class="keywordflow">if</span> (displen / pixelx &gt; 16) { <span class="comment">/* don&#39;t even try to grab the handles of small strips */</span>
<a name="l00415"></a>00415                         <span class="comment">/* Set the max value to handle to 1/3 of the total len when its less then 28.</span>
<a name="l00416"></a>00416 <span class="comment">                         * This is important because otherwise selecting handles happens even when you click in the middle */</span>
<a name="l00417"></a>00417                         
<a name="l00418"></a>00418                         <span class="keywordflow">if</span> ((displen / 3) &lt; 30 * pixelx) {
<a name="l00419"></a>00419                             handsize = displen / 3;
<a name="l00420"></a>00420                         }
<a name="l00421"></a>00421                         <span class="keywordflow">else</span> {
<a name="l00422"></a>00422                             <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(handsize, 7 * pixelx, 30 * pixelx);
<a name="l00423"></a>00423                         }
<a name="l00424"></a>00424                         
<a name="l00425"></a>00425                         <span class="keywordflow">if</span> (handsize + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt;= x)
<a name="l00426"></a>00426                             *hand = <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>;
<a name="l00427"></a>00427                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (-handsize + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> &lt;= x)
<a name="l00428"></a>00428                             *hand = <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>;
<a name="l00429"></a>00429                     }
<a name="l00430"></a>00430                 }
<a name="l00431"></a>00431                 <span class="keywordflow">return</span> seq;
<a name="l00432"></a>00432             }
<a name="l00433"></a>00433         }
<a name="l00434"></a>00434         seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00437"></a>00437 }
<a name="l00438"></a>00438 
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">00440</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">seq_is_parent</a>(<a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *par, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq)
<a name="l00441"></a>00441 {
<a name="l00442"></a>00442     <span class="keywordflow">return</span> ((par-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> == seq) || (par-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> == seq) || (par-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a> == seq));
<a name="l00443"></a>00443 }
<a name="l00444"></a>00444 
<a name="l00445"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">00445</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">seq_is_predecessor</a>(<a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *pred, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq)
<a name="l00446"></a>00446 {
<a name="l00447"></a>00447     <span class="keywordflow">if</span> (!pred) <span class="keywordflow">return</span> 0;
<a name="l00448"></a>00448     <span class="keywordflow">if</span> (pred == seq) <span class="keywordflow">return</span> 0;
<a name="l00449"></a>00449     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">seq_is_parent</a>(pred, seq)) <span class="keywordflow">return</span> 1;
<a name="l00450"></a>00450     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pred-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">seq_is_predecessor</a>(pred-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a>, seq)) <span class="keywordflow">return</span> 1;
<a name="l00451"></a>00451     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pred-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">seq_is_predecessor</a>(pred-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a>, seq)) <span class="keywordflow">return</span> 1;
<a name="l00452"></a>00452     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pred-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a> &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">seq_is_predecessor</a>(pred-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>, seq)) <span class="keywordflow">return</span> 1;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <span class="keywordflow">return</span> 0;
<a name="l00455"></a>00455 }
<a name="l00456"></a>00456 
<a name="l00457"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a55d0bf425828e7c8aea92f4f03ddd035">00457</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad6691eeb07fb20cb105c6146922f023a">deselect_all_seq</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00458"></a>00458 {
<a name="l00459"></a>00459     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00460"></a>00460     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     
<a name="l00463"></a>00463     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aec8906c47a30af947fb6945abd9d0dab">SEQP_BEGIN</a>(ed, seq)
<a name="l00466"></a>00466     {
<a name="l00467"></a>00467         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a83f85f3b9e0027d9abe86402913b1037">SEQ_ALLSEL</a>;
<a name="l00468"></a>00468     }
<a name="l00469"></a>00469     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>
<a name="l00470"></a>00470         
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ab5f1e08eb38fe5fd3788b582ed6b3e45">00473</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a547af9cb2e65720dd6899546927d28d1">recurs_sel_seq</a>(<a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seqm)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477     seq = seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00478"></a>00478     <span class="keywordflow">while</span> (seq) {
<a name="l00479"></a>00479 
<a name="l00480"></a>00480         <span class="keywordflow">if</span> (seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; (<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#afb4e85100d4223b01bf37f1d5c45ab28">SEQ_LEFTSEL</a> + <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a9449eade6a750ae240a932adbbea385d">SEQ_RIGHTSEL</a>)) seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a83f85f3b9e0027d9abe86402913b1037">SEQ_ALLSEL</a>;
<a name="l00481"></a>00481         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00482"></a>00482         <span class="keywordflow">else</span> seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a83f85f3b9e0027d9abe86402913b1037">SEQ_ALLSEL</a>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a547af9cb2e65720dd6899546927d28d1">recurs_sel_seq</a>(seq);
<a name="l00485"></a>00485 
<a name="l00486"></a>00486         seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l00487"></a>00487     }
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 
<a name="l00490"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#aa21744e1c17557cc614f918eec99c537">00490</a> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3267c0a6ae74bba7f75bfb0f604b53ef">seq_effect_find_selected</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *activeseq, <span class="keywordtype">int</span> type, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> **selseq1, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> **selseq2, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> **selseq3, <span class="keyword">const</span> <span class="keywordtype">char</span> **error_str)
<a name="l00491"></a>00491 {
<a name="l00492"></a>00492     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00493"></a>00493     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq1 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *seq2 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *seq3 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *seq;
<a name="l00494"></a>00494     
<a name="l00495"></a>00495     *error_str = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="keywordflow">if</span> (!activeseq)
<a name="l00498"></a>00498         seq2 = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;next) {
<a name="l00501"></a>00501         <span class="keywordflow">if</span> (seq-&gt;flag &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00502"></a>00502             <span class="keywordflow">if</span> (seq-&gt;type == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a3667844452f6c2f4b40e851fb3cf5132">SEQ_SOUND</a> &amp;&amp; <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a47b9509a75eefacd18b6511957497821">get_sequence_effect_num_inputs</a>(type) != 0) {
<a name="l00503"></a>00503                 *error_str = <span class="stringliteral">&quot;Can&#39;t apply effects to audio sequence strips&quot;</span>;
<a name="l00504"></a>00504                 <span class="keywordflow">return</span> 0;
<a name="l00505"></a>00505             }
<a name="l00506"></a>00506             <span class="keywordflow">if</span> ((seq != activeseq) &amp;&amp; (seq != seq2)) {
<a name="l00507"></a>00507                 <span class="keywordflow">if</span> (seq2 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) seq2 = seq;
<a name="l00508"></a>00508                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq1 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) seq1 = seq;
<a name="l00509"></a>00509                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq3 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) seq3 = seq;
<a name="l00510"></a>00510                 <span class="keywordflow">else</span> {
<a name="l00511"></a>00511                     *error_str = <span class="stringliteral">&quot;Can&#39;t apply effect to more than 3 sequence strips&quot;</span>;
<a name="l00512"></a>00512                     <span class="keywordflow">return</span> 0;
<a name="l00513"></a>00513                 }
<a name="l00514"></a>00514             }
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     <span class="comment">/* make sequence selection a little bit more intuitive</span>
<a name="l00519"></a>00519 <span class="comment">     * for 3 strips: the last-strip should be sequence3 */</span>
<a name="l00520"></a>00520     <span class="keywordflow">if</span> (seq3 != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; seq2 != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00521"></a>00521         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *tmp = seq2;
<a name="l00522"></a>00522         seq2 = seq3;
<a name="l00523"></a>00523         seq3 = tmp;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525     
<a name="l00526"></a>00526 
<a name="l00527"></a>00527     <span class="keywordflow">switch</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a47b9509a75eefacd18b6511957497821">get_sequence_effect_num_inputs</a>(type)) {
<a name="l00528"></a>00528         <span class="keywordflow">case</span> 0:
<a name="l00529"></a>00529             *selseq1 = *selseq2 = *selseq3 = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00530"></a>00530             <span class="keywordflow">return</span> 1; <span class="comment">/* succsess */</span>
<a name="l00531"></a>00531         <span class="keywordflow">case</span> 1:
<a name="l00532"></a>00532             <span class="keywordflow">if</span> (seq2 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00533"></a>00533                 *error_str = <span class="stringliteral">&quot;Need at least one selected sequence strip&quot;</span>;
<a name="l00534"></a>00534                 <span class="keywordflow">return</span> 0;
<a name="l00535"></a>00535             }
<a name="l00536"></a>00536             <span class="keywordflow">if</span> (seq1 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) seq1 = seq2;
<a name="l00537"></a>00537             <span class="keywordflow">if</span> (seq3 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) seq3 = seq2;
<a name="l00538"></a>00538         <span class="keywordflow">case</span> 2:
<a name="l00539"></a>00539             <span class="keywordflow">if</span> (seq1 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || seq2 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00540"></a>00540                 *error_str = <span class="stringliteral">&quot;Need 2 selected sequence strips&quot;</span>;
<a name="l00541"></a>00541                 <span class="keywordflow">return</span> 0;
<a name="l00542"></a>00542             }
<a name="l00543"></a>00543             <span class="keywordflow">if</span> (seq3 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) seq3 = seq2;
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545     
<a name="l00546"></a>00546     <span class="keywordflow">if</span> (seq1 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; seq2 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; seq3 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00547"></a>00547         *error_str = <span class="stringliteral">&quot;TODO: in what cases does this happen?&quot;</span>;
<a name="l00548"></a>00548         <span class="keywordflow">return</span> 0;
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550     
<a name="l00551"></a>00551     *selseq1 = seq1;
<a name="l00552"></a>00552     *selseq2 = seq2;
<a name="l00553"></a>00553     *selseq3 = seq3;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     <span class="keywordflow">return</span> 1;
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
<a name="l00558"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">00558</a> <span class="keyword">static</span> <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq)
<a name="l00559"></a>00559 {
<a name="l00560"></a>00560     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq1, *seq2, *seq3;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="comment">/* try to find a replacement input sequence, and flag for later deletion if</span>
<a name="l00563"></a>00563 <span class="comment">     * no replacement can be found */</span>
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <span class="keywordflow">if</span> (!seq)
<a name="l00566"></a>00566         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00567"></a>00567     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>))
<a name="l00568"></a>00568         <span class="keywordflow">return</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) ? <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> : seq);
<a name="l00569"></a>00569     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(seq-&gt;flag &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) {
<a name="l00570"></a>00570         <span class="comment">/* try to find replacement for effect inputs */</span>
<a name="l00571"></a>00571         seq1 = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(scene, seq-&gt;seq1);
<a name="l00572"></a>00572         seq2 = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(scene, seq-&gt;seq2);
<a name="l00573"></a>00573         seq3 = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(scene, seq-&gt;seq3);
<a name="l00574"></a>00574 
<a name="l00575"></a>00575         <span class="keywordflow">if</span> (seq1 == seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> &amp;&amp; seq2 == seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> &amp;&amp; seq3 == seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>) ;
<a name="l00576"></a>00576         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq1 || seq2 || seq3) {
<a name="l00577"></a>00577             seq-&gt;seq1 = (seq1) ? seq1 : (seq2) ? seq2 : seq3;
<a name="l00578"></a>00578             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> = (seq2) ? seq2 : (seq1) ? seq1 : seq3;
<a name="l00579"></a>00579             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a> = (seq3) ? seq3 : (seq1) ? seq1 : seq2;
<a name="l00580"></a>00580 
<a name="l00581"></a>00581             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a593b927f446765f9b1b83c513a86856c">update_changed_seq_and_deps</a>(scene, seq, 1, 1);
<a name="l00582"></a>00582         }
<a name="l00583"></a>00583         <span class="keywordflow">else</span>
<a name="l00584"></a>00584             seq-&gt;flag |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;  <span class="comment">/* mark for delete */</span>
<a name="l00585"></a>00585     }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587     <span class="keywordflow">if</span> (seq-&gt;flag &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00588"></a>00588         <span class="keywordflow">if</span> ((seq1 = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(scene, seq-&gt;seq1))) <span class="keywordflow">return</span> seq1;
<a name="l00589"></a>00589         <span class="keywordflow">if</span> ((seq2 = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(scene, seq-&gt;seq2))) <span class="keywordflow">return</span> seq2;
<a name="l00590"></a>00590         <span class="keywordflow">if</span> ((seq3 = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(scene, seq-&gt;seq3))) <span class="keywordflow">return</span> seq3;
<a name="l00591"></a>00591         <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00592"></a>00592     }
<a name="l00593"></a>00593     <span class="keywordflow">else</span>
<a name="l00594"></a>00594         <span class="keywordflow">return</span> seq;
<a name="l00595"></a>00595 }
<a name="l00596"></a>00596 
<a name="l00597"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c7e4c1fed1cb9b839a3af6bd9c527b3">00597</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c7e4c1fed1cb9b839a3af6bd9c527b3">recurs_del_seq_flag</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb, <span class="keywordtype">short</span> flag, <span class="keywordtype">short</span> deleteall)
<a name="l00598"></a>00598 {
<a name="l00599"></a>00599     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *seqn;
<a name="l00600"></a>00600     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l00601"></a>00601 
<a name="l00602"></a>00602     seq = lb-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00603"></a>00603     <span class="keywordflow">while</span> (seq) {
<a name="l00604"></a>00604         seqn = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l00605"></a>00605         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; flag) || deleteall) {
<a name="l00606"></a>00606             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(lb, seq);
<a name="l00607"></a>00607             <span class="keywordflow">if</span> (seq == last_seq) <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a3ad148ec3a6aa1db31ae1662ca889856">seq_active_set</a>(scene, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00608"></a>00608             <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>) <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c7e4c1fed1cb9b839a3af6bd9c527b3">recurs_del_seq_flag</a>(scene, &amp;seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>, flag, 1);
<a name="l00609"></a>00609             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7a2f7e78b98400bb7da9c17e2cf044ce">seq_free_sequence</a>(scene, seq);
<a name="l00610"></a>00610         }
<a name="l00611"></a>00611         seq = seqn;
<a name="l00612"></a>00612     }
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 
<a name="l00616"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea0a70db317b299e94b0c2a976f157ba">00616</a> <span class="keyword">static</span> <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea0a70db317b299e94b0c2a976f157ba">cut_seq_hard</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, <span class="keywordtype">int</span> cutframe)
<a name="l00617"></a>00617 {
<a name="l00618"></a>00618     <a class="code" href="../../dd/d49/structTransSeq.html">TransSeq</a> ts;
<a name="l00619"></a>00619     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seqn = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00620"></a>00620     <span class="keywordtype">int</span> skip_dup = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00621"></a>00621 
<a name="l00622"></a>00622     <span class="comment">/* backup values */</span>
<a name="l00623"></a>00623     ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>;
<a name="l00624"></a>00624     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a5ac9501875d40e3254239d45d756d821">machine</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a>;
<a name="l00625"></a>00625     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a036e113e5a2a0febc448c7b10b544e8e">startstill</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>;
<a name="l00626"></a>00626     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a3a625fe8a1e50cae4586cc9970ed2d9d">endstill</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a>;
<a name="l00627"></a>00627     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a91cb7e10ac49439dd3d66651b17edfb2">startdisp</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>;
<a name="l00628"></a>00628     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a0c70bd77482503c3d6fdae9e9c363aaa">enddisp</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>;
<a name="l00629"></a>00629     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a26eec102174f95ae4740f6da3a801a85">startofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a>;
<a name="l00630"></a>00630     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a51b1f03d33ed535009eaecbbdbeafae7">endofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a>;
<a name="l00631"></a>00631     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a308550dc7c08b1c1cff90b3570e2c003">anim_startofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a9e0dd64523ebced8c7a0ef6113bb8d5f">anim_startofs</a>;
<a name="l00632"></a>00632     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a016cacdb86a63326ea238e4dddce92c3">anim_endofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aebea1cccf598ab41fcaeacf700cd887a">anim_endofs</a>;
<a name="l00633"></a>00633     ts.<a class="code" href="../../dd/d49/structTransSeq.html#aff955747045227010eae91fb6ea50fbd">len</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>;
<a name="l00634"></a>00634     
<a name="l00635"></a>00635     <span class="comment">/* First Strip! */</span>
<a name="l00636"></a>00636     <span class="comment">/* strips with extended stillfames before */</span>
<a name="l00637"></a>00637     
<a name="l00638"></a>00638     <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>) &amp;&amp; (cutframe &lt; seq-&gt;start)) {
<a name="l00639"></a>00639         <span class="comment">/* don&#39;t do funny things with METAs ... */</span>
<a name="l00640"></a>00640         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>) {
<a name="l00641"></a>00641             skip_dup = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00642"></a>00642             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> - cutframe;
<a name="l00643"></a>00643         }
<a name="l00644"></a>00644         <span class="keywordflow">else</span> {
<a name="l00645"></a>00645             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = cutframe - 1;
<a name="l00646"></a>00646             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = cutframe - seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - 1;
<a name="l00647"></a>00647             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aebea1cccf598ab41fcaeacf700cd887a">anim_endofs</a> += seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a> - 1;
<a name="l00648"></a>00648             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = 0;
<a name="l00649"></a>00649         }
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651     <span class="comment">/* normal strip */</span>
<a name="l00652"></a>00652     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cutframe &gt;= seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>) &amp;&amp; (cutframe &lt;= (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>))) {
<a name="l00653"></a>00653         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a> = 0;
<a name="l00654"></a>00654         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = 0;
<a name="l00655"></a>00655         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aebea1cccf598ab41fcaeacf700cd887a">anim_endofs</a> += (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>) - cutframe;
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657     <span class="comment">/* strips with extended stillframes after */</span>
<a name="l00658"></a>00658     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>) &lt; cutframe) &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a>)) {
<a name="l00659"></a>00659         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> -= seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> - cutframe;
<a name="l00660"></a>00660         <span class="comment">/* don&#39;t do funny things with METAs ... */</span>
<a name="l00661"></a>00661         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>) {
<a name="l00662"></a>00662             skip_dup = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00663"></a>00663         }
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665     
<a name="l00666"></a>00666     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a104ada50dedffcd571655161b01e695a">reload_sequence_new_file</a>(scene, seq, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00667"></a>00667     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l00668"></a>00668 
<a name="l00669"></a>00669     <span class="keywordflow">if</span> (!skip_dup) {
<a name="l00670"></a>00670         <span class="comment">/* Duplicate AFTER the first change */</span>
<a name="l00671"></a>00671         seqn = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a17207265964f4e39dea1a59dd5e3e9d1">seq_dupli_recursive</a>(scene, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, seq, <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a1660e3e1c0a867f4ae91f78bedc20e11">SEQ_DUPE_UNIQUE_NAME</a> | <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7f5f22a4a5e3e0c223b0ee18d8e99562">SEQ_DUPE_ANIM</a>);
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673     
<a name="l00674"></a>00674     <span class="keywordflow">if</span> (seqn) { 
<a name="l00675"></a>00675         seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00676"></a>00676             
<a name="l00677"></a>00677         <span class="comment">/* Second Strip! */</span>
<a name="l00678"></a>00678         <span class="comment">/* strips with extended stillframes before */</span>
<a name="l00679"></a>00679         <span class="keywordflow">if</span> ((seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>) &amp;&amp; (cutframe == seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + 1)) {
<a name="l00680"></a>00680             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a>;
<a name="l00681"></a>00681             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a> - cutframe;
<a name="l00682"></a>00682             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aebea1cccf598ab41fcaeacf700cd887a">anim_endofs</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a016cacdb86a63326ea238e4dddce92c3">anim_endofs</a>;
<a name="l00683"></a>00683             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a3a625fe8a1e50cae4586cc9970ed2d9d">endstill</a>;
<a name="l00684"></a>00684         }
<a name="l00685"></a>00685         
<a name="l00686"></a>00686         <span class="comment">/* normal strip */</span>
<a name="l00687"></a>00687         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cutframe &gt;= seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>) &amp;&amp; (cutframe &lt;= (seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>))) {
<a name="l00688"></a>00688             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = cutframe;
<a name="l00689"></a>00689             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = 0;
<a name="l00690"></a>00690             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a> = 0;
<a name="l00691"></a>00691             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a51b1f03d33ed535009eaecbbdbeafae7">endofs</a>;
<a name="l00692"></a>00692             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a9e0dd64523ebced8c7a0ef6113bb8d5f">anim_startofs</a> += cutframe - ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a>;
<a name="l00693"></a>00693             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aebea1cccf598ab41fcaeacf700cd887a">anim_endofs</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a016cacdb86a63326ea238e4dddce92c3">anim_endofs</a>;
<a name="l00694"></a>00694             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a3a625fe8a1e50cae4586cc9970ed2d9d">endstill</a>;
<a name="l00695"></a>00695         }               
<a name="l00696"></a>00696         
<a name="l00697"></a>00697         <span class="comment">/* strips with extended stillframes after */</span>
<a name="l00698"></a>00698         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>) &lt; cutframe) &amp;&amp; (seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a>)) {
<a name="l00699"></a>00699             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = cutframe;
<a name="l00700"></a>00700             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a> = 0;
<a name="l00701"></a>00701             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a9e0dd64523ebced8c7a0ef6113bb8d5f">anim_startofs</a> += ts.<a class="code" href="../../dd/d49/structTransSeq.html#aff955747045227010eae91fb6ea50fbd">len</a> - 1;
<a name="l00702"></a>00702             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a0c70bd77482503c3d6fdae9e9c363aaa">enddisp</a> - cutframe - 1;
<a name="l00703"></a>00703             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = 0;
<a name="l00704"></a>00704         }
<a name="l00705"></a>00705         
<a name="l00706"></a>00706         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a104ada50dedffcd571655161b01e695a">reload_sequence_new_file</a>(scene, seqn, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00707"></a>00707         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seqn);
<a name="l00708"></a>00708     }
<a name="l00709"></a>00709     <span class="keywordflow">return</span> seqn;
<a name="l00710"></a>00710 }
<a name="l00711"></a>00711 
<a name="l00712"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac1c2dda8286ac0531562580eb35af7dd">00712</a> <span class="keyword">static</span> <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac1c2dda8286ac0531562580eb35af7dd">cut_seq_soft</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, <span class="keywordtype">int</span> cutframe)
<a name="l00713"></a>00713 {
<a name="l00714"></a>00714     <a class="code" href="../../dd/d49/structTransSeq.html">TransSeq</a> ts;
<a name="l00715"></a>00715     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seqn = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00716"></a>00716     <span class="keywordtype">int</span> skip_dup = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00717"></a>00717 
<a name="l00718"></a>00718     <span class="comment">/* backup values */</span>
<a name="l00719"></a>00719     ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>;
<a name="l00720"></a>00720     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a5ac9501875d40e3254239d45d756d821">machine</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a>;
<a name="l00721"></a>00721     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a036e113e5a2a0febc448c7b10b544e8e">startstill</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>;
<a name="l00722"></a>00722     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a3a625fe8a1e50cae4586cc9970ed2d9d">endstill</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a>;
<a name="l00723"></a>00723     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a91cb7e10ac49439dd3d66651b17edfb2">startdisp</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>;
<a name="l00724"></a>00724     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a0c70bd77482503c3d6fdae9e9c363aaa">enddisp</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>;
<a name="l00725"></a>00725     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a26eec102174f95ae4740f6da3a801a85">startofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a>;
<a name="l00726"></a>00726     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a51b1f03d33ed535009eaecbbdbeafae7">endofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a>;
<a name="l00727"></a>00727     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a308550dc7c08b1c1cff90b3570e2c003">anim_startofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a9e0dd64523ebced8c7a0ef6113bb8d5f">anim_startofs</a>;
<a name="l00728"></a>00728     ts.<a class="code" href="../../dd/d49/structTransSeq.html#a016cacdb86a63326ea238e4dddce92c3">anim_endofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aebea1cccf598ab41fcaeacf700cd887a">anim_endofs</a>;
<a name="l00729"></a>00729     ts.<a class="code" href="../../dd/d49/structTransSeq.html#aff955747045227010eae91fb6ea50fbd">len</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>;
<a name="l00730"></a>00730     
<a name="l00731"></a>00731     <span class="comment">/* First Strip! */</span>
<a name="l00732"></a>00732     <span class="comment">/* strips with extended stillfames before */</span>
<a name="l00733"></a>00733     
<a name="l00734"></a>00734     <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>) &amp;&amp; (cutframe &lt; seq-&gt;start)) {
<a name="l00735"></a>00735         <span class="comment">/* don&#39;t do funny things with METAs ... */</span>
<a name="l00736"></a>00736         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>) {
<a name="l00737"></a>00737             skip_dup = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00738"></a>00738             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> - cutframe;
<a name="l00739"></a>00739         }
<a name="l00740"></a>00740         <span class="keywordflow">else</span> {
<a name="l00741"></a>00741             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = cutframe - 1;
<a name="l00742"></a>00742             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = cutframe - seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - 1;
<a name="l00743"></a>00743             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a> - 1;
<a name="l00744"></a>00744             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = 0;
<a name="l00745"></a>00745         }
<a name="l00746"></a>00746     }
<a name="l00747"></a>00747     <span class="comment">/* normal strip */</span>
<a name="l00748"></a>00748     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cutframe &gt;= seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>) &amp;&amp; (cutframe &lt;= (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>))) {
<a name="l00749"></a>00749         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a> = (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>) - cutframe;
<a name="l00750"></a>00750     }
<a name="l00751"></a>00751     <span class="comment">/* strips with extended stillframes after */</span>
<a name="l00752"></a>00752     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>) &lt; cutframe) &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a>)) {
<a name="l00753"></a>00753         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> -= seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> - cutframe;
<a name="l00754"></a>00754         <span class="comment">/* don&#39;t do funny things with METAs ... */</span>
<a name="l00755"></a>00755         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>) {
<a name="l00756"></a>00756             skip_dup = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759     
<a name="l00760"></a>00760     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l00761"></a>00761 
<a name="l00762"></a>00762     <span class="keywordflow">if</span> (!skip_dup) {
<a name="l00763"></a>00763         <span class="comment">/* Duplicate AFTER the first change */</span>
<a name="l00764"></a>00764         seqn = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a17207265964f4e39dea1a59dd5e3e9d1">seq_dupli_recursive</a>(scene, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, seq, <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a1660e3e1c0a867f4ae91f78bedc20e11">SEQ_DUPE_UNIQUE_NAME</a> | <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7f5f22a4a5e3e0c223b0ee18d8e99562">SEQ_DUPE_ANIM</a>);
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766     
<a name="l00767"></a>00767     <span class="keywordflow">if</span> (seqn) { 
<a name="l00768"></a>00768         seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l00769"></a>00769             
<a name="l00770"></a>00770         <span class="comment">/* Second Strip! */</span>
<a name="l00771"></a>00771         <span class="comment">/* strips with extended stillframes before */</span>
<a name="l00772"></a>00772         <span class="keywordflow">if</span> ((seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>) &amp;&amp; (cutframe == seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + 1)) {
<a name="l00773"></a>00773             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a>;
<a name="l00774"></a>00774             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a> - cutframe;
<a name="l00775"></a>00775             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a51b1f03d33ed535009eaecbbdbeafae7">endofs</a>;
<a name="l00776"></a>00776             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a3a625fe8a1e50cae4586cc9970ed2d9d">endstill</a>;
<a name="l00777"></a>00777         }
<a name="l00778"></a>00778         
<a name="l00779"></a>00779         <span class="comment">/* normal strip */</span>
<a name="l00780"></a>00780         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cutframe &gt;= seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>) &amp;&amp; (cutframe &lt;= (seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>))) {
<a name="l00781"></a>00781             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = 0;
<a name="l00782"></a>00782             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a> = cutframe - ts.<a class="code" href="../../dd/d49/structTransSeq.html#ae09d9d357eef4c2840f69359036b4ef9">start</a>;
<a name="l00783"></a>00783             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a51b1f03d33ed535009eaecbbdbeafae7">endofs</a>;
<a name="l00784"></a>00784             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a3a625fe8a1e50cae4586cc9970ed2d9d">endstill</a>;
<a name="l00785"></a>00785         }               
<a name="l00786"></a>00786         
<a name="l00787"></a>00787         <span class="comment">/* strips with extended stillframes after */</span>
<a name="l00788"></a>00788         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> + seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a>) &lt; cutframe) &amp;&amp; (seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a>)) {
<a name="l00789"></a>00789             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = cutframe - ts.<a class="code" href="../../dd/d49/structTransSeq.html#aff955747045227010eae91fb6ea50fbd">len</a> + 1;
<a name="l00790"></a>00790             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#aff955747045227010eae91fb6ea50fbd">len</a> - 1;
<a name="l00791"></a>00791             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = ts.<a class="code" href="../../dd/d49/structTransSeq.html#a0c70bd77482503c3d6fdae9e9c363aaa">enddisp</a> - cutframe - 1;
<a name="l00792"></a>00792             seqn-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = 0;
<a name="l00793"></a>00793         }
<a name="l00794"></a>00794         
<a name="l00795"></a>00795         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seqn);
<a name="l00796"></a>00796     }
<a name="l00797"></a>00797     <span class="keywordflow">return</span> seqn;
<a name="l00798"></a>00798 }
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 
<a name="l00801"></a>00801 <span class="comment">/* like duplicate, but only duplicate and cut overlapping strips,</span>
<a name="l00802"></a>00802 <span class="comment"> * strips to the left of the cutframe are ignored and strips to the right are moved into the new list */</span>
<a name="l00803"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a4fe9b20057ddd7afec19b1df2e6ae882">00803</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a4fe9b20057ddd7afec19b1df2e6ae882">cut_seq_list</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *old, <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *<span class="keyword">new</span>, <span class="keywordtype">int</span> cutframe,
<a name="l00804"></a>00804                         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> * (*cut_seq)(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *, <span class="keywordtype">int</span>))
<a name="l00805"></a>00805 {
<a name="l00806"></a>00806     <span class="keywordtype">int</span> did_something = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00807"></a>00807     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *seq_next_iter;
<a name="l00808"></a>00808     
<a name="l00809"></a>00809     seq = old-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00810"></a>00810     
<a name="l00811"></a>00811     <span class="keywordflow">while</span> (seq) {
<a name="l00812"></a>00812         seq_next_iter = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>; <span class="comment">/* we need this because we may remove seq */</span>
<a name="l00813"></a>00813         
<a name="l00814"></a>00814         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a6526677bf7204890079ff5847f18a0d4">tmp</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00815"></a>00815         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00816"></a>00816             <span class="keywordflow">if</span> (cutframe &gt; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &amp;&amp; 
<a name="l00817"></a>00817                 cutframe &lt; seq-&gt;enddisp)
<a name="l00818"></a>00818             {
<a name="l00819"></a>00819                 <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seqn = cut_seq(scene, seq, cutframe);
<a name="l00820"></a>00820                 <span class="keywordflow">if</span> (seqn) {
<a name="l00821"></a>00821                     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(<span class="keyword">new</span>, seqn);
<a name="l00822"></a>00822                 }
<a name="l00823"></a>00823                 did_something = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00824"></a>00824             }
<a name="l00825"></a>00825             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> &lt;= cutframe) {
<a name="l00826"></a>00826                 <span class="comment">/* do nothing */</span>
<a name="l00827"></a>00827             }
<a name="l00828"></a>00828             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt;= cutframe) {
<a name="l00829"></a>00829                 <span class="comment">/* move into new list */</span>
<a name="l00830"></a>00830                 <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(old, seq);
<a name="l00831"></a>00831                 <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(<span class="keyword">new</span>, seq);
<a name="l00832"></a>00832             }
<a name="l00833"></a>00833         }
<a name="l00834"></a>00834         seq = seq_next_iter;
<a name="l00835"></a>00835     }
<a name="l00836"></a>00836     <span class="keywordflow">return</span> did_something;
<a name="l00837"></a>00837 }
<a name="l00838"></a>00838 
<a name="l00839"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a2d5b42382c4d350908c01ac98da31e1b">00839</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a2d5b42382c4d350908c01ac98da31e1b">insert_gap</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> gap, <span class="keywordtype">int</span> cfra)
<a name="l00840"></a>00840 {
<a name="l00841"></a>00841     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00842"></a>00842     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00843"></a>00843     <span class="keywordtype">int</span> done = 0;
<a name="l00844"></a>00844 
<a name="l00845"></a>00845     <span class="comment">/* all strips &gt;= cfra are shifted */</span>
<a name="l00846"></a>00846     
<a name="l00847"></a>00847     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00848"></a>00848 
<a name="l00849"></a>00849     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aec8906c47a30af947fb6945abd9d0dab">SEQP_BEGIN</a>(ed, seq) {
<a name="l00850"></a>00850         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt;= cfra) {
<a name="l00851"></a>00851             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> += gap;
<a name="l00852"></a>00852             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l00853"></a>00853             done = 1;
<a name="l00854"></a>00854         }
<a name="l00855"></a>00855     }
<a name="l00856"></a>00856     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>
<a name="l00857"></a>00857 
<a name="l00858"></a>00858     <span class="keywordflow">return</span> done;
<a name="l00859"></a>00859 }
<a name="l00860"></a>00860 
<a name="l00861"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae7e3b0a32dfc32269b3193435a1edb5c">00861</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a26aa3564d15ae9e56cce569a324df5da">UNUSED_FUNCTION</a>(<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae7e3b0a32dfc32269b3193435a1edb5c">touch_seq_files</a>) (<a class="code" href="../../d9/d27/structScene.html">Scene</a> * scene)
<a name="l00862"></a>00862 {
<a name="l00863"></a>00863     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00864"></a>00864     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00865"></a>00865     <span class="keywordtype">char</span> <a class="code" href="../../d2/d36/interface__layout_8c.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>[256];
<a name="l00866"></a>00866 
<a name="l00867"></a>00867     <span class="comment">/* touch all strips with movies */</span>
<a name="l00868"></a>00868     
<a name="l00869"></a>00869     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l00870"></a>00870 
<a name="l00871"></a>00871     <span class="comment">// XXX25 if (okee(&quot;Touch and print selected movies&quot;)==0) return;</span>
<a name="l00872"></a>00872 
<a name="l00873"></a>00873     <a class="code" href="../../de/d3c/wm__cursors_8c.html#ae5b57427153f1f60f6638a537465c805">WM_cursor_wait</a>(1);
<a name="l00874"></a>00874 
<a name="l00875"></a>00875     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aec8906c47a30af947fb6945abd9d0dab">SEQP_BEGIN</a>(ed, seq)
<a name="l00876"></a>00876     {
<a name="l00877"></a>00877         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00878"></a>00878             <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af37f12bdb831d524294dcd62ff0a8805">SEQ_MOVIE</a>) {
<a name="l00879"></a>00879                 <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a> &amp;&amp; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a5f5ecc8c7ffc8375e8a43b2500738889">stripdata</a>) {
<a name="l00880"></a>00880                     <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a6f32ac1a463a6322c25cb5c1615c4b1c">BLI_make_file_string</a>(<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.main-&gt;name, str, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a5f5ecc8c7ffc8375e8a43b2500738889">stripdata</a>-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a68eca881ea502f351f9a21fcdc99955d">name</a>);
<a name="l00881"></a>00881                     <a class="code" href="../../d2/d63/BLI__fileops_8h.html#aa4acfeb38f126ddc1c6e4f7aa86f085d">BLI_file_touch</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a>);
<a name="l00882"></a>00882                 }
<a name="l00883"></a>00883             }
<a name="l00884"></a>00884 
<a name="l00885"></a>00885         }
<a name="l00886"></a>00886     }
<a name="l00887"></a>00887     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>
<a name="l00888"></a>00888 
<a name="l00889"></a>00889     <a class="code" href="../../de/d3c/wm__cursors_8c.html#ae5b57427153f1f60f6638a537465c805">WM_cursor_wait</a>(0);
<a name="l00890"></a>00890 }
<a name="l00891"></a>00891 
<a name="l00892"></a>00892 <span class="preprocessor">#if 0</span>
<a name="l00893"></a>00893 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> set_filter_seq(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene)
<a name="l00894"></a>00894 {
<a name="l00895"></a>00895     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l00896"></a>00896     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00897"></a>00897 
<a name="l00898"></a>00898     
<a name="l00899"></a>00899     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l00900"></a>00900 
<a name="l00901"></a>00901     <span class="keywordflow">if</span> (okee(<span class="stringliteral">&quot;Set Deinterlace&quot;</span>) == 0) <span class="keywordflow">return</span>;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aec8906c47a30af947fb6945abd9d0dab">SEQP_BEGIN</a>(ed, seq)
<a name="l00904"></a>00904     {
<a name="l00905"></a>00905         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00906"></a>00906             <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af37f12bdb831d524294dcd62ff0a8805">SEQ_MOVIE</a>) {
<a name="l00907"></a>00907                 seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a7d73ba2f5134cb100b300fed3059c320">SEQ_FILTERY</a>;
<a name="l00908"></a>00908                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a104ada50dedffcd571655161b01e695a">reload_sequence_new_file</a>(scene, seq, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00909"></a>00909                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l00910"></a>00910             }
<a name="l00911"></a>00911 
<a name="l00912"></a>00912         }
<a name="l00913"></a>00913     }
<a name="l00914"></a>00914     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>
<a name="l00915"></a>00915 }
<a name="l00916"></a>00916 <span class="preprocessor">#endif</span>
<a name="l00917"></a>00917 <span class="preprocessor"></span>
<a name="l00918"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac1e320841c5c8acc39597626b27a24cb">00918</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a26aa3564d15ae9e56cce569a324df5da">UNUSED_FUNCTION</a>(<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac1e320841c5c8acc39597626b27a24cb">seq_remap_paths</a>) (<a class="code" href="../../d9/d27/structScene.html">Scene</a> * scene)
<a name="l00919"></a>00919 {
<a name="l00920"></a>00920     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l00921"></a>00921     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00922"></a>00922     <span class="keywordtype">char</span> from[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>], to[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>], stripped[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l00923"></a>00923     
<a name="l00924"></a>00924     
<a name="l00925"></a>00925     <span class="keywordflow">if</span> (last_seq == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00926"></a>00926         <span class="keywordflow">return</span>;
<a name="l00927"></a>00927     
<a name="l00928"></a>00928     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(from, last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>, <span class="keyword">sizeof</span>(from));
<a name="l00929"></a>00929 <span class="comment">// XXX  if (0==sbutton(from, 0, sizeof(from)-1, &quot;From: &quot;))</span>
<a name="l00930"></a>00930 <span class="comment">//      return;</span>
<a name="l00931"></a>00931     
<a name="l00932"></a>00932     <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(to, from, <span class="keyword">sizeof</span>(to));
<a name="l00933"></a>00933 <span class="comment">// XXX  if (0==sbutton(to, 0, sizeof(to)-1, &quot;To: &quot;))</span>
<a name="l00934"></a>00934 <span class="comment">//      return;</span>
<a name="l00935"></a>00935     
<a name="l00936"></a>00936     <span class="keywordflow">if</span> (strcmp(to, from) == 0)
<a name="l00937"></a>00937         <span class="keywordflow">return</span>;
<a name="l00938"></a>00938     
<a name="l00939"></a>00939     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aec8906c47a30af947fb6945abd9d0dab">SEQP_BEGIN</a>(ed, seq)
<a name="l00940"></a>00940     {
<a name="l00941"></a>00941         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l00942"></a>00942             <span class="keywordflow">if</span> (strncmp(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>, from, <a class="code" href="../../d1/d22/stdosl_8h.html#af902ac638d8127503ad64a0eacb3a7e8">strlen</a>(from)) == 0) {
<a name="l00943"></a>00943                 printf(<span class="stringliteral">&quot;found %s\n&quot;</span>, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>);
<a name="l00944"></a>00944                 
<a name="l00945"></a>00945                 <span class="comment">/* strip off the beginning */</span>
<a name="l00946"></a>00946                 stripped[0] = 0;
<a name="l00947"></a>00947                 <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(stripped, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a> + <a class="code" href="../../d1/d22/stdosl_8h.html#af902ac638d8127503ad64a0eacb3a7e8">strlen</a>(from), <a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>);
<a name="l00948"></a>00948                 
<a name="l00949"></a>00949                 <span class="comment">/* new path */</span>
<a name="l00950"></a>00950                 <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>, <span class="keyword">sizeof</span>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>), <span class="stringliteral">&quot;%s%s&quot;</span>, to, stripped);
<a name="l00951"></a>00951                 printf(<span class="stringliteral">&quot;new %s\n&quot;</span>, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>);
<a name="l00952"></a>00952             }
<a name="l00953"></a>00953         }
<a name="l00954"></a>00954     }
<a name="l00955"></a>00955     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>
<a name="l00956"></a>00956         
<a name="l00957"></a>00957 }
<a name="l00958"></a>00958 
<a name="l00959"></a>00959 
<a name="l00960"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a317d70df7cc8b2a3ed5442576beafd30">00960</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a26aa3564d15ae9e56cce569a324df5da">UNUSED_FUNCTION</a>(<a class="code" href="../../d0/d97/sequencer__edit_8c.html#a317d70df7cc8b2a3ed5442576beafd30">no_gaps</a>) (<a class="code" href="../../d9/d27/structScene.html">Scene</a> * scene)
<a name="l00961"></a>00961 {
<a name="l00962"></a>00962     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00963"></a>00963     <span class="keywordtype">int</span> cfra, first = 0, done;
<a name="l00964"></a>00964 
<a name="l00965"></a>00965     
<a name="l00966"></a>00966     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span>;
<a name="l00967"></a>00967 
<a name="l00968"></a>00968     <span class="keywordflow">for</span> (cfra = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>; cfra &lt;= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad256bf7a37ebe6e72d9ac63d4a4cea7a">EFRA</a>; cfra++) {
<a name="l00969"></a>00969         <span class="keywordflow">if</span> (first == 0) {
<a name="l00970"></a>00970             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aa2aa3a6a437bfc674fa35be67296daa5">evaluate_seq_frame</a>(scene, cfra) ) first = 1;
<a name="l00971"></a>00971         }
<a name="l00972"></a>00972         <span class="keywordflow">else</span> {
<a name="l00973"></a>00973             done = 1;
<a name="l00974"></a>00974             <span class="keywordflow">while</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aa2aa3a6a437bfc674fa35be67296daa5">evaluate_seq_frame</a>(scene, cfra) == 0) {
<a name="l00975"></a>00975                 done = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a2d5b42382c4d350908c01ac98da31e1b">insert_gap</a>(scene, -1, cfra);
<a name="l00976"></a>00976                 <span class="keywordflow">if</span> (done == 0) <span class="keywordflow">break</span>;
<a name="l00977"></a>00977             }
<a name="l00978"></a>00978             <span class="keywordflow">if</span> (done == 0) <span class="keywordflow">break</span>;
<a name="l00979"></a>00979         }
<a name="l00980"></a>00980     }
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 }
<a name="l00983"></a>00983 
<a name="l00984"></a>00984 <span class="preprocessor">#if 0</span>
<a name="l00985"></a>00985 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">int</span> seq_get_snaplimit(<a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d)
<a name="l00986"></a>00986 {
<a name="l00987"></a>00987     <span class="comment">/* fake mouse coords to get the snap value</span>
<a name="l00988"></a>00988 <span class="comment">     * a bit lazy but its only done once pre transform */</span>
<a name="l00989"></a>00989     <span class="keywordtype">float</span> xmouse, ymouse, x;
<a name="l00990"></a>00990     <span class="keywordtype">int</span> mval[2] = {24, 0}; <span class="comment">/* 24 screen px snap */</span>
<a name="l00991"></a>00991     
<a name="l00992"></a>00992     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, mval[0], mval[1], &amp;xmouse, &amp;ymouse);
<a name="l00993"></a>00993     x = xmouse;
<a name="l00994"></a>00994     mval[0] = 0;
<a name="l00995"></a>00995     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, mval[0], mval[1], &amp;xmouse, &amp;ymouse);
<a name="l00996"></a>00996     <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(x - xmouse);
<a name="l00997"></a>00997 }
<a name="l00998"></a>00998 <span class="preprocessor">#endif</span>
<a name="l00999"></a>00999 <span class="preprocessor"></span>
<a name="l01000"></a>01000 <span class="comment">/* Operator functions */</span>
<a name="l01001"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a7917afb60d906e3347ec211854961f4c">01001</a> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l01002"></a>01002 {
<a name="l01003"></a>01003     <span class="keywordflow">return</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01004"></a>01004 }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006 <span class="preprocessor">#if 0 </span><span class="comment">/* UNUSED */</span>
<a name="l01007"></a>01007 <span class="keywordtype">int</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#aa0364b0ec3798234e1f744da652e33a7">sequencer_strip_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l01008"></a>01008 {
<a name="l01009"></a>01009     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed;
<a name="l01010"></a>01010     <span class="keywordflow">return</span> (((ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)) != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a3557a6d5b10e3903ce4300e3dea13c36">act_seq</a> != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));
<a name="l01011"></a>01011 }
<a name="l01012"></a>01012 <span class="preprocessor">#endif</span>
<a name="l01013"></a>01013 <span class="preprocessor"></span>
<a name="l01014"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a1124cc71c3a2c3e253658e5b3de4a1f1">01014</a> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a1eb2756dbeaa62fee9df3e93e43f8840">sequencer_strip_has_path_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l01015"></a>01015 {
<a name="l01016"></a>01016     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed;
<a name="l01017"></a>01017     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01018"></a>01018     <span class="keywordflow">return</span> (((ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)) != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; ((seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a3557a6d5b10e3903ce4300e3dea13c36">act_seq</a>) != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a43ae010009490acc58f848d435af5bfa">SEQ_HAS_PATH</a>(seq)));
<a name="l01019"></a>01019 }
<a name="l01020"></a>01020 
<a name="l01021"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a07f5bfd7f14d9096565f21c9ed0ed4b6">01021</a> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6d3605795c2b5e972ab68160903d8839">sequencer_view_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l01022"></a>01022 {
<a name="l01023"></a>01023     <a class="code" href="../../df/d05/structSpaceSeq.html">SpaceSeq</a> *sseq = <a class="code" href="../../df/d01/BKE__context_8h.html#a66d4a98afec1ebc4ac0e6bd0f3168046">CTX_wm_space_seq</a>(C);
<a name="l01024"></a>01024     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C), <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01025"></a>01025     <span class="keywordflow">if</span> (ed &amp;&amp; sseq &amp;&amp; (sseq-&gt;<a class="code" href="../../df/d05/structSpaceSeq.html#a1690fabe7e2ef701c6a63ed2b2406840">mainb</a> == <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#ad5b89b5996803f2f045d524b8d5fad70">SEQ_DRAW_IMG_IMBUF</a>))
<a name="l01026"></a>01026         <span class="keywordflow">return</span> 1;
<a name="l01027"></a>01027 
<a name="l01028"></a>01028     <span class="keywordflow">return</span> 0;
<a name="l01029"></a>01029 }
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 <span class="comment">/* snap operator*/</span>
<a name="l01032"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0c23cd0afb12f9fb856ef938e272685a">01032</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0c23cd0afb12f9fb856ef938e272685a">sequencer_snap_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01033"></a>01033 {
<a name="l01034"></a>01034     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01035"></a>01035     
<a name="l01036"></a>01036     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01037"></a>01037     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01038"></a>01038     <span class="keywordtype">int</span> snap_frame;
<a name="l01039"></a>01039 
<a name="l01040"></a>01040     snap_frame = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;frame&quot;</span>);
<a name="l01041"></a>01041 
<a name="l01042"></a>01042     <span class="comment">/* also check metas */</span>
<a name="l01043"></a>01043     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01044"></a>01044         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a> &amp;&amp; !(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a0d2507c3a5dc4105ce8b2b85fc33e54b">depth</a> == 0 &amp;&amp; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4b25e64c42d68bdda834d7f6ddba73e2">SEQ_LOCK</a>) &amp;&amp;
<a name="l01045"></a>01045             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ae82ab3eea87645e2fa3c1d294c3a922c">seq_tx_test</a>(seq))
<a name="l01046"></a>01046         {
<a name="l01047"></a>01047             <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; (<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#afb4e85100d4223b01bf37f1d5c45ab28">SEQ_LEFTSEL</a> + <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a9449eade6a750ae240a932adbbea385d">SEQ_RIGHTSEL</a>)) == 0) {
<a name="l01048"></a>01048                 <span class="comment">/* simple but no anim update */</span>
<a name="l01049"></a>01049                 <span class="comment">/* seq-&gt;start= snap_frame-seq-&gt;startofs+seq-&gt;startstill; */</span>
<a name="l01050"></a>01050 
<a name="l01051"></a>01051                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7aa6ef5bba1f8e92bc5c67dcea04aa82">seq_translate</a>(scene, seq, (snap_frame - seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a> + seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a>) - seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a>);
<a name="l01052"></a>01052             }
<a name="l01053"></a>01053             <span class="keywordflow">else</span> {
<a name="l01054"></a>01054                 <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#afb4e85100d4223b01bf37f1d5c45ab28">SEQ_LEFTSEL</a>) {
<a name="l01055"></a>01055                     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a1c7252a47f403abf68879236f6d2d432">seq_tx_set_final_left</a>(seq, snap_frame);
<a name="l01056"></a>01056                 }
<a name="l01057"></a>01057                 <span class="keywordflow">else</span> { <span class="comment">/* SEQ_RIGHTSEL */</span>
<a name="l01058"></a>01058                     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ab185d4180ee610c2145508e8f13a6452">seq_tx_set_final_right</a>(seq, snap_frame);
<a name="l01059"></a>01059                 }
<a name="l01060"></a>01060                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aeaabb3a5ebb91b39ea2e01bb11d89a32">seq_tx_handle_xlimits</a>(seq, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#afb4e85100d4223b01bf37f1d5c45ab28">SEQ_LEFTSEL</a>, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a9449eade6a750ae240a932adbbea385d">SEQ_RIGHTSEL</a>);
<a name="l01061"></a>01061             }
<a name="l01062"></a>01062             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l01063"></a>01063         }
<a name="l01064"></a>01064     }
<a name="l01065"></a>01065 
<a name="l01066"></a>01066     <span class="comment">/* test for effects and overlap</span>
<a name="l01067"></a>01067 <span class="comment">     * don&#39;t use SEQP_BEGIN since that would be recursive */</span>
<a name="l01068"></a>01068     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01069"></a>01069         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a> &amp;&amp; !(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a0d2507c3a5dc4105ce8b2b85fc33e54b">depth</a> == 0 &amp;&amp; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4b25e64c42d68bdda834d7f6ddba73e2">SEQ_LOCK</a>)) {
<a name="l01070"></a>01070             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#aa7e3e092128d8c7fe75dc39e5893483d">SEQ_OVERLAP</a>;
<a name="l01071"></a>01071             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq) ) {
<a name="l01072"></a>01072                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq, scene);
<a name="l01073"></a>01073             }
<a name="l01074"></a>01074         }
<a name="l01075"></a>01075         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) {
<a name="l01076"></a>01076             <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a>-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) 
<a name="l01077"></a>01077                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l01078"></a>01078             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a>-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) 
<a name="l01079"></a>01079                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l01080"></a>01080             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a> &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) 
<a name="l01081"></a>01081                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l01082"></a>01082         }
<a name="l01083"></a>01083     }
<a name="l01084"></a>01084 
<a name="l01085"></a>01085     <span class="comment">/* as last: */</span>
<a name="l01086"></a>01086     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a351665cd83431f78daaffde840fc0da8">sort_seq</a>(scene);
<a name="l01087"></a>01087     
<a name="l01088"></a>01088     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01089"></a>01089     
<a name="l01090"></a>01090     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01091"></a>01091 }
<a name="l01092"></a>01092 
<a name="l01093"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a24634eac1969db06db5a16f940dbeb50">01093</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a24634eac1969db06db5a16f940dbeb50">sequencer_snap_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l01094"></a>01094 {
<a name="l01095"></a>01095     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01096"></a>01096     
<a name="l01097"></a>01097     <span class="keywordtype">int</span> snap_frame;
<a name="l01098"></a>01098     
<a name="l01099"></a>01099     snap_frame = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>;
<a name="l01100"></a>01100     
<a name="l01101"></a>01101     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;frame&quot;</span>, snap_frame);
<a name="l01102"></a>01102     <span class="keywordflow">return</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0c23cd0afb12f9fb856ef938e272685a">sequencer_snap_exec</a>(C, op);
<a name="l01103"></a>01103 }
<a name="l01104"></a>01104 
<a name="l01105"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a254dda6d6bebe0b476d6b3e50c6dc93c">01105</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a254dda6d6bebe0b476d6b3e50c6dc93c">SEQUENCER_OT_snap</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01106"></a>01106 {
<a name="l01107"></a>01107     <span class="comment">/* identifiers */</span>
<a name="l01108"></a>01108     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Snap strips&quot;</span>;
<a name="l01109"></a>01109     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_snap&quot;</span>;
<a name="l01110"></a>01110     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Frame where selected strips will be snapped&quot;</span>;
<a name="l01111"></a>01111     
<a name="l01112"></a>01112     <span class="comment">/* api callbacks */</span>
<a name="l01113"></a>01113     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a24634eac1969db06db5a16f940dbeb50">sequencer_snap_invoke</a>;
<a name="l01114"></a>01114     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0c23cd0afb12f9fb856ef938e272685a">sequencer_snap_exec</a>;
<a name="l01115"></a>01115     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01116"></a>01116     
<a name="l01117"></a>01117     <span class="comment">/* flags */</span>
<a name="l01118"></a>01118     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01119"></a>01119     
<a name="l01120"></a>01120     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;frame&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Frame&quot;</span>, <span class="stringliteral">&quot;Frame where selected strips will be snapped&quot;</span>, INT_MIN, INT_MAX);
<a name="l01121"></a>01121 }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123 <span class="comment">/* mute operator */</span>
<a name="l01124"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a13ea93d8f24f7d3cee58b46e6ce8c095">01124</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a13ea93d8f24f7d3cee58b46e6ce8c095">sequencer_mute_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01125"></a>01125 {
<a name="l01126"></a>01126     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01127"></a>01127     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01128"></a>01128     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01129"></a>01129     <span class="keywordtype">int</span> selected;
<a name="l01130"></a>01130 
<a name="l01131"></a>01131     selected = !<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;unselected&quot;</span>);
<a name="l01132"></a>01132     
<a name="l01133"></a>01133     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01134"></a>01134         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4b25e64c42d68bdda834d7f6ddba73e2">SEQ_LOCK</a>) == 0) {
<a name="l01135"></a>01135             <span class="keywordflow">if</span> (selected) { <span class="comment">/* mute unselected */</span>
<a name="l01136"></a>01136                 <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l01137"></a>01137                     seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a2e8c1156b04437b5fa537cf87d76eaff">SEQ_MUTE</a>;
<a name="l01138"></a>01138             }
<a name="l01139"></a>01139             <span class="keywordflow">else</span> {
<a name="l01140"></a>01140                 <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) == 0)
<a name="l01141"></a>01141                     seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a2e8c1156b04437b5fa537cf87d76eaff">SEQ_MUTE</a>;
<a name="l01142"></a>01142             }
<a name="l01143"></a>01143         }
<a name="l01144"></a>01144     }
<a name="l01145"></a>01145     
<a name="l01146"></a>01146     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#acf8f5ba64230d559c282e40ba7070a02">seq_update_muting</a>(ed);
<a name="l01147"></a>01147     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01148"></a>01148     
<a name="l01149"></a>01149     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01150"></a>01150 }
<a name="l01151"></a>01151 
<a name="l01152"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a48e4c2a3fe3ed77031e51e30f326dd95">01152</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a48e4c2a3fe3ed77031e51e30f326dd95">SEQUENCER_OT_mute</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01153"></a>01153 {
<a name="l01154"></a>01154     <span class="comment">/* identifiers */</span>
<a name="l01155"></a>01155     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Mute Strips&quot;</span>;
<a name="l01156"></a>01156     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_mute&quot;</span>;
<a name="l01157"></a>01157     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Mute selected strips&quot;</span>;
<a name="l01158"></a>01158     
<a name="l01159"></a>01159     <span class="comment">/* api callbacks */</span>
<a name="l01160"></a>01160     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a13ea93d8f24f7d3cee58b46e6ce8c095">sequencer_mute_exec</a>;
<a name="l01161"></a>01161     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01162"></a>01162     
<a name="l01163"></a>01163     <span class="comment">/* flags */</span>
<a name="l01164"></a>01164     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01165"></a>01165     
<a name="l01166"></a>01166     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;unselected&quot;</span>, 0, <span class="stringliteral">&quot;Unselected&quot;</span>, <span class="stringliteral">&quot;Mute unselected rather than selected strips&quot;</span>);
<a name="l01167"></a>01167 }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169 
<a name="l01170"></a>01170 <span class="comment">/* unmute operator */</span>
<a name="l01171"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7aff2bb2f251f6004a9080ef7283fcae">01171</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7aff2bb2f251f6004a9080ef7283fcae">sequencer_unmute_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01172"></a>01172 {
<a name="l01173"></a>01173     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01174"></a>01174     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01175"></a>01175     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01176"></a>01176     <span class="keywordtype">int</span> selected;
<a name="l01177"></a>01177 
<a name="l01178"></a>01178     selected = !<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;unselected&quot;</span>);
<a name="l01179"></a>01179     
<a name="l01180"></a>01180     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01181"></a>01181         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4b25e64c42d68bdda834d7f6ddba73e2">SEQ_LOCK</a>) == 0) {
<a name="l01182"></a>01182             <span class="keywordflow">if</span> (selected) { <span class="comment">/* unmute unselected */</span>
<a name="l01183"></a>01183                 <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)
<a name="l01184"></a>01184                     seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a2e8c1156b04437b5fa537cf87d76eaff">SEQ_MUTE</a>;
<a name="l01185"></a>01185             }
<a name="l01186"></a>01186             <span class="keywordflow">else</span> {
<a name="l01187"></a>01187                 <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) == 0)
<a name="l01188"></a>01188                     seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a2e8c1156b04437b5fa537cf87d76eaff">SEQ_MUTE</a>;
<a name="l01189"></a>01189             }
<a name="l01190"></a>01190         }
<a name="l01191"></a>01191     }
<a name="l01192"></a>01192     
<a name="l01193"></a>01193     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#acf8f5ba64230d559c282e40ba7070a02">seq_update_muting</a>(ed);
<a name="l01194"></a>01194     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01195"></a>01195     
<a name="l01196"></a>01196     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01197"></a>01197 }
<a name="l01198"></a>01198 
<a name="l01199"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a23527fc5cab0641e95122ab5f97936d9">01199</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a23527fc5cab0641e95122ab5f97936d9">SEQUENCER_OT_unmute</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01200"></a>01200 {
<a name="l01201"></a>01201     <span class="comment">/* identifiers */</span>
<a name="l01202"></a>01202     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Un-Mute Strips&quot;</span>;
<a name="l01203"></a>01203     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_unmute&quot;</span>;
<a name="l01204"></a>01204     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Un-Mute unselected rather than selected strips&quot;</span>;
<a name="l01205"></a>01205     
<a name="l01206"></a>01206     <span class="comment">/* api callbacks */</span>
<a name="l01207"></a>01207     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7aff2bb2f251f6004a9080ef7283fcae">sequencer_unmute_exec</a>;
<a name="l01208"></a>01208     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01209"></a>01209     
<a name="l01210"></a>01210     <span class="comment">/* flags */</span>
<a name="l01211"></a>01211     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01212"></a>01212     
<a name="l01213"></a>01213     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;unselected&quot;</span>, 0, <span class="stringliteral">&quot;Unselected&quot;</span>, <span class="stringliteral">&quot;UnMute unselected rather than selected strips&quot;</span>);
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 
<a name="l01217"></a>01217 <span class="comment">/* lock operator */</span>
<a name="l01218"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aca85d5e5f8c78202587ef7db75123b2c">01218</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aca85d5e5f8c78202587ef7db75123b2c">sequencer_lock_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01219"></a>01219 {
<a name="l01220"></a>01220     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01221"></a>01221     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01222"></a>01222     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01223"></a>01223 
<a name="l01224"></a>01224     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01225"></a>01225         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l01226"></a>01226             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4b25e64c42d68bdda834d7f6ddba73e2">SEQ_LOCK</a>;
<a name="l01227"></a>01227         }
<a name="l01228"></a>01228     }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01231"></a>01231 
<a name="l01232"></a>01232     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01233"></a>01233 }
<a name="l01234"></a>01234 
<a name="l01235"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#aae6b4b7181b00ca4a741aee1c563355e">01235</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aae6b4b7181b00ca4a741aee1c563355e">SEQUENCER_OT_lock</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01236"></a>01236 {
<a name="l01237"></a>01237     <span class="comment">/* identifiers */</span>
<a name="l01238"></a>01238     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Lock Strips&quot;</span>;
<a name="l01239"></a>01239     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_lock&quot;</span>;
<a name="l01240"></a>01240     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Lock the active strip so that it can&#39;t be transformed&quot;</span>;
<a name="l01241"></a>01241     
<a name="l01242"></a>01242     <span class="comment">/* api callbacks */</span>
<a name="l01243"></a>01243     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aca85d5e5f8c78202587ef7db75123b2c">sequencer_lock_exec</a>;
<a name="l01244"></a>01244     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01245"></a>01245     
<a name="l01246"></a>01246     <span class="comment">/* flags */</span>
<a name="l01247"></a>01247     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01248"></a>01248 }
<a name="l01249"></a>01249 
<a name="l01250"></a>01250 <span class="comment">/* unlock operator */</span>
<a name="l01251"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aadf10d6ead148f003f87ea8a34c88a84">01251</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aadf10d6ead148f003f87ea8a34c88a84">sequencer_unlock_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01252"></a>01252 {
<a name="l01253"></a>01253     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01254"></a>01254     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01255"></a>01255     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01256"></a>01256 
<a name="l01257"></a>01257     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01258"></a>01258         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l01259"></a>01259             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4b25e64c42d68bdda834d7f6ddba73e2">SEQ_LOCK</a>;
<a name="l01260"></a>01260         }
<a name="l01261"></a>01261     }
<a name="l01262"></a>01262 
<a name="l01263"></a>01263     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01264"></a>01264 
<a name="l01265"></a>01265     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01266"></a>01266 }
<a name="l01267"></a>01267 
<a name="l01268"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#aa5b49f4d7731a75d60b16529877bd6c6">01268</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa5b49f4d7731a75d60b16529877bd6c6">SEQUENCER_OT_unlock</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01269"></a>01269 {
<a name="l01270"></a>01270     <span class="comment">/* identifiers */</span>
<a name="l01271"></a>01271     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;UnLock Strips&quot;</span>;
<a name="l01272"></a>01272     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_unlock&quot;</span>;
<a name="l01273"></a>01273     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Unlock the active strip so that it can&#39;t be transformed&quot;</span>;
<a name="l01274"></a>01274     
<a name="l01275"></a>01275     <span class="comment">/* api callbacks */</span>
<a name="l01276"></a>01276     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aadf10d6ead148f003f87ea8a34c88a84">sequencer_unlock_exec</a>;
<a name="l01277"></a>01277     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01278"></a>01278     
<a name="l01279"></a>01279     <span class="comment">/* flags */</span>
<a name="l01280"></a>01280     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01281"></a>01281 }
<a name="l01282"></a>01282 
<a name="l01283"></a>01283 <span class="comment">/* reload operator */</span>
<a name="l01284"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a33df5e4765d32dab1228070492e55207">01284</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a33df5e4765d32dab1228070492e55207">sequencer_reload_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01285"></a>01285 {
<a name="l01286"></a>01286     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01287"></a>01287     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01288"></a>01288     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01289"></a>01289     <span class="keywordtype">int</span> adjust_length = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;adjust_length&quot;</span>);
<a name="l01290"></a>01290 
<a name="l01291"></a>01291     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01292"></a>01292         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l01293"></a>01293             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a593b927f446765f9b1b83c513a86856c">update_changed_seq_and_deps</a>(scene, seq, 0, 1);
<a name="l01294"></a>01294             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a104ada50dedffcd571655161b01e695a">reload_sequence_new_file</a>(scene, seq, !adjust_length);
<a name="l01295"></a>01295 
<a name="l01296"></a>01296             <span class="keywordflow">if</span> (adjust_length) {
<a name="l01297"></a>01297                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq))
<a name="l01298"></a>01298                     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq, scene);
<a name="l01299"></a>01299             }
<a name="l01300"></a>01300         }
<a name="l01301"></a>01301     }
<a name="l01302"></a>01302 
<a name="l01303"></a>01303     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01304"></a>01304 
<a name="l01305"></a>01305     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01306"></a>01306 }
<a name="l01307"></a>01307 
<a name="l01308"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#afbd5aba9b7e675a2d946cdd5d16baac7">01308</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#afbd5aba9b7e675a2d946cdd5d16baac7">SEQUENCER_OT_reload</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01309"></a>01309 {
<a name="l01310"></a>01310     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l01311"></a>01311 
<a name="l01312"></a>01312     <span class="comment">/* identifiers */</span>
<a name="l01313"></a>01313     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Reload Strips&quot;</span>;
<a name="l01314"></a>01314     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_reload&quot;</span>;
<a name="l01315"></a>01315     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Reload strips in the sequencer&quot;</span>;
<a name="l01316"></a>01316     
<a name="l01317"></a>01317     <span class="comment">/* api callbacks */</span>
<a name="l01318"></a>01318     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a33df5e4765d32dab1228070492e55207">sequencer_reload_exec</a>;
<a name="l01319"></a>01319     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01320"></a>01320     
<a name="l01321"></a>01321     <span class="comment">/* flags */</span>
<a name="l01322"></a>01322     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>; <span class="comment">/* no undo, the data changed is stored outside &#39;main&#39; */</span>
<a name="l01323"></a>01323 
<a name="l01324"></a>01324     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;adjust_length&quot;</span>, 0, <span class="stringliteral">&quot;Adjust Length&quot;</span>,
<a name="l01325"></a>01325                            <span class="stringliteral">&quot;Adjust lenght of strips to their data lenght&quot;</span>);
<a name="l01326"></a>01326     <a class="code" href="../../dc/d7e/rna__define_8c.html#a97e75cad8daa0d94523c8df118947191">RNA_def_property_flag</a>(prop, <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ac49bd36c069e337f7ee269c672ef1332">PROP_SKIP_SAVE</a>);
<a name="l01327"></a>01327 }
<a name="l01328"></a>01328 
<a name="l01329"></a>01329 <span class="comment">/* reload operator */</span>
<a name="l01330"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6620b96ab1d1bb4a2eb5115b1e4f9ca5">01330</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6620b96ab1d1bb4a2eb5115b1e4f9ca5">sequencer_refresh_all_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01331"></a>01331 {
<a name="l01332"></a>01332     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01333"></a>01333     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01334"></a>01334 
<a name="l01335"></a>01335     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a4dee98589098f19747a1caaecf7c0b9c">free_imbuf_seq</a>(scene, &amp;ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01336"></a>01336 
<a name="l01337"></a>01337     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01338"></a>01338 
<a name="l01339"></a>01339     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01340"></a>01340 }
<a name="l01341"></a>01341 
<a name="l01342"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ad054ae514aa3c5990938410b42359f41">01342</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad054ae514aa3c5990938410b42359f41">SEQUENCER_OT_refresh_all</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01343"></a>01343 {
<a name="l01344"></a>01344     <span class="comment">/* identifiers */</span>
<a name="l01345"></a>01345     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Refresh Sequencer&quot;</span>;
<a name="l01346"></a>01346     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_refresh_all&quot;</span>;
<a name="l01347"></a>01347     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Refresh the sequencer editor&quot;</span>;
<a name="l01348"></a>01348     
<a name="l01349"></a>01349     <span class="comment">/* api callbacks */</span>
<a name="l01350"></a>01350     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6620b96ab1d1bb4a2eb5115b1e4f9ca5">sequencer_refresh_all_exec</a>;
<a name="l01351"></a>01351     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01352"></a>01352 }
<a name="l01353"></a>01353 
<a name="l01354"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0f1776c339f38d40d723f7cd7157fd6c">01354</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0f1776c339f38d40d723f7cd7157fd6c">sequencer_reassign_inputs_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01355"></a>01355 {
<a name="l01356"></a>01356     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01357"></a>01357     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq1, *seq2, *seq3, *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l01358"></a>01358     <span class="keyword">const</span> <span class="keywordtype">char</span> *error_msg;
<a name="l01359"></a>01359 
<a name="l01360"></a>01360     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3267c0a6ae74bba7f75bfb0f604b53ef">seq_effect_find_selected</a>(scene, last_seq, last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a>, &amp;seq1, &amp;seq2, &amp;seq3, &amp;error_msg)) {
<a name="l01361"></a>01361         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, error_msg);
<a name="l01362"></a>01362         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01363"></a>01363     }
<a name="l01364"></a>01364     <span class="comment">/* see reassigning would create a cycle */</span>
<a name="l01365"></a>01365     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">seq_is_predecessor</a>(seq1, last_seq) ||
<a name="l01366"></a>01366         <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">seq_is_predecessor</a>(seq2, last_seq) ||
<a name="l01367"></a>01367         <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0102049c565994871d4352c3ede669a1">seq_is_predecessor</a>(seq3, last_seq)
<a name="l01368"></a>01368         ) {
<a name="l01369"></a>01369         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Can&#39;t reassign inputs: no cycles allowed&quot;</span>);
<a name="l01370"></a>01370         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01371"></a>01371     }
<a name="l01372"></a>01372 
<a name="l01373"></a>01373     last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> = seq1;
<a name="l01374"></a>01374     last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> = seq2;
<a name="l01375"></a>01375     last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a> = seq3;
<a name="l01376"></a>01376 
<a name="l01377"></a>01377     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a593b927f446765f9b1b83c513a86856c">update_changed_seq_and_deps</a>(scene, last_seq, 1, 1);
<a name="l01378"></a>01378 
<a name="l01379"></a>01379     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01380"></a>01380 
<a name="l01381"></a>01381     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01382"></a>01382 }
<a name="l01383"></a>01383 
<a name="l01384"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd537c83115c645841b9cdf43255ae87">01384</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd537c83115c645841b9cdf43255ae87">sequencer_effect_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C)
<a name="l01385"></a>01385 {
<a name="l01386"></a>01386     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01387"></a>01387     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01388"></a>01388 
<a name="l01389"></a>01389     <span class="keywordflow">if</span> (ed) {
<a name="l01390"></a>01390         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l01391"></a>01391         <span class="keywordflow">if</span> (last_seq &amp;&amp; (last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>)) {
<a name="l01392"></a>01392             <span class="keywordflow">return</span> 1;
<a name="l01393"></a>01393         }
<a name="l01394"></a>01394     }
<a name="l01395"></a>01395 
<a name="l01396"></a>01396     <span class="keywordflow">return</span> 0;
<a name="l01397"></a>01397 }
<a name="l01398"></a>01398 
<a name="l01399"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a29fb8e2e0a2ee44f6b8e11638e649951">01399</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a29fb8e2e0a2ee44f6b8e11638e649951">SEQUENCER_OT_reassign_inputs</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01400"></a>01400 {
<a name="l01401"></a>01401     <span class="comment">/* identifiers */</span>
<a name="l01402"></a>01402     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Reassign Inputs&quot;</span>;
<a name="l01403"></a>01403     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_reassign_inputs&quot;</span>;
<a name="l01404"></a>01404     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Reassign the inputs for the effect strip&quot;</span>;
<a name="l01405"></a>01405 
<a name="l01406"></a>01406     <span class="comment">/* api callbacks */</span>
<a name="l01407"></a>01407     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a0f1776c339f38d40d723f7cd7157fd6c">sequencer_reassign_inputs_exec</a>;
<a name="l01408"></a>01408     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd537c83115c645841b9cdf43255ae87">sequencer_effect_poll</a>;
<a name="l01409"></a>01409 
<a name="l01410"></a>01410     <span class="comment">/* flags */</span>
<a name="l01411"></a>01411     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01412"></a>01412 }
<a name="l01413"></a>01413 
<a name="l01414"></a>01414 
<a name="l01415"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae06eb058bde40f6644c5a3d283209eda">01415</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae06eb058bde40f6644c5a3d283209eda">sequencer_swap_inputs_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01416"></a>01416 {
<a name="l01417"></a>01417     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01418"></a>01418     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l01419"></a>01419 
<a name="l01420"></a>01420     <span class="keywordflow">if</span> (last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01421"></a>01421         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;No valid inputs to swap&quot;</span>);
<a name="l01422"></a>01422         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01423"></a>01423     }
<a name="l01424"></a>01424 
<a name="l01425"></a>01425     seq = last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a>;
<a name="l01426"></a>01426     last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> = last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a>;
<a name="l01427"></a>01427     last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> = seq;
<a name="l01428"></a>01428 
<a name="l01429"></a>01429     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a593b927f446765f9b1b83c513a86856c">update_changed_seq_and_deps</a>(scene, last_seq, 1, 1);
<a name="l01430"></a>01430 
<a name="l01431"></a>01431     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01432"></a>01432 
<a name="l01433"></a>01433     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01434"></a>01434 }
<a name="l01435"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#afe7d286925c3c47623a958b4e3776435">01435</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#afe7d286925c3c47623a958b4e3776435">SEQUENCER_OT_swap_inputs</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01436"></a>01436 {
<a name="l01437"></a>01437     <span class="comment">/* identifiers */</span>
<a name="l01438"></a>01438     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Swap Inputs&quot;</span>;
<a name="l01439"></a>01439     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_swap_inputs&quot;</span>;
<a name="l01440"></a>01440     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Swap the first two inputs for the effect strip&quot;</span>;
<a name="l01441"></a>01441 
<a name="l01442"></a>01442     <span class="comment">/* api callbacks */</span>
<a name="l01443"></a>01443     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae06eb058bde40f6644c5a3d283209eda">sequencer_swap_inputs_exec</a>;
<a name="l01444"></a>01444     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd537c83115c645841b9cdf43255ae87">sequencer_effect_poll</a>;
<a name="l01445"></a>01445 
<a name="l01446"></a>01446     <span class="comment">/* flags */</span>
<a name="l01447"></a>01447     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01448"></a>01448 }
<a name="l01449"></a>01449 
<a name="l01450"></a>01450 
<a name="l01451"></a>01451 <span class="comment">/* cut operator */</span>
<a name="l01452"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a1f908c3a4e346660192ddc7946e9b371">01452</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a1f908c3a4e346660192ddc7946e9b371">prop_cut_types</a>[] = {
<a name="l01453"></a>01453     {<a class="code" href="../../db/d4a/sequencer__intern_8h.html#afb24d298ddd4bc4ff61aa333f07a574aa794868aacb1ec0020420573d480713d5">SEQ_CUT_SOFT</a>, <span class="stringliteral">&quot;SOFT&quot;</span>, 0, <span class="stringliteral">&quot;Soft&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01454"></a>01454     {<a class="code" href="../../db/d4a/sequencer__intern_8h.html#afb24d298ddd4bc4ff61aa333f07a574aa282febe71cb62acdc0cc4ae2967c4bbd">SEQ_CUT_HARD</a>, <span class="stringliteral">&quot;HARD&quot;</span>, 0, <span class="stringliteral">&quot;Hard&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01455"></a>01455     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l01456"></a>01456 };
<a name="l01457"></a>01457 
<a name="l01458"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c19833fada77481c7694e73c2a5a28b">01458</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c19833fada77481c7694e73c2a5a28b">sequencer_cut_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01459"></a>01459 {
<a name="l01460"></a>01460     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01461"></a>01461     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01462"></a>01462     <span class="keywordtype">int</span> cut_side, cut_hard, cut_frame;
<a name="l01463"></a>01463 
<a name="l01464"></a>01464     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> newlist;
<a name="l01465"></a>01465     <span class="keywordtype">int</span> changed;
<a name="l01466"></a>01466 
<a name="l01467"></a>01467     cut_frame = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;frame&quot;</span>);
<a name="l01468"></a>01468     cut_hard = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l01469"></a>01469     cut_side = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;side&quot;</span>);
<a name="l01470"></a>01470     
<a name="l01471"></a>01471     newlist.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> = newlist.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01472"></a>01472 
<a name="l01473"></a>01473     <span class="keywordflow">if</span> (cut_hard == <a class="code" href="../../db/d4a/sequencer__intern_8h.html#afb24d298ddd4bc4ff61aa333f07a574aa282febe71cb62acdc0cc4ae2967c4bbd">SEQ_CUT_HARD</a>) {
<a name="l01474"></a>01474         changed = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a4fe9b20057ddd7afec19b1df2e6ae882">cut_seq_list</a>(scene, ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, &amp;newlist, cut_frame, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea0a70db317b299e94b0c2a976f157ba">cut_seq_hard</a>);
<a name="l01475"></a>01475     }
<a name="l01476"></a>01476     <span class="keywordflow">else</span> {
<a name="l01477"></a>01477         changed = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a4fe9b20057ddd7afec19b1df2e6ae882">cut_seq_list</a>(scene, ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, &amp;newlist, cut_frame, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac1c2dda8286ac0531562580eb35af7dd">cut_seq_soft</a>);
<a name="l01478"></a>01478     }
<a name="l01479"></a>01479     
<a name="l01480"></a>01480     <span class="keywordflow">if</span> (newlist.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) { <span class="comment">/* got new strips ? */</span>
<a name="l01481"></a>01481         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01482"></a>01482         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aea47205fbf4fc9965bc2b06e7e3ca75a">BLI_movelisttolist</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, &amp;newlist);
<a name="l01483"></a>01483 
<a name="l01484"></a>01484         <span class="keywordflow">if</span> (cut_side != <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a1dbe295d258279a487794ff49fe4fda6">SEQ_SIDE_BOTH</a>) {
<a name="l01485"></a>01485             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aec8906c47a30af947fb6945abd9d0dab">SEQP_BEGIN</a>(ed, seq) {
<a name="l01486"></a>01486                 <span class="keywordflow">if</span> (cut_side == <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>) {
<a name="l01487"></a>01487                     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt;= cut_frame) {
<a name="l01488"></a>01488                         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a83f85f3b9e0027d9abe86402913b1037">SEQ_ALLSEL</a>;
<a name="l01489"></a>01489                     }
<a name="l01490"></a>01490                 }
<a name="l01491"></a>01491                 <span class="keywordflow">else</span> {
<a name="l01492"></a>01492                     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> &lt;= cut_frame) {
<a name="l01493"></a>01493                         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a83f85f3b9e0027d9abe86402913b1037">SEQ_ALLSEL</a>;
<a name="l01494"></a>01494                     }
<a name="l01495"></a>01495                 }
<a name="l01496"></a>01496             }
<a name="l01497"></a>01497             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#afb362a5bc3609465e99eeaac37d5350a">SEQ_END</a>;
<a name="l01498"></a>01498         }
<a name="l01499"></a>01499         <span class="comment">/* as last: */</span>
<a name="l01500"></a>01500         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a351665cd83431f78daaffde840fc0da8">sort_seq</a>(scene);
<a name="l01501"></a>01501     }
<a name="l01502"></a>01502 
<a name="l01503"></a>01503     <span class="keywordflow">if</span> (changed) {
<a name="l01504"></a>01504         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01505"></a>01505         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01506"></a>01506     }
<a name="l01507"></a>01507     <span class="keywordflow">else</span> {
<a name="l01508"></a>01508         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01509"></a>01509     }
<a name="l01510"></a>01510 }
<a name="l01511"></a>01511 
<a name="l01512"></a>01512 
<a name="l01513"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae1fee83fd04e6573d137a2e3191e0fc5">01513</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae1fee83fd04e6573d137a2e3191e0fc5">sequencer_cut_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01514"></a>01514 {
<a name="l01515"></a>01515     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01516"></a>01516     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = <a class="code" href="../../d5/d63/UI__view2d_8h.html#a5438d7c06bc8dbbb2746da95bcbcefb5">UI_view2d_fromcontext</a>(C);
<a name="l01517"></a>01517 
<a name="l01518"></a>01518     <span class="keywordtype">int</span> cut_side = <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a1dbe295d258279a487794ff49fe4fda6">SEQ_SIDE_BOTH</a>;
<a name="l01519"></a>01519     <span class="keywordtype">int</span> cut_frame = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>;
<a name="l01520"></a>01520 
<a name="l01521"></a>01521     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>(C) &amp;&amp; v2d)
<a name="l01522"></a>01522         cut_side = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab145ac90a396fd9ce2384c7b068f2dfb">mouse_frame_side</a>(v2d, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a7ecdf2416014628878116151dcb377f1">mval</a>[0], cut_frame);
<a name="l01523"></a>01523     
<a name="l01524"></a>01524     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;frame&quot;</span>, cut_frame);
<a name="l01525"></a>01525     <a class="code" href="../../d3/d10/rna__access_8c.html#ad70d450cec9fe951de69b8c9128b8cc4">RNA_enum_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;side&quot;</span>, cut_side);
<a name="l01526"></a>01526     <span class="comment">/*RNA_enum_set(op-&gt;ptr, &quot;type&quot;, cut_hard); */</span> <span class="comment">/*This type is set from the key shortcut */</span>
<a name="l01527"></a>01527 
<a name="l01528"></a>01528     <span class="keywordflow">return</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c19833fada77481c7694e73c2a5a28b">sequencer_cut_exec</a>(C, op);
<a name="l01529"></a>01529 }
<a name="l01530"></a>01530 
<a name="l01531"></a>01531 
<a name="l01532"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a2671f8c86ed9b059927aaea7d93fadae">01532</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a2671f8c86ed9b059927aaea7d93fadae">SEQUENCER_OT_cut</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01533"></a>01533 {
<a name="l01534"></a>01534     <span class="comment">/* identifiers */</span>
<a name="l01535"></a>01535     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Cut Strips&quot;</span>;
<a name="l01536"></a>01536     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_cut&quot;</span>;
<a name="l01537"></a>01537     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Cut the selected strips&quot;</span>;
<a name="l01538"></a>01538     
<a name="l01539"></a>01539     <span class="comment">/* api callbacks */</span>
<a name="l01540"></a>01540     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae1fee83fd04e6573d137a2e3191e0fc5">sequencer_cut_invoke</a>;
<a name="l01541"></a>01541     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c19833fada77481c7694e73c2a5a28b">sequencer_cut_exec</a>;
<a name="l01542"></a>01542     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01543"></a>01543     
<a name="l01544"></a>01544     <span class="comment">/* flags */</span>
<a name="l01545"></a>01545     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01546"></a>01546     
<a name="l01547"></a>01547     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;frame&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Frame&quot;</span>, <span class="stringliteral">&quot;Frame where selected strips will be cut&quot;</span>, INT_MIN, INT_MAX);
<a name="l01548"></a>01548     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, prop_cut_types, <a class="code" href="../../db/d4a/sequencer__intern_8h.html#afb24d298ddd4bc4ff61aa333f07a574aa794868aacb1ec0020420573d480713d5">SEQ_CUT_SOFT</a>, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;The type of cut operation to perform on strips&quot;</span>);
<a name="l01549"></a>01549     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;side&quot;</span>, prop_side_types, <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a1dbe295d258279a487794ff49fe4fda6">SEQ_SIDE_BOTH</a>, <span class="stringliteral">&quot;Side&quot;</span>, <span class="stringliteral">&quot;The side that remains selected after cutting&quot;</span>);
<a name="l01550"></a>01550 }
<a name="l01551"></a>01551 
<a name="l01552"></a>01552 <span class="comment">/* duplicate operator */</span>
<a name="l01553"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd0b3b45597e42af1e6e22d1c0cd828d">01553</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd0b3b45597e42af1e6e22d1c0cd828d">apply_unique_name_cb</a>(<a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, <span class="keywordtype">void</span> *arg_pt)
<a name="l01554"></a>01554 {
<a name="l01555"></a>01555     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = (<a class="code" href="../../d9/d27/structScene.html">Scene</a> *)arg_pt;
<a name="l01556"></a>01556     <span class="keywordtype">char</span> name[<span class="keyword">sizeof</span>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a>) - 2];
<a name="l01557"></a>01557 
<a name="l01558"></a>01558     strcpy(name, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a> + 2);
<a name="l01559"></a>01559     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ac8a5c77b4ca3351b21f74890f845c681">seqbase_unique_name_recursive</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, seq);
<a name="l01560"></a>01560     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ae48bea74a4be78d04e67889d36f2c205">seq_dupe_animdata</a>(scene, name, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a> + 2);
<a name="l01561"></a>01561     <span class="keywordflow">return</span> 1;
<a name="l01562"></a>01562 
<a name="l01563"></a>01563 }
<a name="l01564"></a>01564 
<a name="l01565"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a752f5f070fa606514e5c5e0c47bfd6c7">01565</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a752f5f070fa606514e5c5e0c47bfd6c7">sequencer_add_duplicate_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01566"></a>01566 {
<a name="l01567"></a>01567     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01568"></a>01568     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01569"></a>01569 
<a name="l01570"></a>01570     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> nseqbase = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l01571"></a>01571 
<a name="l01572"></a>01572     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01573"></a>01573         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01574"></a>01574 
<a name="l01575"></a>01575     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a6a19420861bba9c05e0d73b5b54e7ff6">seqbase_dupli_recursive</a>(scene, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;nseqbase, ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a72e2c51aea0ee75becd768fe7f53fdc7">SEQ_DUPE_CONTEXT</a>);
<a name="l01576"></a>01576 
<a name="l01577"></a>01577     <span class="keywordflow">if</span> (nseqbase.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) {
<a name="l01578"></a>01578         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq = nseqbase.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01579"></a>01579         <span class="comment">/* rely on the nseqbase list being added at the end */</span>
<a name="l01580"></a>01580         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aea47205fbf4fc9965bc2b06e7e3ca75a">BLI_movelisttolist</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, &amp;nseqbase);
<a name="l01581"></a>01581 
<a name="l01582"></a>01582         <span class="keywordflow">for</span> (; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>)
<a name="l01583"></a>01583             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aa1d91fc50da4428f24c3c6ffb0b013a2">seq_recursive_apply</a>(seq, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd0b3b45597e42af1e6e22d1c0cd828d">apply_unique_name_cb</a>, scene);
<a name="l01584"></a>01584 
<a name="l01585"></a>01585         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01586"></a>01586         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01587"></a>01587     }
<a name="l01588"></a>01588 
<a name="l01589"></a>01589     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01590"></a>01590 }
<a name="l01591"></a>01591 
<a name="l01592"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aed2f3a730f5c69052a47877a1e3b5ba0">01592</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aed2f3a730f5c69052a47877a1e3b5ba0">sequencer_add_duplicate_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l01593"></a>01593 {
<a name="l01594"></a>01594     <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a752f5f070fa606514e5c5e0c47bfd6c7">sequencer_add_duplicate_exec</a>(C, op);
<a name="l01595"></a>01595 
<a name="l01596"></a>01596     <a class="code" href="../../d3/d10/rna__access_8c.html#ad70d450cec9fe951de69b8c9128b8cc4">RNA_enum_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;mode&quot;</span>, <a class="code" href="../../d8/df2/ED__transform_8h.html#aa57e16cd48de3b9a989056ff8df26f84ac6708d3325ae542bd46d599286c1cf90">TFM_TRANSLATION</a>);
<a name="l01597"></a>01597     <a class="code" href="../../df/db0/wm__event__system_8c.html#a0208cd65e2ce6a150f2653214cfc57dd">WM_operator_name_call</a>(C, <span class="stringliteral">&quot;TRANSFORM_OT_transform&quot;</span>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39a0a4b36fb214cf9c59486cd041c118bd6">WM_OP_INVOKE_REGION_WIN</a>, op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>);
<a name="l01598"></a>01598 
<a name="l01599"></a>01599     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01600"></a>01600 }
<a name="l01601"></a>01601 
<a name="l01602"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a506ed2866f6d3c61b1568cc58cc3083f">01602</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa6269df495f5ee0166c4be3469b1a231">SEQUENCER_OT_duplicate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01603"></a>01603 {
<a name="l01604"></a>01604     <span class="comment">/* identifiers */</span>
<a name="l01605"></a>01605     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Duplicate Strips&quot;</span>;
<a name="l01606"></a>01606     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_duplicate&quot;</span>;
<a name="l01607"></a>01607     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Duplicate the selected strips&quot;</span>;
<a name="l01608"></a>01608     
<a name="l01609"></a>01609     <span class="comment">/* api callbacks */</span>
<a name="l01610"></a>01610     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aed2f3a730f5c69052a47877a1e3b5ba0">sequencer_add_duplicate_invoke</a>;
<a name="l01611"></a>01611     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a752f5f070fa606514e5c5e0c47bfd6c7">sequencer_add_duplicate_exec</a>;
<a name="l01612"></a>01612     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l01613"></a>01613     
<a name="l01614"></a>01614     <span class="comment">/* flags */</span>
<a name="l01615"></a>01615     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01616"></a>01616     
<a name="l01617"></a>01617     <span class="comment">/* to give to transform */</span>
<a name="l01618"></a>01618     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mode&quot;</span>, <a class="code" href="../../d3/d0f/transform__ops_8c.html#a0cc49fe43d3d0f938a1fc45c4cae96af">transform_mode_types</a>, <a class="code" href="../../d8/df2/ED__transform_8h.html#aa57e16cd48de3b9a989056ff8df26f84ac6708d3325ae542bd46d599286c1cf90">TFM_TRANSLATION</a>, <span class="stringliteral">&quot;Mode&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01619"></a>01619 }
<a name="l01620"></a>01620 
<a name="l01621"></a>01621 <span class="comment">/* delete operator */</span>
<a name="l01622"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a93aa627cb625079b96c447d8fe3995b5">01622</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a93aa627cb625079b96c447d8fe3995b5">sequencer_delete_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01623"></a>01623 {
<a name="l01624"></a>01624     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01625"></a>01625     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01626"></a>01626     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01627"></a>01627     <a class="code" href="../../de/d91/structMetaStack.html">MetaStack</a> *ms;
<a name="l01628"></a>01628     <span class="keywordtype">int</span> nothingSelected = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01629"></a>01629 
<a name="l01630"></a>01630     seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l01631"></a>01631     <span class="keywordflow">if</span> (seq &amp;&amp; seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) { <span class="comment">/* avoid a loop since this is likely to be selected */</span>
<a name="l01632"></a>01632         nothingSelected = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01633"></a>01633     }
<a name="l01634"></a>01634     <span class="keywordflow">else</span> {
<a name="l01635"></a>01635         <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01636"></a>01636             <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l01637"></a>01637                 nothingSelected = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01638"></a>01638                 <span class="keywordflow">break</span>;
<a name="l01639"></a>01639             }
<a name="l01640"></a>01640         }
<a name="l01641"></a>01641     }
<a name="l01642"></a>01642 
<a name="l01643"></a>01643     <span class="keywordflow">if</span> (nothingSelected)
<a name="l01644"></a>01644         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01645"></a>01645 
<a name="l01646"></a>01646     <span class="comment">/* for effects, try to find a replacement input */</span>
<a name="l01647"></a>01647     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>)
<a name="l01648"></a>01648         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) &amp;&amp; !(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>))
<a name="l01649"></a>01649             <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a265581f7d8f5effa91df2316f62bb22e">del_seq_find_replace_recurs</a>(scene, seq);
<a name="l01650"></a>01650 
<a name="l01651"></a>01651     <span class="comment">/* delete all selected strips */</span>
<a name="l01652"></a>01652     <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c7e4c1fed1cb9b839a3af6bd9c527b3">recurs_del_seq_flag</a>(scene, ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>, 0);
<a name="l01653"></a>01653 
<a name="l01654"></a>01654     <span class="comment">/* updates lengths etc */</span>
<a name="l01655"></a>01655     seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01656"></a>01656     <span class="keywordflow">while</span> (seq) {
<a name="l01657"></a>01657         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l01658"></a>01658         seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l01659"></a>01659     }
<a name="l01660"></a>01660 
<a name="l01661"></a>01661     <span class="comment">/* free parent metas */</span>
<a name="l01662"></a>01662     ms = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a71fc675641a789cae753a4480aea15cf">metastack</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01663"></a>01663     <span class="keywordflow">while</span> (ms) {
<a name="l01664"></a>01664         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#a01b324eb36108cb5bb748377f4195718">parseq</a>);
<a name="l01665"></a>01665         ms = ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#a0e085861ade6c0dc14452c549ef1f318">prev</a>;
<a name="l01666"></a>01666     }
<a name="l01667"></a>01667 
<a name="l01668"></a>01668     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01669"></a>01669     
<a name="l01670"></a>01670     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01671"></a>01671 }
<a name="l01672"></a>01672 
<a name="l01673"></a>01673 
<a name="l01674"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a9582a64cdf33f859d01886fe45cdcb66">01674</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a1fb4ded3ed6237273ce8f09d0a1b3d27">SEQUENCER_OT_delete</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01675"></a>01675 {
<a name="l01676"></a>01676 
<a name="l01677"></a>01677     <span class="comment">/* identifiers */</span>
<a name="l01678"></a>01678     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Erase Strips&quot;</span>;
<a name="l01679"></a>01679     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_delete&quot;</span>;
<a name="l01680"></a>01680     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Erase selected strips from the sequencer&quot;</span>;
<a name="l01681"></a>01681     
<a name="l01682"></a>01682     <span class="comment">/* api callbacks */</span>
<a name="l01683"></a>01683     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a63ac1372a9efaaca8bec8660ff770026">WM_operator_confirm</a>;
<a name="l01684"></a>01684     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a93aa627cb625079b96c447d8fe3995b5">sequencer_delete_exec</a>;
<a name="l01685"></a>01685     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01686"></a>01686     
<a name="l01687"></a>01687     <span class="comment">/* flags */</span>
<a name="l01688"></a>01688     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01689"></a>01689 }
<a name="l01690"></a>01690 
<a name="l01691"></a>01691 
<a name="l01692"></a>01692 <span class="comment">/* offset clear operator */</span>
<a name="l01693"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a61cf8621d6386281a905950e75fdbbe4">01693</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a61cf8621d6386281a905950e75fdbbe4">sequencer_offset_clear_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01694"></a>01694 {
<a name="l01695"></a>01695     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01696"></a>01696     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01697"></a>01697     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01698"></a>01698 
<a name="l01699"></a>01699     <span class="comment">/* for effects, try to find a replacement input */</span>
<a name="l01700"></a>01700     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01701"></a>01701         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) == 0 &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) {
<a name="l01702"></a>01702             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a8240dbc5c4a5ed979d60585b4eb95fcc">startofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1bbdbe8b6defef9e0f5bc29de183eadd">endofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#af822399c04f7c494f1ac30a8c6a680e4">startstill</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = 0;
<a name="l01703"></a>01703         }
<a name="l01704"></a>01704     }
<a name="l01705"></a>01705 
<a name="l01706"></a>01706     <span class="comment">/* updates lengths etc */</span>
<a name="l01707"></a>01707     seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01708"></a>01708     <span class="keywordflow">while</span> (seq) {
<a name="l01709"></a>01709         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l01710"></a>01710         seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l01711"></a>01711     }
<a name="l01712"></a>01712 
<a name="l01713"></a>01713     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l01714"></a>01714         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) == 0 &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) {
<a name="l01715"></a>01715             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq)) {
<a name="l01716"></a>01716                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq, scene);
<a name="l01717"></a>01717             }
<a name="l01718"></a>01718         }
<a name="l01719"></a>01719     }
<a name="l01720"></a>01720 
<a name="l01721"></a>01721     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01722"></a>01722 
<a name="l01723"></a>01723     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01724"></a>01724 }
<a name="l01725"></a>01725 
<a name="l01726"></a>01726 
<a name="l01727"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#aa62c73868bf33e089ceb1e7e95f4ffbc">01727</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a8cc381a038a4753c5e706ac64c405dc1">SEQUENCER_OT_offset_clear</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01728"></a>01728 {
<a name="l01729"></a>01729 
<a name="l01730"></a>01730     <span class="comment">/* identifiers */</span>
<a name="l01731"></a>01731     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Clear Strip Offset&quot;</span>;
<a name="l01732"></a>01732     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_offset_clear&quot;</span>;
<a name="l01733"></a>01733     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Clear strip offsets from the start and end frames&quot;</span>;
<a name="l01734"></a>01734 
<a name="l01735"></a>01735     <span class="comment">/* api callbacks */</span>
<a name="l01736"></a>01736     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a61cf8621d6386281a905950e75fdbbe4">sequencer_offset_clear_exec</a>;
<a name="l01737"></a>01737     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01738"></a>01738 
<a name="l01739"></a>01739     <span class="comment">/* flags */</span>
<a name="l01740"></a>01740     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01741"></a>01741 }
<a name="l01742"></a>01742 
<a name="l01743"></a>01743 
<a name="l01744"></a>01744 <span class="comment">/* separate_images operator */</span>
<a name="l01745"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a229fb042e98bf45d0a5dd8fc6dc61910">01745</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a229fb042e98bf45d0a5dd8fc6dc61910">sequencer_separate_images_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01746"></a>01746 {
<a name="l01747"></a>01747     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01748"></a>01748     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01749"></a>01749     
<a name="l01750"></a>01750     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *seq_new;
<a name="l01751"></a>01751     <a class="code" href="../../de/d68/structStrip.html">Strip</a> *strip_new;
<a name="l01752"></a>01752     <a class="code" href="../../d0/d38/structStripElem.html">StripElem</a> *se, *se_new;
<a name="l01753"></a>01753     <span class="keywordtype">int</span> start_ofs, cfra, frame_end;
<a name="l01754"></a>01754     <span class="keywordtype">int</span> <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;length&quot;</span>);
<a name="l01755"></a>01755 
<a name="l01756"></a>01756     seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; <span class="comment">/* poll checks this is valid */</span>
<a name="l01757"></a>01757 
<a name="l01758"></a>01758     <span class="keywordflow">while</span> (seq) {
<a name="l01759"></a>01759         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ac06b183625bca249c8c0d1168f907aeb">SEQ_IMAGE</a>) &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a> &gt; 1)) {
<a name="l01760"></a>01760             <span class="comment">/* remove seq so overlap tests don&#39;t conflict,</span>
<a name="l01761"></a>01761 <span class="comment">             * see seq_free_sequence below for the real free&#39;ing */</span>
<a name="l01762"></a>01762             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq);
<a name="l01763"></a>01763             <span class="comment">/* if (seq-&gt;ipo) seq-&gt;ipo-&gt;id.us--; */</span>
<a name="l01764"></a>01764             <span class="comment">/* XXX, remove fcurve and assign to split image strips */</span>
<a name="l01765"></a>01765 
<a name="l01766"></a>01766             start_ofs = cfra = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7269ba1af4b92f3b9d07b45455f0c096">seq_tx_get_final_left</a>(seq, 0);
<a name="l01767"></a>01767             frame_end = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aca197f82f9b9a5343c73b230007da861">seq_tx_get_final_right</a>(seq, 0);
<a name="l01768"></a>01768 
<a name="l01769"></a>01769             <span class="keywordflow">while</span> (cfra &lt; frame_end) {
<a name="l01770"></a>01770                 <span class="comment">/* new seq */</span>
<a name="l01771"></a>01771                 se = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a000a22b46caf0117e7d0b5956e5a3615">give_stripelem</a>(seq, cfra);
<a name="l01772"></a>01772 
<a name="l01773"></a>01773                 seq_new = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a17207265964f4e39dea1a59dd5e3e9d1">seq_dupli_recursive</a>(scene, scene, seq, <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a1660e3e1c0a867f4ae91f78bedc20e11">SEQ_DUPE_UNIQUE_NAME</a>);
<a name="l01774"></a>01774                 <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq_new);
<a name="l01775"></a>01775 
<a name="l01776"></a>01776                 seq_new-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = start_ofs;
<a name="l01777"></a>01777                 seq_new-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> = <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ac06b183625bca249c8c0d1168f907aeb">SEQ_IMAGE</a>;
<a name="l01778"></a>01778                 seq_new-&gt;<a class="code" href="../../dd/d1a/structSequence.html#abe1c801646c929f79810b8aefa491701">len</a> = 1;
<a name="l01779"></a>01779                 seq_new-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3c7e823146d7a1a05c502def7d1a3227">endstill</a> = step - 1;
<a name="l01780"></a>01780 
<a name="l01781"></a>01781                 <span class="comment">/* new strip */</span>
<a name="l01782"></a>01782                 strip_new = seq_new-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>;
<a name="l01783"></a>01783                 strip_new-&gt;<a class="code" href="../../de/d68/structStrip.html#abb8ed2ec3f2ffc2f68d0a0723aaab1c2">us</a> = 1;
<a name="l01784"></a>01784 
<a name="l01785"></a>01785                 <span class="comment">/* new stripdata */</span>
<a name="l01786"></a>01786                 se_new = strip_new-&gt;<a class="code" href="../../de/d68/structStrip.html#a5f5ecc8c7ffc8375e8a43b2500738889">stripdata</a>;
<a name="l01787"></a>01787                 <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(se_new-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a68eca881ea502f351f9a21fcdc99955d">name</a>, se-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a68eca881ea502f351f9a21fcdc99955d">name</a>, <span class="keyword">sizeof</span>(se_new-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a68eca881ea502f351f9a21fcdc99955d">name</a>));
<a name="l01788"></a>01788                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq_new);
<a name="l01789"></a>01789 
<a name="l01790"></a>01790                 <span class="keywordflow">if</span> (step &gt; 1) {
<a name="l01791"></a>01791                     seq_new-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#aa7e3e092128d8c7fe75dc39e5893483d">SEQ_OVERLAP</a>;
<a name="l01792"></a>01792                     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq_new)) {
<a name="l01793"></a>01793                         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq_new, scene);
<a name="l01794"></a>01794                     }
<a name="l01795"></a>01795                 }
<a name="l01796"></a>01796 
<a name="l01797"></a>01797                 <span class="comment">/* XXX, COPY FCURVES */</span>
<a name="l01798"></a>01798 
<a name="l01799"></a>01799                 cfra++;
<a name="l01800"></a>01800                 start_ofs += <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>;
<a name="l01801"></a>01801             }
<a name="l01802"></a>01802 
<a name="l01803"></a>01803             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7a2f7e78b98400bb7da9c17e2cf044ce">seq_free_sequence</a>(scene, seq);
<a name="l01804"></a>01804             seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l01805"></a>01805         }
<a name="l01806"></a>01806         <span class="keywordflow">else</span> {
<a name="l01807"></a>01807             seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l01808"></a>01808         }
<a name="l01809"></a>01809     }
<a name="l01810"></a>01810 
<a name="l01811"></a>01811     <span class="comment">/* as last: */</span>
<a name="l01812"></a>01812     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a351665cd83431f78daaffde840fc0da8">sort_seq</a>(scene);
<a name="l01813"></a>01813     
<a name="l01814"></a>01814     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01815"></a>01815 
<a name="l01816"></a>01816     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01817"></a>01817 }
<a name="l01818"></a>01818 
<a name="l01819"></a>01819 
<a name="l01820"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a3353c9634e33d8d586a1aa8b67271dca">01820</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a76385850a9e64d713fda1d9eec5d5662">SEQUENCER_OT_images_separate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01821"></a>01821 {
<a name="l01822"></a>01822     <span class="comment">/* identifiers */</span>
<a name="l01823"></a>01823     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Separate Images&quot;</span>;
<a name="l01824"></a>01824     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_images_separate&quot;</span>;
<a name="l01825"></a>01825     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;On image sequence strips, it returns a strip for each image&quot;</span>;
<a name="l01826"></a>01826     
<a name="l01827"></a>01827     <span class="comment">/* api callbacks */</span>
<a name="l01828"></a>01828     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a229fb042e98bf45d0a5dd8fc6dc61910">sequencer_separate_images_exec</a>;
<a name="l01829"></a>01829     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01830"></a>01830     
<a name="l01831"></a>01831     <span class="comment">/* flags */</span>
<a name="l01832"></a>01832     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01833"></a>01833 
<a name="l01834"></a>01834     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;length&quot;</span>, 1, 1, 1000, <span class="stringliteral">&quot;Length&quot;</span>, <span class="stringliteral">&quot;Length of each frame&quot;</span>, 1, INT_MAX);
<a name="l01835"></a>01835 }
<a name="l01836"></a>01836 
<a name="l01837"></a>01837 
<a name="l01838"></a>01838 <span class="comment">/* META Operators */</span>
<a name="l01839"></a>01839 
<a name="l01840"></a>01840 <span class="comment">/* separate_meta_toggle operator */</span>
<a name="l01841"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#adbb2d20a2591b75c00d30988fed3a4e8">01841</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#adbb2d20a2591b75c00d30988fed3a4e8">sequencer_meta_toggle_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01842"></a>01842 {
<a name="l01843"></a>01843     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01844"></a>01844     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01845"></a>01845     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l01846"></a>01846     <a class="code" href="../../de/d91/structMetaStack.html">MetaStack</a> *ms;
<a name="l01847"></a>01847 
<a name="l01848"></a>01848     <span class="keywordflow">if</span> (last_seq &amp;&amp; last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a> &amp;&amp; last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l01849"></a>01849         <span class="comment">/* Enter Metastrip */</span>
<a name="l01850"></a>01850         ms = <a class="code" href="../../da/d2b/mallocn_8c.html#a2bfff00be1f0c49f1945b5d6f66af243">MEM_mallocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../de/d91/structMetaStack.html">MetaStack</a>), <span class="stringliteral">&quot;metastack&quot;</span>);
<a name="l01851"></a>01851         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a71fc675641a789cae753a4480aea15cf">metastack</a>, ms);
<a name="l01852"></a>01852         ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#a01b324eb36108cb5bb748377f4195718">parseq</a> = last_seq;
<a name="l01853"></a>01853         ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#aaf2dee834693f5843c5a2e533de2bbba">oldbasep</a> = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>;
<a name="l01854"></a>01854 
<a name="l01855"></a>01855         ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a> = &amp;last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>;
<a name="l01856"></a>01856 
<a name="l01857"></a>01857         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a3ad148ec3a6aa1db31ae1662ca889856">seq_active_set</a>(scene, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01858"></a>01858 
<a name="l01859"></a>01859     }
<a name="l01860"></a>01860     <span class="keywordflow">else</span> {
<a name="l01861"></a>01861         <span class="comment">/* Exit Metastrip (if possible) */</span>
<a name="l01862"></a>01862 
<a name="l01863"></a>01863         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l01864"></a>01864 
<a name="l01865"></a>01865         <span class="keywordflow">if</span> (ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a71fc675641a789cae753a4480aea15cf">metastack</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01866"></a>01866             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01867"></a>01867 
<a name="l01868"></a>01868         ms = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a71fc675641a789cae753a4480aea15cf">metastack</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l01869"></a>01869         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(&amp;ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a71fc675641a789cae753a4480aea15cf">metastack</a>, ms);
<a name="l01870"></a>01870 
<a name="l01871"></a>01871         ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a> = ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#aaf2dee834693f5843c5a2e533de2bbba">oldbasep</a>;
<a name="l01872"></a>01872 
<a name="l01873"></a>01873         <span class="comment">/* recalc all: the meta can have effects connected to it */</span>
<a name="l01874"></a>01874         <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>)
<a name="l01875"></a>01875             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l01876"></a>01876 
<a name="l01877"></a>01877         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a3ad148ec3a6aa1db31ae1662ca889856">seq_active_set</a>(scene, ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#a01b324eb36108cb5bb748377f4195718">parseq</a>);
<a name="l01878"></a>01878 
<a name="l01879"></a>01879         ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#a01b324eb36108cb5bb748377f4195718">parseq</a>-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l01880"></a>01880         <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a547af9cb2e65720dd6899546927d28d1">recurs_sel_seq</a>(ms-&gt;<a class="code" href="../../de/d91/structMetaStack.html#a01b324eb36108cb5bb748377f4195718">parseq</a>);
<a name="l01881"></a>01881 
<a name="l01882"></a>01882         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(ms);
<a name="l01883"></a>01883 
<a name="l01884"></a>01884     }
<a name="l01885"></a>01885 
<a name="l01886"></a>01886     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#acf8f5ba64230d559c282e40ba7070a02">seq_update_muting</a>(ed);
<a name="l01887"></a>01887     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01888"></a>01888 
<a name="l01889"></a>01889     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01890"></a>01890 }
<a name="l01891"></a>01891 
<a name="l01892"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#abfd9cf3bd98ee2f0aed3808e73b8e45a">01892</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acdaebdec9d968c172b2e8a7a59d306bf">SEQUENCER_OT_meta_toggle</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01893"></a>01893 {
<a name="l01894"></a>01894     <span class="comment">/* identifiers */</span>
<a name="l01895"></a>01895     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Toggle Meta Strip&quot;</span>;
<a name="l01896"></a>01896     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_meta_toggle&quot;</span>;
<a name="l01897"></a>01897     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Toggle a metastrip (to edit enclosed strips)&quot;</span>;
<a name="l01898"></a>01898     
<a name="l01899"></a>01899     <span class="comment">/* api callbacks */</span>
<a name="l01900"></a>01900     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#adbb2d20a2591b75c00d30988fed3a4e8">sequencer_meta_toggle_exec</a>;
<a name="l01901"></a>01901     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01902"></a>01902     
<a name="l01903"></a>01903     <span class="comment">/* flags */</span>
<a name="l01904"></a>01904     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01905"></a>01905 }
<a name="l01906"></a>01906 
<a name="l01907"></a>01907 
<a name="l01908"></a>01908 <span class="comment">/* separate_meta_make operator */</span>
<a name="l01909"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a27227ead01d067b5bfb15fc550a66c20">01909</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a27227ead01d067b5bfb15fc550a66c20">sequencer_meta_make_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01910"></a>01910 {
<a name="l01911"></a>01911     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01912"></a>01912     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01913"></a>01913     
<a name="l01914"></a>01914     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *seqm, *<a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>, *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l01915"></a>01915     <span class="keywordtype">int</span> channel_max = 1;
<a name="l01916"></a>01916 
<a name="l01917"></a>01917     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a6033630a9a5aa0d9f03a2f94d78f4d88">seqbase_isolated_sel_check</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>) == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
<a name="l01918"></a>01918         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Please select all related strips&quot;</span>);
<a name="l01919"></a>01919         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01920"></a>01920     }
<a name="l01921"></a>01921 
<a name="l01922"></a>01922     <span class="comment">/* remove all selected from main list, and put in meta */</span>
<a name="l01923"></a>01923 
<a name="l01924"></a>01924     seqm = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a8ed814fa19e0d81128bbed3a325acc9b">alloc_sequence</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, 1, 1); <span class="comment">/* channel number set later */</span>
<a name="l01925"></a>01925     strcpy(seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2225f4aab19fa7afa3965a2502db8b81">name</a> + 2, <span class="stringliteral">&quot;MetaStrip&quot;</span>);
<a name="l01926"></a>01926     seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> = <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>;
<a name="l01927"></a>01927     seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> = <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>;
<a name="l01928"></a>01928 
<a name="l01929"></a>01929     seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01930"></a>01930     <span class="keywordflow">while</span> (seq) {
<a name="l01931"></a>01931         next = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>;
<a name="l01932"></a>01932         <span class="keywordflow">if</span> (seq != seqm &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>)) {
<a name="l01933"></a>01933             channel_max = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a>, channel_max);
<a name="l01934"></a>01934             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq);
<a name="l01935"></a>01935             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>, seq);
<a name="l01936"></a>01936         }
<a name="l01937"></a>01937         seq = <a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>;
<a name="l01938"></a>01938     }
<a name="l01939"></a>01939     seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> = last_seq ? last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a> : channel_max;
<a name="l01940"></a>01940     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seqm);
<a name="l01941"></a>01941 
<a name="l01942"></a>01942     seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a> = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../de/d68/structStrip.html">Strip</a>), <span class="stringliteral">&quot;metastrip&quot;</span>);
<a name="l01943"></a>01943     seqm-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#abb8ed2ec3f2ffc2f68d0a0723aaab1c2">us</a> = 1;
<a name="l01944"></a>01944     
<a name="l01945"></a>01945     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a3ad148ec3a6aa1db31ae1662ca889856">seq_active_set</a>(scene, seqm);
<a name="l01946"></a>01946 
<a name="l01947"></a>01947     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seqm) ) <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seqm, scene);
<a name="l01948"></a>01948 
<a name="l01949"></a>01949     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#acf8f5ba64230d559c282e40ba7070a02">seq_update_muting</a>(ed);
<a name="l01950"></a>01950 
<a name="l01951"></a>01951     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ac8a5c77b4ca3351b21f74890f845c681">seqbase_unique_name_recursive</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, seqm);
<a name="l01952"></a>01952 
<a name="l01953"></a>01953     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l01954"></a>01954 
<a name="l01955"></a>01955     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01956"></a>01956 }
<a name="l01957"></a>01957 
<a name="l01958"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a1f5bc641c40336880ed5aa907f78111b">01958</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a90a87739fe64dc8b3d22f36011ab1541">SEQUENCER_OT_meta_make</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01959"></a>01959 {
<a name="l01960"></a>01960     <span class="comment">/* identifiers */</span>
<a name="l01961"></a>01961     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Make Meta Strip&quot;</span>;
<a name="l01962"></a>01962     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_meta_make&quot;</span>;
<a name="l01963"></a>01963     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Group selected strips into a metastrip&quot;</span>;
<a name="l01964"></a>01964     
<a name="l01965"></a>01965     <span class="comment">/* api callbacks */</span>
<a name="l01966"></a>01966     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a63ac1372a9efaaca8bec8660ff770026">WM_operator_confirm</a>;
<a name="l01967"></a>01967     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a27227ead01d067b5bfb15fc550a66c20">sequencer_meta_make_exec</a>;
<a name="l01968"></a>01968     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l01969"></a>01969     
<a name="l01970"></a>01970     <span class="comment">/* flags */</span>
<a name="l01971"></a>01971     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01972"></a>01972 }
<a name="l01973"></a>01973 
<a name="l01974"></a>01974 
<a name="l01975"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3dfe9c4b16a740fb62ddca6324d4448a">01975</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3dfe9c4b16a740fb62ddca6324d4448a">seq_depends_on_meta</a>(<a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seqm)
<a name="l01976"></a>01976 {
<a name="l01977"></a>01977     <span class="keywordflow">if</span> (seq == seqm) <span class="keywordflow">return</span> 1;
<a name="l01978"></a>01978     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3dfe9c4b16a740fb62ddca6324d4448a">seq_depends_on_meta</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a>, seqm)) <span class="keywordflow">return</span> 1;
<a name="l01979"></a>01979     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3dfe9c4b16a740fb62ddca6324d4448a">seq_depends_on_meta</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a>, seqm)) <span class="keywordflow">return</span> 1;
<a name="l01980"></a>01980     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a> &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3dfe9c4b16a740fb62ddca6324d4448a">seq_depends_on_meta</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>, seqm)) <span class="keywordflow">return</span> 1;
<a name="l01981"></a>01981     <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;
<a name="l01982"></a>01982 }
<a name="l01983"></a>01983 
<a name="l01984"></a>01984 <span class="comment">/* separate_meta_make operator */</span>
<a name="l01985"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7b2b8156766d8a3d4b2245d014347e93">01985</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7b2b8156766d8a3d4b2245d014347e93">sequencer_meta_separate_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l01986"></a>01986 {
<a name="l01987"></a>01987     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01988"></a>01988     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l01989"></a>01989 
<a name="l01990"></a>01990     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *last_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene); <span class="comment">/* last_seq checks ed==NULL */</span>
<a name="l01991"></a>01991 
<a name="l01992"></a>01992     <span class="keywordflow">if</span> (last_seq == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> != <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>)
<a name="l01993"></a>01993         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01994"></a>01994 
<a name="l01995"></a>01995     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aea47205fbf4fc9965bc2b06e7e3ca75a">BLI_movelisttolist</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, &amp;last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>);
<a name="l01996"></a>01996 
<a name="l01997"></a>01997     last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01998"></a>01998     last_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01999"></a>01999 
<a name="l02000"></a>02000     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, last_seq);
<a name="l02001"></a>02001     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7a2f7e78b98400bb7da9c17e2cf044ce">seq_free_sequence</a>(scene, last_seq);
<a name="l02002"></a>02002 
<a name="l02003"></a>02003     <span class="comment">/* emtpy meta strip, delete all effects depending on it */</span>
<a name="l02004"></a>02004     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>)
<a name="l02005"></a>02005         <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3dfe9c4b16a740fb62ddca6324d4448a">seq_depends_on_meta</a>(seq, last_seq))
<a name="l02006"></a>02006             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> |= <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a14fc93645e2ab8ab2b60dc6566bc12a1">SEQ_FLAG_DELETE</a>;
<a name="l02007"></a>02007 
<a name="l02008"></a>02008     <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7c7e4c1fed1cb9b839a3af6bd9c527b3">recurs_del_seq_flag</a>(scene, ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a14fc93645e2ab8ab2b60dc6566bc12a1">SEQ_FLAG_DELETE</a>, 0);
<a name="l02009"></a>02009 
<a name="l02010"></a>02010     <span class="comment">/* test for effects and overlap</span>
<a name="l02011"></a>02011 <span class="comment">     * don&#39;t use SEQP_BEGIN since that would be recursive */</span>
<a name="l02012"></a>02012     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02013"></a>02013         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l02014"></a>02014             seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp;= ~<a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#aa7e3e092128d8c7fe75dc39e5893483d">SEQ_OVERLAP</a>;
<a name="l02015"></a>02015             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq)) {
<a name="l02016"></a>02016                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, seq, scene);
<a name="l02017"></a>02017             }
<a name="l02018"></a>02018         }
<a name="l02019"></a>02019     }
<a name="l02020"></a>02020 
<a name="l02021"></a>02021     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a351665cd83431f78daaffde840fc0da8">sort_seq</a>(scene);
<a name="l02022"></a>02022     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#acf8f5ba64230d559c282e40ba7070a02">seq_update_muting</a>(ed);
<a name="l02023"></a>02023 
<a name="l02024"></a>02024     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l02025"></a>02025 
<a name="l02026"></a>02026     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02027"></a>02027 }
<a name="l02028"></a>02028 
<a name="l02029"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a607c4337107ea75a68662e4fdbba2a1a">02029</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af0936ab69d2e048f7d7511a48a929626">SEQUENCER_OT_meta_separate</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02030"></a>02030 {
<a name="l02031"></a>02031     <span class="comment">/* identifiers */</span>
<a name="l02032"></a>02032     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;UnMeta Strip&quot;</span>;
<a name="l02033"></a>02033     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_meta_separate&quot;</span>;
<a name="l02034"></a>02034     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Put the contents of a metastrip back in the sequencer&quot;</span>;
<a name="l02035"></a>02035     
<a name="l02036"></a>02036     <span class="comment">/* api callbacks */</span>
<a name="l02037"></a>02037     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a63ac1372a9efaaca8bec8660ff770026">WM_operator_confirm</a>;
<a name="l02038"></a>02038     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a7b2b8156766d8a3d4b2245d014347e93">sequencer_meta_separate_exec</a>;
<a name="l02039"></a>02039     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l02040"></a>02040     
<a name="l02041"></a>02041     <span class="comment">/* flags */</span>
<a name="l02042"></a>02042     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02043"></a>02043 }
<a name="l02044"></a>02044 
<a name="l02045"></a>02045 <span class="comment">/* view_all operator */</span>
<a name="l02046"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a09e60baba752473ba8325292e1b73687">02046</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a09e60baba752473ba8325292e1b73687">sequencer_view_all_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02047"></a>02047 {
<a name="l02048"></a>02048     <span class="comment">//Scene *scene= CTX_data_scene(C);</span>
<a name="l02049"></a>02049     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l02050"></a>02050     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *area = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02051"></a>02051     <span class="comment">//ARegion *ar= CTX_wm_region(C);</span>
<a name="l02052"></a>02052     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = <a class="code" href="../../d5/d63/UI__view2d_8h.html#a5438d7c06bc8dbbb2746da95bcbcefb5">UI_view2d_fromcontext</a>(C);
<a name="l02053"></a>02053 
<a name="l02054"></a>02054     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a> = v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>;
<a name="l02055"></a>02055     <a class="code" href="../../d5/d63/UI__view2d_8h.html#af75b83105e7573fbdbfd1a6c1e856058">UI_view2d_curRect_validate</a>(v2d);
<a name="l02056"></a>02056     <a class="code" href="../../d5/d63/UI__view2d_8h.html#ab7089b88d3b7fdc1f26037f32468c7b1">UI_view2d_sync</a>(sc, area, v2d, <a class="code" href="../../d5/d63/UI__view2d_8h.html#a1df4e9b75e5090a9a745b6f6bb9846af">V2D_LOCK_COPY</a>);
<a name="l02057"></a>02057     
<a name="l02058"></a>02058     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l02059"></a>02059     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02060"></a>02060 }
<a name="l02061"></a>02061 
<a name="l02062"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a49c4c58837fe8c9ec98ea09972378442">02062</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aca5e399a46e42ca61a33aaa776c4fd2a">SEQUENCER_OT_view_all</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02063"></a>02063 {
<a name="l02064"></a>02064     <span class="comment">/* identifiers */</span>
<a name="l02065"></a>02065     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;View All&quot;</span>;
<a name="l02066"></a>02066     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_view_all&quot;</span>;
<a name="l02067"></a>02067     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;View all the strips in the sequencer&quot;</span>;
<a name="l02068"></a>02068     
<a name="l02069"></a>02069     <span class="comment">/* api callbacks */</span>
<a name="l02070"></a>02070     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a09e60baba752473ba8325292e1b73687">sequencer_view_all_exec</a>;
<a name="l02071"></a>02071     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02072"></a>02072     
<a name="l02073"></a>02073     <span class="comment">/* flags */</span>
<a name="l02074"></a>02074     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>;
<a name="l02075"></a>02075 }
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 <span class="comment">/* view_all operator */</span>
<a name="l02078"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad11a92dd416d76071584581e81d8f1ea">02078</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad11a92dd416d76071584581e81d8f1ea">sequencer_view_all_preview_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02079"></a>02079 {
<a name="l02080"></a>02080     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l02081"></a>02081     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *area = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02082"></a>02082 <span class="preprocessor">#if 0</span>
<a name="l02083"></a>02083 <span class="preprocessor"></span>    <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar = <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l02084"></a>02084     <a class="code" href="../../df/d05/structSpaceSeq.html">SpaceSeq</a> *sseq = area-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l02085"></a>02085     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02086"></a>02086 <span class="preprocessor">#endif</span>
<a name="l02087"></a>02087 <span class="preprocessor"></span>    <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = <a class="code" href="../../d5/d63/UI__view2d_8h.html#a5438d7c06bc8dbbb2746da95bcbcefb5">UI_view2d_fromcontext</a>(C);
<a name="l02088"></a>02088 
<a name="l02089"></a>02089     v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a> = v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>;
<a name="l02090"></a>02090     <a class="code" href="../../d5/d63/UI__view2d_8h.html#af75b83105e7573fbdbfd1a6c1e856058">UI_view2d_curRect_validate</a>(v2d);
<a name="l02091"></a>02091     <a class="code" href="../../d5/d63/UI__view2d_8h.html#ab7089b88d3b7fdc1f26037f32468c7b1">UI_view2d_sync</a>(sc, area, v2d, <a class="code" href="../../d5/d63/UI__view2d_8h.html#a1df4e9b75e5090a9a745b6f6bb9846af">V2D_LOCK_COPY</a>);
<a name="l02092"></a>02092     
<a name="l02093"></a>02093 <span class="preprocessor">#if 0</span>
<a name="l02094"></a>02094 <span class="preprocessor"></span>    <span class="comment">/* Like zooming on an image view */</span>
<a name="l02095"></a>02095     <span class="keywordtype">float</span> zoomX, zoomY;
<a name="l02096"></a>02096     <span class="keywordtype">int</span> width, height, imgwidth, imgheight;
<a name="l02097"></a>02097 
<a name="l02098"></a>02098     width = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a32e37003215c0dc7f77e12e4fc9db3f4">winx</a>;
<a name="l02099"></a>02099     height = ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a908d20a23657ef143d2de1496be69f42">winy</a>;
<a name="l02100"></a>02100 
<a name="l02101"></a>02101     <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a78b274d2c19ca79fa6628b88f1bf8d9e">seq_reset_imageofs</a>(sseq);
<a name="l02102"></a>02102 
<a name="l02103"></a>02103     imgwidth = (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a11d240aa637c806a992d75d43d4aded8">size</a> * scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#afac89783028ff848f111de04e0c29fbe">xsch</a>) / 100;
<a name="l02104"></a>02104     imgheight = (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a11d240aa637c806a992d75d43d4aded8">size</a> * scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aca3c1ebdf50a6c74730e19e24983217d">ysch</a>) / 100;
<a name="l02105"></a>02105 
<a name="l02106"></a>02106     <span class="comment">/* Apply aspect, dosnt need to be that accurate */</span>
<a name="l02107"></a>02107     imgwidth = (int)(imgwidth * (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a7c97c9fb3ae2b02bd4ccb8c76d68811a">xasp</a> / scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a1f4c395a81051abd055a1014e02c9f00">yasp</a>));
<a name="l02108"></a>02108 
<a name="l02109"></a>02109     <span class="keywordflow">if</span> (((imgwidth &gt;= width) || (imgheight &gt;= height)) &amp;&amp;
<a name="l02110"></a>02110         ((width &gt; 0) &amp;&amp; (height &gt; 0))) {
<a name="l02111"></a>02111 
<a name="l02112"></a>02112         <span class="comment">/* Find the zoom value that will fit the image in the image space */</span>
<a name="l02113"></a>02113         zoomX = ((float)width) / ((float)imgwidth);
<a name="l02114"></a>02114         zoomY = ((float)height) / ((float)imgheight);
<a name="l02115"></a>02115         sseq-&gt;zoom = (zoomX &lt; zoomY) ? zoomX : zoomY;
<a name="l02116"></a>02116 
<a name="l02117"></a>02117         sseq-&gt;zoom = 1.0f / <a class="code" href="../../dd/d06/BLI__math__base_8h.html#aabd145f96ccab2e9e3675d7883b0acb2">power_of_2</a>(1 / <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(zoomX, zoomY) );
<a name="l02118"></a>02118     }
<a name="l02119"></a>02119     <span class="keywordflow">else</span> {
<a name="l02120"></a>02120         sseq-&gt;zoom = 1.0f;
<a name="l02121"></a>02121     }
<a name="l02122"></a>02122 <span class="preprocessor">#endif</span>
<a name="l02123"></a>02123 <span class="preprocessor"></span>
<a name="l02124"></a>02124     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l02125"></a>02125     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02126"></a>02126 }
<a name="l02127"></a>02127 
<a name="l02128"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a795375b4b44ca730664b40d559e5e51a">02128</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a9bce16cddd92a0f31163ad0bb8fe424b">SEQUENCER_OT_view_all_preview</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02129"></a>02129 {
<a name="l02130"></a>02130     <span class="comment">/* identifiers */</span>
<a name="l02131"></a>02131     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;View All&quot;</span>;
<a name="l02132"></a>02132     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_view_all_preview&quot;</span>;
<a name="l02133"></a>02133     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Zoom preview to fit in the area&quot;</span>;
<a name="l02134"></a>02134     
<a name="l02135"></a>02135     <span class="comment">/* api callbacks */</span>
<a name="l02136"></a>02136     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad11a92dd416d76071584581e81d8f1ea">sequencer_view_all_preview_exec</a>;
<a name="l02137"></a>02137     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02138"></a>02138     
<a name="l02139"></a>02139     <span class="comment">/* flags */</span>
<a name="l02140"></a>02140     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>;
<a name="l02141"></a>02141 }
<a name="l02142"></a>02142 
<a name="l02143"></a>02143 
<a name="l02144"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a46b26b40f264728e4deabfb062a24575">02144</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a46b26b40f264728e4deabfb062a24575">sequencer_view_zoom_ratio_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02145"></a>02145 {
<a name="l02146"></a>02146     <a class="code" href="../../d3/d27/structRenderData.html">RenderData</a> *r = &amp;<a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C)-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>;
<a name="l02147"></a>02147     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = <a class="code" href="../../d5/d63/UI__view2d_8h.html#a5438d7c06bc8dbbb2746da95bcbcefb5">UI_view2d_fromcontext</a>(C);
<a name="l02148"></a>02148 
<a name="l02149"></a>02149     <span class="keywordtype">float</span> ratio = <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ratio&quot;</span>);
<a name="l02150"></a>02150 
<a name="l02151"></a>02151     <span class="keywordtype">float</span> winx = (int)(r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#a11d240aa637c806a992d75d43d4aded8">size</a> * r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#afac89783028ff848f111de04e0c29fbe">xsch</a>) / 100;
<a name="l02152"></a>02152     <span class="keywordtype">float</span> winy = (int)(r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#a11d240aa637c806a992d75d43d4aded8">size</a> * r-&gt;<a class="code" href="../../d3/d27/structRenderData.html#aca3c1ebdf50a6c74730e19e24983217d">ysch</a>) / 100;
<a name="l02153"></a>02153 
<a name="l02154"></a>02154     <span class="keywordtype">float</span> facx = (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>) / winx;
<a name="l02155"></a>02155     <span class="keywordtype">float</span> facy = (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a5cb400ea187f0be505947260808d428f">mask</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>) / winy;
<a name="l02156"></a>02156 
<a name="l02157"></a>02157     <a class="code" href="../../d5/d44/BLI__rect_8h.html#af4bc9b188a1e83b3f62bf2778c6e30a5">BLI_resize_rctf</a>(&amp;v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>, (<span class="keywordtype">int</span>)(winx * facx * ratio) + 1, (<span class="keywordtype">int</span>)(winy * facy * ratio) + 1);
<a name="l02158"></a>02158 
<a name="l02159"></a>02159     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C));
<a name="l02160"></a>02160 
<a name="l02161"></a>02161     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02162"></a>02162 }
<a name="l02163"></a>02163 
<a name="l02164"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#af2fce96f11119cc3d2de477b16cdbe52">02164</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa59857d78a7de7b35e20a16fae1a1a07">SEQUENCER_OT_view_zoom_ratio</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02165"></a>02165 {
<a name="l02166"></a>02166     <span class="comment">/* identifiers */</span>
<a name="l02167"></a>02167     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Sequencer View Zoom Ratio&quot;</span>;
<a name="l02168"></a>02168     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_view_zoom_ratio&quot;</span>;
<a name="l02169"></a>02169     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Change zoom ratio of sequencer preview&quot;</span>;
<a name="l02170"></a>02170 
<a name="l02171"></a>02171     <span class="comment">/* api callbacks */</span>
<a name="l02172"></a>02172     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a46b26b40f264728e4deabfb062a24575">sequencer_view_zoom_ratio_exec</a>;
<a name="l02173"></a>02173     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02174"></a>02174 
<a name="l02175"></a>02175     <span class="comment">/* properties */</span>
<a name="l02176"></a>02176     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;ratio&quot;</span>, 1.0f, 0.0f, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>,
<a name="l02177"></a>02177                   <span class="stringliteral">&quot;Ratio&quot;</span>, <span class="stringliteral">&quot;Zoom ratio, 1.0 is 1:1, higher is zoomed in, lower is zoomed out&quot;</span>, -<a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>, <a class="code" href="../../d3/db4/VEC3_8h.html#a7fbf1534f9e0f0bfdb86fb928902474c">FLT_MAX</a>);
<a name="l02178"></a>02178 }
<a name="l02179"></a>02179 
<a name="l02180"></a>02180 
<a name="l02181"></a>02181 <span class="preprocessor">#if 0</span>
<a name="l02182"></a>02182 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> view_type_items[] = {
<a name="l02183"></a>02183     {<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a44c6fecd8977fde13fdf2c2cdc45015b">SEQ_VIEW_SEQUENCE</a>, <span class="stringliteral">&quot;SEQUENCER&quot;</span>, ICON_SEQ_SEQUENCER, <span class="stringliteral">&quot;Sequencer&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02184"></a>02184     {<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a00d8c8fb03bfb11556e41d32086843f4">SEQ_VIEW_PREVIEW</a>,  <span class="stringliteral">&quot;PREVIEW&quot;</span>, ICON_SEQ_PREVIEW, <span class="stringliteral">&quot;Image Preview&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02185"></a>02185     {<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a83be3829676633dcb2973d0bdb1bcdb3">SEQ_VIEW_SEQUENCE_PREVIEW</a>,  <span class="stringliteral">&quot;SEQUENCER_PREVIEW&quot;</span>, ICON_SEQ_SEQUENCER, <span class="stringliteral">&quot;Sequencer and Image Preview&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02186"></a>02186     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l02187"></a>02187 };
<a name="l02188"></a>02188 <span class="preprocessor">#endif</span>
<a name="l02189"></a>02189 <span class="preprocessor"></span>
<a name="l02190"></a>02190 <span class="comment">/* view_all operator */</span>
<a name="l02191"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab4e1bc7ed7452fb2d5cc84823dc0fed4">02191</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab4e1bc7ed7452fb2d5cc84823dc0fed4">sequencer_view_toggle_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02192"></a>02192 {
<a name="l02193"></a>02193     <a class="code" href="../../df/d05/structSpaceSeq.html">SpaceSeq</a> *sseq = (<a class="code" href="../../df/d05/structSpaceSeq.html">SpaceSeq</a> *)<a class="code" href="../../df/d01/BKE__context_8h.html#ac2755ddf45c6787c6429d5af9b04d809">CTX_wm_space_data</a>(C);
<a name="l02194"></a>02194 
<a name="l02195"></a>02195     sseq-&gt;<a class="code" href="../../df/d05/structSpaceSeq.html#a279bac440748b0c0101a89c84d8ec005">view</a>++;
<a name="l02196"></a>02196     <span class="keywordflow">if</span> (sseq-&gt;<a class="code" href="../../df/d05/structSpaceSeq.html#a279bac440748b0c0101a89c84d8ec005">view</a> &gt; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a83be3829676633dcb2973d0bdb1bcdb3">SEQ_VIEW_SEQUENCE_PREVIEW</a>) sseq-&gt;<a class="code" href="../../df/d05/structSpaceSeq.html#a279bac440748b0c0101a89c84d8ec005">view</a> = <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a44c6fecd8977fde13fdf2c2cdc45015b">SEQ_VIEW_SEQUENCE</a>;
<a name="l02197"></a>02197 
<a name="l02198"></a>02198     <a class="code" href="../../d1/d12/ED__screen_8h.html#ae9072acfc70f13e6379261f68f49c691">ED_area_tag_refresh</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l02199"></a>02199 
<a name="l02200"></a>02200     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02201"></a>02201 }
<a name="l02202"></a>02202 
<a name="l02203"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a9262163f84a5b7233c1fd8e844c336a3">02203</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a719cff985f69480114a5a317793a3822">SEQUENCER_OT_view_toggle</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02204"></a>02204 {
<a name="l02205"></a>02205     <span class="comment">/* identifiers */</span>
<a name="l02206"></a>02206     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;View Toggle&quot;</span>;
<a name="l02207"></a>02207     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_view_toggle&quot;</span>;
<a name="l02208"></a>02208     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Toggle between sequencer views (sequence, preview, both)&quot;</span>;
<a name="l02209"></a>02209     
<a name="l02210"></a>02210     <span class="comment">/* api callbacks */</span>
<a name="l02211"></a>02211     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab4e1bc7ed7452fb2d5cc84823dc0fed4">sequencer_view_toggle_exec</a>;
<a name="l02212"></a>02212     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02213"></a>02213     
<a name="l02214"></a>02214     <span class="comment">/* flags */</span>
<a name="l02215"></a>02215     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>;
<a name="l02216"></a>02216 }
<a name="l02217"></a>02217 
<a name="l02218"></a>02218 
<a name="l02219"></a>02219 <span class="comment">/* view_selected operator */</span>
<a name="l02220"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a641226f656e6dd02f7a724d03dc4a1b6">02220</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a641226f656e6dd02f7a724d03dc4a1b6">sequencer_view_selected_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02221"></a>02221 {
<a name="l02222"></a>02222     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02223"></a>02223     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = <a class="code" href="../../d5/d63/UI__view2d_8h.html#a5438d7c06bc8dbbb2746da95bcbcefb5">UI_view2d_fromcontext</a>(C);
<a name="l02224"></a>02224     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *area = <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02225"></a>02225     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc = <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l02226"></a>02226     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02227"></a>02227     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l02228"></a>02228 
<a name="l02229"></a>02229     <span class="keywordtype">int</span> xmin =  <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a> * 2;
<a name="l02230"></a>02230     <span class="keywordtype">int</span> xmax = -<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a> * 2;
<a name="l02231"></a>02231     <span class="keywordtype">int</span> ymin =  <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ad80d35fb1f6030ea512eef172e98cef5">MAXSEQ</a> + 1;
<a name="l02232"></a>02232     <span class="keywordtype">int</span> ymax = 0;
<a name="l02233"></a>02233     <span class="keywordtype">int</span> orig_height;
<a name="l02234"></a>02234     <span class="keywordtype">int</span> ymid;
<a name="l02235"></a>02235     <span class="keywordtype">int</span> ymargin = 1;
<a name="l02236"></a>02236     <span class="keywordtype">int</span> xmargin = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac92ca5ab87034a348decad7ee8d4bd1b">FPS</a>;
<a name="l02237"></a>02237 
<a name="l02238"></a>02238     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02239"></a>02239         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02240"></a>02240 
<a name="l02241"></a>02241     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02242"></a>02242         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#add20bc7b873e8f7514725f6f3863de53">flag</a> &amp; <a class="code" href="../../db/d17/fcurve_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>) {
<a name="l02243"></a>02243             xmin = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(xmin, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>);
<a name="l02244"></a>02244             xmax = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(xmax, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>);
<a name="l02245"></a>02245 
<a name="l02246"></a>02246             ymin = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(ymin, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a>);
<a name="l02247"></a>02247             ymax = <a class="code" href="../../d0/dbd/bmfont_8c.html#a57562d98bd289bc7ea77ba251915d8fb">MAX2</a>(ymax, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acec18bb3c5d89ee50e5e2d74ae1b85a4">machine</a>);
<a name="l02248"></a>02248         }
<a name="l02249"></a>02249     }
<a name="l02250"></a>02250 
<a name="l02251"></a>02251     <span class="keywordflow">if</span> (ymax != 0) {
<a name="l02252"></a>02252         
<a name="l02253"></a>02253         xmax += xmargin;
<a name="l02254"></a>02254         xmin -= xmargin;
<a name="l02255"></a>02255         ymax += ymargin;
<a name="l02256"></a>02256         ymin -= ymargin;
<a name="l02257"></a>02257 
<a name="l02258"></a>02258         orig_height = v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>;
<a name="l02259"></a>02259 
<a name="l02260"></a>02260         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> = xmin;
<a name="l02261"></a>02261         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> = xmax;
<a name="l02262"></a>02262 
<a name="l02263"></a>02263         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = ymin;
<a name="l02264"></a>02264         v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = ymax;
<a name="l02265"></a>02265 
<a name="l02266"></a>02266         <span class="comment">/* only zoom out vertically */</span>
<a name="l02267"></a>02267         <span class="keywordflow">if</span> (orig_height &gt; v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>) {
<a name="l02268"></a>02268             ymid = (v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> + v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>) / 2;
<a name="l02269"></a>02269 
<a name="l02270"></a>02270             v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> = ymid - (orig_height / 2);
<a name="l02271"></a>02271             v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a3e5cff50450e7702e8a33b40dd056cbb">cur</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> = ymid + (orig_height / 2);
<a name="l02272"></a>02272         }
<a name="l02273"></a>02273 
<a name="l02274"></a>02274         <a class="code" href="../../d5/d63/UI__view2d_8h.html#af75b83105e7573fbdbfd1a6c1e856058">UI_view2d_curRect_validate</a>(v2d);
<a name="l02275"></a>02275         <a class="code" href="../../d5/d63/UI__view2d_8h.html#ab7089b88d3b7fdc1f26037f32468c7b1">UI_view2d_sync</a>(sc, area, v2d, <a class="code" href="../../d5/d63/UI__view2d_8h.html#a1df4e9b75e5090a9a745b6f6bb9846af">V2D_LOCK_COPY</a>);
<a name="l02276"></a>02276 
<a name="l02277"></a>02277         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l02278"></a>02278     }
<a name="l02279"></a>02279     
<a name="l02280"></a>02280     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02281"></a>02281 }
<a name="l02282"></a>02282 
<a name="l02283"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ab62f58ed739093e04665c12c2d7db62c">02283</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac8795dac0768c6efdf563dc12c2ad008">SEQUENCER_OT_view_selected</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02284"></a>02284 {
<a name="l02285"></a>02285     <span class="comment">/* identifiers */</span>
<a name="l02286"></a>02286     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;View Selected&quot;</span>;
<a name="l02287"></a>02287     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_view_selected&quot;</span>;
<a name="l02288"></a>02288     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Zoom the sequencer on the selected strips&quot;</span>;
<a name="l02289"></a>02289     
<a name="l02290"></a>02290     <span class="comment">/* api callbacks */</span>
<a name="l02291"></a>02291     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a641226f656e6dd02f7a724d03dc4a1b6">sequencer_view_selected_exec</a>;
<a name="l02292"></a>02292     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02293"></a>02293     
<a name="l02294"></a>02294     <span class="comment">/* flags */</span>
<a name="l02295"></a>02295     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>;
<a name="l02296"></a>02296 }
<a name="l02297"></a>02297 
<a name="l02298"></a>02298 
<a name="l02299"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#af2f49f7f55395d10862d5086141a15cf">02299</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af2f49f7f55395d10862d5086141a15cf">find_next_prev_edit</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> cfra, <span class="keywordtype">int</span> side)
<a name="l02300"></a>02300 {
<a name="l02301"></a>02301     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02302"></a>02302     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *best_seq = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *frame_seq = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02303"></a>02303     
<a name="l02304"></a>02304     <span class="keywordtype">int</span> dist, best_dist;
<a name="l02305"></a>02305     best_dist = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a> * 2;
<a name="l02306"></a>02306 
<a name="l02307"></a>02307     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> cfra;
<a name="l02308"></a>02308     
<a name="l02309"></a>02309     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02310"></a>02310         dist = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afedd4d2cbfe9c6cdbc7496c9a2a01c9e">MAXFRAME</a> * 2;
<a name="l02311"></a>02311             
<a name="l02312"></a>02312         <span class="keywordflow">switch</span> (side) {
<a name="l02313"></a>02313             <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>:
<a name="l02314"></a>02314                 <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &lt; cfra) {
<a name="l02315"></a>02315                     dist = cfra - seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>;
<a name="l02316"></a>02316                 }
<a name="l02317"></a>02317                 <span class="keywordflow">break</span>;
<a name="l02318"></a>02318             <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>:
<a name="l02319"></a>02319                 <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> &gt; cfra) {
<a name="l02320"></a>02320                     dist = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - cfra;
<a name="l02321"></a>02321                 }
<a name="l02322"></a>02322                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> == cfra) {
<a name="l02323"></a>02323                     frame_seq = seq;
<a name="l02324"></a>02324                 }
<a name="l02325"></a>02325                 <span class="keywordflow">break</span>;
<a name="l02326"></a>02326         }
<a name="l02327"></a>02327 
<a name="l02328"></a>02328         <span class="keywordflow">if</span> (dist &lt; best_dist) {
<a name="l02329"></a>02329             best_dist = dist;
<a name="l02330"></a>02330             best_seq = seq;
<a name="l02331"></a>02331         }
<a name="l02332"></a>02332     }
<a name="l02333"></a>02333 
<a name="l02334"></a>02334     <span class="comment">/* if no sequence to the right is found and the</span>
<a name="l02335"></a>02335 <span class="comment">     * frame is on the start of the last sequence,</span>
<a name="l02336"></a>02336 <span class="comment">     * move to the end of the last sequence */</span>
<a name="l02337"></a>02337     <span class="keywordflow">if</span> (frame_seq) cfra = frame_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>;
<a name="l02338"></a>02338 
<a name="l02339"></a>02339     <span class="keywordflow">return</span> best_seq ? best_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> : cfra;
<a name="l02340"></a>02340 }
<a name="l02341"></a>02341 
<a name="l02342"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab54edc4cb1a3e2db2ab7e7bdee5287b2">02342</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab54edc4cb1a3e2db2ab7e7bdee5287b2">next_prev_edit_internal</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> side)
<a name="l02343"></a>02343 {
<a name="l02344"></a>02344     <span class="keywordtype">int</span> change = 0;
<a name="l02345"></a>02345     <span class="keywordtype">int</span> cfra = <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>;
<a name="l02346"></a>02346     <span class="keywordtype">int</span> nfra = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af2f49f7f55395d10862d5086141a15cf">find_next_prev_edit</a>(scene, cfra, side);
<a name="l02347"></a>02347     
<a name="l02348"></a>02348     <span class="keywordflow">if</span> (nfra != cfra) {
<a name="l02349"></a>02349         <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a> = nfra;
<a name="l02350"></a>02350         change = 1;
<a name="l02351"></a>02351     }
<a name="l02352"></a>02352 
<a name="l02353"></a>02353     <span class="keywordflow">return</span> change;
<a name="l02354"></a>02354 }
<a name="l02355"></a>02355 
<a name="l02356"></a>02356 <span class="comment">/* move frame to next edit point operator */</span>
<a name="l02357"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ace43dd45fe5d189d53d852f239bba26d">02357</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ace43dd45fe5d189d53d852f239bba26d">sequencer_next_edit_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02358"></a>02358 {
<a name="l02359"></a>02359     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02360"></a>02360     
<a name="l02361"></a>02361     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab54edc4cb1a3e2db2ab7e7bdee5287b2">next_prev_edit_internal</a>(scene, <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>))
<a name="l02362"></a>02362         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02363"></a>02363 
<a name="l02364"></a>02364     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>, scene);
<a name="l02365"></a>02365 
<a name="l02366"></a>02366     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02367"></a>02367 }
<a name="l02368"></a>02368 
<a name="l02369"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a4f4922bb214b0b39738d61618daaa067">02369</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa88610714fa2dd9721a90803669caa1c">SEQUENCER_OT_next_edit</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02370"></a>02370 {
<a name="l02371"></a>02371     <span class="comment">/* identifiers */</span>
<a name="l02372"></a>02372     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Next Edit&quot;</span>;
<a name="l02373"></a>02373     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_next_edit&quot;</span>;
<a name="l02374"></a>02374     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Move frame to next edit point&quot;</span>;
<a name="l02375"></a>02375     
<a name="l02376"></a>02376     <span class="comment">/* api callbacks */</span>
<a name="l02377"></a>02377     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ace43dd45fe5d189d53d852f239bba26d">sequencer_next_edit_exec</a>;
<a name="l02378"></a>02378     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l02379"></a>02379     
<a name="l02380"></a>02380     <span class="comment">/* flags */</span>
<a name="l02381"></a>02381     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02382"></a>02382     
<a name="l02383"></a>02383     <span class="comment">/* properties */</span>
<a name="l02384"></a>02384 }
<a name="l02385"></a>02385 
<a name="l02386"></a>02386 <span class="comment">/* move frame to previous edit point operator */</span>
<a name="l02387"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6e723d9e7d0ce21fa7fa7c736d1797f4">02387</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6e723d9e7d0ce21fa7fa7c736d1797f4">sequencer_previous_edit_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02388"></a>02388 {
<a name="l02389"></a>02389     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02390"></a>02390     
<a name="l02391"></a>02391     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ab54edc4cb1a3e2db2ab7e7bdee5287b2">next_prev_edit_internal</a>(scene, <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>))
<a name="l02392"></a>02392         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02393"></a>02393 
<a name="l02394"></a>02394     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>, scene);
<a name="l02395"></a>02395     
<a name="l02396"></a>02396     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02397"></a>02397 }
<a name="l02398"></a>02398 
<a name="l02399"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a30c4e05c2bcbf40334174d4583be020a">02399</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af629683134ac29bcccff983fc3e259f4">SEQUENCER_OT_previous_edit</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02400"></a>02400 {
<a name="l02401"></a>02401     <span class="comment">/* identifiers */</span>
<a name="l02402"></a>02402     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Previous Edit&quot;</span>;
<a name="l02403"></a>02403     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_previous_edit&quot;</span>;
<a name="l02404"></a>02404     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Move frame to previous edit point&quot;</span>;
<a name="l02405"></a>02405     
<a name="l02406"></a>02406     <span class="comment">/* api callbacks */</span>
<a name="l02407"></a>02407     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6e723d9e7d0ce21fa7fa7c736d1797f4">sequencer_previous_edit_exec</a>;
<a name="l02408"></a>02408     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l02409"></a>02409     
<a name="l02410"></a>02410     <span class="comment">/* flags */</span>
<a name="l02411"></a>02411     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02412"></a>02412     
<a name="l02413"></a>02413     <span class="comment">/* properties */</span>
<a name="l02414"></a>02414 }
<a name="l02415"></a>02415 
<a name="l02416"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#af0a235c8e454c7697fc86ec84c3eeaa9">02416</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af0a235c8e454c7697fc86ec84c3eeaa9">swap_sequence</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seqa, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seqb)
<a name="l02417"></a>02417 {
<a name="l02418"></a>02418     <span class="keywordtype">int</span> gap = seqb-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a> - seqa-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a>;
<a name="l02419"></a>02419     seqb-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = (seqb-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> - seqb-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>) + seqa-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>;
<a name="l02420"></a>02420     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seqb);
<a name="l02421"></a>02421     seqa-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> = (seqa-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a20aa4398994695c982d8b56d858e13bf">start</a> - seqa-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a2aa66a78e868a7e54f7643496e7ee018">startdisp</a>) + seqb-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ac56b2f05e8517940c88d9a9b84e52025">enddisp</a> + gap;
<a name="l02422"></a>02422     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seqa);
<a name="l02423"></a>02423 }
<a name="l02424"></a>02424 
<a name="l02425"></a>02425 <span class="preprocessor">#if 0</span>
<a name="l02426"></a>02426 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *sequence_find_parent(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *child)
<a name="l02427"></a>02427 {
<a name="l02428"></a>02428     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02429"></a>02429     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *parent = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02430"></a>02430     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l02431"></a>02431 
<a name="l02432"></a>02432     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02433"></a>02433 
<a name="l02434"></a>02434     <span class="keywordflow">for</span> (seq = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02435"></a>02435         <span class="keywordflow">if</span> ( (seq != child) &amp;&amp; <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">seq_is_parent</a>(seq, child) ) {
<a name="l02436"></a>02436             parent = seq;
<a name="l02437"></a>02437             <span class="keywordflow">break</span>;
<a name="l02438"></a>02438         }
<a name="l02439"></a>02439     }
<a name="l02440"></a>02440 
<a name="l02441"></a>02441     <span class="keywordflow">return</span> parent;
<a name="l02442"></a>02442 }
<a name="l02443"></a>02443 <span class="preprocessor">#endif</span>
<a name="l02444"></a>02444 <span class="preprocessor"></span>
<a name="l02445"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae7af6359de53ab1d5989f29a1a61e5b2">02445</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae7af6359de53ab1d5989f29a1a61e5b2">sequencer_swap_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02446"></a>02446 {
<a name="l02447"></a>02447     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02448"></a>02448     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02449"></a>02449     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *active_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l02450"></a>02450     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *iseq;
<a name="l02451"></a>02451     <span class="keywordtype">int</span> side = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;side&quot;</span>);
<a name="l02452"></a>02452 
<a name="l02453"></a>02453     <span class="keywordflow">if</span> (active_seq == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02454"></a>02454 
<a name="l02455"></a>02455     seq = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a17d918739a38fb9ce8b9a1ff791abaa1">find_next_prev_sequence</a>(scene, active_seq, side, -1);
<a name="l02456"></a>02456     
<a name="l02457"></a>02457     <span class="keywordflow">if</span> (seq) {
<a name="l02458"></a>02458         
<a name="l02459"></a>02459         <span class="comment">/* disallow effect strips */</span>
<a name="l02460"></a>02460         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a47b9509a75eefacd18b6511957497821">get_sequence_effect_num_inputs</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a>) &gt;= 1 &amp;&amp; (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1511098380a8c09302a09e43aef9d619">effectdata</a> || seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> || seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> || seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>))
<a name="l02461"></a>02461             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02462"></a>02462         <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a47b9509a75eefacd18b6511957497821">get_sequence_effect_num_inputs</a>(active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a>) &gt;= 1) &amp;&amp; (active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a1511098380a8c09302a09e43aef9d619">effectdata</a> || active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a> || active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a> || active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>))
<a name="l02463"></a>02463             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02464"></a>02464 
<a name="l02465"></a>02465         <span class="keywordflow">switch</span> (side) {
<a name="l02466"></a>02466             <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a9dffe253ddd0377530d63664b69e7328">SEQ_SIDE_LEFT</a>: 
<a name="l02467"></a>02467                 <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af0a235c8e454c7697fc86ec84c3eeaa9">swap_sequence</a>(scene, seq, active_seq);
<a name="l02468"></a>02468                 <span class="keywordflow">break</span>;
<a name="l02469"></a>02469             <span class="keywordflow">case</span> <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>: 
<a name="l02470"></a>02470                 <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af0a235c8e454c7697fc86ec84c3eeaa9">swap_sequence</a>(scene, active_seq, seq);
<a name="l02471"></a>02471                 <span class="keywordflow">break</span>;
<a name="l02472"></a>02472         }
<a name="l02473"></a>02473 
<a name="l02474"></a>02474         <span class="comment">// XXX - should be a generic function</span>
<a name="l02475"></a>02475         <span class="keywordflow">for</span> (iseq = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; iseq; iseq = iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02476"></a>02476             <span class="keywordflow">if</span> ((iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) &amp;&amp; (<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">seq_is_parent</a>(iseq, active_seq) || <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">seq_is_parent</a>(iseq, seq))) {
<a name="l02477"></a>02477                 <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, iseq);
<a name="l02478"></a>02478             }
<a name="l02479"></a>02479         }
<a name="l02480"></a>02480 
<a name="l02481"></a>02481         <span class="comment">/* do this in a new loop since both effects need to be calculated first */</span>
<a name="l02482"></a>02482         <span class="keywordflow">for</span> (iseq = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; iseq; iseq = iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02483"></a>02483             <span class="keywordflow">if</span> ((iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) &amp;&amp; (<a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">seq_is_parent</a>(iseq, active_seq) || <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac0a0846dbda11bd578074af3450112c0">seq_is_parent</a>(iseq, seq))) {
<a name="l02484"></a>02484                 <span class="comment">/* this may now overlap */</span>
<a name="l02485"></a>02485                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a744e1678a9c2d9d80ddb30927c2481f3">seq_test_overlap</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, iseq) ) {
<a name="l02486"></a>02486                     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ace28fbac813ada7b6a0095cbe4d389df">shuffle_seq</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, iseq, scene);
<a name="l02487"></a>02487                 }
<a name="l02488"></a>02488             }
<a name="l02489"></a>02489         }
<a name="l02490"></a>02490 
<a name="l02491"></a>02491 
<a name="l02492"></a>02492 
<a name="l02493"></a>02493         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a351665cd83431f78daaffde840fc0da8">sort_seq</a>(scene);
<a name="l02494"></a>02494 
<a name="l02495"></a>02495         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l02496"></a>02496 
<a name="l02497"></a>02497         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02498"></a>02498     }
<a name="l02499"></a>02499 
<a name="l02500"></a>02500     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02501"></a>02501 }
<a name="l02502"></a>02502 
<a name="l02503"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ab0e949826b3e5f80f8fc781608870c8e">02503</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#abf86187d6ce4a85d9a4dd0d3d41ed9e5">SEQUENCER_OT_swap</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02504"></a>02504 {
<a name="l02505"></a>02505     <span class="comment">/* identifiers */</span>
<a name="l02506"></a>02506     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Swap Strip&quot;</span>;
<a name="l02507"></a>02507     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_swap&quot;</span>;
<a name="l02508"></a>02508     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Swap active strip with strip to the right or left&quot;</span>;
<a name="l02509"></a>02509     
<a name="l02510"></a>02510     <span class="comment">/* api callbacks */</span>
<a name="l02511"></a>02511     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ae7af6359de53ab1d5989f29a1a61e5b2">sequencer_swap_exec</a>;
<a name="l02512"></a>02512     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l02513"></a>02513     
<a name="l02514"></a>02514     <span class="comment">/* flags */</span>
<a name="l02515"></a>02515     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02516"></a>02516     
<a name="l02517"></a>02517     <span class="comment">/* properties */</span>
<a name="l02518"></a>02518     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;side&quot;</span>, prop_side_lr_types, <a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8420dba71b9cc240cf981b0bef892004a07d80e2715b08416b09ae7c1c538a427">SEQ_SIDE_RIGHT</a>, <span class="stringliteral">&quot;Side&quot;</span>, <span class="stringliteral">&quot;Side of the strip to swap&quot;</span>);
<a name="l02519"></a>02519 }
<a name="l02520"></a>02520 
<a name="l02521"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a481ffe139203bfaff4c4f12235ab2b95">02521</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a481ffe139203bfaff4c4f12235ab2b95">sequencer_rendersize_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02522"></a>02522 {
<a name="l02523"></a>02523     <span class="keywordtype">int</span> retval = <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02524"></a>02524     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02525"></a>02525     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *active_seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l02526"></a>02526     <a class="code" href="../../d0/d38/structStripElem.html">StripElem</a> *se = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02527"></a>02527 
<a name="l02528"></a>02528     <span class="keywordflow">if</span> (active_seq == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02529"></a>02529         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02530"></a>02530 
<a name="l02531"></a>02531 
<a name="l02532"></a>02532     <span class="keywordflow">if</span> (active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>) {
<a name="l02533"></a>02533         <span class="keywordflow">switch</span> (active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a>) {
<a name="l02534"></a>02534             <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ac06b183625bca249c8c0d1168f907aeb">SEQ_IMAGE</a>:
<a name="l02535"></a>02535                 se = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a000a22b46caf0117e7d0b5956e5a3615">give_stripelem</a>(active_seq, scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>);
<a name="l02536"></a>02536                 <span class="keywordflow">break</span>;
<a name="l02537"></a>02537             <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af37f12bdb831d524294dcd62ff0a8805">SEQ_MOVIE</a>:
<a name="l02538"></a>02538                 se = active_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a5f5ecc8c7ffc8375e8a43b2500738889">stripdata</a>;
<a name="l02539"></a>02539                 <span class="keywordflow">break</span>;
<a name="l02540"></a>02540             <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af051b69d8cf51868252e25a23d14e50a">SEQ_SCENE</a>:
<a name="l02541"></a>02541             <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>:
<a name="l02542"></a>02542             <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a8b0dfdfbb5067b1fe563ac12b3df6c69">SEQ_RAM_SOUND</a>:
<a name="l02543"></a>02543             <span class="keywordflow">case</span> <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#af135daf13efd69a8d844dc7d9058cdc1">SEQ_HD_SOUND</a>:
<a name="l02544"></a>02544             <span class="keywordflow">default</span>:
<a name="l02545"></a>02545                 <span class="keywordflow">break</span>;
<a name="l02546"></a>02546         }
<a name="l02547"></a>02547     }
<a name="l02548"></a>02548 
<a name="l02549"></a>02549     <span class="keywordflow">if</span> (se) {
<a name="l02550"></a>02550         <span class="comment">// prevent setting the render size if sequence values aren&#39;t initialized</span>
<a name="l02551"></a>02551         <span class="keywordflow">if</span> ( (se-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a3ef3836b87b9f9d8693a1ec4278d6d4f">orig_width</a> &gt; 0) &amp;&amp; (se-&gt;<a class="code" href="../../d0/d38/structStripElem.html#ae93f174380c5d9efe6030592def59ad0">orig_height</a> &gt; 0) ) {
<a name="l02552"></a>02552             scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#afac89783028ff848f111de04e0c29fbe">xsch</a> = se-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a3ef3836b87b9f9d8693a1ec4278d6d4f">orig_width</a>;
<a name="l02553"></a>02553             scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aca3c1ebdf50a6c74730e19e24983217d">ysch</a> = se-&gt;<a class="code" href="../../d0/d38/structStripElem.html#ae93f174380c5d9efe6030592def59ad0">orig_height</a>;
<a name="l02554"></a>02554             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a2d1f4e4fbef089f325035e7fcf010b66">ND_RENDER_OPTIONS</a>, scene);
<a name="l02555"></a>02555             retval = <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02556"></a>02556         }
<a name="l02557"></a>02557     }
<a name="l02558"></a>02558 
<a name="l02559"></a>02559     <span class="keywordflow">return</span> retval;
<a name="l02560"></a>02560 }
<a name="l02561"></a>02561 
<a name="l02562"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ae1e278c0fc76e1bcec9815a241804bc8">02562</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a20cd9f761e7897be47478d952f83bf11">SEQUENCER_OT_rendersize</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02563"></a>02563 {
<a name="l02564"></a>02564     <span class="comment">/* identifiers */</span>
<a name="l02565"></a>02565     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Set Render Size&quot;</span>;
<a name="l02566"></a>02566     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_rendersize&quot;</span>;
<a name="l02567"></a>02567     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Set render size and aspect from active sequence&quot;</span>;
<a name="l02568"></a>02568     
<a name="l02569"></a>02569     <span class="comment">/* api callbacks */</span>
<a name="l02570"></a>02570     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a481ffe139203bfaff4c4f12235ab2b95">sequencer_rendersize_exec</a>;
<a name="l02571"></a>02571     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l02572"></a>02572     
<a name="l02573"></a>02573     <span class="comment">/* flags */</span>
<a name="l02574"></a>02574     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02575"></a>02575     
<a name="l02576"></a>02576     <span class="comment">/* properties */</span>
<a name="l02577"></a>02577 }
<a name="l02578"></a>02578 
<a name="l02579"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a745497958ea76275b30c7cb5e9ce58d1">02579</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a745497958ea76275b30c7cb5e9ce58d1">seq_copy_del_sound</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq)
<a name="l02580"></a>02580 {
<a name="l02581"></a>02581     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>) {
<a name="l02582"></a>02582         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *iseq;
<a name="l02583"></a>02583         <span class="keywordflow">for</span> (iseq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; iseq; iseq = iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02584"></a>02584             <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a745497958ea76275b30c7cb5e9ce58d1">seq_copy_del_sound</a>(scene, iseq);
<a name="l02585"></a>02585         }
<a name="l02586"></a>02586     }
<a name="l02587"></a>02587     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a>) {
<a name="l02588"></a>02588         <a class="code" href="../../d2/db1/BKE__sound_8h.html#a74150add0e85ba1bdea575523b8664a2">sound_remove_scene_sound</a>(scene, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a>);
<a name="l02589"></a>02589         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02590"></a>02590     }
<a name="l02591"></a>02591 }
<a name="l02592"></a>02592 
<a name="l02593"></a>02593 <span class="comment">/* TODO, validate scenes */</span>
<a name="l02594"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#adb932a51de8f7253a413efe151ee771b">02594</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#adb932a51de8f7253a413efe151ee771b">sequencer_copy_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02595"></a>02595 {
<a name="l02596"></a>02596     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02597"></a>02597     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02598"></a>02598     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq;
<a name="l02599"></a>02599 
<a name="l02600"></a>02600     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> nseqbase = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l02601"></a>02601 
<a name="l02602"></a>02602     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a5de250a370189cb702a7a4e4ce6b3a30">seq_free_clipboard</a>();
<a name="l02603"></a>02603 
<a name="l02604"></a>02604     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a6033630a9a5aa0d9f03a2f94d78f4d88">seqbase_isolated_sel_check</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>) == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
<a name="l02605"></a>02605         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Please select all related strips&quot;</span>);
<a name="l02606"></a>02606         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02607"></a>02607     }
<a name="l02608"></a>02608 
<a name="l02609"></a>02609     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a6a19420861bba9c05e0d73b5b54e7ff6">seqbase_dupli_recursive</a>(scene, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;nseqbase, ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a1660e3e1c0a867f4ae91f78bedc20e11">SEQ_DUPE_UNIQUE_NAME</a>);
<a name="l02610"></a>02610 
<a name="l02611"></a>02611     <span class="comment">/* To make sure the copied strips have unique names between each other add</span>
<a name="l02612"></a>02612 <span class="comment">     * them temporarily to the end of the original seqbase. (bug 25932)</span>
<a name="l02613"></a>02613 <span class="comment">     */</span>
<a name="l02614"></a>02614     <span class="keywordflow">if</span> (nseqbase.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>) {
<a name="l02615"></a>02615         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq, *first_seq = nseqbase.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l02616"></a>02616         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aea47205fbf4fc9965bc2b06e7e3ca75a">BLI_movelisttolist</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, &amp;nseqbase);
<a name="l02617"></a>02617 
<a name="l02618"></a>02618         <span class="keywordflow">for</span> (seq = first_seq; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>)
<a name="l02619"></a>02619             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aa1d91fc50da4428f24c3c6ffb0b013a2">seq_recursive_apply</a>(seq, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd0b3b45597e42af1e6e22d1c0cd828d">apply_unique_name_cb</a>, scene);
<a name="l02620"></a>02620 
<a name="l02621"></a>02621         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a2e5b41c74a0c237fed067a16ebe2438e">seqbase_clipboard</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> = first_seq;
<a name="l02622"></a>02622         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a2e5b41c74a0c237fed067a16ebe2438e">seqbase_clipboard</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a> = ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l02623"></a>02623 
<a name="l02624"></a>02624         <span class="keywordflow">if</span> (first_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a7a59e7cb1df745f25913002ad24e6a0b">prev</a>) {
<a name="l02625"></a>02625             first_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a7a59e7cb1df745f25913002ad24e6a0b">prev</a>-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02626"></a>02626             ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>-&gt;<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a> = first_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a7a59e7cb1df745f25913002ad24e6a0b">prev</a>;
<a name="l02627"></a>02627             first_seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a7a59e7cb1df745f25913002ad24e6a0b">prev</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02628"></a>02628         }
<a name="l02629"></a>02629     }
<a name="l02630"></a>02630 
<a name="l02631"></a>02631     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ab4fab2db354bb6fddea52f4624ba0bd8">seqbase_clipboard_frame</a> = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>;
<a name="l02632"></a>02632 
<a name="l02633"></a>02633     <span class="comment">/* Need to remove anything that references the current scene */</span>
<a name="l02634"></a>02634     <span class="keywordflow">for</span> (seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a2e5b41c74a0c237fed067a16ebe2438e">seqbase_clipboard</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; seq; seq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02635"></a>02635         <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a745497958ea76275b30c7cb5e9ce58d1">seq_copy_del_sound</a>(scene, seq);
<a name="l02636"></a>02636     }
<a name="l02637"></a>02637 
<a name="l02638"></a>02638     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02639"></a>02639 }
<a name="l02640"></a>02640 
<a name="l02641"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a186fd38a48d3d35086096b667418707a">02641</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a1d6a493ede8b7ada645f5469a7c8c49d">SEQUENCER_OT_copy</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02642"></a>02642 {
<a name="l02643"></a>02643     <span class="comment">/* identifiers */</span>
<a name="l02644"></a>02644     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Copy&quot;</span>;
<a name="l02645"></a>02645     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_copy&quot;</span>;
<a name="l02646"></a>02646     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l02647"></a>02647 
<a name="l02648"></a>02648     <span class="comment">/* api callbacks */</span>
<a name="l02649"></a>02649     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#adb932a51de8f7253a413efe151ee771b">sequencer_copy_exec</a>;
<a name="l02650"></a>02650     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a715528d279a3b4fd8d8254ab372f4b6b">sequencer_edit_poll</a>;
<a name="l02651"></a>02651 
<a name="l02652"></a>02652     <span class="comment">/* flags */</span>
<a name="l02653"></a>02653     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>;
<a name="l02654"></a>02654 
<a name="l02655"></a>02655     <span class="comment">/* properties */</span>
<a name="l02656"></a>02656 }
<a name="l02657"></a>02657 
<a name="l02658"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a08e987edac1def3959f26ea2a03bafd2">02658</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a08e987edac1def3959f26ea2a03bafd2">seq_paste_add_sound</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene, <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq)
<a name="l02659"></a>02659 {
<a name="l02660"></a>02660     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a0ff3d95aaa4b8f030a8b032636bf63c6">SEQ_META</a>) {
<a name="l02661"></a>02661         <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *iseq;
<a name="l02662"></a>02662         <span class="keywordflow">for</span> (iseq = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa36ece483e44a2f715bc29b396284bc0">seqbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; iseq; iseq = iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02663"></a>02663             <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a08e987edac1def3959f26ea2a03bafd2">seq_paste_add_sound</a>(scene, iseq);
<a name="l02664"></a>02664         }
<a name="l02665"></a>02665     }
<a name="l02666"></a>02666     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a3667844452f6c2f4b40e851fb3cf5132">SEQ_SOUND</a>) {
<a name="l02667"></a>02667         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a> = <a class="code" href="../../d2/db1/BKE__sound_8h.html#a08efb69894c1b50d50c5473839f28b94">sound_add_scene_sound_defaults</a>(scene, seq);
<a name="l02668"></a>02668     }
<a name="l02669"></a>02669 }
<a name="l02670"></a>02670 
<a name="l02671"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea6a2b3c2ae5620be24e2f787574105e">02671</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea6a2b3c2ae5620be24e2f787574105e">sequencer_paste_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02672"></a>02672 {
<a name="l02673"></a>02673     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02674"></a>02674     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>); <span class="comment">/* create if needed */</span>
<a name="l02675"></a>02675     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> nseqbase = {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l02676"></a>02676     <span class="keywordtype">int</span> ofs;
<a name="l02677"></a>02677     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *iseq;
<a name="l02678"></a>02678 
<a name="l02679"></a>02679     <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad6691eeb07fb20cb105c6146922f023a">deselect_all_seq</a>(scene);
<a name="l02680"></a>02680     ofs = scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> - <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ab4fab2db354bb6fddea52f4624ba0bd8">seqbase_clipboard_frame</a>;
<a name="l02681"></a>02681 
<a name="l02682"></a>02682     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a6a19420861bba9c05e0d73b5b54e7ff6">seqbase_dupli_recursive</a>(scene, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;nseqbase, &amp;<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a2e5b41c74a0c237fed067a16ebe2438e">seqbase_clipboard</a>, <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a1660e3e1c0a867f4ae91f78bedc20e11">SEQ_DUPE_UNIQUE_NAME</a>);
<a name="l02683"></a>02683 
<a name="l02684"></a>02684     <span class="comment">/* transform pasted strips before adding */</span>
<a name="l02685"></a>02685     <span class="keywordflow">if</span> (ofs) {
<a name="l02686"></a>02686         <span class="keywordflow">for</span> (iseq = nseqbase.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; iseq; iseq = iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02687"></a>02687             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7aa6ef5bba1f8e92bc5c67dcea04aa82">seq_translate</a>(scene, iseq, ofs);
<a name="l02688"></a>02688             <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#ac6fbbcc0e773d8b029d73d6438c2e8f9">seq_sound_init</a>(scene, iseq);
<a name="l02689"></a>02689         }
<a name="l02690"></a>02690     }
<a name="l02691"></a>02691 
<a name="l02692"></a>02692     iseq = nseqbase.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l02693"></a>02693 
<a name="l02694"></a>02694     <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aea47205fbf4fc9965bc2b06e7e3ca75a">BLI_movelisttolist</a>(ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a2a3744774bbd84f20c3204f41e73fe97">seqbasep</a>, &amp;nseqbase);
<a name="l02695"></a>02695 
<a name="l02696"></a>02696     <span class="comment">/* make sure the pasted strips have unique names between them */</span>
<a name="l02697"></a>02697     <span class="keywordflow">for</span> (; iseq; iseq = iseq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ad4de4f8111ab2794d21cfbd6a2fc1810">next</a>) {
<a name="l02698"></a>02698         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#aa1d91fc50da4428f24c3c6ffb0b013a2">seq_recursive_apply</a>(iseq, <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd0b3b45597e42af1e6e22d1c0cd828d">apply_unique_name_cb</a>, scene);
<a name="l02699"></a>02699 
<a name="l02700"></a>02700         <span class="comment">/* restore valid sound_scene for newly added strips */</span>
<a name="l02701"></a>02701         <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a08e987edac1def3959f26ea2a03bafd2">seq_paste_add_sound</a>(scene, iseq);
<a name="l02702"></a>02702     }
<a name="l02703"></a>02703 
<a name="l02704"></a>02704     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l02705"></a>02705 
<a name="l02706"></a>02706     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02707"></a>02707 }
<a name="l02708"></a>02708 
<a name="l02709"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ac50f9a499cbb968f403bfa20708d77f9">02709</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acb98b8a9f1de6a749e24616161dd6456">SEQUENCER_OT_paste</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02710"></a>02710 {
<a name="l02711"></a>02711     <span class="comment">/* identifiers */</span>
<a name="l02712"></a>02712     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Paste&quot;</span>;
<a name="l02713"></a>02713     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_paste&quot;</span>;
<a name="l02714"></a>02714     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l02715"></a>02715 
<a name="l02716"></a>02716     <span class="comment">/* api callbacks */</span>
<a name="l02717"></a>02717     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aea6a2b3c2ae5620be24e2f787574105e">sequencer_paste_exec</a>;
<a name="l02718"></a>02718     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02719"></a>02719 
<a name="l02720"></a>02720     <span class="comment">/* flags */</span>
<a name="l02721"></a>02721     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02722"></a>02722 
<a name="l02723"></a>02723     <span class="comment">/* properties */</span>
<a name="l02724"></a>02724 }
<a name="l02725"></a>02725 
<a name="l02726"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6ee5ea03066a82bf2e6346be73d2551d">02726</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6ee5ea03066a82bf2e6346be73d2551d">sequencer_swap_data_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02727"></a>02727 {
<a name="l02728"></a>02728     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02729"></a>02729     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq_act;
<a name="l02730"></a>02730     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq_other;
<a name="l02731"></a>02731     <span class="keyword">const</span> <span class="keywordtype">char</span> *error_msg;
<a name="l02732"></a>02732 
<a name="l02733"></a>02733     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a8e67d1ef7c12b3153b29fee72378732f">seq_active_pair_get</a>(scene, &amp;seq_act, &amp;seq_other) == 0) {
<a name="l02734"></a>02734         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Must select 2 strips&quot;</span>);
<a name="l02735"></a>02735         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02736"></a>02736     }
<a name="l02737"></a>02737 
<a name="l02738"></a>02738     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a35961fdcd81a7bf2e26de660e070f061">seq_swap</a>(seq_act, seq_other, &amp;error_msg) == 0) {
<a name="l02739"></a>02739         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, error_msg);
<a name="l02740"></a>02740         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02741"></a>02741     }
<a name="l02742"></a>02742 
<a name="l02743"></a>02743     <a class="code" href="../../d2/db1/BKE__sound_8h.html#a74150add0e85ba1bdea575523b8664a2">sound_remove_scene_sound</a>(scene, seq_act-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a>);
<a name="l02744"></a>02744     <a class="code" href="../../d2/db1/BKE__sound_8h.html#a74150add0e85ba1bdea575523b8664a2">sound_remove_scene_sound</a>(scene, seq_other-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a>);
<a name="l02745"></a>02745 
<a name="l02746"></a>02746     seq_act-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02747"></a>02747     seq_other-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a424b12e52a2943c13a922b52de6e0845">scene_sound</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02748"></a>02748 
<a name="l02749"></a>02749     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq_act);
<a name="l02750"></a>02750     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq_other);
<a name="l02751"></a>02751 
<a name="l02752"></a>02752     <span class="keywordflow">if</span> (seq_act-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa80c3c765c96ab1aefb4a64ca1c5f672">sound</a>) <a class="code" href="../../d2/db1/BKE__sound_8h.html#a08efb69894c1b50d50c5473839f28b94">sound_add_scene_sound_defaults</a>(scene, seq_act);
<a name="l02753"></a>02753     <span class="keywordflow">if</span> (seq_other-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aa80c3c765c96ab1aefb4a64ca1c5f672">sound</a>) <a class="code" href="../../d2/db1/BKE__sound_8h.html#a08efb69894c1b50d50c5473839f28b94">sound_add_scene_sound_defaults</a>(scene, seq_other);
<a name="l02754"></a>02754 
<a name="l02755"></a>02755     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l02756"></a>02756 
<a name="l02757"></a>02757     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02758"></a>02758 }
<a name="l02759"></a>02759 
<a name="l02760"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a7335bb17b9be18a101c74d4dd3658a23">02760</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a61001be2b24025a3f41d88cb281c006b">SEQUENCER_OT_swap_data</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02761"></a>02761 {
<a name="l02762"></a>02762     <span class="comment">/* identifiers */</span>
<a name="l02763"></a>02763     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Sequencer Swap Data&quot;</span>;
<a name="l02764"></a>02764     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_swap_data&quot;</span>;
<a name="l02765"></a>02765     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Swap 2 sequencer strips&quot;</span>;
<a name="l02766"></a>02766 
<a name="l02767"></a>02767     <span class="comment">/* api callbacks */</span>
<a name="l02768"></a>02768     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6ee5ea03066a82bf2e6346be73d2551d">sequencer_swap_data_exec</a>;
<a name="l02769"></a>02769     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02770"></a>02770 
<a name="l02771"></a>02771     <span class="comment">/* flags */</span>
<a name="l02772"></a>02772     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02773"></a>02773 
<a name="l02774"></a>02774     <span class="comment">/* properties */</span>
<a name="l02775"></a>02775 }
<a name="l02776"></a>02776 
<a name="l02777"></a>02777 <span class="comment">/* borderselect operator */</span>
<a name="l02778"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#af3abb9340ce181d283d8b5f8961ffde3">02778</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af3abb9340ce181d283d8b5f8961ffde3">view_ghost_border_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02779"></a>02779 {
<a name="l02780"></a>02780     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02781"></a>02781     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02782"></a>02782     <a class="code" href="../../d7/de3/structView2D.html">View2D</a> *v2d = <a class="code" href="../../d5/d63/UI__view2d_8h.html#a5438d7c06bc8dbbb2746da95bcbcefb5">UI_view2d_fromcontext</a>(C);
<a name="l02783"></a>02783 
<a name="l02784"></a>02784     <a class="code" href="../../da/d10/structrctf.html">rctf</a> rect;
<a name="l02785"></a>02785 
<a name="l02786"></a>02786     <span class="comment">/* convert coordinates of rect to &#39;tot&#39; rect coordinates */</span>
<a name="l02787"></a>02787     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmin&quot;</span>), <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymin&quot;</span>), &amp;rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, &amp;rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>);
<a name="l02788"></a>02788     <a class="code" href="../../d5/d63/UI__view2d_8h.html#acb43bece9ce784b1daa91efb77069e78">UI_view2d_region_to_view</a>(v2d, <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;xmax&quot;</span>), <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;ymax&quot;</span>), &amp;rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a>, &amp;rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>);
<a name="l02789"></a>02789 
<a name="l02790"></a>02790     <span class="keywordflow">if</span> (ed == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02791"></a>02791         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02792"></a>02792 
<a name="l02793"></a>02793     rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> /=  (float)(<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>));
<a name="l02794"></a>02794     rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> /=  (float)(<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>));
<a name="l02795"></a>02795 
<a name="l02796"></a>02796     rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> /=  (float)(<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>));
<a name="l02797"></a>02797     rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> /=  (float)(<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> - v2d-&gt;<a class="code" href="../../d7/de3/structView2D.html#a08871e1668409d82d50b637bab889f74">tot</a>.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>));
<a name="l02798"></a>02798 
<a name="l02799"></a>02799     rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a> += 0.5f;
<a name="l02800"></a>02800     rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a> += 0.5f;
<a name="l02801"></a>02801     rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a> += 0.5f;
<a name="l02802"></a>02802     rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a> += 0.5f;
<a name="l02803"></a>02803 
<a name="l02804"></a>02804     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(rect.<a class="code" href="../../da/d10/structrctf.html#a9d7813796d160db4cdb7b9c749a8901d">xmin</a>, 0.0f, 1.0f);
<a name="l02805"></a>02805     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(rect.<a class="code" href="../../da/d10/structrctf.html#aeea1ce7886a81f1099e897d587012013">ymin</a>, 0.0f, 1.0f);
<a name="l02806"></a>02806     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(rect.<a class="code" href="../../da/d10/structrctf.html#a76a664abf5a6971d8cc82d85c31a1178">xmax</a>, 0.0f, 1.0f);
<a name="l02807"></a>02807     <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(rect.<a class="code" href="../../da/d10/structrctf.html#ab8c08095a5b34878ced13a9b3026b74f">ymax</a>, 0.0f, 1.0f);
<a name="l02808"></a>02808 
<a name="l02809"></a>02809     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a996dee77afe7797ef9349731bf2342e7">ed</a>-&gt;<a class="code" href="../../d5/de9/structEditing.html#a8ebec20c4a1c359d00403883f57fb5ca">over_border</a> = rect;
<a name="l02810"></a>02810 
<a name="l02811"></a>02811     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l02812"></a>02812 
<a name="l02813"></a>02813     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02814"></a>02814 }
<a name="l02815"></a>02815 
<a name="l02816"></a>02816 <span class="comment">/* ****** Border Select ****** */</span>
<a name="l02817"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a982960af3ff6f79978e06076a6afff3b">02817</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa6d134a344f3c6afc4769d95125d4a89">SEQUENCER_OT_view_ghost_border</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02818"></a>02818 {
<a name="l02819"></a>02819     <span class="comment">/* identifiers */</span>
<a name="l02820"></a>02820     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Border Offset View&quot;</span>;
<a name="l02821"></a>02821     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_view_ghost_border&quot;</span>;
<a name="l02822"></a>02822     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Enable border select mode&quot;</span>;
<a name="l02823"></a>02823 
<a name="l02824"></a>02824     <span class="comment">/* api callbacks */</span>
<a name="l02825"></a>02825     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a8d45022b7baa1add659b6798c15601b1">WM_border_select_invoke</a>;
<a name="l02826"></a>02826     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#af3abb9340ce181d283d8b5f8961ffde3">view_ghost_border_exec</a>;
<a name="l02827"></a>02827     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#ab6bb53ebc07c5ca59c0a1a687124de2b">WM_border_select_modal</a>;
<a name="l02828"></a>02828     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a6d3605795c2b5e972ab68160903d8839">sequencer_view_poll</a>;
<a name="l02829"></a>02829     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a30c4cae4bcb919d6519d9a1b5b77cdb0">WM_border_select_cancel</a>;
<a name="l02830"></a>02830 
<a name="l02831"></a>02831     <span class="comment">/* flags */</span>
<a name="l02832"></a>02832     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l02833"></a>02833 
<a name="l02834"></a>02834     <span class="comment">/* rna */</span>
<a name="l02835"></a>02835     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7df9a6eccb78facfa397098a5ad2bc4a">WM_operator_properties_gesture_border</a>(ot, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02836"></a>02836 }
<a name="l02837"></a>02837 
<a name="l02838"></a>02838 <span class="comment">/* rebuild_proxy operator */</span>
<a name="l02839"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa1d15f56a8bd893d6e58227b441e943d">02839</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa1d15f56a8bd893d6e58227b441e943d">sequencer_rebuild_proxy_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02840"></a>02840 {
<a name="l02841"></a>02841     <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a9570344a5cf8ecc6b880381e0a40002a">seq_proxy_build_job</a>(C);
<a name="l02842"></a>02842 
<a name="l02843"></a>02843     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02844"></a>02844 }
<a name="l02845"></a>02845 
<a name="l02846"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ad8cbce3cd6392133a23e6177aa3e4b07">02846</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a3bda01a329f0626a0ea9cece3fad0ec3">SEQUENCER_OT_rebuild_proxy</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02847"></a>02847 {
<a name="l02848"></a>02848     <span class="comment">/* identifiers */</span>
<a name="l02849"></a>02849     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Rebuild Proxy and Timecode Indices&quot;</span>;
<a name="l02850"></a>02850     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_rebuild_proxy&quot;</span>;
<a name="l02851"></a>02851     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Rebuild all selected proxies and timecode indeces using the job system&quot;</span>;
<a name="l02852"></a>02852     
<a name="l02853"></a>02853     <span class="comment">/* api callbacks */</span>
<a name="l02854"></a>02854     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa1d15f56a8bd893d6e58227b441e943d">sequencer_rebuild_proxy_exec</a>;
<a name="l02855"></a>02855     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>;
<a name="l02856"></a>02856     
<a name="l02857"></a>02857     <span class="comment">/* flags */</span>
<a name="l02858"></a>02858     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>;
<a name="l02859"></a>02859 }
<a name="l02860"></a>02860 
<a name="l02861"></a>02861 <span class="comment">/* change ops */</span>
<a name="l02862"></a>02862 
<a name="l02863"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a67d0d85ea9acc247dbb7f280c4635f22">02863</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a67d0d85ea9acc247dbb7f280c4635f22">prop_change_effect_input_types</a>[] = {
<a name="l02864"></a>02864     {0, <span class="stringliteral">&quot;A_B&quot;</span>, 0, <span class="stringliteral">&quot;A -&gt; B&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02865"></a>02865     {1, <span class="stringliteral">&quot;B_C&quot;</span>, 0, <span class="stringliteral">&quot;B -&gt; C&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02866"></a>02866     {2, <span class="stringliteral">&quot;A_C&quot;</span>, 0, <span class="stringliteral">&quot;A -&gt; C&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l02867"></a>02867     {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}
<a name="l02868"></a>02868 };
<a name="l02869"></a>02869 
<a name="l02870"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad521d25376712e31a7fbd8f51fd760d1">02870</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad521d25376712e31a7fbd8f51fd760d1">sequencer_change_effect_input_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02871"></a>02871 {
<a name="l02872"></a>02872     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02873"></a>02873     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02874"></a>02874     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l02875"></a>02875 
<a name="l02876"></a>02876     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> **seq_1, **seq_2;
<a name="l02877"></a>02877 
<a name="l02878"></a>02878     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;swap&quot;</span>)) {
<a name="l02879"></a>02879         <span class="keywordflow">case</span> 0:
<a name="l02880"></a>02880             seq_1 = &amp;seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a>;
<a name="l02881"></a>02881             seq_2 = &amp;seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a>;
<a name="l02882"></a>02882             <span class="keywordflow">break</span>;
<a name="l02883"></a>02883         <span class="keywordflow">case</span> 1:
<a name="l02884"></a>02884             seq_1 = &amp;seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#acf49b2f41e3b26a1eaaafcdeb075e41d">seq2</a>;
<a name="l02885"></a>02885             seq_2 = &amp;seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>;
<a name="l02886"></a>02886             <span class="keywordflow">break</span>;
<a name="l02887"></a>02887         <span class="keywordflow">default</span>: <span class="comment">/* 2 */</span>
<a name="l02888"></a>02888             seq_1 = &amp;seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#ab7595a789e425d70fba09325dc85404d">seq1</a>;
<a name="l02889"></a>02889             seq_2 = &amp;seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a3bddc2c587641a96b5f753443ccd97f3">seq3</a>;
<a name="l02890"></a>02890             <span class="keywordflow">break</span>;
<a name="l02891"></a>02891     }
<a name="l02892"></a>02892 
<a name="l02893"></a>02893     <span class="keywordflow">if</span> (*seq_1 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || *seq_2 == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l02894"></a>02894         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;One of the effect inputs is unset, can&#39;t swap&quot;</span>);
<a name="l02895"></a>02895         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02896"></a>02896     }
<a name="l02897"></a>02897     <span class="keywordflow">else</span> {
<a name="l02898"></a>02898         <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a5fe0952e66cbb7dbad512a6fcc91b1b3">SWAP</a>(<a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *, *seq_1, *seq_2);
<a name="l02899"></a>02899     }
<a name="l02900"></a>02900 
<a name="l02901"></a>02901     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a593b927f446765f9b1b83c513a86856c">update_changed_seq_and_deps</a>(scene, seq, 0, 1);
<a name="l02902"></a>02902 
<a name="l02903"></a>02903     <span class="comment">/* important else we don&#39;t get the imbuf cache flushed */</span>
<a name="l02904"></a>02904     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a4dee98589098f19747a1caaecf7c0b9c">free_imbuf_seq</a>(scene, &amp;ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02905"></a>02905 
<a name="l02906"></a>02906     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l02907"></a>02907 
<a name="l02908"></a>02908     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02909"></a>02909 }
<a name="l02910"></a>02910 
<a name="l02911"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#acce4c0c6689d0049e62c4f49980a50dc">02911</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acce4c0c6689d0049e62c4f49980a50dc">SEQUENCER_OT_change_effect_input</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02912"></a>02912 {
<a name="l02913"></a>02913     <span class="comment">/* identifiers */</span>
<a name="l02914"></a>02914     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Change Effect Input&quot;</span>;
<a name="l02915"></a>02915     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_change_effect_input&quot;</span>;
<a name="l02916"></a>02916     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l02917"></a>02917 
<a name="l02918"></a>02918     <span class="comment">/* api callbacks */</span>
<a name="l02919"></a>02919     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad521d25376712e31a7fbd8f51fd760d1">sequencer_change_effect_input_exec</a>;
<a name="l02920"></a>02920     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd537c83115c645841b9cdf43255ae87">sequencer_effect_poll</a>;
<a name="l02921"></a>02921 
<a name="l02922"></a>02922     <span class="comment">/* flags */</span>
<a name="l02923"></a>02923     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02924"></a>02924 
<a name="l02925"></a>02925     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;swap&quot;</span>, prop_change_effect_input_types, 0, <span class="stringliteral">&quot;Swap&quot;</span>, <span class="stringliteral">&quot;The effect inputs to swap&quot;</span>);
<a name="l02926"></a>02926 }
<a name="l02927"></a>02927 
<a name="l02928"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#a9565d3ea710cda388fd8f762dc505e85">02928</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a9565d3ea710cda388fd8f762dc505e85">sequencer_change_effect_type_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02929"></a>02929 {
<a name="l02930"></a>02930     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02931"></a>02931     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02932"></a>02932     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l02933"></a>02933     <span class="keyword">const</span> <span class="keywordtype">int</span> new_type = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l02934"></a>02934 
<a name="l02935"></a>02935     <span class="comment">/* free previous effect and init new effect */</span>
<a name="l02936"></a>02936     <span class="keyword">struct </span><a class="code" href="../../d5/d8e/structSeqEffectHandle.html">SeqEffectHandle</a> sh;
<a name="l02937"></a>02937 
<a name="l02938"></a>02938     <span class="keywordflow">if</span> ((seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> &amp; <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#a4af5720a811adce10514f7495b880734">SEQ_EFFECT</a>) == 0) {
<a name="l02939"></a>02939         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02940"></a>02940     }
<a name="l02941"></a>02941 
<a name="l02942"></a>02942     <span class="comment">/* can someone explain the logic behind only allowing to increase this,</span>
<a name="l02943"></a>02943 <span class="comment">     * copied from 2.4x - campbell */</span>
<a name="l02944"></a>02944     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a47b9509a75eefacd18b6511957497821">get_sequence_effect_num_inputs</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a>) &lt;
<a name="l02945"></a>02945         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a47b9509a75eefacd18b6511957497821">get_sequence_effect_num_inputs</a>(new_type))
<a name="l02946"></a>02946     {
<a name="l02947"></a>02947         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;New effect needs more input strips&quot;</span>);
<a name="l02948"></a>02948         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02949"></a>02949     }
<a name="l02950"></a>02950     <span class="keywordflow">else</span> {
<a name="l02951"></a>02951         sh = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a619b9587c8fc27bb04b8058b950a6ff4">get_sequence_effect</a>(seq);
<a name="l02952"></a>02952         sh.<a class="code" href="../../d5/d8e/structSeqEffectHandle.html#acf63e37b5acf8f298dac6a747e59e5f9">free</a>(seq);
<a name="l02953"></a>02953 
<a name="l02954"></a>02954         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> = new_type;
<a name="l02955"></a>02955 
<a name="l02956"></a>02956         sh = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a619b9587c8fc27bb04b8058b950a6ff4">get_sequence_effect</a>(seq);
<a name="l02957"></a>02957         sh.<a class="code" href="../../d5/d8e/structSeqEffectHandle.html#a5442413ecba118cb56c5cdccf02303af">init</a>(seq);
<a name="l02958"></a>02958     }
<a name="l02959"></a>02959 
<a name="l02960"></a>02960     <span class="comment">/* update */</span>
<a name="l02961"></a>02961     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a593b927f446765f9b1b83c513a86856c">update_changed_seq_and_deps</a>(scene, seq, 0, 1);
<a name="l02962"></a>02962 
<a name="l02963"></a>02963     <span class="comment">/* important else we don&#39;t get the imbuf cache flushed */</span>
<a name="l02964"></a>02964     <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a4dee98589098f19747a1caaecf7c0b9c">free_imbuf_seq</a>(scene, &amp;ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02965"></a>02965 
<a name="l02966"></a>02966     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l02967"></a>02967 
<a name="l02968"></a>02968     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02969"></a>02969 }
<a name="l02970"></a>02970 
<a name="l02971"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#a8cb2633141b507f6576811eab12e8a59">02971</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a8cb2633141b507f6576811eab12e8a59">SEQUENCER_OT_change_effect_type</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02972"></a>02972 {
<a name="l02973"></a>02973     <span class="comment">/* identifiers */</span>
<a name="l02974"></a>02974     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Change Effect Type&quot;</span>;
<a name="l02975"></a>02975     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_change_effect_type&quot;</span>;
<a name="l02976"></a>02976     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l02977"></a>02977 
<a name="l02978"></a>02978     <span class="comment">/* api callbacks */</span>
<a name="l02979"></a>02979     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a9565d3ea710cda388fd8f762dc505e85">sequencer_change_effect_type_exec</a>;
<a name="l02980"></a>02980     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#acd537c83115c645841b9cdf43255ae87">sequencer_effect_poll</a>;
<a name="l02981"></a>02981 
<a name="l02982"></a>02982     <span class="comment">/* flags */</span>
<a name="l02983"></a>02983     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l02984"></a>02984 
<a name="l02985"></a>02985     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, sequencer_prop_effect_types, <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ae38fc4065fd82d15b5cd46c3526691aa">SEQ_CROSS</a>, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Sequencer effect type&quot;</span>);
<a name="l02986"></a>02986 }
<a name="l02987"></a>02987 
<a name="l02988"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac374e5958a38aa4cc654fca12ce4f741">02988</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac374e5958a38aa4cc654fca12ce4f741">sequencer_change_path_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02989"></a>02989 {
<a name="l02990"></a>02990     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain = <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l02991"></a>02991     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02992"></a>02992     <a class="code" href="../../d5/de9/structEditing.html">Editing</a> *ed = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#af27ede5fdfee51a163366fd358a03e14">seq_give_editing</a>(scene, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02993"></a>02993     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l02994"></a>02994     <span class="keyword">const</span> <span class="keywordtype">int</span> is_relative_path = <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;relative_path&quot;</span>);
<a name="l02995"></a>02995 
<a name="l02996"></a>02996     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ac06b183625bca249c8c0d1168f907aeb">SEQ_IMAGE</a>) {
<a name="l02997"></a>02997         <span class="keywordtype">char</span> directory[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l02998"></a>02998         <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d90/util__math_8h.html#aa4232e576aca913870e7753393b82894">len</a> = <a class="code" href="../../d3/d10/rna__access_8c.html#afa268ad0fdaa32bbbf52be74426bfbd6">RNA_property_collection_length</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;files&quot;</span>));
<a name="l02999"></a>02999         <a class="code" href="../../d0/d38/structStripElem.html">StripElem</a> *se;
<a name="l03000"></a>03000 
<a name="l03001"></a>03001         <span class="keywordflow">if</span> (len == 0)
<a name="l03002"></a>03002             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03003"></a>03003 
<a name="l03004"></a>03004         <a class="code" href="../../d3/d10/rna__access_8c.html#a810e909d61281bbb2d9fe99f9f2219ab">RNA_string_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;directory&quot;</span>, directory);
<a name="l03005"></a>03005         <span class="keywordflow">if</span> (is_relative_path) {
<a name="l03006"></a>03006             <span class="comment">/* TODO, shouldn&#39;t this already be relative from the filesel?</span>
<a name="l03007"></a>03007 <span class="comment">             * (as the &#39;filepath&#39; is) for now just make relative here,</span>
<a name="l03008"></a>03008 <span class="comment">             * but look into changing after 2.60 - campbell */</span>
<a name="l03009"></a>03009             <a class="code" href="../../d2/dd9/BLI__path__util_8h.html#a885e6044163b103a6c8e811d17286bb6">BLI_path_rel</a>(directory, bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a8cf7ece1c27b22c05a1198b28d42ebdf">name</a>);
<a name="l03010"></a>03010         }
<a name="l03011"></a>03011         <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>, directory, <span class="keyword">sizeof</span>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>));
<a name="l03012"></a>03012 
<a name="l03013"></a>03013         <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a5f5ecc8c7ffc8375e8a43b2500738889">stripdata</a>) {
<a name="l03014"></a>03014             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a5f5ecc8c7ffc8375e8a43b2500738889">stripdata</a>);
<a name="l03015"></a>03015         }
<a name="l03016"></a>03016         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a5f5ecc8c7ffc8375e8a43b2500738889">stripdata</a> = se = <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(len * <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d38/structStripElem.html">StripElem</a>), <span class="stringliteral">&quot;stripelem&quot;</span>);
<a name="l03017"></a>03017 
<a name="l03018"></a>03018         <a class="code" href="../../de/ddf/RNA__access_8h.html#a0310a34930fc9ac8d15a39c38d3dd429">RNA_BEGIN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, itemptr, <span class="stringliteral">&quot;files&quot;</span>) {
<a name="l03019"></a>03019             <span class="keywordtype">char</span> *filename = <a class="code" href="../../d3/d10/rna__access_8c.html#afeb202c69e280217f90b9504ad559876">RNA_string_get_alloc</a>(&amp;itemptr, <span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);
<a name="l03020"></a>03020             <a class="code" href="../../d3/db3/BLI__string_8h.html#a98d7c9cb4a81dbe506d1972b306300ce">BLI_strncpy</a>(se-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a68eca881ea502f351f9a21fcdc99955d">name</a>, filename, <span class="keyword">sizeof</span>(se-&gt;<a class="code" href="../../d0/d38/structStripElem.html#a68eca881ea502f351f9a21fcdc99955d">name</a>));
<a name="l03021"></a>03021             <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(filename);
<a name="l03022"></a>03022             se++;
<a name="l03023"></a>03023         }
<a name="l03024"></a>03024         <a class="code" href="../../de/ddf/RNA__access_8h.html#a245d0341a908eab74fc30b93cf24a74d">RNA_END</a>;
<a name="l03025"></a>03025 
<a name="l03026"></a>03026         <span class="comment">/* reset these else we wont see all the images */</span>
<a name="l03027"></a>03027         seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a9e0dd64523ebced8c7a0ef6113bb8d5f">anim_startofs</a> = seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#aebea1cccf598ab41fcaeacf700cd887a">anim_endofs</a> = 0;
<a name="l03028"></a>03028 
<a name="l03029"></a>03029         <span class="comment">/* correct start/end frames so we don&#39;t move</span>
<a name="l03030"></a>03030 <span class="comment">         * important not to set seq-&gt;len= len; allow the function to handle it */</span>
<a name="l03031"></a>03031         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a104ada50dedffcd571655161b01e695a">reload_sequence_new_file</a>(scene, seq, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03032"></a>03032 
<a name="l03033"></a>03033         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a40cabafd685ace5636d8add73bffd1bc">calc_sequence</a>(scene, seq);
<a name="l03034"></a>03034 
<a name="l03035"></a>03035         <span class="comment">/* important else we don&#39;t get the imbuf cache flushed */</span>
<a name="l03036"></a>03036         <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a4dee98589098f19747a1caaecf7c0b9c">free_imbuf_seq</a>(scene, &amp;ed-&gt;<a class="code" href="../../d5/de9/structEditing.html#a0395eb82d0ea9133b88e856ac3004a21">seqbase</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03037"></a>03037     }
<a name="l03038"></a>03038     <span class="keywordflow">else</span> {
<a name="l03039"></a>03039         <span class="comment">/* lame, set rna filepath */</span>
<a name="l03040"></a>03040         <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> seq_ptr;
<a name="l03041"></a>03041         <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l03042"></a>03042         <span class="keywordtype">char</span> filepath[<a class="code" href="../../d3/dde/BKE__utildefines_8h.html#a4d71bd743114c866e342b82481760d80">FILE_MAX</a>];
<a name="l03043"></a>03043 
<a name="l03044"></a>03044         <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>(&amp;scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#adcaccec888ecc6bda37aab635f75c61b">RNA_Sequence</a>, seq, &amp;seq_ptr);
<a name="l03045"></a>03045 
<a name="l03046"></a>03046         <a class="code" href="../../d3/d10/rna__access_8c.html#a810e909d61281bbb2d9fe99f9f2219ab">RNA_string_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filepath&quot;</span>, filepath);
<a name="l03047"></a>03047         prop = <a class="code" href="../../d3/d10/rna__access_8c.html#a58253ea33cfb6f09202907a524090aab">RNA_struct_find_property</a>(&amp;seq_ptr, <span class="stringliteral">&quot;filepath&quot;</span>);
<a name="l03048"></a>03048         <a class="code" href="../../d3/d10/rna__access_8c.html#afce4fb987ac5a876e33a51d1b5cc2d6a">RNA_property_string_set</a>(&amp;seq_ptr, prop, filepath);
<a name="l03049"></a>03049         <a class="code" href="../../d3/d10/rna__access_8c.html#a5fa7d69c3a73312275e1e6d20baf3bc6">RNA_property_update</a>(C, &amp;seq_ptr, prop);
<a name="l03050"></a>03050     }
<a name="l03051"></a>03051 
<a name="l03052"></a>03052     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a008505fc0cf87d3aed5472593449c793">ND_SEQUENCER</a>, scene);
<a name="l03053"></a>03053 
<a name="l03054"></a>03054     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03055"></a>03055 }
<a name="l03056"></a>03056 
<a name="l03057"></a><a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa35b296301665bac1a7081401b722450">03057</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa35b296301665bac1a7081401b722450">sequencer_change_path_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l03058"></a>03058 {
<a name="l03059"></a>03059     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03060"></a>03060     <a class="code" href="../../dd/d1a/structSequence.html">Sequence</a> *seq = <a class="code" href="../../d8/d5f/BKE__sequencer_8h.html#a7337a67d9bac57c38d02c046e4902a1d">seq_active_get</a>(scene);
<a name="l03061"></a>03061 
<a name="l03062"></a>03062     <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;directory&quot;</span>, seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#affbe3a1670437b9c5a70b45bcde77922">strip</a>-&gt;<a class="code" href="../../de/d68/structStrip.html#a8875219904331387919a2a290cde7d78">dir</a>);
<a name="l03063"></a>03063 
<a name="l03064"></a>03064     <span class="comment">/* set default display depending on seq type */</span>
<a name="l03065"></a>03065     <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="../../dd/d1a/structSequence.html#a748f95b8453aa6af7b77a60532c474ae">type</a> == <a class="code" href="../../d7/da9/DNA__sequence__types_8h.html#ac06b183625bca249c8c0d1168f907aeb">SEQ_IMAGE</a>) {
<a name="l03066"></a>03066         <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filter_movie&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03067"></a>03067     }
<a name="l03068"></a>03068     <span class="keywordflow">else</span> {
<a name="l03069"></a>03069         <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;filter_image&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03070"></a>03070     }
<a name="l03071"></a>03071 
<a name="l03072"></a>03072     <a class="code" href="../../df/db0/wm__event__system_8c.html#a2e41929a4b0d2175609f19e7a3626a42">WM_event_add_fileselect</a>(C, op);
<a name="l03073"></a>03073 
<a name="l03074"></a>03074     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l03075"></a>03075 }
<a name="l03076"></a>03076 
<a name="l03077"></a><a class="code" href="../../db/d4a/sequencer__intern_8h.html#ad1f4737696feb04cb1e4b9b0f4868556">03077</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ad1f4737696feb04cb1e4b9b0f4868556">SEQUENCER_OT_change_path</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03078"></a>03078 {
<a name="l03079"></a>03079     <span class="comment">/* identifiers */</span>
<a name="l03080"></a>03080     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Change Data/Files&quot;</span>;
<a name="l03081"></a>03081     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SEQUENCER_OT_change_path&quot;</span>;
<a name="l03082"></a>03082     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l03083"></a>03083 
<a name="l03084"></a>03084     <span class="comment">/* api callbacks */</span>
<a name="l03085"></a>03085     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#ac374e5958a38aa4cc654fca12ce4f741">sequencer_change_path_exec</a>;
<a name="l03086"></a>03086     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#aa35b296301665bac1a7081401b722450">sequencer_change_path_invoke</a>;
<a name="l03087"></a>03087     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d0/d97/sequencer__edit_8c.html#a1eb2756dbeaa62fee9df3e93e43f8840">sequencer_strip_has_path_poll</a>;
<a name="l03088"></a>03088 
<a name="l03089"></a>03089     <span class="comment">/* flags */</span>
<a name="l03090"></a>03090     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a> | <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03091"></a>03091 
<a name="l03092"></a>03092     <a class="code" href="../../d6/dae/wm__operators_8c.html#a5fa435f05172819dfaae1f6acf79bab8">WM_operator_properties_filesel</a>(ot, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#aaac3f2bc8c44aafb973f3b1cf5b1c9b1">FOLDERFILE</a> | <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#aa1c7480dc3bd39628bc5c3531e2a4d1f">IMAGEFILE</a> | <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a3081c1c0f7825de961687ac50208e980">MOVIEFILE</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#ada7c3cc863dd57483b348dcdf9569b4c">FILE_SPECIAL</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a95da76b164841451e8aef4b21d3f38a2">FILE_OPENFILE</a>, <a class="code" href="../../d4/d7f/WM__api_8h.html#a1afd00b565d1c20abf84cf3945d268c2">WM_FILESEL_DIRECTORY</a> | <a class="code" href="../../d4/d7f/WM__api_8h.html#a37e372cb74a17fb7d0c39d96f0c1ea52">WM_FILESEL_RELPATH</a> | <a class="code" href="../../d4/d7f/WM__api_8h.html#a615ddace8bd4db6f6afb8e59f5366d97">WM_FILESEL_FILEPATH</a> | <a class="code" href="../../d4/d7f/WM__api_8h.html#acb363e6b70d39fca17a20ba27874a13f">WM_FILESEL_FILES</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a21d31fc4a7d23f7ebc977203f7e63571ac853e68e87258d362a5539682d68af18">FILE_DEFAULTDISPLAY</a>);
<a name="l03093"></a>03093 }
<a name="l03094"></a>03094 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:54 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
