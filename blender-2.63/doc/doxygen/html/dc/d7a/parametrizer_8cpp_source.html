<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: parametrizer.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">parametrizer.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../dc/d7a/parametrizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00004"></a>00004 <span class="comment">/******************************************************************************</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * El&#39;Beem - Free Surface Fluid Simulation with the Lattice Boltzmann Method</span>
<a name="l00007"></a>00007 <span class="comment"> * Copyright 2003-2006 Nils Thuerey</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * Parameter calculator for the LBM Solver class</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *****************************************************************************/</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d94/parametrizer_8h.html">parametrizer.h</a>&quot;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">// debug output flag, has to be off for win32 for some reason...</span>
<a name="l00017"></a><a class="code" href="../../dc/d7a/parametrizer_8cpp.html#a6a553403e866434f1e89e1bf1714ffff">00017</a> <span class="preprocessor">#define DEBUG_PARAMCHANNELS 0</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00020"></a><a class="code" href="../../dc/d7a/parametrizer_8cpp.html#a6015c422abaa6562823735748662f532">00020</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d7a/parametrizer_8cpp.html#a6015c422abaa6562823735748662f532">ParamStrings</a>[] = {
<a name="l00021"></a>00021     <span class="stringliteral">&quot;RelaxTime&quot;</span>,
<a name="l00022"></a>00022     <span class="stringliteral">&quot;Reynolds&quot;</span>,
<a name="l00023"></a>00023     <span class="stringliteral">&quot;Viscosity&quot;</span>,
<a name="l00024"></a>00024     <span class="stringliteral">&quot;SoundSpeed&quot;</span>,
<a name="l00025"></a>00025     <span class="stringliteral">&quot;DomainSize&quot;</span>,
<a name="l00026"></a>00026     <span class="stringliteral">&quot;GravityForce&quot;</span>,
<a name="l00027"></a>00027     <span class="stringliteral">&quot;TimeLength&quot;</span>,
<a name="l00028"></a>00028     <span class="stringliteral">&quot;Timestep&quot;</span>,
<a name="l00029"></a>00029     <span class="stringliteral">&quot;Size&quot;</span>,
<a name="l00030"></a>00030     <span class="stringliteral">&quot;TimeFactor&quot;</span>,
<a name="l00031"></a>00031     <span class="stringliteral">&quot;AniFrames&quot;</span>,
<a name="l00032"></a>00032     <span class="stringliteral">&quot;AniFrameTime&quot;</span>,
<a name="l00033"></a>00033     <span class="stringliteral">&quot;AniStart&quot;</span>,
<a name="l00034"></a>00034     <span class="stringliteral">&quot;SurfaceTension&quot;</span>,
<a name="l00035"></a>00035     <span class="stringliteral">&quot;Density&quot;</span>,
<a name="l00036"></a>00036     <span class="stringliteral">&quot;CellSize&quot;</span>,
<a name="l00037"></a>00037     <span class="stringliteral">&quot;GStar&quot;</span>,
<a name="l00038"></a>00038     <span class="stringliteral">&quot;MaxSpeed&quot;</span>,
<a name="l00039"></a>00039     <span class="stringliteral">&quot;SimMaxSpeed&quot;</span>,
<a name="l00040"></a>00040     <span class="stringliteral">&quot;FluidVolHeight&quot;</span>,
<a name="l00041"></a>00041     <span class="stringliteral">&quot;NormalizedGStar&quot;</span>,
<a name="l00042"></a>00042     <span class="stringliteral">&quot;PSERR&quot;</span>, <span class="stringliteral">&quot;PSERR&quot;</span>, <span class="stringliteral">&quot;PSERR&quot;</span>, <span class="stringliteral">&quot;PSERR&quot;</span>
<a name="l00043"></a>00043 };
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="comment">/******************************************************************************</span>
<a name="l00048"></a>00048 <span class="comment"> * Default constructor</span>
<a name="l00049"></a>00049 <span class="comment"> *****************************************************************************/</span>
<a name="l00050"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a9beadf84b878bd4d426c1cbf95513d34">00050</a> <a class="code" href="../../d1/d7f/classParametrizer.html#a9beadf84b878bd4d426c1cbf95513d34">Parametrizer::Parametrizer</a>( <span class="keywordtype">void</span> ) :
<a name="l00051"></a>00051     mcViscosity( 8.94e-7 ), 
<a name="l00052"></a>00052     mSoundSpeed( 1500 ),
<a name="l00053"></a>00053     mDomainSize( 0.1 ), mCellSize( 0.01 ),
<a name="l00054"></a>00054     mcGravity( <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a>(0.0) ),
<a name="l00055"></a>00055     mTimestep(0.0001), mDesiredTimestep(-1.0),
<a name="l00056"></a>00056     mMaxTimestep(-1.0),
<a name="l00057"></a>00057     mMinTimestep(-1.0), 
<a name="l00058"></a>00058     mSizex(50), mSizey(50), mSizez(50),
<a name="l00059"></a>00059     mTimeFactor( 1.0 ),
<a name="l00060"></a>00060     mcAniFrameTime(0.0001),
<a name="l00061"></a>00061     mTimeStepScale(1.0),
<a name="l00062"></a>00062     mAniStart(0.0),
<a name="l00063"></a>00063     <span class="comment">//mExtent(1.0, 1.0, 1.0), //mSurfaceTension( 0.0 ),</span>
<a name="l00064"></a>00064     mDensity(1000.0), mGStar(0.0001), mFluidVolumeHeight(0.0),
<a name="l00065"></a>00065     mSimulationMaxSpeed(0.0),
<a name="l00066"></a>00066     mTadapMaxOmega(2.0), mTadapMaxSpeed(0.1), mTadapLevels(1),
<a name="l00067"></a>00067     mFrameNum(0),
<a name="l00068"></a>00068     mSeenValues( 0 ), mCalculatedValues( 0 )
<a name="l00069"></a>00069 {
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">/******************************************************************************</span>
<a name="l00074"></a>00074 <span class="comment"> * Destructor</span>
<a name="l00075"></a>00075 <span class="comment"> *****************************************************************************/</span>
<a name="l00076"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a1fccf527f5b5fc3d6a303368fb91f3d8">00076</a> <a class="code" href="../../d1/d7f/classParametrizer.html#a1fccf527f5b5fc3d6a303368fb91f3d8">Parametrizer::~Parametrizer</a>() 
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078     <span class="comment">/* not much to do... */</span>
<a name="l00079"></a>00079 }
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/******************************************************************************</span>
<a name="l00082"></a>00082 <span class="comment"> * Init from attr list</span>
<a name="l00083"></a>00083 <span class="comment"> *****************************************************************************/</span>
<a name="l00084"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a2d89e0b7af73394f266040046e13064a">00084</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#a2d89e0b7af73394f266040046e13064a">Parametrizer::parseAttrList</a>() 
<a name="l00085"></a>00085 {
<a name="l00086"></a>00086     <span class="keywordflow">if</span>(!mpAttrs) {
<a name="l00087"></a>00087         <a class="code" href="../../de/df0/utilities_8h.html#abbf67626aa468b4301520b9f6f292e1c">errFatal</a>(<span class="stringliteral">&quot;Parametrizer::parseAttrList&quot;</span>, <span class="stringliteral">&quot;mpAttrs pointer not initialized!&quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#a74894721e682bda2c22d5dacda988cad">SIMWORLD_INITERROR</a>);
<a name="l00088"></a>00088         <span class="keywordflow">return</span>;
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091     <span class="comment">// unused</span>
<a name="l00092"></a>00092     <span class="keywordtype">string</span>  mSetupType = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00093"></a>00093     mSetupType = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#a3ca411f70b712bec3d4dd4e81229e2cb">readString</a>(<span class="stringliteral">&quot;p_setup&quot;</span>,mSetupType, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mSetupType&quot;</span>, <span class="keyword">false</span>); 
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     <span class="comment">// real params</span>
<a name="l00096"></a>00096     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_viscosity&quot;</span>)) {
<a name="l00097"></a>00097             mcViscosity = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#a9293c76290503528601a743ce6689fbf">readChannelFloat</a>(<span class="stringliteral">&quot;p_viscosity&quot;</span>); <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#aa42c7b42faba8b00b536e20282c86f5b">PARAM_VISCOSITY</a> ); }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     mSoundSpeed = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_soundspeed&quot;</span>,mSoundSpeed, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mSoundSpeed&quot;</span>, <span class="keyword">false</span>); 
<a name="l00100"></a>00100     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_soundspeed&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a1ebb9d03420acd07c43e5bddd3b54686">PARAM_SOUNDSPEED</a> );
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     mDomainSize = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_domainsize&quot;</span>,mDomainSize, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mDomainSize&quot;</span>, <span class="keyword">false</span>); 
<a name="l00103"></a>00103     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_domainsize&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#ae943e93827f1354231425912610c02b4">PARAM_DOMAINSIZE</a> );
<a name="l00104"></a>00104     <span class="keywordflow">if</span>(mDomainSize&lt;=0.0) {
<a name="l00105"></a>00105         <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::parseAttrList&quot;</span>,<span class="stringliteral">&quot;Invalid real world domain size:&quot;</span>&lt;&lt;mDomainSize&lt;&lt;<span class="stringliteral">&quot;, resetting to 0.1&quot;</span>);
<a name="l00106"></a>00106         mDomainSize = 0.1;
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_gravity&quot;</span>)) { <span class="comment">// || (!mcGravity.isInited()) ) {</span>
<a name="l00110"></a>00110         mcGravity = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#adc5feaa35e85f51a353f2bbba2fd5aad">readChannelVec3d</a>(<span class="stringliteral">&quot;p_gravity&quot;</span>); <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a30d6799298608162497ed5c7930dcac2">PARAM_GRAVITY</a> );
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     mTimestep = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_steptime&quot;</span>,mTimestep, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mTimestep&quot;</span>, <span class="keyword">false</span>); 
<a name="l00114"></a>00114     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_steptime&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a5d9a11b4dcbeb313732d34880c31bc6c">PARAM_STEPTIME</a> );
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     mTimeFactor = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_timefactor&quot;</span>,mTimeFactor, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mTimeFactor&quot;</span>, <span class="keyword">false</span>); 
<a name="l00117"></a>00117     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_timefactor&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#ad42d68a4efb2e307a3a71720c099d94e">PARAM_TIMEFACTOR</a> );
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_aniframetime&quot;</span>)) { <span class="comment">//|| (!mcAniFrameTime.isInited()) ) {</span>
<a name="l00120"></a>00120         mcAniFrameTime = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#a9293c76290503528601a743ce6689fbf">readChannelFloat</a>(<span class="stringliteral">&quot;p_aniframetime&quot;</span>);<a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#af4543e70188174f6aae2f7de3b470bec">PARAM_ANIFRAMETIME</a> ); 
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122     mTimeStepScale = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_timestepscale&quot;</span>,mTimeStepScale, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mTimeStepScale&quot;</span>, <span class="keyword">false</span>); 
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     mAniStart = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_anistart&quot;</span>,mAniStart, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mAniStart&quot;</span>, <span class="keyword">false</span>); 
<a name="l00125"></a>00125     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_anistart&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#adf1b860a15cdc3d87f73ac61412276aa">PARAM_ANISTART</a> );
<a name="l00126"></a>00126     <span class="keywordflow">if</span>(mAniStart&lt;0.0) {
<a name="l00127"></a>00127         <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::parseAttrList&quot;</span>,<span class="stringliteral">&quot;Invalid start time:&quot;</span>&lt;&lt;mAniStart&lt;&lt;<span class="stringliteral">&quot;, resetting to 0.0&quot;</span>);
<a name="l00128"></a>00128         mAniStart = 0.0;
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <span class="comment">//mSurfaceTension = mpAttrs-&gt;readFloat(&quot;p_surfacetension&quot;,mSurfaceTension, &quot;Parametrizer&quot;,&quot;mSurfaceTension&quot;, false); </span>
<a name="l00132"></a>00132     <span class="comment">//if(getAttributeList()-&gt;exists(&quot;p_surfacetension&quot;)) seenThis( PARAM_SURFACETENSION );</span>
<a name="l00133"></a>00133 
<a name="l00134"></a>00134     mDensity = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_density&quot;</span>,mDensity, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mDensity&quot;</span>, <span class="keyword">false</span>); 
<a name="l00135"></a>00135     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_density&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#ac18bf77a62da4d81bdcac81764b2376d">PARAM_DENSITY</a> );
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> cellSize = 0.0; <span class="comment">// unused, deprecated</span>
<a name="l00138"></a>00138     cellSize = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_cellsize&quot;</span>,cellSize, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;cellSize&quot;</span>, <span class="keyword">false</span>); 
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     mGStar = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_gstar&quot;</span>,mGStar, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mGStar&quot;</span>, <span class="keyword">false</span>); 
<a name="l00141"></a>00141     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_gstar&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a906b8cd98d45fddbc0481a4f32a36ff5">PARAM_GSTAR</a> );
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     mNormalizedGStar = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_normgstar&quot;</span>,mNormalizedGStar, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mNormalizedGStar&quot;</span>, <span class="keyword">false</span>); 
<a name="l00144"></a>00144     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#aa1a6f2b2c3ed137cb3447caf2a41fd1a">getAttributeList</a>()-&gt;exists(<span class="stringliteral">&quot;p_normgstar&quot;</span>)) <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a7fa623952ab728f07fe3b669f87cd12f">PARAM_NORMALIZEDGSTAR</a> );
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     mTadapMaxOmega = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_tadapmaxomega&quot;</span>,mTadapMaxOmega, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mTadapMaxOmega&quot;</span>, <span class="keyword">false</span>); 
<a name="l00147"></a>00147     mTadapMaxSpeed = mpAttrs-&gt;<a class="code" href="../../d3/d8d/classAttributeList.html#aa3665e9ece0f9433c0d0d83c9965a493">readFloat</a>(<span class="stringliteral">&quot;p_tadapmaxspeed&quot;</span>,mTadapMaxSpeed, <span class="stringliteral">&quot;Parametrizer&quot;</span>,<span class="stringliteral">&quot;mTadapMaxSpeed&quot;</span>, <span class="keyword">false</span>); 
<a name="l00148"></a>00148 }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 <span class="comment">/******************************************************************************</span>
<a name="l00151"></a>00151 <span class="comment"> *! advance to next render/output frame </span>
<a name="l00152"></a>00152 <span class="comment"> *****************************************************************************/</span>
<a name="l00153"></a><a class="code" href="../../d1/d7f/classParametrizer.html#af94fe286cc274336da311a2dde5c660b">00153</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#af94fe286cc274336da311a2dde5c660b">Parametrizer::setFrameNum</a>(<span class="keywordtype">int</span> frame) {
<a name="l00154"></a>00154     mFrameNum = frame;
<a name="l00155"></a>00155 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>    <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DEBUG_PARAMCHANNELS&quot;</span>,<span class="stringliteral">&quot;setFrameNum frame-num=&quot;</span>&lt;&lt;mFrameNum);
<a name="l00157"></a>00157 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span>}
<a name="l00160"></a>00160 <span class="comment">// also used by: mpParam-&gt;getCurrentAniFrameTime() , e.g. for velocity dump</span>
<a name="l00161"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a75babdb6b7ad7ec90a308d24b6063280">00161</a> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <a class="code" href="../../d1/d7f/classParametrizer.html#a75babdb6b7ad7ec90a308d24b6063280">Parametrizer::getAniFrameTime</a>( <span class="keywordtype">int</span> frame )   { 
<a name="l00162"></a>00162     <span class="keywordtype">double</span> frametime = (double)frame;
<a name="l00163"></a>00163     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> anift = mcAniFrameTime.<a class="code" href="../../d1/df5/classAnimChannel.html#a2f8b4626f4c6c5a87c4de4235313d8e2">get</a>(frametime);
<a name="l00164"></a>00164     <span class="keywordflow">if</span>(anift&lt;0.0) {
<a name="l00165"></a>00165         <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> resetv = 0.;
<a name="l00166"></a>00166         <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::setFrameNum&quot;</span>,<span class="stringliteral">&quot;Invalid frame time:&quot;</span>&lt;&lt;anift&lt;&lt;<span class="stringliteral">&quot; at frame &quot;</span>&lt;&lt;frame&lt;&lt;<span class="stringliteral">&quot;, resetting to &quot;</span>&lt;&lt;resetv);
<a name="l00167"></a>00167         anift = resetv; 
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span>    <span class="keywordflow">if</span>((0)|| (<a class="code" href="../../dc/d7a/parametrizer_8cpp.html#a6a553403e866434f1e89e1bf1714ffff">DEBUG_PARAMCHANNELS</a>)) <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DEBUG_PARAMCHANNELS&quot;</span>,<span class="stringliteral">&quot;getAniFrameTime frame=&quot;</span>&lt;&lt;frame&lt;&lt;<span class="stringliteral">&quot;, frametime=&quot;</span>&lt;&lt;anift&lt;&lt;<span class="stringliteral">&quot; &quot;</span>);
<a name="l00171"></a>00171 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>    <span class="keywordflow">return</span> anift; 
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">/******************************************************************************</span>
<a name="l00176"></a>00176 <span class="comment"> * scale a given speed vector in m/s to lattice values </span>
<a name="l00177"></a>00177 <span class="comment"> *****************************************************************************/</span>
<a name="l00178"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a679162b616a22c6a0198fbd91e693c41">00178</a> <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> <a class="code" href="../../d1/d7f/classParametrizer.html#a679162b616a22c6a0198fbd91e693c41">Parametrizer::calculateAddForce</a>(<a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> vec, <span class="keywordtype">string</span> <a class="code" href="../../dc/d71/GPG__ghost_8cpp.html#a65a9d8448d84b7dbb124d5186f855c61">usage</a>)
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180     <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> ret = vec * (mTimestep*mTimestep) /mCellSize;
<a name="l00181"></a>00181     <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateVector&quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>, <span class="stringliteral">&quot;scaled vector = &quot;</span>&lt;&lt;ret&lt;&lt;<span class="stringliteral">&quot; for &#39;&quot;</span>&lt;&lt;usage&lt;&lt;<span class="stringliteral">&quot;&#39;, org = &quot;</span>&lt;&lt;vec&lt;&lt;<span class="stringliteral">&quot; dt=&quot;</span>&lt;&lt;mTimestep ,10);
<a name="l00182"></a>00182     <span class="keywordflow">return</span> ret;
<a name="l00183"></a>00183 }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="comment">/******************************************************************************</span>
<a name="l00187"></a>00187 <span class="comment"> * calculate size of a single cell</span>
<a name="l00188"></a>00188 <span class="comment"> *****************************************************************************/</span>
<a name="l00189"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a7241bf69c8d77e20c53567e0cb7c5b8b">00189</a> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <a class="code" href="../../d1/d7f/classParametrizer.html#a7241bf69c8d77e20c53567e0cb7c5b8b">Parametrizer::calculateCellSize</a>(<span class="keywordtype">void</span>)
<a name="l00190"></a>00190 {
<a name="l00191"></a>00191     <span class="keywordtype">int</span> maxsize = mSizex; <span class="comment">// get max size</span>
<a name="l00192"></a>00192     <span class="keywordflow">if</span>(mSizey&gt;maxsize) maxsize = mSizey;
<a name="l00193"></a>00193     <span class="keywordflow">if</span>(mSizez&gt;maxsize) maxsize = mSizez;
<a name="l00194"></a>00194     maxsize = mSizez; <span class="comment">// take along gravity dir for now!</span>
<a name="l00195"></a>00195     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> cellSize = 1.0 / (<a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a>)maxsize;
<a name="l00196"></a>00196     <span class="keywordflow">return</span> cellSize;
<a name="l00197"></a>00197 }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="comment">/*****************************************************************************/</span>
<a name="l00201"></a>00201 <span class="comment">/* simple calulation functions */</span>
<a name="l00202"></a>00202 <span class="comment">/*****************************************************************************/</span>
<a name="l00203"></a>00203 
<a name="l00205"></a><a class="code" href="../../d1/d7f/classParametrizer.html#ad2da115601348e590176cee61a3178ee">00205</a> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <a class="code" href="../../d1/d7f/classParametrizer.html#ad2da115601348e590176cee61a3178ee">Parametrizer::calculateOmega</a>( <span class="keywordtype">double</span> time ) { 
<a name="l00206"></a>00206     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> viscStar = <a class="code" href="../../d1/d7f/classParametrizer.html#a2a45367e9164e03ea229e84bb6b17cd6">calculateLatticeViscosity</a>(time);
<a name="l00207"></a>00207     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> relaxTime = (6.0 * viscStar + 1) * 0.5;
<a name="l00208"></a>00208 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>    <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DEBUG_PARAMCHANNELS&quot;</span>,<span class="stringliteral">&quot;calculateOmega viscStar=&quot;</span>&lt;&lt;viscStar&lt;&lt;<span class="stringliteral">&quot; relaxtime=&quot;</span>&lt;&lt;relaxTime);
<a name="l00210"></a>00210 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00211"></a>00211 <span class="preprocessor"></span>    <span class="keywordflow">return</span> (1.0/relaxTime); 
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00215"></a><a class="code" href="../../d1/d7f/classParametrizer.html#ab7bb4a73d49cd7ad9e7a304f272ac7b6">00215</a> <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> <a class="code" href="../../d1/d7f/classParametrizer.html#ab7bb4a73d49cd7ad9e7a304f272ac7b6">Parametrizer::calculateGravity</a>( <span class="keywordtype">double</span> time ) { 
<a name="l00216"></a>00216     <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> grav = mcGravity.<a class="code" href="../../d1/df5/classAnimChannel.html#a2f8b4626f4c6c5a87c4de4235313d8e2">get</a>(time);
<a name="l00217"></a>00217     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> forceFactor = (mTimestep *mTimestep)/mCellSize;
<a name="l00218"></a>00218     <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> latticeGravity = grav * forceFactor;
<a name="l00219"></a>00219 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>    <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DEBUG_PARAMCHANNELS&quot;</span>,<span class="stringliteral">&quot;calculateGravity grav=&quot;</span>&lt;&lt;grav&lt;&lt;<span class="stringliteral">&quot; ff&quot;</span>&lt;&lt;forceFactor&lt;&lt;<span class="stringliteral">&quot; lattGrav=&quot;</span>&lt;&lt;latticeGravity);
<a name="l00221"></a>00221 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>    <span class="keywordflow">return</span> latticeGravity; 
<a name="l00223"></a>00223 }
<a name="l00224"></a>00224 
<a name="l00226"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a2a45367e9164e03ea229e84bb6b17cd6">00226</a> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <a class="code" href="../../d1/d7f/classParametrizer.html#a2a45367e9164e03ea229e84bb6b17cd6">Parametrizer::calculateLatticeViscosity</a>( <span class="keywordtype">double</span> time ) { 
<a name="l00227"></a>00227     <span class="comment">// check seen values</span>
<a name="l00228"></a>00228     <span class="keywordtype">int</span> reqValues = <a class="code" href="../../de/d94/parametrizer_8h.html#aa42c7b42faba8b00b536e20282c86f5b">PARAM_VISCOSITY</a> | <a class="code" href="../../de/d94/parametrizer_8h.html#a5d9a11b4dcbeb313732d34880c31bc6c">PARAM_STEPTIME</a>;
<a name="l00229"></a>00229     <span class="keywordflow">if</span>(!<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>( reqValues ) ){
<a name="l00230"></a>00230         <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::calculateLatticeViscosity&quot;</span>,<span class="stringliteral">&quot; Missing arguments!&quot;</span>);
<a name="l00231"></a>00231     }
<a name="l00232"></a>00232     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> viscStar = mcViscosity.<a class="code" href="../../d1/df5/classAnimChannel.html#a2f8b4626f4c6c5a87c4de4235313d8e2">get</a>(time) * mTimestep / (mCellSize*mCellSize);
<a name="l00233"></a>00233 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span>    <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DEBUG_PARAMCHANNELS&quot;</span>,<span class="stringliteral">&quot;calculateLatticeViscosity viscStar=&quot;</span>&lt;&lt;viscStar);
<a name="l00235"></a>00235 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00236"></a>00236 <span class="preprocessor"></span>    <span class="keywordflow">return</span> viscStar; 
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00240"></a><a class="code" href="../../d1/d7f/classParametrizer.html#aad2088ecf86c6805d2d3ec499eca8aea">00240</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d7f/classParametrizer.html#aad2088ecf86c6805d2d3ec499eca8aea">Parametrizer::calculateStepsForSecs</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> s ) { 
<a name="l00241"></a>00241     <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(s/mTimestep); 
<a name="l00242"></a>00242 }
<a name="l00243"></a>00243 
<a name="l00245"></a><a class="code" href="../../d1/d7f/classParametrizer.html#aeec3099791f7aafd4eec411eedb3369c">00245</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d7f/classParametrizer.html#aeec3099791f7aafd4eec411eedb3369c">Parametrizer::calculateAniStart</a>( <span class="keywordtype">void</span> )   { 
<a name="l00246"></a>00246     <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(mAniStart/mTimestep); 
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00250"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a27757e0bd7c948f550d76e3e64436256">00250</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d7f/classParametrizer.html#a27757e0bd7c948f550d76e3e64436256">Parametrizer::calculateAniStepsPerFrame</a>(<span class="keywordtype">int</span> frame)   { 
<a name="l00251"></a>00251     <span class="keywordflow">if</span>(!<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#af4543e70188174f6aae2f7de3b470bec">PARAM_ANIFRAMETIME</a>)) {
<a name="l00252"></a>00252         <a class="code" href="../../de/df0/utilities_8h.html#abbf67626aa468b4301520b9f6f292e1c">errFatal</a>(<span class="stringliteral">&quot;Parametrizer::calculateAniStepsPerFrame&quot;</span>, <span class="stringliteral">&quot;Missing ani frame time argument!&quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#a74894721e682bda2c22d5dacda988cad">SIMWORLD_INITERROR</a>);
<a name="l00253"></a>00253         <span class="keywordflow">return</span> 1;
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255     <span class="keywordtype">int</span> value = (int)(<a class="code" href="../../d1/d7f/classParametrizer.html#a75babdb6b7ad7ec90a308d24b6063280">getAniFrameTime</a>(frame)/mTimestep); 
<a name="l00256"></a>00256     <span class="keywordflow">if</span>((value&lt;0) || (value&gt;1000000)) {
<a name="l00257"></a>00257         <a class="code" href="../../de/df0/utilities_8h.html#abbf67626aa468b4301520b9f6f292e1c">errFatal</a>(<span class="stringliteral">&quot;Parametrizer::calculateAniStepsPerFrame&quot;</span>, <span class="stringliteral">&quot;Invalid step-time (=&quot;</span>&lt;&lt;value&lt;&lt;<span class="stringliteral">&quot;) &lt;&gt; ani-frame-time (&quot;</span>&lt;&lt;mTimestep&lt;&lt;<span class="stringliteral">&quot;) settings, aborting...&quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#a74894721e682bda2c22d5dacda988cad">SIMWORLD_INITERROR</a>);
<a name="l00258"></a>00258         <span class="keywordflow">return</span> 1;
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260     <span class="keywordflow">return</span> value;
<a name="l00261"></a>00261 }
<a name="l00262"></a>00262 
<a name="l00264"></a><a class="code" href="../../d1/d7f/classParametrizer.html#acc02a2840f5a88d4a552fa27552d1e52">00264</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d7f/classParametrizer.html#acc02a2840f5a88d4a552fa27552d1e52">Parametrizer::calculateNoOfSteps</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> timelen ) { 
<a name="l00265"></a>00265     <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(timelen/mTimestep); 
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00269"></a>00269 <span class="comment">//ParamVec Parametrizer::calculateExtent( void ) { </span>
<a name="l00270"></a>00270     <span class="comment">//return mExtent; </span>
<a name="l00271"></a>00271 <span class="comment">//}</span>
<a name="l00272"></a>00272 
<a name="l00274"></a>00274 <span class="comment">//ParamFloat Parametrizer::calculateSurfaceTension( void ) { return mSurfaceTension; }</span>
<a name="l00275"></a>00275 
<a name="l00277"></a>00277 <span class="comment">// explicity scaled by time factor for refinement </span>
<a name="l00278"></a><a class="code" href="../../d1/d7f/classParametrizer.html#ad6481f27613af196314d262f662a5c61">00278</a> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <a class="code" href="../../d1/d7f/classParametrizer.html#ad6481f27613af196314d262f662a5c61">Parametrizer::getTimestep</a>( <span class="keywordtype">void</span> ) { 
<a name="l00279"></a>00279     <span class="keywordflow">return</span> mTimestep; 
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
<a name="l00283"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a6876e6f7f70128c9e931df8dffbf53da">00283</a> <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> <a class="code" href="../../d1/d7f/classParametrizer.html#a6876e6f7f70128c9e931df8dffbf53da">Parametrizer::calculateLattVelocityFromRw</a>( <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> ivel ) { 
<a name="l00284"></a>00284     <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> velvec = ivel;
<a name="l00285"></a>00285     velvec /= mCellSize;
<a name="l00286"></a>00286     velvec *= mTimestep;
<a name="l00287"></a>00287     <span class="keywordflow">return</span> velvec; 
<a name="l00288"></a>00288 }
<a name="l00290"></a><a class="code" href="../../d1/d7f/classParametrizer.html#ab7f6a9eaa886d2096c56403a0cae8b56">00290</a> <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> <a class="code" href="../../d1/d7f/classParametrizer.html#ab7f6a9eaa886d2096c56403a0cae8b56">Parametrizer::calculateRwVelocityFromLatt</a>( <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> ivel ) { 
<a name="l00291"></a>00291     <a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> velvec = ivel;
<a name="l00292"></a>00292     velvec *= mCellSize;
<a name="l00293"></a>00293     velvec /= mTimestep;
<a name="l00294"></a>00294     <span class="keywordflow">return</span> velvec; 
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 
<a name="l00299"></a><a class="code" href="../../d1/d7f/classParametrizer.html#ab5f00626630175d4909583d6c131c267">00299</a> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <a class="code" href="../../d1/d7f/classParametrizer.html#ab5f00626630175d4909583d6c131c267">Parametrizer::getCurrentGStar</a>( <span class="keywordtype">void</span> ) {
<a name="l00300"></a>00300     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> gStar = mGStar; <span class="comment">// check? TODO get from mNormalizedGStar?</span>
<a name="l00301"></a>00301     <span class="keywordflow">if</span>(mFluidVolumeHeight&gt;0.0) { gStar = mGStar/mFluidVolumeHeight; }
<a name="l00302"></a>00302     <span class="keywordflow">return</span> gStar;
<a name="l00303"></a>00303 }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305 <span class="comment">/******************************************************************************</span>
<a name="l00306"></a>00306 <span class="comment"> * function that tries to calculate all the missing values from the given ones</span>
<a name="l00307"></a>00307 <span class="comment"> * prints errors and returns false if thats not possible </span>
<a name="l00308"></a>00308 <span class="comment"> *****************************************************************************/</span>
<a name="l00309"></a><a class="code" href="../../d1/d7f/classParametrizer.html#ae56423aa4fc6327fdbbc79f1b0ea959f">00309</a> <span class="keywordtype">bool</span> <a class="code" href="../../d1/d7f/classParametrizer.html#ae56423aa4fc6327fdbbc79f1b0ea959f">Parametrizer::calculateAllMissingValues</a>( <span class="keywordtype">double</span> time, <span class="keywordtype">bool</span> silent )
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311     <span class="keywordtype">bool</span> <a class="code" href="../../dd/db3/node__composite__movieclip_8c.html#a9e3042c67b9ca0db42c98423ee8f4da9">init</a> = <span class="keyword">false</span>;  <span class="comment">// did we init correctly?</span>
<a name="l00312"></a>00312     <span class="keywordtype">int</span>  valuesChecked = 0;
<a name="l00313"></a>00313     <span class="keywordtype">int</span> reqValues;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315     <span class="comment">// we always need the sizes</span>
<a name="l00316"></a>00316     reqValues = <a class="code" href="../../de/d94/parametrizer_8h.html#a1dc6200b7756ec764f3ac70ba7ab49cf">PARAM_SIZE</a>;
<a name="l00317"></a>00317     valuesChecked |= reqValues;
<a name="l00318"></a>00318     <span class="keywordflow">if</span>(!<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(reqValues)) {
<a name="l00319"></a>00319         <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<span class="stringliteral">&quot; Missing size argument!&quot;</span>);
<a name="l00320"></a>00320         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="keywordflow">if</span>(!<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#ae943e93827f1354231425912610c02b4">PARAM_DOMAINSIZE</a>)) {
<a name="l00324"></a>00324         <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<span class="stringliteral">&quot; Missing domain size argument!&quot;</span>);
<a name="l00325"></a>00325         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327     <span class="keywordtype">int</span> maxsize = mSizex; <span class="comment">// get max size</span>
<a name="l00328"></a>00328     <span class="keywordflow">if</span>(mSizey&gt;maxsize) maxsize = mSizey;
<a name="l00329"></a>00329     <span class="keywordflow">if</span>(mSizez&gt;maxsize) maxsize = mSizez;
<a name="l00330"></a>00330     maxsize = mSizez; <span class="comment">// take along gravity dir for now!</span>
<a name="l00331"></a>00331     mCellSize = ( mDomainSize * <a class="code" href="../../d1/d7f/classParametrizer.html#a7241bf69c8d77e20c53567e0cb7c5b8b">calculateCellSize</a>() ); <span class="comment">// sets mCellSize</span>
<a name="l00332"></a>00332     <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; max domain resolution=&quot;</span>&lt;&lt;(maxsize)&lt;&lt;<span class="stringliteral">&quot; cells , cellsize=&quot;</span>&lt;&lt;mCellSize ,10);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334             
<a name="l00335"></a>00335     <span class="comment">/* Carolin init , see DA for details */</span>
<a name="l00336"></a>00336     <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> maxDeltaT = 0.0;
<a name="l00337"></a>00337 
<a name="l00338"></a>00338     <span class="comment">/* normalized gstar init */</span>
<a name="l00339"></a>00339     reqValues = <a class="code" href="../../de/d94/parametrizer_8h.html#a7fa623952ab728f07fe3b669f87cd12f">PARAM_NORMALIZEDGSTAR</a>;
<a name="l00340"></a>00340     valuesChecked |= reqValues;
<a name="l00341"></a>00341     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>( reqValues ) ){
<a name="l00342"></a>00342         <span class="comment">//if(checkSeenValues( PARAM_GSTAR ) ){ if(!silent) debMsgStd(&quot;Parametrizer::calculateAllMissingValues&quot;,DM_WARNING,&quot; g star value override by normalizedGStar!&quot;,1); }</span>
<a name="l00343"></a>00343         <span class="keyword">const</span> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> normgstarReset = 0.005;
<a name="l00344"></a>00344         <span class="keywordflow">if</span>(mNormalizedGStar&lt;=1e-6) {
<a name="l00345"></a>00345             <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<span class="stringliteral">&quot;Invalid NormGstar: &quot;</span>&lt;&lt;mNormalizedGStar&lt;&lt;<span class="stringliteral">&quot;... resetting to &quot;</span>&lt;&lt;normgstarReset);
<a name="l00346"></a>00346             mNormalizedGStar = normgstarReset;
<a name="l00347"></a>00347         }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         mGStar = mNormalizedGStar/maxsize;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="comment">// TODO FIXME add use testdata check!</span>
<a name="l00352"></a>00352 mGStar = mNormalizedGStar/mSizez;
<a name="l00353"></a>00353 <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Warning&quot;</span>,<span class="stringliteral">&quot;Used z-dir for gstar!&quot;</span>);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355         <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; g star set to &quot;</span>&lt;&lt;mGStar&lt;&lt;<span class="stringliteral">&quot; from normalizedGStar=&quot;</span>&lt;&lt;mNormalizedGStar ,1);
<a name="l00356"></a>00356         <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a906b8cd98d45fddbc0481a4f32a36ff5">PARAM_GSTAR</a>);
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     reqValues = <a class="code" href="../../de/d94/parametrizer_8h.html#a906b8cd98d45fddbc0481a4f32a36ff5">PARAM_GSTAR</a> | <a class="code" href="../../de/d94/parametrizer_8h.html#aa42c7b42faba8b00b536e20282c86f5b">PARAM_VISCOSITY</a>;
<a name="l00360"></a>00360     <span class="keywordflow">if</span>((<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a36dad51c2e398961eed628af78a40e02">PARAM_SURFACETENSION</a>))) reqValues |= <a class="code" href="../../de/d94/parametrizer_8h.html#ac18bf77a62da4d81bdcac81764b2376d">PARAM_DENSITY</a>; <span class="comment">// surface tension optional now...</span>
<a name="l00361"></a>00361     valuesChecked |= reqValues;
<a name="l00362"></a>00362     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>( reqValues ) ){
<a name="l00363"></a>00363         <span class="keyword">const</span> <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> gstarReset = 0.0005;
<a name="l00364"></a>00364         <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#ab5f00626630175d4909583d6c131c267">getCurrentGStar</a>()&lt;=1e-6) {
<a name="l00365"></a>00365             <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<span class="stringliteral">&quot;Invalid Gstar: &quot;</span>&lt;&lt;<a class="code" href="../../d1/d7f/classParametrizer.html#ab5f00626630175d4909583d6c131c267">getCurrentGStar</a>()&lt;&lt;<span class="stringliteral">&quot; (set to &quot;</span>&lt;&lt;mGStar&lt;&lt;<span class="stringliteral">&quot;) ... resetting to &quot;</span>&lt;&lt;gstarReset);
<a name="l00366"></a>00366             mGStar = gstarReset;
<a name="l00367"></a>00367         }
<a name="l00368"></a>00368 
<a name="l00369"></a>00369         <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> gStar = <a class="code" href="../../d1/d7f/classParametrizer.html#ab5f00626630175d4909583d6c131c267">getCurrentGStar</a>(); <span class="comment">// mGStar</span>
<a name="l00370"></a>00370         <span class="keywordflow">if</span>(mFluidVolumeHeight&gt;0.0) {
<a name="l00371"></a>00371             <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; height&quot;</span>&lt;&lt;mFluidVolumeHeight&lt;&lt;<span class="stringliteral">&quot; resGStar = &quot;</span>&lt;&lt;gStar, 10);
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373         <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; g star = &quot;</span>&lt;&lt;gStar, 10);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375         <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> forceStrength = 0.0;
<a name="l00376"></a>00376         <span class="comment">//if(checkSeenValues(PARAM_GRAVITY)) { forceStrength = norm( calculateGravity(time) ); }</span>
<a name="l00377"></a>00377         <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a30d6799298608162497ed5c7930dcac2">PARAM_GRAVITY</a>)) { forceStrength = <a class="code" href="../../d1/d8e/ntl__vector3dim_8h.html#a828f653994f3f04fe2a539bc1ed64590">norm</a>( mcGravity.<a class="code" href="../../d1/df5/classAnimChannel.html#a2f8b4626f4c6c5a87c4de4235313d8e2">get</a>(time) ); }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379         <span class="comment">// determine max. delta density per timestep trough gravity force</span>
<a name="l00380"></a>00380         <span class="keywordflow">if</span>(forceStrength&gt;0.0) {
<a name="l00381"></a>00381             maxDeltaT = <a class="code" href="../../d7/d47/NM__Scalar_8h.html#aa3fc8738e36a262f694814c04e8ef744">sqrt</a>( gStar*mCellSize *mTimeStepScale /forceStrength );
<a name="l00382"></a>00382         } <span class="keywordflow">else</span> {
<a name="l00383"></a>00383             <span class="comment">// use 1 lbm setp = 1 anim step as max</span>
<a name="l00384"></a>00384             maxDeltaT = <a class="code" href="../../d1/d7f/classParametrizer.html#a75babdb6b7ad7ec90a308d24b6063280">getAniFrameTime</a>(0);
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; targeted step time = &quot;</span>&lt;&lt;maxDeltaT, 10);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389         <span class="comment">//ParamFloat viscStarFac = mViscosity/(mCellSize*mCellSize);</span>
<a name="l00390"></a>00390         <span class="comment">//if(!silent) debMsgStd(&quot;Parametrizer::calculateAllMissingValues&quot;,DM_MSG,&quot; viscStarFac = &quot;&lt;&lt;viscStarFac&lt;&lt;&quot; viscosity:&quot;&lt;&lt;mViscosity, 10);</span>
<a name="l00391"></a>00391 
<a name="l00392"></a>00392         <span class="comment">// time step adaptivty, only for caro with max sim speed</span>
<a name="l00393"></a>00393         <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> setDeltaT = maxDeltaT;
<a name="l00394"></a>00394         <span class="keywordflow">if</span>(mDesiredTimestep&gt;0.0) {
<a name="l00395"></a>00395             <span class="comment">// explicitly set step time according to max velocity in sim</span>
<a name="l00396"></a>00396             setDeltaT = mDesiredTimestep;
<a name="l00397"></a>00397             <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; desired step time = &quot;</span>&lt;&lt;setDeltaT, 10);
<a name="l00398"></a>00398             mDesiredTimestep = -1.0;
<a name="l00399"></a>00399         } <span class="keywordflow">else</span> {
<a name="l00400"></a>00400             <span class="comment">// just use max delta t as current</span>
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402         
<a name="l00403"></a>00403         <span class="comment">// and once for init determine minimal delta t by omega max. </span>
<a name="l00404"></a>00404         <span class="keywordflow">if</span>((mMinTimestep&lt;0.0) || (mMaxTimestep&lt;0.0)) {
<a name="l00405"></a>00405             <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> minDeltaT; 
<a name="l00406"></a>00406             <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> maxOmega = mTadapMaxOmega;
<a name="l00407"></a>00407             <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> minRelaxTime = 1.0/maxOmega;
<a name="l00408"></a>00408             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> lev=1; lev&lt;mTadapLevels; lev++) {
<a name="l00409"></a>00409                 <span class="comment">// make minRelaxTime larger for each level that exists...</span>
<a name="l00410"></a>00410                 minRelaxTime = 2.0 * (minRelaxTime-0.5) + 0.5;
<a name="l00411"></a>00411             }
<a name="l00412"></a>00412             maxOmega = 1.0/minRelaxTime;
<a name="l00413"></a>00413             <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; maxOmega=&quot;</span>&lt;&lt;maxOmega&lt;&lt;<span class="stringliteral">&quot; minRelaxTime=&quot;</span>&lt;&lt;minRelaxTime&lt;&lt;<span class="stringliteral">&quot; levels=&quot;</span>&lt;&lt;mTadapLevels, 1);
<a name="l00414"></a>00414             <span class="comment">// visc-star for min relax time to calculate min delta ta</span>
<a name="l00415"></a>00415             <span class="keywordflow">if</span>(mcViscosity.<a class="code" href="../../d1/df5/classAnimChannel.html#a2f8b4626f4c6c5a87c4de4235313d8e2">get</a>(time)&gt;0.0) {
<a name="l00416"></a>00416                 minDeltaT = ((2.0*minRelaxTime-1.0)/6.0) * mCellSize * mCellSize / mcViscosity.<a class="code" href="../../d1/df5/classAnimChannel.html#a2f8b4626f4c6c5a87c4de4235313d8e2">get</a>(time);
<a name="l00417"></a>00417             } <span class="keywordflow">else</span> {
<a name="l00418"></a>00418                 <span class="comment">// visc=0, this is not physical, but might happen</span>
<a name="l00419"></a>00419                 minDeltaT = 0.0;
<a name="l00420"></a>00420             }
<a name="l00421"></a>00421             <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; min delta t = &quot;</span>&lt;&lt;minDeltaT&lt;&lt;<span class="stringliteral">&quot; , range = &quot;</span> &lt;&lt; (maxDeltaT/minDeltaT) ,1);
<a name="l00422"></a>00422 
<a name="l00423"></a>00423             <span class="comment">// sim speed + accel shouldnt exceed 0.1?</span>
<a name="l00424"></a>00424             mMaxTimestep = maxDeltaT;
<a name="l00425"></a>00425             mMinTimestep = minDeltaT;
<a name="l00426"></a>00426             <span class="comment">// only use once...  </span>
<a name="l00427"></a>00427         } 
<a name="l00428"></a>00428 
<a name="l00429"></a>00429         <a class="code" href="../../d1/d7f/classParametrizer.html#a6bc3e8dc463763d595e7a2bfb46a73a5">setTimestep</a>( setDeltaT ); <span class="comment">// set mTimestep to new value</span>
<a name="l00430"></a>00430         init = <span class="keyword">true</span>;    
<a name="l00431"></a>00431     }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433     <span class="comment">// finish init</span>
<a name="l00434"></a>00434     <span class="keywordflow">if</span>(init) {
<a name="l00435"></a>00435         <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; omega = &quot;</span>&lt;&lt;<a class="code" href="../../d1/d7f/classParametrizer.html#ad2da115601348e590176cee61a3178ee">calculateOmega</a>(0.0)&lt;&lt;<span class="stringliteral">&quot;, delt=&quot;</span>&lt;&lt;mTimestep,1);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437         <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a30d6799298608162497ed5c7930dcac2">PARAM_GRAVITY</a>)) {
<a name="l00438"></a>00438             <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> forceFactor = (mTimestep *mTimestep)/mCellSize; <span class="comment">// only used for printing...</span>
<a name="l00439"></a>00439             <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; gravity force = &quot;</span>&lt;&lt;<a class="code" href="../../de/df0/utilities_8h.html#abe7c339155b4a4de2c69036fca238969">PRINT_NTLVEC</a>(mcGravity.<a class="code" href="../../d1/df5/classAnimChannel.html#a2f8b4626f4c6c5a87c4de4235313d8e2">get</a>(time))&lt;&lt;<span class="stringliteral">&quot;, scaled with &quot;</span>&lt;&lt;forceFactor&lt;&lt;<span class="stringliteral">&quot; to &quot;</span>&lt;&lt;<a class="code" href="../../d1/d7f/classParametrizer.html#ab7bb4a73d49cd7ad9e7a304f272ac7b6">calculateGravity</a>(time),1);
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441         
<a name="l00442"></a>00442         <span class="comment">//mExtent = ParamVec( mCellSize*mSizex, mCellSize*mSizey, mCellSize*mSizez );</span>
<a name="l00443"></a>00443         <span class="comment">//if(!silent) debMsgStd(&quot;Parametrizer::calculateAllMissingValues&quot;,DM_MSG,&quot; domain extent = &quot;&lt;&lt;PRINT_NTLVEC(mExtent)&lt;&lt;&quot;m , gs:&quot;&lt;&lt;PRINT_VEC(mSizex,mSizey,mSizez)&lt;&lt;&quot; cs:&quot;&lt;&lt;mCellSize,1);</span>
<a name="l00444"></a>00444         
<a name="l00445"></a>00445         <span class="keywordflow">if</span>(!<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#af4543e70188174f6aae2f7de3b470bec">PARAM_ANIFRAMETIME</a>)) {
<a name="l00446"></a>00446             <a class="code" href="../../de/df0/utilities_8h.html#abbf67626aa468b4301520b9f6f292e1c">errFatal</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<span class="stringliteral">&quot; Warning no ani frame time given!&quot;</span>, <a class="code" href="../../de/df0/utilities_8h.html#a74894721e682bda2c22d5dacda988cad">SIMWORLD_INITERROR</a>);
<a name="l00447"></a>00447             <a class="code" href="../../d1/d7f/classParametrizer.html#a6d6cfc48fd648709da3d4f59c6cc6323">setAniFrameTimeChannel</a>( mTimestep );
<a name="l00448"></a>00448         } 
<a name="l00449"></a>00449 
<a name="l00450"></a>00450         <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; ani frame steps = &quot;</span>&lt;&lt;<a class="code" href="../../d1/d7f/classParametrizer.html#a27757e0bd7c948f550d76e3e64436256">calculateAniStepsPerFrame</a>(mFrameNum)&lt;&lt;<span class="stringliteral">&quot; for frame &quot;</span>&lt;&lt;mFrameNum, 1);
<a name="l00451"></a>00451 
<a name="l00452"></a>00452         <span class="keywordflow">if</span>((<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#adf1b860a15cdc3d87f73ac61412276aa">PARAM_ANISTART</a>))&amp;&amp;(<a class="code" href="../../d1/d7f/classParametrizer.html#aeec3099791f7aafd4eec411eedb3369c">calculateAniStart</a>()&gt;0)) {
<a name="l00453"></a>00453             <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues&quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a6114b55148a647b2cb346a8f3f4bb938">DM_MSG</a>,<span class="stringliteral">&quot; ani start steps = &quot;</span>&lt;&lt;<a class="code" href="../../d1/d7f/classParametrizer.html#aeec3099791f7aafd4eec411eedb3369c">calculateAniStart</a>()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>,1); 
<a name="l00454"></a>00454         }
<a name="l00455"></a>00455             
<a name="l00456"></a>00456         <span class="keywordflow">if</span>(! <a class="code" href="../../de/da5/utilities_8cpp.html#af3e89e0e3df33a7bf12fb4903a18f79b">isSimworldOk</a>() ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00457"></a>00457         <span class="comment">// everything ok</span>
<a name="l00458"></a>00458         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <span class="comment">// init failed ... failure:</span>
<a name="l00462"></a>00462     <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues &quot;</span>,<span class="stringliteral">&quot; invalid configuration!&quot;</span>);
<a name="l00463"></a>00463     <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues &quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#aac9413fb9eeba06e80c56258d95b15d6">DM_WARNING</a>, <span class="stringliteral">&quot; values seen:&quot;</span>, 1);
<a name="l00464"></a>00464     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="../../de/d94/parametrizer_8h.html#aea661b13c6dc9d2d1259ccc4796cdd3b">PARAM_NUMIDS</a>;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00465"></a>00465         <span class="keywordflow">if</span>(<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>( 1&lt;&lt;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> )) {
<a name="l00466"></a>00466             <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;  &quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#a49b416ae327829b9acf505a5f627a272">DM_NOTIFY</a>, <a class="code" href="../../dc/d7a/parametrizer_8cpp.html#a6015c422abaa6562823735748662f532">ParamStrings</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 1);
<a name="l00467"></a>00467         }
<a name="l00468"></a>00468     }
<a name="l00469"></a>00469     <span class="keywordflow">if</span>(!silent) <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;Parametrizer::calculateAllMissingValues &quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#aac9413fb9eeba06e80c56258d95b15d6">DM_WARNING</a>, <span class="stringliteral">&quot;values checked but missing:&quot;</span>, 1);
<a name="l00470"></a>00470     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="../../de/d94/parametrizer_8h.html#aea661b13c6dc9d2d1259ccc4796cdd3b">PARAM_NUMIDS</a>;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00471"></a>00471         <span class="keywordflow">if</span>((!<a class="code" href="../../d1/d7f/classParametrizer.html#a7bbc219792fc2fbae9f488c5935ca2c0">checkSeenValues</a>( 1&lt;&lt;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> ))&amp;&amp;
<a name="l00472"></a>00472              ( (valuesChecked&amp;(1&lt;&lt;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>))==(1&lt;&lt;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) ) {
<a name="l00473"></a>00473             <a class="code" href="../../de/df0/utilities_8h.html#a37f52a1d684af6dd5f377d6286f09fbd">debMsgStd</a>(<span class="stringliteral">&quot;  &quot;</span>,<a class="code" href="../../de/df0/utilities_8h.html#abebab014d2b6f5d93631b8d2e58eda66">DM_IMPORTANT</a>, <a class="code" href="../../dc/d7a/parametrizer_8cpp.html#a6015c422abaa6562823735748662f532">ParamStrings</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 1);
<a name="l00474"></a>00474         }
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476 
<a name="l00477"></a>00477     <span class="comment">// print values?</span>
<a name="l00478"></a>00478     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00479"></a>00479 }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="comment">/******************************************************************************</span>
<a name="l00483"></a>00483 <span class="comment"> * init debug functions</span>
<a name="l00484"></a>00484 <span class="comment"> *****************************************************************************/</span>
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 
<a name="l00488"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a928ef3a6224899fe6f7d81b2ec3b7985">00488</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#a928ef3a6224899fe6f7d81b2ec3b7985">Parametrizer::setViscosity</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <span class="keyword">set</span>) { 
<a name="l00489"></a>00489     mcViscosity = <a class="code" href="../../d1/df5/classAnimChannel.html">AnimChannel&lt;ParamFloat&gt;</a>(<span class="keyword">set</span>); 
<a name="l00490"></a>00490     <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#aa42c7b42faba8b00b536e20282c86f5b">PARAM_VISCOSITY</a> ); 
<a name="l00491"></a>00491 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span>    { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DebugChannels&quot;</span>,<span class="stringliteral">&quot;Parametrizer::mcViscosity set = &quot;</span>&lt;&lt; mcViscosity.<a class="code" href="../../d1/df5/classAnimChannel.html#a7204208e0f7cf13728ade6a6b6659222" title="debug function, prints channel as string">printChannel</a>() ); }
<a name="l00493"></a>00493 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00494"></a>00494 <span class="preprocessor"></span>}
<a name="l00495"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a94ec4fa354024a2c48d1d8f95a61d453">00495</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#a94ec4fa354024a2c48d1d8f95a61d453">Parametrizer::initViscosityChannel</a>(vector&lt;ParamFloat&gt; val, vector&lt;double&gt; time) { 
<a name="l00496"></a>00496     mcViscosity = <a class="code" href="../../d1/df5/classAnimChannel.html">AnimChannel&lt;ParamFloat&gt;</a>(val,time); 
<a name="l00497"></a>00497     <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#aa42c7b42faba8b00b536e20282c86f5b">PARAM_VISCOSITY</a> ); 
<a name="l00498"></a>00498 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00499"></a>00499 <span class="preprocessor"></span>    { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DebugChannels&quot;</span>,<span class="stringliteral">&quot;Parametrizer::mcViscosity initc = &quot;</span>&lt;&lt; mcViscosity.<a class="code" href="../../d1/df5/classAnimChannel.html#a7204208e0f7cf13728ade6a6b6659222" title="debug function, prints channel as string">printChannel</a>() ); }
<a name="l00500"></a>00500 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span>}
<a name="l00502"></a>00502 
<a name="l00504"></a><a class="code" href="../../d1/d7f/classParametrizer.html#aeadd52b694690b7370e670c072aac5e3">00504</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#aeadd52b694690b7370e670c072aac5e3">Parametrizer::setGravity</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> setx, <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> sety, <a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> setz) { 
<a name="l00505"></a>00505     mcGravity = <a class="code" href="../../d1/df5/classAnimChannel.html">AnimChannel&lt;ParamVec&gt;</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a5874807786cac3cd2676621c8ae9fc8f">ParamVec</a>(setx,sety,setz)); 
<a name="l00506"></a>00506     <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a30d6799298608162497ed5c7930dcac2">PARAM_GRAVITY</a> ); 
<a name="l00507"></a>00507 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00508"></a>00508 <span class="preprocessor"></span>    { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DebugChannels&quot;</span>,<span class="stringliteral">&quot;Parametrizer::mcGravity set = &quot;</span>&lt;&lt; mcGravity.<a class="code" href="../../d1/df5/classAnimChannel.html#a7204208e0f7cf13728ade6a6b6659222" title="debug function, prints channel as string">printChannel</a>() ); }
<a name="l00509"></a>00509 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00510"></a>00510 <span class="preprocessor"></span>}
<a name="l00511"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a8559e86ccacfa7966b3e5ee4b31121cf">00511</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#aeadd52b694690b7370e670c072aac5e3">Parametrizer::setGravity</a>(<a class="code" href="../../dc/d7e/classntlVector3Dim.html">ParamVec</a> <span class="keyword">set</span>) { 
<a name="l00512"></a>00512     mcGravity = <a class="code" href="../../d1/df5/classAnimChannel.html">AnimChannel&lt;ParamVec&gt;</a>(<span class="keyword">set</span>); 
<a name="l00513"></a>00513     <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a30d6799298608162497ed5c7930dcac2">PARAM_GRAVITY</a> ); 
<a name="l00514"></a>00514 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00515"></a>00515 <span class="preprocessor"></span>    { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DebugChannels&quot;</span>,<span class="stringliteral">&quot;Parametrizer::mcGravity set = &quot;</span>&lt;&lt; mcGravity.<a class="code" href="../../d1/df5/classAnimChannel.html#a7204208e0f7cf13728ade6a6b6659222" title="debug function, prints channel as string">printChannel</a>() ); }
<a name="l00516"></a>00516 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00517"></a>00517 <span class="preprocessor"></span>}
<a name="l00518"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a744fc0c42fb349008f86ce43e2e4f419">00518</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#a744fc0c42fb349008f86ce43e2e4f419">Parametrizer::initGravityChannel</a>(vector&lt;ParamVec&gt; val, vector&lt;double&gt; time) { 
<a name="l00519"></a>00519     mcGravity = <a class="code" href="../../d1/df5/classAnimChannel.html">AnimChannel&lt;ParamVec&gt;</a>(val,time); 
<a name="l00520"></a>00520     <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#a30d6799298608162497ed5c7930dcac2">PARAM_GRAVITY</a> ); 
<a name="l00521"></a>00521 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00522"></a>00522 <span class="preprocessor"></span>    { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DebugChannels&quot;</span>,<span class="stringliteral">&quot;Parametrizer::mcGravity initc = &quot;</span>&lt;&lt; mcGravity.<a class="code" href="../../d1/df5/classAnimChannel.html#a7204208e0f7cf13728ade6a6b6659222" title="debug function, prints channel as string">printChannel</a>() ); }
<a name="l00523"></a>00523 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00524"></a>00524 <span class="preprocessor"></span>}
<a name="l00525"></a>00525 
<a name="l00527"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a6d6cfc48fd648709da3d4f59c6cc6323">00527</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#a6d6cfc48fd648709da3d4f59c6cc6323">Parametrizer::setAniFrameTimeChannel</a>(<a class="code" href="../../de/d94/parametrizer_8h.html#a706d5b87f05317dfa53e5b70dbc09f95">ParamFloat</a> <span class="keyword">set</span>) { 
<a name="l00528"></a>00528     mcAniFrameTime = <a class="code" href="../../d1/df5/classAnimChannel.html">AnimChannel&lt;ParamFloat&gt;</a>(<span class="keyword">set</span>); 
<a name="l00529"></a>00529     <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#af4543e70188174f6aae2f7de3b470bec">PARAM_ANIFRAMETIME</a> ); 
<a name="l00530"></a>00530 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span>    { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DebugChannels&quot;</span>,<span class="stringliteral">&quot;Parametrizer::mcAniFrameTime set = &quot;</span>&lt;&lt; mcAniFrameTime.<a class="code" href="../../d1/df5/classAnimChannel.html#a7204208e0f7cf13728ade6a6b6659222" title="debug function, prints channel as string">printChannel</a>() ); }
<a name="l00532"></a>00532 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00533"></a>00533 <span class="preprocessor"></span>}
<a name="l00534"></a><a class="code" href="../../d1/d7f/classParametrizer.html#a86a3fd61d583482d5716fac02750e5aa">00534</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d7f/classParametrizer.html#a86a3fd61d583482d5716fac02750e5aa">Parametrizer::initAniFrameTimeChannel</a>(vector&lt;ParamFloat&gt; val, vector&lt;double&gt; time) { 
<a name="l00535"></a>00535     mcAniFrameTime = <a class="code" href="../../d1/df5/classAnimChannel.html">AnimChannel&lt;ParamFloat&gt;</a>(val,time); 
<a name="l00536"></a>00536     <a class="code" href="../../d1/d7f/classParametrizer.html#aadbb1a0d6253b8b6b9d8456c9681692f">seenThis</a>( <a class="code" href="../../de/d94/parametrizer_8h.html#af4543e70188174f6aae2f7de3b470bec">PARAM_ANIFRAMETIME</a> ); 
<a name="l00537"></a>00537 <span class="preprocessor">#if DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00538"></a>00538 <span class="preprocessor"></span>    { <a class="code" href="../../de/df0/utilities_8h.html#aad5a3b2a920c31f4f4a4252c949c6c71">errMsg</a>(<span class="stringliteral">&quot;DebugChannels&quot;</span>,<span class="stringliteral">&quot;Parametrizer::mcAniFrameTime initc = &quot;</span>&lt;&lt; mcAniFrameTime.<a class="code" href="../../d1/df5/classAnimChannel.html#a7204208e0f7cf13728ade6a6b6659222" title="debug function, prints channel as string">printChannel</a>() ); }
<a name="l00539"></a>00539 <span class="preprocessor">#endif // DEBUG_PARAMCHANNELS&gt;0</span>
<a name="l00540"></a>00540 <span class="preprocessor"></span>}
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 <span class="comment">// OLD interface stuff</span>
<a name="l00543"></a>00543 <span class="comment">// reactivate at some point?</span>
<a name="l00544"></a>00544 
<a name="l00546"></a>00546         <span class="comment">//ParamFloat mSurfaceTension;</span>
<a name="l00548"></a>00548 <span class="comment"></span>        <span class="comment">//void setSurfaceTension(ParamFloat set) { mSurfaceTension = set; seenThis( PARAM_SURFACETENSION ); }</span>
<a name="l00550"></a>00550 <span class="comment"></span>        <span class="comment">//ParamFloat getSurfaceTension( void )   { return mSurfaceTension; }</span>
<a name="l00551"></a>00551         <span class="comment">/*if((checkSeenValues(PARAM_SURFACETENSION))&amp;&amp;(mSurfaceTension&gt;0.0)) {</span>
<a name="l00552"></a>00552 <span class="comment">            ParamFloat massDelta = 1.0;</span>
<a name="l00553"></a>00553 <span class="comment">            ParamFloat densityStar = 1.0;</span>
<a name="l00554"></a>00554 <span class="comment">            massDelta = mDensity / densityStar *mCellSize*mCellSize*mCellSize;</span>
<a name="l00555"></a>00555 <span class="comment">            if(!silent) debMsgStd(&quot;Parametrizer::calculateAllMissingValues&quot;,DM_MSG,&quot; massDelta = &quot;&lt;&lt;massDelta, 10);</span>
<a name="l00556"></a>00556 <span class="comment"></span>
<a name="l00557"></a>00557 <span class="comment">            mSurfaceTension = mSurfaceTension*mTimestep*mTimestep/massDelta;</span>
<a name="l00558"></a>00558 <span class="comment">            if(!silent) debMsgStd(&quot;Parametrizer::calculateAllMissingValues&quot;,DM_MSG,&quot; surface tension = &quot;&lt;&lt;mSurfaceTension&lt;&lt;&quot; &quot;,1);</span>
<a name="l00559"></a>00559 <span class="comment">        } // */</span>
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 <span class="comment">// probably just delete:</span>
<a name="l00562"></a>00562 
<a name="l00564"></a>00564         <span class="comment">//ParamFloat mReynolds;</span>
<a name="l00565"></a>00565 
<a name="l00567"></a>00567         <span class="comment">//void setRelaxTime(ParamFloat set) { mRelaxTime = set; seenThis( PARAM_RELAXTIME ); }</span>
<a name="l00569"></a>00569 <span class="comment"></span>        <span class="comment">//ParamFloat getRelaxTime( void )   { return mRelaxTime; }</span>
<a name="l00571"></a>00571 <span class="comment"></span>        <span class="comment">//void setReynolds(ParamFloat set) { mReynolds = set; seenThis( PARAM_REYNOLDS ); }</span>
<a name="l00573"></a>00573 <span class="comment"></span>        <span class="comment">//ParamFloat getReynolds( void )   { return mReynolds; }</span>
<a name="l00574"></a>00574 
<a name="l00575"></a>00575         <span class="comment">// calculate reynolds number</span>
<a name="l00576"></a>00576         <span class="comment">/*if(mViscosity&gt;0.0) {</span>
<a name="l00577"></a>00577 <span class="comment">            ParamFloat maxSpeed  = 1.0/6.0; // for rough reynolds approx</span>
<a name="l00578"></a>00578 <span class="comment">            ParamFloat reynoldsApprox = -1.0;</span>
<a name="l00579"></a>00579 <span class="comment">            ParamFloat gridSpeed = (maxSpeed*mCellSize/mTimestep);</span>
<a name="l00580"></a>00580 <span class="comment">            reynoldsApprox = (mDomainSize*gridSpeed) / mViscosity;</span>
<a name="l00581"></a>00581 <span class="comment">            if(!silent) debMsgStd(&quot;Parametrizer::calculateAllMissingValues&quot;,DM_MSG,&quot; reynolds number (D=&quot;&lt;&lt;mDomainSize&lt;&lt;&quot;, assuming V=&quot;&lt;&lt;gridSpeed&lt;&lt;&quot;)= &quot;&lt;&lt;reynoldsApprox&lt;&lt;&quot; &quot;, 1);</span>
<a name="l00582"></a>00582 <span class="comment">        } // */</span>
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="comment">//? mRelaxTime = mpAttrs-&gt;readFloat(&quot;p_relaxtime&quot;,mRelaxTime, &quot;Parametrizer&quot;,&quot;mRelaxTime&quot;, false); </span>
<a name="l00585"></a>00585     <span class="comment">//if(getAttributeList()-&gt;exists(&quot;p_relaxtime&quot;)) seenThis( PARAM_RELAXTIME );</span>
<a name="l00586"></a>00586     <span class="comment">//? mReynolds = mpAttrs-&gt;readFloat(&quot;p_reynolds&quot;,mReynolds, &quot;Parametrizer&quot;,&quot;mReynolds&quot;, false); </span>
<a name="l00587"></a>00587     <span class="comment">//if(getAttributeList()-&gt;exists(&quot;p_reynolds&quot;)) seenThis( PARAM_REYNOLDS );</span>
<a name="l00588"></a>00588 
<a name="l00589"></a>00589     <span class="comment">//mViscosity = mpAttrs-&gt;readFloat(&quot;p_viscosity&quot;,mViscosity, &quot;Parametrizer&quot;,&quot;mViscosity&quot;, false); </span>
<a name="l00590"></a>00590     <span class="comment">//if(getAttributeList()-&gt;exists(&quot;p_viscosity&quot;) || (!mcViscosity.isInited()) ) { }</span>
<a name="l00591"></a>00591     <span class="comment">//if(getAttributeList()-&gt;exists(&quot;p_viscosity&quot;)) </span>
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 
<a name="l00594"></a>00594         <span class="comment">//ParamFloat viscStar = calculateLatticeViscosity(time);</span>
<a name="l00595"></a>00595         <span class="comment">//RelaxTime = (6.0 * viscStar + 1) * 0.5;</span>
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:43 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
