<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: gpencil_buttons.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">gpencil_buttons.c</div>  </div>
</div>
<div class="contents">
<a href="../../d2/df1/gpencil__buttons_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2008, Blender Foundation, Joshua Leung</span>
<a name="l00019"></a>00019 <span class="comment"> * This is a new part of Blender</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * Contributor(s): Joshua Leung</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00024"></a>00024 <span class="comment"> */</span>
<a name="l00025"></a>00025 
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;stddef.h&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d61/BLF__translation_8h.html">BLF_translation.h</a>&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html">DNA_gpencil_types.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da4/DNA__screen__types_8h.html">DNA_screen_types.h</a>&quot;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../da/df0/BKE__gpencil_8h.html">BKE_gpencil.h</a>&quot;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dea/ED__gpencil_8h.html">ED_gpencil.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1e/UI__interface_8h.html">UI_interface.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d96/UI__resources_8h.html">UI_resources.h</a>&quot;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d14/gpencil__intern_8h.html">gpencil_intern.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">/* ************************************************** */</span>
<a name="l00061"></a>00061 <span class="comment">/* GREASE PENCIL PANEL-UI DRAWING */</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="comment">/* Every space which implements Grease-Pencil functionality should have a panel</span>
<a name="l00064"></a>00064 <span class="comment"> * for the settings. All of the space-dependent parts should be coded in the panel</span>
<a name="l00065"></a>00065 <span class="comment"> * code for that space, but the rest is all handled by generic panel here.</span>
<a name="l00066"></a>00066 <span class="comment"> */</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">/* ------- Callbacks ----------- */</span>
<a name="l00069"></a>00069 <span class="comment">/* These are just &#39;dummy wrappers&#39; around gpencil api calls */</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">/* make layer active one after being clicked on */</span>
<a name="l00072"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#ac7709806680e96144d3039dbb380a97e">00072</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#ac7709806680e96144d3039dbb380a97e">gp_ui_activelayer_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *gpd, <span class="keywordtype">void</span> *gpl)
<a name="l00073"></a>00073 {
<a name="l00074"></a>00074     <span class="comment">/* make sure the layer we want to remove is the active one */</span>
<a name="l00075"></a>00075     <a class="code" href="../../da/df0/BKE__gpencil_8h.html#a5be42bcad6d4f6207223f52ae0359783">gpencil_layer_setactive</a>(gpd, gpl);
<a name="l00076"></a>00076     
<a name="l00077"></a>00077     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#aeab12aa02a0566181ca86214c661faca">ND_GPENCIL</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); <span class="comment">/* XXX please work! */</span>
<a name="l00078"></a>00078 }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="comment">/* delete &#39;active&#39; layer */</span>
<a name="l00081"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a9164ac5c3b4e8b7a10ba5d96d438e248">00081</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a9164ac5c3b4e8b7a10ba5d96d438e248">gp_ui_dellayer_cb</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">void</span> *gpd, <span class="keywordtype">void</span> *gpl)
<a name="l00082"></a>00082 {
<a name="l00083"></a>00083     <span class="comment">/* make sure the layer we want to remove is the active one */</span>
<a name="l00084"></a>00084     <a class="code" href="../../da/df0/BKE__gpencil_8h.html#a5be42bcad6d4f6207223f52ae0359783">gpencil_layer_setactive</a>(gpd, gpl);
<a name="l00085"></a>00085     <a class="code" href="../../da/df0/BKE__gpencil_8h.html#a84424971af23741e3adf82e8fc801a34">gpencil_layer_delactive</a>(gpd);
<a name="l00086"></a>00086     
<a name="l00087"></a>00087     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#aeab12aa02a0566181ca86214c661faca">ND_GPENCIL</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); <span class="comment">/* XXX please work! */</span>
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">/* ------- Drawing Code ------- */</span>
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="comment">/* draw the controls for a given layer */</span>
<a name="l00094"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a93be18912a120c61c4a3e9be84b5d6c7">00094</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a93be18912a120c61c4a3e9be84b5d6c7">gp_drawui_layer</a>(<a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d52/structbGPdata.html">bGPdata</a> *gpd, <a class="code" href="../../da/d7e/structbGPDlayer.html">bGPDlayer</a> *gpl, <span class="keyword">const</span> <span class="keywordtype">short</span> is_v3d)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *box = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *<a class="code" href="../../d8/d40/btDbvt_8cpp.html#ad08f07bba2ea0c5c64802b70c686fc68">split</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00097"></a>00097     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *col = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00098"></a>00098     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *row = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *sub = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00099"></a>00099     <a class="code" href="../../df/d5b/structuiBlock.html">uiBlock</a> *block;
<a name="l00100"></a>00100     <a class="code" href="../../d5/dd7/structuiBut.html">uiBut</a> *but;
<a name="l00101"></a>00101     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l00102"></a>00102     <span class="keywordtype">int</span> icon;
<a name="l00103"></a>00103     
<a name="l00104"></a>00104     <span class="comment">/* make pointer to layer data */</span>
<a name="l00105"></a>00105     <a class="code" href="../../d3/d10/rna__access_8c.html#a1f8fb80da9a6450a51ab2e9b97264f01">RNA_pointer_create</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)gpd, &amp;<a class="code" href="../../de/ddf/RNA__access_8h.html#ab6ebfbd541ecc7384694d5cbbac275e2">RNA_GPencilLayer</a>, gpl, &amp;ptr);
<a name="l00106"></a>00106     
<a name="l00107"></a>00107     <span class="comment">/* unless button has own callback, it adds this callback to button */</span>
<a name="l00108"></a>00108     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(layout);
<a name="l00109"></a>00109     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a283c3c70489e4b3cd74853d007ad457a">uiBlockSetFunc</a>(block, <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#ac7709806680e96144d3039dbb380a97e">gp_ui_activelayer_cb</a>, gpd, gpl);
<a name="l00110"></a>00110     
<a name="l00111"></a>00111     <span class="comment">/* draw header ---------------------------------- */</span>
<a name="l00112"></a>00112     <span class="comment">/* get layout-row + UI-block for header */</span>
<a name="l00113"></a>00113     box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5570dc8f239e27a98c5fdbb965572d35">uiLayoutBox</a>(layout);
<a name="l00114"></a>00114     
<a name="l00115"></a>00115     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(box, 0);
<a name="l00116"></a>00116     <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(row, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a83dfa8e56539cd22059940bbddcc4d8c">UI_LAYOUT_ALIGN_EXPAND</a>);
<a name="l00117"></a>00117     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(row); <span class="comment">/* err... */</span>
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l00120"></a>00120     
<a name="l00121"></a>00121     <span class="comment">/* left-align ............................... */</span>
<a name="l00122"></a>00122     sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(row, 0);
<a name="l00123"></a>00123     
<a name="l00124"></a>00124     <span class="comment">/* active */</span>
<a name="l00125"></a>00125     block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(sub);
<a name="l00126"></a>00126     icon = (gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#abfffefae185b28a622d3c6f294de6d51">GP_LAYER_ACTIVE</a>) ? ICON_RADIOBUT_ON : ICON_RADIOBUT_OFF;
<a name="l00127"></a>00127     but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa9defd90102f943b88abe250434ebada">uiDefIconButBitI</a>(block, <a class="code" href="../../d9/dc4/plugin_8h.html#a2532bfdf10e1ca1685038b02ce0f3386">TOG</a>, <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#abfffefae185b28a622d3c6f294de6d51">GP_LAYER_ACTIVE</a>, 0, icon, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>,
<a name="l00128"></a>00128                            &amp;gpd-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Set active layer&quot;</span>));
<a name="l00129"></a>00129     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(but, <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#ac7709806680e96144d3039dbb380a97e">gp_ui_activelayer_cb</a>, gpd, gpl);
<a name="l00130"></a>00130     
<a name="l00131"></a>00131     <span class="comment">/* locked */</span>
<a name="l00132"></a>00132     icon = (gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#a1bb3a52d41441645b284a37edf6114de">GP_LAYER_LOCKED</a>) ? ICON_LOCKED : ICON_UNLOCKED;
<a name="l00133"></a>00133     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;lock&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, icon);
<a name="l00134"></a>00134     
<a name="l00135"></a>00135     <span class="comment">/* when layer is locked or hidden, only draw header */</span>
<a name="l00136"></a>00136     <span class="keywordflow">if</span> (gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; (<a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#a1bb3a52d41441645b284a37edf6114de">GP_LAYER_LOCKED</a>|<a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#ad3d40b7a6d2bbfdf190adc89a0d36220">GP_LAYER_HIDE</a>)) {
<a name="l00137"></a>00137         <span class="keywordtype">char</span> name[256]; <span class="comment">/* gpl-&gt;info is 128, but we need space for &#39;locked/hidden&#39; as well */</span>
<a name="l00138"></a>00138         
<a name="l00139"></a>00139         <span class="comment">/* visibility button (only if hidden but not locked!) */</span>
<a name="l00140"></a>00140         <span class="keywordflow">if</span> ((gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#ad3d40b7a6d2bbfdf190adc89a0d36220">GP_LAYER_HIDE</a>) &amp;&amp; !(gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#a1bb3a52d41441645b284a37edf6114de">GP_LAYER_LOCKED</a>))
<a name="l00141"></a>00141             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;hide&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_RESTRICT_VIEW_ON);
<a name="l00142"></a>00142         
<a name="l00143"></a>00143         <span class="comment">/* name */</span>
<a name="l00144"></a>00144         <span class="keywordflow">if</span> (gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#ad3d40b7a6d2bbfdf190adc89a0d36220">GP_LAYER_HIDE</a>)
<a name="l00145"></a>00145             <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(name, <span class="keyword">sizeof</span>(name), <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;%s (Hidden)&quot;</span>), gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#a31a515796c99b3c58f1c0d34d3c9ea2d">info</a>);
<a name="l00146"></a>00146         <span class="keywordflow">else</span>
<a name="l00147"></a>00147             <a class="code" href="../../d3/db3/BLI__string_8h.html#a150551c0e3b1dc65b4c9021461f468a9">BLI_snprintf</a>(name, <span class="keyword">sizeof</span>(name), <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;%s (Locked)&quot;</span>), gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#a31a515796c99b3c58f1c0d34d3c9ea2d">info</a>);
<a name="l00148"></a>00148         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(sub, name, ICON_NONE);
<a name="l00149"></a>00149         
<a name="l00150"></a>00150         <span class="comment">/* delete button (only if hidden but not locked!) */</span>
<a name="l00151"></a>00151         <span class="keywordflow">if</span> ((gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#ad3d40b7a6d2bbfdf190adc89a0d36220">GP_LAYER_HIDE</a>) &amp;&amp; !(gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#a1bb3a52d41441645b284a37edf6114de">GP_LAYER_LOCKED</a>)) {
<a name="l00152"></a>00152             <span class="comment">/* right-align ............................... */</span>
<a name="l00153"></a>00153             sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(row, 1);
<a name="l00154"></a>00154             <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(sub, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a697e2a0e180427a09cbdd46d1c8a221b">UI_LAYOUT_ALIGN_RIGHT</a>);
<a name="l00155"></a>00155             block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(sub); <span class="comment">/* XXX... err... */</span>
<a name="l00156"></a>00156             
<a name="l00157"></a>00157             but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_X, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>,
<a name="l00158"></a>00158                                <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Delete layer&quot;</span>));
<a name="l00159"></a>00159             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(but, <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a9164ac5c3b4e8b7a10ba5d96d438e248">gp_ui_dellayer_cb</a>, gpd, gpl);
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163     <span class="keywordflow">else</span> {
<a name="l00164"></a>00164         <span class="comment">/* draw rest of header -------------------------------- */</span>
<a name="l00165"></a>00165         <span class="comment">/* visibility button */</span>
<a name="l00166"></a>00166         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;hide&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_RESTRICT_VIEW_OFF);
<a name="l00167"></a>00167         
<a name="l00168"></a>00168         <span class="comment">/* frame locking */</span>
<a name="l00169"></a>00169         <span class="comment">/* TODO: this needs its own icons... */</span>
<a name="l00170"></a>00170         icon = (gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#aed047c52577f6e0e3560c80bb65e1359">flag</a> &amp; <a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#a952a1ecb70308007eb240a58daab2a43">GP_LAYER_FRAMELOCK</a>) ? ICON_RENDER_STILL : ICON_RENDER_ANIMATION;
<a name="l00171"></a>00171         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;lock_frame&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, icon);
<a name="l00172"></a>00172         
<a name="l00173"></a>00173         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l00174"></a>00174         
<a name="l00175"></a>00175         <span class="comment">/* name */</span>
<a name="l00176"></a>00176         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;info&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00177"></a>00177         
<a name="l00178"></a>00178         <span class="comment">/* delete &#39;button&#39; */</span>
<a name="l00179"></a>00179         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a54c054495b4966d6e51e0c5ccb5d72f4">UI_EMBOSSN</a>);
<a name="l00180"></a>00180         <span class="comment">/* right-align ............................... */</span>
<a name="l00181"></a>00181         sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(row, 1);
<a name="l00182"></a>00182         <a class="code" href="../../d8/d1e/UI__interface_8h.html#acd6efe9f2ebe08f59e0d42a1bc1f6d36">uiLayoutSetAlignment</a>(sub, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a697e2a0e180427a09cbdd46d1c8a221b">UI_LAYOUT_ALIGN_RIGHT</a>);
<a name="l00183"></a>00183         block = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a103df17c27f04aa1a4d649c3d1ea349c">uiLayoutGetBlock</a>(sub); <span class="comment">/* XXX... err... */</span>
<a name="l00184"></a>00184         
<a name="l00185"></a>00185         but = <a class="code" href="../../d8/d1e/UI__interface_8h.html#afb370449e683507d2b022aec0be66046">uiDefIconBut</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a02c336ab5ee16270de92af2f3f2cb5eb">BUT</a>, 0, ICON_X, 0, 0, <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>,
<a name="l00186"></a>00186                            <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0.0, 0.0, 0.0, 0.0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#a7163975dd2031d6463da225baaf59bfb">TIP_</a>(<span class="stringliteral">&quot;Delete layer&quot;</span>));
<a name="l00187"></a>00187         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3577b54257b3f858be44d8808e6c5cc6">uiButSetFunc</a>(but, <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a9164ac5c3b4e8b7a10ba5d96d438e248">gp_ui_dellayer_cb</a>, gpd, gpl);
<a name="l00188"></a>00188         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a273f9460f5ebaa8e186d34a949d1f862">uiBlockSetEmboss</a>(block, <a class="code" href="../../d8/d1e/UI__interface_8h.html#a505992b59501cd825ea7f6d7ad3358a6">UI_EMBOSS</a>);
<a name="l00189"></a>00189         
<a name="l00190"></a>00190         <span class="comment">/* new backdrop ----------------------------------- */</span>
<a name="l00191"></a>00191         box = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5570dc8f239e27a98c5fdbb965572d35">uiLayoutBox</a>(layout);
<a name="l00192"></a>00192         split = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a81b59d1d72c4105842646d41bc39c972">uiLayoutSplit</a>(box, 0.5f, 0);
<a name="l00193"></a>00193         
<a name="l00194"></a>00194         <span class="comment">/* draw settings ---------------------------------- */</span>
<a name="l00195"></a>00195         <span class="comment">/* left column ..................... */</span>
<a name="l00196"></a>00196         col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(split, 0);
<a name="l00197"></a>00197         
<a name="l00198"></a>00198         <span class="comment">/* color */</span>
<a name="l00199"></a>00199         sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(col, 1);
<a name="l00200"></a>00200             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;color&quot;</span>, 0, <span class="stringliteral">&quot;&quot;</span>, ICON_NONE);
<a name="l00201"></a>00201             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;alpha&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aaf3db421329ade89576ca807fd583154">UI_ITEM_R_SLIDER</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00202"></a>00202         
<a name="l00203"></a>00203         <span class="comment">/* stroke thickness */</span>
<a name="l00204"></a>00204         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(col, &amp;ptr, <span class="stringliteral">&quot;line_width&quot;</span>, <a class="code" href="../../d8/d1e/UI__interface_8h.html#aaf3db421329ade89576ca807fd583154">UI_ITEM_R_SLIDER</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00205"></a>00205         
<a name="l00206"></a>00206         <span class="comment">/* debugging options */</span>
<a name="l00207"></a>00207         <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>) {
<a name="l00208"></a>00208             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(col, &amp;ptr, <span class="stringliteral">&quot;show_points&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00209"></a>00209         }
<a name="l00210"></a>00210         
<a name="l00211"></a>00211         <span class="comment">/* right column ................... */</span>
<a name="l00212"></a>00212         col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(split, 0);
<a name="l00213"></a>00213         
<a name="l00214"></a>00214         <span class="comment">/* onion-skinning */</span>
<a name="l00215"></a>00215         sub = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(col, 1);
<a name="l00216"></a>00216         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;use_onion_skinning&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00217"></a>00217         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(sub, &amp;ptr, <span class="stringliteral">&quot;ghost_range_max&quot;</span>, 0, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Frames&quot;</span>), ICON_NONE);
<a name="l00218"></a>00218         
<a name="l00219"></a>00219         <span class="comment">/* 3d-view specific drawing options */</span>
<a name="l00220"></a>00220         <span class="keywordflow">if</span> (is_v3d) {
<a name="l00221"></a>00221             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(col, &amp;ptr, <span class="stringliteral">&quot;show_x_ray&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00222"></a>00222         }
<a name="l00223"></a>00223     }
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="comment">/* stroke drawing options available */</span>
<a name="l00227"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398">00227</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398">eGP_Stroke_Ops</a> {
<a name="l00228"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398ac53ea307be0d6b9472c1023bcfe67246">00228</a>     <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398ac53ea307be0d6b9472c1023bcfe67246">STROKE_OPTS_NORMAL</a>  = 0,
<a name="l00229"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398a6e6b68d23565c10c0bdad5e1c7fc9071">00229</a>     <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398a6e6b68d23565c10c0bdad5e1c7fc9071">STROKE_OPTS_V3D_OFF</a>,
<a name="l00230"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398af92302933b4134271f9e4f48bc8c5fc4">00230</a>     <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398af92302933b4134271f9e4f48bc8c5fc4">STROKE_OPTS_V3D_ON</a>,
<a name="l00231"></a>00231 } <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398">eGP_Stroke_Ops</a>;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <span class="comment">/* Draw the contents for a grease-pencil panel*/</span>
<a name="l00234"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a193262240cd009941c1e6800b532cb9b">00234</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a193262240cd009941c1e6800b532cb9b">draw_gpencil_panel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout, <a class="code" href="../../dd/d52/structbGPdata.html">bGPdata</a> *gpd, <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> *ctx_ptr)
<a name="l00235"></a>00235 {
<a name="l00236"></a>00236     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> gpd_ptr;
<a name="l00237"></a>00237     <a class="code" href="../../da/d7e/structbGPDlayer.html">bGPDlayer</a> *gpl;
<a name="l00238"></a>00238     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *col, *row;
<a name="l00239"></a>00239     <span class="keywordtype">short</span> v3d_stroke_opts = <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398ac53ea307be0d6b9472c1023bcfe67246">STROKE_OPTS_NORMAL</a>;
<a name="l00240"></a>00240     <span class="keyword">const</span> <span class="keywordtype">short</span> is_v3d = <a class="code" href="../../df/d01/BKE__context_8h.html#a88ab4a564441708766a6b4ace3b17908">CTX_wm_view3d</a>(C) != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00241"></a>00241     
<a name="l00242"></a>00242     <span class="comment">/* make new PointerRNA for Grease Pencil block */</span>
<a name="l00243"></a>00243     <a class="code" href="../../d3/d10/rna__access_8c.html#a2ce5c1d9b520b00730820e0e118dd4e1">RNA_id_pointer_create</a>((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)gpd, &amp;gpd_ptr);
<a name="l00244"></a>00244     
<a name="l00245"></a>00245     <span class="comment">/* draw gpd settings first ------------------------------------- */</span>
<a name="l00246"></a>00246     col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(layout, 0);
<a name="l00247"></a>00247     <span class="comment">/* current Grease Pencil block */</span>
<a name="l00248"></a>00248     <span class="comment">/* TODO: show some info about who owns this? */</span>
<a name="l00249"></a>00249     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a1caec9fcdc7d298770e84c6daa185f59">uiTemplateID</a>(col, C, ctx_ptr, <span class="stringliteral">&quot;grease_pencil&quot;</span>, <span class="stringliteral">&quot;GPENCIL_OT_data_add&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;GPENCIL_OT_data_unlink&quot;</span>);
<a name="l00250"></a>00250     
<a name="l00251"></a>00251     <span class="comment">/* add new layer button - can be used even when no data, since it can add a new block too */</span>
<a name="l00252"></a>00252     <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(col, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;New Layer&quot;</span>), ICON_NONE, <span class="stringliteral">&quot;GPENCIL_OT_layer_add&quot;</span>);
<a name="l00253"></a>00253     row = <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(col, 1);
<a name="l00254"></a>00254         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Delete Frame&quot;</span>), ICON_NONE, <span class="stringliteral">&quot;GPENCIL_OT_active_frame_delete&quot;</span>);
<a name="l00255"></a>00255         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(row, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Convert&quot;</span>), ICON_NONE, <span class="stringliteral">&quot;GPENCIL_OT_convert&quot;</span>);
<a name="l00256"></a>00256     
<a name="l00257"></a>00257     <span class="comment">/* sanity checks... */</span>
<a name="l00258"></a>00258     <span class="keywordflow">if</span> (gpd == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00259"></a>00259         <span class="keywordflow">return</span>;
<a name="l00260"></a>00260     
<a name="l00261"></a>00261     <span class="comment">/* draw each layer --------------------------------------------- */</span>
<a name="l00262"></a>00262     <span class="keywordflow">for</span> (gpl = gpd-&gt;layers.first; gpl; gpl = gpl-&gt;<a class="code" href="../../da/d7e/structbGPDlayer.html#a428b812104383d1b973f98c4dde29ac9">next</a>) {
<a name="l00263"></a>00263         col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(layout, 1);
<a name="l00264"></a>00264         <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a93be18912a120c61c4a3e9be84b5d6c7">gp_drawui_layer</a>(col, gpd, gpl, is_v3d);
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266     
<a name="l00267"></a>00267     <span class="comment">/* draw gpd drawing settings first ------------------------------------- */</span>
<a name="l00268"></a>00268     col = <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa162d3b20924285fb9b3668337cb86d2">uiLayoutColumn</a>(layout, 1);
<a name="l00269"></a>00269         <span class="comment">/* label */</span>
<a name="l00270"></a>00270         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35f187f3b43444171e2ffb0a080c0fe7">uiItemL</a>(col, <a class="code" href="../../d6/d61/BLF__translation_8h.html#abb0b47333c78518638888749beab5f55">IFACE_</a>(<span class="stringliteral">&quot;Drawing Settings:&quot;</span>), ICON_NONE);
<a name="l00271"></a>00271         
<a name="l00272"></a>00272         <span class="comment">/* check whether advanced 3D-View drawing space options can be used */</span>
<a name="l00273"></a>00273         <span class="keywordflow">if</span> (is_v3d) {
<a name="l00274"></a>00274             <span class="keywordflow">if</span> (gpd-&gt;<a class="code" href="../../d8/d7e/structID.html#aaa0124bd1f312b0d778e1e0de8b8be9f">flag</a> &amp; (<a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#a529f36469455be7c564513f59eb75be2">GP_DATA_DEPTH_STROKE</a>|<a class="code" href="../../d6/dcb/DNA__gpencil__types_8h.html#a0c50e8058cd049e9149bb3bb76bce045">GP_DATA_DEPTH_VIEW</a>))
<a name="l00275"></a>00275                 v3d_stroke_opts = <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398af92302933b4134271f9e4f48bc8c5fc4">STROKE_OPTS_V3D_ON</a>;
<a name="l00276"></a>00276             <span class="keywordflow">else</span>
<a name="l00277"></a>00277                 v3d_stroke_opts = <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398a6e6b68d23565c10c0bdad5e1c7fc9071">STROKE_OPTS_V3D_OFF</a>;
<a name="l00278"></a>00278         }
<a name="l00279"></a>00279         
<a name="l00280"></a>00280         <span class="comment">/* drawing space options */</span>
<a name="l00281"></a>00281         row= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(col, 1);
<a name="l00282"></a>00282             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa9493a27cee856e903a8e22cf2bddfdb">uiItemEnumR_string</a>(row, &amp;gpd_ptr, <span class="stringliteral">&quot;draw_mode&quot;</span>, <span class="stringliteral">&quot;VIEW&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00283"></a>00283             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa9493a27cee856e903a8e22cf2bddfdb">uiItemEnumR_string</a>(row, &amp;gpd_ptr, <span class="stringliteral">&quot;draw_mode&quot;</span>, <span class="stringliteral">&quot;CURSOR&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00284"></a>00284         row= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(col, 1);
<a name="l00285"></a>00285             <a class="code" href="../../d8/d1e/UI__interface_8h.html#ace838ed32c66a6979e0df3cbaa7327b1">uiLayoutSetActive</a>(row, v3d_stroke_opts);
<a name="l00286"></a>00286             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa9493a27cee856e903a8e22cf2bddfdb">uiItemEnumR_string</a>(row, &amp;gpd_ptr, <span class="stringliteral">&quot;draw_mode&quot;</span>, <span class="stringliteral">&quot;SURFACE&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00287"></a>00287             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa9493a27cee856e903a8e22cf2bddfdb">uiItemEnumR_string</a>(row, &amp;gpd_ptr, <span class="stringliteral">&quot;draw_mode&quot;</span>, <span class="stringliteral">&quot;STROKE&quot;</span>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00288"></a>00288         
<a name="l00289"></a>00289         row= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a4aaa709c2b2a5eb251c2693567599659">uiLayoutRow</a>(col, 0);
<a name="l00290"></a>00290             <a class="code" href="../../d8/d1e/UI__interface_8h.html#ace838ed32c66a6979e0df3cbaa7327b1">uiLayoutSetActive</a>(row, v3d_stroke_opts==<a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a2c633ba95319cfc2ec09887ddb041398af92302933b4134271f9e4f48bc8c5fc4">STROKE_OPTS_V3D_ON</a>);
<a name="l00291"></a>00291             <a class="code" href="../../d8/d1e/UI__interface_8h.html#a979d9b6768e6d5a505ea6947f2465bc1">uiItemR</a>(row, &amp;gpd_ptr, <span class="stringliteral">&quot;use_stroke_endpoints&quot;</span>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ICON_NONE);
<a name="l00292"></a>00292 }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 <span class="comment">/* Standard panel to be included wherever Grease Pencil is used... */</span>
<a name="l00296"></a><a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a8ca88cef978444bc93cf33a4e20c0461">00296</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a8ca88cef978444bc93cf33a4e20c0461">gpencil_panel_standard</a>(<span class="keyword">const</span> <a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d7/d84/structPanel.html">Panel</a> *pa)
<a name="l00297"></a>00297 {
<a name="l00298"></a>00298     <a class="code" href="../../dd/d52/structbGPdata.html">bGPdata</a> **gpd_ptr = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00299"></a>00299     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr;
<a name="l00300"></a>00300     
<a name="l00301"></a>00301     <span class="comment">/* if (v3d-&gt;flag2 &amp; V3D_DISPGP)... etc. */</span>
<a name="l00302"></a>00302     
<a name="l00303"></a>00303     <span class="comment">/* get pointer to Grease Pencil Data */</span>
<a name="l00304"></a>00304     gpd_ptr = <a class="code" href="../../dd/d13/gpencil__edit_8c.html#ac2d9a15a8bf2418b19c1e5b7101fd7a2">gpencil_data_get_pointers</a>((<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *)C, &amp;ptr);
<a name="l00305"></a>00305     
<a name="l00306"></a>00306     <span class="keywordflow">if</span> (gpd_ptr)
<a name="l00307"></a>00307         <a class="code" href="../../d2/df1/gpencil__buttons_8c.html#a193262240cd009941c1e6800b532cb9b">draw_gpencil_panel</a>((<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *)C, pa-&gt;<a class="code" href="../../d7/d84/structPanel.html#a4412b9fd46d6b1618671644b2ddfc06a">layout</a>, *gpd_ptr, &amp;ptr);
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310 <span class="comment">/* ************************************************** */</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:22 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
