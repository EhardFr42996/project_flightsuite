<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: btGjkEpa2.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">btGjkEpa2.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../d6/d00/btGjkEpa2_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">Bullet Continuous Collision Detection and Physics Library</span>
<a name="l00003"></a>00003 <span class="comment">Copyright (c) 2003-2008 Erwin Coumans  http://continuousphysics.com/Bullet/</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">This software is provided &#39;as-is&#39;, without any express or implied warranty.</span>
<a name="l00006"></a>00006 <span class="comment">In no event will the authors be held liable for any damages arising from the</span>
<a name="l00007"></a>00007 <span class="comment">use of this software.</span>
<a name="l00008"></a>00008 <span class="comment">Permission is granted to anyone to use this software for any purpose,</span>
<a name="l00009"></a>00009 <span class="comment">including commercial applications, and to alter it and redistribute it</span>
<a name="l00010"></a>00010 <span class="comment">freely,</span>
<a name="l00011"></a>00011 <span class="comment">subject to the following restrictions:</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">1. The origin of this software must not be misrepresented; you must not</span>
<a name="l00014"></a>00014 <span class="comment">claim that you wrote the original software. If you use this software in a</span>
<a name="l00015"></a>00015 <span class="comment">product, an acknowledgment in the product documentation would be appreciated</span>
<a name="l00016"></a>00016 <span class="comment">but is not required.</span>
<a name="l00017"></a>00017 <span class="comment">2. Altered source versions must be plainly marked as such, and must not be</span>
<a name="l00018"></a>00018 <span class="comment">misrepresented as being the original software.</span>
<a name="l00019"></a>00019 <span class="comment">3. This notice may not be removed or altered from any source distribution.</span>
<a name="l00020"></a>00020 <span class="comment">*/</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">/*</span>
<a name="l00023"></a>00023 <span class="comment">GJK-EPA collision solver by Nathanael Presson, 2008</span>
<a name="l00024"></a>00024 <span class="comment">*/</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/btConvexInternalShape_8h.html">BulletCollision/CollisionShapes/btConvexInternalShape.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/dcf/btSphereShape_8h.html">BulletCollision/CollisionShapes/btSphereShape.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d1b/btGjkEpa2_8h.html">btGjkEpa2.h</a>&quot;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#if defined(DEBUG) || defined (_DEBUG)</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stdio.h&gt;</span> <span class="comment">//for debug printf</span>
<a name="l00031"></a>00031 <span class="preprocessor">#ifdef __SPU__</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#include &lt;spu_printf.h&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#define printf spu_printf</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#endif //__SPU__</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a><a class="code" href="../../d0/de2/namespacegjkepa2__impl.html">00037</a> <span class="keyword">namespace </span>gjkepa2_impl
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039 
<a name="l00040"></a>00040     <span class="comment">// Config</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042     <span class="comment">/* GJK  */</span> 
<a name="l00043"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#aca7c73020abfbfa5b057429a9d4425b1">00043</a> <span class="preprocessor">#define GJK_MAX_ITERATIONS  128</span>
<a name="l00044"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a3b4b2922f76b6d4fcef32c4f859fbbf4">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define GJK_ACCURARY        ((btScalar)0.0001)</span>
<a name="l00045"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a531b5643d6fbf8bbbbddd4fc6249968f">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define GJK_MIN_DISTANCE    ((btScalar)0.0001)</span>
<a name="l00046"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a94397c258e4cdb69b09ea807afba3693">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define GJK_DUPLICATED_EPS  ((btScalar)0.0001)</span>
<a name="l00047"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#abf0442104b72d6d523e440e0a00585c4">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define GJK_SIMPLEX2_EPS    ((btScalar)0.0)</span>
<a name="l00048"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#ad6d825015888fa3c01646e5f94df3ba6">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define GJK_SIMPLEX3_EPS    ((btScalar)0.0)</span>
<a name="l00049"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a67dfc6179ade988698401d8f3492e55b">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define GJK_SIMPLEX4_EPS    ((btScalar)0.0)</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051     <span class="comment">/* EPA  */</span> 
<a name="l00052"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#aae0e97be7ea410413ccf6ae07abf8550">00052</a> <span class="preprocessor">#define EPA_MAX_VERTICES    64</span>
<a name="l00053"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a41fe3c0af8fa3a74a3a8c61fd342712a">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define EPA_MAX_FACES       (EPA_MAX_VERTICES*2)</span>
<a name="l00054"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#aea71bad120f57c3a6bd4ab7d15fe4991">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define EPA_MAX_ITERATIONS  255</span>
<a name="l00055"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a1148f1844702be4174adb46b3db660f4">00055</a> <span class="preprocessor"></span><span class="preprocessor">#define EPA_ACCURACY        ((btScalar)0.0001)</span>
<a name="l00056"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a868329f4a23b956897d097b52f536f3f">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define EPA_FALLBACK        (10*EPA_ACCURACY)</span>
<a name="l00057"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a8c8917e22455518087d7888491543529">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define EPA_PLANE_EPS       ((btScalar)0.00001)</span>
<a name="l00058"></a><a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#ac2781c694b4d360362399397ccbb8fb3">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define EPA_INSIDE_EPS      ((btScalar)0.01)</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061     <span class="comment">// Shorthands</span>
<a name="l00062"></a><a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">00062</a>     <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>;
<a name="l00063"></a><a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">00063</a>     <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">U1</a>;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     <span class="comment">// MinkowskiDiff</span>
<a name="l00066"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">00066</a>     <span class="keyword">struct  </span><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">MinkowskiDiff</a>
<a name="l00067"></a>00067     {
<a name="l00068"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">00068</a>         <span class="keyword">const</span> btConvexShape*    <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[2];
<a name="l00069"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a6a0374ad6fc23d5fdcb4f50b7fbf457f">00069</a>         <a class="code" href="../../d1/d7d/classbtMatrix3x3.html" title="The btMatrix3x3 class implements a 3x3 rotation matrix, to perform linear algebra in combination with...">btMatrix3x3</a>             <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a6a0374ad6fc23d5fdcb4f50b7fbf457f">m_toshape1</a>;
<a name="l00070"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#ad3b88e820bf02ad378bcf7219b6d706e">00070</a>         <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>             <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#ad3b88e820bf02ad378bcf7219b6d706e">m_toshape0</a>;
<a name="l00071"></a>00071 <span class="preprocessor">#ifdef __SPU__</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span>        <span class="keywordtype">bool</span>                    m_enableMargin;
<a name="l00073"></a>00073 <span class="preprocessor">#else</span>
<a name="l00074"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a5d5357013a6114698057cc0b949fea0a">00074</a> <span class="preprocessor"></span>        btVector3               (btConvexShape::*<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a5d5357013a6114698057cc0b949fea0a">Ls</a>)(<span class="keyword">const</span> btVector3&amp;) <span class="keyword">const</span>;
<a name="l00075"></a>00075 <span class="preprocessor">#endif//__SPU__</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span>        
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a4a359f0952cc47c314eee19958d658f1">00078</a>         <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a4a359f0952cc47c314eee19958d658f1">MinkowskiDiff</a>()
<a name="l00079"></a>00079         {
<a name="l00080"></a>00080 
<a name="l00081"></a>00081         }
<a name="l00082"></a>00082 <span class="preprocessor">#ifdef __SPU__</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>            <span class="keywordtype">void</span>                    <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a2050c7ca5d9c033d40da2a95ed7efc9d">EnableMargin</a>(<span class="keywordtype">bool</span> enable)
<a name="l00084"></a>00084         {
<a name="l00085"></a>00085             m_enableMargin = enable;
<a name="l00086"></a>00086         }   
<a name="l00087"></a>00087         <span class="keyword">inline</span> btVector3        <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#aeab174424636b4676bb454d6bdef567e">Support0</a>(<span class="keyword">const</span> btVector3&amp; d)<span class="keyword"> const</span>
<a name="l00088"></a>00088 <span class="keyword">        </span>{
<a name="l00089"></a>00089             <span class="keywordflow">if</span> (m_enableMargin)
<a name="l00090"></a>00090             {
<a name="l00091"></a>00091                 <span class="keywordflow">return</span> <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[0]-&gt;localGetSupportVertexNonVirtual(d);
<a name="l00092"></a>00092             } <span class="keywordflow">else</span>
<a name="l00093"></a>00093             {
<a name="l00094"></a>00094                 <span class="keywordflow">return</span> <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[0]-&gt;localGetSupportVertexWithoutMarginNonVirtual(d);
<a name="l00095"></a>00095             }
<a name="l00096"></a>00096         }
<a name="l00097"></a>00097         <span class="keyword">inline</span> btVector3        <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abb9670f065f5f96c570a932f8e167201">Support1</a>(<span class="keyword">const</span> btVector3&amp; d)<span class="keyword"> const</span>
<a name="l00098"></a>00098 <span class="keyword">        </span>{
<a name="l00099"></a>00099             <span class="keywordflow">if</span> (m_enableMargin)
<a name="l00100"></a>00100             {
<a name="l00101"></a>00101                 <span class="keywordflow">return</span> <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#ad3b88e820bf02ad378bcf7219b6d706e">m_toshape0</a>*(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[1]-&gt;localGetSupportVertexNonVirtual(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a6a0374ad6fc23d5fdcb4f50b7fbf457f">m_toshape1</a>*d));
<a name="l00102"></a>00102             } <span class="keywordflow">else</span>
<a name="l00103"></a>00103             {
<a name="l00104"></a>00104                 <span class="keywordflow">return</span> <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#ad3b88e820bf02ad378bcf7219b6d706e">m_toshape0</a>*(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[1]-&gt;localGetSupportVertexWithoutMarginNonVirtual(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a6a0374ad6fc23d5fdcb4f50b7fbf457f">m_toshape1</a>*d));
<a name="l00105"></a>00105             }
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107 <span class="preprocessor">#else</span>
<a name="l00108"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a2050c7ca5d9c033d40da2a95ed7efc9d">00108</a> <span class="preprocessor"></span>        <span class="keywordtype">void</span>                    <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a2050c7ca5d9c033d40da2a95ed7efc9d">EnableMargin</a>(<span class="keywordtype">bool</span> enable)
<a name="l00109"></a>00109         {
<a name="l00110"></a>00110             <span class="keywordflow">if</span>(enable)
<a name="l00111"></a>00111                 <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a5d5357013a6114698057cc0b949fea0a">Ls</a>=&amp;btConvexShape::localGetSupportVertexNonVirtual;
<a name="l00112"></a>00112             <span class="keywordflow">else</span>
<a name="l00113"></a>00113                 <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a5d5357013a6114698057cc0b949fea0a">Ls</a>=&amp;btConvexShape::localGetSupportVertexWithoutMarginNonVirtual;
<a name="l00114"></a>00114         }   
<a name="l00115"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#aeab174424636b4676bb454d6bdef567e">00115</a>         <span class="keyword">inline</span> btVector3        <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#aeab174424636b4676bb454d6bdef567e">Support0</a>(<span class="keyword">const</span> btVector3&amp; d)<span class="keyword"> const</span>
<a name="l00116"></a>00116 <span class="keyword">        </span>{
<a name="l00117"></a>00117             <span class="keywordflow">return</span>(((<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[0])-&gt;*(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a5d5357013a6114698057cc0b949fea0a">Ls</a>))(d));
<a name="l00118"></a>00118         }
<a name="l00119"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abb9670f065f5f96c570a932f8e167201">00119</a>         <span class="keyword">inline</span> btVector3        <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abb9670f065f5f96c570a932f8e167201">Support1</a>(<span class="keyword">const</span> btVector3&amp; d)<span class="keyword"> const</span>
<a name="l00120"></a>00120 <span class="keyword">        </span>{
<a name="l00121"></a>00121             <span class="keywordflow">return</span>(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#ad3b88e820bf02ad378bcf7219b6d706e">m_toshape0</a>*((<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[1])-&gt;*(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a5d5357013a6114698057cc0b949fea0a">Ls</a>))(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a6a0374ad6fc23d5fdcb4f50b7fbf457f">m_toshape1</a>*d));
<a name="l00122"></a>00122         }
<a name="l00123"></a>00123 <span class="preprocessor">#endif //__SPU__</span>
<a name="l00124"></a>00124 <span class="preprocessor"></span>
<a name="l00125"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">00125</a>         <span class="keyword">inline</span> btVector3        <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>(<span class="keyword">const</span> btVector3&amp; d)<span class="keyword"> const</span>
<a name="l00126"></a>00126 <span class="keyword">        </span>{
<a name="l00127"></a>00127             <span class="keywordflow">return</span>(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#aeab174424636b4676bb454d6bdef567e">Support0</a>(d)-<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abb9670f065f5f96c570a932f8e167201">Support1</a>(-d));
<a name="l00128"></a>00128         }
<a name="l00129"></a><a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a129ead3b7a066d28c64bb4e4fcd38834">00129</a>         btVector3               <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>(<span class="keyword">const</span> btVector3&amp; d,<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> index)<span class="keyword"> const</span>
<a name="l00130"></a>00130 <span class="keyword">        </span>{
<a name="l00131"></a>00131             <span class="keywordflow">if</span>(index)
<a name="l00132"></a>00132                 <span class="keywordflow">return</span>(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abb9670f065f5f96c570a932f8e167201">Support1</a>(d));
<a name="l00133"></a>00133             <span class="keywordflow">else</span>
<a name="l00134"></a>00134                 <span class="keywordflow">return</span>(<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#aeab174424636b4676bb454d6bdef567e">Support0</a>(d));
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136     };
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a5a36cf8991c9237efd1569c08e3bc288">00138</a>     <span class="keyword">typedef</span> <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">MinkowskiDiff</a>   <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a5a36cf8991c9237efd1569c08e3bc288">tShape</a>;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <span class="comment">// GJK</span>
<a name="l00142"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html">00142</a>     <span class="keyword">struct  </span><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html">GJK</a>
<a name="l00143"></a>00143     {
<a name="l00144"></a>00144         <span class="comment">/* Types        */</span> 
<a name="l00145"></a><a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">00145</a>         <span class="keyword">struct  </span><a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>
<a name="l00146"></a>00146         {
<a name="l00147"></a><a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">00147</a>             btVector3   <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#ac8906ecfd952ed195ec56f61681eb358">d</a>,<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>;
<a name="l00148"></a>00148         };
<a name="l00149"></a><a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">00149</a>         <span class="keyword">struct  </span><a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">sSimplex</a>
<a name="l00150"></a>00150         {
<a name="l00151"></a><a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">00151</a>             <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>*        <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[4];
<a name="l00152"></a><a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">00152</a>             <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[4];
<a name="l00153"></a><a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">00153</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>;
<a name="l00154"></a>00154         };
<a name="l00155"></a><a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4">00155</a>         <span class="keyword">struct  </span><a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html">eStatus</a> { <span class="keyword">enum</span> <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4">_</a> {
<a name="l00156"></a><a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4aaa004846ed212c2cae21e4dd97faab11">00156</a>             <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4aaa004846ed212c2cae21e4dd97faab11">Valid</a>,
<a name="l00157"></a><a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">00157</a>             <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">Inside</a>,
<a name="l00158"></a><a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4ae74893a2dc706bcec2391c25c403bd5f">00158</a>             <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4ae74893a2dc706bcec2391c25c403bd5f">Failed</a>      };};
<a name="l00159"></a>00159             <span class="comment">/* Fields       */</span> 
<a name="l00160"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aed2064fbd7bcb606163984823e07625e">00160</a>             <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">tShape</a>          <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aed2064fbd7bcb606163984823e07625e">m_shape</a>;
<a name="l00161"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">00161</a>             btVector3       <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>;
<a name="l00162"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a738c69f33e3dd567528b3f01bd23baa3">00162</a>             <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>        <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a738c69f33e3dd567528b3f01bd23baa3">m_distance</a>;
<a name="l00163"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">00163</a>             <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">sSimplex</a>        <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[2];
<a name="l00164"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a2f234473fc9ef2bfcbb894f591e3551f">00164</a>             <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a2f234473fc9ef2bfcbb894f591e3551f">m_store</a>[4];
<a name="l00165"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">00165</a>             <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>*            <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[4];
<a name="l00166"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#af2d09f8a74f185dcb4e5d2c4e52375ae">00166</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>               <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#af2d09f8a74f185dcb4e5d2c4e52375ae">m_nfree</a>;
<a name="l00167"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">00167</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>               <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>;
<a name="l00168"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">00168</a>             <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">sSimplex</a>*       <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>;
<a name="l00169"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">00169</a>             <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4">eStatus::_</a>      <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>;
<a name="l00170"></a>00170             <span class="comment">/* Methods      */</span> 
<a name="l00171"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aff0e12e3e0d92a58d159fcacae4654c9">00171</a>             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aff0e12e3e0d92a58d159fcacae4654c9">GJK</a>()
<a name="l00172"></a>00172             {
<a name="l00173"></a>00173                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cd1cd7827d81afe62d27022fc3a5a38">Initialize</a>();
<a name="l00174"></a>00174             }
<a name="l00175"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cd1cd7827d81afe62d27022fc3a5a38">00175</a>             <span class="keywordtype">void</span>                <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cd1cd7827d81afe62d27022fc3a5a38">Initialize</a>()
<a name="l00176"></a>00176             {
<a name="l00177"></a>00177                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>       =   btVector3(0,0,0);
<a name="l00178"></a>00178                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#af2d09f8a74f185dcb4e5d2c4e52375ae">m_nfree</a>     =   0;
<a name="l00179"></a>00179                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>    =   <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4ae74893a2dc706bcec2391c25c403bd5f">eStatus::Failed</a>;
<a name="l00180"></a>00180                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>   =   0;
<a name="l00181"></a>00181                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a738c69f33e3dd567528b3f01bd23baa3">m_distance</a>  =   0;
<a name="l00182"></a>00182             }
<a name="l00183"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aef02ebcb7c4628eea04d9fd6a6a2867a">00183</a>             <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4">eStatus::_</a>          <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aef02ebcb7c4628eea04d9fd6a6a2867a">Evaluate</a>(<span class="keyword">const</span> <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">tShape</a>&amp; shapearg,<span class="keyword">const</span> btVector3&amp; guess)
<a name="l00184"></a>00184             {
<a name="l00185"></a>00185                 <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           iterations=0;
<a name="l00186"></a>00186                 <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    sqdist=0;
<a name="l00187"></a>00187                 <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    alpha=0;
<a name="l00188"></a>00188                 btVector3   lastw[4];
<a name="l00189"></a>00189                 <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           clastw=0;
<a name="l00190"></a>00190                 <span class="comment">/* Initialize solver        */</span> 
<a name="l00191"></a>00191                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[0]           =   &amp;<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a2f234473fc9ef2bfcbb894f591e3551f">m_store</a>[0];
<a name="l00192"></a>00192                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[1]           =   &amp;<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a2f234473fc9ef2bfcbb894f591e3551f">m_store</a>[1];
<a name="l00193"></a>00193                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[2]           =   &amp;<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a2f234473fc9ef2bfcbb894f591e3551f">m_store</a>[2];
<a name="l00194"></a>00194                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[3]           =   &amp;<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a2f234473fc9ef2bfcbb894f591e3551f">m_store</a>[3];
<a name="l00195"></a>00195                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#af2d09f8a74f185dcb4e5d2c4e52375ae">m_nfree</a>             =   4;
<a name="l00196"></a>00196                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>           =   0;
<a name="l00197"></a>00197                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>            =   <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4aaa004846ed212c2cae21e4dd97faab11">eStatus::Valid</a>;
<a name="l00198"></a>00198                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aed2064fbd7bcb606163984823e07625e">m_shape</a>             =   shapearg;
<a name="l00199"></a>00199                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a738c69f33e3dd567528b3f01bd23baa3">m_distance</a>          =   0;
<a name="l00200"></a>00200                 <span class="comment">/* Initialize simplex       */</span> 
<a name="l00201"></a>00201                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[0].<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a> =   0;
<a name="l00202"></a>00202                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>               =   guess;
<a name="l00203"></a>00203                 <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  sqrl=   <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>.length2();
<a name="l00204"></a>00204                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[0],sqrl&gt;0?-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>:btVector3(1,0,0));
<a name="l00205"></a>00205                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[0].<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[0] =   1;
<a name="l00206"></a>00206                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>               =   <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[0].<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>; 
<a name="l00207"></a>00207                 sqdist              =   sqrl;
<a name="l00208"></a>00208                 lastw[0]            =
<a name="l00209"></a>00209                     lastw[1]            =
<a name="l00210"></a>00210                     lastw[2]            =
<a name="l00211"></a>00211                     lastw[3]            =   <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>;
<a name="l00212"></a>00212                 <span class="comment">/* Loop                     */</span> 
<a name="l00213"></a>00213                 <span class="keywordflow">do</span>  {
<a name="l00214"></a>00214                     <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>     <a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>=1-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>;
<a name="l00215"></a>00215                     <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">sSimplex</a>&amp;   cs=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>];
<a name="l00216"></a>00216                     <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">sSimplex</a>&amp;   ns=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[<a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>];
<a name="l00217"></a>00217                     <span class="comment">/* Check zero                           */</span> 
<a name="l00218"></a>00218                     <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  rl=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>.length();
<a name="l00219"></a>00219                     <span class="keywordflow">if</span>(rl&lt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a531b5643d6fbf8bbbbddd4fc6249968f">GJK_MIN_DISTANCE</a>)
<a name="l00220"></a>00220                     {<span class="comment">/* Touching or inside              */</span> 
<a name="l00221"></a>00221                         <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>=<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">eStatus::Inside</a>;
<a name="l00222"></a>00222                         <span class="keywordflow">break</span>;
<a name="l00223"></a>00223                     }
<a name="l00224"></a>00224                     <span class="comment">/* Append new vertice in -&#39;v&#39; direction */</span> 
<a name="l00225"></a>00225                     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(cs,-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>);
<a name="l00226"></a>00226                     <span class="keyword">const</span> btVector3&amp;    w=cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>-1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>;
<a name="l00227"></a>00227                     <span class="keywordtype">bool</span>                found=<span class="keyword">false</span>;
<a name="l00228"></a>00228                     <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;4;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00229"></a>00229                     {
<a name="l00230"></a>00230                         <span class="keywordflow">if</span>((w-lastw[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]).length2()&lt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a94397c258e4cdb69b09ea807afba3693">GJK_DUPLICATED_EPS</a>)
<a name="l00231"></a>00231                         { found=<span class="keyword">true</span>;<span class="keywordflow">break</span>; }
<a name="l00232"></a>00232                     }
<a name="l00233"></a>00233                     <span class="keywordflow">if</span>(found)
<a name="l00234"></a>00234                     {<span class="comment">/* Return old simplex              */</span> 
<a name="l00235"></a>00235                         <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>]);
<a name="l00236"></a>00236                         <span class="keywordflow">break</span>;
<a name="l00237"></a>00237                     }
<a name="l00238"></a>00238                     <span class="keywordflow">else</span>
<a name="l00239"></a>00239                     {<span class="comment">/* Update lastw                    */</span> 
<a name="l00240"></a>00240                         lastw[clastw=(clastw+1)&amp;3]=w;
<a name="l00241"></a>00241                     }
<a name="l00242"></a>00242                     <span class="comment">/* Check for termination                */</span> 
<a name="l00243"></a>00243                     <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  omega=<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>,w)/rl;
<a name="l00244"></a>00244                     alpha=<a class="code" href="../../da/d05/btMinMax_8h.html#ac663fae9d94f02fb5a2d45828aa91ba1">btMax</a>(omega,alpha);
<a name="l00245"></a>00245                     <span class="keywordflow">if</span>(((rl-alpha)-(<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a3b4b2922f76b6d4fcef32c4f859fbbf4">GJK_ACCURARY</a>*rl))&lt;=0)
<a name="l00246"></a>00246                     {<span class="comment">/* Return old simplex              */</span> 
<a name="l00247"></a>00247                         <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>]);
<a name="l00248"></a>00248                         <span class="keywordflow">break</span>;
<a name="l00249"></a>00249                     }       
<a name="l00250"></a>00250                     <span class="comment">/* Reduce simplex                       */</span> 
<a name="l00251"></a>00251                     <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    weights[4];
<a name="l00252"></a>00252                     <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           mask=0;
<a name="l00253"></a>00253                     <span class="keywordflow">switch</span>(cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>)
<a name="l00254"></a>00254                     {
<a name="l00255"></a>00255                     <span class="keywordflow">case</span>    2:  sqdist=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(   cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00256"></a>00256                                     cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00257"></a>00257                                     weights,mask);<span class="keywordflow">break</span>;
<a name="l00258"></a>00258                     <span class="keywordflow">case</span>    3:  sqdist=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(   cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00259"></a>00259                                     cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00260"></a>00260                                     cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00261"></a>00261                                     weights,mask);<span class="keywordflow">break</span>;
<a name="l00262"></a>00262                     <span class="keywordflow">case</span>    4:  sqdist=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(   cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00263"></a>00263                                     cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00264"></a>00264                                     cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00265"></a>00265                                     cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00266"></a>00266                                     weights,mask);<span class="keywordflow">break</span>;
<a name="l00267"></a>00267                     }
<a name="l00268"></a>00268                     <span class="keywordflow">if</span>(sqdist&gt;=0)
<a name="l00269"></a>00269                     {<span class="comment">/* Valid   */</span> 
<a name="l00270"></a>00270                         ns.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>     =   0;
<a name="l00271"></a>00271                         <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>       =   btVector3(0,0,0);
<a name="l00272"></a>00272                         <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>   =   <a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>;
<a name="l00273"></a>00273                         <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0,ni=cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;ni;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00274"></a>00274                         {
<a name="l00275"></a>00275                             <span class="keywordflow">if</span>(mask&amp;(1&lt;&lt;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>))
<a name="l00276"></a>00276                             {
<a name="l00277"></a>00277                                 ns.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[ns.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>]       =   cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00278"></a>00278                                 ns.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[ns.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>++]     =   weights[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00279"></a>00279                                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>               +=  cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>*weights[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00280"></a>00280                             }
<a name="l00281"></a>00281                             <span class="keywordflow">else</span>
<a name="l00282"></a>00282                             {
<a name="l00283"></a>00283                                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#af2d09f8a74f185dcb4e5d2c4e52375ae">m_nfree</a>++]   =   cs.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00284"></a>00284                             }
<a name="l00285"></a>00285                         }
<a name="l00286"></a>00286                         <span class="keywordflow">if</span>(mask==15) <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>=<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">eStatus::Inside</a>;
<a name="l00287"></a>00287                     }
<a name="l00288"></a>00288                     <span class="keywordflow">else</span>
<a name="l00289"></a>00289                     {<span class="comment">/* Return old simplex              */</span> 
<a name="l00290"></a>00290                         <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>]);
<a name="l00291"></a>00291                         <span class="keywordflow">break</span>;
<a name="l00292"></a>00292                     }
<a name="l00293"></a>00293                     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>=((++iterations)&lt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#aca7c73020abfbfa5b057429a9d4425b1">GJK_MAX_ITERATIONS</a>)?<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>:<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4ae74893a2dc706bcec2391c25c403bd5f">eStatus::Failed</a>;
<a name="l00294"></a>00294                 } <span class="keywordflow">while</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>==<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4aaa004846ed212c2cae21e4dd97faab11">eStatus::Valid</a>);
<a name="l00295"></a>00295                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>=&amp;<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a49ad74413daf37bf2184e2c44b25c928">m_simplices</a>[<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#ab156242bc169f7c70e541c035e8a0215">m_current</a>];
<a name="l00296"></a>00296                 <span class="keywordflow">switch</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>)
<a name="l00297"></a>00297                 {
<a name="l00298"></a>00298                 <span class="keywordflow">case</span>    <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4aaa004846ed212c2cae21e4dd97faab11">eStatus::Valid</a>:     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a738c69f33e3dd567528b3f01bd23baa3">m_distance</a>=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>.length();<span class="keywordflow">break</span>;
<a name="l00299"></a>00299                 <span class="keywordflow">case</span>    <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">eStatus::Inside</a>:    <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a738c69f33e3dd567528b3f01bd23baa3">m_distance</a>=0;<span class="keywordflow">break</span>;
<a name="l00300"></a>00300                 <span class="keywordflow">default</span>:
<a name="l00301"></a>00301                     {
<a name="l00302"></a>00302                     }
<a name="l00303"></a>00303                 }   
<a name="l00304"></a>00304                 <span class="keywordflow">return</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a871d818da50b37e5585497005bc62e5c">m_status</a>);
<a name="l00305"></a>00305             }
<a name="l00306"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">00306</a>             <span class="keywordtype">bool</span>                    <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>()
<a name="l00307"></a>00307             {
<a name="l00308"></a>00308                 <span class="keywordflow">switch</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>)
<a name="l00309"></a>00309                 {
<a name="l00310"></a>00310                 <span class="keywordflow">case</span>    1:
<a name="l00311"></a>00311                     {
<a name="l00312"></a>00312                         <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;3;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00313"></a>00313                         {
<a name="l00314"></a>00314                             btVector3       axis=btVector3(0,0,0);
<a name="l00315"></a>00315                             axis[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]=1;
<a name="l00316"></a>00316                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>, axis);
<a name="l00317"></a>00317                             <span class="keywordflow">if</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>()) <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00318"></a>00318                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>);
<a name="l00319"></a>00319                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>,-axis);
<a name="l00320"></a>00320                             <span class="keywordflow">if</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>()) <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00321"></a>00321                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>);
<a name="l00322"></a>00322                         }
<a name="l00323"></a>00323                     }
<a name="l00324"></a>00324                     <span class="keywordflow">break</span>;
<a name="l00325"></a>00325                 <span class="keywordflow">case</span>    2:
<a name="l00326"></a>00326                     {
<a name="l00327"></a>00327                         <span class="keyword">const</span> btVector3 d=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>;
<a name="l00328"></a>00328                         <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;3;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00329"></a>00329                         {
<a name="l00330"></a>00330                             btVector3       axis=btVector3(0,0,0);
<a name="l00331"></a>00331                             axis[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]=1;
<a name="l00332"></a>00332                             <span class="keyword">const</span> btVector3 <a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>=<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(d,axis);
<a name="l00333"></a>00333                             <span class="keywordflow">if</span>(p.length2()&gt;0)
<a name="l00334"></a>00334                             {
<a name="l00335"></a>00335                                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>, p);
<a name="l00336"></a>00336                                 <span class="keywordflow">if</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>()) <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00337"></a>00337                                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>);
<a name="l00338"></a>00338                                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>,-p);
<a name="l00339"></a>00339                                 <span class="keywordflow">if</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>()) <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00340"></a>00340                                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>);
<a name="l00341"></a>00341                             }
<a name="l00342"></a>00342                         }
<a name="l00343"></a>00343                     }
<a name="l00344"></a>00344                     <span class="keywordflow">break</span>;
<a name="l00345"></a>00345                 <span class="keywordflow">case</span>    3:
<a name="l00346"></a>00346                     {
<a name="l00347"></a>00347                         <span class="keyword">const</span> btVector3 n=<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00348"></a>00348                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>);
<a name="l00349"></a>00349                         <span class="keywordflow">if</span>(n.length2()&gt;0)
<a name="l00350"></a>00350                         {
<a name="l00351"></a>00351                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>,n);
<a name="l00352"></a>00352                             <span class="keywordflow">if</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>()) <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00353"></a>00353                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>);
<a name="l00354"></a>00354                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>,-n);
<a name="l00355"></a>00355                             <span class="keywordflow">if</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>()) <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00356"></a>00356                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(*<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>);
<a name="l00357"></a>00357                         }
<a name="l00358"></a>00358                     }
<a name="l00359"></a>00359                     <span class="keywordflow">break</span>;
<a name="l00360"></a>00360                 <span class="keywordflow">case</span>    4:
<a name="l00361"></a>00361                     {
<a name="l00362"></a>00362                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d6b/btScalar_8h.html#a4c4bd8e065ab617f4e37273d76e6d581">btFabs</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">det</a>(  <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00363"></a>00363                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00364"></a>00364                             <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>))&gt;0)
<a name="l00365"></a>00365                             <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00366"></a>00366                     }
<a name="l00367"></a>00367                     <span class="keywordflow">break</span>;
<a name="l00368"></a>00368                 }
<a name="l00369"></a>00369                 <span class="keywordflow">return</span>(<span class="keyword">false</span>);
<a name="l00370"></a>00370             }
<a name="l00371"></a>00371             <span class="comment">/* Internals    */</span> 
<a name="l00372"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a5e507366c9533778bc27fa014d750d58">00372</a>             <span class="keywordtype">void</span>                <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a5e507366c9533778bc27fa014d750d58">getsupport</a>(<span class="keyword">const</span> btVector3&amp; d,<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>&amp; sv)<span class="keyword"> const</span>
<a name="l00373"></a>00373 <span class="keyword">            </span>{
<a name="l00374"></a>00374                 sv.<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#ac8906ecfd952ed195ec56f61681eb358">d</a>    =   d/d.length();
<a name="l00375"></a>00375                 sv.<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>    =   <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aed2064fbd7bcb606163984823e07625e">m_shape</a>.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>(sv.<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#ac8906ecfd952ed195ec56f61681eb358">d</a>);
<a name="l00376"></a>00376             }
<a name="l00377"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">00377</a>             <span class="keywordtype">void</span>                <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a60f7bd45348913e0fd18b3227f727897">removevertice</a>(<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">sSimplex</a>&amp; simplex)
<a name="l00378"></a>00378             {
<a name="l00379"></a>00379                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#af2d09f8a74f185dcb4e5d2c4e52375ae">m_nfree</a>++]=simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[--simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>];
<a name="l00380"></a>00380             }
<a name="l00381"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">00381</a>             <span class="keywordtype">void</span>                <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aae2a3d9ae71bf888ee700a0f18b9125b">appendvertice</a>(<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">sSimplex</a>&amp; simplex,<span class="keyword">const</span> btVector3&amp; v)
<a name="l00382"></a>00382             {
<a name="l00383"></a>00383                 simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>]=0;
<a name="l00384"></a>00384                 simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>]=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a82d589e14a87add03ea51b5a86224fa4">m_free</a>[--<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#af2d09f8a74f185dcb4e5d2c4e52375ae">m_nfree</a>];
<a name="l00385"></a>00385                 <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a5e507366c9533778bc27fa014d750d58">getsupport</a>(v,*simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>++]);
<a name="l00386"></a>00386             }
<a name="l00387"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">00387</a>             <span class="keyword">static</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">det</a>(<span class="keyword">const</span> btVector3&amp; a,<span class="keyword">const</span> btVector3&amp; b,<span class="keyword">const</span> btVector3&amp; c)
<a name="l00388"></a>00388             {
<a name="l00389"></a>00389                 <span class="keywordflow">return</span>( a.y()*b.z()*c.x()+a.z()*b.x()*c.y()-
<a name="l00390"></a>00390                     a.x()*b.z()*c.y()-a.y()*b.x()*c.z()+
<a name="l00391"></a>00391                     a.x()*b.y()*c.z()-a.z()*b.y()*c.x());
<a name="l00392"></a>00392             }
<a name="l00393"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">00393</a>             <span class="keyword">static</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(  <span class="keyword">const</span> btVector3&amp; a,
<a name="l00394"></a>00394                 <span class="keyword">const</span> btVector3&amp; b,
<a name="l00395"></a>00395                 <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>* w,<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>&amp; m)
<a name="l00396"></a>00396             {
<a name="l00397"></a>00397                 <span class="keyword">const</span> btVector3 d=b-a;
<a name="l00398"></a>00398                 <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  l=d.length2();
<a name="l00399"></a>00399                 <span class="keywordflow">if</span>(l&gt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#abf0442104b72d6d523e440e0a00585c4">GJK_SIMPLEX2_EPS</a>)
<a name="l00400"></a>00400                 {
<a name="l00401"></a>00401                     <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  t(l&gt;0?-<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(a,d)/l:0);
<a name="l00402"></a>00402                     <span class="keywordflow">if</span>(t&gt;=1)        { w[0]=0;w[1]=1;m=2;<span class="keywordflow">return</span>(b.length2()); }
<a name="l00403"></a>00403                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(t&lt;=0)   { w[0]=1;w[1]=0;m=1;<span class="keywordflow">return</span>(a.length2()); }
<a name="l00404"></a>00404                     <span class="keywordflow">else</span>            { w[0]=1-(w[1]=t);m=3;<span class="keywordflow">return</span>((a+d*t).length2()); }
<a name="l00405"></a>00405                 }
<a name="l00406"></a>00406                 <span class="keywordflow">return</span>(-1);
<a name="l00407"></a>00407             }
<a name="l00408"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#abbb0c6f4e1d031edeffd3b90a18aa308">00408</a>             <span class="keyword">static</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(  <span class="keyword">const</span> btVector3&amp; a,
<a name="l00409"></a>00409                 <span class="keyword">const</span> btVector3&amp; b,
<a name="l00410"></a>00410                 <span class="keyword">const</span> btVector3&amp; c,
<a name="l00411"></a>00411                 <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>* w,<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>&amp; m)
<a name="l00412"></a>00412             {
<a name="l00413"></a>00413                 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>      imd3[]={1,2,0};
<a name="l00414"></a>00414                 <span class="keyword">const</span> btVector3*    vt[]={&amp;a,&amp;b,&amp;c};
<a name="l00415"></a>00415                 <span class="keyword">const</span> btVector3     dl[]={a-b,b-c,c-a};
<a name="l00416"></a>00416                 <span class="keyword">const</span> btVector3     n=<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(dl[0],dl[1]);
<a name="l00417"></a>00417                 <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>      l=n.length2();
<a name="l00418"></a>00418                 <span class="keywordflow">if</span>(l&gt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#ad6d825015888fa3c01646e5f94df3ba6">GJK_SIMPLEX3_EPS</a>)
<a name="l00419"></a>00419                 {
<a name="l00420"></a>00420                     <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    mindist=-1;
<a name="l00421"></a>00421                     <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    subw[2]={0.f,0.f};
<a name="l00422"></a>00422                     <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           subm(0);
<a name="l00423"></a>00423                     <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;3;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00424"></a>00424                     {
<a name="l00425"></a>00425                         <span class="keywordflow">if</span>(<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(*vt[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>],<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(dl[i],n))&gt;0)
<a name="l00426"></a>00426                         {
<a name="l00427"></a>00427                             <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>         j=imd3[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00428"></a>00428                             <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  subd(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(*vt[i],*vt[j],subw,subm));
<a name="l00429"></a>00429                             <span class="keywordflow">if</span>((mindist&lt;0)||(subd&lt;mindist))
<a name="l00430"></a>00430                             {
<a name="l00431"></a>00431                                 mindist     =   subd;
<a name="l00432"></a>00432                                 m           =   <span class="keyword">static_cast&lt;</span><a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a><span class="keyword">&gt;</span>(((subm&amp;1)?1&lt;&lt;i:0)+((subm&amp;2)?1&lt;&lt;j:0));
<a name="l00433"></a>00433                                 w[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]        =   subw[0];
<a name="l00434"></a>00434                                 w[j]        =   subw[1];
<a name="l00435"></a>00435                                 w[imd3[j]]  =   0;              
<a name="l00436"></a>00436                             }
<a name="l00437"></a>00437                         }
<a name="l00438"></a>00438                     }
<a name="l00439"></a>00439                     <span class="keywordflow">if</span>(mindist&lt;0)
<a name="l00440"></a>00440                     {
<a name="l00441"></a>00441                         <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  d=<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(a,n);   
<a name="l00442"></a>00442                         <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  s=<a class="code" href="../../d0/d6b/btScalar_8h.html#a6b200a8d26a49406ca13329be909ec10">btSqrt</a>(l);
<a name="l00443"></a>00443                         <span class="keyword">const</span> btVector3 <a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>=n*(d/l);
<a name="l00444"></a>00444                         mindist =   p.length2();
<a name="l00445"></a>00445                         m       =   7;
<a name="l00446"></a>00446                         w[0]    =   (<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(dl[1],b-p)).<a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>()/s;
<a name="l00447"></a>00447                         w[1]    =   (<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(dl[2],c-p)).<a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>()/s;
<a name="l00448"></a>00448                         w[2]    =   1-(w[0]+w[1]);
<a name="l00449"></a>00449                     }
<a name="l00450"></a>00450                     <span class="keywordflow">return</span>(mindist);
<a name="l00451"></a>00451                 }
<a name="l00452"></a>00452                 <span class="keywordflow">return</span>(-1);
<a name="l00453"></a>00453             }
<a name="l00454"></a><a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#abfb3f7083d409d013152ff7c1a696bd4">00454</a>             <span class="keyword">static</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(  <span class="keyword">const</span> btVector3&amp; a,
<a name="l00455"></a>00455                 <span class="keyword">const</span> btVector3&amp; b,
<a name="l00456"></a>00456                 <span class="keyword">const</span> btVector3&amp; c,
<a name="l00457"></a>00457                 <span class="keyword">const</span> btVector3&amp; d,
<a name="l00458"></a>00458                 <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>* w,<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>&amp; m)
<a name="l00459"></a>00459             {
<a name="l00460"></a>00460                 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>      imd3[]={1,2,0};
<a name="l00461"></a>00461                 <span class="keyword">const</span> btVector3*    vt[]={&amp;a,&amp;b,&amp;c,&amp;d};
<a name="l00462"></a>00462                 <span class="keyword">const</span> btVector3     dl[]={a-d,b-d,c-d};
<a name="l00463"></a>00463                 <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>      vl=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">det</a>(dl[0],dl[1],dl[2]);
<a name="l00464"></a>00464                 <span class="keyword">const</span> <span class="keywordtype">bool</span>          ng=(vl*<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(a,<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(b-c,a-b)))&lt;=0;
<a name="l00465"></a>00465                 <span class="keywordflow">if</span>(ng&amp;&amp;(<a class="code" href="../../d0/d6b/btScalar_8h.html#a4c4bd8e065ab617f4e37273d76e6d581">btFabs</a>(vl)&gt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a67dfc6179ade988698401d8f3492e55b">GJK_SIMPLEX4_EPS</a>))
<a name="l00466"></a>00466                 {
<a name="l00467"></a>00467                     <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    mindist=-1;
<a name="l00468"></a>00468                     <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    subw[3]={0.f,0.f,0.f};
<a name="l00469"></a>00469                     <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           subm(0);
<a name="l00470"></a>00470                     <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;3;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00471"></a>00471                     {
<a name="l00472"></a>00472                         <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>         j=imd3[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00473"></a>00473                         <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  s=vl*<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(d,<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(dl[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>],dl[j]));
<a name="l00474"></a>00474                         <span class="keywordflow">if</span>(s&gt;0)
<a name="l00475"></a>00475                         {
<a name="l00476"></a>00476                             <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  subd=<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aee41f08026e70a25f007116118a87bed">projectorigin</a>(*vt[i],*vt[j],d,subw,subm);
<a name="l00477"></a>00477                             <span class="keywordflow">if</span>((mindist&lt;0)||(subd&lt;mindist))
<a name="l00478"></a>00478                             {
<a name="l00479"></a>00479                                 mindist     =   subd;
<a name="l00480"></a>00480                                 m           =   <span class="keyword">static_cast&lt;</span><a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a><span class="keyword">&gt;</span>((subm&amp;1?1&lt;&lt;i:0)+
<a name="l00481"></a>00481                                     (subm&amp;2?1&lt;&lt;j:0)+
<a name="l00482"></a>00482                                     (subm&amp;4?8:0));
<a name="l00483"></a>00483                                 w[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]        =   subw[0];
<a name="l00484"></a>00484                                 w[j]        =   subw[1];
<a name="l00485"></a>00485                                 w[imd3[j]]  =   0;
<a name="l00486"></a>00486                                 w[3]        =   subw[2];
<a name="l00487"></a>00487                             }
<a name="l00488"></a>00488                         }
<a name="l00489"></a>00489                     }
<a name="l00490"></a>00490                     <span class="keywordflow">if</span>(mindist&lt;0)
<a name="l00491"></a>00491                     {
<a name="l00492"></a>00492                         mindist =   0;
<a name="l00493"></a>00493                         m       =   15;
<a name="l00494"></a>00494                         w[0]    =   <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">det</a>(c,b,d)/vl;
<a name="l00495"></a>00495                         w[1]    =   <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">det</a>(a,c,d)/vl;
<a name="l00496"></a>00496                         w[2]    =   <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">det</a>(b,a,d)/vl;
<a name="l00497"></a>00497                         w[3]    =   1-(w[0]+w[1]+w[2]);
<a name="l00498"></a>00498                     }
<a name="l00499"></a>00499                     <span class="keywordflow">return</span>(mindist);
<a name="l00500"></a>00500                 }
<a name="l00501"></a>00501                 <span class="keywordflow">return</span>(-1);
<a name="l00502"></a>00502             }
<a name="l00503"></a>00503     };
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="comment">// EPA</span>
<a name="l00506"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html">00506</a>     <span class="keyword">struct  </span><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html">EPA</a>
<a name="l00507"></a>00507     {
<a name="l00508"></a>00508         <span class="comment">/* Types        */</span> 
<a name="l00509"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ae68df593da0fe83750ca5d214f3b99e1">00509</a>         <span class="keyword">typedef</span> <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">GJK::sSV</a>    <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ae68df593da0fe83750ca5d214f3b99e1">sSV</a>;
<a name="l00510"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">00510</a>         <span class="keyword">struct  </span><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>
<a name="l00511"></a>00511         {
<a name="l00512"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">00512</a>             btVector3   <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>;
<a name="l00513"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">00513</a>             <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>;
<a name="l00514"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">00514</a>             <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>;
<a name="l00515"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">00515</a>             <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>*        <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[3];
<a name="l00516"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a8e66ed87024afa716eea0cb6aaf75c96">00516</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*      <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a8e66ed87024afa716eea0cb6aaf75c96">f</a>[3];
<a name="l00517"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abba40edc9397fe52ba4ea37c85e166e3">00517</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*      <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abba40edc9397fe52ba4ea37c85e166e3">l</a>[2];
<a name="l00518"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a81d623f8eca043ad973a9cdd6f791e8a">00518</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">U1</a>          <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a81d623f8eca043ad973a9cdd6f791e8a">e</a>[3];
<a name="l00519"></a><a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a6a0ef1327923a6ac1b8b9a88c36234f8">00519</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">U1</a>          <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a6a0ef1327923a6ac1b8b9a88c36234f8">pass</a>;
<a name="l00520"></a>00520         };
<a name="l00521"></a><a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html">00521</a>         <span class="keyword">struct  </span><a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html">sList</a>
<a name="l00522"></a>00522         {
<a name="l00523"></a><a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">00523</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*      <a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>;
<a name="l00524"></a><a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a7be6d7567e0e23712e37955057be6eff">00524</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           <a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a7be6d7567e0e23712e37955057be6eff">count</a>;
<a name="l00525"></a><a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a4c6ad1b35f1bc757748854a4cfb68238">00525</a>             <a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a4c6ad1b35f1bc757748854a4cfb68238">sList</a>() : <a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>(0),<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a7be6d7567e0e23712e37955057be6eff">count</a>(0)  {}
<a name="l00526"></a>00526         };
<a name="l00527"></a><a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html">00527</a>         <span class="keyword">struct  </span><a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html">sHorizon</a>
<a name="l00528"></a>00528         {
<a name="l00529"></a><a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a7c99c9a25b25fe45e7789bea49e3c863">00529</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*      <a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a7c99c9a25b25fe45e7789bea49e3c863">cf</a>;
<a name="l00530"></a><a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#adbcd006a25dfd9a3057d51b0839f0488">00530</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*      <a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#adbcd006a25dfd9a3057d51b0839f0488">ff</a>;
<a name="l00531"></a><a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a2a65f3e810f41fa36e15c36eeb0f83c3">00531</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           <a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a2a65f3e810f41fa36e15c36eeb0f83c3">nf</a>;
<a name="l00532"></a><a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a45e4d1cf89c0c0efb1df7215a2bea82b">00532</a>             <a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a45e4d1cf89c0c0efb1df7215a2bea82b">sHorizon</a>() : <a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a7c99c9a25b25fe45e7789bea49e3c863">cf</a>(0),<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#adbcd006a25dfd9a3057d51b0839f0488">ff</a>(0),<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a2a65f3e810f41fa36e15c36eeb0f83c3">nf</a>(0)  {}
<a name="l00533"></a>00533         };
<a name="l00534"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627be">00534</a>         <span class="keyword">struct  </span><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html">eStatus</a> { <span class="keyword">enum</span> <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627be">_</a> {
<a name="l00535"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea12472bb05df40f919a22c2998d565e3f">00535</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea12472bb05df40f919a22c2998d565e3f">Valid</a>,
<a name="l00536"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beabb82f18c95a961572ff2df0c7da6bd7b">00536</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beabb82f18c95a961572ff2df0c7da6bd7b">Touching</a>,
<a name="l00537"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea0815dbee590551dc3a0915caae30c0a1">00537</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea0815dbee590551dc3a0915caae30c0a1">Degenerated</a>,
<a name="l00538"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea99c56e945ab5dd60adc73d65bb597553">00538</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea99c56e945ab5dd60adc73d65bb597553">NonConvex</a>,
<a name="l00539"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beada7873f49d51200800302fbd7171a680">00539</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beada7873f49d51200800302fbd7171a680">InvalidHull</a>,        
<a name="l00540"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea8e197d8dc5efebe2becaf72ee38a9c31">00540</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea8e197d8dc5efebe2becaf72ee38a9c31">OutOfFaces</a>,
<a name="l00541"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beab2f85914e91a5cfa40ac02bcfd95e416">00541</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beab2f85914e91a5cfa40ac02bcfd95e416">OutOfVertices</a>,
<a name="l00542"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beaa3338cda54014f420338fc17ae2a09a5">00542</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beaa3338cda54014f420338fc17ae2a09a5">AccuraryReached</a>,
<a name="l00543"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beacf63479cb718929c7a1c07dfb65adf16">00543</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beacf63479cb718929c7a1c07dfb65adf16">FallBack</a>,
<a name="l00544"></a><a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea00fe930ee8847e694eb345b74fd55638">00544</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea00fe930ee8847e694eb345b74fd55638">Failed</a>      };};
<a name="l00545"></a>00545             <span class="comment">/* Fields       */</span> 
<a name="l00546"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">00546</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627be">eStatus::_</a>      <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>;
<a name="l00547"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">00547</a>             <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">GJK::sSimplex</a>   <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>;
<a name="l00548"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">00548</a>             btVector3       <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>;
<a name="l00549"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7329b93546644d254bb01193b324f80a">00549</a>             <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>        <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7329b93546644d254bb01193b324f80a">m_depth</a>;
<a name="l00550"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a5c2c3d064d13f1270ed589c090b62d05">00550</a>             <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>             <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a5c2c3d064d13f1270ed589c090b62d05">m_sv_store</a>[<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#aae0e97be7ea410413ccf6ae07abf8550">EPA_MAX_VERTICES</a>];
<a name="l00551"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab0293865869ece92d35106a0d4bf6dda">00551</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>           <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab0293865869ece92d35106a0d4bf6dda">m_fc_store</a>[<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a41fe3c0af8fa3a74a3a8c61fd342712a">EPA_MAX_FACES</a>];
<a name="l00552"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad140d2e9afab9280d11b1175d42994c9">00552</a>             <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>               <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad140d2e9afab9280d11b1175d42994c9">m_nextsv</a>;
<a name="l00553"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">00553</a>             <a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html">sList</a>           <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>;
<a name="l00554"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">00554</a>             <a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html">sList</a>           <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>;
<a name="l00555"></a>00555             <span class="comment">/* Methods      */</span> 
<a name="l00556"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7269bc6a66e06eb5be461616e312bae2">00556</a>             <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7269bc6a66e06eb5be461616e312bae2">EPA</a>()
<a name="l00557"></a>00557             {
<a name="l00558"></a>00558                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a5f6c9f49dd9fcd223aba906afa1dad7f">Initialize</a>();   
<a name="l00559"></a>00559             }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 
<a name="l00562"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">00562</a>             <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>      <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>* fa,<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> ea,<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>* <a class="code" href="../../dc/d53/implicit_8c.html#a6593817fe20dfc95a3fb3f71c7b8c996">fb</a>,<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> eb)
<a name="l00563"></a>00563             {
<a name="l00564"></a>00564                 fa-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a81d623f8eca043ad973a9cdd6f791e8a">e</a>[ea]=(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">U1</a>)eb;fa-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a8e66ed87024afa716eea0cb6aaf75c96">f</a>[ea]=<a class="code" href="../../dc/d53/implicit_8c.html#a6593817fe20dfc95a3fb3f71c7b8c996">fb</a>;
<a name="l00565"></a>00565                 fb-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a81d623f8eca043ad973a9cdd6f791e8a">e</a>[eb]=(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">U1</a>)ea;fb-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a8e66ed87024afa716eea0cb6aaf75c96">f</a>[eb]=fa;
<a name="l00566"></a>00566             }
<a name="l00567"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">00567</a>             <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>      <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">append</a>(<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html">sList</a>&amp; list,<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>* face)
<a name="l00568"></a>00568             {
<a name="l00569"></a>00569                 face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abba40edc9397fe52ba4ea37c85e166e3">l</a>[0]  =   0;
<a name="l00570"></a>00570                 face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abba40edc9397fe52ba4ea37c85e166e3">l</a>[1]  =   list.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>;
<a name="l00571"></a>00571                 <span class="keywordflow">if</span>(list.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>) list.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abba40edc9397fe52ba4ea37c85e166e3">l</a>[0]=face;
<a name="l00572"></a>00572                 list.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>   =   face;
<a name="l00573"></a>00573                 ++list.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a7be6d7567e0e23712e37955057be6eff">count</a>;
<a name="l00574"></a>00574             }
<a name="l00575"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a2cc3a589df31713fcd2f8fb3a30b429a">00575</a>             <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>      <span class="keyword">remove</span>(<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html">sList</a>&amp; list,<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>* face)
<a name="l00576"></a>00576             {
<a name="l00577"></a>00577                 <span class="keywordflow">if</span>(face-&gt;l[1]) face-&gt;l[1]-&gt;l[0]=face-&gt;l[0];
<a name="l00578"></a>00578                 <span class="keywordflow">if</span>(face-&gt;l[0]) face-&gt;l[0]-&gt;l[1]=face-&gt;l[1];
<a name="l00579"></a>00579                 <span class="keywordflow">if</span>(face==list.root) list.root=face-&gt;l[1];
<a name="l00580"></a>00580                 --list.count;
<a name="l00581"></a>00581             }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 
<a name="l00584"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a5f6c9f49dd9fcd223aba906afa1dad7f">00584</a>             <span class="keywordtype">void</span>                <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a5f6c9f49dd9fcd223aba906afa1dad7f">Initialize</a>()
<a name="l00585"></a>00585             {
<a name="l00586"></a>00586                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>    =   <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea00fe930ee8847e694eb345b74fd55638">eStatus::Failed</a>;
<a name="l00587"></a>00587                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>    =   btVector3(0,0,0);
<a name="l00588"></a>00588                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7329b93546644d254bb01193b324f80a">m_depth</a>     =   0;
<a name="l00589"></a>00589                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad140d2e9afab9280d11b1175d42994c9">m_nextsv</a>    =   0;
<a name="l00590"></a>00590                 <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a41fe3c0af8fa3a74a3a8c61fd342712a">EPA_MAX_FACES</a>;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00591"></a>00591                 {
<a name="l00592"></a>00592                     <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">append</a>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>,&amp;<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab0293865869ece92d35106a0d4bf6dda">m_fc_store</a>[EPA_MAX_FACES-<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>-1]);
<a name="l00593"></a>00593                 }
<a name="l00594"></a>00594             }
<a name="l00595"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a66edbc762eb8ac621d32f4620a5dfc35">00595</a>             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627be">eStatus::_</a>          <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a66edbc762eb8ac621d32f4620a5dfc35">Evaluate</a>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html">GJK</a>&amp; gjk,<span class="keyword">const</span> btVector3&amp; guess)
<a name="l00596"></a>00596             {
<a name="l00597"></a>00597                 <a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html">GJK::sSimplex</a>&amp;  simplex=*gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>;
<a name="l00598"></a>00598                 <span class="keywordflow">if</span>((simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>&gt;1)&amp;&amp;gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a1cb2261d5ad6b120b6741dbb32bc0961">EncloseOrigin</a>())
<a name="l00599"></a>00599                 {
<a name="l00600"></a>00600 
<a name="l00601"></a>00601                     <span class="comment">/* Clean up             */</span> 
<a name="l00602"></a>00602                     <span class="keywordflow">while</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>)
<a name="l00603"></a>00603                     {
<a name="l00604"></a>00604                         <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*  f = <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>;
<a name="l00605"></a>00605                         <span class="keyword">remove</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>,f);
<a name="l00606"></a>00606                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">append</a>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>,f);
<a name="l00607"></a>00607                     }
<a name="l00608"></a>00608                     <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>    =   <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea12472bb05df40f919a22c2998d565e3f">eStatus::Valid</a>;
<a name="l00609"></a>00609                     <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad140d2e9afab9280d11b1175d42994c9">m_nextsv</a>    =   0;
<a name="l00610"></a>00610                     <span class="comment">/* Orient simplex       */</span> 
<a name="l00611"></a>00611                     <span class="keywordflow">if</span>(gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8749f1a765d65393514efcd1b6092a1b">det</a>( simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00612"></a>00612                         simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,
<a name="l00613"></a>00613                         simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>)&lt;0)
<a name="l00614"></a>00614                     {
<a name="l00615"></a>00615                         <a class="code" href="../../d0/d6b/btScalar_8h.html#a2914d44e9957536703eda13dd0a4a2b2">btSwap</a>(simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]);
<a name="l00616"></a>00616                         <a class="code" href="../../d0/d6b/btScalar_8h.html#a2914d44e9957536703eda13dd0a4a2b2">btSwap</a>(simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[0],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[1]);
<a name="l00617"></a>00617                     }
<a name="l00618"></a>00618                     <span class="comment">/* Build initial hull   */</span> 
<a name="l00619"></a>00619                     <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*  tetra[]={<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ac01d46e7801045987e4c7b46f6d08e1d">newface</a>(simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2],<span class="keyword">true</span>),
<a name="l00620"></a>00620                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ac01d46e7801045987e4c7b46f6d08e1d">newface</a>(simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3],<span class="keyword">true</span>),
<a name="l00621"></a>00621                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ac01d46e7801045987e4c7b46f6d08e1d">newface</a>(simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3],<span class="keyword">true</span>),
<a name="l00622"></a>00622                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ac01d46e7801045987e4c7b46f6d08e1d">newface</a>(simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2],simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[3],<span class="keyword">true</span>)};
<a name="l00623"></a>00623                     <span class="keywordflow">if</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a7be6d7567e0e23712e37955057be6eff">count</a>==4)
<a name="l00624"></a>00624                     {
<a name="l00625"></a>00625                         <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*      best=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a906d2b41e82262cc702fedac99e88906">findbest</a>();
<a name="l00626"></a>00626                         <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>       outer=*best;
<a name="l00627"></a>00627                         <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           pass=0;
<a name="l00628"></a>00628                         <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>           iterations=0;
<a name="l00629"></a>00629                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(tetra[0],0,tetra[1],0);
<a name="l00630"></a>00630                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(tetra[0],1,tetra[2],0);
<a name="l00631"></a>00631                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(tetra[0],2,tetra[3],0);
<a name="l00632"></a>00632                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(tetra[1],1,tetra[3],2);
<a name="l00633"></a>00633                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(tetra[1],2,tetra[2],1);
<a name="l00634"></a>00634                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(tetra[2],2,tetra[3],1);
<a name="l00635"></a>00635                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>=<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea12472bb05df40f919a22c2998d565e3f">eStatus::Valid</a>;
<a name="l00636"></a>00636                         <span class="keywordflow">for</span>(;iterations&lt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#aea71bad120f57c3a6bd4ab7d15fe4991">EPA_MAX_ITERATIONS</a>;++iterations)
<a name="l00637"></a>00637                         {
<a name="l00638"></a>00638                             <span class="keywordflow">if</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad140d2e9afab9280d11b1175d42994c9">m_nextsv</a>&lt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#aae0e97be7ea410413ccf6ae07abf8550">EPA_MAX_VERTICES</a>)
<a name="l00639"></a>00639                             {   
<a name="l00640"></a>00640                                 <a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html">sHorizon</a>        horizon;
<a name="l00641"></a>00641                                 <a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>*            w=&amp;<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a5c2c3d064d13f1270ed589c090b62d05">m_sv_store</a>[<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad140d2e9afab9280d11b1175d42994c9">m_nextsv</a>++];
<a name="l00642"></a>00642                                 <span class="keywordtype">bool</span>            valid=<span class="keyword">true</span>;                 
<a name="l00643"></a>00643                                 best-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a6a0ef1327923a6ac1b8b9a88c36234f8">pass</a>  =   (<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">U1</a>)(++pass);
<a name="l00644"></a>00644                                 gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a5e507366c9533778bc27fa014d750d58">getsupport</a>(best-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>,*w);
<a name="l00645"></a>00645                                 <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  wdist=<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(best-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>,w-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>)-best-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>;
<a name="l00646"></a>00646                                 <span class="keywordflow">if</span>(wdist&gt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a1148f1844702be4174adb46b3db660f4">EPA_ACCURACY</a>)
<a name="l00647"></a>00647                                 {
<a name="l00648"></a>00648                                     <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> j=0;(j&lt;3)&amp;&amp;valid;++j)
<a name="l00649"></a>00649                                     {
<a name="l00650"></a>00650                                         valid&amp;=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a279ea2052f9a7bfc3a1bd5024bb6ad17">expand</a>(  pass,w,
<a name="l00651"></a>00651                                             best-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a8e66ed87024afa716eea0cb6aaf75c96">f</a>[j],best-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a81d623f8eca043ad973a9cdd6f791e8a">e</a>[j],
<a name="l00652"></a>00652                                             horizon);
<a name="l00653"></a>00653                                     }
<a name="l00654"></a>00654                                     <span class="keywordflow">if</span>(valid&amp;&amp;(horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a2a65f3e810f41fa36e15c36eeb0f83c3">nf</a>&gt;=3))
<a name="l00655"></a>00655                                     {
<a name="l00656"></a>00656                                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a7c99c9a25b25fe45e7789bea49e3c863">cf</a>,1,horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#adbcd006a25dfd9a3057d51b0839f0488">ff</a>,2);
<a name="l00657"></a>00657                                         <span class="keyword">remove</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>,best);
<a name="l00658"></a>00658                                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">append</a>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>,best);
<a name="l00659"></a>00659                                         best=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a906d2b41e82262cc702fedac99e88906">findbest</a>();
<a name="l00660"></a>00660                                         <span class="keywordflow">if</span>(best-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>&gt;=outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>) outer=*best;
<a name="l00661"></a>00661                                     } <span class="keywordflow">else</span> { <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>=<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beada7873f49d51200800302fbd7171a680">eStatus::InvalidHull</a>;<span class="keywordflow">break</span>; }
<a name="l00662"></a>00662                                 } <span class="keywordflow">else</span> { <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>=<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beaa3338cda54014f420338fc17ae2a09a5">eStatus::AccuraryReached</a>;<span class="keywordflow">break</span>; }
<a name="l00663"></a>00663                             } <span class="keywordflow">else</span> { <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>=<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beab2f85914e91a5cfa40ac02bcfd95e416">eStatus::OutOfVertices</a>;<span class="keywordflow">break</span>; }
<a name="l00664"></a>00664                         }
<a name="l00665"></a>00665                         <span class="keyword">const</span> btVector3 projection=outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>*outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>;
<a name="l00666"></a>00666                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>    =   outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>;
<a name="l00667"></a>00667                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7329b93546644d254bb01193b324f80a">m_depth</a>     =   outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>;
<a name="l00668"></a>00668                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>   =   3;
<a name="l00669"></a>00669                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]   =   outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[0];
<a name="l00670"></a>00670                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[1]   =   outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[1];
<a name="l00671"></a>00671                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[2]   =   outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[2];
<a name="l00672"></a>00672                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[0]   =   <a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(    outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-projection,
<a name="l00673"></a>00673                             outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[2]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-projection).length();
<a name="l00674"></a>00674                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[1]   =   <a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(    outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[2]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-projection,
<a name="l00675"></a>00675                             outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-projection).length();
<a name="l00676"></a>00676                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[2]   =   <a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(    outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[0]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-projection,
<a name="l00677"></a>00677                             outer.<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[1]-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-projection).length();
<a name="l00678"></a>00678                         <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a746bfa686f2dce5b1cff46bba26ac803">sum</a>=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[0]+<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[1]+<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[2];
<a name="l00679"></a>00679                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[0]   /=  <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a746bfa686f2dce5b1cff46bba26ac803">sum</a>;
<a name="l00680"></a>00680                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[1]   /=  <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a746bfa686f2dce5b1cff46bba26ac803">sum</a>;
<a name="l00681"></a>00681                         <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[2]   /=  <a class="code" href="../../de/da0/btSoftBodyHelpers_8cpp.html#a746bfa686f2dce5b1cff46bba26ac803">sum</a>;
<a name="l00682"></a>00682                         <span class="keywordflow">return</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>);
<a name="l00683"></a>00683                     }
<a name="l00684"></a>00684                 }
<a name="l00685"></a>00685                 <span class="comment">/* Fallback     */</span> 
<a name="l00686"></a>00686                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>    =   <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beacf63479cb718929c7a1c07dfb65adf16">eStatus::FallBack</a>;
<a name="l00687"></a>00687                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>    =   -guess;
<a name="l00688"></a>00688                 <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  nl=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>.length();
<a name="l00689"></a>00689                 <span class="keywordflow">if</span>(nl&gt;0)
<a name="l00690"></a>00690                     <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>    =   <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>/nl;
<a name="l00691"></a>00691                 <span class="keywordflow">else</span>
<a name="l00692"></a>00692                     <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>    =   btVector3(1,0,0);
<a name="l00693"></a>00693                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7329b93546644d254bb01193b324f80a">m_depth</a> =   0;
<a name="l00694"></a>00694                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>=1;
<a name="l00695"></a>00695                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0]=simplex.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[0];
<a name="l00696"></a>00696                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[0]=1;    
<a name="l00697"></a>00697                 <span class="keywordflow">return</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>);
<a name="l00698"></a>00698             }
<a name="l00699"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ac01d46e7801045987e4c7b46f6d08e1d">00699</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*              <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ac01d46e7801045987e4c7b46f6d08e1d">newface</a>(<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>* a,<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>* b,<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>* c,<span class="keywordtype">bool</span> forced)
<a name="l00700"></a>00700             {
<a name="l00701"></a>00701                 <span class="keywordflow">if</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>)
<a name="l00702"></a>00702                 {
<a name="l00703"></a>00703                     <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*  face=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>;
<a name="l00704"></a>00704                     <span class="keyword">remove</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>,face);
<a name="l00705"></a>00705                     <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">append</a>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>,face);
<a name="l00706"></a>00706                     face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a6a0ef1327923a6ac1b8b9a88c36234f8">pass</a>  =   0;
<a name="l00707"></a>00707                     face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[0]  =   a;
<a name="l00708"></a>00708                     face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[1]  =   b;
<a name="l00709"></a>00709                     face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[2]  =   c;
<a name="l00710"></a>00710                     face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>     =   <a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(b-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-a-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,c-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-a-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>);
<a name="l00711"></a>00711                     <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  l=face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>.length();
<a name="l00712"></a>00712                     <span class="keyword">const</span> <span class="keywordtype">bool</span>      v=l&gt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a1148f1844702be4174adb46b3db660f4">EPA_ACCURACY</a>;
<a name="l00713"></a>00713                     face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>     =   <a class="code" href="../../da/d05/btMinMax_8h.html#a083aab7ffec01586f450c9f2696f7fe5">btMin</a>(<a class="code" href="../../da/d05/btMinMax_8h.html#a083aab7ffec01586f450c9f2696f7fe5">btMin</a>(
<a name="l00714"></a>00714                         <a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(a-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>,a-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-b-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>)),
<a name="l00715"></a>00715                         <a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(b-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>,b-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-c-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>))),
<a name="l00716"></a>00716                         <a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(c-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,<a class="code" href="../../d2/dd0/btVector3_8h.html#ad50f4077e814fac34e7d7d5d461278de" title="Return the cross product of two vectors.">btCross</a>(face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>,c-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>-a-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>))) /
<a name="l00717"></a>00717                         (v?l:1);
<a name="l00718"></a>00718                     face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>     =   face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>&gt;=-<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#ac2781c694b4d360362399397ccbb8fb3">EPA_INSIDE_EPS</a>?0:face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>;
<a name="l00719"></a>00719                     <span class="keywordflow">if</span>(v)
<a name="l00720"></a>00720                     {
<a name="l00721"></a>00721                         face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>     =   <a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(a-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>,face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>)/l;
<a name="l00722"></a>00722                         face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>     /=  l;
<a name="l00723"></a>00723                         <span class="keywordflow">if</span>(forced||(face-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>&gt;=-<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a8c8917e22455518087d7888491543529">EPA_PLANE_EPS</a>))
<a name="l00724"></a>00724                         {
<a name="l00725"></a>00725                             <span class="keywordflow">return</span>(face);
<a name="l00726"></a>00726                         } <span class="keywordflow">else</span> <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>=<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea99c56e945ab5dd60adc73d65bb597553">eStatus::NonConvex</a>;
<a name="l00727"></a>00727                     } <span class="keywordflow">else</span> <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>=<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea0815dbee590551dc3a0915caae30c0a1">eStatus::Degenerated</a>;
<a name="l00728"></a>00728                     <span class="keyword">remove</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>,face);
<a name="l00729"></a>00729                     <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">append</a>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>,face);
<a name="l00730"></a>00730                     <span class="keywordflow">return</span>(0);
<a name="l00731"></a>00731                 }
<a name="l00732"></a>00732                 <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad364c49ac6b754b7aa56b4e7322739f7">m_status</a>=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>?<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627beab2f85914e91a5cfa40ac02bcfd95e416">eStatus::OutOfVertices</a>:<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea8e197d8dc5efebe2becaf72ee38a9c31">eStatus::OutOfFaces</a>;
<a name="l00733"></a>00733                 <span class="keywordflow">return</span>(0);
<a name="l00734"></a>00734             }
<a name="l00735"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a906d2b41e82262cc702fedac99e88906">00735</a>             <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*              <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a906d2b41e82262cc702fedac99e88906">findbest</a>()
<a name="l00736"></a>00736             {
<a name="l00737"></a>00737                 <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*      <a class="code" href="../../dd/d06/BLI__math__base_8h.html#a6662c4add3c6f2e4b3a5ab8526d0fb67">minf</a>=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>.<a class="code" href="../../d2/d60/structgjkepa2__impl_1_1EPA_1_1sList.html#a856f35452ebca0df771601426fcbb4d6">root</a>;
<a name="l00738"></a>00738                 <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    mind=minf-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>*minf-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>;
<a name="l00739"></a>00739                 <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    maxp=minf-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>;
<a name="l00740"></a>00740                 <span class="keywordflow">for</span>(<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>* f=minf-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abba40edc9397fe52ba4ea37c85e166e3">l</a>[1];f;f=f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abba40edc9397fe52ba4ea37c85e166e3">l</a>[1])
<a name="l00741"></a>00741                 {
<a name="l00742"></a>00742                     <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  sqd=f-&gt;d*f-&gt;d;
<a name="l00743"></a>00743                     <span class="keywordflow">if</span>((f-&gt;p&gt;=maxp)&amp;&amp;(sqd&lt;mind))
<a name="l00744"></a>00744                     {
<a name="l00745"></a>00745                         minf=f;
<a name="l00746"></a>00746                         mind=sqd;
<a name="l00747"></a>00747                         maxp=f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a946f348db8bc34351741ed56e3d85252">p</a>;
<a name="l00748"></a>00748                     }
<a name="l00749"></a>00749                 }
<a name="l00750"></a>00750                 <span class="keywordflow">return</span>(minf);
<a name="l00751"></a>00751             }
<a name="l00752"></a><a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a279ea2052f9a7bfc3a1bd5024bb6ad17">00752</a>             <span class="keywordtype">bool</span>                <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a279ea2052f9a7bfc3a1bd5024bb6ad17">expand</a>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> pass,<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html">sSV</a>* w,<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>* f,<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> e,<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html">sHorizon</a>&amp; horizon)
<a name="l00753"></a>00753             {
<a name="l00754"></a>00754                 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>  i1m3[]={1,2,0};
<a name="l00755"></a>00755                 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a>  i2m3[]={2,0,1};
<a name="l00756"></a>00756                 <span class="keywordflow">if</span>(f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a6a0ef1327923a6ac1b8b9a88c36234f8">pass</a>!=pass)
<a name="l00757"></a>00757                 {
<a name="l00758"></a>00758                     <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> e1=i1m3[e];
<a name="l00759"></a>00759                     <span class="keywordflow">if</span>((<a class="code" href="../../d2/dd0/btVector3_8h.html#a550dc4505b1f10c03a685705f41f4011" title="Return the dot product between two vectors.">btDot</a>(f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a7242f9c39910b760329d56a846cb2084">n</a>,w-&gt;<a class="code" href="../../df/dc3/structgjkepa2__impl_1_1GJK_1_1sSV.html#abdd688f396857f3993703df93fdcae56">w</a>)-f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a5aa2572578985a659d54766dd230f0b6">d</a>)&lt;-<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a8c8917e22455518087d7888491543529">EPA_PLANE_EPS</a>)
<a name="l00760"></a>00760                     {
<a name="l00761"></a>00761                         <a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html">sFace</a>*  nf=<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ac01d46e7801045987e4c7b46f6d08e1d">newface</a>(f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[e1],f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#abde121ff9ab6e987af62d201f4e11b4b">c</a>[e],w,<span class="keyword">false</span>);
<a name="l00762"></a>00762                         <span class="keywordflow">if</span>(nf)
<a name="l00763"></a>00763                         {
<a name="l00764"></a>00764                             <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(nf,0,f,e);
<a name="l00765"></a>00765                             <span class="keywordflow">if</span>(horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a7c99c9a25b25fe45e7789bea49e3c863">cf</a>) <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ad9740a2ff2bd6d01b3bc4440c0391665">bind</a>(horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a7c99c9a25b25fe45e7789bea49e3c863">cf</a>,1,nf,2); <span class="keywordflow">else</span> horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#adbcd006a25dfd9a3057d51b0839f0488">ff</a>=nf;
<a name="l00766"></a>00766                             horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a7c99c9a25b25fe45e7789bea49e3c863">cf</a>=nf;
<a name="l00767"></a>00767                             ++horizon.<a class="code" href="../../d0/dc0/structgjkepa2__impl_1_1EPA_1_1sHorizon.html#a2a65f3e810f41fa36e15c36eeb0f83c3">nf</a>;
<a name="l00768"></a>00768                             <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00769"></a>00769                         }
<a name="l00770"></a>00770                     }
<a name="l00771"></a>00771                     <span class="keywordflow">else</span>
<a name="l00772"></a>00772                     {
<a name="l00773"></a>00773                         <span class="keyword">const</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> e2=i2m3[e];
<a name="l00774"></a>00774                         f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a6a0ef1327923a6ac1b8b9a88c36234f8">pass</a>     =   (<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a71d72754cfaa5b6625d1ee78c3d6c7f4">U1</a>)pass;
<a name="l00775"></a>00775                         <span class="keywordflow">if</span>( <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a279ea2052f9a7bfc3a1bd5024bb6ad17">expand</a>(pass,w,f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a8e66ed87024afa716eea0cb6aaf75c96">f</a>[e1],f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a81d623f8eca043ad973a9cdd6f791e8a">e</a>[e1],horizon)&amp;&amp;
<a name="l00776"></a>00776                             <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a279ea2052f9a7bfc3a1bd5024bb6ad17">expand</a>(pass,w,f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a8e66ed87024afa716eea0cb6aaf75c96">f</a>[e2],f-&gt;<a class="code" href="../../d9/d7a/structgjkepa2__impl_1_1EPA_1_1sFace.html#a81d623f8eca043ad973a9cdd6f791e8a">e</a>[e2],horizon))
<a name="l00777"></a>00777                         {
<a name="l00778"></a>00778                             <span class="keyword">remove</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab5f509efd64c357fc587136f30242d0e">m_hull</a>,f);
<a name="l00779"></a>00779                             <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#ab2183a53cd62b6227b2294e7864a7c5d">append</a>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#abf546eab1bcce4dce9df72d4d404dce6">m_stock</a>,f);
<a name="l00780"></a>00780                             <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00781"></a>00781                         }
<a name="l00782"></a>00782                     }
<a name="l00783"></a>00783                 }
<a name="l00784"></a>00784                 <span class="keywordflow">return</span>(<span class="keyword">false</span>);
<a name="l00785"></a>00785             }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     };
<a name="l00788"></a>00788 
<a name="l00789"></a>00789     <span class="comment">//</span>
<a name="l00790"></a><a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a430de76f55ad97df44e953bdbd376ee7">00790</a>     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a430de76f55ad97df44e953bdbd376ee7">Initialize</a>( <span class="keyword">const</span> btConvexShape* shape0,<span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp; wtrs0,
<a name="l00791"></a>00791         <span class="keyword">const</span> btConvexShape* shape1,<span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp; wtrs1,
<a name="l00792"></a>00792         <a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html">btGjkEpaSolver2::sResults</a>&amp; results,
<a name="l00793"></a>00793         <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">tShape</a>&amp; shape,
<a name="l00794"></a>00794         <span class="keywordtype">bool</span> withmargins)
<a name="l00795"></a>00795     {
<a name="l00796"></a>00796         <span class="comment">/* Results      */</span> 
<a name="l00797"></a>00797         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[0]    =
<a name="l00798"></a>00798             results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[1]    =   btVector3(0,0,0);
<a name="l00799"></a>00799         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a29cbe2f4110c25bb4897338cdea5ddaf">status</a>          =   <a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#afc87a476b5c94b203dec0b0d2f17e1b7a89f2ab63d5bc2139e6a4f1f886e36b90">btGjkEpaSolver2::sResults::Separated</a>;
<a name="l00800"></a>00800         <span class="comment">/* Shape        */</span> 
<a name="l00801"></a>00801         shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[0]       =   shape0;
<a name="l00802"></a>00802         shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a3d3f5a9789c7184e5adc6f81761bd2c8">m_shapes</a>[1]       =   shape1;
<a name="l00803"></a>00803         shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a6a0374ad6fc23d5fdcb4f50b7fbf457f">m_toshape1</a>        =   wtrs1.<a class="code" href="../../d4/d79/classbtTransform.html#a7fc96ecb7fe7794b6bcd56136bc51053" title="Return the basis matrix for the rotation.">getBasis</a>().<a class="code" href="../../d1/d7d/classbtMatrix3x3.html#acad301963aaf6ab78c6b1a133a8cf2e9">transposeTimes</a>(wtrs0.<a class="code" href="../../d4/d79/classbtTransform.html#a7fc96ecb7fe7794b6bcd56136bc51053" title="Return the basis matrix for the rotation.">getBasis</a>());
<a name="l00804"></a>00804         shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#ad3b88e820bf02ad378bcf7219b6d706e">m_toshape0</a>        =   wtrs0.<a class="code" href="../../d4/d79/classbtTransform.html#a483172465755455b242b6d54bdb3979d" title="Return the inverse of this transform times the other transform.">inverseTimes</a>(wtrs1);
<a name="l00805"></a>00805         shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#a2050c7ca5d9c033d40da2a95ed7efc9d">EnableMargin</a>(withmargins);
<a name="l00806"></a>00806     }
<a name="l00807"></a>00807 
<a name="l00808"></a>00808 }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810 <span class="comment">//</span>
<a name="l00811"></a>00811 <span class="comment">// Api</span>
<a name="l00812"></a>00812 <span class="comment">//</span>
<a name="l00813"></a>00813 
<a name="l00814"></a>00814 <span class="keyword">using namespace </span>gjkepa2_impl;
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 <span class="comment">//</span>
<a name="l00817"></a><a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#aa6d1e7ce16abccf3bbb6b8cd2468e61b">00817</a> <span class="keywordtype">int</span>         <a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#aa6d1e7ce16abccf3bbb6b8cd2468e61b">btGjkEpaSolver2::StackSizeRequirement</a>()
<a name="l00818"></a>00818 {
<a name="l00819"></a>00819     <span class="keywordflow">return</span>(<span class="keyword">sizeof</span>(<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html">GJK</a>)+<span class="keyword">sizeof</span>(<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html">EPA</a>));
<a name="l00820"></a>00820 }
<a name="l00821"></a>00821 
<a name="l00822"></a>00822 <span class="comment">//</span>
<a name="l00823"></a><a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#a687580e208340d8d92baa7a108833a5d">00823</a> <span class="keywordtype">bool</span>        <a class="code" href="../../dc/d4f/rna__nodetree__types_8h.html#a97638ab45770a5bc48ade363ac887c91">btGjkEpaSolver2::Distance</a>(  <span class="keyword">const</span> btConvexShape*    shape0,
<a name="l00824"></a>00824                                       <span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp;        wtrs0,
<a name="l00825"></a>00825                                       <span class="keyword">const</span> btConvexShape*  shape1,
<a name="l00826"></a>00826                                       <span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp;        wtrs1,
<a name="l00827"></a>00827                                       <span class="keyword">const</span> btVector3&amp;      guess,
<a name="l00828"></a>00828                                       <a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html">sResults</a>&amp;             results)
<a name="l00829"></a>00829 {
<a name="l00830"></a>00830     <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">tShape</a>          shape;
<a name="l00831"></a>00831     <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a430de76f55ad97df44e953bdbd376ee7">Initialize</a>(shape0,wtrs0,shape1,wtrs1,results,shape,<span class="keyword">false</span>);
<a name="l00832"></a>00832     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html">GJK</a>             gjk;
<a name="l00833"></a>00833     <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4">GJK::eStatus::_</a> gjk_status=gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aef02ebcb7c4628eea04d9fd6a6a2867a">Evaluate</a>(shape,guess);
<a name="l00834"></a>00834     <span class="keywordflow">if</span>(gjk_status==<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4aaa004846ed212c2cae21e4dd97faab11">GJK::eStatus::Valid</a>)
<a name="l00835"></a>00835     {
<a name="l00836"></a>00836         btVector3   w0=btVector3(0,0,0);
<a name="l00837"></a>00837         btVector3   w1=btVector3(0,0,0);
<a name="l00838"></a>00838         <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;rank;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00839"></a>00839         {
<a name="l00840"></a>00840             <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  <a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>=gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;p[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00841"></a>00841             w0+=shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>( gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;d,0)*<a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>;
<a name="l00842"></a>00842             w1+=shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>(-gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;d,1)*<a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>;
<a name="l00843"></a>00843         }
<a name="l00844"></a>00844         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[0]    =   wtrs0*w0;
<a name="l00845"></a>00845         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[1]    =   wtrs0*w1;
<a name="l00846"></a>00846         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aba3b090b5ecd5197bf241161b373b4af">normal</a>          =   w0-w1;
<a name="l00847"></a>00847         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a5546e8142e330769c8c291827abcf37e">distance</a>        =   results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aba3b090b5ecd5197bf241161b373b4af">normal</a>.length();
<a name="l00848"></a>00848         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aba3b090b5ecd5197bf241161b373b4af">normal</a>          /=  results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a5546e8142e330769c8c291827abcf37e">distance</a>&gt;<a class="code" href="../../d6/d00/btGjkEpa2_8cpp.html#a531b5643d6fbf8bbbbddd4fc6249968f">GJK_MIN_DISTANCE</a>?results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a5546e8142e330769c8c291827abcf37e">distance</a>:1;
<a name="l00849"></a>00849         <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00850"></a>00850     }
<a name="l00851"></a>00851     <span class="keywordflow">else</span>
<a name="l00852"></a>00852     {
<a name="l00853"></a>00853         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a29cbe2f4110c25bb4897338cdea5ddaf">status</a>  =   gjk_status==<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">GJK::eStatus::Inside</a>?
<a name="l00854"></a>00854             sResults::Penetrating   :
<a name="l00855"></a>00855         sResults::GJK_Failed    ;
<a name="l00856"></a>00856         <span class="keywordflow">return</span>(<span class="keyword">false</span>);
<a name="l00857"></a>00857     }
<a name="l00858"></a>00858 }
<a name="l00859"></a>00859 
<a name="l00860"></a>00860 <span class="comment">//</span>
<a name="l00861"></a><a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#a6813bb52592ff84e2fea43285719ba55">00861</a> <span class="keywordtype">bool</span>    <a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#a6813bb52592ff84e2fea43285719ba55">btGjkEpaSolver2::Penetration</a>(   <span class="keyword">const</span> btConvexShape*    shape0,
<a name="l00862"></a>00862                                      <span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp;     wtrs0,
<a name="l00863"></a>00863                                      <span class="keyword">const</span> btConvexShape*   shape1,
<a name="l00864"></a>00864                                      <span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp;     wtrs1,
<a name="l00865"></a>00865                                      <span class="keyword">const</span> btVector3&amp;       guess,
<a name="l00866"></a>00866                                      <a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html">sResults</a>&amp;              results,
<a name="l00867"></a>00867                                      <span class="keywordtype">bool</span>                   usemargins)
<a name="l00868"></a>00868 {
<a name="l00869"></a>00869     <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">tShape</a>          shape;
<a name="l00870"></a>00870     <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a430de76f55ad97df44e953bdbd376ee7">Initialize</a>(shape0,wtrs0,shape1,wtrs1,results,shape,usemargins);
<a name="l00871"></a>00871     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html">GJK</a>             gjk;    
<a name="l00872"></a>00872     <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4">GJK::eStatus::_</a> gjk_status=gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aef02ebcb7c4628eea04d9fd6a6a2867a">Evaluate</a>(shape,-guess);
<a name="l00873"></a>00873     <span class="keywordflow">switch</span>(gjk_status)
<a name="l00874"></a>00874     {
<a name="l00875"></a>00875     <span class="keywordflow">case</span>    <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">GJK::eStatus::Inside</a>:
<a name="l00876"></a>00876         {
<a name="l00877"></a>00877             <a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html">EPA</a>             epa;
<a name="l00878"></a>00878             <a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627be">EPA::eStatus::_</a> epa_status=epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a66edbc762eb8ac621d32f4620a5dfc35">Evaluate</a>(gjk,-guess);
<a name="l00879"></a>00879             <span class="keywordflow">if</span>(epa_status!=<a class="code" href="../../d1/d9e/structgjkepa2__impl_1_1EPA_1_1eStatus.html#a0bc55f16c679e32afbba1952f6a627bea00fe930ee8847e694eb345b74fd55638">EPA::eStatus::Failed</a>)
<a name="l00880"></a>00880             {
<a name="l00881"></a>00881                 btVector3   w0=btVector3(0,0,0);
<a name="l00882"></a>00882                 <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a97bc5764f27917fef42a979f21c1c040">rank</a>;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00883"></a>00883                 {
<a name="l00884"></a>00884                     w0+=shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>(epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a1fb2add7d2c837c16e2369b6c1ca8ff9">c</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;d,0)*epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a38aac942239d780dbf019a5bbd815bba">m_result</a>.<a class="code" href="../../d0/d1f/structgjkepa2__impl_1_1GJK_1_1sSimplex.html#a213f4cdd828ba68282330f2390accfc7">p</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00885"></a>00885                 }
<a name="l00886"></a>00886                 results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a29cbe2f4110c25bb4897338cdea5ddaf">status</a>          =   sResults::Penetrating;
<a name="l00887"></a>00887                 results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[0]    =   wtrs0*w0;
<a name="l00888"></a>00888                 results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[1]    =   wtrs0*(w0-epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>*epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7329b93546644d254bb01193b324f80a">m_depth</a>);
<a name="l00889"></a>00889                 results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aba3b090b5ecd5197bf241161b373b4af">normal</a>          =   -epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a3771e3e7e8e99cbca0e5ce27ef505bd1">m_normal</a>;
<a name="l00890"></a>00890                 results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a5546e8142e330769c8c291827abcf37e">distance</a>        =   -epa.<a class="code" href="../../d5/d23/structgjkepa2__impl_1_1EPA.html#a7329b93546644d254bb01193b324f80a">m_depth</a>;
<a name="l00891"></a>00891                 <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00892"></a>00892             } <span class="keywordflow">else</span> results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a29cbe2f4110c25bb4897338cdea5ddaf">status</a>=sResults::EPA_Failed;
<a name="l00893"></a>00893         }
<a name="l00894"></a>00894         <span class="keywordflow">break</span>;
<a name="l00895"></a>00895     <span class="keywordflow">case</span>    <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4ae74893a2dc706bcec2391c25c403bd5f">GJK::eStatus::Failed</a>:
<a name="l00896"></a>00896         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#a29cbe2f4110c25bb4897338cdea5ddaf">status</a>=sResults::GJK_Failed;
<a name="l00897"></a>00897         <span class="keywordflow">break</span>;
<a name="l00898"></a>00898         <span class="keywordflow">default</span>:
<a name="l00899"></a>00899                     {
<a name="l00900"></a>00900                     }
<a name="l00901"></a>00901     }
<a name="l00902"></a>00902     <span class="keywordflow">return</span>(<span class="keyword">false</span>);
<a name="l00903"></a>00903 }
<a name="l00904"></a>00904 
<a name="l00905"></a>00905 <span class="preprocessor">#ifndef __SPU__</span>
<a name="l00906"></a>00906 <span class="preprocessor"></span><span class="comment">//</span>
<a name="l00907"></a><a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#a01766fb4fe5a5e846228c07c5c947ab3">00907</a> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>    <a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#a01766fb4fe5a5e846228c07c5c947ab3">btGjkEpaSolver2::SignedDistance</a>(<span class="keyword">const</span> btVector3&amp; position,
<a name="l00908"></a>00908                                             <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a> margin,
<a name="l00909"></a>00909                                             <span class="keyword">const</span> btConvexShape* shape0,
<a name="l00910"></a>00910                                             <span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp; wtrs0,
<a name="l00911"></a>00911                                             <a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html">sResults</a>&amp; results)
<a name="l00912"></a>00912 {
<a name="l00913"></a>00913     <a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html">tShape</a>          shape;
<a name="l00914"></a>00914     btSphereShape   shape1(margin);
<a name="l00915"></a>00915     <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>     wtrs1(<a class="code" href="../../d2/d33/classbtQuaternion.html" title="The btQuaternion implements quaternion to perform linear algebra rotations in combination with btMatr...">btQuaternion</a>(0,0,0,1),position);
<a name="l00916"></a>00916     <a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a430de76f55ad97df44e953bdbd376ee7">Initialize</a>(shape0,wtrs0,&amp;shape1,wtrs1,results,shape,<span class="keyword">false</span>);
<a name="l00917"></a>00917     <a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html">GJK</a>             gjk;    
<a name="l00918"></a>00918     <a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4">GJK::eStatus::_</a> gjk_status=gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#aef02ebcb7c4628eea04d9fd6a6a2867a">Evaluate</a>(shape,btVector3(1,1,1));
<a name="l00919"></a>00919     <span class="keywordflow">if</span>(gjk_status==<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4aaa004846ed212c2cae21e4dd97faab11">GJK::eStatus::Valid</a>)
<a name="l00920"></a>00920     {
<a name="l00921"></a>00921         btVector3   w0=btVector3(0,0,0);
<a name="l00922"></a>00922         btVector3   w1=btVector3(0,0,0);
<a name="l00923"></a>00923         <span class="keywordflow">for</span>(<a class="code" href="../../d0/de2/namespacegjkepa2__impl.html#a6d41857f051fae50b68076f99f439398">U</a> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;rank;++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l00924"></a>00924         {
<a name="l00925"></a>00925             <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  <a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>=gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;p[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];
<a name="l00926"></a>00926             w0+=shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>( gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;d,0)*<a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>;
<a name="l00927"></a>00927             w1+=shape.<a class="code" href="../../d0/d6e/structgjkepa2__impl_1_1MinkowskiDiff.html#abc85c35313d9cf02f57ca63f25b9be3a">Support</a>(-gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a4fcd4e88e5c7cb66dd29d86884602e15">m_simplex</a>-&gt;c[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;d,1)*<a class="code" href="../../dd/d05/noise_8c.html#aa5b68af6f39f968261f8942af260e938">p</a>;
<a name="l00928"></a>00928         }
<a name="l00929"></a>00929         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[0]    =   wtrs0*w0;
<a name="l00930"></a>00930         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[1]    =   wtrs0*w1;
<a name="l00931"></a>00931         <span class="keyword">const</span> btVector3 delta=  results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[1]-
<a name="l00932"></a>00932             results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[0];
<a name="l00933"></a>00933         <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  margin= shape0-&gt;getMarginNonVirtual()+
<a name="l00934"></a>00934             shape1.getMarginNonVirtual();
<a name="l00935"></a>00935         <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  <a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>= delta.length(); 
<a name="l00936"></a>00936         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aba3b090b5ecd5197bf241161b373b4af">normal</a>          =   delta/<a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>;
<a name="l00937"></a>00937         results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[0]    +=  results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aba3b090b5ecd5197bf241161b373b4af">normal</a>*margin;
<a name="l00938"></a>00938         <span class="keywordflow">return</span>(length-margin);
<a name="l00939"></a>00939     }
<a name="l00940"></a>00940     <span class="keywordflow">else</span>
<a name="l00941"></a>00941     {
<a name="l00942"></a>00942         <span class="keywordflow">if</span>(gjk_status==<a class="code" href="../../d0/d04/structgjkepa2__impl_1_1GJK_1_1eStatus.html#a56e8a322d66d3609e32ab2ec93725af4a9360555ef1edf22cd50c5ae10e9ab0cb">GJK::eStatus::Inside</a>)
<a name="l00943"></a>00943         {
<a name="l00944"></a>00944             <span class="keywordflow">if</span>(Penetration(shape0,wtrs0,&amp;shape1,wtrs1,gjk.<a class="code" href="../../d5/d38/structgjkepa2__impl_1_1GJK.html#a8b7dead4b7fe812a502d5faeca7f944b">m_ray</a>,results))
<a name="l00945"></a>00945             {
<a name="l00946"></a>00946                 <span class="keyword">const</span> btVector3 delta=  results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[0]-
<a name="l00947"></a>00947                     results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aa9a1768be83dc3ef5ce1b4857f78058d">witnesses</a>[1];
<a name="l00948"></a>00948                 <span class="keyword">const</span> <a class="code" href="../../d0/d6b/btScalar_8h.html#a1e5824cfc8adbf5a77f2622132d16018" title="The btScalar type abstracts floating point numbers, to easily switch between double and single floati...">btScalar</a>  <a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>= delta.length();
<a name="l00949"></a>00949                 <span class="keywordflow">if</span> (length &gt;= <a class="code" href="../../d0/d6b/btScalar_8h.html#ae51eef6845bd59f964c1b2dbfe7054b7">SIMD_EPSILON</a>)
<a name="l00950"></a>00950                     results.<a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html#aba3b090b5ecd5197bf241161b373b4af">normal</a>  =   delta/<a class="code" href="../../d1/d22/stdosl_8h.html#a939ad05d43eeb38dcadd8218e52d9648">length</a>;           
<a name="l00951"></a>00951                 <span class="keywordflow">return</span>(-length);
<a name="l00952"></a>00952             }
<a name="l00953"></a>00953         }   
<a name="l00954"></a>00954     }
<a name="l00955"></a>00955     <span class="keywordflow">return</span>(<a class="code" href="../../d0/d6b/btScalar_8h.html#a87dcd463392e45ddb5350989e566f34a">SIMD_INFINITY</a>);
<a name="l00956"></a>00956 }
<a name="l00957"></a>00957 
<a name="l00958"></a>00958 <span class="comment">//</span>
<a name="l00959"></a><a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#ae14d4dcf29d472f8fd47d4e5a74f7e00">00959</a> <span class="keywordtype">bool</span>    <a class="code" href="../../d5/d06/structbtGjkEpaSolver2.html#a01766fb4fe5a5e846228c07c5c947ab3">btGjkEpaSolver2::SignedDistance</a>(<span class="keyword">const</span> btConvexShape*    shape0,
<a name="l00960"></a>00960                                         <span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp;      wtrs0,
<a name="l00961"></a>00961                                         <span class="keyword">const</span> btConvexShape*    shape1,
<a name="l00962"></a>00962                                         <span class="keyword">const</span> <a class="code" href="../../d4/d79/classbtTransform.html" title="The btTransform class supports rigid transforms with only translation and rotation and no scaling/she...">btTransform</a>&amp;      wtrs1,
<a name="l00963"></a>00963                                         <span class="keyword">const</span> btVector3&amp;        guess,
<a name="l00964"></a>00964                                         <a class="code" href="../../d5/d40/structbtGjkEpaSolver2_1_1sResults.html">sResults</a>&amp;               results)
<a name="l00965"></a>00965 {
<a name="l00966"></a>00966     <span class="keywordflow">if</span>(!<a class="code" href="../../dc/d4f/rna__nodetree__types_8h.html#a97638ab45770a5bc48ade363ac887c91">Distance</a>(shape0,wtrs0,shape1,wtrs1,guess,results))
<a name="l00967"></a>00967         <span class="keywordflow">return</span>(Penetration(shape0,wtrs0,shape1,wtrs1,guess,results,<span class="keyword">false</span>));
<a name="l00968"></a>00968     <span class="keywordflow">else</span>
<a name="l00969"></a>00969         <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00970"></a>00970 }
<a name="l00971"></a>00971 <span class="preprocessor">#endif //__SPU__</span>
<a name="l00972"></a>00972 <span class="preprocessor"></span>
<a name="l00973"></a>00973 <span class="comment">/* Symbols cleanup      */</span> 
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 <span class="preprocessor">#undef GJK_MAX_ITERATIONS</span>
<a name="l00976"></a>00976 <span class="preprocessor"></span><span class="preprocessor">#undef GJK_ACCURARY</span>
<a name="l00977"></a>00977 <span class="preprocessor"></span><span class="preprocessor">#undef GJK_MIN_DISTANCE</span>
<a name="l00978"></a>00978 <span class="preprocessor"></span><span class="preprocessor">#undef GJK_DUPLICATED_EPS</span>
<a name="l00979"></a>00979 <span class="preprocessor"></span><span class="preprocessor">#undef GJK_SIMPLEX2_EPS</span>
<a name="l00980"></a>00980 <span class="preprocessor"></span><span class="preprocessor">#undef GJK_SIMPLEX3_EPS</span>
<a name="l00981"></a>00981 <span class="preprocessor"></span><span class="preprocessor">#undef GJK_SIMPLEX4_EPS</span>
<a name="l00982"></a>00982 <span class="preprocessor"></span>
<a name="l00983"></a>00983 <span class="preprocessor">#undef EPA_MAX_VERTICES</span>
<a name="l00984"></a>00984 <span class="preprocessor"></span><span class="preprocessor">#undef EPA_MAX_FACES</span>
<a name="l00985"></a>00985 <span class="preprocessor"></span><span class="preprocessor">#undef EPA_MAX_ITERATIONS</span>
<a name="l00986"></a>00986 <span class="preprocessor"></span><span class="preprocessor">#undef EPA_ACCURACY</span>
<a name="l00987"></a>00987 <span class="preprocessor"></span><span class="preprocessor">#undef EPA_FALLBACK</span>
<a name="l00988"></a>00988 <span class="preprocessor"></span><span class="preprocessor">#undef EPA_PLANE_EPS</span>
<a name="l00989"></a>00989 <span class="preprocessor"></span><span class="preprocessor">#undef EPA_INSIDE_EPS</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:08 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
