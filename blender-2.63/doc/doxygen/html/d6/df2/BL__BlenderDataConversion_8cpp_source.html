<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: BL_BlenderDataConversion.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">BL_BlenderDataConversion.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../d6/df2/BL__BlenderDataConversion_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2001-2002 by NaN Holding BV.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * The Original Code is: all of this file.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * Contributor(s): none yet.</span>
<a name="l00024"></a>00024 <span class="comment"> *</span>
<a name="l00025"></a>00025 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00026"></a>00026 <span class="comment"> * Convert blender data to ketsji</span>
<a name="l00027"></a>00027 <span class="comment"> */</span>
<a name="l00028"></a>00028 
<a name="l00034"></a>00034 <span class="preprocessor">#if defined(WIN32) &amp;&amp; !defined(FREE_WINDOWS)</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#pragma warning (disable : 4786)</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d98/BL__BlenderDataConversion_8h.html">BL_BlenderDataConversion.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d77/KX__BlenderGL_8h.html">KX_BlenderGL.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d2c/KX__BlenderScalarInterpolator_8h.html">KX_BlenderScalarInterpolator.h</a>&quot;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/da4/RAS__IPolygonMaterial_8h.html">RAS_IPolygonMaterial.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../da/da5/KX__PolygonMaterial_8h.html">KX_PolygonMaterial.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="comment">// Expressions</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/db8/ListValue_8h.html">ListValue.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d3c/IntValue_8h.html">IntValue.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="comment">// Collision &amp; Fuzzics LTD</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d49/PHY__Pro_8h.html">PHY_Pro.h</a>&quot;</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da5/KX__Scene_8h.html">KX_Scene.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/dc5/KX__GameObject_8h.html" title="General KX game object.">KX_GameObject.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../da/da6/RAS__FramingManager_8h.html">RAS_FramingManager.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d62/RAS__MeshObject_8h.html">RAS_MeshObject.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d7d/KX__ConvertActuators_8h.html">KX_ConvertActuators.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d37/KX__ConvertControllers_8h.html">KX_ConvertControllers.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../da/df6/KX__ConvertSensors_8h.html">KX_ConvertSensors.h</a>&quot;</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d03/SCA__LogicManager_8h.html">SCA_LogicManager.h</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d74/SCA__EventManager_8h.html">SCA_EventManager.h</a>&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/dcc/SCA__TimeEventManager_8h.html">SCA_TimeEventManager.h</a>&quot;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d58/KX__Light_8h.html">KX_Light.h</a>&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d17/KX__Camera_8h.html" title="Camera in the gameengine. Cameras are also used for views.">KX_Camera.h</a>&quot;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d7c/KX__EmptyObject_8h.html">KX_EmptyObject.h</a>&quot;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d81/KX__FontObject_8h.html">KX_FontObject.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d73/MT__Point3_8h.html">MT_Point3.h</a>&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d0d/MT__Transform_8h.html">MT_Transform.h</a>&quot;</span>
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d95/MT__MinMax_8h.html">MT_MinMax.h</a>&quot;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d24/SCA__IInputDevice_8h.html">SCA_IInputDevice.h</a>&quot;</span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/da4/RAS__TexMatrix_8h.html">RAS_TexMatrix.h</a>&quot;</span>
<a name="l00076"></a>00076 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/ded/RAS__ICanvas_8h.html">RAS_ICanvas.h</a>&quot;</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d6d/RAS__MaterialBucket_8h.html">RAS_MaterialBucket.h</a>&quot;</span>
<a name="l00078"></a>00078 <span class="comment">//#include &quot;KX_BlenderPolyMaterial.h&quot;</span>
<a name="l00079"></a>00079 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/da9/RAS__Polygon_8h.html">RAS_Polygon.h</a>&quot;</span>
<a name="l00080"></a>00080 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d02/RAS__TexVert_8h.html">RAS_TexVert.h</a>&quot;</span>
<a name="l00081"></a>00081 <span class="preprocessor">#include &quot;<a class="code" href="../../db/dfd/RAS__BucketManager_8h.html">RAS_BucketManager.h</a>&quot;</span>
<a name="l00082"></a>00082 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/df5/RAS__IRenderTools_8h.html">RAS_IRenderTools.h</a>&quot;</span>
<a name="l00083"></a>00083 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4a/BL__Material_8h.html">BL_Material.h</a>&quot;</span>
<a name="l00084"></a>00084 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d9b/KX__BlenderMaterial_8h.html">KX_BlenderMaterial.h</a>&quot;</span>
<a name="l00085"></a>00085 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dbb/BL__Texture_8h.html">BL_Texture.h</a>&quot;</span>
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d2a/DNA__action__types_8h.html">DNA_action_types.h</a>&quot;</span>
<a name="l00088"></a>00088 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00089"></a>00089 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00090"></a>00090 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dac/BKE__object_8h.html" title="General operations, lookup, etc. for blender objects.">BKE_object.h</a>&quot;</span>
<a name="l00091"></a>00091 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d60/BL__ModifierDeformer_8h.html">BL_ModifierDeformer.h</a>&quot;</span>
<a name="l00092"></a>00092 <span class="preprocessor">#include &quot;<a class="code" href="../../df/de6/BL__ShapeDeformer_8h.html">BL_ShapeDeformer.h</a>&quot;</span>
<a name="l00093"></a>00093 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/dda/BL__SkinDeformer_8h.html">BL_SkinDeformer.h</a>&quot;</span>
<a name="l00094"></a>00094 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d05/BL__MeshDeformer_8h.html">BL_MeshDeformer.h</a>&quot;</span>
<a name="l00095"></a>00095 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d70/KX__SoftBodyDeformer_8h.html">KX_SoftBodyDeformer.h</a>&quot;</span>
<a name="l00096"></a>00096 <span class="comment">//#include &quot;BL_ArmatureController.h&quot;</span>
<a name="l00097"></a>00097 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00098"></a>00098 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/db5/BlenderWorldInfo_8h.html">BlenderWorldInfo.h</a>&quot;</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/de7/KX__KetsjiEngine_8h.html">KX_KetsjiEngine.h</a>&quot;</span>
<a name="l00101"></a>00101 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dc5/KX__BlenderSceneConverter_8h.html">KX_BlenderSceneConverter.h</a>&quot;</span>
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="comment">/* This little block needed for linking to Blender... */</span>
<a name="l00104"></a>00104 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="../../d9/ded/BLI__winstuff_8h.html" title="Compatibility-like things for windows.">BLI_winstuff.h</a>&quot;</span>
<a name="l00106"></a>00106 <span class="preprocessor">#endif</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span>
<a name="l00108"></a>00108 <span class="comment">/* This list includes only data type definitions */</span>
<a name="l00109"></a>00109 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00110"></a>00110 <span class="preprocessor">#include &quot;<a class="code" href="../../de/db2/DNA__material__types_8h.html">DNA_material_types.h</a>&quot;</span>
<a name="l00111"></a>00111 <span class="preprocessor">#include &quot;<a class="code" href="../../da/ddf/DNA__texture__types_8h.html">DNA_texture_types.h</a>&quot;</span>
<a name="l00112"></a>00112 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d94/DNA__image__types_8h.html">DNA_image_types.h</a>&quot;</span>
<a name="l00113"></a>00113 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html">DNA_lamp_types.h</a>&quot;</span>
<a name="l00114"></a>00114 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d75/DNA__group__types_8h.html">DNA_group_types.h</a>&quot;</span>
<a name="l00115"></a>00115 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00116"></a>00116 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d3b/DNA__camera__types_8h.html">DNA_camera_types.h</a>&quot;</span>
<a name="l00117"></a>00117 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d2b/DNA__property__types_8h.html">DNA_property_types.h</a>&quot;</span>
<a name="l00118"></a>00118 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d71/DNA__text__types_8h.html">DNA_text_types.h</a>&quot;</span>
<a name="l00119"></a>00119 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dc4/DNA__sensor__types_8h.html">DNA_sensor_types.h</a>&quot;</span>
<a name="l00120"></a>00120 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d3e/DNA__controller__types_8h.html">DNA_controller_types.h</a>&quot;</span>
<a name="l00121"></a>00121 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/de2/DNA__actuator__types_8h.html">DNA_actuator_types.h</a>&quot;</span>
<a name="l00122"></a>00122 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d96/DNA__mesh__types_8h.html">DNA_mesh_types.h</a>&quot;</span>
<a name="l00123"></a>00123 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d36/DNA__meshdata__types_8h.html">DNA_meshdata_types.h</a>&quot;</span>
<a name="l00124"></a>00124 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d06/DNA__view3d__types_8h.html">DNA_view3d_types.h</a>&quot;</span>
<a name="l00125"></a>00125 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d3b/DNA__world__types_8h.html">DNA_world_types.h</a>&quot;</span>
<a name="l00126"></a>00126 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d66/DNA__sound__types_8h.html">DNA_sound_types.h</a>&quot;</span>
<a name="l00127"></a>00127 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d41/DNA__key__types_8h.html">DNA_key_types.h</a>&quot;</span>
<a name="l00128"></a>00128 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d93/DNA__armature__types_8h.html">DNA_armature_types.h</a>&quot;</span>
<a name="l00129"></a>00129 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d60/DNA__object__force_8h.html">DNA_object_force.h</a>&quot;</span>
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d17/BKE__key_8h.html">BKE_key.h</a>&quot;</span>
<a name="l00134"></a>00134 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d7f/BKE__mesh_8h.html">BKE_mesh.h</a>&quot;</span>
<a name="l00135"></a>00135 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d73/MT__Point3_8h.html">MT_Point3.h</a>&quot;</span>
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00140"></a>00140 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d53/BKE__scene_8h.html">BKE_scene.h</a>&quot;</span>
<a name="l00141"></a>00141 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d5e/BKE__customdata_8h.html" title="CustomData interface, see also DNA_customdata_types.h.">BKE_customdata.h</a>&quot;</span>
<a name="l00142"></a>00142 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html">BKE_cdderivedmesh.h</a>&quot;</span>
<a name="l00143"></a>00143 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d7f/BKE__DerivedMesh_8h.html">BKE_DerivedMesh.h</a>&quot;</span>
<a name="l00144"></a>00144 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d0f/BKE__material_8h.html" title="General operations, lookup, etc. for materials.">BKE_material.h</a>&quot;</span> <span class="comment">/* give_current_material */</span>
<a name="l00145"></a>00145 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d77/BKE__image_8h.html">BKE_image.h</a>&quot;</span>
<a name="l00146"></a>00146 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc9/IMB__imbuf__types_8h.html" title="Contains defines and structs used throughout the imbuf module.">IMB_imbuf_types.h</a>&quot;</span>
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="keyword">extern</span> <a class="code" href="../../d2/d10/structMaterial.html">Material</a> <a class="code" href="../../de/d87/material_8c.html#a685518354e9af381cf9881b703cad017">defmaterial</a>;    <span class="comment">/* material.c */</span>
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 <span class="comment">/* end of blender include block */</span>
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/db0/KX__BlenderInputDevice_8h.html">KX_BlenderInputDevice.h</a>&quot;</span>
<a name="l00154"></a>00154 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d8a/KX__ConvertProperties_8h.html">KX_ConvertProperties.h</a>&quot;</span>
<a name="l00155"></a>00155 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d4b/KX__HashedPtr_8h.html">KX_HashedPtr.h</a>&quot;</span>
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d27/KX__ScalarInterpolator_8h.html">KX_ScalarInterpolator.h</a>&quot;</span>
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/de6/KX__IpoConvert_8h.html">KX_IpoConvert.h</a>&quot;</span>
<a name="l00161"></a>00161 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d4a/BL__System_8h.html">BL_System.h</a>&quot;</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d3b/SG__Node_8h.html">SG_Node.h</a>&quot;</span>
<a name="l00164"></a>00164 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/dfb/SG__BBox_8h.html" title="Bounding Box.">SG_BBox.h</a>&quot;</span>
<a name="l00165"></a>00165 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d19/SG__Tree_8h.html">SG_Tree.h</a>&quot;</span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html">KX_ConvertPhysicsObject.h</a>&quot;</span>
<a name="l00168"></a>00168 <span class="preprocessor">#ifdef USE_BULLET</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="../../da/d4a/CcdPhysicsEnvironment_8h.html">CcdPhysicsEnvironment.h</a>&quot;</span>
<a name="l00170"></a>00170 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/de0/CcdGraphicController_8h.html">CcdGraphicController.h</a>&quot;</span>
<a name="l00171"></a>00171 <span class="preprocessor">#endif</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d8c/KX__MotionState_8h.html">KX_MotionState.h</a>&quot;</span>
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 <span class="comment">// This file defines relationships between parents and children</span>
<a name="l00175"></a>00175 <span class="comment">// in the game engine.</span>
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dca/KX__SG__NodeRelationships_8h.html">KX_SG_NodeRelationships.h</a>&quot;</span>
<a name="l00178"></a>00178 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d4d/KX__SG__BoneParentNodeRelationship_8h.html">KX_SG_BoneParentNodeRelationship.h</a>&quot;</span>
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d2a/BL__ArmatureObject_8h.html">BL_ArmatureObject.h</a>&quot;</span>
<a name="l00181"></a>00181 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/de4/BL__DeformableGameObject_8h.html">BL_DeformableGameObject.h</a>&quot;</span>
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/dc7/KX__NavMeshObject_8h.html">KX_NavMeshObject.h</a>&quot;</span>
<a name="l00184"></a>00184 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dbc/KX__ObstacleSimulation_8h.html">KX_ObstacleSimulation.h</a>&quot;</span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00187"></a>00187 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00188"></a>00188 <span class="preprocessor">#endif</span>
<a name="l00189"></a>00189 <span class="preprocessor"></span><span class="comment">//XXX #include &quot;BSE_headerbuttons.h&quot;</span>
<a name="l00190"></a>00190 <span class="comment">//XXX void update_for_newframe();</span>
<a name="l00191"></a>00191 <span class="comment">//void scene_update_for_newframe(struct Scene *sce, unsigned int lay);</span>
<a name="l00192"></a>00192 <span class="comment">//#include &quot;BKE_ipo.h&quot;</span>
<a name="l00193"></a>00193 <span class="comment">//void do_all_data_ipos(void);</span>
<a name="l00194"></a>00194 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span>}
<a name="l00196"></a>00196 <span class="preprocessor">#endif</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span>
<a name="l00198"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a355807bfa0fd16a65e29a0c50714bac6">00198</a> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a355807bfa0fd16a65e29a0c50714bac6">default_light_mode</a> = 0;
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af79a8b0161edc21bf8c6abacc8163783">00200</a> <span class="keyword">static</span> std::map&lt;int, SCA_IInputDevice::KX_EnumInputs&gt; <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af79a8b0161edc21bf8c6abacc8163783">create_translate_table</a>()
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202     std::map&lt;int, SCA_IInputDevice::KX_EnumInputs&gt; m;
<a name="l00203"></a>00203         
<a name="l00204"></a>00204     <span class="comment">/* The reverse table. In order to not confuse ourselves, we      */</span>
<a name="l00205"></a>00205     <span class="comment">/* immediately convert all events that come in to KX codes.      */</span>
<a name="l00206"></a>00206     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>         ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa072c180f6c11005a97395696c01dd829">SCA_IInputDevice::KX_LEFTMOUSE</a>;
<a name="l00207"></a>00207     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a64d06d50176bcded7e70cd4ebbce0e12">MIDDLEMOUSE</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa3084e409142f350c38c383da7d6b9bba">SCA_IInputDevice::KX_MIDDLEMOUSE</a>;
<a name="l00208"></a>00208     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#adc87b609a6285a24e23172a90734044c">RIGHTMOUSE</a>        ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7b98cb86744852596b18f594f5c07c58">SCA_IInputDevice::KX_RIGHTMOUSE</a>;
<a name="l00209"></a>00209     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae58fa49252a1cf05799ab21592491a30">WHEELUPMOUSE</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaae1eb73fe1795a5d53b085455d0b81a3a">SCA_IInputDevice::KX_WHEELUPMOUSE</a>;
<a name="l00210"></a>00210     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a2ffb32901b9678d9b738e618330f60c0">WHEELDOWNMOUSE</a>    ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaabc34b929bac0a44343815392ea6b2cb7">SCA_IInputDevice::KX_WHEELDOWNMOUSE</a>;
<a name="l00211"></a>00211     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a463b518d1bb06480753f0ce4eec9744c">MOUSEX</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa6a0c547d905bea97ca35a32da2fc9c04">SCA_IInputDevice::KX_MOUSEX</a>;
<a name="l00212"></a>00212     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#afa852cd657d63f893daafc3cc8787cd5">MOUSEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac30075b812be0319d8ca277dc0dda896">SCA_IInputDevice::KX_MOUSEY</a>;
<a name="l00213"></a>00213         
<a name="l00214"></a>00214     <span class="comment">// TIMERS                                                                                                  </span>
<a name="l00215"></a>00215         
<a name="l00216"></a>00216     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#af1b746ba5ab7d0ab657156ebda0f290c">TIMER0</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa1a89bc7652e5d71313bd76eea6a7850f">SCA_IInputDevice::KX_TIMER0</a>;                  
<a name="l00217"></a>00217     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a63bf4f24c85f26e838f55701a5e69831">TIMER1</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa9774bd660e961934674b5f70b1b52ab0">SCA_IInputDevice::KX_TIMER1</a>;                  
<a name="l00218"></a>00218     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aca904d0e4ebb6d643c349f7f05613995">TIMER2</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaad764e3a2109cb74d566f56c4c0b2571d">SCA_IInputDevice::KX_TIMER2</a>;                  
<a name="l00219"></a>00219         
<a name="l00220"></a>00220     <span class="comment">// SYSTEM                                                                                                  </span>
<a name="l00221"></a>00221         
<a name="l00222"></a>00222 <span class="preprocessor">#if 0           </span>
<a name="l00223"></a>00223 <span class="preprocessor"></span>    <span class="comment">/* **** XXX **** */</span>
<a name="l00224"></a>00224     m[KEYBD             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa77f92356e0b1afb9b04bba613ae2bbbe">SCA_IInputDevice::KX_KEYBD</a>;                  
<a name="l00225"></a>00225     m[RAWKEYBD          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaab92d917c294319a1a981bcdcabacd63f">SCA_IInputDevice::KX_RAWKEYBD</a>;                  
<a name="l00226"></a>00226     m[REDRAW            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7868da410cfc8080d77e1cb268af509c">SCA_IInputDevice::KX_REDRAW</a>;                  
<a name="l00227"></a>00227     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a20e6f451fd9c644502fd93f11d0301c1">INPUTCHANGE</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa26e6b5e46f9da6bb7d7b26aa52f41148">SCA_IInputDevice::KX_INPUTCHANGE</a>;                  
<a name="l00228"></a>00228     m[QFULL             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa4fc488b1962030c778d9f2be36726c68">SCA_IInputDevice::KX_QFULL</a>;                  
<a name="l00229"></a>00229     m[WINFREEZE         ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa65ff948b34432c8e525a43dcdd7ce28b">SCA_IInputDevice::KX_WINFREEZE</a>;                  
<a name="l00230"></a>00230     m[WINTHAW           ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7163c3beef9ebb906178eb171f3da126">SCA_IInputDevice::KX_WINTHAW</a>;                  
<a name="l00231"></a>00231     m[WINCLOSE          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa0229b72e03d7f578366527b15299d4ed">SCA_IInputDevice::KX_WINCLOSE</a>;                  
<a name="l00232"></a>00232     m[WINQUIT           ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaafa271fd8451a3a7aac84cf658fb9fe2a">SCA_IInputDevice::KX_WINQUIT</a>;                  
<a name="l00233"></a>00233     m[Q_FIRSTTIME       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa3b6c23887781bf3ed0146bd9a0d064ea">SCA_IInputDevice::KX_Q_FIRSTTIME</a>;                  
<a name="l00234"></a>00234     <span class="comment">/* **** XXX **** */</span>
<a name="l00235"></a>00235 <span class="preprocessor">#endif  </span>
<a name="l00236"></a>00236 <span class="preprocessor"></span>        
<a name="l00237"></a>00237     <span class="comment">// standard keyboard                                                                                       </span>
<a name="l00238"></a>00238         
<a name="l00239"></a>00239     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a746a67a50a93dd2cac52c218ef94a218">AKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa3aea8ddfb28b64d45b89e8b2d937fbe9">SCA_IInputDevice::KX_AKEY</a>;                  
<a name="l00240"></a>00240     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a3ec89d7b25cbb572b2e11b10ad8bc196">BKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa9a327268aa67592b22d7a53d87e08fe9">SCA_IInputDevice::KX_BKEY</a>;                  
<a name="l00241"></a>00241     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a39f146afd78004fead59358c29028292">CKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaad618c83a203fcf8e9edc71ff2335a316">SCA_IInputDevice::KX_CKEY</a>;                  
<a name="l00242"></a>00242     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae108a0974a5073bf40514974c1e98028">DKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaadc2fb3dc5cdfe86961b8329c226a1535">SCA_IInputDevice::KX_DKEY</a>;                  
<a name="l00243"></a>00243     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab47f5c869dbeec85e5e133760db3e0d5">EKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa0b7c08f2d38e17a8f32e9a2666e479f1">SCA_IInputDevice::KX_EKEY</a>;                  
<a name="l00244"></a>00244     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae7b7db7df7852dd2feedcbf061c6d609">FKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa08842f0959782193626a9239572a8ff8">SCA_IInputDevice::KX_FKEY</a>;                  
<a name="l00245"></a>00245     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ac4133479f03eb38f20b64e5a1d73ab0a">GKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa71180ac68277c674d5a07b33acd4c75a">SCA_IInputDevice::KX_GKEY</a>;                  
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="comment">//XXX clean up</span>
<a name="l00248"></a>00248 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00249"></a>00249 <span class="preprocessor"></span><span class="preprocessor">#define HKEY    &#39;h&#39;</span>
<a name="l00250"></a>00250 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00251"></a>00251 <span class="preprocessor"></span>    m[<a class="code" href="../../d9/ded/BLI__winstuff_8h.html#a5af76a936eef07cada7df669d90f3341">HKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa5571ae1feb776ece389ee15eb4a7b9ce">SCA_IInputDevice::KX_HKEY</a>;                  
<a name="l00252"></a>00252 <span class="comment">//XXX clean up</span>
<a name="l00253"></a>00253 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00254"></a>00254 <span class="preprocessor"></span><span class="preprocessor">#undef HKEY</span>
<a name="l00255"></a>00255 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span>
<a name="l00257"></a>00257     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a8266bf9b4373825723254f4a186d3de6">IKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa2a945821804d1efc436e6ade66dfe4f9">SCA_IInputDevice::KX_IKEY</a>;                  
<a name="l00258"></a>00258     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a4d89b13f4c91c0fe71ea0e63c6f2c0b1">JKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa5399ed51b3fd1e0ccaacbb3adc9b3ba1">SCA_IInputDevice::KX_JKEY</a>;                  
<a name="l00259"></a>00259     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a08bc6a3adcfad743bcba777bfc5cb5ce">KKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa45092ae3af4ea285067994e2998a1877">SCA_IInputDevice::KX_KKEY</a>;                  
<a name="l00260"></a>00260     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab5e73c4a2145fa76f94d5cf763e2fc98">LKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaafe4531c4757a67c5f0b046ff49d636e0">SCA_IInputDevice::KX_LKEY</a>;                  
<a name="l00261"></a>00261     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a4fd9ef5328e6ef038f4fcc6539405682">MKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaab12ade1a73d3adeb083954493b26807a">SCA_IInputDevice::KX_MKEY</a>;                  
<a name="l00262"></a>00262     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#adee45143f45097e633561db657024e66">NKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaf5c5ce6db685a18f8f4ee4ca203854f0">SCA_IInputDevice::KX_NKEY</a>;                  
<a name="l00263"></a>00263     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ac20849472da73fdbe2fea6acca2b70da">OKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa97492d600aeacd14ef10e48f6e46b559">SCA_IInputDevice::KX_OKEY</a>;                  
<a name="l00264"></a>00264     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a32a9e2b523ec8abcb158c4628f6d0d48">PKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaae4796099d1eea1a02e67c8ba2105a4c8">SCA_IInputDevice::KX_PKEY</a>;                  
<a name="l00265"></a>00265     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a4a864432ec0fec9609cedc8ee4c83f8d">QKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa29c274c5316fe6c550a0606c6832d11f">SCA_IInputDevice::KX_QKEY</a>;                  
<a name="l00266"></a>00266     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a9fb42765696ec2a77dff4bc1267864c3">RKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac4e19cbb60cd8f2ea5475b2b2e9f5f65">SCA_IInputDevice::KX_RKEY</a>;                  
<a name="l00267"></a>00267     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a32a2e419731c7ff93211038f83bb4acc">SKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa0cd9ba0339344b6d987a31fa4269c197">SCA_IInputDevice::KX_SKEY</a>;                  
<a name="l00268"></a>00268     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#af4a805cf5874fafa2a0bd8f959fad04e">TKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaa551d151495bf1efdf158955108a7497">SCA_IInputDevice::KX_TKEY</a>;                  
<a name="l00269"></a>00269     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a7d136ae22613ef0df2eef2eaec226fda">UKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac7e6de5936f179533d847d87edca7fd5">SCA_IInputDevice::KX_UKEY</a>;                  
<a name="l00270"></a>00270     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a8691f4871880a2b71eef19973c0664e1">VKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa6c7cd2494891b23df75ff8919ca25d71">SCA_IInputDevice::KX_VKEY</a>;                  
<a name="l00271"></a>00271     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a72b673275d904736b31f62f6c294c1eb">WKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa3e4bf6ac222dd93e2f86d403ad23a02e">SCA_IInputDevice::KX_WKEY</a>;                  
<a name="l00272"></a>00272     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a16a045703cd7faafcbab3abe5953c4a2">XKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7b5685a46ff76d183ea96f818560132e">SCA_IInputDevice::KX_XKEY</a>;                  
<a name="l00273"></a>00273     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#af58b3779d0b9691c9a871cc1ff0b880c">YKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaa268ff7fde80bd7de2f27214be219218">SCA_IInputDevice::KX_YKEY</a>;                  
<a name="l00274"></a>00274     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a5387e52eccf782cebe3b5eb2ca7655e1">ZKEY</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaad6c8c5bbf31816ad4f0581f361ffabf">SCA_IInputDevice::KX_ZKEY</a>;                  
<a name="l00275"></a>00275         
<a name="l00276"></a>00276     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a18fef1c6c42114045de29186f96e1878">ZEROKEY</a>           ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaafdbe063701ab8a778414a5a25255bbbf">SCA_IInputDevice::KX_ZEROKEY</a>;                  
<a name="l00277"></a>00277     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab9fb6b3cb0a4d451b63de95c43f0c71c">ONEKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa039a5e9d3c106fc45bb58d9cb72e8ad5">SCA_IInputDevice::KX_ONEKEY</a>;                  
<a name="l00278"></a>00278     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a514ead02a18560423d79e5c1e8cdea52">TWOKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaae52fb7dac851e318160047a45faaac06">SCA_IInputDevice::KX_TWOKEY</a>;                  
<a name="l00279"></a>00279     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#afc29e796f859c8e645a294b10c7fe2cb">THREEKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaab53c0bd60e4faab7d313abbf4b0e0a08">SCA_IInputDevice::KX_THREEKEY</a>;                  
<a name="l00280"></a>00280     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a3d15f5dababa2ad8fb0c2a744e0c5207">FOURKEY</a>           ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa0264a45559a2c7893ffc057df866a0e5">SCA_IInputDevice::KX_FOURKEY</a>;                  
<a name="l00281"></a>00281     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a6d42a1643aaa139744c0a9a164622fd2">FIVEKEY</a>           ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa6c2229d4cc6aa5685fcd09fac4bf0688">SCA_IInputDevice::KX_FIVEKEY</a>;                  
<a name="l00282"></a>00282     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab710951e04d672ce9f23292a4d55126b">SIXKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac9c07b68993e77c9da670d84df7b1dd3">SCA_IInputDevice::KX_SIXKEY</a>;                  
<a name="l00283"></a>00283     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a9e76fe8ee785f01500ad44394cd6e66e">SEVENKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7f98ba6f89045fd177d0d74f9696db30">SCA_IInputDevice::KX_SEVENKEY</a>;                  
<a name="l00284"></a>00284     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a27ea2a95deee54dc8c7ce9f9db4b2387">EIGHTKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaadcb74e7a1769622067b2aabefb8c4200">SCA_IInputDevice::KX_EIGHTKEY</a>;                  
<a name="l00285"></a>00285     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a06009c2bd60552b82b76d219409ba513">NINEKEY</a>           ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaafcbc1333ccb9b06b9ef38e9be48a60e1">SCA_IInputDevice::KX_NINEKEY</a>;                  
<a name="l00286"></a>00286         
<a name="l00287"></a>00287     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aeac42513548f4e3068c6e343f968593e">CAPSLOCKKEY</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaab844d8869d07160d06fe9a86444f3a13">SCA_IInputDevice::KX_CAPSLOCKKEY</a>;                  
<a name="l00288"></a>00288         
<a name="l00289"></a>00289     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ad025960542c5698bad7efc649c641897">LEFTCTRLKEY</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa795eec7f3a1bee51d0f6296d93b72762">SCA_IInputDevice::KX_LEFTCTRLKEY</a>;                  
<a name="l00290"></a>00290     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a40ea4d6b0d8ed13cc872f87fb6d4559b">LEFTALTKEY</a>        ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaec39540b29562197e3cc702a0f4e82bd">SCA_IInputDevice::KX_LEFTALTKEY</a>;                  
<a name="l00291"></a>00291     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ac92a400a2afe72bfc979d23307b29a26">RIGHTALTKEY</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaacce16d53446e99d4f799e8083c2bdfaa">SCA_IInputDevice::KX_RIGHTALTKEY</a>;                  
<a name="l00292"></a>00292     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aacc3c8c5f05ebb7eeca8e4da6dc9c969">RIGHTCTRLKEY</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa0b9c8baceb87ebcf310f1de750c420ba">SCA_IInputDevice::KX_RIGHTCTRLKEY</a>;                  
<a name="l00293"></a>00293     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a60ddce316227eaa9586286cca0e085f5">RIGHTSHIFTKEY</a>     ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa5dcb8ed9fcf7c9f6bdc58c930204047c">SCA_IInputDevice::KX_RIGHTSHIFTKEY</a>;                  
<a name="l00294"></a>00294     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a8bb00d0e3bbc5c558edcef2b6c7d549c">LEFTSHIFTKEY</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa2692c6dc190d5a684d7ca849b85d02f3">SCA_IInputDevice::KX_LEFTSHIFTKEY</a>;                  
<a name="l00295"></a>00295         
<a name="l00296"></a>00296     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaadeb7ec25434a754368bb360731c7d98e">SCA_IInputDevice::KX_ESCKEY</a>;                  
<a name="l00297"></a>00297     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a67d5864c4d46748f0c7ee7a4fc30561d">TABKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaef382edcb1936e8f153a11d8c6906ff0">SCA_IInputDevice::KX_TABKEY</a>;                  
<a name="l00298"></a>00298     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a6c861c5ebabe8fe076ed84a2aaa7a1a0">RETKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7bd88a218ffb45ee14031e63c89d48db">SCA_IInputDevice::KX_RETKEY</a>;                  
<a name="l00299"></a>00299     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a59b43db62ffa0d14bb076092d862d2cd">SPACEKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa0d863a18cfeb72a71f539deac3ec91cf">SCA_IInputDevice::KX_SPACEKEY</a>;                  
<a name="l00300"></a>00300     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae3bbf21d063017d4bdc6573327a5d346">LINEFEEDKEY</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa0e38057c9e60c45d3caf46ee9589e1e1">SCA_IInputDevice::KX_LINEFEEDKEY</a>;                  
<a name="l00301"></a>00301     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aac0bf168bc790ab56adc890c4e8580bb">BACKSPACEKEY</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa2498439847fec9a6698bf09eb13b2f26">SCA_IInputDevice::KX_BACKSPACEKEY</a>;                  
<a name="l00302"></a>00302     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#adb5ce1680b5ec047cfc1f0de10f4e3f0">DELKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa75fb5f05463f0baca0b661a56bfd6949">SCA_IInputDevice::KX_DELKEY</a>;                  
<a name="l00303"></a>00303     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a9edb38061f4dd02393b3b6040d5ad0ff">SEMICOLONKEY</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa335273b10f978f0ef8889a12e940cca5">SCA_IInputDevice::KX_SEMICOLONKEY</a>;                  
<a name="l00304"></a>00304     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#af6576ca1700245fc5c150e84b000bc40">PERIODKEY</a>         ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa859ef8908ab03d11f101d724bd878693">SCA_IInputDevice::KX_PERIODKEY</a>;                  
<a name="l00305"></a>00305     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#adf608dfdafc6ae0e69128d9d207f33ed">COMMAKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa4db2e29d12a15c92692ac65df0327b5f">SCA_IInputDevice::KX_COMMAKEY</a>;                  
<a name="l00306"></a>00306     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#abc7ca286a0b3442e2190de6b18757729">QUOTEKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa8067ff1f17f14027c55f7882d4b0d41e">SCA_IInputDevice::KX_QUOTEKEY</a>;                  
<a name="l00307"></a>00307     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a70187f9debfd7574ad1b356e168d4348">ACCENTGRAVEKEY</a>    ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac78e0639ec30dca96a534b64b3de15e4">SCA_IInputDevice::KX_ACCENTGRAVEKEY</a>;                  
<a name="l00308"></a>00308     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a32aa9ced052bfd4e51f37e3f872adfb8">MINUSKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaace1736b64dc516cd539f7260db46d9e">SCA_IInputDevice::KX_MINUSKEY</a>;                  
<a name="l00309"></a>00309     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a5b426a6dc91c359d9930f2054f43c6c7">SLASHKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa74bb71211f7e99cac61c4c252d7c199d">SCA_IInputDevice::KX_SLASHKEY</a>;                  
<a name="l00310"></a>00310     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a02007f618028364a8c4118d8d2d5ff42">BACKSLASHKEY</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa63c316c83f300bb6e7f7681c6a4de8f8">SCA_IInputDevice::KX_BACKSLASHKEY</a>;                  
<a name="l00311"></a>00311     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a6622a89438c3591abe1430569e645a33">EQUALKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaadb5b2d403f4bf618b42e959cbedd2687">SCA_IInputDevice::KX_EQUALKEY</a>;                  
<a name="l00312"></a>00312     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae4a7a1736031c3ddabd4982b98bbb355">LEFTBRACKETKEY</a>    ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac34785166221b3beefdc5064800a8b4b">SCA_IInputDevice::KX_LEFTBRACKETKEY</a>;                  
<a name="l00313"></a>00313     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a65322ad6168f54d2bdbbbc5e392f4db3">RIGHTBRACKETKEY</a>   ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaeb10b8e8e87a5d7e03ccd050985729ad">SCA_IInputDevice::KX_RIGHTBRACKETKEY</a>;                  
<a name="l00314"></a>00314         
<a name="l00315"></a>00315     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a10c4c00065059a135492a87a229162af">LEFTARROWKEY</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7bf9f5d10d9eb34e856d04692e6ff1d0">SCA_IInputDevice::KX_LEFTARROWKEY</a>;                  
<a name="l00316"></a>00316     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab85e7d9e3424f69f61d277f3aa68bff8">DOWNARROWKEY</a>      ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac2b88779b02e50f54b736609506afa4b">SCA_IInputDevice::KX_DOWNARROWKEY</a>;                  
<a name="l00317"></a>00317     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a00226d1726c5da69413ce5e368332f0f">RIGHTARROWKEY</a>     ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaebd8a52ab29c8a4f56c855a9d23414f5">SCA_IInputDevice::KX_RIGHTARROWKEY</a>;                  
<a name="l00318"></a>00318     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#afc161d5211a7975b71b2d478f936ad85">UPARROWKEY</a>        ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa17329ab805f5c83ca61fb85ebfc77024">SCA_IInputDevice::KX_UPARROWKEY</a>;                  
<a name="l00319"></a>00319         
<a name="l00320"></a>00320     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a99e5b4d67a9e666386ddf2101b962d6f">PAD2</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaf12eba2a4bafa5cee8c25a3653066df9">SCA_IInputDevice::KX_PAD2</a>;                  
<a name="l00321"></a>00321     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a59adfc10114409298d29e8a34f9420aa">PAD4</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa43068a142f7e5b4e366e8495fb8a3dfa">SCA_IInputDevice::KX_PAD4</a>;                  
<a name="l00322"></a>00322     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a2b9bf38285d3ef4cc630ba4b1ed1d41c">PAD6</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa5fa6eb2295931301a389200d9712d1f7">SCA_IInputDevice::KX_PAD6</a>;                  
<a name="l00323"></a>00323     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#abbff1efb9138f1ccbe1f01fd17b912d8">PAD8</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa6f22fa56af42d48d7f5ad3577ce8e24b">SCA_IInputDevice::KX_PAD8</a>;                  
<a name="l00324"></a>00324         
<a name="l00325"></a>00325     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a01d2fb85e309555aba53cd538c19e8f6">PAD1</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaabef70149ee39834594c640cf19adc91f">SCA_IInputDevice::KX_PAD1</a>;                  
<a name="l00326"></a>00326     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ad219dd30c4b1c517b3ded1a3da26018f">PAD3</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa41d73de3f03eaa0e7d3dda9fe10419a4">SCA_IInputDevice::KX_PAD3</a>;                  
<a name="l00327"></a>00327     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab1c311ab4886ead1cae73e276ee76371">PAD5</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaffbdfe3295bbe5dfdac05415b942aeaf">SCA_IInputDevice::KX_PAD5</a>;                  
<a name="l00328"></a>00328     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a1cb7f7860cae61be1831169aa1d8ba06">PAD7</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaf3cca455bc37ca3d08a27716ab4e194d">SCA_IInputDevice::KX_PAD7</a>;                  
<a name="l00329"></a>00329     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a4c06e7c1830872541a40dc04cdd2b589">PAD9</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaabb8f2c1e60b9838a314abf39d9e391ed">SCA_IInputDevice::KX_PAD9</a>;                  
<a name="l00330"></a>00330         
<a name="l00331"></a>00331     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab45280c6bf516a0393fb11baf0047244">PADPERIOD</a>         ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa3867d7f39b174ac6ac7269f76896899a">SCA_IInputDevice::KX_PADPERIOD</a>;                  
<a name="l00332"></a>00332     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a5c34cf5cadbf3ffd60ca6b3b8ec14605">PADSLASHKEY</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaae78f39e7f136e0d364da6ffdcdf26ec9">SCA_IInputDevice::KX_PADSLASHKEY</a>;                  
<a name="l00333"></a>00333     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a6c76f316d8f6a531d937567438196037">PADASTERKEY</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa4bb5f8d7de079a3aba6f5a8e57af7ef7">SCA_IInputDevice::KX_PADASTERKEY</a>;                  
<a name="l00334"></a>00334         
<a name="l00335"></a>00335     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a04cfc47c84309660da78fc8a479679c3">PAD0</a>              ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaa44d4e95fe707ae70acd3be81303e3e2">SCA_IInputDevice::KX_PAD0</a>;                  
<a name="l00336"></a>00336     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#af3feb147cfa2676ff6c909a61af4405b">PADMINUS</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa21c0410484fd8ac3a6b22508dd2ceb31">SCA_IInputDevice::KX_PADMINUS</a>;                  
<a name="l00337"></a>00337     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aafdc675e684c8485e8e27c7f2bafcbef">PADENTER</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa65404aa5d4619a4004b27eeb810414e8">SCA_IInputDevice::KX_PADENTER</a>;                  
<a name="l00338"></a>00338     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a58d161b0d7f338f7c6083654a83100d0">PADPLUSKEY</a>        ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaad7dad0073daa86f3dcc63ce9851ca6f8">SCA_IInputDevice::KX_PADPLUSKEY</a>;                  
<a name="l00339"></a>00339         
<a name="l00340"></a>00340         
<a name="l00341"></a>00341     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aa5db595ca499413029c93f3f257eb382">F1KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa06e9af9822c4cfeb29d4ec258e18d98c">SCA_IInputDevice::KX_F1KEY</a>;                  
<a name="l00342"></a>00342     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a6583482591f0023fd58ffc64710f631c">F2KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaadd51cfb12655ed9fdd1830824ebcc6f1">SCA_IInputDevice::KX_F2KEY</a>;                  
<a name="l00343"></a>00343     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a42a44c57b02d9dffa9e9e9a21d54b4cb">F3KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa55a9d89e4404311825cbec7e52630d6d">SCA_IInputDevice::KX_F3KEY</a>;                  
<a name="l00344"></a>00344     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ada55106f7feb2ba8c1012b98771c1054">F4KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa46dc498f222aade01fec13c8ea5e67eb">SCA_IInputDevice::KX_F4KEY</a>;                  
<a name="l00345"></a>00345     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aceea0c28ae73c0fb6b8215f174fa8aef">F5KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa4d12c5dbb4d9cb85e152ed2874641779">SCA_IInputDevice::KX_F5KEY</a>;                  
<a name="l00346"></a>00346     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a8df42a39d3542b2b25411f61cb73a3f2">F6KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa889574b590ccc21c1dd07587f7c493c4">SCA_IInputDevice::KX_F6KEY</a>;                  
<a name="l00347"></a>00347     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae5a175fa28ed777b5d95be7e79c6c9d8">F7KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7eb5f665076bf386fce4cdc1f136e16d">SCA_IInputDevice::KX_F7KEY</a>;                  
<a name="l00348"></a>00348     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a0ff4a866a52dd2ab9c8d008622cb8921">F8KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa507ae426d9db4d8da28a00a9ae55446f">SCA_IInputDevice::KX_F8KEY</a>;                  
<a name="l00349"></a>00349     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aeb09e974f015b6fd5c0898e8a64a51e0">F9KEY</a>             ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaaa4b90845f2edc8ad99e22941eb4ebdb0">SCA_IInputDevice::KX_F9KEY</a>;                  
<a name="l00350"></a>00350     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a2cedce79da84ac047b45ece15ec7fcd4">F10KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaad67d58e23e8d0939456cce2dd151d7b2">SCA_IInputDevice::KX_F10KEY</a>;                  
<a name="l00351"></a>00351     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#adb9995de4225686857d1623600a0b65b">F11KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa720b545fa415b55ad072d44cf4f7ddb6">SCA_IInputDevice::KX_F11KEY</a>;                  
<a name="l00352"></a>00352     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a1ee33b3bc4eec09116f29d4a2ca269d8">F12KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7eba4d167ae96eace9084acc64047b9f">SCA_IInputDevice::KX_F12KEY</a>;
<a name="l00353"></a>00353     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#afe9f04aa26a3885b2e84e577b95a4e6c">F13KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaac8cbc3febcaecf998917f3e6fce5ef2e">SCA_IInputDevice::KX_F13KEY</a>;
<a name="l00354"></a>00354     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a9f1e68770175b7d6ca0e66e6cb603d5b">F14KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa3e13979e5d81cf3f1bb77384fe0ecc68">SCA_IInputDevice::KX_F14KEY</a>;
<a name="l00355"></a>00355     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ac3fadb1fd2031bc2981e4020a2a56fa0">F15KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaacf49418f99dc076965568309aa078f2e">SCA_IInputDevice::KX_F15KEY</a>;
<a name="l00356"></a>00356     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#aad7fa0859b2c284b5aaf59e3bc416b19">F16KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa4f96aab8b81d9a3b61062d4a41cc7a23">SCA_IInputDevice::KX_F16KEY</a>;
<a name="l00357"></a>00357     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#abe76544c5105a36ac803b6702bec488d">F17KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa92b33a2edba3ea252b5459cff940f30e">SCA_IInputDevice::KX_F17KEY</a>;
<a name="l00358"></a>00358     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a89433d7ce1f944bc9c1c498a396faf4a">F18KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa2920087d3cfb8df88efca64365b9f743">SCA_IInputDevice::KX_F18KEY</a>;
<a name="l00359"></a>00359     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a31bc1d396c9451b745cdbbe5e0a55087">F19KEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa41d40a6f3de3b2fd14afda3065fd920c">SCA_IInputDevice::KX_F19KEY</a>;
<a name="l00360"></a>00360         
<a name="l00361"></a>00361         
<a name="l00362"></a>00362     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab6f292e309b6dfeec4680e86cabeeae7">PAUSEKEY</a>          ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa1146160b198505cbc4d1e6c3a053ee0f">SCA_IInputDevice::KX_PAUSEKEY</a>;                  
<a name="l00363"></a>00363     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a4b243137c3e7f898a2a47f69e30c169b">INSERTKEY</a>         ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa245db8b2dbde0d21c350a67fd75af768">SCA_IInputDevice::KX_INSERTKEY</a>;                  
<a name="l00364"></a>00364     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a9ab826a2e86a9ccd0095979fc4726119">HOMEKEY</a>           ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa48a5ca6281cd87738c68b95bb88f66dd">SCA_IInputDevice::KX_HOMEKEY</a>;                  
<a name="l00365"></a>00365     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a2da9bb01ecf11a9818c9f8eb06743237">PAGEUPKEY</a>         ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa7dfb298c36b3b531a4d50ae36a7d9db8">SCA_IInputDevice::KX_PAGEUPKEY</a>;                  
<a name="l00366"></a>00366     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a3864b9574c939049ca9a2cb6523035e8">PAGEDOWNKEY</a>       ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa1ea7c952c17732c0e3bfa31127f3f2f3">SCA_IInputDevice::KX_PAGEDOWNKEY</a>;                  
<a name="l00367"></a>00367     m[<a class="code" href="../../d1/d40/wm__event__types_8h.html#a5ef1f3d0ca3b2e83d0ddefcacceaa4d7">ENDKEY</a>            ] = <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aaa731b9184f5b4d1fd0a4d1fdf5d1e73e7">SCA_IInputDevice::KX_ENDKEY</a>;
<a name="l00368"></a>00368 
<a name="l00369"></a>00369     <span class="keywordflow">return</span> m;
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a3dfe7fa19ac92c26f3f1e1d532a1f9a7">00372</a> <span class="keyword">static</span> std::map&lt;int, SCA_IInputDevice::KX_EnumInputs&gt; <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a3dfe7fa19ac92c26f3f1e1d532a1f9a7">gReverseKeyTranslateTable</a> = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af79a8b0161edc21bf8c6abacc8163783">create_translate_table</a>();
<a name="l00373"></a>00373 
<a name="l00374"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">00374</a> <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> icol)
<a name="l00375"></a>00375 {
<a name="l00376"></a>00376     <span class="keyword">union</span>
<a name="l00377"></a>00377     {
<a name="l00378"></a>00378         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> integer;
<a name="l00379"></a>00379         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cp[4];
<a name="l00380"></a>00380     } out_color, in_color;
<a name="l00381"></a>00381     
<a name="l00382"></a>00382     in_color.integer = icol;
<a name="l00383"></a>00383     out_color.cp[0] = in_color.cp[3]; <span class="comment">// red</span>
<a name="l00384"></a>00384     out_color.cp[1] = in_color.cp[2]; <span class="comment">// green</span>
<a name="l00385"></a>00385     out_color.cp[2] = in_color.cp[1]; <span class="comment">// blue</span>
<a name="l00386"></a>00386     out_color.cp[3] = in_color.cp[0]; <span class="comment">// alpha</span>
<a name="l00387"></a>00387     
<a name="l00388"></a>00388     <span class="keywordflow">return</span> out_color.integer;
<a name="l00389"></a>00389 }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="comment">/* Now the real converting starts... */</span>
<a name="l00392"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">00392</a> <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(<a class="code" href="../../db/d33/structMCol.html">MCol</a> col)
<a name="l00393"></a>00393 {
<a name="l00394"></a>00394     <span class="comment">/* color has to be converted without endian sensitivity. So no shifting! */</span>
<a name="l00395"></a>00395     <span class="keyword">union</span>
<a name="l00396"></a>00396     {
<a name="l00397"></a>00397         <a class="code" href="../../db/d33/structMCol.html">MCol</a> col;
<a name="l00398"></a>00398         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> integer;
<a name="l00399"></a>00399         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cp[4];
<a name="l00400"></a>00400     } out_color, in_color;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402     in_color.col = col;
<a name="l00403"></a>00403     out_color.cp[0] = in_color.cp[3]; <span class="comment">// red</span>
<a name="l00404"></a>00404     out_color.cp[1] = in_color.cp[2]; <span class="comment">// green</span>
<a name="l00405"></a>00405     out_color.cp[2] = in_color.cp[1]; <span class="comment">// blue</span>
<a name="l00406"></a>00406     out_color.cp[3] = in_color.cp[0]; <span class="comment">// alpha</span>
<a name="l00407"></a>00407     
<a name="l00408"></a>00408     <span class="keywordflow">return</span> out_color.integer;
<a name="l00409"></a>00409 }
<a name="l00410"></a>00410 
<a name="l00411"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af75ad81281718b1f2f9332135354b0bf">00411</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af75ad81281718b1f2f9332135354b0bf">SetDefaultLightMode</a>(<a class="code" href="../../d9/d27/structScene.html">Scene</a>* scene)
<a name="l00412"></a>00412 {
<a name="l00413"></a>00413     <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a355807bfa0fd16a65e29a0c50714bac6">default_light_mode</a> = <span class="keyword">false</span>;
<a name="l00414"></a>00414     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce_iter;
<a name="l00415"></a>00415     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417     <span class="keywordflow">for</span> (<a class="code" href="../../d8/d53/BKE__scene_8h.html#a2ea2c0ff1c9b5bb29c3add65bbaadf2d">SETLOOPER</a>(scene, sce_iter, base))
<a name="l00418"></a>00418     {
<a name="l00419"></a>00419         <span class="keywordflow">if</span> (base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a1514ec0465b89013544107c908e7abca">OB_LAMP</a>)
<a name="l00420"></a>00420         {
<a name="l00421"></a>00421             <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a355807bfa0fd16a65e29a0c50714bac6">default_light_mode</a> = <span class="keyword">true</span>;
<a name="l00422"></a>00422             <span class="keywordflow">return</span>;
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425 }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 <span class="comment">// --</span>
<a name="l00429"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a14fc52c2aebfeb1a89505ee990f7a321">00429</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a14fc52c2aebfeb1a89505ee990f7a321">GetRGB</a>(<span class="keywordtype">short</span> type,
<a name="l00430"></a>00430     <a class="code" href="../../d6/da0/structMFace.html">MFace</a>* mface,
<a name="l00431"></a>00431     <a class="code" href="../../db/d33/structMCol.html">MCol</a>* mmcol,
<a name="l00432"></a>00432     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *mat,
<a name="l00433"></a>00433     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;c0, 
<a name="l00434"></a>00434     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;c1, 
<a name="l00435"></a>00435     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;c2, 
<a name="l00436"></a>00436     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;c3)
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> color = 0xFFFFFFFF<a class="code" href="../../d2/d6c/mball_8c.html#aa73214aa5f2f94f63d90bb4e3d99fe53">L</a>;
<a name="l00439"></a>00439     <span class="keywordflow">switch</span>(type)
<a name="l00440"></a>00440     {
<a name="l00441"></a>00441         <span class="keywordflow">case</span> 0: <span class="comment">// vertex colors</span>
<a name="l00442"></a>00442         {
<a name="l00443"></a>00443             <span class="keywordflow">if</span> (mmcol) {
<a name="l00444"></a>00444                 c0 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mmcol[0]);
<a name="l00445"></a>00445                 c1 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mmcol[1]);
<a name="l00446"></a>00446                 c2 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mmcol[2]);
<a name="l00447"></a>00447                 <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l00448"></a>00448                     c3 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mmcol[3]);
<a name="l00449"></a>00449             }<span class="keywordflow">else</span> <span class="comment">// backup white</span>
<a name="l00450"></a>00450             {
<a name="l00451"></a>00451                 c0 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00452"></a>00452                 c1 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00453"></a>00453                 c2 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);    
<a name="l00454"></a>00454                 <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l00455"></a>00455                     c3 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>( color );
<a name="l00456"></a>00456             }
<a name="l00457"></a>00457         } <span class="keywordflow">break</span>;
<a name="l00458"></a>00458         
<a name="l00459"></a>00459     
<a name="l00460"></a>00460         <span class="keywordflow">case</span> 1: <span class="comment">// material rgba</span>
<a name="l00461"></a>00461         {
<a name="l00462"></a>00462             <span class="keywordflow">if</span> (mat) {
<a name="l00463"></a>00463                 <span class="keyword">union </span>{
<a name="l00464"></a>00464                     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cp[4];
<a name="l00465"></a>00465                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> integer;
<a name="l00466"></a>00466                 } col_converter;
<a name="l00467"></a>00467                 col_converter.cp[3] = (<span class="keywordtype">unsigned</span> char) (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9e892cbd7e25b6fd5ee00c383cd9cacf">r</a>*255.0);
<a name="l00468"></a>00468                 col_converter.cp[2] = (<span class="keywordtype">unsigned</span> char) (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a4b832bd11d2b3d00ab74a269f2f2e9e8">g</a>*255.0);
<a name="l00469"></a>00469                 col_converter.cp[1] = (<span class="keywordtype">unsigned</span> char) (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a01ac5d90e907d35afcf7af9cf6b17c04">b</a>*255.0);
<a name="l00470"></a>00470                 col_converter.cp[0] = (<span class="keywordtype">unsigned</span> char) (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ac0f2eb80623ad884c7fa770e47ae92a2">alpha</a>*255.0);
<a name="l00471"></a>00471                 color = col_converter.integer;
<a name="l00472"></a>00472             }
<a name="l00473"></a>00473             c0 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00474"></a>00474             c1 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00475"></a>00475             c2 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);    
<a name="l00476"></a>00476             <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l00477"></a>00477                 c3 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00478"></a>00478         } <span class="keywordflow">break</span>;
<a name="l00479"></a>00479         
<a name="l00480"></a>00480         <span class="keywordflow">default</span>: <span class="comment">// white</span>
<a name="l00481"></a>00481         {
<a name="l00482"></a>00482             c0 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00483"></a>00483             c1 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00484"></a>00484             c2 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);    
<a name="l00485"></a>00485             <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l00486"></a>00486                 c3 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l00487"></a>00487         } <span class="keywordflow">break</span>;
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00491"></a><a class="code" href="../../d5/df3/structMTF__localLayer.html">00491</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/df3/structMTF__localLayer.html">MTF_localLayer</a>
<a name="l00492"></a>00492 {
<a name="l00493"></a><a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">00493</a>     <a class="code" href="../../da/d7f/structMTFace.html">MTFace</a> *<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a>;
<a name="l00494"></a><a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">00494</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a>;
<a name="l00495"></a>00495 }<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#aab95deb295d842098ebad032edae2987">MTF_localLayer</a>;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 <span class="comment">// ------------------------------------</span>
<a name="l00498"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a3e0e88c03da354310fc96bdc52145c4c">00498</a> <span class="keywordtype">bool</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a3e0e88c03da354310fc96bdc52145c4c">ConvertMaterial</a>(
<a name="l00499"></a>00499     <a class="code" href="../../d3/de1/classBL__Material.html">BL_Material</a> *material,
<a name="l00500"></a>00500     <a class="code" href="../../d2/d10/structMaterial.html">Material</a> *mat, 
<a name="l00501"></a>00501     <a class="code" href="../../da/d7f/structMTFace.html">MTFace</a>* tface,  
<a name="l00502"></a>00502     <span class="keyword">const</span> <span class="keywordtype">char</span> *tfaceName,
<a name="l00503"></a>00503     <a class="code" href="../../d6/da0/structMFace.html">MFace</a>* mface, 
<a name="l00504"></a>00504     <a class="code" href="../../db/d33/structMCol.html">MCol</a>* mmcol,
<a name="l00505"></a>00505     <a class="code" href="../../d5/df3/structMTF__localLayer.html">MTF_localLayer</a> *layers,
<a name="l00506"></a>00506     <span class="keywordtype">bool</span> glslmat)
<a name="l00507"></a>00507 {
<a name="l00508"></a>00508     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ab6328efaf6768beaabfaf9aa613254cd">Initialize</a>();
<a name="l00509"></a>00509     <span class="keywordtype">int</span> numchan =   -1, texalpha = 0;
<a name="l00510"></a>00510     <span class="keywordtype">bool</span> validmat   = (mat!=0);
<a name="l00511"></a>00511     <span class="keywordtype">bool</span> validface  = (tface!=0);
<a name="l00512"></a>00512     
<a name="l00513"></a>00513     <span class="keywordtype">short</span> type = 0;
<a name="l00514"></a>00514     <span class="keywordflow">if</span> ( validmat )
<a name="l00515"></a>00515         type = 1; <span class="comment">// material color </span>
<a name="l00516"></a>00516     
<a name="l00517"></a>00517     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aefaccf78793cc724e61ecf71fa108bad">IdMode</a> = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a366893b30d0095c834c9aba7df3f598caab313d21aeaa53db371daf27054afaee">DEFAULT_BLENDER</a>;
<a name="l00518"></a>00518     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a0899468804a495f1c852d1104a18463c">glslmat</a> = (validmat)? glslmat: <span class="keyword">false</span>;
<a name="l00519"></a>00519     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a6cc7258f646856ab704d75aa1ce30c0d">materialindex</a> = mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a9263f86fc8c22b7f355bcade20574047">mat_nr</a>;
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <span class="comment">// --------------------------------</span>
<a name="l00522"></a>00522     <span class="keywordflow">if</span> (validmat) {
<a name="l00523"></a>00523 
<a name="l00524"></a>00524         <span class="comment">// use vertex colors by explicitly setting</span>
<a name="l00525"></a>00525         <span class="keywordflow">if</span> (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#a738a0d7c46ba3b6726d95e0842e020ce">MA_VERTEXCOLP</a> || glslmat)
<a name="l00526"></a>00526             type = 0;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528         <span class="comment">// use lighting?</span>
<a name="l00529"></a>00529         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a85f714f47470dfdaa7b87fa72965f73e">ras_mode</a> |= ( mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a711a44cc51cfb78f529c3ac59306e756">MA_SHLESS</a> )?0:<a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9ba0d555ae0f2870d6dd8e4c19e1dad1d41">USE_LIGHT</a>;
<a name="l00530"></a>00530         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a85f714f47470dfdaa7b87fa72965f73e">ras_mode</a> |= ( mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#a397c98bd06439151d371cc4085c2acfb">flag</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a05f438c08666b75c7a79f95cb3811314">GEMAT_BACKCULL</a> )?0:<a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9bad771d2ec808c427ad0df0c177e9ee400">TWOSIDED</a>;
<a name="l00531"></a>00531 
<a name="l00532"></a>00532         <span class="comment">// cast shadows?</span>
<a name="l00533"></a>00533         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a85f714f47470dfdaa7b87fa72965f73e">ras_mode</a> |= ( mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a57a66e703cc7c97d7e2feb1f6b5bccc6">MA_SHADBUF</a> )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9ba1feb68b140a38104812c1d83ec87ca18">CAST_SHADOW</a>:0;
<a name="l00534"></a>00534         <a class="code" href="../../dc/ddd/structMTex.html">MTex</a> *mttmp = 0;
<a name="l00535"></a>00535         numchan = <a class="code" href="../../d2/d7d/BL__Material_8cpp.html#abd2025fab9593c22224792ea7ce4fcb4">getNumTexChannels</a>(mat);
<a name="l00536"></a>00536         <span class="keywordtype">int</span> valid_index = 0;
<a name="l00537"></a>00537         
<a name="l00538"></a>00538         <span class="comment">/* In Multitexture use the face texture if and only if</span>
<a name="l00539"></a>00539 <span class="comment">         * it is set in the buttons</span>
<a name="l00540"></a>00540 <span class="comment">         * In GLSL is not working yet :/ 3.2011 */</span>
<a name="l00541"></a>00541         <span class="keywordtype">bool</span> facetex = <span class="keyword">false</span>;
<a name="l00542"></a>00542         <span class="keywordflow">if</span> (validface &amp;&amp; mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#a95f694c6f90519ab830e9b9fa87d62e6">MA_FACETEXTURE</a>) 
<a name="l00543"></a>00543             facetex = <span class="keyword">true</span>;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545         numchan = numchan&gt;<a class="code" href="../../d1/d4a/BL__Material_8h.html#aeb2da7fb980f205aff939caf5eee99c9">MAXTEX</a>?<a class="code" href="../../d1/d4a/BL__Material_8h.html#aeb2da7fb980f205aff939caf5eee99c9">MAXTEX</a>:numchan;
<a name="l00546"></a>00546         <span class="keywordflow">if</span> (facetex &amp;&amp; numchan == 0) numchan = 1;
<a name="l00547"></a>00547     
<a name="l00548"></a>00548         <span class="comment">// foreach MTex</span>
<a name="l00549"></a>00549         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;numchan; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {
<a name="l00550"></a>00550             <span class="comment">// use face tex</span>
<a name="l00551"></a>00551 
<a name="l00552"></a>00552             <span class="keywordflow">if</span> (<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>==0 &amp;&amp; facetex ) {
<a name="l00553"></a>00553                 facetex = <span class="keyword">false</span>;
<a name="l00554"></a>00554                 <a class="code" href="../../d8/d00/classImage.html" title="32 bit RGBA image.">Image</a>*tmp = (<a class="code" href="../../d8/d00/classImage.html" title="32 bit RGBA image.">Image</a>*)(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a94b886f25499ad61afed79c6362451ef">tpage</a>);
<a name="l00555"></a>00555 
<a name="l00556"></a>00556                 <span class="keywordflow">if</span> (tmp) {
<a name="l00557"></a>00557                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = tmp;
<a name="l00558"></a>00558                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ae3d218348db649f1e861f4e76225a5fa">texname</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="../../d8/d00/classImage.html#aaf5fcd281cf4337d6686322f82187896">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>;
<a name="l00559"></a>00559                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65a07e649496c491cfeb099de6684fdcdd9">MIPMAP</a>;
<a name="l00560"></a>00560 
<a name="l00561"></a>00561                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= ( mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#aa27d0575fa94b59c91b4eb396adfe0f5">alpha_blend</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a03ed6bc55badbc77d9c6d9617a54bd0e">GEMAT_ALPHA_SORT</a> )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65ac3513dbebb210e599e133ad4ee22a84d">USEALPHA</a>:0;
<a name="l00562"></a>00562                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= ( mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#aa27d0575fa94b59c91b4eb396adfe0f5">alpha_blend</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9d7f03d458ed9eb326964cd8733f7b94">GEMAT_ALPHA</a> )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65ac3513dbebb210e599e133ad4ee22a84d">USEALPHA</a>:0;
<a name="l00563"></a>00563                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= ( mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#aa27d0575fa94b59c91b4eb396adfe0f5">alpha_blend</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a680b2522cef7f0875dc99e28ab6488db">GEMAT_ADD</a> )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65a33e7a3560d37a39424c22837186ee253">CALCALPHA</a>:0;
<a name="l00564"></a>00564 
<a name="l00565"></a>00565                     <span class="keywordflow">if</span> (material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="../../d8/d00/classImage.html#ab84c3d099caf0d6ec44c266899839f63">flag</a> &amp; <a class="code" href="../../d2/d94/DNA__image__types_8h.html#a4824ccdbc52f037697247fb86ac01d83">IMA_REFLECT</a>)
<a name="l00566"></a>00566                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1af542db7ac20b88f9e6f21cf6124a8bdd">USEREFL</a>;
<a name="l00567"></a>00567                     <span class="keywordflow">else</span>
<a name="l00568"></a>00568                     {
<a name="l00569"></a>00569                         mttmp = <a class="code" href="../../d2/d7d/BL__Material_8cpp.html#a4979a13dc2a89334a1f09a4ea15cbff3">getImageFromMaterial</a>( mat, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> );
<a name="l00570"></a>00570                         <span class="keywordflow">if</span> (mttmp &amp;&amp; mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#a938a2602f1452ef9399e915c4a004116">TEXCO_UV</a>)
<a name="l00571"></a>00571                         {
<a name="l00572"></a>00572                             <a class="code" href="../../d6/dce/classSTR__String.html">STR_String</a> uvName = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#acd0c915b6336e1c3e1e46d19a27e9a17">uvname</a>;
<a name="l00573"></a>00573 
<a name="l00574"></a>00574                             <span class="keywordflow">if</span> (!uvName.<a class="code" href="../../d6/dce/classSTR__String.html#a0160aebe91ec2ecd92f1190bafea7cf9">IsEmpty</a>())
<a name="l00575"></a>00575                                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a24bc80a1d8ee32efd1dfeb288bcddec2">uvCoName</a> = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#acd0c915b6336e1c3e1e46d19a27e9a17">uvname</a>;
<a name="l00576"></a>00576                             <span class="keywordflow">else</span>
<a name="l00577"></a>00577                                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a24bc80a1d8ee32efd1dfeb288bcddec2">uvCoName</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00578"></a>00578                         }
<a name="l00579"></a>00579                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1abd3621dd64f8e5135230d56ea99ecff2">USEUV</a>;
<a name="l00580"></a>00580                     }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582                     valid_index++;
<a name="l00583"></a>00583                 }
<a name="l00584"></a>00584                 <span class="keywordflow">else</span> {
<a name="l00585"></a>00585                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;
<a name="l00586"></a>00586                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ae3d218348db649f1e861f4e76225a5fa">texname</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00587"></a>00587                 }
<a name="l00588"></a>00588                 <span class="keywordflow">continue</span>;
<a name="l00589"></a>00589             }
<a name="l00590"></a>00590 
<a name="l00591"></a>00591             mttmp = <a class="code" href="../../d2/d7d/BL__Material_8cpp.html#a4979a13dc2a89334a1f09a4ea15cbff3">getImageFromMaterial</a>( mat, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> );
<a name="l00592"></a>00592             <span class="keywordflow">if</span> ( mttmp ) {
<a name="l00593"></a>00593                 <span class="keywordflow">if</span> ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a> ) {
<a name="l00594"></a>00594                     <span class="keywordflow">if</span> ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#aa7daf61fa1146d430403e81db6acb7cb">type</a> == <a class="code" href="../../dc/d4f/rna__nodetree__types_8h.html#af2375c975e2ce5925f9be76460a1f1c1">TEX_IMAGE</a> ) {
<a name="l00595"></a>00595                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a4a97b2280836687ecbcb607f27898e73">mtexname</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a8319488bcdfe2de879476bd0f7c27aa2">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>;
<a name="l00596"></a>00596                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#ad2c2c4a8437672ea77fc9cfded61ffaf">ima</a>;
<a name="l00597"></a>00597                         <span class="keywordflow">if</span> ( material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ) {
<a name="l00598"></a>00598 
<a name="l00599"></a>00599                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ae3d218348db649f1e861f4e76225a5fa">texname</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="../../d8/d00/classImage.html#aaf5fcd281cf4337d6686322f82187896">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>;
<a name="l00600"></a>00600                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a2f3d295e7caaecf01e345d12d195e76e">imaflag</a> &amp;<a class="code" href="../../da/ddf/DNA__texture__types_8h.html#ae80ae7a29d1acb12a94fa45c6eb3003f">TEX_MIPMAP</a> )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65a07e649496c491cfeb099de6684fdcdd9">MIPMAP</a>:0;
<a name="l00601"></a>00601                             <span class="comment">// -----------------------</span>
<a name="l00602"></a>00602                             <span class="keywordflow">if</span> ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a2f3d295e7caaecf01e345d12d195e76e">imaflag</a> &amp;<a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a444168081b0f593651c005217b3bebc8">TEX_USEALPHA</a> ) {
<a name="l00603"></a>00603                                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]   |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65ac3513dbebb210e599e133ad4ee22a84d">USEALPHA</a>;
<a name="l00604"></a>00604                             }
<a name="l00605"></a>00605                             <span class="comment">// -----------------------</span>
<a name="l00606"></a>00606                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a2f3d295e7caaecf01e345d12d195e76e">imaflag</a> &amp;<a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a7145956ea80499f8e2eae6be19f608dd">TEX_CALCALPHA</a> ) {
<a name="l00607"></a>00607                                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]   |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65a33e7a3560d37a39424c22837186ee253">CALCALPHA</a>;
<a name="l00608"></a>00608                             }
<a name="l00609"></a>00609                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#aa3d72a0e7a943da508e3f4c1cd1803e7">flag</a> &amp;<a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a9ddd149ad6bb398568d6d8f00f756cf7">TEX_NEGALPHA</a>) {
<a name="l00610"></a>00610                                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]   |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65afc0eb4425a8895c69073a123e2aab1d8">USENEGALPHA</a>;
<a name="l00611"></a>00611                             }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a6a2165308d9ab9cbeae25b6e79bc99ba">color_blend</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a50c3aa992ec063f2e025bda4932d9671">colfac</a>;
<a name="l00614"></a>00614                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aa28e86f4cbc4330e5e8518b11dcfbc61">mapto</a>  &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a4d4d91166a52a89f90553ad91d3efd06">MAP_ALPHA</a>        )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65ae28c99668606543baa357c5505ff357f">TEXALPHA</a>:0;
<a name="l00615"></a>00615                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#ab51470b87b40b19a8ca3781d30b70f12">texflag</a>&amp; <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a5b0a127a63aea49f47ce00125a79f6cc">MTEX_NEGATIVE</a>    )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65adc72fb2f94fdf3345f4a2ac14020914f">TEXNEG</a>:0;
<a name="l00616"></a>00616 
<a name="l00617"></a>00617                             <span class="keywordflow">if</span> (!glslmat &amp;&amp; (material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] &amp; <a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65ae28c99668606543baa357c5505ff357f">TEXALPHA</a>))
<a name="l00618"></a>00618                                 texalpha = 1;
<a name="l00619"></a>00619                         }
<a name="l00620"></a>00620                     }
<a name="l00621"></a>00621                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#aa7daf61fa1146d430403e81db6acb7cb">type</a> == <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a268a78c388efb693b879d6d21d3f60c7">TEX_ENVMAP</a>) {
<a name="l00622"></a>00622                         <span class="keywordflow">if</span> ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a38f85ab225d5634cf434ae45e7eed004">env</a>-&gt;<a class="code" href="../../d2/d48/structEnvMap.html#aba1cb887824b438b9754bd605877cdf4">stype</a> == <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a5cc75635fa3e668d8974bcc898f3f97b">ENV_LOAD</a> ) {
<a name="l00623"></a>00623                     
<a name="l00624"></a>00624                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a4a97b2280836687ecbcb607f27898e73">mtexname</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]     = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a8319488bcdfe2de879476bd0f7c27aa2">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>;
<a name="l00625"></a>00625                             <a class="code" href="../../d2/d48/structEnvMap.html">EnvMap</a> *env = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#a38f85ab225d5634cf434ae45e7eed004">env</a>;
<a name="l00626"></a>00626                             env-&gt;<a class="code" href="../../d2/d48/structEnvMap.html#a8aa958f7d9894d2941bf32c82625a50a">ima</a> = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aef6acbb854984bb254e1cb5b75f821d4">tex</a>-&gt;<a class="code" href="../../df/d2d/structTex.html#ad2c2c4a8437672ea77fc9cfded61ffaf">ima</a>;
<a name="l00627"></a>00627                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad407568dc1d5ffb2f357aa0a24601b89">cubemap</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = env;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629                             <span class="keywordflow">if</span> (material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad407568dc1d5ffb2f357aa0a24601b89">cubemap</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])
<a name="l00630"></a>00630                             {
<a name="l00631"></a>00631                                 <span class="keywordflow">if</span> (!material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad407568dc1d5ffb2f357aa0a24601b89">cubemap</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="../../d2/d48/structEnvMap.html#ac7f5cdc3723c068a8fc59ec0cf59e346">cube</a>[0])
<a name="l00632"></a>00632                                     <a class="code" href="../../dd/d62/classBL__Texture.html#ad68a27cd1c9aa84a72bfddfdd5b99d99">BL_Texture::SplitEnvMap</a>(material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad407568dc1d5ffb2f357aa0a24601b89">cubemap</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);
<a name="l00633"></a>00633 
<a name="l00634"></a>00634                                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ae3d218348db649f1e861f4e76225a5fa">texname</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]= material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad407568dc1d5ffb2f357aa0a24601b89">cubemap</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="../../d2/d48/structEnvMap.html#a8aa958f7d9894d2941bf32c82625a50a">ima</a>-&gt;<a class="code" href="../../d8/d00/classImage.html#aaf5fcd281cf4337d6686322f82187896">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>;
<a name="l00635"></a>00635                                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1adb0d275790d6a0ec87b8c1039d889d2f">USEENV</a>;
<a name="l00636"></a>00636                             }
<a name="l00637"></a>00637                         }
<a name="l00638"></a>00638                     }
<a name="l00639"></a>00639 <span class="preprocessor">#if 0               </span><span class="comment">/* this flag isn&#39;t used anymore */</span>
<a name="l00640"></a>00640                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= (<a class="code" href="../../dc/d51/BKE__animsys_8h.html#aa3c6a97f5185329334a481908e7cf985">BKE_animdata_from_id</a>(mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>) != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ? HASIPO : 0;
<a name="l00641"></a>00641 <span class="preprocessor">#endif</span>
<a name="l00642"></a>00642 <span class="preprocessor"></span>
<a name="l00643"></a>00643                     <span class="comment">// mapping methods</span>
<a name="l00644"></a>00644                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= ( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a>  &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a29019e3a840bac8047994ce5829b07d6">TEXCO_REFL</a>    )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1af542db7ac20b88f9e6f21cf6124a8bdd">USEREFL</a>:0;
<a name="l00645"></a>00645                     
<a name="l00646"></a>00646                     <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a19dec5a9457d85954f61c9b0dffd8211">TEXCO_OBJECT</a>) {
<a name="l00647"></a>00647                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1a315b58cbd7861d8066148061235d7d70">USEOBJ</a>;
<a name="l00648"></a>00648                         <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aaf7b9758f217a9aa59a16b1768c2753e">object</a>)
<a name="l00649"></a>00649                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a13096967c252a6493acfb7a1c9cd31a6">objconame</a> = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#aaf7b9758f217a9aa59a16b1768c2753e">object</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>;
<a name="l00650"></a>00650                     }
<a name="l00651"></a>00651                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#a29019e3a840bac8047994ce5829b07d6">TEXCO_REFL</a>)
<a name="l00652"></a>00652                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1af542db7ac20b88f9e6f21cf6124a8bdd">USEREFL</a>;
<a name="l00653"></a>00653                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a> &amp;(<a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7840c0d1aa749edccc8bfb7215b472a">TEXCO_ORCO</a>|<a class="code" href="../../de/db2/DNA__material__types_8h.html#a24fae7c12b9d1c2c450f8056a0c08d9e">TEXCO_GLOB</a>))
<a name="l00654"></a>00654                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1ae7fac6f2eced03499db66dbb86b56f2b">USEORCO</a>;
<a name="l00655"></a>00655                     <span class="keywordflow">else</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#a938a2602f1452ef9399e915c4a004116">TEXCO_UV</a>)
<a name="l00656"></a>00656                     {
<a name="l00657"></a>00657                         <a class="code" href="../../d6/dce/classSTR__String.html">STR_String</a> uvName = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#acd0c915b6336e1c3e1e46d19a27e9a17">uvname</a>;
<a name="l00658"></a>00658 
<a name="l00659"></a>00659                         <span class="keywordflow">if</span> (!uvName.<a class="code" href="../../d6/dce/classSTR__String.html#a0160aebe91ec2ecd92f1190bafea7cf9">IsEmpty</a>())
<a name="l00660"></a>00660                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a24bc80a1d8ee32efd1dfeb288bcddec2">uvCoName</a> = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#acd0c915b6336e1c3e1e46d19a27e9a17">uvname</a>;
<a name="l00661"></a>00661                         <span class="keywordflow">else</span>
<a name="l00662"></a>00662                             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a24bc80a1d8ee32efd1dfeb288bcddec2">uvCoName</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00663"></a>00663                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1abd3621dd64f8e5135230d56ea99ecff2">USEUV</a>;
<a name="l00664"></a>00664                     }
<a name="l00665"></a>00665                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#aaa5de8ec9022fb2d91875b60047eecb1">TEXCO_NORM</a>)
<a name="l00666"></a>00666                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1a66edc3f6d3c97e493aec1408dd3fff94">USENORM</a>;
<a name="l00667"></a>00667                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a0e8d81acbf5efcb10a9c30bba03a5c09">texco</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#ae4ff7cbf2e23bf1c8b5b1a56642f2492">TEXCO_TANGENT</a>)
<a name="l00668"></a>00668                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1a8969bc09d7e930014cd4c3734297d3bc">USETANG</a>;
<a name="l00669"></a>00669                     <span class="keywordflow">else</span>
<a name="l00670"></a>00670                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1ad3a9df141be0ccf10389b640f492b26d">DISABLE</a>;
<a name="l00671"></a>00671                     
<a name="l00672"></a>00672                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a18ce08c8591019f83fd14a3c1128b468">scale</a>[0] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#accae10059528ad76fb12b21d19f7d9c1">size</a>[0];
<a name="l00673"></a>00673                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a18ce08c8591019f83fd14a3c1128b468">scale</a>[1] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#accae10059528ad76fb12b21d19f7d9c1">size</a>[1];
<a name="l00674"></a>00674                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a18ce08c8591019f83fd14a3c1128b468">scale</a>[2] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#accae10059528ad76fb12b21d19f7d9c1">size</a>[2];
<a name="l00675"></a>00675                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a4eef8eed260cfad3d7a30b1dfe81760b">offsets</a>[0] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a9b7596a4182c5d9c82299e9599edfe48">ofs</a>[0];
<a name="l00676"></a>00676                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a4eef8eed260cfad3d7a30b1dfe81760b">offsets</a>[1] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a9b7596a4182c5d9c82299e9599edfe48">ofs</a>[1];
<a name="l00677"></a>00677                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#a4eef8eed260cfad3d7a30b1dfe81760b">offsets</a>[2] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a9b7596a4182c5d9c82299e9599edfe48">ofs</a>[2];
<a name="l00678"></a>00678 
<a name="l00679"></a>00679                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#ae427bbcbd9bb8c1be9cbef56a8556daa">projplane</a>[0] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a73d150ce25a5958b9bb9883dc15e36b8">projx</a>;
<a name="l00680"></a>00680                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#ae427bbcbd9bb8c1be9cbef56a8556daa">projplane</a>[1] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a20f2b9a9fb58c2ac5be98fa2a461ca40">projy</a>;
<a name="l00681"></a>00681                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../df/d83/classBL__Mapping.html#ae427bbcbd9bb8c1be9cbef56a8556daa">projplane</a>[2] = mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a313bfa927173e512fb242f1886f3d0c8">projz</a>;
<a name="l00683"></a>00683                     
<a name="l00684"></a>00684                     <span class="keywordflow">switch</span>( mttmp-&gt;<a class="code" href="../../dc/ddd/structMTex.html#a6aacfa6bf53d67200c50a11b4662402e">blendtype</a> ) {
<a name="l00685"></a>00685                     <span class="keywordflow">case</span> <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#ac3a8049d0db5deca0c55bbe3782ef97f">MTEX_BLEND</a>:
<a name="l00686"></a>00686                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a6d418e41b6e0c13e366f94bd4a7abee1">blend_mode</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a7ef0b8f7ae5d40f925be669cbc10dbbfa3274374c34a60e502a8ec515c6f4c5d6">BLEND_MIX</a>;
<a name="l00687"></a>00687                         <span class="keywordflow">break</span>;
<a name="l00688"></a>00688                     <span class="keywordflow">case</span> <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a082272727c78e320aa764225c854d1f0">MTEX_MUL</a>:
<a name="l00689"></a>00689                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a6d418e41b6e0c13e366f94bd4a7abee1">blend_mode</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a7ef0b8f7ae5d40f925be669cbc10dbbfadd4e0909cc112a570ce892a2df08cb78">BLEND_MUL</a>;
<a name="l00690"></a>00690                         <span class="keywordflow">break</span>;
<a name="l00691"></a>00691                     <span class="keywordflow">case</span> <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#add089465c8a525998da583aea2b3800d">MTEX_ADD</a>:
<a name="l00692"></a>00692                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a6d418e41b6e0c13e366f94bd4a7abee1">blend_mode</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a7ef0b8f7ae5d40f925be669cbc10dbbfadbdb329830e5b4d9fa2b17d5d6d7894f">BLEND_ADD</a>;
<a name="l00693"></a>00693                         <span class="keywordflow">break</span>;
<a name="l00694"></a>00694                     <span class="keywordflow">case</span> <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a7a6644c61ffb76743b6ac4cd423633b5">MTEX_SUB</a>:
<a name="l00695"></a>00695                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a6d418e41b6e0c13e366f94bd4a7abee1">blend_mode</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a7ef0b8f7ae5d40f925be669cbc10dbbfa26d23568de2a88f60573afa9154b3b38">BLEND_SUB</a>;
<a name="l00696"></a>00696                         <span class="keywordflow">break</span>;
<a name="l00697"></a>00697                     <span class="keywordflow">case</span> <a class="code" href="../../da/ddf/DNA__texture__types_8h.html#a88efd9c2cb9d9260da3084457143a7e9">MTEX_SCREEN</a>:
<a name="l00698"></a>00698                         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a6d418e41b6e0c13e366f94bd4a7abee1">blend_mode</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a7ef0b8f7ae5d40f925be669cbc10dbbfa9ba81e195fcacc43ab0b770748c008d9">BLEND_SCR</a>;
<a name="l00699"></a>00699                         <span class="keywordflow">break</span>;
<a name="l00700"></a>00700                     }
<a name="l00701"></a>00701                     valid_index++;
<a name="l00702"></a>00702                 }
<a name="l00703"></a>00703             }
<a name="l00704"></a>00704         }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706         <span class="comment">// above one tex the switches here</span>
<a name="l00707"></a>00707         <span class="comment">// are not used</span>
<a name="l00708"></a>00708         <span class="keywordflow">switch</span>(valid_index) {
<a name="l00709"></a>00709         <span class="keywordflow">case</span> 0:
<a name="l00710"></a>00710             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aefaccf78793cc724e61ecf71fa108bad">IdMode</a> = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a366893b30d0095c834c9aba7df3f598caab313d21aeaa53db371daf27054afaee">DEFAULT_BLENDER</a>;
<a name="l00711"></a>00711             <span class="keywordflow">break</span>;
<a name="l00712"></a>00712         <span class="keywordflow">case</span> 1:
<a name="l00713"></a>00713             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aefaccf78793cc724e61ecf71fa108bad">IdMode</a> = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a366893b30d0095c834c9aba7df3f598ca011124efb1a0b3dee7770635e0449440">ONETEX</a>;
<a name="l00714"></a>00714             <span class="keywordflow">break</span>;
<a name="l00715"></a>00715         <span class="keywordflow">default</span>:
<a name="l00716"></a>00716             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aefaccf78793cc724e61ecf71fa108bad">IdMode</a> = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a366893b30d0095c834c9aba7df3f598cacf3f4a930b537530e96fc0ae9cb0d4ae">GREATERTHAN2</a>;
<a name="l00717"></a>00717             <span class="keywordflow">break</span>;
<a name="l00718"></a>00718         }
<a name="l00719"></a>00719         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a818fc6d6089612c350b264cd7a702f88">SetUsers</a>(mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad88374dc626795552b5c3f5b77fab1ab">us</a>);
<a name="l00720"></a>00720 
<a name="l00721"></a>00721         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad49c1d1d2dab4c87e062eee87ccfd514">num_enabled</a> = valid_index;
<a name="l00722"></a>00722 
<a name="l00723"></a>00723         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#afa6b568dcb05ada4a3fec8bcbedb27ac">speccolor</a>[0]  = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#af595797ad989716e9a27949aa0fc3fcb">specr</a>;
<a name="l00724"></a>00724         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#afa6b568dcb05ada4a3fec8bcbedb27ac">speccolor</a>[1]  = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a056953ed5167834167da6744af3ef1ff">specg</a>;
<a name="l00725"></a>00725         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#afa6b568dcb05ada4a3fec8bcbedb27ac">speccolor</a>[2]  = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ac7a3474ca6b651dbd0cb99b3849750e2">specb</a>;
<a name="l00726"></a>00726         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ab6dd9213323693fc1462df1cd90293f3">hard</a>          = (float)mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#af7e6796633eed3cf2fe85a929fd11199">har</a>/4.0f;
<a name="l00727"></a>00727         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad59a47825d7ca71b42c0a98a93c72aec">matcolor</a>[0]   = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9e892cbd7e25b6fd5ee00c383cd9cacf">r</a>;
<a name="l00728"></a>00728         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad59a47825d7ca71b42c0a98a93c72aec">matcolor</a>[1]   = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a4b832bd11d2b3d00ab74a269f2f2e9e8">g</a>;
<a name="l00729"></a>00729         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad59a47825d7ca71b42c0a98a93c72aec">matcolor</a>[2]   = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a01ac5d90e907d35afcf7af9cf6b17c04">b</a>;
<a name="l00730"></a>00730         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad59a47825d7ca71b42c0a98a93c72aec">matcolor</a>[3]   = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ac0f2eb80623ad884c7fa770e47ae92a2">alpha</a>;
<a name="l00731"></a>00731         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a55b977971c633fa5c857ffc9c3c48a0e">alpha</a>         = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ac0f2eb80623ad884c7fa770e47ae92a2">alpha</a>;
<a name="l00732"></a>00732         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a07e351056d5590815910e1d2efa66a14">emit</a>          = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aff92c6c1d611b91f0dfcbb80992ca89c">emit</a>;
<a name="l00733"></a>00733         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a5378323b6b6595b39563ef9b48686083">spec_f</a>        = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9fde6991e416c1b39b8977dc7d345fc9">spec</a>;
<a name="l00734"></a>00734         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a705bf8d05c7b895ab699c4ecfeb17179">ref</a>           = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#afe35ce8fce88e740bc54505576f4b65a">ref</a>;
<a name="l00735"></a>00735         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a40cadb7ee87e3413703c569554d3d69c">amb</a>           = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a870998ec12271918c097d9077d771aef">amb</a>;
<a name="l00736"></a>00736 
<a name="l00737"></a>00737         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a85f714f47470dfdaa7b87fa72965f73e">ras_mode</a> |= (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ab2181c8ca6ce7ebdb8858702b9dd044c">material_type</a> == <a class="code" href="../../de/db2/DNA__material__types_8h.html#ace7b0e47f96304e3d85afdf3d6f4ee51">MA_TYPE_WIRE</a>)? <a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9ba1f1dd8e7a28788f8b1f2635baafe0d9b">WIRE</a>: 0;
<a name="l00738"></a>00738     }
<a name="l00739"></a>00739     <span class="keywordflow">else</span> { <span class="comment">// No Material</span>
<a name="l00740"></a>00740         <span class="keywordtype">int</span> valid = 0;
<a name="l00741"></a>00741 
<a name="l00742"></a>00742         <span class="comment">// check for tface tex to fallback on</span>
<a name="l00743"></a>00743         <span class="keywordflow">if</span> ( validface ) {
<a name="l00744"></a>00744             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[0] = (<a class="code" href="../../d8/d00/classImage.html" title="32 bit RGBA image.">Image</a>*)(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a94b886f25499ad61afed79c6362451ef">tpage</a>);
<a name="l00745"></a>00745             <span class="comment">// ------------------------</span>
<a name="l00746"></a>00746             <span class="keywordflow">if</span> (material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[0]) {
<a name="l00747"></a>00747                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ae3d218348db649f1e861f4e76225a5fa">texname</a>[0] = material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[0]-&gt;<a class="code" href="../../d8/d00/classImage.html#aaf5fcd281cf4337d6686322f82187896">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>;
<a name="l00748"></a>00748                 material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[0].<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= ( (material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[0]-&gt;<a class="code" href="../../d8/d00/classImage.html#ab84c3d099caf0d6ec44c266899839f63">flag</a> &amp; <a class="code" href="../../d2/d94/DNA__image__types_8h.html#a4824ccdbc52f037697247fb86ac01d83">IMA_REFLECT</a>)!=0 )?<a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1af542db7ac20b88f9e6f21cf6124a8bdd">USEREFL</a>:0;
<a name="l00749"></a>00749 
<a name="l00750"></a>00750                 <span class="comment">/* see if depth of the image is 32bits */</span>
<a name="l00751"></a>00751                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d77/BKE__image_8h.html#a0414fa198129a6dbec124c02a42c0e5c">BKE_image_has_alpha</a>(material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad88d5442b5b764fe17a444142ab6ffef">img</a>[0])) {
<a name="l00752"></a>00752                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a60e7f41e2e8633068547ccf5556f4ce4">flag</a>[0] |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#ad485bc2b4478f83a4ae54f8939cbcd65ac3513dbebb210e599e133ad4ee22a84d">USEALPHA</a>;
<a name="l00753"></a>00753                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a> = <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9d7f03d458ed9eb326964cd8733f7b94">GEMAT_ALPHA</a>;
<a name="l00754"></a>00754                 }
<a name="l00755"></a>00755                 <span class="keywordflow">else</span>
<a name="l00756"></a>00756                     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a> = <a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7029d7af71941a92a514e74ed001727">GEMAT_SOLID</a>;
<a name="l00757"></a>00757 
<a name="l00758"></a>00758                 valid++;
<a name="l00759"></a>00759             }
<a name="l00760"></a>00760         }
<a name="l00761"></a>00761         <span class="keywordflow">else</span>
<a name="l00762"></a>00762             material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a> = <a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7029d7af71941a92a514e74ed001727">GEMAT_SOLID</a>;
<a name="l00763"></a>00763 
<a name="l00764"></a>00764         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a818fc6d6089612c350b264cd7a702f88">SetUsers</a>(-1);
<a name="l00765"></a>00765         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad49c1d1d2dab4c87e062eee87ccfd514">num_enabled</a>   = valid;
<a name="l00766"></a>00766         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aefaccf78793cc724e61ecf71fa108bad">IdMode</a>        = <a class="code" href="../../d1/d4a/BL__Material_8h.html#a366893b30d0095c834c9aba7df3f598caab4ddca2a74fe70b6f99f100056c6363">TEXFACE</a>;
<a name="l00767"></a>00767         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#afa6b568dcb05ada4a3fec8bcbedb27ac">speccolor</a>[0]  = 1.f;
<a name="l00768"></a>00768         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#afa6b568dcb05ada4a3fec8bcbedb27ac">speccolor</a>[1]  = 1.f;
<a name="l00769"></a>00769         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#afa6b568dcb05ada4a3fec8bcbedb27ac">speccolor</a>[2]  = 1.f;
<a name="l00770"></a>00770         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ab6dd9213323693fc1462df1cd90293f3">hard</a>          = 35.f;
<a name="l00771"></a>00771         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad59a47825d7ca71b42c0a98a93c72aec">matcolor</a>[0]   = 0.5f;
<a name="l00772"></a>00772         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad59a47825d7ca71b42c0a98a93c72aec">matcolor</a>[1]   = 0.5f;
<a name="l00773"></a>00773         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad59a47825d7ca71b42c0a98a93c72aec">matcolor</a>[2]   = 0.5f;
<a name="l00774"></a>00774         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a5378323b6b6595b39563ef9b48686083">spec_f</a>        = 0.5f;
<a name="l00775"></a>00775         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a705bf8d05c7b895ab699c4ecfeb17179">ref</a>           = 0.8f;
<a name="l00776"></a>00776 
<a name="l00777"></a>00777         <span class="comment">// No material - old default TexFace properties</span>
<a name="l00778"></a>00778         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a85f714f47470dfdaa7b87fa72965f73e">ras_mode</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9ba0d555ae0f2870d6dd8e4c19e1dad1d41">USE_LIGHT</a>;
<a name="l00779"></a>00779     }
<a name="l00780"></a>00780     <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a> uv[4];
<a name="l00781"></a>00781     <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a> uv2[4];
<a name="l00782"></a>00782     <span class="keyword">const</span> <span class="keywordtype">char</span> *uvName = <span class="stringliteral">&quot;&quot;</span>, *uv2Name = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00783"></a>00783 
<a name="l00784"></a>00784     
<a name="l00785"></a>00785     uv2[0]= uv2[1]= uv2[2]= uv2[3]= <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a>(0.0f, 0.0f);
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="comment">/* No material, what to do? let&#39;s see what is in the UV and set the material accordingly</span>
<a name="l00788"></a>00788 <span class="comment">     * light and visible is always on */</span>
<a name="l00789"></a>00789     <span class="keywordflow">if</span> ( validface ) {
<a name="l00790"></a>00790         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a384e9bb3b6d6f3266b8142b890437da2">tile</a>  = tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a5ff693b49db8a10f21d3e9f9dd99538a">tile</a>;
<a name="l00791"></a>00791             
<a name="l00792"></a>00792         uv[0].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[0]);
<a name="l00793"></a>00793         uv[1].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[1]);
<a name="l00794"></a>00794         uv[2].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[2]);
<a name="l00795"></a>00795 
<a name="l00796"></a>00796         <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>) 
<a name="l00797"></a>00797             uv[3].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[3]);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799         uvName = tfaceName;
<a name="l00800"></a>00800     } 
<a name="l00801"></a>00801     <span class="keywordflow">else</span> {
<a name="l00802"></a>00802         <span class="comment">// nothing at all</span>
<a name="l00803"></a>00803         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a>    = <a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7029d7af71941a92a514e74ed001727">GEMAT_SOLID</a>;
<a name="l00804"></a>00804         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a384e9bb3b6d6f3266b8142b890437da2">tile</a>      = 0;
<a name="l00805"></a>00805         
<a name="l00806"></a>00806         uv[0]= uv[1]= uv[2]= uv[3]= <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a>(0.0f, 0.0f);
<a name="l00807"></a>00807     }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809     <span class="keywordflow">if</span> (validmat &amp;&amp; validface) {
<a name="l00810"></a>00810         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a> = mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#aa27d0575fa94b59c91b4eb396adfe0f5">alpha_blend</a>;
<a name="l00811"></a>00811     }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813     <span class="comment">// with ztransp enabled, enforce alpha blending mode</span>
<a name="l00814"></a>00814     <span class="keywordflow">if</span> (validmat &amp;&amp; (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#ab93c6e013760ce505229d6c6686b1478">MA_TRANSP</a>) &amp;&amp; (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a582c0fe9d451f1c0ede8929648f9dd52">MA_ZTRANSP</a>) &amp;&amp; (material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a> == <a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7029d7af71941a92a514e74ed001727">GEMAT_SOLID</a>))
<a name="l00815"></a>00815         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a> = <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9d7f03d458ed9eb326964cd8733f7b94">GEMAT_ALPHA</a>;
<a name="l00816"></a>00816 
<a name="l00817"></a>00817     <span class="comment">// always zsort alpha + add</span>
<a name="l00818"></a>00818     <span class="keywordflow">if</span> ((<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a>, <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9d7f03d458ed9eb326964cd8733f7b94">GEMAT_ALPHA</a>, <a class="code" href="../../de/db2/DNA__material__types_8h.html#a03ed6bc55badbc77d9c6d9617a54bd0e">GEMAT_ALPHA_SORT</a>, <a class="code" href="../../de/db2/DNA__material__types_8h.html#a680b2522cef7f0875dc99e28ab6488db">GEMAT_ADD</a>) || texalpha) &amp;&amp; (material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad5f88801ba2d792a50c4a5c7937922e4">alphablend</a> != <a class="code" href="../../de/db2/DNA__material__types_8h.html#a5926aa70d1b8cbd54074426b176fe410">GEMAT_CLIP</a> )) {
<a name="l00819"></a>00819         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a85f714f47470dfdaa7b87fa72965f73e">ras_mode</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9ba47e073572a47a01522b766b027f1a16c">ALPHA</a>;
<a name="l00820"></a>00820         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a85f714f47470dfdaa7b87fa72965f73e">ras_mode</a> |= (mat &amp;&amp; (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#aa27d0575fa94b59c91b4eb396adfe0f5">alpha_blend</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a03ed6bc55badbc77d9c6d9617a54bd0e">GEMAT_ALPHA_SORT</a>))? <a class="code" href="../../d1/d4a/BL__Material_8h.html#a229571f072de0056c443b44191c99f9ba461cb9ec6757c83e365846ba10e1ccfb">ZSORT</a>: 0;
<a name="l00821"></a>00821     }
<a name="l00822"></a>00822 
<a name="l00823"></a>00823     <span class="comment">// get uv sets</span>
<a name="l00824"></a>00824     <span class="keywordflow">if</span> (validmat) 
<a name="l00825"></a>00825     {
<a name="l00826"></a>00826         <span class="keywordtype">bool</span> isFirstSet = <span class="keyword">true</span>;
<a name="l00827"></a>00827 
<a name="l00828"></a>00828         <span class="comment">// only two sets implemented, but any of the eight </span>
<a name="l00829"></a>00829         <span class="comment">// sets can make up the two layers</span>
<a name="l00830"></a>00830         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> vind = 0; vind&lt;material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ad49c1d1d2dab4c87e062eee87ccfd514">num_enabled</a>; vind++)
<a name="l00831"></a>00831         {
<a name="l00832"></a>00832             <a class="code" href="../../df/d83/classBL__Mapping.html">BL_Mapping</a> &amp;map = material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aaf6969faa26c953fbd56f9cda6f44605">mapping</a>[vind];
<a name="l00833"></a>00833 
<a name="l00834"></a>00834             <span class="keywordflow">if</span> (map.<a class="code" href="../../df/d83/classBL__Mapping.html#a24bc80a1d8ee32efd1dfeb288bcddec2">uvCoName</a>.<a class="code" href="../../d6/dce/classSTR__String.html#a0160aebe91ec2ecd92f1190bafea7cf9">IsEmpty</a>())
<a name="l00835"></a>00835                 isFirstSet = <span class="keyword">false</span>;
<a name="l00836"></a>00836             <span class="keywordflow">else</span>
<a name="l00837"></a>00837             {
<a name="l00838"></a>00838                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lay=0; lay&lt;<a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#ae22819cd79515b97f4f20edf7efcc762">MAX_MTFACE</a>; lay++)
<a name="l00839"></a>00839                 {
<a name="l00840"></a>00840                     <a class="code" href="../../d5/df3/structMTF__localLayer.html">MTF_localLayer</a>&amp; layer = layers[lay];
<a name="l00841"></a>00841                     <span class="keywordflow">if</span> (layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a> == 0) <span class="keywordflow">break</span>;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843                     <span class="keywordflow">if</span> (strcmp(map.<a class="code" href="../../df/d83/classBL__Mapping.html#a24bc80a1d8ee32efd1dfeb288bcddec2">uvCoName</a>.<a class="code" href="../../d6/dce/classSTR__String.html#a946cab5eea587bf86a388f826fd7e26c">ReadPtr</a>(), layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a>)==0)
<a name="l00844"></a>00844                     {
<a name="l00845"></a>00845                         <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a> uvSet[4];
<a name="l00846"></a>00846 
<a name="l00847"></a>00847                         uvSet[0].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a>-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[0]);
<a name="l00848"></a>00848                         uvSet[1].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a>-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[1]);
<a name="l00849"></a>00849                         uvSet[2].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a>-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[2]);
<a name="l00850"></a>00850 
<a name="l00851"></a>00851                         <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>) 
<a name="l00852"></a>00852                             uvSet[3].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a>-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[3]);
<a name="l00853"></a>00853                         <span class="keywordflow">else</span>
<a name="l00854"></a>00854                             uvSet[3].<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(0.0f, 0.0f);
<a name="l00855"></a>00855 
<a name="l00856"></a>00856                         <span class="keywordflow">if</span> (isFirstSet)
<a name="l00857"></a>00857                         {
<a name="l00858"></a>00858                             uv[0] = uvSet[0]; uv[1] = uvSet[1];
<a name="l00859"></a>00859                             uv[2] = uvSet[2]; uv[3] = uvSet[3];
<a name="l00860"></a>00860                             isFirstSet = <span class="keyword">false</span>;
<a name="l00861"></a>00861                             uvName = layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a>;
<a name="l00862"></a>00862                         }
<a name="l00863"></a>00863                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a>, uvName) != 0)
<a name="l00864"></a>00864                         {
<a name="l00865"></a>00865                             uv2[0] = uvSet[0]; uv2[1] = uvSet[1];
<a name="l00866"></a>00866                             uv2[2] = uvSet[2]; uv2[3] = uvSet[3];
<a name="l00867"></a>00867                             map.<a class="code" href="../../df/d83/classBL__Mapping.html#a34bca173c0f2927d473ecad059e506c3">mapping</a> |= <a class="code" href="../../d1/d4a/BL__Material_8h.html#afb634ae509c7658da38254fd11f8b8e1a4a87ef84950a0adb8ad08797e692d026">USECUSTOMUV</a>;
<a name="l00868"></a>00868                             uv2Name = layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a>;
<a name="l00869"></a>00869                         }
<a name="l00870"></a>00870                     }
<a name="l00871"></a>00871                 }
<a name="l00872"></a>00872             }
<a name="l00873"></a>00873         }
<a name="l00874"></a>00874     }
<a name="l00875"></a>00875 
<a name="l00876"></a>00876     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rgb[4];
<a name="l00877"></a>00877     <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a14fc52c2aebfeb1a89505ee990f7a321">GetRGB</a>(type,mface,mmcol,mat,rgb[0],rgb[1],rgb[2], rgb[3]);
<a name="l00878"></a>00878 
<a name="l00879"></a>00879     <span class="comment">// swap the material color, so MCol on bitmap font works</span>
<a name="l00880"></a>00880     <span class="keywordflow">if</span> (validmat &amp;&amp; type==1 &amp;&amp; (mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#a397c98bd06439151d371cc4085c2acfb">flag</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a8bbde62ac9bb3474c3b0e713430ce248">GEMAT_TEXT</a>))
<a name="l00881"></a>00881     {
<a name="l00882"></a>00882         rgb[0] = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(rgb[0]);
<a name="l00883"></a>00883         rgb[1] = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(rgb[1]);
<a name="l00884"></a>00884         rgb[2] = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(rgb[2]);
<a name="l00885"></a>00885         rgb[3] = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(rgb[3]);
<a name="l00886"></a>00886     }
<a name="l00887"></a>00887 
<a name="l00888"></a>00888     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a02c1e42ae26a0aa5e6addf55e2e7120e">SetConversionRGB</a>(rgb);
<a name="l00889"></a>00889     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a53f3d3a611fa871fc089b14e3b293744">SetConversionUV</a>(uvName, uv);
<a name="l00890"></a>00890     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#ae05c5469a3cd626267204969289d0c6b">SetConversionUV2</a>(uv2Name, uv2);
<a name="l00891"></a>00891 
<a name="l00892"></a>00892     <span class="keywordflow">if</span> (validmat)
<a name="l00893"></a>00893         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a83e2f8154d4280bb3a23a54d65f411c0">matname</a>   =(mat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a3fc06eed9b3244922dd05906dcc58cde">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>);
<a name="l00894"></a>00894 
<a name="l00895"></a>00895     <span class="keywordflow">if</span> (tface) {
<a name="l00896"></a>00896         material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a343e46e95bf2772c130b24455a8e6b27">tface</a>     = *tface;
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898     <span class="keywordflow">else</span> {
<a name="l00899"></a>00899         memset(&amp;material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a343e46e95bf2772c130b24455a8e6b27">tface</a>, 0, <span class="keyword">sizeof</span>(material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a343e46e95bf2772c130b24455a8e6b27">tface</a>));
<a name="l00900"></a>00900     }
<a name="l00901"></a>00901     material-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a81464bdc9a517649d0f2342cb801e9dd">material</a>  = mat;
<a name="l00902"></a>00902     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00903"></a>00903 }
<a name="l00904"></a>00904 
<a name="l00905"></a>00905 <span class="comment">/* blenderobj can be NULL, make sure its checked for */</span>
<a name="l00906"></a><a class="code" href="../../da/d98/BL__BlenderDataConversion_8h.html#a4305652ee5e6d34b608643dc47c3e0e4">00906</a> <a class="code" href="../../d5/d85/classRAS__MeshObject.html">RAS_MeshObject</a>* <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9dbfbbf38d5103b376e1d9d27915075a">BL_ConvertMesh</a>(<a class="code" href="../../da/d29/structMesh.html">Mesh</a>* mesh, <a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobj, <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a>* scene, <a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html">KX_BlenderSceneConverter</a> *converter)
<a name="l00907"></a>00907 {
<a name="l00908"></a>00908     <a class="code" href="../../d5/d85/classRAS__MeshObject.html">RAS_MeshObject</a> *meshobj;
<a name="l00909"></a>00909     <span class="keywordtype">int</span> lightlayer = blenderobj ? blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a>:(1&lt;&lt;20)-1; <span class="comment">// all layers if no object.</span>
<a name="l00910"></a>00910 
<a name="l00911"></a>00911     <span class="keywordflow">if</span> ((meshobj = converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a0bdce6b402feeedbda74f00d8b9f4b1b">FindGameMesh</a>(mesh<span class="comment">/*, ob-&gt;lay*/</span>)) != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00912"></a>00912         <span class="keywordflow">return</span> meshobj;
<a name="l00913"></a>00913     <span class="comment">// Get DerivedMesh data</span>
<a name="l00914"></a>00914     <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *dm = <a class="code" href="../../dd/d15/BKE__cdderivedmesh_8h.html#acf07490dbc6e250966bbfb63d34e7ada">CDDM_from_mesh</a>(mesh, blenderobj);
<a name="l00915"></a>00915     <a class="code" href="../../d0/d7f/BKE__DerivedMesh_8h.html#afed7604eb89f555bfcad4c3ccd1e5a35">DM_ensure_tessface</a>(dm);
<a name="l00916"></a>00916 
<a name="l00917"></a>00917     <a class="code" href="../../d8/de5/structMVert.html">MVert</a> *mvert = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#adf25b9f9aee2bb3846fe2d0c4a2ab1d4">getVertArray</a>(dm);
<a name="l00918"></a>00918     <span class="keywordtype">int</span> totvert = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a3d5c5a506b0705a9071680807da2e7ee">getNumVerts</a>(dm);
<a name="l00919"></a>00919 
<a name="l00920"></a>00920     <a class="code" href="../../d6/da0/structMFace.html">MFace</a> *mface = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#aebdc3d5680e822d40c479530c23a56a1">getTessFaceArray</a>(dm);
<a name="l00921"></a>00921     <a class="code" href="../../da/d7f/structMTFace.html">MTFace</a> *tface = <span class="keyword">static_cast&lt;</span><a class="code" href="../../da/d7f/structMTFace.html">MTFace</a>*<span class="keyword">&gt;</span>(dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ab62c496219df5c1429b6cb0ec051bfac">getTessFaceDataArray</a>(dm, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#af23f4c9ba200ae24e0a1ac80464e7b21">CD_MTFACE</a>));
<a name="l00922"></a>00922     <a class="code" href="../../db/d33/structMCol.html">MCol</a> *mcol = <span class="keyword">static_cast&lt;</span><a class="code" href="../../db/d33/structMCol.html">MCol</a>*<span class="keyword">&gt;</span>(dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ab62c496219df5c1429b6cb0ec051bfac">getTessFaceDataArray</a>(dm, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a24cf4db4f470b454282bf931f4aa58ac">CD_MCOL</a>));
<a name="l00923"></a>00923     float (*tangent)[4] = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00924"></a>00924     <span class="keywordtype">int</span> totface = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a3481fefe300b7d6b456071320be70c56">getNumTessFaces</a>(dm);
<a name="l00925"></a>00925     <span class="keyword">const</span> <span class="keywordtype">char</span> *tfaceName = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00926"></a>00926 
<a name="l00927"></a>00927     <span class="keywordflow">if</span> (tface) {
<a name="l00928"></a>00928         <a class="code" href="../../d0/d7f/BKE__DerivedMesh_8h.html#a63408f7aaa01a246352ce26d0123d480">DM_add_tangent_layer</a>(dm);
<a name="l00929"></a>00929         tangent = (float(*)[4])dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#ab62c496219df5c1429b6cb0ec051bfac">getTessFaceDataArray</a>(dm, <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#a9a75d58928774d1a6eaca221552ba789">CD_TANGENT</a>);
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931 
<a name="l00932"></a>00932     meshobj = <span class="keyword">new</span> <a class="code" href="../../d5/d85/classRAS__MeshObject.html">RAS_MeshObject</a>(mesh);
<a name="l00933"></a>00933 
<a name="l00934"></a>00934     <span class="comment">// Extract avaiable layers</span>
<a name="l00935"></a>00935     <a class="code" href="../../d5/df3/structMTF__localLayer.html">MTF_localLayer</a> *layers =  <span class="keyword">new</span> <a class="code" href="../../d5/df3/structMTF__localLayer.html">MTF_localLayer</a>[<a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#ae22819cd79515b97f4f20edf7efcc762">MAX_MTFACE</a>];
<a name="l00936"></a>00936     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lay=0; lay&lt;<a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#ae22819cd79515b97f4f20edf7efcc762">MAX_MTFACE</a>; lay++) {
<a name="l00937"></a>00937         layers[lay].<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a> = 0;
<a name="l00938"></a>00938         layers[lay].<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00939"></a>00939     }
<a name="l00940"></a>00940 
<a name="l00941"></a>00941     <span class="keywordtype">int</span> validLayers = 0;
<a name="l00942"></a>00942     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a12722e14b04d5f053d93d2a3bb81203e">faceData</a>.<a class="code" href="../../df/d04/structCustomData.html#ae5b4833527392742d84e8f7b46f5f264">totlayer</a>; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)
<a name="l00943"></a>00943     {
<a name="l00944"></a>00944         <span class="keywordflow">if</span> (dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a12722e14b04d5f053d93d2a3bb81203e">faceData</a>.<a class="code" href="../../df/d04/structCustomData.html#a91813d4d92a1349830c9b1e554cf7af6">layers</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d97/structCustomDataLayer.html#a1ba604969c785bba31ef501e7a06cc9c">type</a> == <a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#af23f4c9ba200ae24e0a1ac80464e7b21">CD_MTFACE</a>)
<a name="l00945"></a>00945         {
<a name="l00946"></a>00946             <a class="code" href="../../d5/d8e/Value_8h.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(validLayers &lt;= 8);
<a name="l00947"></a>00947 
<a name="l00948"></a>00948             layers[validLayers].<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a> = (<a class="code" href="../../da/d7f/structMTFace.html">MTFace</a>*)(dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a12722e14b04d5f053d93d2a3bb81203e">faceData</a>.<a class="code" href="../../df/d04/structCustomData.html#a91813d4d92a1349830c9b1e554cf7af6">layers</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d97/structCustomDataLayer.html#a96b03d545e94aacd77c467efb04b1153">data</a>);
<a name="l00949"></a>00949             layers[validLayers].<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a> = dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a12722e14b04d5f053d93d2a3bb81203e">faceData</a>.<a class="code" href="../../df/d04/structCustomData.html#a91813d4d92a1349830c9b1e554cf7af6">layers</a>[<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d5/d97/structCustomDataLayer.html#aa8ef26f614b5037233d4ba102e3286d8">name</a>;
<a name="l00950"></a>00950             <span class="keywordflow">if</span> (tface == layers[validLayers].face)
<a name="l00951"></a>00951                 tfaceName = layers[validLayers].<a class="code" href="../../d5/df3/structMTF__localLayer.html#ac5fe816ef27e65f6c07932d86519e437">name</a>;
<a name="l00952"></a>00952             validLayers++;
<a name="l00953"></a>00953         }
<a name="l00954"></a>00954     }
<a name="l00955"></a>00955 
<a name="l00956"></a>00956     meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#a0d7be83d7736dc4df24d0b1b852fa0fb">SetName</a>(mesh-&gt;<a class="code" href="../../da/d29/structMesh.html#ac10779fc3e00d6d5b8f7ea32adaedd43">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l00957"></a>00957     meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#aa67d74520a6ff0536efed2c360656312">m_sharedvertex_map</a>.resize(totvert);
<a name="l00958"></a>00958     <a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html">RAS_IPolyMaterial</a>* polymat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00959"></a>00959     <a class="code" href="../../d6/dce/classSTR__String.html">STR_String</a> imastr;
<a name="l00960"></a>00960     <span class="comment">// These pointers will hold persistent material structure during the conversion</span>
<a name="l00961"></a>00961     <span class="comment">// to avoid countless allocation/deallocation of memory.</span>
<a name="l00962"></a>00962     <a class="code" href="../../d3/de1/classBL__Material.html">BL_Material</a>* bl_mat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00963"></a>00963     <a class="code" href="../../d2/d90/classKX__BlenderMaterial.html">KX_BlenderMaterial</a>* kx_blmat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00964"></a>00964     <a class="code" href="../../d9/d1f/classKX__PolygonMaterial.html">KX_PolygonMaterial</a>* kx_polymat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00965"></a>00965 
<a name="l00966"></a>00966     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f=0;f&lt;totface;f++,mface++)
<a name="l00967"></a>00967     {
<a name="l00968"></a>00968         <a class="code" href="../../d2/d10/structMaterial.html">Material</a>* ma = 0;
<a name="l00969"></a>00969         <span class="keywordtype">bool</span> collider = <span class="keyword">true</span>;
<a name="l00970"></a>00970         <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a> uv0(0.0,0.0),uv1(0.0,0.0),uv2(0.0,0.0),uv3(0.0,0.0);
<a name="l00971"></a>00971         <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a> uv20(0.0,0.0),uv21(0.0,0.0),uv22(0.0,0.0),uv23(0.0,0.0);
<a name="l00972"></a>00972         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rgb0,rgb1,rgb2,rgb3 = 0;
<a name="l00973"></a>00973 
<a name="l00974"></a>00974         <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a> pt0, pt1, pt2, pt3;
<a name="l00975"></a>00975         <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> no0(0,0,0), no1(0,0,0), no2(0,0,0), no3(0,0,0);
<a name="l00976"></a>00976         <a class="code" href="../../d2/dfc/classMT__Vector4.html">MT_Vector4</a> tan0(0,0,0,0), tan1(0,0,0,0), tan2(0,0,0,0), tan3(0,0,0,0);
<a name="l00977"></a>00977 
<a name="l00978"></a>00978         <span class="comment">/* get coordinates, normals and tangents */</span>
<a name="l00979"></a>00979         pt0.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af98629114dfe61b7e4c27dee89d7e94d">setValue</a>(mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a7bbd2d1ca59c1ed8edd859c0a869081d">v1</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l00980"></a>00980         pt1.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af98629114dfe61b7e4c27dee89d7e94d">setValue</a>(mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a3e56f10b57b97167b3db97024920f693">v2</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l00981"></a>00981         pt2.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af98629114dfe61b7e4c27dee89d7e94d">setValue</a>(mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ac3bd1c8c8cb82e73685b9bfead2b30da">v3</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l00982"></a>00982         <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>) pt3.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af98629114dfe61b7e4c27dee89d7e94d">setValue</a>(mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984         <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a729da859ed02b2946331e7f82f3ff20c">flag</a> &amp; <a class="code" href="../../d4/d36/DNA__meshdata__types_8h.html#a2907e1f781802f5886994a86e0ee6fd1">ME_SMOOTH</a>) {
<a name="l00985"></a>00985             <span class="keywordtype">float</span> n0[3], n1[3], n2[3], n3[3];
<a name="l00986"></a>00986 
<a name="l00987"></a>00987             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a57d12e99226ed5380368efa5add45b75">normal_short_to_float_v3</a>(n0, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a7bbd2d1ca59c1ed8edd859c0a869081d">v1</a>].<a class="code" href="../../d8/de5/structMVert.html#aac14cce64a2131bbdee5ea8fc1d64909">no</a>);
<a name="l00988"></a>00988             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a57d12e99226ed5380368efa5add45b75">normal_short_to_float_v3</a>(n1, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a3e56f10b57b97167b3db97024920f693">v2</a>].<a class="code" href="../../d8/de5/structMVert.html#aac14cce64a2131bbdee5ea8fc1d64909">no</a>);
<a name="l00989"></a>00989             <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a57d12e99226ed5380368efa5add45b75">normal_short_to_float_v3</a>(n2, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ac3bd1c8c8cb82e73685b9bfead2b30da">v3</a>].<a class="code" href="../../d8/de5/structMVert.html#aac14cce64a2131bbdee5ea8fc1d64909">no</a>);
<a name="l00990"></a>00990             no0 = n0;
<a name="l00991"></a>00991             no1 = n1;
<a name="l00992"></a>00992             no2 = n2;
<a name="l00993"></a>00993 
<a name="l00994"></a>00994             <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>) {
<a name="l00995"></a>00995                 <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a57d12e99226ed5380368efa5add45b75">normal_short_to_float_v3</a>(n3, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>].<a class="code" href="../../d8/de5/structMVert.html#aac14cce64a2131bbdee5ea8fc1d64909">no</a>);
<a name="l00996"></a>00996                 no3 = n3;
<a name="l00997"></a>00997             }
<a name="l00998"></a>00998         }
<a name="l00999"></a>00999         <span class="keywordflow">else</span> {
<a name="l01000"></a>01000             <span class="keywordtype">float</span> fno[3];
<a name="l01001"></a>01001 
<a name="l01002"></a>01002             <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l01003"></a>01003                 <a class="code" href="../../d9/dc3/BLI__math__geom_8h.html#a79b270ef64d46a87c7739ff2042fb7db">normal_quad_v3</a>( fno,mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a7bbd2d1ca59c1ed8edd859c0a869081d">v1</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a3e56f10b57b97167b3db97024920f693">v2</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ac3bd1c8c8cb82e73685b9bfead2b30da">v3</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l01004"></a>01004             <span class="keywordflow">else</span>
<a name="l01005"></a>01005                 <a class="code" href="../../d9/dc3/BLI__math__geom_8h.html#ada7050cefa95b7a630489eddee0c3834">normal_tri_v3</a>( fno,mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a7bbd2d1ca59c1ed8edd859c0a869081d">v1</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a3e56f10b57b97167b3db97024920f693">v2</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>, mvert[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ac3bd1c8c8cb82e73685b9bfead2b30da">v3</a>].<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>);
<a name="l01006"></a>01006 
<a name="l01007"></a>01007             no0 = no1 = no2 = no3 = <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a>(fno);
<a name="l01008"></a>01008         }
<a name="l01009"></a>01009 
<a name="l01010"></a>01010         <span class="keywordflow">if</span> (tangent) {
<a name="l01011"></a>01011             tan0 = tangent[f*4 + 0];
<a name="l01012"></a>01012             tan1 = tangent[f*4 + 1];
<a name="l01013"></a>01013             tan2 = tangent[f*4 + 2];
<a name="l01014"></a>01014 
<a name="l01015"></a>01015             <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l01016"></a>01016                 tan3 = tangent[f*4 + 3];
<a name="l01017"></a>01017         }
<a name="l01018"></a>01018         <span class="keywordflow">if</span> (blenderobj)
<a name="l01019"></a>01019             ma = <a class="code" href="../../d4/d0f/BKE__material_8h.html#a941f5112d1047bcbcf3e2212685296a5">give_current_material</a>(blenderobj, mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a9263f86fc8c22b7f355bcade20574047">mat_nr</a>+1);
<a name="l01020"></a>01020         <span class="keywordflow">else</span>
<a name="l01021"></a>01021             ma = mesh-&gt;<a class="code" href="../../da/d29/structMesh.html#a4fdee04a24d1a821f3bfa659b3bd8156">mat</a> ? mesh-&gt;<a class="code" href="../../da/d29/structMesh.html#a4fdee04a24d1a821f3bfa659b3bd8156">mat</a>[mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a9263f86fc8c22b7f355bcade20574047">mat_nr</a>]:<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01022"></a>01022 
<a name="l01023"></a>01023         <span class="comment">/* ckeck for texface since texface _only_ is used as a fallback */</span>
<a name="l01024"></a>01024         <span class="keywordflow">if</span> (ma == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; tface == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01025"></a>01025             ma= &amp;<a class="code" href="../../de/d87/material_8c.html#a685518354e9af381cf9881b703cad017">defmaterial</a>;
<a name="l01026"></a>01026         }
<a name="l01027"></a>01027 
<a name="l01028"></a>01028         {
<a name="l01029"></a>01029             <span class="keywordtype">bool</span> visible = <span class="keyword">true</span>;
<a name="l01030"></a>01030             <span class="keywordtype">bool</span> twoside = <span class="keyword">false</span>;
<a name="l01031"></a>01031 
<a name="l01032"></a>01032             <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a0c62bbec2c2cf3d535f8c7f63b107d47">GetMaterials</a>()) {
<a name="l01033"></a>01033                 <span class="comment">/* do Blender Multitexture and Blender GLSL materials */</span>
<a name="l01034"></a>01034                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rgb[4];
<a name="l01035"></a>01035                 <a class="code" href="../../d1/daa/classMT__Point2.html">MT_Point2</a> uv[4];
<a name="l01036"></a>01036 
<a name="l01037"></a>01037                 <span class="comment">/* first is the BL_Material */</span>
<a name="l01038"></a>01038                 <span class="keywordflow">if</span> (!bl_mat)
<a name="l01039"></a>01039                     bl_mat = <span class="keyword">new</span> <a class="code" href="../../d3/de1/classBL__Material.html">BL_Material</a>();
<a name="l01040"></a>01040                 <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a3e0e88c03da354310fc96bdc52145c4c">ConvertMaterial</a>(bl_mat, ma, tface, tfaceName, mface, mcol,
<a name="l01041"></a>01041                     layers, converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#afe1f045607e0bef2aa9bee3482c04290">GetGLSLMaterials</a>());
<a name="l01042"></a>01042 
<a name="l01043"></a>01043                 <span class="comment">/* vertex colors and uv&#39;s were stored in bl_mat temporarily */</span>
<a name="l01044"></a>01044                 bl_mat-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a98380da2a8a94610afe15b8cabe9c9d3">GetConversionRGB</a>(rgb);
<a name="l01045"></a>01045                 rgb0 = rgb[0]; rgb1 = rgb[1];
<a name="l01046"></a>01046                 rgb2 = rgb[2]; rgb3 = rgb[3];
<a name="l01047"></a>01047 
<a name="l01048"></a>01048                 bl_mat-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#a540b458c885ecb2c830b507432eca7d0">GetConversionUV</a>(uv);
<a name="l01049"></a>01049                 uv0 = uv[0]; uv1 = uv[1];
<a name="l01050"></a>01050                 uv2 = uv[2]; uv3 = uv[3];
<a name="l01051"></a>01051 
<a name="l01052"></a>01052                 bl_mat-&gt;<a class="code" href="../../d3/de1/classBL__Material.html#aa8b1b0c98aa143bb6129b7b0439e9edc">GetConversionUV2</a>(uv);
<a name="l01053"></a>01053                 uv20 = uv[0]; uv21 = uv[1];
<a name="l01054"></a>01054                 uv22 = uv[2]; uv23 = uv[3];
<a name="l01055"></a>01055                 
<a name="l01056"></a>01056                 <span class="comment">/* then the KX_BlenderMaterial */</span>
<a name="l01057"></a>01057                 <span class="keywordflow">if</span> (kx_blmat == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01058"></a>01058                     kx_blmat = <span class="keyword">new</span> <a class="code" href="../../d2/d90/classKX__BlenderMaterial.html">KX_BlenderMaterial</a>();
<a name="l01059"></a>01059 
<a name="l01060"></a>01060                 kx_blmat-&gt;<a class="code" href="../../d2/d90/classKX__BlenderMaterial.html#a53dab4a50dac5e47ea48b20b43ee1f81">Initialize</a>(scene, bl_mat, (ma?&amp;ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>:<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));
<a name="l01061"></a>01061                 polymat = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html">RAS_IPolyMaterial</a>*<span class="keyword">&gt;</span>(kx_blmat);
<a name="l01062"></a>01062             }
<a name="l01063"></a>01063             <span class="keywordflow">else</span> {
<a name="l01064"></a>01064                 <span class="comment">/* do Texture Face materials */</span>
<a name="l01065"></a>01065                 <a class="code" href="../../d8/d00/classImage.html" title="32 bit RGBA image.">Image</a>* bima = (tface)? (<a class="code" href="../../d8/d00/classImage.html" title="32 bit RGBA image.">Image</a>*)tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a94b886f25499ad61afed79c6362451ef">tpage</a>: <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01066"></a>01066                 imastr =  (tface)? (bima? (bima)-&gt;<a class="code" href="../../d8/d00/classImage.html#aaf5fcd281cf4337d6686322f82187896">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> : <span class="stringliteral">&quot;&quot;</span> ) : <span class="stringliteral">&quot;&quot;</span>;
<a name="l01067"></a>01067         
<a name="l01068"></a>01068                 <span class="keywordtype">char</span> alpha_blend=0;
<a name="l01069"></a>01069                 <span class="keywordtype">short</span> tile=0;
<a name="l01070"></a>01070                 <span class="keywordtype">int</span> tilexrep=4,tileyrep = 4;
<a name="l01071"></a>01071 
<a name="l01072"></a>01072                 <span class="comment">/* set material properties - old TexFace */</span>
<a name="l01073"></a>01073                 <span class="keywordflow">if</span> (ma) {
<a name="l01074"></a>01074                     alpha_blend = ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#aa27d0575fa94b59c91b4eb396adfe0f5">alpha_blend</a>;
<a name="l01075"></a>01075                     <span class="comment">/* Commented out for now. If we ever get rid of</span>
<a name="l01076"></a>01076 <span class="comment">                     * &quot;Texture Face/Singletexture&quot; we can then think about it */</span>
<a name="l01077"></a>01077 
<a name="l01078"></a>01078                     <span class="comment">/* Texture Face mode ignores texture but requires &quot;Face Textures to be True &quot;*/</span>
<a name="l01079"></a>01079 <span class="preprocessor">#if 0</span>
<a name="l01080"></a>01080 <span class="preprocessor"></span>                    <span class="keywordflow">if</span> ((ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#a95f694c6f90519ab830e9b9fa87d62e6">MA_FACETEXTURE</a>)==0 &amp;&amp; (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#a397c98bd06439151d371cc4085c2acfb">flag</a> &amp;<a class="code" href="../../de/db2/DNA__material__types_8h.html#a8bbde62ac9bb3474c3b0e713430ce248">GEMAT_TEXT</a>)==0) {
<a name="l01081"></a>01081                         bima = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01082"></a>01082                         imastr = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01083"></a>01083                         alpha_blend = <a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7029d7af71941a92a514e74ed001727">GEMAT_SOLID</a>;   
<a name="l01084"></a>01084                     }
<a name="l01085"></a>01085                     <span class="keywordflow">else</span> {
<a name="l01086"></a>01086                         alpha_blend = ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#aa27d0575fa94b59c91b4eb396adfe0f5">alpha_blend</a>;
<a name="l01087"></a>01087                     }
<a name="l01088"></a>01088 <span class="preprocessor">#endif</span>
<a name="l01089"></a>01089 <span class="preprocessor"></span>                }
<a name="l01090"></a>01090                 <span class="comment">/* check for tface tex to fallback on */</span>
<a name="l01091"></a>01091                 <span class="keywordflow">else</span> {
<a name="l01092"></a>01092                     <span class="keywordflow">if</span> (bima) {
<a name="l01093"></a>01093                         <span class="comment">/* see if depth of the image is 32 */</span>
<a name="l01094"></a>01094                         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d77/BKE__image_8h.html#a0414fa198129a6dbec124c02a42c0e5c">BKE_image_has_alpha</a>(bima))
<a name="l01095"></a>01095                             alpha_blend = <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9d7f03d458ed9eb326964cd8733f7b94">GEMAT_ALPHA</a>;
<a name="l01096"></a>01096                         <span class="keywordflow">else</span>
<a name="l01097"></a>01097                             alpha_blend = <a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7029d7af71941a92a514e74ed001727">GEMAT_SOLID</a>;
<a name="l01098"></a>01098                     }
<a name="l01099"></a>01099                     <span class="keywordflow">else</span> {
<a name="l01100"></a>01100                         alpha_blend = <a class="code" href="../../de/db2/DNA__material__types_8h.html#ad7029d7af71941a92a514e74ed001727">GEMAT_SOLID</a>;
<a name="l01101"></a>01101                     }
<a name="l01102"></a>01102                 }
<a name="l01103"></a>01103 
<a name="l01104"></a>01104                 <span class="keywordflow">if</span> (bima) {
<a name="l01105"></a>01105                     tilexrep = bima-&gt;<a class="code" href="../../d8/d00/classImage.html#a4a8434eea71145fbb4de56f4b65e201d">xrep</a>;
<a name="l01106"></a>01106                     tileyrep = bima-&gt;<a class="code" href="../../d8/d00/classImage.html#a2e13fd1505d81eadcb27ba03f90797cc">yrep</a>;
<a name="l01107"></a>01107                 }
<a name="l01108"></a>01108 
<a name="l01109"></a>01109                 <span class="comment">/* set UV properties */</span>
<a name="l01110"></a>01110                 <span class="keywordflow">if</span> (tface) {
<a name="l01111"></a>01111                     uv0.setValue(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[0]);
<a name="l01112"></a>01112                     uv1.setValue(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[1]);
<a name="l01113"></a>01113                     uv2.setValue(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[2]);
<a name="l01114"></a>01114     
<a name="l01115"></a>01115                     <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l01116"></a>01116                         uv3.<a class="code" href="../../d7/dba/classMT__Tuple2.html#ac0cce81003a17b9abe4bf93446ad85d6">setValue</a>(tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a8008df692b4527be183b85665cdde582">uv</a>[3]);
<a name="l01117"></a>01117 
<a name="l01118"></a>01118                     tile = tface-&gt;<a class="code" href="../../da/d7f/structMTFace.html#a5ff693b49db8a10f21d3e9f9dd99538a">tile</a>;
<a name="l01119"></a>01119                 } 
<a name="l01120"></a>01120                 <span class="keywordflow">else</span> {
<a name="l01121"></a>01121                     <span class="comment">/* no texfaces */</span>
<a name="l01122"></a>01122                     tile = 0;
<a name="l01123"></a>01123                 }
<a name="l01124"></a>01124 
<a name="l01125"></a>01125                 <span class="comment">/* get vertex colors */</span>
<a name="l01126"></a>01126                 <span class="keywordflow">if</span> (mcol) {
<a name="l01127"></a>01127                     <span class="comment">/* we have vertex colors */</span>
<a name="l01128"></a>01128                     rgb0 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mcol[0]);
<a name="l01129"></a>01129                     rgb1 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mcol[1]);
<a name="l01130"></a>01130                     rgb2 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mcol[2]);
<a name="l01131"></a>01131                     
<a name="l01132"></a>01132                     <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l01133"></a>01133                         rgb3 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a51b2d3ae50d1c2cac659470873d2ccf9">KX_Mcol2uint_new</a>(mcol[3]);
<a name="l01134"></a>01134                 }
<a name="l01135"></a>01135                 <span class="keywordflow">else</span> {
<a name="l01136"></a>01136                     <span class="comment">/* no vertex colors, take from material, otherwise white */</span>
<a name="l01137"></a>01137                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> color = 0xFFFFFFFF<a class="code" href="../../d2/d6c/mball_8c.html#aa73214aa5f2f94f63d90bb4e3d99fe53">L</a>;
<a name="l01138"></a>01138 
<a name="l01139"></a>01139                     <span class="keywordflow">if</span> (ma)
<a name="l01140"></a>01140                     {
<a name="l01141"></a>01141                         <span class="keyword">union</span>
<a name="l01142"></a>01142                         {
<a name="l01143"></a>01143                             <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cp[4];
<a name="l01144"></a>01144                             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> integer;
<a name="l01145"></a>01145                         } col_converter;
<a name="l01146"></a>01146                         
<a name="l01147"></a>01147                         col_converter.cp[3] = (<span class="keywordtype">unsigned</span> char) (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9e892cbd7e25b6fd5ee00c383cd9cacf">r</a>*255.0);
<a name="l01148"></a>01148                         col_converter.cp[2] = (<span class="keywordtype">unsigned</span> char) (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a4b832bd11d2b3d00ab74a269f2f2e9e8">g</a>*255.0);
<a name="l01149"></a>01149                         col_converter.cp[1] = (<span class="keywordtype">unsigned</span> char) (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a01ac5d90e907d35afcf7af9cf6b17c04">b</a>*255.0);
<a name="l01150"></a>01150                         col_converter.cp[0] = (<span class="keywordtype">unsigned</span> char) (ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ac0f2eb80623ad884c7fa770e47ae92a2">alpha</a>*255.0);
<a name="l01151"></a>01151                         
<a name="l01152"></a>01152                         color = col_converter.integer;
<a name="l01153"></a>01153                     }
<a name="l01154"></a>01154 
<a name="l01155"></a>01155                     rgb0 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l01156"></a>01156                     rgb1 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l01157"></a>01157                     rgb2 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);  
<a name="l01158"></a>01158                     
<a name="l01159"></a>01159                     <span class="keywordflow">if</span> (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)
<a name="l01160"></a>01160                         rgb3 = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9fed2e837982314af108e6bdee1de1c0">KX_rgbaint2uint_new</a>(color);
<a name="l01161"></a>01161                 }
<a name="l01162"></a>01162 
<a name="l01163"></a>01163                 <span class="comment">// only zsort alpha + add</span>
<a name="l01164"></a>01164                 <span class="keywordtype">bool</span> alpha = <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ad3568ab74428f47aea1c855024e467f0">ELEM3</a>(alpha_blend, <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9d7f03d458ed9eb326964cd8733f7b94">GEMAT_ALPHA</a>, <a class="code" href="../../de/db2/DNA__material__types_8h.html#a680b2522cef7f0875dc99e28ab6488db">GEMAT_ADD</a>, <a class="code" href="../../de/db2/DNA__material__types_8h.html#a03ed6bc55badbc77d9c6d9617a54bd0e">GEMAT_ALPHA_SORT</a>);
<a name="l01165"></a>01165                 <span class="keywordtype">bool</span> zsort = (alpha_blend == <a class="code" href="../../de/db2/DNA__material__types_8h.html#a03ed6bc55badbc77d9c6d9617a54bd0e">GEMAT_ALPHA_SORT</a>);
<a name="l01166"></a>01166                 <span class="keywordtype">bool</span> light = (ma)?(ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ad4773378c42a4167bdd615d67997535e">mode</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a711a44cc51cfb78f529c3ac59306e756">MA_SHLESS</a>)==0:<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a355807bfa0fd16a65e29a0c50714bac6">default_light_mode</a>;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168                 <span class="comment">// don&#39;t need zort anymore, deal as if it it&#39;s alpha blend</span>
<a name="l01169"></a>01169                 <span class="keywordflow">if</span> (alpha_blend == <a class="code" href="../../de/db2/DNA__material__types_8h.html#a03ed6bc55badbc77d9c6d9617a54bd0e">GEMAT_ALPHA_SORT</a>) alpha_blend = <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9d7f03d458ed9eb326964cd8733f7b94">GEMAT_ALPHA</a>;
<a name="l01170"></a>01170 
<a name="l01171"></a>01171                 <span class="keywordflow">if</span> (kx_polymat == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01172"></a>01172                     kx_polymat = <span class="keyword">new</span> <a class="code" href="../../d9/d1f/classKX__PolygonMaterial.html">KX_PolygonMaterial</a>();
<a name="l01173"></a>01173                 kx_polymat-&gt;<a class="code" href="../../d9/d1f/classKX__PolygonMaterial.html#ab932f6b04bd25afd78af95dc9e43aa58">Initialize</a>(imastr, ma, (<span class="keywordtype">int</span>)mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a9263f86fc8c22b7f355bcade20574047">mat_nr</a>,
<a name="l01174"></a>01174                     tile, tilexrep, tileyrep, 
<a name="l01175"></a>01175                     alpha_blend, alpha, zsort, light, lightlayer, tface, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*)mcol);
<a name="l01176"></a>01176                 polymat = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html">RAS_IPolyMaterial</a>*<span class="keyword">&gt;</span>(kx_polymat);
<a name="l01177"></a>01177     
<a name="l01178"></a>01178                 <span class="keywordflow">if</span> (ma) {
<a name="l01179"></a>01179                     polymat-&gt;<a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html#a409606f225848e6bd7b39b4f6e1cedb8">m_specular</a> = <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a>(ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#af595797ad989716e9a27949aa0fc3fcb">specr</a>, ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a056953ed5167834167da6744af3ef1ff">specg</a>, ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ac7a3474ca6b651dbd0cb99b3849750e2">specb</a>)*ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9fde6991e416c1b39b8977dc7d345fc9">spec</a>;
<a name="l01180"></a>01180                     polymat-&gt;<a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html#a09f37a4e4216e9ae7cc3da5c467c6146">m_shininess</a> = (float)ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#af7e6796633eed3cf2fe85a929fd11199">har</a>/4.0f; <span class="comment">// 0 &lt; ma-&gt;har &lt;= 512</span>
<a name="l01181"></a>01181                     polymat-&gt;<a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html#a400b10318af0254e45dec0b2ae67199d">m_diffuse</a> = <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a>(ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9e892cbd7e25b6fd5ee00c383cd9cacf">r</a>, ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a4b832bd11d2b3d00ab74a269f2f2e9e8">g</a>, ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a01ac5d90e907d35afcf7af9cf6b17c04">b</a>)*(ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aff92c6c1d611b91f0dfcbb80992ca89c">emit</a> + ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#afe35ce8fce88e740bc54505576f4b65a">ref</a>);
<a name="l01182"></a>01182                 }
<a name="l01183"></a>01183                 <span class="keywordflow">else</span> {
<a name="l01184"></a>01184                     polymat-&gt;<a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html#a409606f225848e6bd7b39b4f6e1cedb8">m_specular</a>.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af98629114dfe61b7e4c27dee89d7e94d">setValue</a>(0.0f,0.0f,0.0f);
<a name="l01185"></a>01185                     polymat-&gt;<a class="code" href="../../d1/d00/classRAS__IPolyMaterial.html#a09f37a4e4216e9ae7cc3da5c467c6146">m_shininess</a> = 35.0;
<a name="l01186"></a>01186                 }
<a name="l01187"></a>01187             }
<a name="l01188"></a>01188 
<a name="l01189"></a>01189             <span class="comment">// set render flags</span>
<a name="l01190"></a>01190             <span class="keywordflow">if</span> (ma)
<a name="l01191"></a>01191             {
<a name="l01192"></a>01192                 visible = ((ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#a397c98bd06439151d371cc4085c2acfb">flag</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a9e033cf1da5b00cbb91d56182a59b8c4">GEMAT_INVISIBLE</a>)==0);
<a name="l01193"></a>01193                 twoside = ((ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#a397c98bd06439151d371cc4085c2acfb">flag</a>  &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a05f438c08666b75c7a79f95cb3811314">GEMAT_BACKCULL</a>)==0);
<a name="l01194"></a>01194                 collider = ((ma-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a704bae714f83df324006557b2c386d12">game</a>.<a class="code" href="../../d1/d3d/structGameSettings.html#a397c98bd06439151d371cc4085c2acfb">flag</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#a19919e59af0a97159b4f15f0a7652b38">GEMAT_NOPHYSICS</a>)==0);
<a name="l01195"></a>01195             }
<a name="l01196"></a>01196             <span class="keywordflow">else</span>{
<a name="l01197"></a>01197                 visible = <span class="keyword">true</span>;
<a name="l01198"></a>01198                 twoside = <span class="keyword">false</span>;
<a name="l01199"></a>01199                 collider = <span class="keyword">true</span>;
<a name="l01200"></a>01200             }
<a name="l01201"></a>01201 
<a name="l01202"></a>01202             <span class="comment">/* mark face as flat, so vertices are split */</span>
<a name="l01203"></a>01203             <span class="keywordtype">bool</span> flat = (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a729da859ed02b2946331e7f82f3ff20c">flag</a> &amp; <a class="code" href="../../d4/d36/DNA__meshdata__types_8h.html#a2907e1f781802f5886994a86e0ee6fd1">ME_SMOOTH</a>) == 0;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205             <span class="comment">// see if a bucket was reused or a new one was created</span>
<a name="l01206"></a>01206             <span class="comment">// this way only one KX_BlenderMaterial object has to exist per bucket</span>
<a name="l01207"></a>01207             <span class="keywordtype">bool</span> bucketCreated; 
<a name="l01208"></a>01208             <a class="code" href="../../de/dc6/classRAS__MaterialBucket.html">RAS_MaterialBucket</a>* bucket = scene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a128d13556724e1951eeb3e32a1c5b679">FindBucket</a>(polymat, bucketCreated);
<a name="l01209"></a>01209             <span class="keywordflow">if</span> (bucketCreated) {
<a name="l01210"></a>01210                 <span class="comment">// this is needed to free up memory afterwards</span>
<a name="l01211"></a>01211                 converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a4e2d7e9b1493bf1da3f38923ab89e417">RegisterPolyMaterial</a>(polymat);
<a name="l01212"></a>01212                 <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a0c62bbec2c2cf3d535f8c7f63b107d47">GetMaterials</a>()) {
<a name="l01213"></a>01213                     converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a06ada250260e5c21417591c991158b7f">RegisterBlenderMaterial</a>(bl_mat);
<a name="l01214"></a>01214                     <span class="comment">// the poly material has been stored in the bucket, next time we must create a new one</span>
<a name="l01215"></a>01215                     bl_mat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01216"></a>01216                     kx_blmat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01217"></a>01217                 } <span class="keywordflow">else</span> {
<a name="l01218"></a>01218                     <span class="comment">// the poly material has been stored in the bucket, next time we must create a new one</span>
<a name="l01219"></a>01219                     kx_polymat = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01220"></a>01220                 }
<a name="l01221"></a>01221             } <span class="keywordflow">else</span> {
<a name="l01222"></a>01222                 <span class="comment">// from now on, use the polygon material from the material bucket</span>
<a name="l01223"></a>01223                 polymat = bucket-&gt;<a class="code" href="../../de/dc6/classRAS__MaterialBucket.html#acc588ec1f42649b68ce44a4b1dd02711">GetPolyMaterial</a>();
<a name="l01224"></a>01224                 <span class="comment">// keep the material pointers, they will be reused for next face</span>
<a name="l01225"></a>01225             }
<a name="l01226"></a>01226                          
<a name="l01227"></a>01227             <span class="keywordtype">int</span> nverts = (mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>)? 4: 3;
<a name="l01228"></a>01228             <a class="code" href="../../dc/dd9/classRAS__Polygon.html">RAS_Polygon</a> *poly = meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#afcb8922a10825c0aecfff94ac85c71d8">AddPolygon</a>(bucket, nverts);
<a name="l01229"></a>01229 
<a name="l01230"></a>01230             poly-&gt;<a class="code" href="../../dc/dd9/classRAS__Polygon.html#a074063e3d6956f80fc0c5f28d967a27d">SetVisible</a>(visible);
<a name="l01231"></a>01231             poly-&gt;<a class="code" href="../../dc/dd9/classRAS__Polygon.html#a2a53e3e16c869b2d4ee3df3f4a0189d4">SetCollider</a>(collider);
<a name="l01232"></a>01232             poly-&gt;<a class="code" href="../../dc/dd9/classRAS__Polygon.html#ab677308f18439a65ff47aba74974fe1e">SetTwoside</a>(twoside);
<a name="l01233"></a>01233             <span class="comment">//poly-&gt;SetEdgeCode(mface-&gt;edcode);</span>
<a name="l01234"></a>01234 
<a name="l01235"></a>01235             meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#af27a4c45c55bc5c9839bcddfa39f2452">AddVertex</a>(poly,0,pt0,uv0,uv20,tan0,rgb0,no0,flat,mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a7bbd2d1ca59c1ed8edd859c0a869081d">v1</a>);
<a name="l01236"></a>01236             meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#af27a4c45c55bc5c9839bcddfa39f2452">AddVertex</a>(poly,1,pt1,uv1,uv21,tan1,rgb1,no1,flat,mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#a3e56f10b57b97167b3db97024920f693">v2</a>);
<a name="l01237"></a>01237             meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#af27a4c45c55bc5c9839bcddfa39f2452">AddVertex</a>(poly,2,pt2,uv2,uv22,tan2,rgb2,no2,flat,mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ac3bd1c8c8cb82e73685b9bfead2b30da">v3</a>);
<a name="l01238"></a>01238 
<a name="l01239"></a>01239             <span class="keywordflow">if</span> (nverts==4)
<a name="l01240"></a>01240                 meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#af27a4c45c55bc5c9839bcddfa39f2452">AddVertex</a>(poly,3,pt3,uv3,uv23,tan3,rgb3,no3,flat,mface-&gt;<a class="code" href="../../d6/da0/structMFace.html#ab3fb5a76f4c838226244c710af79e3fc">v4</a>);
<a name="l01241"></a>01241         }
<a name="l01242"></a>01242 
<a name="l01243"></a>01243         <span class="keywordflow">if</span> (tface) 
<a name="l01244"></a>01244             tface++;
<a name="l01245"></a>01245         <span class="keywordflow">if</span> (mcol)
<a name="l01246"></a>01246             mcol+=4;
<a name="l01247"></a>01247 
<a name="l01248"></a>01248         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lay=0; lay&lt;<a class="code" href="../../d8/d9f/DNA__customdata__types_8h.html#ae22819cd79515b97f4f20edf7efcc762">MAX_MTFACE</a>; lay++)
<a name="l01249"></a>01249         {
<a name="l01250"></a>01250             <a class="code" href="../../d5/df3/structMTF__localLayer.html">MTF_localLayer</a> &amp;layer = layers[lay];
<a name="l01251"></a>01251             <span class="keywordflow">if</span> (layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a> == 0) <span class="keywordflow">break</span>;
<a name="l01252"></a>01252 
<a name="l01253"></a>01253             layer.<a class="code" href="../../d5/df3/structMTF__localLayer.html#a4acb17c63efd51f2ea7e863342208bba">face</a>++;
<a name="l01254"></a>01254         }
<a name="l01255"></a>01255     }
<a name="l01256"></a>01256     <span class="comment">// keep meshobj-&gt;m_sharedvertex_map for reinstance phys mesh.</span>
<a name="l01257"></a>01257     <span class="comment">// 2.49a and before it did: meshobj-&gt;m_sharedvertex_map.clear();</span>
<a name="l01258"></a>01258     <span class="comment">// but this didnt save much ram. - Campbell</span>
<a name="l01259"></a>01259     meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#af6d577125fcea28292030658adcb4ca1">EndConversion</a>();
<a name="l01260"></a>01260 
<a name="l01261"></a>01261     <span class="comment">// pre calculate texture generation</span>
<a name="l01262"></a>01262     <span class="keywordflow">for</span> (list&lt;RAS_MeshMaterial&gt;::iterator mit = meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#aacb4031876fbe05055f76960e65cfe52">GetFirstMaterial</a>();
<a name="l01263"></a>01263         mit != meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#a17f47ec4725583656021c85e7cee012f">GetLastMaterial</a>(); ++ mit) {
<a name="l01264"></a>01264         mit-&gt;m_bucket-&gt;GetPolyMaterial()-&gt;OnConstruction(lightlayer);
<a name="l01265"></a>01265     }
<a name="l01266"></a>01266 
<a name="l01267"></a>01267     <span class="keywordflow">if</span> (layers)
<a name="l01268"></a>01268         <span class="keyword">delete</span> []layers;
<a name="l01269"></a>01269     
<a name="l01270"></a>01270     dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a36c159344a023f5fbe64f12006c8647f">release</a>(dm);
<a name="l01271"></a>01271     <span class="comment">// cleanup material</span>
<a name="l01272"></a>01272     <span class="keywordflow">if</span> (bl_mat)
<a name="l01273"></a>01273         <span class="keyword">delete</span> bl_mat;
<a name="l01274"></a>01274     <span class="keywordflow">if</span> (kx_blmat)
<a name="l01275"></a>01275         <span class="keyword">delete</span> kx_blmat;
<a name="l01276"></a>01276     <span class="keywordflow">if</span> (kx_polymat)
<a name="l01277"></a>01277         <span class="keyword">delete</span> kx_polymat;
<a name="l01278"></a>01278     converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a606e3b9c61879416e2a63a90f8f9f12e">RegisterGameMesh</a>(meshobj, mesh);
<a name="l01279"></a>01279     <span class="keywordflow">return</span> meshobj;
<a name="l01280"></a>01280 }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282     
<a name="l01283"></a>01283     
<a name="l01284"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af8f375d572e6062e787ae799c21aed85">01284</a> <span class="keyword">static</span> <a class="code" href="../../d7/dce/structPHY__MaterialProps.html">PHY_MaterialProps</a> *<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af8f375d572e6062e787ae799c21aed85">CreateMaterialFromBlenderObject</a>(<span class="keyword">struct</span> <a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject)
<a name="l01285"></a>01285 {
<a name="l01286"></a>01286     <a class="code" href="../../d7/dce/structPHY__MaterialProps.html">PHY_MaterialProps</a> *materialProps = <span class="keyword">new</span> <a class="code" href="../../d7/dce/structPHY__MaterialProps.html">PHY_MaterialProps</a>;
<a name="l01287"></a>01287     
<a name="l01288"></a>01288     <a class="code" href="../../dc/d60/MT__assert_8h.html#a9a255d1fa64eae77485b7bc71c1b4c97">MT_assert</a>(materialProps &amp;&amp; <span class="stringliteral">&quot;Create physics material properties failed&quot;</span>);
<a name="l01289"></a>01289         
<a name="l01290"></a>01290     <a class="code" href="../../d2/d10/structMaterial.html">Material</a>* blendermat = <a class="code" href="../../d4/d0f/BKE__material_8h.html#a941f5112d1047bcbcf3e2212685296a5">give_current_material</a>(blenderobject, 0);
<a name="l01291"></a>01291         
<a name="l01292"></a>01292     <span class="keywordflow">if</span> (blendermat)
<a name="l01293"></a>01293     {
<a name="l01294"></a>01294         <a class="code" href="../../dc/d60/MT__assert_8h.html#a9a255d1fa64eae77485b7bc71c1b4c97">MT_assert</a>(0.0f &lt;= blendermat-&gt;<a class="code" href="../../d1/d22/stdosl_8h.html#abbe14ef840e8892a518a08df51226fbb">reflect</a> &amp;&amp; blendermat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a13a0e6d77557d55180fea6000c887ec8">reflect</a> &lt;= 1.0f);
<a name="l01295"></a>01295     
<a name="l01296"></a>01296         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a67231b92b9ef7cd2097f4072a1bc4b39">m_restitution</a> = blendermat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a13a0e6d77557d55180fea6000c887ec8">reflect</a>;
<a name="l01297"></a>01297         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6773431e8f8476c767a6c2ee55676289">m_friction</a> = blendermat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#aa3a38889e9a7af5428d78b6e1f430702">friction</a>;
<a name="l01298"></a>01298         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#adb56370e9cc933e70d6e06e8c61b3793">m_fh_spring</a> = blendermat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9f747396d598330fbb96db12e9ca8f74">fh</a>;
<a name="l01299"></a>01299         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6686a5317bdb3f4f7b2db527ef79ab00">m_fh_damping</a> = blendermat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#ac6ba5be191994132565faab37b3f6693">xyfrict</a>;
<a name="l01300"></a>01300         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6a855a987e430b26ca30404fbeaf4c89">m_fh_distance</a> = blendermat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a428961f45c911545bfa71fef73093b58">fhdist</a>;
<a name="l01301"></a>01301         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6b7e19bc1fe368b13a3804f51f01fd07">m_fh_normal</a> = (blendermat-&gt;<a class="code" href="../../d2/d10/structMaterial.html#a9e43392bb83920ff072896128781bf6b">dynamode</a> &amp; <a class="code" href="../../de/db2/DNA__material__types_8h.html#ae6c30b0405ac52f1f0bbf9f168a363fb">MA_FH_NOR</a>) != 0;
<a name="l01302"></a>01302     }
<a name="l01303"></a>01303     <span class="keywordflow">else</span> {
<a name="l01304"></a>01304         <span class="comment">//give some defaults</span>
<a name="l01305"></a>01305         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a67231b92b9ef7cd2097f4072a1bc4b39">m_restitution</a> = 0.f;
<a name="l01306"></a>01306         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6773431e8f8476c767a6c2ee55676289">m_friction</a> = 0.5;
<a name="l01307"></a>01307         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#adb56370e9cc933e70d6e06e8c61b3793">m_fh_spring</a> = 0.f;
<a name="l01308"></a>01308         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6686a5317bdb3f4f7b2db527ef79ab00">m_fh_damping</a> = 0.f;
<a name="l01309"></a>01309         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6a855a987e430b26ca30404fbeaf4c89">m_fh_distance</a> = 0.f;
<a name="l01310"></a>01310         materialProps-&gt;<a class="code" href="../../d7/dce/structPHY__MaterialProps.html#a6b7e19bc1fe368b13a3804f51f01fd07">m_fh_normal</a> = <span class="keyword">false</span>;
<a name="l01311"></a>01311 
<a name="l01312"></a>01312     }
<a name="l01313"></a>01313     
<a name="l01314"></a>01314     <span class="keywordflow">return</span> materialProps;
<a name="l01315"></a>01315 }
<a name="l01316"></a>01316 
<a name="l01317"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a437160df04f0e263f6b95a69884f6ee1">01317</a> <span class="keyword">static</span> <a class="code" href="../../d4/dd1/structPHY__ShapeProps.html">PHY_ShapeProps</a> *<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a437160df04f0e263f6b95a69884f6ee1">CreateShapePropsFromBlenderObject</a>(<span class="keyword">struct</span> <a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject)
<a name="l01318"></a>01318 {
<a name="l01319"></a>01319     <a class="code" href="../../d4/dd1/structPHY__ShapeProps.html">PHY_ShapeProps</a> *shapeProps = <span class="keyword">new</span> <a class="code" href="../../d4/dd1/structPHY__ShapeProps.html">PHY_ShapeProps</a>;
<a name="l01320"></a>01320     
<a name="l01321"></a>01321     <a class="code" href="../../dc/d60/MT__assert_8h.html#a9a255d1fa64eae77485b7bc71c1b4c97">MT_assert</a>(shapeProps);
<a name="l01322"></a>01322         
<a name="l01323"></a>01323     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a8a75b26b55c5c30d0afee6e8dd7561c5">m_mass</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a60866179af7cb2aad410ea01de546e4e">mass</a>;
<a name="l01324"></a>01324     
<a name="l01325"></a>01325 <span class="comment">//  This needs to be fixed in blender. For now, we use:</span>
<a name="l01326"></a>01326     
<a name="l01327"></a>01327 <span class="comment">// in Blender, inertia stands for the size value which is equivalent to</span>
<a name="l01328"></a>01328 <span class="comment">// the sphere radius</span>
<a name="l01329"></a>01329     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a004e2a690ab605f8e55afed6e851a7f8">m_inertia</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#af2829a0f4febb82506e7f5d2a99f8a3c">formfactor</a>;
<a name="l01330"></a>01330     
<a name="l01331"></a>01331     <a class="code" href="../../dc/d60/MT__assert_8h.html#a9a255d1fa64eae77485b7bc71c1b4c97">MT_assert</a>(0.0f &lt;= blenderobject-&gt;damping &amp;&amp; blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a0f7412e63750dbfc2e4bd485ff7a9920">damping</a> &lt;= 1.0f);
<a name="l01332"></a>01332     <a class="code" href="../../dc/d60/MT__assert_8h.html#a9a255d1fa64eae77485b7bc71c1b4c97">MT_assert</a>(0.0f &lt;= blenderobject-&gt;rdamping &amp;&amp; blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a0216bf8bf0f5207ab1ff917f30305d79">rdamping</a> &lt;= 1.0f);
<a name="l01333"></a>01333     
<a name="l01334"></a>01334     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a03e311aae67b87988d7792663d98e81f">m_lin_drag</a> = 1.0 - blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a0f7412e63750dbfc2e4bd485ff7a9920">damping</a>;
<a name="l01335"></a>01335     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#abfe88f86141eab2841189b2691a06eaf">m_ang_drag</a> = 1.0 - blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a0216bf8bf0f5207ab1ff917f30305d79">rdamping</a>;
<a name="l01336"></a>01336     
<a name="l01337"></a>01337     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a7c1b3f81c86908c8924353410dc45f72">m_friction_scaling</a>[0] = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a9aa1212ef790ff952c162f4a08eea073">anisotropicFriction</a>[0]; 
<a name="l01338"></a>01338     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a7c1b3f81c86908c8924353410dc45f72">m_friction_scaling</a>[1] = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a9aa1212ef790ff952c162f4a08eea073">anisotropicFriction</a>[1];
<a name="l01339"></a>01339     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a7c1b3f81c86908c8924353410dc45f72">m_friction_scaling</a>[2] = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a9aa1212ef790ff952c162f4a08eea073">anisotropicFriction</a>[2];
<a name="l01340"></a>01340     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a3e832ce28d8af948fa7851211865e421">m_do_anisotropic</a> = ((blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a750ae9f2372bacd245ffd29a89f983d2">OB_ANISOTROPIC_FRICTION</a>) != 0);
<a name="l01341"></a>01341     
<a name="l01342"></a>01342     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a03bbcb172e95856fe73ceccd7058469e">m_do_fh</a>     = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#aa7e7ef49482d61ce8eae03477e35eb21">OB_DO_FH</a>) != 0; 
<a name="l01343"></a>01343     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a6600dad2a4e1c6d7bf9a254258e83b71">m_do_rot_fh</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a257e9d5c2c0a383b74bb44ed50efcd81">OB_ROT_FH</a>) != 0;
<a name="l01344"></a>01344     
<a name="l01345"></a>01345 <span class="comment">//  velocity clamping XXX</span>
<a name="l01346"></a>01346     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#ac093f3c4b17444e2ac595f491809bc6f">m_clamp_vel_min</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ae7962f09a5ce8487ee62c560579256e6">min_vel</a>;
<a name="l01347"></a>01347     shapeProps-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#afc3f16b984dba45dac9292111b40fc5c">m_clamp_vel_max</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab41861bda877603be3fd079c9d8ef0d6">max_vel</a>;
<a name="l01348"></a>01348     
<a name="l01349"></a>01349     <span class="keywordflow">return</span> shapeProps;
<a name="l01350"></a>01350 }
<a name="l01351"></a>01351 
<a name="l01352"></a>01352     
<a name="l01353"></a>01353     
<a name="l01354"></a>01354     
<a name="l01355"></a>01355         
<a name="l01357"></a>01357     
<a name="l01358"></a>01358 
<a name="l01359"></a>01359 
<a name="l01360"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a7bb64659859a4f98db583890027c9aff">01360</a> <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a7bb64659859a4f98db583890027c9aff">my_boundbox_mesh</a>(<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me, <span class="keywordtype">float</span> *loc, <span class="keywordtype">float</span> *<a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>)
<a name="l01361"></a>01361 {
<a name="l01362"></a>01362     <a class="code" href="../../d8/de5/structMVert.html">MVert</a> *mvert;
<a name="l01363"></a>01363     <a class="code" href="../../d3/d8a/structBoundBox.html">BoundBox</a> *bb;
<a name="l01364"></a>01364     <span class="keywordtype">float</span> <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>[3], <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>[3];
<a name="l01365"></a>01365     <span class="keywordtype">float</span> mloc[3], msize[3];
<a name="l01366"></a>01366     <span class="keywordtype">float</span> radius=0.0f, vert_radius, *<a class="code" href="../../d4/dd4/drawarmature_8c.html#a7cadd25320d9bbcc4f8d41f1b6d0978b">co</a>;
<a name="l01367"></a>01367     <span class="keywordtype">int</span> a;
<a name="l01368"></a>01368     
<a name="l01369"></a>01369     <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a71b32c841e28c59ad02129f2a0e72648">bb</a>==0) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a71b32c841e28c59ad02129f2a0e72648">bb</a>= (<span class="keyword">struct </span><a class="code" href="../../d3/d8a/structBoundBox.html">BoundBox</a> *)<a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8a/structBoundBox.html">BoundBox</a>), <span class="stringliteral">&quot;boundbox&quot;</span>);
<a name="l01370"></a>01370     bb= me-&gt;<a class="code" href="../../da/d29/structMesh.html#a71b32c841e28c59ad02129f2a0e72648">bb</a>;
<a name="l01371"></a>01371     
<a name="l01372"></a>01372     <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a329751705c70a4b2fd8a24744f172bb2">INIT_MINMAX</a>(min, max);
<a name="l01373"></a>01373 
<a name="l01374"></a>01374     <span class="keywordflow">if</span> (!loc) loc= mloc;
<a name="l01375"></a>01375     <span class="keywordflow">if</span> (!size) size= msize;
<a name="l01376"></a>01376     
<a name="l01377"></a>01377     mvert= me-&gt;<a class="code" href="../../da/d29/structMesh.html#a422181e95f8eeb611b58ca26b5f62bdf">mvert</a>;
<a name="l01378"></a>01378     <span class="keywordflow">for</span> (a=0; a&lt;me-&gt;<a class="code" href="../../da/d29/structMesh.html#a8eb428498e3a39055f51a7de431655ed">totvert</a>; a++, mvert++) {
<a name="l01379"></a>01379         co= mvert-&gt;<a class="code" href="../../d8/de5/structMVert.html#a7682e4afa4b2ff47a3e17a4a3f670f1f">co</a>;
<a name="l01380"></a>01380         
<a name="l01381"></a>01381         <span class="comment">/* bounds */</span>
<a name="l01382"></a>01382         <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a56471388e0045022014f3a365af6b34a">DO_MINMAX</a>(co, min, max);
<a name="l01383"></a>01383         
<a name="l01384"></a>01384         <span class="comment">/* radius */</span>
<a name="l01385"></a>01385         vert_radius= co[0]*co[0] + co[1]*co[1] + co[2]*co[2];
<a name="l01386"></a>01386         <span class="keywordflow">if</span> (vert_radius &gt; radius)
<a name="l01387"></a>01387             radius= vert_radius;
<a name="l01388"></a>01388     }
<a name="l01389"></a>01389         
<a name="l01390"></a>01390     <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a8eb428498e3a39055f51a7de431655ed">totvert</a>) {
<a name="l01391"></a>01391         loc[0]= (min[0]+max[0])/2.0f;
<a name="l01392"></a>01392         loc[1]= (min[1]+max[1])/2.0f;
<a name="l01393"></a>01393         loc[2]= (min[2]+max[2])/2.0f;
<a name="l01394"></a>01394         
<a name="l01395"></a>01395         size[0]= (max[0]-min[0])/2.0f;
<a name="l01396"></a>01396         size[1]= (max[1]-min[1])/2.0f;
<a name="l01397"></a>01397         size[2]= (max[2]-min[2])/2.0f;
<a name="l01398"></a>01398     }
<a name="l01399"></a>01399     <span class="keywordflow">else</span> {
<a name="l01400"></a>01400         loc[0]= loc[1]= loc[2]= 0.0f;
<a name="l01401"></a>01401         size[0]= size[1]= size[2]= 0.0f;
<a name="l01402"></a>01402     }
<a name="l01403"></a>01403         
<a name="l01404"></a>01404     bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][0]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[1][0]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[2][0]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[3][0]= loc[0]-size[0];
<a name="l01405"></a>01405     bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[4][0]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[5][0]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[6][0]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[7][0]= loc[0]+size[0];
<a name="l01406"></a>01406         
<a name="l01407"></a>01407     bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][1]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[1][1]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[4][1]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[5][1]= loc[1]-size[1];
<a name="l01408"></a>01408     bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[2][1]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[3][1]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[6][1]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[7][1]= loc[1]+size[1];
<a name="l01409"></a>01409 
<a name="l01410"></a>01410     bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][2]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[3][2]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[4][2]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[7][2]= loc[2]-size[2];
<a name="l01411"></a>01411     bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[1][2]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[2][2]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[5][2]=bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[6][2]= loc[2]+size[2];
<a name="l01412"></a>01412 
<a name="l01413"></a>01413     <span class="keywordflow">return</span> <a class="code" href="../../d7/d47/NM__Scalar_8h.html#aa3fc8738e36a262f694814c04e8ef744">sqrt</a>(radius);
<a name="l01414"></a>01414 }
<a name="l01415"></a>01415         
<a name="l01416"></a>01416 
<a name="l01417"></a>01417 
<a name="l01418"></a>01418 
<a name="l01419"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a069269c433a936b994fa4ce7a745ae35">01419</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a069269c433a936b994fa4ce7a745ae35">my_tex_space_mesh</a>(<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me)
<a name="l01420"></a>01420 {
<a name="l01421"></a>01421     <a class="code" href="../../d2/dc3/structKeyBlock.html">KeyBlock</a> *kb;
<a name="l01422"></a>01422     <span class="keywordtype">float</span> *fp, loc[3], <a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>[3], <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>[3], <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>[3];
<a name="l01423"></a>01423     <span class="keywordtype">int</span> a;
<a name="l01424"></a>01424 
<a name="l01425"></a>01425     <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a7bb64659859a4f98db583890027c9aff">my_boundbox_mesh</a>(me, loc, size);
<a name="l01426"></a>01426     
<a name="l01427"></a>01427     <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#abfcbaf5f07add94d74961a3ec2bbbf63">texflag</a> &amp; <a class="code" href="../../df/d96/DNA__mesh__types_8h.html#a98df2e3a6513be3b105cca0bcb06ad3d">ME_AUTOSPACE</a>) {
<a name="l01428"></a>01428         <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#ad5e8f2b7e52cbc5caf836c656db83589">key</a>) {
<a name="l01429"></a>01429             kb= me-&gt;<a class="code" href="../../da/d29/structMesh.html#ad5e8f2b7e52cbc5caf836c656db83589">key</a>-&gt;<a class="code" href="../../d1/d9e/structKey.html#ac66292f02aa3b6c694a1fcd14e4218e2">refkey</a>;
<a name="l01430"></a>01430             <span class="keywordflow">if</span> (kb) {
<a name="l01431"></a>01431 
<a name="l01432"></a>01432                 <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a329751705c70a4b2fd8a24744f172bb2">INIT_MINMAX</a>(min, max);
<a name="l01433"></a>01433 
<a name="l01434"></a>01434                 fp= (<span class="keywordtype">float</span> *)kb-&gt;<a class="code" href="../../d2/dc3/structKeyBlock.html#aec4b55f1b0c4c1e0c60a77f7ffb80401">data</a>;
<a name="l01435"></a>01435                 for (a=0; a&lt;kb-&gt;<a class="code" href="../../d2/dc3/structKeyBlock.html#a48866fbfcc064f4777e2d2841ce42fe4">totelem</a>; a++, fp+=3) {
<a name="l01436"></a>01436                     <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a56471388e0045022014f3a365af6b34a">DO_MINMAX</a>(fp, min, max);
<a name="l01437"></a>01437                 }
<a name="l01438"></a>01438                 <span class="keywordflow">if</span> (kb-&gt;<a class="code" href="../../d2/dc3/structKeyBlock.html#a48866fbfcc064f4777e2d2841ce42fe4">totelem</a>) {
<a name="l01439"></a>01439                     loc[0]= (min[0]+max[0])/2.0f; loc[1]= (min[1]+max[1])/2.0f; loc[2]= (min[2]+max[2])/2.0f;
<a name="l01440"></a>01440                     size[0]= (max[0]-min[0])/2.0f; size[1]= (max[1]-min[1])/2.0f; size[2]= (max[2]-min[2])/2.0f;
<a name="l01441"></a>01441                 }
<a name="l01442"></a>01442                 <span class="keywordflow">else</span> {
<a name="l01443"></a>01443                     loc[0]= loc[1]= loc[2]= 0.0;
<a name="l01444"></a>01444                     size[0]= size[1]= size[2]= 0.0;
<a name="l01445"></a>01445                 }
<a name="l01446"></a>01446                 
<a name="l01447"></a>01447             }
<a name="l01448"></a>01448         }
<a name="l01449"></a>01449 
<a name="l01450"></a>01450         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(me-&gt;<a class="code" href="../../da/d29/structMesh.html#af8037e1c6eef49ed43b915021617b55a">loc</a>, loc);
<a name="l01451"></a>01451         <a class="code" href="../../d3/d86/BLI__math__vector_8h.html#a6cf5ea9576bb2186e5c71a02480875eb">copy_v3_v3</a>(me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>, size);
<a name="l01452"></a>01452         me-&gt;<a class="code" href="../../da/d29/structMesh.html#a6e880f4e544ec55b3f6ab71d68af40d6">rot</a>[0]= me-&gt;<a class="code" href="../../da/d29/structMesh.html#a6e880f4e544ec55b3f6ab71d68af40d6">rot</a>[1]= me-&gt;<a class="code" href="../../da/d29/structMesh.html#a6e880f4e544ec55b3f6ab71d68af40d6">rot</a>[2]= 0.0f;
<a name="l01453"></a>01453 
<a name="l01454"></a>01454         <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]==0.0) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]= 1.0f;
<a name="l01455"></a>01455         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]&gt;0.0 &amp;&amp; me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]&lt; 0.00001f) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]= 0.00001f;
<a name="l01456"></a>01456         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]&lt;0.0 &amp;&amp; me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]&gt; -0.00001f) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[0]= -0.00001f;
<a name="l01457"></a>01457 
<a name="l01458"></a>01458         <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]==0.0) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]= 1.0f;
<a name="l01459"></a>01459         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]&gt;0.0 &amp;&amp; me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]&lt; 0.00001f) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]= 0.00001f;
<a name="l01460"></a>01460         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]&lt;0.0 &amp;&amp; me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]&gt; -0.00001f) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[1]= -0.00001f;
<a name="l01461"></a>01461 
<a name="l01462"></a>01462         <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]==0.0) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]= 1.0f;
<a name="l01463"></a>01463         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]&gt;0.0 &amp;&amp; me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]&lt; 0.00001f) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]= 0.00001f;
<a name="l01464"></a>01464         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]&lt;0.0 &amp;&amp; me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]&gt; -0.00001f) me-&gt;<a class="code" href="../../da/d29/structMesh.html#a4b8b4196dcde315bfbbdd34c57924248">size</a>[2]= -0.00001f;
<a name="l01465"></a>01465     }
<a name="l01466"></a>01466     
<a name="l01467"></a>01467 }
<a name="l01468"></a>01468 
<a name="l01469"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a6a42ccf9cf5644e3bb666cc5fd5b2172">01469</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a6a42ccf9cf5644e3bb666cc5fd5b2172">my_get_local_bounds</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a> *dm, <span class="keywordtype">float</span> *center, <span class="keywordtype">float</span> *<a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>)
<a name="l01470"></a>01470 {
<a name="l01471"></a>01471     <a class="code" href="../../d3/d8a/structBoundBox.html">BoundBox</a> *bb= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01472"></a>01472     <span class="comment">/* uses boundbox, function used by Ketsji */</span>
<a name="l01473"></a>01473     <span class="keywordflow">switch</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>)
<a name="l01474"></a>01474     {
<a name="l01475"></a>01475         <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>:
<a name="l01476"></a>01476             <span class="keywordflow">if</span> (dm)
<a name="l01477"></a>01477             {
<a name="l01478"></a>01478                 <span class="keywordtype">float</span> min_r[3], max_r[3];
<a name="l01479"></a>01479                 <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a329751705c70a4b2fd8a24744f172bb2">INIT_MINMAX</a>(min_r, max_r);
<a name="l01480"></a>01480                 dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a1e765037d4de223d2f7fd63b551e1c99">getMinMax</a>(dm, min_r, max_r);
<a name="l01481"></a>01481                 size[0]= 0.5f*<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(max_r[0] - min_r[0]);
<a name="l01482"></a>01482                 size[1]= 0.5f*<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(max_r[1] - min_r[1]);
<a name="l01483"></a>01483                 size[2]= 0.5f*<a class="code" href="../../dd/d06/BLI__math__base_8h.html#aa825035ff543e2be9c11ad8acf18d480">fabsf</a>(max_r[2] - min_r[2]);
<a name="l01484"></a>01484                     
<a name="l01485"></a>01485                 center[0]= 0.5f*(max_r[0] + min_r[0]);
<a name="l01486"></a>01486                 center[1]= 0.5f*(max_r[1] + min_r[1]);
<a name="l01487"></a>01487                 center[2]= 0.5f*(max_r[2] + min_r[2]);
<a name="l01488"></a>01488                 <span class="keywordflow">return</span>;
<a name="l01489"></a>01489             } <span class="keywordflow">else</span>
<a name="l01490"></a>01490             {
<a name="l01491"></a>01491                 bb= ( (<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a> )-&gt;bb;
<a name="l01492"></a>01492                 <span class="keywordflow">if</span> (bb==0) 
<a name="l01493"></a>01493                 {
<a name="l01494"></a>01494                     <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a069269c433a936b994fa4ce7a745ae35">my_tex_space_mesh</a>((<span class="keyword">struct</span> <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l01495"></a>01495                     bb= ( (<a class="code" href="../../da/d29/structMesh.html">Mesh</a> *)ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a> )-&gt;bb;
<a name="l01496"></a>01496                 }
<a name="l01497"></a>01497             }
<a name="l01498"></a>01498             <span class="keywordflow">break</span>;
<a name="l01499"></a>01499         <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a885d669104f0c596dabb147f9371ffc3">OB_CURVE</a>:
<a name="l01500"></a>01500         <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ae247d3ec6e691b7752d8a90065428ecb">OB_SURF</a>:
<a name="l01501"></a>01501             center[0]= center[1]= center[2]= 0.0;
<a name="l01502"></a>01502             size[0]  = size[1]=size[2]=0.0;
<a name="l01503"></a>01503             <span class="keywordflow">break</span>;
<a name="l01504"></a>01504         <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a1a94162b6fc469957966a01d41ff71d6">OB_FONT</a>:
<a name="l01505"></a>01505             center[0]= center[1]= center[2]= 0.0;
<a name="l01506"></a>01506             size[0]  = size[1]=size[2]=1.0;
<a name="l01507"></a>01507             <span class="keywordflow">break</span>;
<a name="l01508"></a>01508         <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a046d883c32490b5c5ca4c5e7b6504e35">OB_MBALL</a>:
<a name="l01509"></a>01509             bb= ob-&gt;<a class="code" href="../../de/de7/structObject.html#a5513f8ac51a6d67252f5c3ceaf3c34eb">bb</a>;
<a name="l01510"></a>01510             <span class="keywordflow">break</span>;
<a name="l01511"></a>01511     }
<a name="l01512"></a>01512     
<a name="l01513"></a>01513     <span class="keywordflow">if</span> (bb==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) 
<a name="l01514"></a>01514     {
<a name="l01515"></a>01515         center[0]= center[1]= center[2]= 0.0;
<a name="l01516"></a>01516         size[0] = size[1]=size[2]=1.0;
<a name="l01517"></a>01517     }
<a name="l01518"></a>01518     <span class="keywordflow">else</span> 
<a name="l01519"></a>01519     {
<a name="l01520"></a>01520         size[0]= 0.5f*<a class="code" href="../../d1/d22/stdosl_8h.html#a706cbf0492993ed1d280ccf8e9b56682">fabs</a>(bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][0] - bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[4][0]);
<a name="l01521"></a>01521         size[1]= 0.5f*<a class="code" href="../../d1/d22/stdosl_8h.html#a706cbf0492993ed1d280ccf8e9b56682">fabs</a>(bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][1] - bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[2][1]);
<a name="l01522"></a>01522         size[2]= 0.5f*<a class="code" href="../../d1/d22/stdosl_8h.html#a706cbf0492993ed1d280ccf8e9b56682">fabs</a>(bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][2] - bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[1][2]);
<a name="l01523"></a>01523                     
<a name="l01524"></a>01524         center[0]= 0.5f*(bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][0] + bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[4][0]);
<a name="l01525"></a>01525         center[1]= 0.5f*(bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][1] + bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[2][1]);
<a name="l01526"></a>01526         center[2]= 0.5f*(bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[0][2] + bb-&gt;<a class="code" href="../../d3/d8a/structBoundBox.html#ad1955c11c5a6c98f2c8b714c20337fb3">vec</a>[1][2]);
<a name="l01527"></a>01527     }
<a name="l01528"></a>01528 }
<a name="l01529"></a>01529     
<a name="l01530"></a>01530 
<a name="l01531"></a>01531 
<a name="l01532"></a>01532 
<a name="l01534"></a>01534 
<a name="l01535"></a>01535 
<a name="l01536"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a8b45221b418440b6287374e399a9a8c5">01536</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a8b45221b418440b6287374e399a9a8c5">BL_CreateGraphicObjectNew</a>(<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj,
<a name="l01537"></a>01537                                <span class="keyword">const</span> <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a>&amp; localAabbMin,
<a name="l01538"></a>01538                                <span class="keyword">const</span> <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a>&amp; localAabbMax,
<a name="l01539"></a>01539                                <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a>* kxscene,
<a name="l01540"></a>01540                                <span class="keywordtype">bool</span> isActive,
<a name="l01541"></a>01541                                <a class="code" href="../../d3/d98/KX__PhysicsEngineEnums_8h.html#a1d02ecff9c9296faee3bc2488e2d4555">e_PhysicsEngine</a> physics_engine)
<a name="l01542"></a>01542 {
<a name="l01543"></a>01543     <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0380469d233ad08592b6a49819db066d">GetMeshCount</a>() &gt; 0) 
<a name="l01544"></a>01544     {
<a name="l01545"></a>01545         <span class="keywordflow">switch</span> (physics_engine)
<a name="l01546"></a>01546         {
<a name="l01547"></a>01547 <span class="preprocessor">#ifdef USE_BULLET</span>
<a name="l01548"></a>01548 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../d3/d98/KX__PhysicsEngineEnums_8h.html#a1d02ecff9c9296faee3bc2488e2d4555a989601135c4f2574a13baf105acaf9a4">UseBullet</a>:
<a name="l01549"></a>01549             {
<a name="l01550"></a>01550                 <a class="code" href="../../d5/d39/classCcdPhysicsEnvironment.html">CcdPhysicsEnvironment</a>* env = (<a class="code" href="../../d5/d39/classCcdPhysicsEnvironment.html">CcdPhysicsEnvironment</a>*)kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>();
<a name="l01551"></a>01551                 <a class="code" href="../../d5/d8e/Value_8h.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(env);
<a name="l01552"></a>01552                 <a class="code" href="../../d2/d52/classPHY__IMotionState.html">PHY_IMotionState</a>* motionstate = <span class="keyword">new</span> <a class="code" href="../../da/d5b/classKX__MotionState.html">KX_MotionState</a>(gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0be04ac2ce18c262fd28cb92f5c296b7">GetSGNode</a>());
<a name="l01553"></a>01553                 <a class="code" href="../../d6/dcb/classCcdGraphicController.html" title="CcdGraphicController is a graphic object that supports view frustrum culling and occlusion.">CcdGraphicController</a>* ctrl = <span class="keyword">new</span> <a class="code" href="../../d6/dcb/classCcdGraphicController.html" title="CcdGraphicController is a graphic object that supports view frustrum culling and occlusion.">CcdGraphicController</a>(env, motionstate);
<a name="l01554"></a>01554                 gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a6f67759c316c4e9c6af844259d722cd1">SetGraphicController</a>(ctrl);
<a name="l01555"></a>01555                 ctrl-&gt;setNewClientInfo(gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a4fb43f2d41de4ddd5130fa0c882dd204">getClientInfo</a>());
<a name="l01556"></a>01556                 ctrl-&gt;setLocalAabb(localAabbMin, localAabbMax);
<a name="l01557"></a>01557                 <span class="keywordflow">if</span> (isActive) {
<a name="l01558"></a>01558                     <span class="comment">// add first, this will create the proxy handle, only if the object is visible</span>
<a name="l01559"></a>01559                     <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#aaeabe9e8554e43eb8d62fa25d3808bc3">GetVisible</a>())
<a name="l01560"></a>01560                         env-&gt;<a class="code" href="../../d5/d39/classCcdPhysicsEnvironment.html#a470bc75192df36177141e13ec756aacd">addCcdGraphicController</a>(ctrl);
<a name="l01561"></a>01561                     <span class="comment">// update the mesh if there is a deformer, this will also update the bounding box for modifiers</span>
<a name="l01562"></a>01562                     <a class="code" href="../../d7/dc3/classRAS__Deformer.html">RAS_Deformer</a>* deformer = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abb4098bf9868e54fc875379eb10009f7">GetDeformer</a>();
<a name="l01563"></a>01563                     <span class="keywordflow">if</span> (deformer)
<a name="l01564"></a>01564                         deformer-&gt;<a class="code" href="../../d7/dc3/classRAS__Deformer.html#a7dca1ebab0f403f5406c8c58676b0211">UpdateBuckets</a>();
<a name="l01565"></a>01565                 }
<a name="l01566"></a>01566             }
<a name="l01567"></a>01567             <span class="keywordflow">break</span>;
<a name="l01568"></a>01568 <span class="preprocessor">#endif</span>
<a name="l01569"></a>01569 <span class="preprocessor"></span>        <span class="keywordflow">default</span>:
<a name="l01570"></a>01570             <span class="keywordflow">break</span>;
<a name="l01571"></a>01571         }
<a name="l01572"></a>01572     }
<a name="l01573"></a>01573 }
<a name="l01574"></a>01574 
<a name="l01575"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a99d1f009720d1f2750d87abaa22c3eca">01575</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a99d1f009720d1f2750d87abaa22c3eca">BL_CreatePhysicsObjectNew</a>(<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj,
<a name="l01576"></a>01576                          <span class="keyword">struct</span> <a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject,
<a name="l01577"></a>01577                          <a class="code" href="../../d5/d85/classRAS__MeshObject.html">RAS_MeshObject</a>* meshobj,
<a name="l01578"></a>01578                          <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a>* kxscene,
<a name="l01579"></a>01579                          <span class="keywordtype">int</span> activeLayerBitInfo,
<a name="l01580"></a>01580                          <a class="code" href="../../d3/d98/KX__PhysicsEngineEnums_8h.html#a1d02ecff9c9296faee3bc2488e2d4555">e_PhysicsEngine</a>    physics_engine,
<a name="l01581"></a>01581                          <a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html">KX_BlenderSceneConverter</a> *converter,
<a name="l01582"></a>01582                          <span class="keywordtype">bool</span> processCompoundChildren
<a name="l01583"></a>01583                          )
<a name="l01584"></a>01584                     
<a name="l01585"></a>01585 {
<a name="l01586"></a>01586     <span class="comment">//SYS_SystemHandle syshandle = SYS_GetSystem(); /*unused*/</span>
<a name="l01587"></a>01587     <span class="comment">//int userigidbody = SYS_GetCommandLineInt(syshandle,&quot;norigidbody&quot;,0);</span>
<a name="l01588"></a>01588     <span class="comment">//bool bRigidBody = (userigidbody == 0);</span>
<a name="l01589"></a>01589 
<a name="l01590"></a>01590     <span class="comment">// object has physics representation?</span>
<a name="l01591"></a>01591     <span class="keywordflow">if</span> (!(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a9c7078a7f5ed6280084e98461c019ac2">OB_COLLISION</a>))
<a name="l01592"></a>01592         <span class="keywordflow">return</span>;
<a name="l01593"></a>01593 
<a name="l01594"></a>01594     <span class="comment">// get Root Parent of blenderobject</span>
<a name="l01595"></a>01595     <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* <a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>;
<a name="l01596"></a>01596     <span class="keywordflow">while</span>(parent &amp;&amp; parent-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>) {
<a name="l01597"></a>01597         parent= parent-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>;
<a name="l01598"></a>01598     }
<a name="l01599"></a>01599 
<a name="l01600"></a>01600     <span class="keywordtype">bool</span> isCompoundChild = <span class="keyword">false</span>;
<a name="l01601"></a>01601     <span class="keywordtype">bool</span> hasCompoundChildren = !parent &amp;&amp; (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a4fd624f7103b4845d856dcd7f9d6c179">OB_CHILD</a>);
<a name="l01602"></a>01602 
<a name="l01603"></a>01603     <span class="comment">/* When the parent is not OB_DYNAMIC and has no OB_COLLISION then it gets no bullet controller</span>
<a name="l01604"></a>01604 <span class="comment">     * and cant be apart of the parents compound shape */</span>
<a name="l01605"></a>01605     <span class="keywordflow">if</span> (parent &amp;&amp; (parent-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; (<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ab0e087d4d1cba100d6aada23fef63137">OB_DYNAMIC</a> | <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a9c7078a7f5ed6280084e98461c019ac2">OB_COLLISION</a>))) {
<a name="l01606"></a>01606         
<a name="l01607"></a>01607         <span class="keywordflow">if</span> ((parent-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a4fd624f7103b4845d856dcd7f9d6c179">OB_CHILD</a>) != 0 &amp;&amp; (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a4fd624f7103b4845d856dcd7f9d6c179">OB_CHILD</a>))
<a name="l01608"></a>01608         {
<a name="l01609"></a>01609             isCompoundChild = <span class="keyword">true</span>;
<a name="l01610"></a>01610         } 
<a name="l01611"></a>01611     }
<a name="l01612"></a>01612     <span class="keywordflow">if</span> (processCompoundChildren != isCompoundChild)
<a name="l01613"></a>01613         <span class="keywordflow">return</span>;
<a name="l01614"></a>01614 
<a name="l01615"></a>01615 
<a name="l01616"></a>01616     <a class="code" href="../../d4/dd1/structPHY__ShapeProps.html">PHY_ShapeProps</a>* shapeprops =
<a name="l01617"></a>01617             <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a437160df04f0e263f6b95a69884f6ee1">CreateShapePropsFromBlenderObject</a>(blenderobject);
<a name="l01618"></a>01618 
<a name="l01619"></a>01619     
<a name="l01620"></a>01620     <a class="code" href="../../d7/dce/structPHY__MaterialProps.html">PHY_MaterialProps</a>* smmaterial = 
<a name="l01621"></a>01621         <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af8f375d572e6062e787ae799c21aed85">CreateMaterialFromBlenderObject</a>(blenderobject);
<a name="l01622"></a>01622                     
<a name="l01623"></a>01623     <a class="code" href="../../d7/da6/structKX__ObjectProperties.html">KX_ObjectProperties</a> objprop;
<a name="l01624"></a>01624     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ace94bbbebf6b253eab7389d0b07e98dd">m_lockXaxis</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#acd742ffe59efea491501b2f3a057c0dc">OB_LOCK_RIGID_BODY_X_AXIS</a>) !=0;
<a name="l01625"></a>01625     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0e69d6031433e8a0f3430eaab09dd3b0">m_lockYaxis</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ac9c4f552073cc5d82251918813f895a9">OB_LOCK_RIGID_BODY_Y_AXIS</a>) !=0;
<a name="l01626"></a>01626     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0fe87ca3d67fea8b63a2f2f0ae660cff">m_lockZaxis</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ae66e188f4a172e783d4c094daf536a7c">OB_LOCK_RIGID_BODY_Z_AXIS</a>) !=0;
<a name="l01627"></a>01627     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a9691e88b9aa0b5262e99b4a35bb55bc9">m_lockXRotaxis</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ad9cc4ca2cd0b2834c64e89649c92d71f">OB_LOCK_RIGID_BODY_X_ROT_AXIS</a>) !=0;
<a name="l01628"></a>01628     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7d7f062366070ef20b19ae3b6fe4fd05">m_lockYRotaxis</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ac11e506736d6f93d67d86aa766d80c8c">OB_LOCK_RIGID_BODY_Y_ROT_AXIS</a>) !=0;
<a name="l01629"></a>01629     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#abeb59a3a03d70a0c014a0f7fc8121de0">m_lockZRotaxis</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a48ca800b34175f713458eb700e24124a">OB_LOCK_RIGID_BODY_Z_ROT_AXIS</a>) !=0;
<a name="l01630"></a>01630 
<a name="l01631"></a>01631     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#af838746a2c7f0ca35506eb0633aa6017">m_isCompoundChild</a> = isCompoundChild;
<a name="l01632"></a>01632     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#af7804bcac378a0e44222515ff44909c5">m_hasCompoundChildren</a> = hasCompoundChildren;
<a name="l01633"></a>01633     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a77b185d044381ace03345cb6859fc6ef">m_margin</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a1fc21f5de759e2ad98ee28422d872191">margin</a>;
<a name="l01634"></a>01634     
<a name="l01635"></a>01635     <span class="comment">// ACTOR is now a separate feature</span>
<a name="l01636"></a>01636     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ae59850baab9540b932da1512342f0b7d">m_isactor</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ad76bdc9402018000455811d82659d7f4">OB_ACTOR</a>)!=0;
<a name="l01637"></a>01637     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a2a2d8e41e05888fc2ccf7d1002d6843d">m_dyna</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ab0e087d4d1cba100d6aada23fef63137">OB_DYNAMIC</a>) != 0;
<a name="l01638"></a>01638     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7e800924c61802411a91f3ce10ee5be0">m_softbody</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#af92fc03b976c0b0b12655c193bd15a44">OB_SOFT_BODY</a>) != 0;
<a name="l01639"></a>01639     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aa2c1cd2e076e53add183a1daff78d761">m_angular_rigidbody</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a134c3f4cef16db08d3532d04adefa6fa">OB_RIGID_BODY</a>) != 0;
<a name="l01640"></a>01640     
<a name="l01642"></a>01642     <span class="keywordflow">if</span> (objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aa2c1cd2e076e53add183a1daff78d761">m_angular_rigidbody</a> || !objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a2a2d8e41e05888fc2ccf7d1002d6843d">m_dyna</a> )
<a name="l01643"></a>01643     {
<a name="l01644"></a>01644         objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aca66e9104c473d231da6bda2a4614d32">m_contactProcessingThreshold</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a831b12aa59859bda341c6e7363cc6e5d">m_contactProcessingThreshold</a>;
<a name="l01645"></a>01645     } <span class="keywordflow">else</span>
<a name="l01646"></a>01646     {
<a name="l01647"></a>01647         objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aca66e9104c473d231da6bda2a4614d32">m_contactProcessingThreshold</a> = 0.f;
<a name="l01648"></a>01648     }
<a name="l01649"></a>01649 
<a name="l01650"></a>01650     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ae55504014f8ae1716d5ed906e10d25a4">m_sensor</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#aa61174cef3000c84e245517ee95d129f">OB_SENSOR</a>) != 0;
<a name="l01651"></a>01651     
<a name="l01652"></a>01652     <span class="keywordflow">if</span> (objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7e800924c61802411a91f3ce10ee5be0">m_softbody</a>)
<a name="l01653"></a>01653     {
<a name="l01655"></a>01655         <span class="keywordflow">if</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>)
<a name="l01656"></a>01656         {
<a name="l01657"></a>01657             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a171c7d32d7604fbc1745467dcdeb1942">m_gamesoftFlag</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a729a96133fbd08b0c869350138721778">flag</a>;
<a name="l01659"></a>01659             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5664b39cedc5f24fd5f34bd04df13965">m_soft_linStiff</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a445d10914d85784c824c643078a79045">linStiff</a>;
<a name="l01660"></a>01660             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a492a13beab3f04a951b54061cc96c534">m_soft_angStiff</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#aa3394f415ce39e1306d4a5020108b3db">angStiff</a>;       <span class="comment">/* angular stiffness 0..1 */</span>
<a name="l01661"></a>01661             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#abe0688efd0d97ca220dd2e48578b2b0c">m_soft_volume</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a6d9c07d050667378b5a4413856cda945">volume</a>;            <span class="comment">/* volume preservation 0..1 */</span>
<a name="l01662"></a>01662 
<a name="l01663"></a>01663             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aaf0a4da83862a70fa947f57a4e4f0191">m_soft_viterations</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a1da542e906b9db7f9347a29050c4dcd0">viterations</a>;      <span class="comment">/* Velocities solver iterations */</span>
<a name="l01664"></a>01664             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a4a67ee2ea5dc3c01271a94f3fd84cf43">m_soft_piterations</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#ae93957c614f4807a52279aebff75c8b3">piterations</a>;      <span class="comment">/* Positions solver iterations */</span>
<a name="l01665"></a>01665             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a6e9391755b3380696f31d8aea1aa666e">m_soft_diterations</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a211aae5ce8a067385746b41439361603">diterations</a>;      <span class="comment">/* Drift solver iterations */</span>
<a name="l01666"></a>01666             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ac67d05816847ecc8515c60958fa6c113">m_soft_citerations</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#ab04e21b7d2b1d12a408046ad451772c9">citerations</a>;      <span class="comment">/* Cluster solver iterations */</span>
<a name="l01667"></a>01667 
<a name="l01668"></a>01668             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a68ac66dc9fd9cdea145cd8b4c6e5d08f">m_soft_kSRHR_CL</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#af7ec5fa0f9456c308d33e4b1ed91d60f">kSRHR_CL</a>;        <span class="comment">/* Soft vs rigid hardness [0,1] (cluster only) */</span>
<a name="l01669"></a>01669             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aeba2d6df9c8adbd0fe69b649ff789580">m_soft_kSKHR_CL</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a6632178494c1021a777581d7f52fe2f1">kSKHR_CL</a>;        <span class="comment">/* Soft vs kinetic hardness [0,1] (cluster only) */</span>
<a name="l01670"></a>01670             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ab3df8d7c13346d2a9ac4ee6968c972d4">m_soft_kSSHR_CL</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a04eb536a5bb9e09f1e6a8e496afbe47c">kSSHR_CL</a>;        <span class="comment">/* Soft vs soft hardness [0,1] (cluster only) */</span>
<a name="l01671"></a>01671             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a1176573581953526d9ecbcf3684b4397">m_soft_kSR_SPLT_CL</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a6fcdbd9c4fc857584eba87978fa49bf0">kSR_SPLT_CL</a>;  <span class="comment">/* Soft vs rigid impulse split [0,1] (cluster only) */</span>
<a name="l01672"></a>01672 
<a name="l01673"></a>01673             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a505aa65590082d826e4107e87116f38d">m_soft_kSK_SPLT_CL</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a45dbc667d04e3a430da438ec76c8194f">kSK_SPLT_CL</a>;  <span class="comment">/* Soft vs rigid impulse split [0,1] (cluster only) */</span>
<a name="l01674"></a>01674             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a8feb9899bfb6b7737cd04154348e236c">m_soft_kSS_SPLT_CL</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#ae5d63fd14cc378d29b32dc43e17eff3b">kSS_SPLT_CL</a>;  <span class="comment">/* Soft vs rigid impulse split [0,1] (cluster only) */</span>
<a name="l01675"></a>01675             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5bde0114e1dd06b63e0dca3c9ddb38ca">m_soft_kVCF</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#adfd91a5019700ebe3f9190261d2f889f">kVCF</a>;            <span class="comment">/* Velocities correction factor (Baumgarte) */</span>
<a name="l01676"></a>01676             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a209d760d49d5f9d6013b7ecb55be45b9">m_soft_kDP</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#ac9c168cf4013813eb28c4a84b9799e55">kDP</a>;          <span class="comment">/* Damping coefficient [0,1] */</span>
<a name="l01677"></a>01677 
<a name="l01678"></a>01678             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#adfa78b945e9292e58b46945c770ec553">m_soft_kDG</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a4c2a9622a8f42a143b34ae7e3ba80daa">kDG</a>;          <span class="comment">/* Drag coefficient [0,+inf] */</span>
<a name="l01679"></a>01679             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ab6cd9c42ca4458809d9888dc565bea12">m_soft_kLF</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a2e944d28915df965c31d15373b7a1a13">kLF</a>;          <span class="comment">/* Lift coefficient [0,+inf] */</span>
<a name="l01680"></a>01680             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a9f367ff75ea2f36231319579a9ab4204">m_soft_kPR</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a32e46835473eff0f7168fe31a79ee37d">kPR</a>;          <span class="comment">/* Pressure coefficient [-inf,+inf] */</span>
<a name="l01681"></a>01681             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#abb500deac2a3b09117245103cf01de3b">m_soft_kVC</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a86f56858084ff7a44972bad320a92297">kVC</a>;          <span class="comment">/* Volume conversation coefficient [0,+inf] */</span>
<a name="l01682"></a>01682 
<a name="l01683"></a>01683             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a1d4794dbce151568dfa0b0dfe0cf5bb4">m_soft_kDF</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a59a58b2297feadd8ce31ce4fc04c9a0a">kDF</a>;          <span class="comment">/* Dynamic friction coefficient [0,1] */</span>
<a name="l01684"></a>01684             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a9ab29256290c46eee911bb73de3560a1">m_soft_kMT</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#adaeaa0b352385e3b72ed2c507155954c">kMT</a>;          <span class="comment">/* Pose matching coefficient [0,1] */</span>
<a name="l01685"></a>01685             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aeede16a7b244fec6db247966a1e5574f">m_soft_kCHR</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a5f55c53d0e2dece2c1e812ab90194af5">kCHR</a>;            <span class="comment">/* Rigid contacts hardness [0,1] */</span>
<a name="l01686"></a>01686             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a4ba1e8140760d0d84dfe33345e26e5ac">m_soft_kKHR</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#ad569e414f9ca604277398429ed99ea24">kKHR</a>;            <span class="comment">/* Kinetic contacts hardness [0,1] */</span>
<a name="l01687"></a>01687 
<a name="l01688"></a>01688             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aa2a9b7459b9d92de86b4a408e70c46f0">m_soft_kSHR</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#ae0d67ffd1a217ef2eba18530a88a133b">kSHR</a>;            <span class="comment">/* Soft contacts hardness [0,1] */</span>
<a name="l01689"></a>01689             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aea77b052686441ffe84be439a4e7d73c">m_soft_kAHR</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a7834213a47659660269ec4745189a748">kAHR</a>;            <span class="comment">/* Anchors hardness [0,1] */</span>
<a name="l01690"></a>01690             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5b00c80fd7c990652c45d66746423e2d">m_soft_collisionflags</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a252e35a7697dbab9cbec6ccb45152b80">collisionflags</a>;    <span class="comment">/* Vertex/Face or Signed Distance Field(SDF) or Clusters, Soft versus Soft or Rigid */</span>
<a name="l01691"></a>01691             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a4c33044a01a788b0d117ee463ed06cb6">m_soft_numclusteriterations</a>= blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a5a629e02048f31a99e6fc8dc55972460">numclusteriterations</a>;    <span class="comment">/* number of iterations to refine collision clusters*/</span>
<a name="l01692"></a>01692             <span class="comment">//objprop.m_soft_welding = blenderobject-&gt;bsoft-&gt;welding;       /* welding */</span>
<a name="l01693"></a>01693             <span class="comment">/* disable welding: it doesn&#39;t bring any additional stability and it breaks the relation between soft body collision shape and graphic mesh */</span>
<a name="l01694"></a>01694             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5b8c115e3ad261e5f9dfb1522cf9c726">m_soft_welding</a> = 0.f;       
<a name="l01695"></a>01695             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a77b185d044381ace03345cb6859fc6ef">m_margin</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acaa3b12bf1664333e0bb2a4327faaef6">bsoft</a>-&gt;<a class="code" href="../../d2/dc0/structBulletSoftBody.html#a6a8c06cfa683242600e702e2bc4cbc22">margin</a>;
<a name="l01696"></a>01696             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aca66e9104c473d231da6bda2a4614d32">m_contactProcessingThreshold</a> = 0.f;
<a name="l01697"></a>01697         } <span class="keywordflow">else</span>
<a name="l01698"></a>01698         {
<a name="l01699"></a>01699             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a171c7d32d7604fbc1745467dcdeb1942">m_gamesoftFlag</a> = <a class="code" href="../../d2/d60/DNA__object__force_8h.html#a8d19a52add7dc1a483b5746eba65954a">OB_BSB_BENDING_CONSTRAINTS</a> | <a class="code" href="../../d2/d60/DNA__object__force_8h.html#a4d6123c193a9ebd493392f3dab61efc8">OB_BSB_SHAPE_MATCHING</a> | <a class="code" href="../../d2/d60/DNA__object__force_8h.html#ac858647e2e8ef5cf4cfe3a8d3a90421f">OB_BSB_AERO_VPOINT</a>;
<a name="l01700"></a>01700             
<a name="l01701"></a>01701             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5664b39cedc5f24fd5f34bd04df13965">m_soft_linStiff</a> = 0.5;
<a name="l01702"></a>01702             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a492a13beab3f04a951b54061cc96c534">m_soft_angStiff</a> = 1.f;      <span class="comment">/* angular stiffness 0..1 */</span>
<a name="l01703"></a>01703             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#abe0688efd0d97ca220dd2e48578b2b0c">m_soft_volume</a>= 1.f;         <span class="comment">/* volume preservation 0..1 */</span>
<a name="l01704"></a>01704 
<a name="l01705"></a>01705 
<a name="l01706"></a>01706             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aaf0a4da83862a70fa947f57a4e4f0191">m_soft_viterations</a>= 0;
<a name="l01707"></a>01707             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a4a67ee2ea5dc3c01271a94f3fd84cf43">m_soft_piterations</a>= 1;
<a name="l01708"></a>01708             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a6e9391755b3380696f31d8aea1aa666e">m_soft_diterations</a>= 0;
<a name="l01709"></a>01709             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ac67d05816847ecc8515c60958fa6c113">m_soft_citerations</a>= 4;
<a name="l01710"></a>01710 
<a name="l01711"></a>01711             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a68ac66dc9fd9cdea145cd8b4c6e5d08f">m_soft_kSRHR_CL</a>= 0.1f;
<a name="l01712"></a>01712             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aeba2d6df9c8adbd0fe69b649ff789580">m_soft_kSKHR_CL</a>= 1.f;
<a name="l01713"></a>01713             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ab3df8d7c13346d2a9ac4ee6968c972d4">m_soft_kSSHR_CL</a>= 0.5;
<a name="l01714"></a>01714             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a1176573581953526d9ecbcf3684b4397">m_soft_kSR_SPLT_CL</a>= 0.5f;
<a name="l01715"></a>01715 
<a name="l01716"></a>01716             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a505aa65590082d826e4107e87116f38d">m_soft_kSK_SPLT_CL</a>= 0.5f;
<a name="l01717"></a>01717             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a8feb9899bfb6b7737cd04154348e236c">m_soft_kSS_SPLT_CL</a>= 0.5f;
<a name="l01718"></a>01718             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5bde0114e1dd06b63e0dca3c9ddb38ca">m_soft_kVCF</a>=  1;
<a name="l01719"></a>01719             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a209d760d49d5f9d6013b7ecb55be45b9">m_soft_kDP</a>= 0;
<a name="l01720"></a>01720 
<a name="l01721"></a>01721             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#adfa78b945e9292e58b46945c770ec553">m_soft_kDG</a>= 0;
<a name="l01722"></a>01722             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ab6cd9c42ca4458809d9888dc565bea12">m_soft_kLF</a>= 0;
<a name="l01723"></a>01723             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a9f367ff75ea2f36231319579a9ab4204">m_soft_kPR</a>= 0;
<a name="l01724"></a>01724             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#abb500deac2a3b09117245103cf01de3b">m_soft_kVC</a>= 0;
<a name="l01725"></a>01725 
<a name="l01726"></a>01726             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a1d4794dbce151568dfa0b0dfe0cf5bb4">m_soft_kDF</a>= 0.2f;
<a name="l01727"></a>01727             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a9ab29256290c46eee911bb73de3560a1">m_soft_kMT</a>= 0.05f;
<a name="l01728"></a>01728             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aeede16a7b244fec6db247966a1e5574f">m_soft_kCHR</a>= 1.0f;
<a name="l01729"></a>01729             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a4ba1e8140760d0d84dfe33345e26e5ac">m_soft_kKHR</a>= 0.1f;
<a name="l01730"></a>01730 
<a name="l01731"></a>01731             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aa2a9b7459b9d92de86b4a408e70c46f0">m_soft_kSHR</a>= 1.f;
<a name="l01732"></a>01732             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aea77b052686441ffe84be439a4e7d73c">m_soft_kAHR</a>= 0.7f;
<a name="l01733"></a>01733             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5b00c80fd7c990652c45d66746423e2d">m_soft_collisionflags</a>= <a class="code" href="../../d2/d60/DNA__object__force_8h.html#a46931bf094ff5a549ce5fc391b792ab4">OB_BSB_COL_SDF_RS</a> + <a class="code" href="../../d2/d60/DNA__object__force_8h.html#aceda49c44887de387c6e1d85d9b97105">OB_BSB_COL_VF_SS</a>;
<a name="l01734"></a>01734             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a4c33044a01a788b0d117ee463ed06cb6">m_soft_numclusteriterations</a>= 16;
<a name="l01735"></a>01735             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5b8c115e3ad261e5f9dfb1522cf9c726">m_soft_welding</a> = 0.f;
<a name="l01736"></a>01736             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a77b185d044381ace03345cb6859fc6ef">m_margin</a> = 0.f;
<a name="l01737"></a>01737             objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#aca66e9104c473d231da6bda2a4614d32">m_contactProcessingThreshold</a> = 0.f;
<a name="l01738"></a>01738         }
<a name="l01739"></a>01739     }
<a name="l01740"></a>01740 
<a name="l01741"></a>01741     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a889e780a79018334110aeaaebb0b312a">m_ghost</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#af296003e3a9b1b16427b1cc72c2509d2">OB_GHOST</a>) != 0;
<a name="l01742"></a>01742     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#afeab83bd79d2b8e6f3df7da4c3a0699a">m_disableSleeping</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a6d4f379c1afd0aaada360367ba4295ee">OB_COLLISION_RESPONSE</a>) != 0;<span class="comment">//abuse the OB_COLLISION_RESPONSE flag</span>
<a name="l01743"></a>01743     <span class="comment">//mmm, for now, taks this for the size of the dynamicobject</span>
<a name="l01744"></a>01744     <span class="comment">// Blender uses inertia for radius of dynamic object</span>
<a name="l01745"></a>01745     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0c25cac9781d3d63622ee1e3e92b9a1d">m_radius</a> = blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a068e01267176aa1f09b6651fc61ff6f7">inertia</a>;
<a name="l01746"></a>01746     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0e57c5cf100db051a0bcde57c8dc9808">m_in_active_layer</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a> &amp; activeLayerBitInfo) != 0;
<a name="l01747"></a>01747     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a782c5231e5c7d54281d6de34f33aa3c8">m_dynamic_parent</a>=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01748"></a>01748     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a5052fb56a3e986ba4f55ff840d42f32e">m_isdeformable</a> = ((blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; 2)) != 0;
<a name="l01749"></a>01749     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a2a2d8e41e05888fc2ccf7d1002d6843d">m_dyna</a>?<a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498a91dc35df4f5f5039d7ea00ea82618201">KX_BOUNDSPHERE</a>:<a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498aa615954e6f6374c988d5229f4997089b">KX_BOUNDMESH</a>;
<a name="l01750"></a>01750     
<a name="l01751"></a>01751     <span class="keywordflow">if</span> ((blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#af92fc03b976c0b0b12655c193bd15a44">OB_SOFT_BODY</a>) &amp;&amp; !(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a53ba2501623bb81463914897c276c1d3">OB_BOUNDS</a>))
<a name="l01752"></a>01752     {
<a name="l01753"></a>01753         objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498aa615954e6f6374c988d5229f4997089b">KX_BOUNDMESH</a>;
<a name="l01754"></a>01754     }
<a name="l01755"></a>01755 
<a name="l01756"></a>01756     <a class="code" href="../../dc/dc5/structKX__BoxBounds.html">KX_BoxBounds</a> <a class="code" href="../../de/de7/structObject.html#a5513f8ac51a6d67252f5c3ceaf3c34eb">bb</a>;
<a name="l01757"></a>01757     <a class="code" href="../../d5/d6c/structDerivedMesh.html">DerivedMesh</a>* dm = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01758"></a>01758     <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abb4098bf9868e54fc875379eb10009f7">GetDeformer</a>())
<a name="l01759"></a>01759         dm = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abb4098bf9868e54fc875379eb10009f7">GetDeformer</a>()-&gt;<a class="code" href="../../d7/dc3/classRAS__Deformer.html#a0f9c443343b214bd2812b7e37470c78c">GetPhysicsMesh</a>();
<a name="l01760"></a>01760     <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a6a42ccf9cf5644e3bb666cc5fd5b2172">my_get_local_bounds</a>(blenderobject,dm,objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ad158270d698d6c45b69ea4b875b7e3ab">box</a>.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#ac9ce4505652f35a25de4de112cc3547d">m_center</a>,bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>);
<a name="l01761"></a>01761     <span class="keywordflow">if</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a53ba2501623bb81463914897c276c1d3">OB_BOUNDS</a>)
<a name="l01762"></a>01762     {
<a name="l01763"></a>01763         <span class="keywordflow">switch</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a16dc75c68bc6868b924999fea2e85183">collision_boundtype</a>)
<a name="l01764"></a>01764         {
<a name="l01765"></a>01765             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a72f33cfe4bcec0c725cff4b05f5f4ce5">OB_BOUND_BOX</a>:
<a name="l01766"></a>01766                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498a5b6d917d87de164d08d63cf9aab0babc">KX_BOUNDBOX</a>;
<a name="l01767"></a>01767                 <span class="comment">//mmm, has to be divided by 2 to be proper extends</span>
<a name="l01768"></a>01768                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ad158270d698d6c45b69ea4b875b7e3ab">box</a>.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[0]=2.f*bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[0];
<a name="l01769"></a>01769                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ad158270d698d6c45b69ea4b875b7e3ab">box</a>.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[1]=2.f*bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[1];
<a name="l01770"></a>01770                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#ad158270d698d6c45b69ea4b875b7e3ab">box</a>.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[2]=2.f*bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[2];
<a name="l01771"></a>01771                 <span class="keywordflow">break</span>;
<a name="l01772"></a>01772             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a7da99bc025ab41a300441fe53c481a35">OB_BOUND_CONVEX_HULL</a>:
<a name="l01773"></a>01773                 <span class="keywordflow">if</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>)
<a name="l01774"></a>01774                 {
<a name="l01775"></a>01775                     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498af30f6c2dbe487b4b16ab07494f8a136d">KX_BOUNDPOLYTOPE</a>;
<a name="l01776"></a>01776                     <span class="keywordflow">break</span>;
<a name="l01777"></a>01777                 }
<a name="l01778"></a>01778                 <span class="comment">// Object is not a mesh... fall through OB_BOUND_TRIANGLE_MESH to</span>
<a name="l01779"></a>01779                 <span class="comment">// OB_BOUND_SPHERE</span>
<a name="l01780"></a>01780             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ab91ffb9863492c97db7333576289893b">OB_BOUND_TRIANGLE_MESH</a>:
<a name="l01781"></a>01781                 <span class="keywordflow">if</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>)
<a name="l01782"></a>01782                 {
<a name="l01783"></a>01783                     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498aa615954e6f6374c988d5229f4997089b">KX_BOUNDMESH</a>;
<a name="l01784"></a>01784                     <span class="keywordflow">break</span>;
<a name="l01785"></a>01785                 }
<a name="l01786"></a>01786                 <span class="comment">// Object is not a mesh... can&#39;t use polyhedron.</span>
<a name="l01787"></a>01787                 <span class="comment">// Fall through and become a sphere.</span>
<a name="l01788"></a>01788             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a12dc86faea388ad0da209de37046e165">OB_BOUND_SPHERE</a>:
<a name="l01789"></a>01789             {
<a name="l01790"></a>01790                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498a91dc35df4f5f5039d7ea00ea82618201">KX_BOUNDSPHERE</a>;
<a name="l01791"></a>01791                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#ad61aa7dbd910dbbc657d3649d2f10f68">m_radius</a> = <a class="code" href="../../dd/d95/MT__MinMax_8h.html#a196e2aded079041e1aa6ec864cc51289">MT_max</a>(bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[0], <a class="code" href="../../dd/d95/MT__MinMax_8h.html#a196e2aded079041e1aa6ec864cc51289">MT_max</a>(bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[1], bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[2]));
<a name="l01792"></a>01792                 <span class="keywordflow">break</span>;
<a name="l01793"></a>01793             }
<a name="l01794"></a>01794             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a2aa458321e483c765698791514be074d">OB_BOUND_CYLINDER</a>:
<a name="l01795"></a>01795             {
<a name="l01796"></a>01796                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498aaa8c85d9d8cfa90f67813502ea83a3d1">KX_BOUNDCYLINDER</a>;
<a name="l01797"></a>01797                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#ad61aa7dbd910dbbc657d3649d2f10f68">m_radius</a> = <a class="code" href="../../dd/d95/MT__MinMax_8h.html#a196e2aded079041e1aa6ec864cc51289">MT_max</a>(bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[0], bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[1]);
<a name="l01798"></a>01798                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#a270e49e4f6da154b26a35c1b36a1eb3c">m_height</a> = 2.f*bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[2];
<a name="l01799"></a>01799                 <span class="keywordflow">break</span>;
<a name="l01800"></a>01800             }
<a name="l01801"></a>01801             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a2ef5a74afe035ebf8b1344f6ab0f00c0">OB_BOUND_CONE</a>:
<a name="l01802"></a>01802             {
<a name="l01803"></a>01803                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498a87bea1bf3d641072f2d817f8d616e9c0">KX_BOUNDCONE</a>;
<a name="l01804"></a>01804                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#ad61aa7dbd910dbbc657d3649d2f10f68">m_radius</a> = <a class="code" href="../../dd/d95/MT__MinMax_8h.html#a196e2aded079041e1aa6ec864cc51289">MT_max</a>(bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[0], bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[1]);
<a name="l01805"></a>01805                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#a270e49e4f6da154b26a35c1b36a1eb3c">m_height</a> = 2.f*bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[2];
<a name="l01806"></a>01806                 <span class="keywordflow">break</span>;
<a name="l01807"></a>01807             }
<a name="l01808"></a>01808             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a659ef8b9baabc2c77fe2750bf0b50429">OB_BOUND_CAPSULE</a>:
<a name="l01809"></a>01809             {
<a name="l01810"></a>01810                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a0f16a7259cf5a0dc78b64129ac06481e">m_boundclass</a> = <a class="code" href="../../d7/d65/KX__ConvertPhysicsObject_8h.html#a39af9cd48df73be814b55929af6a2498a9fb8393f8804dd6001afe17ed88842ba">KX_BOUNDCAPSULE</a>;
<a name="l01811"></a>01811                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#ad61aa7dbd910dbbc657d3649d2f10f68">m_radius</a> = <a class="code" href="../../dd/d95/MT__MinMax_8h.html#a196e2aded079041e1aa6ec864cc51289">MT_max</a>(bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[0], bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[1]);
<a name="l01812"></a>01812                 objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#a270e49e4f6da154b26a35c1b36a1eb3c">m_height</a> = 2.f*(bb.<a class="code" href="../../dc/dc5/structKX__BoxBounds.html#a07fb4676041e1193e73fec6f5744a64a">m_extends</a>[2]-objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#ad61aa7dbd910dbbc657d3649d2f10f68">m_radius</a>);
<a name="l01813"></a>01813                 <span class="keywordflow">if</span> (objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#a270e49e4f6da154b26a35c1b36a1eb3c">m_height</a> &lt; 0.f)
<a name="l01814"></a>01814                     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7443a7cd7674987ab3f416f2f487180e">m_boundobject</a>.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a01b11cd260859fee687f5e445ab84332">c</a>.<a class="code" href="../../da/d1e/structKX__CBounds.html#a270e49e4f6da154b26a35c1b36a1eb3c">m_height</a> = 0.f;
<a name="l01815"></a>01815                 <span class="keywordflow">break</span>;
<a name="l01816"></a>01816             }
<a name="l01817"></a>01817         }
<a name="l01818"></a>01818     }
<a name="l01819"></a>01819 
<a name="l01820"></a>01820     
<a name="l01821"></a>01821     <span class="keywordflow">if</span> (parent<span class="comment">/* &amp;&amp; (parent-&gt;gameflag &amp; OB_DYNAMIC)*/</span>) {
<a name="l01822"></a>01822         <span class="comment">// parented object cannot be dynamic</span>
<a name="l01823"></a>01823         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a> *parentgameobject = converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aeaf9dc2ae10c77bc743a3290e0b807a8">FindGameObject</a>(parent);
<a name="l01824"></a>01824         objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a782c5231e5c7d54281d6de34f33aa3c8">m_dynamic_parent</a> = parentgameobject;
<a name="l01825"></a>01825         <span class="comment">//cannot be dynamic:</span>
<a name="l01826"></a>01826         objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a2a2d8e41e05888fc2ccf7d1002d6843d">m_dyna</a> = <span class="keyword">false</span>;
<a name="l01827"></a>01827         objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#a7e800924c61802411a91f3ce10ee5be0">m_softbody</a> = <span class="keyword">false</span>;
<a name="l01828"></a>01828         shapeprops-&gt;<a class="code" href="../../d4/dd1/structPHY__ShapeProps.html#a8a75b26b55c5c30d0afee6e8dd7561c5">m_mass</a> = 0.f;
<a name="l01829"></a>01829     }
<a name="l01830"></a>01830 
<a name="l01831"></a>01831     
<a name="l01832"></a>01832     objprop.<a class="code" href="../../d7/da6/structKX__ObjectProperties.html#abb844c50a5955d78850fc33259d71bbb">m_concave</a> = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a16dc75c68bc6868b924999fea2e85183">collision_boundtype</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ab91ffb9863492c97db7333576289893b">OB_BOUND_TRIANGLE_MESH</a>);
<a name="l01833"></a>01833     
<a name="l01834"></a>01834     <span class="keywordflow">switch</span> (physics_engine)
<a name="l01835"></a>01835     {
<a name="l01836"></a>01836 <span class="preprocessor">#ifdef USE_BULLET</span>
<a name="l01837"></a>01837 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../d3/d98/KX__PhysicsEngineEnums_8h.html#a1d02ecff9c9296faee3bc2488e2d4555a989601135c4f2574a13baf105acaf9a4">UseBullet</a>:
<a name="l01838"></a>01838             KX_ConvertBulletObject(gameobj, meshobj, dm, kxscene, shapeprops, smmaterial, &amp;objprop);
<a name="l01839"></a>01839             <span class="keywordflow">break</span>;
<a name="l01840"></a>01840 
<a name="l01841"></a>01841 <span class="preprocessor">#endif</span>
<a name="l01842"></a>01842 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="../../d3/d98/KX__PhysicsEngineEnums_8h.html#a1d02ecff9c9296faee3bc2488e2d4555ae707385fb6e96ee649832f93a7fbe29b">UseNone</a>:
<a name="l01843"></a>01843         <span class="keywordflow">default</span>:
<a name="l01844"></a>01844             <span class="keywordflow">break</span>;
<a name="l01845"></a>01845     }
<a name="l01846"></a>01846     <span class="keyword">delete</span> shapeprops;
<a name="l01847"></a>01847     <span class="keyword">delete</span> smmaterial;
<a name="l01848"></a>01848     <span class="keywordflow">if</span> (dm) {
<a name="l01849"></a>01849         dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a18e4784d6ea7e5877394c53cdfd65691">needsFree</a> = 1;
<a name="l01850"></a>01850         dm-&gt;<a class="code" href="../../d5/d6c/structDerivedMesh.html#a36c159344a023f5fbe64f12006c8647f">release</a>(dm);
<a name="l01851"></a>01851     }
<a name="l01852"></a>01852 }
<a name="l01853"></a>01853 
<a name="l01854"></a>01854 
<a name="l01855"></a>01855 
<a name="l01856"></a>01856 
<a name="l01857"></a>01857 
<a name="l01858"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a85360e2e7e72d5b54be72e8126a0acf5">01858</a> <span class="keyword">static</span> <a class="code" href="../../d8/d31/classKX__LightObject.html">KX_LightObject</a> *<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a85360e2e7e72d5b54be72e8126a0acf5">gamelight_from_blamp</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <a class="code" href="../../d5/d72/structLamp.html">Lamp</a> *la, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> layerflag, <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a> *kxscene, <a class="code" href="../../d0/d53/classRAS__IRenderTools.html">RAS_IRenderTools</a> *rendertools, <a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html">KX_BlenderSceneConverter</a> *converter)
<a name="l01859"></a>01859 {
<a name="l01860"></a>01860     <a class="code" href="../../de/df8/structRAS__LightObject.html">RAS_LightObject</a> lightobj;
<a name="l01861"></a>01861     <a class="code" href="../../d8/d31/classKX__LightObject.html">KX_LightObject</a> *gamelight;
<a name="l01862"></a>01862     
<a name="l01863"></a>01863     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#ab5b1201679f84ddac8a9752b13c9b43d">m_att1</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#ac71d383b39dc0e0dfc6bb6243756471f">att1</a>;
<a name="l01864"></a>01864     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a143a64604f75bbfcdc44d2d32f849725">m_att2</a> = (la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a1998f8f61376aff315a6b618e8aa6bba">mode</a> &amp; <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a2e09bd4d28e8365b52c3e5d67a41deca">LA_QUAD</a>) ? la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a74abd39c5f30e406fddd65cd33ae63a3">att2</a> : 0.0f;
<a name="l01865"></a>01865     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a075d0480140008b74255f3bcbb9ea8bc">m_red</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a78ed635336937d2f878451f2ad65e849">r</a>;
<a name="l01866"></a>01866     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a0224596645035ba8824fdc870068dbce">m_green</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#ae84f4026e3ea64b20481dfcfa0c66f3f">g</a>;
<a name="l01867"></a>01867     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a2b0d5bf98443167a9cfb3ba1fbb564a6">m_blue</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a2dee0a9717f05d6faff57abed6dd39dc">b</a>;
<a name="l01868"></a>01868     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#ab166a638e1e762f4ceccee429cdbcb55">m_distance</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a7dfb335997197bb8a645e3540a91bf4d">dist</a>;
<a name="l01869"></a>01869     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#ac609df934591161fb5e774123b54bdff">m_energy</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a92ccf572420771f58d0907c0ae410c42">energy</a>;
<a name="l01870"></a>01870     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#ae69cf27f948257ffa569b85350238faa">m_layer</a> = layerflag;
<a name="l01871"></a>01871     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#ad01b11a8f09d750fc83f1f815e1ea82a">m_spotblend</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#afa8564cb927dc5cf1398f89526db5fc1">spotblend</a>;
<a name="l01872"></a>01872     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#aeac3304044548a1b6c488109d12bdbe5">m_spotsize</a> = la-&gt;<a class="code" href="../../d5/d72/structLamp.html#afbf90c480b2728c3b48a5680dd4a9487">spotsize</a>;
<a name="l01873"></a>01873     
<a name="l01874"></a>01874     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#ad580f1fe5dd235e6f7a4721707d7ef8f">m_nodiffuse</a> = (la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a1998f8f61376aff315a6b618e8aa6bba">mode</a> &amp; <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#aae2ddb1afedc2c63b748c2af6da2dbcd">LA_NO_DIFF</a>) != 0;
<a name="l01875"></a>01875     lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a5fd9b9924dad5d4b77e7566312869bb7">m_nospecular</a> = (la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a1998f8f61376aff315a6b618e8aa6bba">mode</a> &amp; <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a134042cbd75d17448cbb831d0f5d2dca">LA_NO_SPEC</a>) != 0;
<a name="l01876"></a>01876     
<a name="l01877"></a>01877     <span class="keywordtype">bool</span> glslmat = converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#afe1f045607e0bef2aa9bee3482c04290">GetGLSLMaterials</a>();
<a name="l01878"></a>01878 
<a name="l01879"></a>01879     <span class="comment">// in GLSL NEGATIVE LAMP is handled inside the lamp update function</span>
<a name="l01880"></a>01880     <span class="keywordflow">if</span> (glslmat==0) {
<a name="l01881"></a>01881         <span class="keywordflow">if</span> (la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a1998f8f61376aff315a6b618e8aa6bba">mode</a> &amp; <a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a51f4b25b6ef31b95d74fd251b103bd7f">LA_NEG</a>)
<a name="l01882"></a>01882         {
<a name="l01883"></a>01883             lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a075d0480140008b74255f3bcbb9ea8bc">m_red</a> = -lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a075d0480140008b74255f3bcbb9ea8bc">m_red</a>;
<a name="l01884"></a>01884             lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a0224596645035ba8824fdc870068dbce">m_green</a> = -lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a0224596645035ba8824fdc870068dbce">m_green</a>;
<a name="l01885"></a>01885             lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a2b0d5bf98443167a9cfb3ba1fbb564a6">m_blue</a> = -lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a2b0d5bf98443167a9cfb3ba1fbb564a6">m_blue</a>;
<a name="l01886"></a>01886         }
<a name="l01887"></a>01887     }
<a name="l01888"></a>01888         
<a name="l01889"></a>01889     <span class="keywordflow">if</span> (la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a6c8bfeca1d8a74252bfe284de7d754cb">type</a>==<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a863bf336582eacc01aec51ebf0a5f412">LA_SUN</a>) {
<a name="l01890"></a>01890         lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a7e70d027075027095fa626d119cd1308">m_type</a> = <a class="code" href="../../de/df8/structRAS__LightObject.html#ae35e96da69ab20062f0c087d15763e85a71ffc7e992f5feec78d4a2045a53c1d9">RAS_LightObject::LIGHT_SUN</a>;
<a name="l01891"></a>01891     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (la-&gt;<a class="code" href="../../d5/d72/structLamp.html#a6c8bfeca1d8a74252bfe284de7d754cb">type</a>==<a class="code" href="../../d0/d16/DNA__lamp__types_8h.html#a55ba7e9dc61979b7097cb11dace90bdb">LA_SPOT</a>) {
<a name="l01892"></a>01892         lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a7e70d027075027095fa626d119cd1308">m_type</a> = <a class="code" href="../../de/df8/structRAS__LightObject.html#ae35e96da69ab20062f0c087d15763e85a2c2d0f36cff9df172d18ab3f37ffd6ad">RAS_LightObject::LIGHT_SPOT</a>;
<a name="l01893"></a>01893     } <span class="keywordflow">else</span> {
<a name="l01894"></a>01894         lightobj.<a class="code" href="../../de/df8/structRAS__LightObject.html#a7e70d027075027095fa626d119cd1308">m_type</a> = <a class="code" href="../../de/df8/structRAS__LightObject.html#ae35e96da69ab20062f0c087d15763e85a645b04e29427b91f06e6c40499b42781">RAS_LightObject::LIGHT_NORMAL</a>;
<a name="l01895"></a>01895     }
<a name="l01896"></a>01896 
<a name="l01897"></a>01897     gamelight = <span class="keyword">new</span> <a class="code" href="../../d8/d31/classKX__LightObject.html">KX_LightObject</a>(kxscene, <a class="code" href="../../d2/da3/classKX__Scene.html#a95b425043c91b7e775df61e5d34a581e">KX_Scene::m_callbacks</a>, rendertools,
<a name="l01898"></a>01898         lightobj, glslmat);
<a name="l01899"></a>01899     
<a name="l01900"></a>01900     <span class="keywordflow">return</span> gamelight;
<a name="l01901"></a>01901 }
<a name="l01902"></a>01902 
<a name="l01903"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a7eff5d2ba6e732cdbb4e6033b2296332">01903</a> <span class="keyword">static</span> <a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a> *<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a7eff5d2ba6e732cdbb4e6033b2296332">gamecamera_from_bcamera</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob, <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a> *kxscene, <a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html">KX_BlenderSceneConverter</a> *converter)
<a name="l01904"></a>01904 {
<a name="l01905"></a>01905     <a class="code" href="../../d7/d7e/structCamera.html">Camera</a>* ca = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d7e/structCamera.html">Camera</a>*<span class="keyword">&gt;</span>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l01906"></a>01906     <a class="code" href="../../d4/d81/structRAS__CameraData.html">RAS_CameraData</a> camdata(ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#a480d411803627517badcebf58c28d0da">lens</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#afc85f917510266df662de3aa053c0ee3">ortho_scale</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#acdf39c5ffbd9b9363fd230256a6a5bef">sensor_x</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#a18c42686b5afa4583d29abdf269d2948">sensor_y</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#a0ed5613b5883c690ae6b8cf690a36d11">sensor_fit</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#a3c6d9c49ef4066ff463617f719d1fef2">clipsta</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#a394ace3dbfbcb6a755adb8690fe76288">clipend</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#abd4c2c91f9398b35caaa737a7bc6da3b">type</a> == <a class="code" href="../../d6/d3b/DNA__camera__types_8h.html#a536998ae3a08d2731455a7a7964393a6">CAM_PERSP</a>, ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#ad7ca0058a5dd2fc4d773753da7e41178">YF_dofdist</a>);
<a name="l01907"></a>01907     <a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a> *gamecamera;
<a name="l01908"></a>01908     
<a name="l01909"></a>01909     gamecamera= <span class="keyword">new</span> <a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a>(kxscene, <a class="code" href="../../d2/da3/classKX__Scene.html#a95b425043c91b7e775df61e5d34a581e">KX_Scene::m_callbacks</a>, camdata);
<a name="l01910"></a>01910     gamecamera-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a43c0693d1745f2b6cbe31d0ef691d3a5">SetName</a>(ca-&gt;<a class="code" href="../../d7/d7e/structCamera.html#ab734d7dca17ac9d8cefcbac786413e41">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l01911"></a>01911     
<a name="l01912"></a>01912     <span class="keywordflow">return</span> gamecamera;
<a name="l01913"></a>01913 }
<a name="l01914"></a>01914 
<a name="l01915"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a2826e1ca8364658f2aa80b11d830db41">01915</a> <span class="keyword">static</span> <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a> *<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a2826e1ca8364658f2aa80b11d830db41">gameobject_from_blenderobject</a>(
<a name="l01916"></a>01916                                 <a class="code" href="../../de/de7/structObject.html">Object</a> *ob, 
<a name="l01917"></a>01917                                 <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a> *kxscene, 
<a name="l01918"></a>01918                                 <a class="code" href="../../d0/d53/classRAS__IRenderTools.html">RAS_IRenderTools</a> *rendertools, 
<a name="l01919"></a>01919                                 <a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html">KX_BlenderSceneConverter</a> *converter) 
<a name="l01920"></a>01920 {
<a name="l01921"></a>01921     <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a> *gameobj = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01922"></a>01922     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *blenderscene = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a217279a18aca964cf8d28d3ad6bdb95d">GetBlenderScene</a>();
<a name="l01923"></a>01923     
<a name="l01924"></a>01924     <span class="keywordflow">switch</span>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>)
<a name="l01925"></a>01925     {
<a name="l01926"></a>01926     <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a1514ec0465b89013544107c908e7abca">OB_LAMP</a>:
<a name="l01927"></a>01927     {
<a name="l01928"></a>01928         <a class="code" href="../../d8/d31/classKX__LightObject.html">KX_LightObject</a>* gamelight = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a85360e2e7e72d5b54be72e8126a0acf5">gamelight_from_blamp</a>(ob, static_cast&lt;Lamp*&gt;(ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>), ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a>, kxscene, rendertools, converter);
<a name="l01929"></a>01929         gameobj = gamelight;
<a name="l01930"></a>01930         
<a name="l01931"></a>01931         <span class="keywordflow">if</span> (blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a506dd867fc58506c37c1e56f6b134056">lay</a> &amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a>)
<a name="l01932"></a>01932         {
<a name="l01933"></a>01933             gamelight-&gt;<a class="code" href="../../d7/d9c/classCValue.html#afbffee1cbf1ba190723f69445a2471ca">AddRef</a>();
<a name="l01934"></a>01934             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#ad0262902bd268122e328de3448809fa6">GetLightList</a>()-&gt;<a class="code" href="../../d6/de7/classCListValue.html#ab20ce4d43a9f9aec11731aa4abddb059">Add</a>(gamelight);
<a name="l01935"></a>01935         }
<a name="l01936"></a>01936 
<a name="l01937"></a>01937         <span class="keywordflow">break</span>;
<a name="l01938"></a>01938     }
<a name="l01939"></a>01939     
<a name="l01940"></a>01940     <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#afd7fa4376c670f245aeed7a7116c7005">OB_CAMERA</a>:
<a name="l01941"></a>01941     {
<a name="l01942"></a>01942         <a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a>* gamecamera = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a7eff5d2ba6e732cdbb4e6033b2296332">gamecamera_from_bcamera</a>(ob, kxscene, converter);
<a name="l01943"></a>01943         gameobj = gamecamera;
<a name="l01944"></a>01944         
<a name="l01945"></a>01945         <span class="comment">//don&#39;t add a reference: the camera list in kxscene-&gt;m_cameras is not released at the end</span>
<a name="l01946"></a>01946         <span class="comment">//gamecamera-&gt;AddRef();</span>
<a name="l01947"></a>01947         kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#aaee2b18c7468e717b0536dc6449857d0">AddCamera</a>(gamecamera);
<a name="l01948"></a>01948         
<a name="l01949"></a>01949         <span class="keywordflow">break</span>;
<a name="l01950"></a>01950     }
<a name="l01951"></a>01951     
<a name="l01952"></a>01952     <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>:
<a name="l01953"></a>01953     {
<a name="l01954"></a>01954         <a class="code" href="../../da/d29/structMesh.html">Mesh</a>* <a class="code" href="../../de/de7/structObject.html#ad755772f4633cd0ef94a05738ffb5e84">mesh</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="../../da/d29/structMesh.html">Mesh</a>*<span class="keyword">&gt;</span>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>);
<a name="l01955"></a>01955         <span class="keywordtype">float</span> center[3], extents[3];
<a name="l01956"></a>01956         <span class="keywordtype">float</span> radius = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a7bb64659859a4f98db583890027c9aff">my_boundbox_mesh</a>((<a class="code" href="../../da/d29/structMesh.html">Mesh</a>*) ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>, center, extents);
<a name="l01957"></a>01957         <a class="code" href="../../d5/d85/classRAS__MeshObject.html">RAS_MeshObject</a>* meshobj = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a9dbfbbf38d5103b376e1d9d27915075a">BL_ConvertMesh</a>(mesh,ob,kxscene,converter);
<a name="l01958"></a>01958         
<a name="l01959"></a>01959         <span class="comment">// needed for python scripting</span>
<a name="l01960"></a>01960         kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#ad9270d324274b162133dd9a02f9bca58">GetLogicManager</a>()-&gt;<a class="code" href="../../db/d0f/classSCA__LogicManager.html#a11c13569539a998c302b2e47924581bb">RegisterMeshName</a>(meshobj-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#a8e232cc1d6f124cc472f9717f82c2f77">GetName</a>(),meshobj);
<a name="l01961"></a>01961 
<a name="l01962"></a>01962         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a3f9a77538b44c005c3225228453ef3a2">OB_NAVMESH</a>)
<a name="l01963"></a>01963         {
<a name="l01964"></a>01964             gameobj = <span class="keyword">new</span> <a class="code" href="../../db/d94/classKX__NavMeshObject.html">KX_NavMeshObject</a>(kxscene,<a class="code" href="../../d2/da3/classKX__Scene.html#a95b425043c91b7e775df61e5d34a581e">KX_Scene::m_callbacks</a>);
<a name="l01965"></a>01965             gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ab9aa7b85e7af077ebf3b475b1fdf0b64">AddMesh</a>(meshobj);
<a name="l01966"></a>01966             <span class="keywordflow">break</span>;
<a name="l01967"></a>01967         }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969         gameobj = <span class="keyword">new</span> <a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>(ob,kxscene,<a class="code" href="../../d2/da3/classKX__Scene.html#a95b425043c91b7e775df61e5d34a581e">KX_Scene::m_callbacks</a>);
<a name="l01970"></a>01970     
<a name="l01971"></a>01971         <span class="comment">// set transformation</span>
<a name="l01972"></a>01972         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ab9aa7b85e7af077ebf3b475b1fdf0b64">AddMesh</a>(meshobj);
<a name="l01973"></a>01973     
<a name="l01974"></a>01974         <span class="comment">// for all objects: check whether they want to</span>
<a name="l01975"></a>01975         <span class="comment">// respond to updates</span>
<a name="l01976"></a>01976         <span class="keywordtype">bool</span> ignoreActivityCulling =  
<a name="l01977"></a>01977             ((ob-&gt;<a class="code" href="../../de/de7/structObject.html#ab86a040ed0e8609b80350a06a34ca018">gameflag2</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#aed53aad5ca38a7886528f857e282ae57">OB_NEVER_DO_ACTIVITY_CULLING</a>)!=0);
<a name="l01978"></a>01978         gameobj-&gt;<a class="code" href="../../da/d68/classSCA__IObject.html#a0e5884c86d5f6dd3cd8cf3e3b08529f9">SetIgnoreActivityCulling</a>(ignoreActivityCulling);
<a name="l01979"></a>01979         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a1fae7b469d6f4bcbd4e4aa10ddc76a67">SetOccluder</a>((ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a5608cada5cca091d4d47bf7a26a4813e">OB_OCCLUDER</a>) != 0, <span class="keyword">false</span>);
<a name="l01980"></a>01980     
<a name="l01981"></a>01981         <span class="comment">// two options exists for deform: shape keys and armature</span>
<a name="l01982"></a>01982         <span class="comment">// only support relative shape key</span>
<a name="l01983"></a>01983         <span class="keywordtype">bool</span> bHasShapeKey = mesh-&gt;<a class="code" href="../../da/d29/structMesh.html#ad5e8f2b7e52cbc5caf836c656db83589">key</a> != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; mesh-&gt;<a class="code" href="../../da/d29/structMesh.html#ad5e8f2b7e52cbc5caf836c656db83589">key</a>-&gt;<a class="code" href="../../d1/d9e/structKey.html#af4673161e52f45eb6c8efc3ea71939fa">type</a>==<a class="code" href="../../de/d41/DNA__key__types_8h.html#a14061dd054afd472999a4f4f6cdf3923a166121abc12de1fb379b9e6956f45c67">KEY_RELATIVE</a>;
<a name="l01984"></a>01984         <span class="keywordtype">bool</span> bHasDvert = mesh-&gt;<a class="code" href="../../da/d29/structMesh.html#a5d3c41c9b430b3ed6e0454a85fea68de">dvert</a> != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a11c2e3299c854eb361471ea041397cb7">defbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l01985"></a>01985         <span class="keywordtype">bool</span> bHasArmature = (<a class="code" href="../../d8/dbf/classBL__ModifierDeformer.html#a4347aece15d3c85492d0a8736386e111">BL_ModifierDeformer::HasArmatureDeformer</a>(ob) &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a> &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a17c162dffb7fd4f0acb11d051374609b">OB_ARMATURE</a> &amp;&amp; bHasDvert);
<a name="l01986"></a>01986         <span class="keywordtype">bool</span> bHasModifier = <a class="code" href="../../d8/dbf/classBL__ModifierDeformer.html#aa93c52466dcd9da31b79aba8c7368057">BL_ModifierDeformer::HasCompatibleDeformer</a>(ob);
<a name="l01987"></a>01987 <span class="preprocessor">#ifdef USE_BULLET</span>
<a name="l01988"></a>01988 <span class="preprocessor"></span>        <span class="keywordtype">bool</span> bHasSoftBody = (!ob-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a> &amp;&amp; (ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#af92fc03b976c0b0b12655c193bd15a44">OB_SOFT_BODY</a>));
<a name="l01989"></a>01989 <span class="preprocessor">#endif</span>
<a name="l01990"></a>01990 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (bHasModifier) {
<a name="l01991"></a>01991             <a class="code" href="../../d8/dbf/classBL__ModifierDeformer.html">BL_ModifierDeformer</a> *dcont = <span class="keyword">new</span> <a class="code" href="../../d8/dbf/classBL__ModifierDeformer.html">BL_ModifierDeformer</a>((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a> *)gameobj,
<a name="l01992"></a>01992                                                                 kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a217279a18aca964cf8d28d3ad6bdb95d">GetBlenderScene</a>(), ob, meshobj);
<a name="l01993"></a>01993             ((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj)-&gt;SetDeformer(dcont);
<a name="l01994"></a>01994             <span class="keywordflow">if</span> (bHasShapeKey &amp;&amp; bHasArmature)
<a name="l01995"></a>01995                 dcont-&gt;<a class="code" href="../../d6/d12/classBL__ShapeDeformer.html#a2960be18d159d1bcf7e2324f1b75b64a">LoadShapeDrivers</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>);
<a name="l01996"></a>01996         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bHasShapeKey) {
<a name="l01997"></a>01997             <span class="comment">// not that we can have shape keys without dvert! </span>
<a name="l01998"></a>01998             <a class="code" href="../../d6/d12/classBL__ShapeDeformer.html">BL_ShapeDeformer</a> *dcont = <span class="keyword">new</span> <a class="code" href="../../d6/d12/classBL__ShapeDeformer.html">BL_ShapeDeformer</a>((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj, 
<a name="l01999"></a>01999                                                             ob, meshobj);
<a name="l02000"></a>02000             ((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj)-&gt;SetDeformer(dcont);
<a name="l02001"></a>02001             <span class="keywordflow">if</span> (bHasArmature)
<a name="l02002"></a>02002                 dcont-&gt;<a class="code" href="../../d6/d12/classBL__ShapeDeformer.html#a2960be18d159d1bcf7e2324f1b75b64a">LoadShapeDrivers</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>);
<a name="l02003"></a>02003         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bHasArmature) {
<a name="l02004"></a>02004             <a class="code" href="../../d2/d80/classBL__SkinDeformer.html">BL_SkinDeformer</a> *dcont = <span class="keyword">new</span> <a class="code" href="../../d2/d80/classBL__SkinDeformer.html">BL_SkinDeformer</a>((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj,
<a name="l02005"></a>02005                                                             ob, meshobj);
<a name="l02006"></a>02006             ((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj)-&gt;SetDeformer(dcont);
<a name="l02007"></a>02007         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bHasDvert) {
<a name="l02008"></a>02008             <span class="comment">// this case correspond to a mesh that can potentially deform but not with the</span>
<a name="l02009"></a>02009             <span class="comment">// object to which it is attached for the moment. A skin mesh was created in</span>
<a name="l02010"></a>02010             <span class="comment">// BL_ConvertMesh() so must create a deformer too!</span>
<a name="l02011"></a>02011             <a class="code" href="../../d2/dc5/classBL__MeshDeformer.html">BL_MeshDeformer</a> *dcont = <span class="keyword">new</span> <a class="code" href="../../d2/dc5/classBL__MeshDeformer.html">BL_MeshDeformer</a>((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj,
<a name="l02012"></a>02012                                                           ob, meshobj);
<a name="l02013"></a>02013             ((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj)-&gt;SetDeformer(dcont);
<a name="l02014"></a>02014 <span class="preprocessor">#ifdef USE_BULLET</span>
<a name="l02015"></a>02015 <span class="preprocessor"></span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bHasSoftBody) {
<a name="l02016"></a>02016             <a class="code" href="../../d6/d77/classKX__SoftBodyDeformer.html">KX_SoftBodyDeformer</a> *dcont = <span class="keyword">new</span> <a class="code" href="../../d6/d77/classKX__SoftBodyDeformer.html">KX_SoftBodyDeformer</a>(meshobj, (<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj);
<a name="l02017"></a>02017             ((<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)gameobj)-&gt;SetDeformer(dcont);
<a name="l02018"></a>02018 <span class="preprocessor">#endif</span>
<a name="l02019"></a>02019 <span class="preprocessor"></span>        }
<a name="l02020"></a>02020         
<a name="l02021"></a>02021         <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a> <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a> = <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a>(center) - <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a>(extents);
<a name="l02022"></a>02022         <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a> <a class="code" href="../../d0/d4b/blender_2imbuf_2intern_2dds_2Common_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a> = <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a>(center) + <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a>(extents);
<a name="l02023"></a>02023         <a class="code" href="../../d8/db0/classSG__BBox.html">SG_BBox</a> bbox = <a class="code" href="../../d8/db0/classSG__BBox.html">SG_BBox</a>(min, max);
<a name="l02024"></a>02024         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0be04ac2ce18c262fd28cb92f5c296b7">GetSGNode</a>()-&gt;<a class="code" href="../../d4/d22/classSG__Spatial.html#af7b29844eae45cad5e4aaff53bca0c0d">SetBBox</a>(bbox);
<a name="l02025"></a>02025         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0be04ac2ce18c262fd28cb92f5c296b7">GetSGNode</a>()-&gt;<a class="code" href="../../d4/d22/classSG__Spatial.html#a4f5866990ac53d4528b2b52049bc43f4">SetRadius</a>(radius);
<a name="l02026"></a>02026     
<a name="l02027"></a>02027         <span class="keywordflow">break</span>;
<a name="l02028"></a>02028     }
<a name="l02029"></a>02029     
<a name="l02030"></a>02030     <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a17c162dffb7fd4f0acb11d051374609b">OB_ARMATURE</a>:
<a name="l02031"></a>02031     {
<a name="l02032"></a>02032         <a class="code" href="../../d9/d9f/structbArmature.html">bArmature</a> *arm = (<a class="code" href="../../d9/d9f/structbArmature.html">bArmature</a>*)ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l02033"></a>02033         gameobj = <span class="keyword">new</span> <a class="code" href="../../d7/d42/classBL__ArmatureObject.html">BL_ArmatureObject</a>(
<a name="l02034"></a>02034             kxscene,
<a name="l02035"></a>02035             <a class="code" href="../../d2/da3/classKX__Scene.html#a95b425043c91b7e775df61e5d34a581e">KX_Scene::m_callbacks</a>,
<a name="l02036"></a>02036             ob,
<a name="l02037"></a>02037             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a217279a18aca964cf8d28d3ad6bdb95d">GetBlenderScene</a>(), <span class="comment">// handle</span>
<a name="l02038"></a>02038             arm-&gt;<a class="code" href="../../d9/d9f/structbArmature.html#a2a60f769b0e2ea011bf773112dee47c4">gevertdeformer</a>
<a name="l02039"></a>02039         );
<a name="l02040"></a>02040         <span class="comment">/* Get the current pose from the armature object and apply it as the rest pose */</span>
<a name="l02041"></a>02041         <span class="keywordflow">break</span>;
<a name="l02042"></a>02042     }
<a name="l02043"></a>02043     
<a name="l02044"></a>02044     <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#aae7aa3fbf86ed3619e54240da402fab1">OB_EMPTY</a>:
<a name="l02045"></a>02045     {
<a name="l02046"></a>02046         gameobj = <span class="keyword">new</span> <a class="code" href="../../df/d77/classKX__EmptyObject.html">KX_EmptyObject</a>(kxscene,<a class="code" href="../../d2/da3/classKX__Scene.html#a95b425043c91b7e775df61e5d34a581e">KX_Scene::m_callbacks</a>);
<a name="l02047"></a>02047         <span class="comment">// set transformation</span>
<a name="l02048"></a>02048         <span class="keywordflow">break</span>;
<a name="l02049"></a>02049     }
<a name="l02050"></a>02050 
<a name="l02051"></a>02051     <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a1a94162b6fc469957966a01d41ff71d6">OB_FONT</a>:
<a name="l02052"></a>02052     {
<a name="l02053"></a>02053         <span class="comment">/* font objects have no bounding box */</span>
<a name="l02054"></a>02054         gameobj = <span class="keyword">new</span> <a class="code" href="../../d1/d47/classKX__FontObject.html">KX_FontObject</a>(kxscene,<a class="code" href="../../d2/da3/classKX__Scene.html#a95b425043c91b7e775df61e5d34a581e">KX_Scene::m_callbacks</a>, rendertools, ob);
<a name="l02055"></a>02055 
<a name="l02056"></a>02056         <span class="comment">/* add to the list only the visible fonts */</span>
<a name="l02057"></a>02057         <span class="keywordflow">if</span> ((ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a> &amp; kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a217279a18aca964cf8d28d3ad6bdb95d">GetBlenderScene</a>()-&gt;<a class="code" href="../../d9/d27/structScene.html#a506dd867fc58506c37c1e56f6b134056">lay</a>) != 0)
<a name="l02058"></a>02058             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a45cc2dbf396acb1d4149fed45d2d8cbc">AddFont</a>(static_cast&lt;KX_FontObject*&gt;(gameobj));
<a name="l02059"></a>02059         <span class="keywordflow">break</span>;
<a name="l02060"></a>02060     }
<a name="l02061"></a>02061 
<a name="l02062"></a>02062     }
<a name="l02063"></a>02063     <span class="keywordflow">if</span> (gameobj) 
<a name="l02064"></a>02064     {
<a name="l02065"></a>02065         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a8ff32fac7cda49c0ed9e72639f8f8fd4">SetLayer</a>(ob-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a>);
<a name="l02066"></a>02066         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a709a87c3d2049fedee3373b6b02405b9">SetBlenderObject</a>(ob);
<a name="l02067"></a>02067         <span class="comment">/* set the visibility state based on the objects render option in the outliner */</span>
<a name="l02068"></a>02068         <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ab94b52225b1bb3d5083e9855b32902d0">OB_RESTRICT_RENDER</a>) gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ad375ebbacffde2939f5eadfe86c4e1d7">SetVisible</a>(0, 0);
<a name="l02069"></a>02069     }
<a name="l02070"></a>02070     <span class="keywordflow">return</span> gameobj;
<a name="l02071"></a>02071 }
<a name="l02072"></a>02072 
<a name="l02073"></a><a class="code" href="../../d1/d4c/structparentChildLink.html">02073</a> <span class="keyword">struct </span><a class="code" href="../../d1/d4c/structparentChildLink.html">parentChildLink</a> {
<a name="l02074"></a><a class="code" href="../../d1/d4c/structparentChildLink.html#ae22f6143b4c523b400be7abd3d00c094">02074</a>     <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* <a class="code" href="../../d1/d4c/structparentChildLink.html#ae22f6143b4c523b400be7abd3d00c094">m_blenderchild</a>;
<a name="l02075"></a><a class="code" href="../../d1/d4c/structparentChildLink.html#a4ee6b4b63c8ea56da1ffea64a75925e7">02075</a>     <a class="code" href="../../d8/d3b/classSG__Node.html">SG_Node</a>* <a class="code" href="../../d1/d4c/structparentChildLink.html#a4ee6b4b63c8ea56da1ffea64a75925e7">m_gamechildnode</a>;
<a name="l02076"></a>02076 };
<a name="l02077"></a>02077 
<a name="l02078"></a>02078 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d03/DNA__constraint__types_8h.html">DNA_constraint_types.h</a>&quot;</span>
<a name="l02079"></a>02079 <span class="comment">//XXX #include &quot;BIF_editconstraint.h&quot;</span>
<a name="l02080"></a>02080 
<a name="l02081"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#aa41cfc3b1ad9e37309a0bc261b88ca82">02081</a> <a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#aa41cfc3b1ad9e37309a0bc261b88ca82">get_active_posechannel2</a> (<a class="code" href="../../de/de7/structObject.html">Object</a> *ob)
<a name="l02082"></a>02082 {
<a name="l02083"></a>02083     <a class="code" href="../../d9/d9f/structbArmature.html">bArmature</a> *arm= (<a class="code" href="../../d9/d9f/structbArmature.html">bArmature</a>*)ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l02084"></a>02084     <a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *pchan;
<a name="l02085"></a>02085     
<a name="l02086"></a>02086     <span class="comment">/* find active */</span>
<a name="l02087"></a>02087     for (pchan= (<a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *)ob-&gt;<a class="code" href="../../de/de7/structObject.html#a23522fc15312fc5d99e1e1f68c579c25">pose</a>-&gt;<a class="code" href="../../d3/de4/structbPose.html#a0bcc485e14443c3542a761284fa36b81">chanbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; pchan; pchan= pchan-&gt;next) {
<a name="l02088"></a>02088         <span class="keywordflow">if</span> (pchan-&gt;bone &amp;&amp; (pchan-&gt;bone == arm-&gt;<a class="code" href="../../d9/d9f/structbArmature.html#a7d1c3812f46a8787c49bc84c68c1e118">act_bone</a>) &amp;&amp; (pchan-&gt;bone-&gt;layer &amp; arm-&gt;<a class="code" href="../../d9/d9f/structbArmature.html#ac14cfbfc02b044a0a9b933dcbe002780">layer</a>))
<a name="l02089"></a>02089             <span class="keywordflow">return</span> pchan;
<a name="l02090"></a>02090     }
<a name="l02091"></a>02091     
<a name="l02092"></a>02092     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02093"></a>02093 }
<a name="l02094"></a>02094 
<a name="l02095"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#ac8d0997433be61cf1763dd7f04292945">02095</a> <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#ac8d0997433be61cf1763dd7f04292945">get_active_constraints2</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob)
<a name="l02096"></a>02096 {
<a name="l02097"></a>02097     <span class="keywordflow">if</span> (!ob)
<a name="l02098"></a>02098         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02099"></a>02099 
<a name="l02100"></a>02100   <span class="comment">// XXX - shouldnt we care about the pose data and not the mode???</span>
<a name="l02101"></a>02101     <span class="keywordflow">if</span> (ob-&gt;<a class="code" href="../../de/de7/structObject.html#a4f90725f5876b309d325c84ae4f5c51b">mode</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a36fb08f71e0c90da2a0f21518ef0d550acfed9b4bf4a7e2d3c5ae0b3571e38950">OB_MODE_POSE</a>) { 
<a name="l02102"></a>02102         <a class="code" href="../../dd/d41/structbPoseChannel.html">bPoseChannel</a> *pchan;
<a name="l02103"></a>02103 
<a name="l02104"></a>02104         pchan = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#aa41cfc3b1ad9e37309a0bc261b88ca82">get_active_posechannel2</a>(ob);
<a name="l02105"></a>02105         <span class="keywordflow">if</span> (pchan)
<a name="l02106"></a>02106             <span class="keywordflow">return</span> &amp;pchan-&gt;<a class="code" href="../../dd/d41/structbPoseChannel.html#a0374b80987b804af0b60a4930f3b5e0b">constraints</a>;
<a name="l02107"></a>02107     }
<a name="l02108"></a>02108     <span class="keywordflow">else</span> 
<a name="l02109"></a>02109         <span class="keywordflow">return</span> &amp;ob-&gt;<a class="code" href="../../de/de7/structObject.html#a15cd252985e63b0a4b12a07297a7aa8b">constraints</a>;
<a name="l02110"></a>02110 
<a name="l02111"></a>02111     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02112"></a>02112 }
<a name="l02113"></a>02113 
<a name="l02114"></a>02114 
<a name="l02115"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a21d6e0f9dacd359c606af5ccca65ec57">02115</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a21d6e0f9dacd359c606af5ccca65ec57">RBJconstraints</a>(<a class="code" href="../../de/de7/structObject.html">Object</a> *ob)<span class="comment">//not used</span>
<a name="l02116"></a>02116 {
<a name="l02117"></a>02117     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *conlist;
<a name="l02118"></a>02118     <a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *curcon;
<a name="l02119"></a>02119 
<a name="l02120"></a>02120     conlist = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#ac8d0997433be61cf1763dd7f04292945">get_active_constraints2</a>(ob);
<a name="l02121"></a>02121 
<a name="l02122"></a>02122     <span class="keywordflow">if</span> (conlist) {
<a name="l02123"></a>02123         <span class="keywordflow">for</span> (curcon = (<a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *)conlist-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; curcon; curcon=(<a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *)curcon-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a463805fc5e4f3bfb3f0bf92913808c88">next</a>) {
<a name="l02124"></a>02124 
<a name="l02125"></a>02125             printf(<span class="stringliteral">&quot;%i\n&quot;</span>,curcon-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a63187d597452da3bb2bd3b52054167cc">type</a>);
<a name="l02126"></a>02126         }
<a name="l02127"></a>02127 
<a name="l02128"></a>02128 
<a name="l02129"></a>02129     }
<a name="l02130"></a>02130 }
<a name="l02131"></a>02131 
<a name="l02132"></a>02132 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/d95/PHY__IPhysicsEnvironment_8h.html">PHY_IPhysicsEnvironment.h</a>&quot;</span>
<a name="l02133"></a>02133 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/df8/KX__IPhysicsController_8h.html">KX_IPhysicsController.h</a>&quot;</span>
<a name="l02134"></a>02134 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d03/PHY__DynamicTypes_8h.html">PHY_DynamicTypes.h</a>&quot;</span>
<a name="l02135"></a>02135 
<a name="l02136"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af296be4b4fcd9556a339587a95649c88">02136</a> <a class="code" href="../../dd/dfc/classKX__IPhysicsController.html">KX_IPhysicsController</a>* <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af296be4b4fcd9556a339587a95649c88">getPhId</a>(<a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* sumolist,<a class="code" href="../../d6/dce/classSTR__String.html">STR_String</a> busc) {<span class="comment">//not used</span>
<a name="l02137"></a>02137 
<a name="l02138"></a>02138     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();j++)
<a name="l02139"></a>02139     {
<a name="l02140"></a>02140         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobje = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(j);
<a name="l02141"></a>02141         <span class="keywordflow">if</span> (gameobje-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a268fb3bcc390cd18830e91113693eb40">GetName</a>()==busc)
<a name="l02142"></a>02142             <span class="keywordflow">return</span> gameobje-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a8fca8020988a86c8cb72dbeb5d4a8e2f">GetPhysicsController</a>();
<a name="l02143"></a>02143     }
<a name="l02144"></a>02144 
<a name="l02145"></a>02145     <span class="keywordflow">return</span> 0;
<a name="l02146"></a>02146 
<a name="l02147"></a>02147 }
<a name="l02148"></a>02148 
<a name="l02149"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a0555f32e9d8f655d4fab1726ebdfba43">02149</a> <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a0555f32e9d8f655d4fab1726ebdfba43">getGameOb</a>(<a class="code" href="../../d6/dce/classSTR__String.html">STR_String</a> busc,<a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* sumolist)
<a name="l02150"></a>02150 {
<a name="l02151"></a>02151 
<a name="l02152"></a>02152     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();j++)
<a name="l02153"></a>02153     {
<a name="l02154"></a>02154         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobje = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(j);
<a name="l02155"></a>02155         <span class="keywordflow">if</span> (gameobje-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a268fb3bcc390cd18830e91113693eb40">GetName</a>()==busc)
<a name="l02156"></a>02156             <span class="keywordflow">return</span> gameobje;
<a name="l02157"></a>02157     }
<a name="l02158"></a>02158     
<a name="l02159"></a>02159     <span class="keywordflow">return</span> 0;
<a name="l02160"></a>02160 
<a name="l02161"></a>02161 }
<a name="l02162"></a>02162 
<a name="l02163"></a>02163 <span class="comment">/* helper for BL_ConvertBlenderObjects, avoids code duplication</span>
<a name="l02164"></a>02164 <span class="comment"> * note: all var names match args are passed from the caller */</span>
<a name="l02165"></a><a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a1d3476ff25c06912bb546bdd8e8095ae">02165</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a1d3476ff25c06912bb546bdd8e8095ae">bl_ConvertBlenderObject_Single</a>(
<a name="l02166"></a>02166         <a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html">KX_BlenderSceneConverter</a> *converter,
<a name="l02167"></a>02167         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *blenderscene, <a class="code" href="../../de/de7/structObject.html">Object</a> *blenderobject,
<a name="l02168"></a>02168         vector&lt;MT_Vector3&gt; &amp;inivel, vector&lt;MT_Vector3&gt; &amp;iniang,
<a name="l02169"></a>02169         vector&lt;parentChildLink&gt; &amp;vec_parent_child,
<a name="l02170"></a>02170         <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* logicbrick_conversionlist,
<a name="l02171"></a>02171         <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* objectlist, <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* inactivelist, <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>*   sumolist,
<a name="l02172"></a>02172         <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a>* kxscene, <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj,
<a name="l02173"></a>02173         <a class="code" href="../../db/d0f/classSCA__LogicManager.html">SCA_LogicManager</a>* logicmgr, <a class="code" href="../../de/dd3/classSCA__TimeEventManager.html">SCA_TimeEventManager</a>* timemgr,
<a name="l02174"></a>02174         <span class="keywordtype">bool</span> isInActiveLayer
<a name="l02175"></a>02175         )
<a name="l02176"></a>02176 {
<a name="l02177"></a>02177     <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a> posPrev;
<a name="l02178"></a>02178     <a class="code" href="../../dd/d6f/classMT__Matrix3x3.html">MT_Matrix3x3</a> angor;
<a name="l02179"></a>02179     <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>) blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>=blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a97f52582406befb3dba13b121d886526">sfra</a>;
<a name="l02180"></a>02180 
<a name="l02181"></a>02181     <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a> pos(
<a name="l02182"></a>02182         blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a56283253ed00c7461cae7602135fbba9">loc</a>[0]+blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a64775ee54d6d8362df47b69bc7e07873">dloc</a>[0],
<a name="l02183"></a>02183         blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a56283253ed00c7461cae7602135fbba9">loc</a>[1]+blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a64775ee54d6d8362df47b69bc7e07873">dloc</a>[1],
<a name="l02184"></a>02184         blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a56283253ed00c7461cae7602135fbba9">loc</a>[2]+blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a64775ee54d6d8362df47b69bc7e07873">dloc</a>[2]
<a name="l02185"></a>02185     );
<a name="l02186"></a>02186     <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> eulxyz(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a73a4242dd7998a04e9895fc07c749153">rot</a>);
<a name="l02187"></a>02187     <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> scale(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a46e0f5309f8c13d85e16fa6436acf9f8">size</a>);
<a name="l02188"></a>02188     <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>) {<span class="comment">//rcruiz</span>
<a name="l02189"></a>02189         <span class="keywordtype">float</span> eulxyzPrev[3];
<a name="l02190"></a>02190         blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>=blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a97f52582406befb3dba13b121d886526">sfra</a>-1;
<a name="l02191"></a>02191         <span class="comment">//XXX update_for_newframe();</span>
<a name="l02192"></a>02192         <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> tmp=pos-<a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a>(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a56283253ed00c7461cae7602135fbba9">loc</a>[0]+blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a64775ee54d6d8362df47b69bc7e07873">dloc</a>[0],
<a name="l02193"></a>02193                                      blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a56283253ed00c7461cae7602135fbba9">loc</a>[1]+blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a64775ee54d6d8362df47b69bc7e07873">dloc</a>[1],
<a name="l02194"></a>02194                                      blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a56283253ed00c7461cae7602135fbba9">loc</a>[2]+blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a64775ee54d6d8362df47b69bc7e07873">dloc</a>[2]
<a name="l02195"></a>02195                                      );
<a name="l02196"></a>02196         eulxyzPrev[0]=blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a73a4242dd7998a04e9895fc07c749153">rot</a>[0];
<a name="l02197"></a>02197         eulxyzPrev[1]=blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a73a4242dd7998a04e9895fc07c749153">rot</a>[1];
<a name="l02198"></a>02198         eulxyzPrev[2]=blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a73a4242dd7998a04e9895fc07c749153">rot</a>[2];
<a name="l02199"></a>02199 
<a name="l02200"></a>02200         <span class="keywordtype">double</span> fps = (double) blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a071df993e13c05fc37e6f9a82c0679f5">frs_sec</a>/
<a name="l02201"></a>02201                 (<span class="keywordtype">double</span>) blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a11e6b08a8678f04813637f658e867193">frs_sec_base</a>;
<a name="l02202"></a>02202 
<a name="l02203"></a>02203         tmp.<a class="code" href="../../d6/d9d/classMT__Vector3.html#a8333bbbfc5675cdaf0f5c7b19a17a9ad">scale</a>(fps, fps, fps);
<a name="l02204"></a>02204         inivel.push_back(tmp);
<a name="l02205"></a>02205         tmp=eulxyz-eulxyzPrev;
<a name="l02206"></a>02206         tmp.<a class="code" href="../../d6/d9d/classMT__Vector3.html#a8333bbbfc5675cdaf0f5c7b19a17a9ad">scale</a>(fps, fps, fps);
<a name="l02207"></a>02207         iniang.push_back(tmp);
<a name="l02208"></a>02208         blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>=blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a97f52582406befb3dba13b121d886526">sfra</a>;
<a name="l02209"></a>02209         <span class="comment">//XXX update_for_newframe();</span>
<a name="l02210"></a>02210     }
<a name="l02211"></a>02211 
<a name="l02212"></a>02212     gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a22d183aca27dacd2942c7eb428fa0eb7">NodeSetLocalPosition</a>(pos);
<a name="l02213"></a>02213     gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a3832f5baf84b55a2b3d71b98a85ac7b1">NodeSetLocalOrientation</a>(<a class="code" href="../../dd/d6f/classMT__Matrix3x3.html">MT_Matrix3x3</a>(eulxyz));
<a name="l02214"></a>02214     gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#acfffcf209f87bf7bad4a25d0bfcfd2a8">NodeSetLocalScale</a>(scale);
<a name="l02215"></a>02215     gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abd94bbbcf52249812ac7ddd8d61b079c">NodeUpdateGS</a>(0);
<a name="l02216"></a>02216 
<a name="l02217"></a>02217     <a class="code" href="../../d9/d5b/KX__IpoConvert_8cpp.html#a7096868602003ce223dc0c5914c71136">BL_ConvertMaterialIpos</a>(blenderobject, gameobj, converter);
<a name="l02218"></a>02218 
<a name="l02219"></a>02219     sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#ab20ce4d43a9f9aec11731aa4abddb059">Add</a>(gameobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#afbffee1cbf1ba190723f69445a2471ca">AddRef</a>());
<a name="l02220"></a>02220 
<a name="l02221"></a>02221     <a class="code" href="../../df/dd3/KX__ConvertProperties_8cpp.html#a5bdbff9ad74ad073bd58e1934cdc363b">BL_ConvertProperties</a>(blenderobject,gameobj,timemgr,kxscene,isInActiveLayer);
<a name="l02222"></a>02222 
<a name="l02223"></a>02223     gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a43c0693d1745f2b6cbe31d0ef691d3a5">SetName</a>(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2);
<a name="l02224"></a>02224 
<a name="l02225"></a>02225     <span class="comment">// update children/parent hierarchy</span>
<a name="l02226"></a>02226     <span class="keywordflow">if</span> ((blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a> != 0)&amp;&amp;(!converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>))
<a name="l02227"></a>02227     {
<a name="l02228"></a>02228         <span class="comment">// blender has an additional &#39;parentinverse&#39; offset in each object</span>
<a name="l02229"></a>02229         <a class="code" href="../../dc/d81/structSG__Callbacks.html">SG_Callbacks</a> callback(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,<a class="code" href="../../d2/da3/classKX__Scene.html#aef26e3ab36cf9a850f0bed0ae527565a">KX_Scene::KX_ScenegraphUpdateFunc</a>,<a class="code" href="../../d2/da3/classKX__Scene.html#a9c568c2a33dae28e000d6a7ded3b256b">KX_Scene::KX_ScenegraphRescheduleFunc</a>);
<a name="l02230"></a>02230         <a class="code" href="../../d8/d3b/classSG__Node.html">SG_Node</a>* parentinversenode = <span class="keyword">new</span> <a class="code" href="../../d8/d3b/classSG__Node.html">SG_Node</a>(<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,kxscene,callback);
<a name="l02231"></a>02231 
<a name="l02232"></a>02232         <span class="comment">// define a normal parent relationship for this node.</span>
<a name="l02233"></a>02233         <a class="code" href="../../d6/d0a/classKX__NormalParentRelation.html">KX_NormalParentRelation</a> * parent_relation = <a class="code" href="../../d6/d0a/classKX__NormalParentRelation.html#a6e0ee2e5d68fc3d5a2c1589670793ef4">KX_NormalParentRelation::New</a>();
<a name="l02234"></a>02234         parentinversenode-&gt;<a class="code" href="../../d4/d22/classSG__Spatial.html#afd81adaab4e510163b91952ea4777d8e">SetParentRelation</a>(parent_relation);
<a name="l02235"></a>02235 
<a name="l02236"></a>02236         <a class="code" href="../../d1/d4c/structparentChildLink.html">parentChildLink</a> pclink;
<a name="l02237"></a>02237         pclink.<a class="code" href="../../d1/d4c/structparentChildLink.html#ae22f6143b4c523b400be7abd3d00c094">m_blenderchild</a> = blenderobject;
<a name="l02238"></a>02238         pclink.<a class="code" href="../../d1/d4c/structparentChildLink.html#a4ee6b4b63c8ea56da1ffea64a75925e7">m_gamechildnode</a> = parentinversenode;
<a name="l02239"></a>02239         vec_parent_child.push_back(pclink);
<a name="l02240"></a>02240 
<a name="l02241"></a>02241         <span class="keywordtype">float</span>* fl = (<span class="keywordtype">float</span>*) blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a7809bbfa606a220179929cc5cd198a30">parentinv</a>;
<a name="l02242"></a>02242         <a class="code" href="../../d0/df9/classMT__Transform.html">MT_Transform</a> parinvtrans(fl);
<a name="l02243"></a>02243         parentinversenode-&gt;<a class="code" href="../../d4/d22/classSG__Spatial.html#a30d80c0a5ade811c461435a6875aa77f">SetLocalPosition</a>(parinvtrans.getOrigin());
<a name="l02244"></a>02244         <span class="comment">// problem here: the parent inverse transform combines scaling and rotation</span>
<a name="l02245"></a>02245         <span class="comment">// in the basis but the scenegraph needs separate rotation and scaling.</span>
<a name="l02246"></a>02246         <span class="comment">// This is not important for OpenGL (it uses 4x4 matrix) but it is important</span>
<a name="l02247"></a>02247         <span class="comment">// for the physic engine that needs a separate scaling</span>
<a name="l02248"></a>02248         <span class="comment">//parentinversenode-&gt;SetLocalOrientation(parinvtrans.getBasis());</span>
<a name="l02249"></a>02249 
<a name="l02250"></a>02250         <span class="comment">// Extract the rotation and the scaling from the basis</span>
<a name="l02251"></a>02251         <a class="code" href="../../dd/d6f/classMT__Matrix3x3.html">MT_Matrix3x3</a> ori(parinvtrans.getBasis());
<a name="l02252"></a>02252         <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> x(ori.getColumn(0));
<a name="l02253"></a>02253         <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> y(ori.getColumn(1));
<a name="l02254"></a>02254         <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> z(ori.getColumn(2));
<a name="l02255"></a>02255         <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> parscale(x.length(), y.length(), z.length());
<a name="l02256"></a>02256         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/dc4/MT__Scalar_8h.html#a0fb0b5ea82fd8be5d34c447d07f1707f">MT_fuzzyZero</a>(parscale[0]))
<a name="l02257"></a>02257             x /= parscale[0];
<a name="l02258"></a>02258         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/dc4/MT__Scalar_8h.html#a0fb0b5ea82fd8be5d34c447d07f1707f">MT_fuzzyZero</a>(parscale[1]))
<a name="l02259"></a>02259             y /= parscale[1];
<a name="l02260"></a>02260         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/dc4/MT__Scalar_8h.html#a0fb0b5ea82fd8be5d34c447d07f1707f">MT_fuzzyZero</a>(parscale[2]))
<a name="l02261"></a>02261             z /= parscale[2];
<a name="l02262"></a>02262         ori.setColumn(0, x);
<a name="l02263"></a>02263         ori.setColumn(1, y);
<a name="l02264"></a>02264         ori.setColumn(2, z);
<a name="l02265"></a>02265         parentinversenode-&gt;<a class="code" href="../../d4/d22/classSG__Spatial.html#a589c6b5ec03b113430cd912d5bd0fdc1">SetLocalOrientation</a>(ori);
<a name="l02266"></a>02266         parentinversenode-&gt;<a class="code" href="../../d4/d22/classSG__Spatial.html#ae9c53084a510b513b02dfe6f0448f34a">SetLocalScale</a>(parscale);
<a name="l02267"></a>02267 
<a name="l02268"></a>02268         parentinversenode-&gt;<a class="code" href="../../d8/d3b/classSG__Node.html#a2e527abc6716de94e2bc551c69a9ae52">AddChild</a>(gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0be04ac2ce18c262fd28cb92f5c296b7">GetSGNode</a>());
<a name="l02269"></a>02269     }
<a name="l02270"></a>02270 
<a name="l02271"></a>02271     <span class="comment">// needed for python scripting</span>
<a name="l02272"></a>02272     logicmgr-&gt;<a class="code" href="../../db/d0f/classSCA__LogicManager.html#a72ab91832183e3172df57e31c452c7f7">RegisterGameObjectName</a>(gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a268fb3bcc390cd18830e91113693eb40">GetName</a>(),gameobj);
<a name="l02273"></a>02273 
<a name="l02274"></a>02274     <span class="comment">// needed for group duplication</span>
<a name="l02275"></a>02275     logicmgr-&gt;<a class="code" href="../../db/d0f/classSCA__LogicManager.html#a44a09bdf1102c62280858578b8a6cd35">RegisterGameObj</a>(blenderobject, gameobj);
<a name="l02276"></a>02276     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0380469d233ad08592b6a49819db066d">GetMeshCount</a>(); <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)
<a name="l02277"></a>02277         logicmgr-&gt;<a class="code" href="../../db/d0f/classSCA__LogicManager.html#ad4817a28b514a6c3d43e68cf9cedc236">RegisterGameMeshName</a>(gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0a71e1e10264a686d4bce3ec2733fe86">GetMesh</a>(<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d85/classRAS__MeshObject.html#a8e232cc1d6f124cc472f9717f82c2f77">GetName</a>(), blenderobject);
<a name="l02278"></a>02278 
<a name="l02279"></a>02279     converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a5d5d85dfabee42148e05efc86a4c184a">RegisterGameObject</a>(gameobj, blenderobject);
<a name="l02280"></a>02280     <span class="comment">// this was put in rapidly, needs to be looked at more closely</span>
<a name="l02281"></a>02281     <span class="comment">// only draw/use objects in active &#39;blender&#39; layers</span>
<a name="l02282"></a>02282 
<a name="l02283"></a>02283     logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#ab20ce4d43a9f9aec11731aa4abddb059">Add</a>(gameobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#afbffee1cbf1ba190723f69445a2471ca">AddRef</a>());
<a name="l02284"></a>02284 
<a name="l02285"></a>02285     <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>) {
<a name="l02286"></a>02286         posPrev=gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#afa83f00c96f7d08511a385730442019b">NodeGetWorldPosition</a>();
<a name="l02287"></a>02287         angor=gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ac4c31c796993a704c92cbc2d82927cfe">NodeGetWorldOrientation</a>();
<a name="l02288"></a>02288     }
<a name="l02289"></a>02289     <span class="keywordflow">if</span> (isInActiveLayer)
<a name="l02290"></a>02290     {
<a name="l02291"></a>02291         objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#ab20ce4d43a9f9aec11731aa4abddb059">Add</a>(gameobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#afbffee1cbf1ba190723f69445a2471ca">AddRef</a>());
<a name="l02292"></a>02292         <span class="comment">//tf.Add(gameobj-&gt;GetSGNode());</span>
<a name="l02293"></a>02293 
<a name="l02294"></a>02294         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abd94bbbcf52249812ac7ddd8d61b079c">NodeUpdateGS</a>(0);
<a name="l02295"></a>02295         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a1a018532e6f4b42433f05a130d4c2f6a">AddMeshUser</a>();
<a name="l02296"></a>02296 
<a name="l02297"></a>02297     }
<a name="l02298"></a>02298     <span class="keywordflow">else</span>
<a name="l02299"></a>02299     {
<a name="l02300"></a>02300         <span class="comment">//we must store this object otherwise it will be deleted</span>
<a name="l02301"></a>02301         <span class="comment">//at the end of this function if it is not a root object</span>
<a name="l02302"></a>02302         inactivelist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#ab20ce4d43a9f9aec11731aa4abddb059">Add</a>(gameobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#afbffee1cbf1ba190723f69445a2471ca">AddRef</a>());
<a name="l02303"></a>02303     }
<a name="l02304"></a>02304 
<a name="l02305"></a>02305     <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>) {
<a name="l02306"></a>02306         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a22d183aca27dacd2942c7eb428fa0eb7">NodeSetLocalPosition</a>(posPrev);
<a name="l02307"></a>02307         gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a3832f5baf84b55a2b3d71b98a85ac7b1">NodeSetLocalOrientation</a>(angor);
<a name="l02308"></a>02308     }
<a name="l02309"></a>02309 }
<a name="l02310"></a>02310 
<a name="l02311"></a>02311 
<a name="l02312"></a>02312 <span class="comment">// convert blender objects into ketsji gameobjects</span>
<a name="l02313"></a><a class="code" href="../../da/d98/BL__BlenderDataConversion_8h.html#a46121b4f73bf16e523baa121356a347d">02313</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a3702acd81384ba70ef99494c392d3f69">BL_ConvertBlenderObjects</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dc0/structMain.html">Main</a>* maggie,
<a name="l02314"></a>02314                               <a class="code" href="../../d2/da3/classKX__Scene.html">KX_Scene</a>* kxscene,
<a name="l02315"></a>02315                               <a class="code" href="../../db/dcd/classKX__KetsjiEngine.html">KX_KetsjiEngine</a>* ketsjiEngine,
<a name="l02316"></a>02316                               <a class="code" href="../../d3/d98/KX__PhysicsEngineEnums_8h.html#a1d02ecff9c9296faee3bc2488e2d4555">e_PhysicsEngine</a>   physics_engine,
<a name="l02317"></a>02317                               <a class="code" href="../../d0/d53/classRAS__IRenderTools.html">RAS_IRenderTools</a>* rendertools,
<a name="l02318"></a>02318                               <a class="code" href="../../d5/df6/classRAS__ICanvas.html">RAS_ICanvas</a>* canvas,
<a name="l02319"></a>02319                               <a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html">KX_BlenderSceneConverter</a>* converter,
<a name="l02320"></a>02320                               <span class="keywordtype">bool</span> alwaysUseExpandFraming
<a name="l02321"></a>02321                               )
<a name="l02322"></a>02322 {
<a name="l02323"></a>02323 
<a name="l02324"></a>02324 <span class="preprocessor">#define BL_CONVERTBLENDEROBJECT_SINGLE                                 \</span>
<a name="l02325"></a>02325 <span class="preprocessor">    bl_ConvertBlenderObject_Single(converter,                          \</span>
<a name="l02326"></a>02326 <span class="preprocessor">                                   blenderscene, blenderobject,        \</span>
<a name="l02327"></a>02327 <span class="preprocessor">                                   inivel, iniang,                     \</span>
<a name="l02328"></a>02328 <span class="preprocessor">                                   vec_parent_child,                   \</span>
<a name="l02329"></a>02329 <span class="preprocessor">                                   logicbrick_conversionlist,          \</span>
<a name="l02330"></a>02330 <span class="preprocessor">                                   objectlist, inactivelist, sumolist, \</span>
<a name="l02331"></a>02331 <span class="preprocessor">                                   kxscene, gameobj,                   \</span>
<a name="l02332"></a>02332 <span class="preprocessor">                                   logicmgr, timemgr,                  \</span>
<a name="l02333"></a>02333 <span class="preprocessor">                                   isInActiveLayer                     \</span>
<a name="l02334"></a>02334 <span class="preprocessor">                                   )</span>
<a name="l02335"></a>02335 <span class="preprocessor"></span>
<a name="l02336"></a>02336 
<a name="l02337"></a>02337 
<a name="l02338"></a>02338     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *blenderscene = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a217279a18aca964cf8d28d3ad6bdb95d">GetBlenderScene</a>();
<a name="l02339"></a>02339     <span class="comment">// for SETLOOPER</span>
<a name="l02340"></a>02340     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *sce_iter;
<a name="l02341"></a>02341     <a class="code" href="../../d3/da9/structBase.html">Base</a> *base;
<a name="l02342"></a>02342 
<a name="l02343"></a>02343     <span class="comment">// Get the frame settings of the canvas.</span>
<a name="l02344"></a>02344     <span class="comment">// Get the aspect ratio of the canvas as designed by the user.</span>
<a name="l02345"></a>02345 
<a name="l02346"></a>02346     <a class="code" href="../../da/dd4/classRAS__FrameSettings.html#abd1e799f66ad7abdc7fb5f3648aa483d">RAS_FrameSettings::RAS_FrameType</a> frame_type;
<a name="l02347"></a>02347     <span class="keywordtype">int</span> aspect_width;
<a name="l02348"></a>02348     <span class="keywordtype">int</span> aspect_height;
<a name="l02349"></a>02349     vector&lt;MT_Vector3&gt; inivel,iniang;
<a name="l02350"></a>02350     set&lt;Group*&gt; grouplist;  <span class="comment">// list of groups to be converted</span>
<a name="l02351"></a>02351     set&lt;Object*&gt; allblobj;  <span class="comment">// all objects converted</span>
<a name="l02352"></a>02352     set&lt;Object*&gt; groupobj;  <span class="comment">// objects from groups (never in active layer)</span>
<a name="l02353"></a>02353 
<a name="l02354"></a>02354     <span class="keywordflow">if</span> (alwaysUseExpandFraming) {
<a name="l02355"></a>02355         frame_type = <a class="code" href="../../da/dd4/classRAS__FrameSettings.html#abd1e799f66ad7abdc7fb5f3648aa483da16aefbac4524b38ecfc293de8488599c">RAS_FrameSettings::e_frame_extend</a>;
<a name="l02356"></a>02356         aspect_width = canvas-&gt;<a class="code" href="../../d5/df6/classRAS__ICanvas.html#a31a96eaa611c1ebe1068eea19e8be167">GetWidth</a>();
<a name="l02357"></a>02357         aspect_height = canvas-&gt;<a class="code" href="../../d5/df6/classRAS__ICanvas.html#acab2e07126fbf3b45cfa831129b2343a">GetHeight</a>();
<a name="l02358"></a>02358     } <span class="keywordflow">else</span> {
<a name="l02359"></a>02359         <span class="keywordflow">if</span> (blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a455f9432e63ad072096755fd65b00bb0">framing</a>.<a class="code" href="../../d2/d08/structGameFraming.html#a34977b1d08733c52f698196768472f8a">type</a> == <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac9999786bf7378a4a82b2836e906378c">SCE_GAMEFRAMING_BARS</a>) {
<a name="l02360"></a>02360             frame_type = <a class="code" href="../../da/dd4/classRAS__FrameSettings.html#abd1e799f66ad7abdc7fb5f3648aa483dab23b3a655212ea9a83facd0c571b159f">RAS_FrameSettings::e_frame_bars</a>;
<a name="l02361"></a>02361         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a455f9432e63ad072096755fd65b00bb0">framing</a>.<a class="code" href="../../d2/d08/structGameFraming.html#a34977b1d08733c52f698196768472f8a">type</a> == <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#aff638110bf8682658cb8f1b58df1c1f6">SCE_GAMEFRAMING_EXTEND</a>) {
<a name="l02362"></a>02362             frame_type = <a class="code" href="../../da/dd4/classRAS__FrameSettings.html#abd1e799f66ad7abdc7fb5f3648aa483da16aefbac4524b38ecfc293de8488599c">RAS_FrameSettings::e_frame_extend</a>;
<a name="l02363"></a>02363         } <span class="keywordflow">else</span> {
<a name="l02364"></a>02364             frame_type = <a class="code" href="../../da/dd4/classRAS__FrameSettings.html#abd1e799f66ad7abdc7fb5f3648aa483dad7506a5f3f6fca8c0500e965b9f87afd">RAS_FrameSettings::e_frame_scale</a>;
<a name="l02365"></a>02365         }
<a name="l02366"></a>02366         
<a name="l02367"></a>02367         aspect_width  = (int)(blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#afac89783028ff848f111de04e0c29fbe">xsch</a> * blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a7c97c9fb3ae2b02bd4ccb8c76d68811a">xasp</a>);
<a name="l02368"></a>02368         aspect_height = (int)(blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aca3c1ebdf50a6c74730e19e24983217d">ysch</a> * blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a1f4c395a81051abd055a1014e02c9f00">yasp</a>);
<a name="l02369"></a>02369     }
<a name="l02370"></a>02370     
<a name="l02371"></a>02371     <a class="code" href="../../da/dd4/classRAS__FrameSettings.html">RAS_FrameSettings</a> frame_settings(
<a name="l02372"></a>02372         frame_type,
<a name="l02373"></a>02373         blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a455f9432e63ad072096755fd65b00bb0">framing</a>.<a class="code" href="../../d2/d08/structGameFraming.html#a8615a14326b7510d84c4055c66f3db22">col</a>[0],
<a name="l02374"></a>02374         blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a455f9432e63ad072096755fd65b00bb0">framing</a>.<a class="code" href="../../d2/d08/structGameFraming.html#a8615a14326b7510d84c4055c66f3db22">col</a>[1],
<a name="l02375"></a>02375         blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a455f9432e63ad072096755fd65b00bb0">framing</a>.<a class="code" href="../../d2/d08/structGameFraming.html#a8615a14326b7510d84c4055c66f3db22">col</a>[2],
<a name="l02376"></a>02376         aspect_width,
<a name="l02377"></a>02377         aspect_height
<a name="l02378"></a>02378     );
<a name="l02379"></a>02379     kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a5810ccd07fbefd1f8ef739fa67002feb">SetFramingType</a>(frame_settings);
<a name="l02380"></a>02380 
<a name="l02381"></a>02381     kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a7eb6f85118ceb26e60b23f77919c2e71">SetGravity</a>(<a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a>(0,0, -blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a8325142eaa7981729c64e6132dccf4a9">gravity</a>));
<a name="l02382"></a>02382     
<a name="l02383"></a>02383     <span class="comment">/* set activity culling parameters */</span>
<a name="l02384"></a>02384     kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#acdf44444b61f12b5d1b3af56b0c25e02">SetActivityCulling</a>( (blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#abb0b4ef8392647aaeab643b9e4164673">mode</a> &amp; <a class="code" href="../../d7/d3b/DNA__world__types_8h.html#a3ddcd523f543408b0a2d3d84a728a825">WO_ACTIVITY_CULLING</a>) != 0);
<a name="l02385"></a>02385     kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a51d7618248cce477183bb6c5217e81bd">SetActivityCullingRadius</a>(blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a3fe26d7981cead81df57bc700b08133b">activityBoxRadius</a>);
<a name="l02386"></a>02386     kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a3dbeb8653b05d750f820cc8d3af231b6">SetDbvtCulling</a>((blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#abb0b4ef8392647aaeab643b9e4164673">mode</a> &amp; <a class="code" href="../../d7/d3b/DNA__world__types_8h.html#a70627b3eb11e0243d1b14fe206bef808">WO_DBVT_CULLING</a>) != 0);
<a name="l02387"></a>02387     
<a name="l02388"></a>02388     <span class="comment">// no occlusion culling by default</span>
<a name="l02389"></a>02389     kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#aad9075ee06fa3f8bd4642a696895745e">SetDbvtOcclusionRes</a>(0);
<a name="l02390"></a>02390 
<a name="l02391"></a>02391     <span class="keywordtype">int</span> activeLayerBitInfo = blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a506dd867fc58506c37c1e56f6b134056">lay</a>;
<a name="l02392"></a>02392     
<a name="l02393"></a>02393     <span class="comment">// list of all object converted, active and inactive</span>
<a name="l02394"></a>02394     <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* sumolist = <span class="keyword">new</span> <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>();
<a name="l02395"></a>02395     
<a name="l02396"></a>02396     vector&lt;parentChildLink&gt; vec_parent_child;
<a name="l02397"></a>02397     
<a name="l02398"></a>02398     <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* objectlist = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a82b767d5115895ec258c43d353b75ff5">GetObjectList</a>();
<a name="l02399"></a>02399     <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* inactivelist = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#adb5a23c8d6be0524def1e704be87a251">GetInactiveList</a>();
<a name="l02400"></a>02400     <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* parentlist = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#ac0b0e3bb47162d2022402d0126f0f9ba">GetRootParentList</a>();
<a name="l02401"></a>02401     
<a name="l02402"></a>02402     <a class="code" href="../../db/d0f/classSCA__LogicManager.html">SCA_LogicManager</a>* logicmgr = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#ad9270d324274b162133dd9a02f9bca58">GetLogicManager</a>();
<a name="l02403"></a>02403     <a class="code" href="../../de/dd3/classSCA__TimeEventManager.html">SCA_TimeEventManager</a>* timemgr = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a3571af4237b258a335342f6d6ece5bdb">GetTimeEventManager</a>();
<a name="l02404"></a>02404     
<a name="l02405"></a>02405     <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* logicbrick_conversionlist = <span class="keyword">new</span> <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>();
<a name="l02406"></a>02406     
<a name="l02407"></a>02407     <span class="comment">//SG_TreeFactory tf;</span>
<a name="l02408"></a>02408     
<a name="l02409"></a>02409     <span class="comment">// Convert actions to actionmap</span>
<a name="l02410"></a>02410     <a class="code" href="../../d1/d48/structbAction.html">bAction</a> *curAct;
<a name="l02411"></a>02411     <span class="keywordflow">for</span> (curAct = (<a class="code" href="../../d1/d48/structbAction.html">bAction</a>*)maggie-&gt;<a class="code" href="../../d0/dc0/structMain.html#a672d2abaa0d861f3a2d938549cbe212b">action</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; curAct; curAct=(<a class="code" href="../../d1/d48/structbAction.html">bAction</a>*)curAct-&gt;<a class="code" href="../../d1/d48/structbAction.html#ad0f2d8efde1fdd4f81ee9fe471313bd6">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>)
<a name="l02412"></a>02412     {
<a name="l02413"></a>02413         logicmgr-&gt;<a class="code" href="../../db/d0f/classSCA__LogicManager.html#a6ecb5dc48bbeaa0c35c5f7a77cefdba8">RegisterActionName</a>(curAct-&gt;<a class="code" href="../../d1/d48/structbAction.html#ad0f2d8efde1fdd4f81ee9fe471313bd6">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a> + 2, curAct);
<a name="l02414"></a>02414     }
<a name="l02415"></a>02415 
<a name="l02416"></a>02416     <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#af75ad81281718b1f2f9332135354b0bf">SetDefaultLightMode</a>(blenderscene);
<a name="l02417"></a>02417     <span class="comment">// Let&#39;s support scene set.</span>
<a name="l02418"></a>02418     <span class="comment">// Beware of name conflict in linked data, it will not crash but will create confusion</span>
<a name="l02419"></a>02419     <span class="comment">// in Python scripting and in certain actuators (replace mesh). Linked scene *should* have</span>
<a name="l02420"></a>02420     <span class="comment">// no conflicting name for Object, Object data and Action.</span>
<a name="l02421"></a>02421     <span class="keywordflow">for</span> (<a class="code" href="../../d8/d53/BKE__scene_8h.html#a2ea2c0ff1c9b5bb29c3add65bbaadf2d">SETLOOPER</a>(blenderscene, sce_iter, base))
<a name="l02422"></a>02422     {
<a name="l02423"></a>02423         <a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>;
<a name="l02424"></a>02424         allblobj.insert(blenderobject);
<a name="l02425"></a>02425 
<a name="l02426"></a>02426         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a2826e1ca8364658f2aa80b11d830db41">gameobject_from_blenderobject</a>(
<a name="l02427"></a>02427                                         base-&gt;<a class="code" href="../../d3/da9/structBase.html#a74bed66e64803246e406c1ed2dd7f1ab">object</a>, 
<a name="l02428"></a>02428                                         kxscene, 
<a name="l02429"></a>02429                                         rendertools, 
<a name="l02430"></a>02430                                         converter);
<a name="l02431"></a>02431                                         
<a name="l02432"></a>02432         <span class="keywordtype">bool</span> isInActiveLayer = (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a> &amp; activeLayerBitInfo) !=0;
<a name="l02433"></a>02433         <span class="keywordtype">bool</span> addobj=<span class="keyword">true</span>;
<a name="l02434"></a>02434         
<a name="l02435"></a>02435         <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>)
<a name="l02436"></a>02436             <span class="keywordflow">if</span> (!isInActiveLayer)
<a name="l02437"></a>02437                 addobj=<span class="keyword">false</span>;
<a name="l02438"></a>02438 
<a name="l02439"></a>02439         <span class="keywordflow">if</span> (gameobj)
<a name="l02440"></a>02440         {
<a name="l02441"></a>02441             <span class="keywordflow">if</span> (addobj)
<a name="l02442"></a>02442             {   <span class="comment">/* macro calls object conversion funcs */</span>
<a name="l02443"></a>02443                 <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a56e0ec43154210565128c5b1a46141d6">BL_CONVERTBLENDEROBJECT_SINGLE</a>;
<a name="l02444"></a>02444 
<a name="l02445"></a>02445                 <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a264ac7c60a972b2afe766e1e847135f8">IsDupliGroup</a>()) {
<a name="l02446"></a>02446                     grouplist.insert(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a3f0daef111a437533e48f6209429b49f">dup_group</a>);
<a name="l02447"></a>02447                 }
<a name="l02448"></a>02448             }
<a name="l02449"></a>02449 
<a name="l02450"></a>02450             <span class="comment">/* Note about memory leak issues:</span>
<a name="l02451"></a>02451 <span class="comment">             * When a CValue derived class is created, m_refcount is initialized to 1</span>
<a name="l02452"></a>02452 <span class="comment">             * so the class must be released after being used to make sure that it won&#39;t</span>
<a name="l02453"></a>02453 <span class="comment">             * hang in memory. If the object needs to be stored for a long time,</span>
<a name="l02454"></a>02454 <span class="comment">             * use AddRef() so that this Release() does not free the object.</span>
<a name="l02455"></a>02455 <span class="comment">             * Make sure that for any AddRef() there is a Release()!!!!</span>
<a name="l02456"></a>02456 <span class="comment">             * Do the same for any object derived from CValue, CExpression and NG_NetworkMessage</span>
<a name="l02457"></a>02457 <span class="comment">             */</span>
<a name="l02458"></a>02458             gameobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#ad20cd92d44698a94dd8137fca86d85e3">Release</a>();
<a name="l02459"></a>02459         }
<a name="l02460"></a>02460     }
<a name="l02461"></a>02461 
<a name="l02462"></a>02462     <span class="keywordflow">if</span> (!grouplist.empty())
<a name="l02463"></a>02463     {
<a name="l02464"></a>02464         <span class="comment">// now convert the group referenced by dupli group object</span>
<a name="l02465"></a>02465         <span class="comment">// keep track of all groups already converted</span>
<a name="l02466"></a>02466         set&lt;Group*&gt; allgrouplist = grouplist;
<a name="l02467"></a>02467         set&lt;Group*&gt; tempglist;
<a name="l02468"></a>02468         <span class="comment">// recurse</span>
<a name="l02469"></a>02469         <span class="keywordflow">while</span> (!grouplist.empty())
<a name="l02470"></a>02470         {
<a name="l02471"></a>02471             set&lt;Group*&gt;::iterator git;
<a name="l02472"></a>02472             tempglist.clear();
<a name="l02473"></a>02473             tempglist.swap(grouplist);
<a name="l02474"></a>02474             <span class="keywordflow">for</span> (git=tempglist.begin(); git!=tempglist.end(); git++)
<a name="l02475"></a>02475             {
<a name="l02476"></a>02476                 <a class="code" href="../../d4/d91/structGroup.html">Group</a>* group = *git;
<a name="l02477"></a>02477                 <a class="code" href="../../d3/d3b/structGroupObject.html">GroupObject</a>* go;
<a name="l02478"></a>02478                 <span class="keywordflow">for</span> (go=(<a class="code" href="../../d3/d3b/structGroupObject.html">GroupObject</a>*)group-&gt;<a class="code" href="../../d4/d91/structGroup.html#ad757bf69b6fd15b1d4e0980089d13be1">gobject</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; go; go=(<a class="code" href="../../d3/d3b/structGroupObject.html">GroupObject</a>*)go-&gt;<a class="code" href="../../d3/d3b/structGroupObject.html#a81e7437ba90ec95c5fbb96e17e6a203d">next</a>)
<a name="l02479"></a>02479                 {
<a name="l02480"></a>02480                     <a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = go-&gt;<a class="code" href="../../d3/d3b/structGroupObject.html#aeafe134dbf1980f42045d1fc191f2967">ob</a>;
<a name="l02481"></a>02481                     <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aeaf9dc2ae10c77bc743a3290e0b807a8">FindGameObject</a>(blenderobject) == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02482"></a>02482                     {
<a name="l02483"></a>02483                         allblobj.insert(blenderobject);
<a name="l02484"></a>02484                         groupobj.insert(blenderobject);
<a name="l02485"></a>02485                         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a2826e1ca8364658f2aa80b11d830db41">gameobject_from_blenderobject</a>(
<a name="l02486"></a>02486                                                         blenderobject, 
<a name="l02487"></a>02487                                                         kxscene, 
<a name="l02488"></a>02488                                                         rendertools, 
<a name="l02489"></a>02489                                                         converter);
<a name="l02490"></a>02490                                         
<a name="l02491"></a>02491                         <span class="comment">// this code is copied from above except that</span>
<a name="l02492"></a>02492                         <span class="comment">// object from groups are never in active layer</span>
<a name="l02493"></a>02493                         <span class="keywordtype">bool</span> isInActiveLayer = <span class="keyword">false</span>;
<a name="l02494"></a>02494                         <span class="keywordtype">bool</span> addobj=<span class="keyword">true</span>;
<a name="l02495"></a>02495                         
<a name="l02496"></a>02496                         <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>)
<a name="l02497"></a>02497                             <span class="keywordflow">if</span> (!isInActiveLayer)
<a name="l02498"></a>02498                                 addobj=<span class="keyword">false</span>;
<a name="l02499"></a>02499 
<a name="l02500"></a>02500                         <span class="keywordflow">if</span> (gameobj)
<a name="l02501"></a>02501                         {
<a name="l02502"></a>02502                             <span class="keywordflow">if</span> (addobj)
<a name="l02503"></a>02503                             {   <span class="comment">/* macro calls object conversion funcs */</span>
<a name="l02504"></a>02504                                 <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a56e0ec43154210565128c5b1a46141d6">BL_CONVERTBLENDEROBJECT_SINGLE</a>;
<a name="l02505"></a>02505                             }
<a name="l02506"></a>02506 
<a name="l02507"></a>02507                             <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a264ac7c60a972b2afe766e1e847135f8">IsDupliGroup</a>())
<a name="l02508"></a>02508                             {
<a name="l02509"></a>02509                                 <span class="keywordflow">if</span> (allgrouplist.insert(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a3f0daef111a437533e48f6209429b49f">dup_group</a>).second)
<a name="l02510"></a>02510                                 {
<a name="l02511"></a>02511                                     grouplist.insert(blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a3f0daef111a437533e48f6209429b49f">dup_group</a>);
<a name="l02512"></a>02512                                 }
<a name="l02513"></a>02513                             }
<a name="l02514"></a>02514 
<a name="l02515"></a>02515 
<a name="l02516"></a>02516                             <span class="comment">/* see comment above re: mem leaks */</span>
<a name="l02517"></a>02517                             gameobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#ad20cd92d44698a94dd8137fca86d85e3">Release</a>();
<a name="l02518"></a>02518                         }
<a name="l02519"></a>02519                     }
<a name="l02520"></a>02520                 }
<a name="l02521"></a>02521             }
<a name="l02522"></a>02522         }
<a name="l02523"></a>02523     }
<a name="l02524"></a>02524 
<a name="l02525"></a>02525     <span class="comment">// non-camera objects not supported as camera currently</span>
<a name="l02526"></a>02526     <span class="keywordflow">if</span> (blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad050647276d4d850d127173450933107">camera</a> &amp;&amp; blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad050647276d4d850d127173450933107">camera</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#afd7fa4376c670f245aeed7a7116c7005">OB_CAMERA</a>) {
<a name="l02527"></a>02527         <a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a> *gamecamera= (<a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a>*) converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aeaf9dc2ae10c77bc743a3290e0b807a8">FindGameObject</a>(blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#ad050647276d4d850d127173450933107">camera</a>);
<a name="l02528"></a>02528         
<a name="l02529"></a>02529         <span class="keywordflow">if</span> (gamecamera)
<a name="l02530"></a>02530             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a301c93aa375258c3b8972a5405d2cd9d">SetActiveCamera</a>(gamecamera);
<a name="l02531"></a>02531     }
<a name="l02532"></a>02532 
<a name="l02533"></a>02533     <span class="comment">//  Set up armatures</span>
<a name="l02534"></a>02534     set&lt;Object*&gt;::iterator oit;
<a name="l02535"></a>02535     <span class="keywordflow">for</span> (oit=allblobj.begin(); oit!=allblobj.end(); oit++)
<a name="l02536"></a>02536     {
<a name="l02537"></a>02537         <a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobj = *oit;
<a name="l02538"></a>02538         <span class="keywordflow">if</span> (blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>) {
<a name="l02539"></a>02539             <a class="code" href="../../da/d29/structMesh.html">Mesh</a> *me = (<a class="code" href="../../da/d29/structMesh.html">Mesh</a>*)blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l02540"></a>02540     
<a name="l02541"></a>02541             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (me-&gt;<a class="code" href="../../da/d29/structMesh.html#a5d3c41c9b430b3ed6e0454a85fea68de">dvert</a>) {
<a name="l02542"></a>02542                 <a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a> *obj = (<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html">BL_DeformableGameObject</a>*)converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aeaf9dc2ae10c77bc743a3290e0b807a8">FindGameObject</a>(blenderobj);
<a name="l02543"></a>02543 
<a name="l02544"></a>02544                 <span class="keywordflow">if</span> (obj &amp;&amp; <a class="code" href="../../d8/dbf/classBL__ModifierDeformer.html#a4347aece15d3c85492d0a8736386e111">BL_ModifierDeformer::HasArmatureDeformer</a>(blenderobj) &amp;&amp; blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a> &amp;&amp; blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a17c162dffb7fd4f0acb11d051374609b">OB_ARMATURE</a>) {
<a name="l02545"></a>02545                     <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a> *par = converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aeaf9dc2ae10c77bc743a3290e0b807a8">FindGameObject</a>(blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>);
<a name="l02546"></a>02546                     <span class="keywordflow">if</span> (par &amp;&amp; obj-&gt;<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html#abdf9c8fe6e65a0b967e002b42edd6b32">GetDeformer</a>())
<a name="l02547"></a>02547                         ((<a class="code" href="../../d2/d80/classBL__SkinDeformer.html">BL_SkinDeformer</a>*)obj-&gt;<a class="code" href="../../d2/d95/classBL__DeformableGameObject.html#abdf9c8fe6e65a0b967e002b42edd6b32">GetDeformer</a>())-&gt;SetArmature((<a class="code" href="../../d7/d42/classBL__ArmatureObject.html">BL_ArmatureObject</a>*) par);
<a name="l02548"></a>02548                 }
<a name="l02549"></a>02549             }
<a name="l02550"></a>02550         }
<a name="l02551"></a>02551     }
<a name="l02552"></a>02552     
<a name="l02553"></a>02553     <span class="comment">// create hierarchy information</span>
<a name="l02554"></a>02554     <span class="keywordtype">int</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l02555"></a>02555     vector&lt;parentChildLink&gt;::iterator pcit;
<a name="l02556"></a>02556     
<a name="l02557"></a>02557     <span class="keywordflow">for</span> (pcit = vec_parent_child.begin();!(pcit==vec_parent_child.end());++pcit)
<a name="l02558"></a>02558     {
<a name="l02559"></a>02559     
<a name="l02560"></a>02560         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderchild = pcit-&gt;m_blenderchild;
<a name="l02561"></a>02561         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderparent = blenderchild-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>;
<a name="l02562"></a>02562         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* parentobj = converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aeaf9dc2ae10c77bc743a3290e0b807a8">FindGameObject</a>(blenderparent);
<a name="l02563"></a>02563         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* childobj = converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aeaf9dc2ae10c77bc743a3290e0b807a8">FindGameObject</a>(blenderchild);
<a name="l02564"></a>02564 
<a name="l02565"></a>02565         <a class="code" href="../../d5/d8e/Value_8h.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(childobj);
<a name="l02566"></a>02566 
<a name="l02567"></a>02567         <span class="keywordflow">if</span> (!parentobj || objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#a42ec90a1f7c5e78b8262b948a1c823d1">SearchValue</a>(childobj) != objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#a42ec90a1f7c5e78b8262b948a1c823d1">SearchValue</a>(parentobj))
<a name="l02568"></a>02568         {
<a name="l02569"></a>02569             <span class="comment">// special case: the parent and child object are not in the same layer. </span>
<a name="l02570"></a>02570             <span class="comment">// This weird situation is used in Apricot for test purposes.</span>
<a name="l02571"></a>02571             <span class="comment">// Resolve it by not converting the child</span>
<a name="l02572"></a>02572             childobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0be04ac2ce18c262fd28cb92f5c296b7">GetSGNode</a>()-&gt;<a class="code" href="../../d8/d3b/classSG__Node.html#a8090fb062d17a47fa1d4e320332ea2b4">DisconnectFromParent</a>();
<a name="l02573"></a>02573             <span class="keyword">delete</span> pcit-&gt;m_gamechildnode;
<a name="l02574"></a>02574             <span class="comment">// Now destroy the child object but also all its descendent that may already be linked</span>
<a name="l02575"></a>02575             <span class="comment">// Remove the child reference in the local list!</span>
<a name="l02576"></a>02576             <span class="comment">// Note: there may be descendents already if the children of the child were processed</span>
<a name="l02577"></a>02577             <span class="comment">//       by this loop before the child. In that case, we must remove the children also</span>
<a name="l02578"></a>02578             <a class="code" href="../../d6/de7/classCListValue.html">CListValue</a>* childrenlist = childobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ab59f0870740e13bfc776c236d48e5cf0">GetChildrenRecursive</a>();
<a name="l02579"></a>02579             childrenlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#ab20ce4d43a9f9aec11731aa4abddb059">Add</a>(childobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#afbffee1cbf1ba190723f69445a2471ca">AddRef</a>());
<a name="l02580"></a>02580             <span class="keywordflow">for</span> ( i=0;i&lt;childrenlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02581"></a>02581             {
<a name="l02582"></a>02582                 <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* obj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(childrenlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02583"></a>02583                 <span class="keywordflow">if</span> (sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#a18acf9a41b6ed927d931143806bd1852">RemoveValue</a>(obj))
<a name="l02584"></a>02584                     obj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#ad20cd92d44698a94dd8137fca86d85e3">Release</a>();
<a name="l02585"></a>02585                 <span class="keywordflow">if</span> (logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#a18acf9a41b6ed927d931143806bd1852">RemoveValue</a>(obj))
<a name="l02586"></a>02586                     obj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#ad20cd92d44698a94dd8137fca86d85e3">Release</a>();
<a name="l02587"></a>02587             }
<a name="l02588"></a>02588             childrenlist-&gt;<a class="code" href="../../d7/d9c/classCValue.html#ad20cd92d44698a94dd8137fca86d85e3">Release</a>();
<a name="l02589"></a>02589             
<a name="l02590"></a>02590             <span class="comment">// now destroy recursively</span>
<a name="l02591"></a>02591             converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#a9df0abe9021caa8548159afaebd2e99f">UnregisterGameObject</a>(childobj); <span class="comment">// removing objects during conversion make sure this runs too</span>
<a name="l02592"></a>02592             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#af875d0f33688aaa8cea374d9a96dbcbe">RemoveObject</a>(childobj);
<a name="l02593"></a>02593             
<a name="l02594"></a>02594             <span class="keywordflow">continue</span>;
<a name="l02595"></a>02595         }
<a name="l02596"></a>02596 
<a name="l02597"></a>02597         <span class="keywordflow">switch</span> (blenderchild-&gt;<a class="code" href="../../de/de7/structObject.html#a0ed2df4a386ce2b22084aaaa701d73ff">partype</a>)
<a name="l02598"></a>02598         {
<a name="l02599"></a>02599             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ab5e0afc22712baa43c3b6323b1bcc87d">PARVERT1</a>:
<a name="l02600"></a>02600             {
<a name="l02601"></a>02601                 <span class="comment">// creat a new vertex parent relationship for this node.</span>
<a name="l02602"></a>02602                 <a class="code" href="../../de/dc8/classKX__VertexParentRelation.html">KX_VertexParentRelation</a> * vertex_parent_relation = <a class="code" href="../../de/dc8/classKX__VertexParentRelation.html#ad7ced50464c50c6362b427e702c15f73">KX_VertexParentRelation::New</a>();
<a name="l02603"></a>02603                 pcit-&gt;m_gamechildnode-&gt;SetParentRelation(vertex_parent_relation);
<a name="l02604"></a>02604                 <span class="keywordflow">break</span>;
<a name="l02605"></a>02605             }
<a name="l02606"></a>02606             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a470d967e3dbbe659e0e9c52f630fe7de">PARSLOW</a>:
<a name="l02607"></a>02607             {
<a name="l02608"></a>02608                 <span class="comment">// creat a new slow parent relationship for this node.</span>
<a name="l02609"></a>02609                 <a class="code" href="../../de/db2/classKX__SlowParentRelation.html">KX_SlowParentRelation</a> * slow_parent_relation = <a class="code" href="../../de/db2/classKX__SlowParentRelation.html#a77e999b1c72bf4ee1497b08be23c4ad6">KX_SlowParentRelation::New</a>(blenderchild-&gt;<a class="code" href="../../de/de7/structObject.html#a5ef43875b28f238f6f78484e47881f99">sf</a>);
<a name="l02610"></a>02610                 pcit-&gt;m_gamechildnode-&gt;SetParentRelation(slow_parent_relation);
<a name="l02611"></a>02611                 <span class="keywordflow">break</span>;
<a name="l02612"></a>02612             }   
<a name="l02613"></a>02613             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#aa660de9e3216076e99f66fac72274ea0">PARBONE</a>:
<a name="l02614"></a>02614             {
<a name="l02615"></a>02615                 <span class="comment">// parent this to a bone</span>
<a name="l02616"></a>02616                 <a class="code" href="../../de/de0/structBone.html">Bone</a> *parent_bone = <a class="code" href="../../da/d17/BKE__armature_8h.html#aa555e0c2fb76b7edbcbd5fc8344b993a">get_named_bone</a>( (<a class="code" href="../../d9/d9f/structbArmature.html">bArmature</a> *)(blenderchild-&gt;<a class="code" href="../../de/de7/structObject.html#acefcc0d10011d68526b827509403b951">parent</a>)-&gt;data, blenderchild-&gt;<a class="code" href="../../de/de7/structObject.html#af977a5a5856a9eb1938a006b90484524">parsubstr</a>);
<a name="l02617"></a>02617 
<a name="l02618"></a>02618                 <span class="keywordflow">if</span> (parent_bone) {
<a name="l02619"></a>02619                     <a class="code" href="../../dc/d68/classKX__BoneParentRelation.html">KX_BoneParentRelation</a> *bone_parent_relation = <a class="code" href="../../dc/d68/classKX__BoneParentRelation.html#a0e45bb684b223f45ed312d36fcafe8c2">KX_BoneParentRelation::New</a>(parent_bone);
<a name="l02620"></a>02620                     pcit-&gt;m_gamechildnode-&gt;SetParentRelation(bone_parent_relation);
<a name="l02621"></a>02621                 }
<a name="l02622"></a>02622             
<a name="l02623"></a>02623                 <span class="keywordflow">break</span>;
<a name="l02624"></a>02624             }
<a name="l02625"></a>02625             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#af88b95b0ce3123f10e88d858cbb50f05">PARSKEL</a>: <span class="comment">// skinned - ignore</span>
<a name="l02626"></a>02626                 <span class="keywordflow">break</span>;
<a name="l02627"></a>02627             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#accc5a1256f709e67b3448b2eb695bd8a">PAROBJECT</a>:
<a name="l02628"></a>02628             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a0d6cab54d20290ca6a45c4940da96745">PARCURVE</a>:
<a name="l02629"></a>02629             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a19099e8f9e5fb348a9a66c7ea54163c8">PARKEY</a>:
<a name="l02630"></a>02630             <span class="keywordflow">case</span> <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a3744a723cccf1a08793e8f25603417c3">PARVERT3</a>:
<a name="l02631"></a>02631             <span class="keywordflow">default</span>:
<a name="l02632"></a>02632                 <span class="comment">// unhandled</span>
<a name="l02633"></a>02633                 <span class="keywordflow">break</span>;
<a name="l02634"></a>02634         }
<a name="l02635"></a>02635     
<a name="l02636"></a>02636         parentobj-&gt; GetSGNode()-&gt;AddChild(pcit-&gt;m_gamechildnode);
<a name="l02637"></a>02637     }
<a name="l02638"></a>02638     vec_parent_child.clear();
<a name="l02639"></a>02639     
<a name="l02640"></a>02640     <span class="comment">// find &#39;root&#39; parents (object that has not parents in SceneGraph)</span>
<a name="l02641"></a>02641     <span class="keywordflow">for</span> (i=0;i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l02642"></a>02642     {
<a name="l02643"></a>02643         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02644"></a>02644         <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0be04ac2ce18c262fd28cb92f5c296b7">GetSGNode</a>()-&gt;<a class="code" href="../../d8/d3b/classSG__Node.html#add82f06cd8b0d43db35de702d50b9833">GetSGParent</a>() == 0)
<a name="l02645"></a>02645         {
<a name="l02646"></a>02646             parentlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#ab20ce4d43a9f9aec11731aa4abddb059">Add</a>(gameobj-&gt;<a class="code" href="../../d7/d9c/classCValue.html#afbffee1cbf1ba190723f69445a2471ca">AddRef</a>());
<a name="l02647"></a>02647             gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abd94bbbcf52249812ac7ddd8d61b079c">NodeUpdateGS</a>(0);
<a name="l02648"></a>02648         }
<a name="l02649"></a>02649     }
<a name="l02650"></a>02650 
<a name="l02651"></a>02651     <span class="comment">// create graphic controller for culling</span>
<a name="l02652"></a>02652     <span class="keywordflow">if</span> (kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#ab894ee493a52dd6842c95fa26510bd1b">GetDbvtCulling</a>())
<a name="l02653"></a>02653     {
<a name="l02654"></a>02654         <span class="keywordtype">bool</span> occlusion = <span class="keyword">false</span>;
<a name="l02655"></a>02655         <span class="keywordflow">for</span> (i=0; i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02656"></a>02656         {
<a name="l02657"></a>02657             <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02658"></a>02658             <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0380469d233ad08592b6a49819db066d">GetMeshCount</a>() &gt; 0) 
<a name="l02659"></a>02659             {
<a name="l02660"></a>02660                 <a class="code" href="../../d0/d9e/classMT__Point3.html">MT_Point3</a> box[2];
<a name="l02661"></a>02661                 gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0be04ac2ce18c262fd28cb92f5c296b7">GetSGNode</a>()-&gt;<a class="code" href="../../d4/d22/classSG__Spatial.html#a17f93f8a07655d9ec109426327a60ef5">BBox</a>().<a class="code" href="../../d8/db0/classSG__BBox.html#a69e119b25487391e9d3b35767fa4c006">getmm</a>(box, <a class="code" href="../../d0/df9/classMT__Transform.html#a4f04b2e1f5b6bc15f75cc3430644324e">MT_Transform::Identity</a>());
<a name="l02662"></a>02662                 <span class="comment">// box[0] is the min, box[1] is the max</span>
<a name="l02663"></a>02663                 <span class="keywordtype">bool</span> isactive = objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#a42ec90a1f7c5e78b8262b948a1c823d1">SearchValue</a>(gameobj);
<a name="l02664"></a>02664                 <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a8b45221b418440b6287374e399a9a8c5">BL_CreateGraphicObjectNew</a>(gameobj,box[0],box[1],kxscene,isactive,physics_engine);
<a name="l02665"></a>02665                 <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a8c48dca6970f5f0c4cba254bbc40e256">GetOccluder</a>())
<a name="l02666"></a>02666                     occlusion = <span class="keyword">true</span>;
<a name="l02667"></a>02667             }
<a name="l02668"></a>02668         }
<a name="l02669"></a>02669         <span class="keywordflow">if</span> (occlusion)
<a name="l02670"></a>02670             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#aad9075ee06fa3f8bd4642a696895745e">SetDbvtOcclusionRes</a>(blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#ac819ad31ba0039ce7494c9aacdd05fc7">occlusionRes</a>);
<a name="l02671"></a>02671     }
<a name="l02672"></a>02672     <span class="keywordflow">if</span> (blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aefac18ed3d1ded63b012f79a3ca8ddb2">world</a>)
<a name="l02673"></a>02673         kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#aaf97974cb1ee9b3e9af6ba4ce7fac839" title="setNumTimeSubSteps set the number of divisions of the timestep. Tradeoff quality versus performance...">setNumTimeSubSteps</a>(blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#a966786bdf5ea4102e08aeeec6fcc65ab">gm</a>.<a class="code" href="../../d4/d6e/structGameData.html#a68cf2f350be387f179d3c408eb84f25d">physubstep</a>);
<a name="l02674"></a>02674 
<a name="l02675"></a>02675     <span class="comment">// now that the scenegraph is complete, let&#39;s instantiate the deformers.</span>
<a name="l02676"></a>02676     <span class="comment">// We need that to create reusable derived mesh and physic shapes</span>
<a name="l02677"></a>02677     <span class="keywordflow">for</span> (i=0;i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l02678"></a>02678     {
<a name="l02679"></a>02679         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02680"></a>02680         <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abb4098bf9868e54fc875379eb10009f7">GetDeformer</a>())
<a name="l02681"></a>02681             gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#abb4098bf9868e54fc875379eb10009f7">GetDeformer</a>()-&gt;<a class="code" href="../../d7/dc3/classRAS__Deformer.html#a7dca1ebab0f403f5406c8c58676b0211">UpdateBuckets</a>();
<a name="l02682"></a>02682     }
<a name="l02683"></a>02683 
<a name="l02684"></a>02684     <span class="comment">// Set up armature constraints</span>
<a name="l02685"></a>02685     <span class="keywordflow">for</span> (i=0;i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();++<a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)
<a name="l02686"></a>02686     {
<a name="l02687"></a>02687         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02688"></a>02688         <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../da/d68/classSCA__IObject.html#a6093176c1389ff66df406c225ee0bcaf">GetGameObjectType</a>() == <a class="code" href="../../da/d68/classSCA__IObject.html#a1f0f06b1ee29284cbef58072f8f2671ba8477bd4faa124e9f3280aa92537e00ec">SCA_IObject::OBJ_ARMATURE</a>)
<a name="l02689"></a>02689             ((<a class="code" href="../../d7/d42/classBL__ArmatureObject.html">BL_ArmatureObject</a>*)gameobj)-&gt;LoadConstraints(converter);
<a name="l02690"></a>02690     }
<a name="l02691"></a>02691 
<a name="l02692"></a>02692     <span class="keywordtype">bool</span> processCompoundChildren = <span class="keyword">false</span>;
<a name="l02693"></a>02693 
<a name="l02694"></a>02694     <span class="comment">// create physics information</span>
<a name="l02695"></a>02695     <span class="keywordflow">for</span> (i=0;i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02696"></a>02696     {
<a name="l02697"></a>02697         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02698"></a>02698         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02699"></a>02699         <span class="keywordtype">int</span> nummeshes = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0380469d233ad08592b6a49819db066d">GetMeshCount</a>();
<a name="l02700"></a>02700         <a class="code" href="../../d5/d85/classRAS__MeshObject.html">RAS_MeshObject</a>* meshobj = 0;
<a name="l02701"></a>02701         <span class="keywordflow">if</span> (nummeshes &gt; 0)
<a name="l02702"></a>02702         {
<a name="l02703"></a>02703             meshobj = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0a71e1e10264a686d4bce3ec2733fe86">GetMesh</a>(0);
<a name="l02704"></a>02704         }
<a name="l02705"></a>02705         <span class="keywordtype">int</span> layerMask = (groupobj.find(blenderobject) == groupobj.end()) ? activeLayerBitInfo : 0;
<a name="l02706"></a>02706         <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a99d1f009720d1f2750d87abaa22c3eca">BL_CreatePhysicsObjectNew</a>(gameobj,blenderobject,meshobj,kxscene,layerMask,physics_engine,converter,processCompoundChildren);
<a name="l02707"></a>02707     }
<a name="l02708"></a>02708 
<a name="l02709"></a>02709     processCompoundChildren = <span class="keyword">true</span>;
<a name="l02710"></a>02710     <span class="comment">// create physics information</span>
<a name="l02711"></a>02711     <span class="keywordflow">for</span> (i=0;i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02712"></a>02712     {
<a name="l02713"></a>02713         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02714"></a>02714         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02715"></a>02715         <span class="keywordtype">int</span> nummeshes = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0380469d233ad08592b6a49819db066d">GetMeshCount</a>();
<a name="l02716"></a>02716         <a class="code" href="../../d5/d85/classRAS__MeshObject.html">RAS_MeshObject</a>* meshobj = 0;
<a name="l02717"></a>02717         <span class="keywordflow">if</span> (nummeshes &gt; 0)
<a name="l02718"></a>02718         {
<a name="l02719"></a>02719             meshobj = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a0a71e1e10264a686d4bce3ec2733fe86">GetMesh</a>(0);
<a name="l02720"></a>02720         }
<a name="l02721"></a>02721         <span class="keywordtype">int</span> layerMask = (groupobj.find(blenderobject) == groupobj.end()) ? activeLayerBitInfo : 0;
<a name="l02722"></a>02722         <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a99d1f009720d1f2750d87abaa22c3eca">BL_CreatePhysicsObjectNew</a>(gameobj,blenderobject,meshobj,kxscene,layerMask,physics_engine,converter,processCompoundChildren);
<a name="l02723"></a>02723     }
<a name="l02724"></a>02724     
<a name="l02725"></a>02725     <span class="comment">//set ini linearVel and int angularVel //rcruiz</span>
<a name="l02726"></a>02726     <span class="keywordflow">if</span> (converter-&gt;<a class="code" href="../../d7/dfb/classKX__ISceneConverter.html#a876fa6054861347717b258b80dcdb85a">addInitFromFrame</a>)
<a name="l02727"></a>02727         <span class="keywordflow">for</span> (i=0;i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02728"></a>02728         {
<a name="l02729"></a>02729             <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02730"></a>02730             <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a92e4767b602687027b7d3bdfcfc2407c">IsDynamic</a>()) {
<a name="l02731"></a>02731                 gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a9c1bd81668d74e90fefec57084a525c3">setLinearVelocity</a>(inivel[i],<span class="keyword">false</span>);
<a name="l02732"></a>02732                 gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a99a8ebf937afd9d80dd72a12f5f8b695">setAngularVelocity</a>(iniang[i],<span class="keyword">false</span>);
<a name="l02733"></a>02733             }
<a name="l02734"></a>02734         
<a name="l02735"></a>02735         
<a name="l02736"></a>02736         }   
<a name="l02737"></a>02737 
<a name="l02738"></a>02738         <span class="comment">// create physics joints</span>
<a name="l02739"></a>02739     <span class="keywordflow">for</span> (i=0;i&lt;sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02740"></a>02740     {
<a name="l02741"></a>02741         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) sumolist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02742"></a>02742         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02743"></a>02743         <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *conlist;
<a name="l02744"></a>02744         <a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *curcon;
<a name="l02745"></a>02745         conlist = <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#ac8d0997433be61cf1763dd7f04292945">get_active_constraints2</a>(blenderobject);
<a name="l02746"></a>02746 
<a name="l02747"></a>02747         <span class="keywordflow">if</span> ((gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ab7670c9020e12b589c96374262e769eb">GetLayer</a>()&amp;activeLayerBitInfo)==0)
<a name="l02748"></a>02748             <span class="keywordflow">continue</span>;
<a name="l02749"></a>02749 
<a name="l02750"></a>02750         <span class="keywordflow">if</span> (conlist) {
<a name="l02751"></a>02751             <span class="keywordflow">for</span> (curcon = (<a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *)conlist-&gt;<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; curcon; curcon=(<a class="code" href="../../d8/d41/structbConstraint.html">bConstraint</a> *)curcon-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a463805fc5e4f3bfb3f0bf92913808c88">next</a>) {
<a name="l02752"></a>02752                 <span class="keywordflow">if</span> (curcon-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#a63187d597452da3bb2bd3b52054167cc">type</a>==<a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a22745fe3cf64fc34759408bb74cd18f5a44c442a006038ebc212011d1c158646f">CONSTRAINT_TYPE_RIGIDBODYJOINT</a>) {
<a name="l02753"></a>02753 
<a name="l02754"></a>02754                     <a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html">bRigidBodyJointConstraint</a> *dat=(<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html">bRigidBodyJointConstraint</a> *)curcon-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#adfe30f55cbdd3ae1ae79948b63d3063e">data</a>;
<a name="l02755"></a>02755 
<a name="l02756"></a>02756                     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (!dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#ada75a64a8d6fd204c14a55ce6f024b9b">child</a> &amp;&amp; !(curcon-&gt;<a class="code" href="../../d8/d41/structbConstraint.html#ac6a72c0507023027796fab32f3780463">flag</a> &amp; <a class="code" href="../../db/d03/DNA__constraint__types_8h.html#a0362894a1749bab66380cae2ce4b1efda3e9dbf2146b5916be569195d1098c5a2">CONSTRAINT_OFF</a>)) {
<a name="l02757"></a>02757 
<a name="l02758"></a>02758                         <a class="code" href="../../d7/ddb/classPHY__IPhysicsController.html">PHY_IPhysicsController</a>* physctr2 = 0;
<a name="l02759"></a>02759 
<a name="l02760"></a>02760                         <span class="keywordflow">if</span> (dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a7b0328b08364316650b3d8b90a637101">tar</a>)
<a name="l02761"></a>02761                         {
<a name="l02762"></a>02762                             <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a> *gotar=<a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a0555f32e9d8f655d4fab1726ebdfba43">getGameOb</a>(dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a7b0328b08364316650b3d8b90a637101">tar</a>-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2,sumolist);
<a name="l02763"></a>02763                             <span class="keywordflow">if</span> (gotar &amp;&amp; ((gotar-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ab7670c9020e12b589c96374262e769eb">GetLayer</a>()&amp;activeLayerBitInfo)!=0) &amp;&amp; gotar-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a8fca8020988a86c8cb72dbeb5d4a8e2f">GetPhysicsController</a>())
<a name="l02764"></a>02764                                 physctr2 = (<a class="code" href="../../d7/ddb/classPHY__IPhysicsController.html">PHY_IPhysicsController</a>*) gotar-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a8fca8020988a86c8cb72dbeb5d4a8e2f">GetPhysicsController</a>()-&gt;<a class="code" href="../../dd/dfc/classKX__IPhysicsController.html#a1776408294ea6ad0d9aea2beed050095">GetUserData</a>();
<a name="l02765"></a>02765                         }
<a name="l02766"></a>02766 
<a name="l02767"></a>02767                         <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a8fca8020988a86c8cb72dbeb5d4a8e2f">GetPhysicsController</a>())
<a name="l02768"></a>02768                         {
<a name="l02769"></a>02769                             <a class="code" href="../../d7/ddb/classPHY__IPhysicsController.html">PHY_IPhysicsController</a>* physctrl = (<a class="code" href="../../d7/ddb/classPHY__IPhysicsController.html">PHY_IPhysicsController</a>*) gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a8fca8020988a86c8cb72dbeb5d4a8e2f">GetPhysicsController</a>()-&gt;<a class="code" href="../../dd/dfc/classKX__IPhysicsController.html#a1776408294ea6ad0d9aea2beed050095">GetUserData</a>();
<a name="l02770"></a>02770                             <span class="comment">//we need to pass a full constraint frame, not just axis</span>
<a name="l02771"></a>02771 
<a name="l02772"></a>02772                             <span class="comment">//localConstraintFrameBasis</span>
<a name="l02773"></a>02773                             <a class="code" href="../../dd/d6f/classMT__Matrix3x3.html">MT_Matrix3x3</a> localCFrame(<a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a>(dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#aaf68f1bac8f98640c374183e5179b24a">axX</a>,dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#afc39bb91adbb4c12841a8957020377de">axY</a>,dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#ac4a5c0b431b4ae719ef7bc30651b94b5">axZ</a>));
<a name="l02774"></a>02774                             <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> axis0 = localCFrame.<a class="code" href="../../dd/d6f/classMT__Matrix3x3.html#ab8db1e7a814e41697a8e2082dbd2aa04">getColumn</a>(0);
<a name="l02775"></a>02775                             <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> axis1 = localCFrame.<a class="code" href="../../dd/d6f/classMT__Matrix3x3.html#ab8db1e7a814e41697a8e2082dbd2aa04">getColumn</a>(1);
<a name="l02776"></a>02776                             <a class="code" href="../../d6/d9d/classMT__Vector3.html">MT_Vector3</a> axis2 = localCFrame.<a class="code" href="../../dd/d6f/classMT__Matrix3x3.html#ab8db1e7a814e41697a8e2082dbd2aa04">getColumn</a>(2);
<a name="l02777"></a>02777                                 
<a name="l02778"></a>02778                             <span class="keywordtype">int</span> constraintId = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#a638574d00febd82b93ad5e81326bcc4b">createConstraint</a>(physctrl,physctr2,(<a class="code" href="../../d4/d03/PHY__DynamicTypes_8h.html#a9755c0d414ca5d2bbb21ba4f790a8b18" title="PHY_ConstraintType enumerates all supported Constraint Types.">PHY_ConstraintType</a>)dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a21f00c46fc4005713aa02470b76c9294">type</a>,(<span class="keywordtype">float</span>)dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#aa60a2e3c9ff99b85ead8d170baa41aa1">pivX</a>,
<a name="l02779"></a>02779                                 (<span class="keywordtype">float</span>)dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a780b41d45ebd8fe056a7dbaadefde681">pivY</a>,(<span class="keywordtype">float</span>)dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#ad9b69a82f75a4a811d982f4e7afec379">pivZ</a>,
<a name="l02780"></a>02780                                 (<span class="keywordtype">float</span>)axis0.<a class="code" href="../../d8/da2/classMT__Tuple3.html#a4fc6295783618921127b9c2fc50f1886">x</a>(),(float)axis0.<a class="code" href="../../d8/da2/classMT__Tuple3.html#a1f96a6c8175338f515073fa85b922275">y</a>(),(float)axis0.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af9fc03727b4886fdc3492c2e4f3c8d79">z</a>(),
<a name="l02781"></a>02781                                 (float)axis1.<a class="code" href="../../d8/da2/classMT__Tuple3.html#a4fc6295783618921127b9c2fc50f1886">x</a>(),(float)axis1.<a class="code" href="../../d8/da2/classMT__Tuple3.html#a1f96a6c8175338f515073fa85b922275">y</a>(),(float)axis1.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af9fc03727b4886fdc3492c2e4f3c8d79">z</a>(),
<a name="l02782"></a>02782                                 (float)axis2.<a class="code" href="../../d8/da2/classMT__Tuple3.html#a4fc6295783618921127b9c2fc50f1886">x</a>(),(float)axis2.<a class="code" href="../../d8/da2/classMT__Tuple3.html#a1f96a6c8175338f515073fa85b922275">y</a>(),(float)axis2.<a class="code" href="../../d8/da2/classMT__Tuple3.html#af9fc03727b4886fdc3492c2e4f3c8d79">z</a>(),dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a518afabd9132a136e762fe183c0d6308">flag</a>);
<a name="l02783"></a>02783                             <span class="keywordflow">if</span> (constraintId)
<a name="l02784"></a>02784                             {
<a name="l02785"></a>02785                                 <span class="comment">//if it is a generic 6DOF constraint, set all the limits accordingly</span>
<a name="l02786"></a>02786                                 <span class="keywordflow">if</span> (dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a21f00c46fc4005713aa02470b76c9294">type</a> == <a class="code" href="../../d4/d03/PHY__DynamicTypes_8h.html#a9755c0d414ca5d2bbb21ba4f790a8b18a563cdd6dc42e4bcc052b97a18bae7c2c">PHY_GENERIC_6DOF_CONSTRAINT</a>)
<a name="l02787"></a>02787                                 {
<a name="l02788"></a>02788                                     <span class="keywordtype">int</span> dof;
<a name="l02789"></a>02789                                     <span class="keywordtype">int</span> dofbit=1;
<a name="l02790"></a>02790                                     <span class="keywordflow">for</span> (dof=0;dof&lt;6;dof++)
<a name="l02791"></a>02791                                     {
<a name="l02792"></a>02792                                         <span class="keywordflow">if</span> (dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a518afabd9132a136e762fe183c0d6308">flag</a> &amp; dofbit)
<a name="l02793"></a>02793                                         {
<a name="l02794"></a>02794                                             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#ad28b5d835243ff1db30f97b69ce5696c">setConstraintParam</a>(constraintId,dof,dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a6891304b68bee8c78074665d4acf956f">minLimit</a>[dof],dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#ad1aa61224e7ff70cf4ecb09f1a3fbca3">maxLimit</a>[dof]);
<a name="l02795"></a>02795                                         } <span class="keywordflow">else</span>
<a name="l02796"></a>02796                                         {
<a name="l02797"></a>02797                                             <span class="comment">//minLimit &gt; maxLimit means free(disabled limit) for this degree of freedom</span>
<a name="l02798"></a>02798                                             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#ad28b5d835243ff1db30f97b69ce5696c">setConstraintParam</a>(constraintId,dof,1,-1);
<a name="l02799"></a>02799                                         }
<a name="l02800"></a>02800                                         dofbit&lt;&lt;=1;
<a name="l02801"></a>02801                                     }
<a name="l02802"></a>02802                                 }
<a name="l02803"></a>02803                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a21f00c46fc4005713aa02470b76c9294">type</a> == <a class="code" href="../../d4/d03/PHY__DynamicTypes_8h.html#a9755c0d414ca5d2bbb21ba4f790a8b18a3f1a0238fdd1b82abd4fc9e34d187e9d">PHY_CONE_TWIST_CONSTRAINT</a>)
<a name="l02804"></a>02804                                 {
<a name="l02805"></a>02805                                     <span class="keywordtype">int</span> dof;
<a name="l02806"></a>02806                                     <span class="keywordtype">int</span> dofbit = 1&lt;&lt;3; <span class="comment">// bitflag use_angular_limit_x</span>
<a name="l02807"></a>02807                                     
<a name="l02808"></a>02808                                     <span class="keywordflow">for</span> (dof=3;dof&lt;6;dof++)
<a name="l02809"></a>02809                                     {
<a name="l02810"></a>02810                                         <span class="keywordflow">if</span> (dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a518afabd9132a136e762fe183c0d6308">flag</a> &amp; dofbit)
<a name="l02811"></a>02811                                         {
<a name="l02812"></a>02812                                             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#ad28b5d835243ff1db30f97b69ce5696c">setConstraintParam</a>(constraintId,dof,dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a6891304b68bee8c78074665d4acf956f">minLimit</a>[dof],dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#ad1aa61224e7ff70cf4ecb09f1a3fbca3">maxLimit</a>[dof]);
<a name="l02813"></a>02813                                         }
<a name="l02814"></a>02814                                         <span class="keywordflow">else</span>
<a name="l02815"></a>02815                                         {
<a name="l02816"></a>02816                                             <span class="comment">//maxLimit &lt; 0 means free(disabled limit) for this degree of freedom</span>
<a name="l02817"></a>02817                                             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#ad28b5d835243ff1db30f97b69ce5696c">setConstraintParam</a>(constraintId,dof,1,-1);
<a name="l02818"></a>02818                                         }
<a name="l02819"></a>02819                                         dofbit&lt;&lt;=1;
<a name="l02820"></a>02820                                     }                               
<a name="l02821"></a>02821                                 }
<a name="l02822"></a>02822                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a21f00c46fc4005713aa02470b76c9294">type</a> == <a class="code" href="../../d4/d03/PHY__DynamicTypes_8h.html#a9755c0d414ca5d2bbb21ba4f790a8b18a6cdacbc59ca2f12867a48e9c17af96ac">PHY_LINEHINGE_CONSTRAINT</a>)
<a name="l02823"></a>02823                                 {
<a name="l02824"></a>02824                                     <span class="keywordtype">int</span> dof = 3; <span class="comment">// dof for angular x</span>
<a name="l02825"></a>02825                                     <span class="keywordtype">int</span> dofbit = 1&lt;&lt;3; <span class="comment">// bitflag use_angular_limit_x</span>
<a name="l02826"></a>02826                                     
<a name="l02827"></a>02827                                     <span class="keywordflow">if</span> (dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a518afabd9132a136e762fe183c0d6308">flag</a> &amp; dofbit)
<a name="l02828"></a>02828                                     {
<a name="l02829"></a>02829                                         kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#ad28b5d835243ff1db30f97b69ce5696c">setConstraintParam</a>(constraintId,dof,
<a name="l02830"></a>02830                                                 dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#a6891304b68bee8c78074665d4acf956f">minLimit</a>[dof],dat-&gt;<a class="code" href="../../d8/dd4/structbRigidBodyJointConstraint.html#ad1aa61224e7ff70cf4ecb09f1a3fbca3">maxLimit</a>[dof]);
<a name="l02831"></a>02831                                     } <span class="keywordflow">else</span>
<a name="l02832"></a>02832                                     {
<a name="l02833"></a>02833                                         <span class="comment">//minLimit &gt; maxLimit means free(disabled limit) for this degree of freedom</span>
<a name="l02834"></a>02834                                         kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a29c3e8d43a5878f1725c03ce37bb5a30">GetPhysicsEnvironment</a>()-&gt;<a class="code" href="../../d4/db0/classPHY__IPhysicsEnvironment.html#ad28b5d835243ff1db30f97b69ce5696c">setConstraintParam</a>(constraintId,dof,1,-1);
<a name="l02835"></a>02835                                     }
<a name="l02836"></a>02836                                 }
<a name="l02837"></a>02837                             }
<a name="l02838"></a>02838                         }
<a name="l02839"></a>02839                     }
<a name="l02840"></a>02840                 }
<a name="l02841"></a>02841             }
<a name="l02842"></a>02842         }
<a name="l02843"></a>02843     }
<a name="l02844"></a>02844 
<a name="l02845"></a>02845     sumolist-&gt;<a class="code" href="../../d7/d9c/classCValue.html#ad20cd92d44698a94dd8137fca86d85e3">Release</a>();
<a name="l02846"></a>02846 
<a name="l02847"></a>02847     <span class="comment">// convert world</span>
<a name="l02848"></a>02848     <a class="code" href="../../db/d52/classKX__WorldInfo.html">KX_WorldInfo</a>* worldinfo = <span class="keyword">new</span> <a class="code" href="../../df/dfc/classBlenderWorldInfo.html">BlenderWorldInfo</a>(blenderscene, blenderscene-&gt;<a class="code" href="../../d9/d27/structScene.html#aefac18ed3d1ded63b012f79a3ca8ddb2">world</a>);
<a name="l02849"></a>02849     converter-&gt;<a class="code" href="../../d3/dc1/classKX__BlenderSceneConverter.html#aa9a274bbce605a15f97d9ea38de9e8f3">RegisterWorldInfo</a>(worldinfo);
<a name="l02850"></a>02850     kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a9c99b1b626029014f37dc68a92ab7708">SetWorldInfo</a>(worldinfo);
<a name="l02851"></a>02851 
<a name="l02852"></a>02852     <span class="comment">//create object representations for obstacle simulation</span>
<a name="l02853"></a>02853     <a class="code" href="../../d7/d8d/classKX__ObstacleSimulation.html">KX_ObstacleSimulation</a>* obssimulation = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a4bffcb8da9793ef6c6d42b707de79edc">GetObstacleSimulation</a>();
<a name="l02854"></a>02854     <span class="keywordflow">if</span> (obssimulation)
<a name="l02855"></a>02855     {
<a name="l02856"></a>02856         <span class="keywordflow">for</span> ( i=0;i&lt;objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02857"></a>02857         {
<a name="l02858"></a>02858             <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02859"></a>02859             <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02860"></a>02860             <span class="keywordflow">if</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a99cbfef9c9f13a669a05c058ef16a152">OB_HASOBSTACLE</a>)
<a name="l02861"></a>02861             {
<a name="l02862"></a>02862                 obssimulation-&gt;<a class="code" href="../../d7/d8d/classKX__ObstacleSimulation.html#a9e47ed5ec91bc82b06e1e7bacafb822e">AddObstacleForObj</a>(gameobj);
<a name="l02863"></a>02863             }
<a name="l02864"></a>02864         }
<a name="l02865"></a>02865     }
<a name="l02866"></a>02866 
<a name="l02867"></a>02867     <span class="comment">//process navigation mesh objects</span>
<a name="l02868"></a>02868     <span class="keywordflow">for</span> ( i=0; i&lt;objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02869"></a>02869     {
<a name="l02870"></a>02870         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02871"></a>02871         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02872"></a>02872         <span class="keywordflow">if</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a> &amp;&amp; (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a3f9a77538b44c005c3225228453ef3a2">OB_NAVMESH</a>))
<a name="l02873"></a>02873         {
<a name="l02874"></a>02874             <a class="code" href="../../db/d94/classKX__NavMeshObject.html">KX_NavMeshObject</a>* navmesh = <span class="keyword">static_cast&lt;</span><a class="code" href="../../db/d94/classKX__NavMeshObject.html">KX_NavMeshObject</a>*<span class="keyword">&gt;</span>(gameobj);
<a name="l02875"></a>02875             navmesh-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ad375ebbacffde2939f5eadfe86c4e1d7">SetVisible</a>(0, <span class="keyword">true</span>);
<a name="l02876"></a>02876             navmesh-&gt;<a class="code" href="../../db/d94/classKX__NavMeshObject.html#aeba8fc6384f2ba4758dcdfd378a48635">BuildNavMesh</a>();
<a name="l02877"></a>02877             <span class="keywordflow">if</span> (obssimulation)
<a name="l02878"></a>02878                 obssimulation-&gt;<a class="code" href="../../d7/d8d/classKX__ObstacleSimulation.html#a1d37a2aa87d1ccc3be6f4fe71272cdde">AddObstaclesForNavMesh</a>(navmesh);
<a name="l02879"></a>02879         }
<a name="l02880"></a>02880     }
<a name="l02881"></a>02881     <span class="keywordflow">for</span> ( i=0; i&lt;inactivelist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02882"></a>02882     {
<a name="l02883"></a>02883         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(inactivelist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02884"></a>02884         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobject = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02885"></a>02885         <span class="keywordflow">if</span> (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a> &amp;&amp; (blenderobject-&gt;<a class="code" href="../../de/de7/structObject.html#aa98e0216a27ddd692f1ec329ce4a4db4">gameflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a3f9a77538b44c005c3225228453ef3a2">OB_NAVMESH</a>))
<a name="l02886"></a>02886         {
<a name="l02887"></a>02887             <a class="code" href="../../db/d94/classKX__NavMeshObject.html">KX_NavMeshObject</a>* navmesh = <span class="keyword">static_cast&lt;</span><a class="code" href="../../db/d94/classKX__NavMeshObject.html">KX_NavMeshObject</a>*<span class="keyword">&gt;</span>(gameobj);
<a name="l02888"></a>02888             navmesh-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#ad375ebbacffde2939f5eadfe86c4e1d7">SetVisible</a>(0, <span class="keyword">true</span>);
<a name="l02889"></a>02889         }
<a name="l02890"></a>02890     }
<a name="l02891"></a>02891 
<a name="l02892"></a>02892 <span class="preprocessor">#define CONVERT_LOGIC</span>
<a name="l02893"></a>02893 <span class="preprocessor"></span><span class="preprocessor">#ifdef CONVERT_LOGIC</span>
<a name="l02894"></a>02894 <span class="preprocessor"></span>    <span class="comment">// convert logic bricks, sensors, controllers and actuators</span>
<a name="l02895"></a>02895     <span class="keywordflow">for</span> (i=0;i&lt;logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02896"></a>02896     {
<a name="l02897"></a>02897         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02898"></a>02898         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobj = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02899"></a>02899         <span class="keywordtype">int</span> layerMask = (groupobj.find(blenderobj) == groupobj.end()) ? activeLayerBitInfo : 0;
<a name="l02900"></a>02900         <span class="keywordtype">bool</span> isInActiveLayer = (blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a> &amp; layerMask)!=0;
<a name="l02901"></a>02901         <a class="code" href="../../df/dfb/KX__ConvertActuators_8cpp.html#a96c91bc51204654be04c2f46772a2b6a">BL_ConvertActuators</a>(maggie-&gt;<a class="code" href="../../d0/dc0/structMain.html#a8cf7ece1c27b22c05a1198b28d42ebdf">name</a>, blenderobj,gameobj,logicmgr,kxscene,ketsjiEngine,layerMask,isInActiveLayer,rendertools,converter);
<a name="l02902"></a>02902     }
<a name="l02903"></a>02903     <span class="keywordflow">for</span> ( i=0;i&lt;logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02904"></a>02904     {
<a name="l02905"></a>02905         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02906"></a>02906         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobj = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02907"></a>02907         <span class="keywordtype">int</span> layerMask = (groupobj.find(blenderobj) == groupobj.end()) ? activeLayerBitInfo : 0;
<a name="l02908"></a>02908         <span class="keywordtype">bool</span> isInActiveLayer = (blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a> &amp; layerMask)!=0;
<a name="l02909"></a>02909         <a class="code" href="../../d3/d30/KX__ConvertControllers_8cpp.html#a5e8b42767870aa5f156182ed3844ee48">BL_ConvertControllers</a>(blenderobj,gameobj,logicmgr, layerMask,isInActiveLayer,converter);
<a name="l02910"></a>02910     }
<a name="l02911"></a>02911     <span class="keywordflow">for</span> ( i=0;i&lt;logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02912"></a>02912     {
<a name="l02913"></a>02913         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(logicbrick_conversionlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02914"></a>02914         <span class="keyword">struct </span><a class="code" href="../../de/de7/structObject.html">Object</a>* blenderobj = gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a33f8953dd41b83078db209e44d448b7c">GetBlenderObject</a>();
<a name="l02915"></a>02915         <span class="keywordtype">int</span> layerMask = (groupobj.find(blenderobj) == groupobj.end()) ? activeLayerBitInfo : 0;
<a name="l02916"></a>02916         <span class="keywordtype">bool</span> isInActiveLayer = (blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#aa9cfa964651e1e2f3044c9c79cf004b3">lay</a> &amp; layerMask)!=0;
<a name="l02917"></a>02917         <a class="code" href="../../d8/d31/KX__ConvertSensors_8cpp.html#a49360c0c6df2570720c4cfde4a1ac438">BL_ConvertSensors</a>(blenderobj,gameobj,logicmgr,kxscene,ketsjiEngine,layerMask,isInActiveLayer,canvas,converter);
<a name="l02918"></a>02918         <span class="comment">// set the init state to all objects</span>
<a name="l02919"></a>02919         gameobj-&gt;<a class="code" href="../../da/d68/classSCA__IObject.html#ae94ec3cad529b095b26582346a461c43">SetInitState</a>((blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#a5a3666f4a715fa60324a0efec6d722ab">init_state</a>)?blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#a5a3666f4a715fa60324a0efec6d722ab">init_state</a>:blenderobj-&gt;<a class="code" href="../../de/de7/structObject.html#a0db8d849f3d902f13e2f102848182758">state</a>);
<a name="l02920"></a>02920     }
<a name="l02921"></a>02921     <span class="comment">// apply the initial state to controllers, only on the active objects as this registers the sensors</span>
<a name="l02922"></a>02922     <span class="keywordflow">for</span> ( i=0;i&lt;objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();i++)
<a name="l02923"></a>02923     {
<a name="l02924"></a>02924         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*<span class="keyword">&gt;</span>(objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i));
<a name="l02925"></a>02925         gameobj-&gt;<a class="code" href="../../da/d68/classSCA__IObject.html#a6ff384be524dde6d026dd7f1059b146a">ResetState</a>();
<a name="l02926"></a>02926     }
<a name="l02927"></a>02927 
<a name="l02928"></a>02928 <span class="preprocessor">#endif //CONVERT_LOGIC</span>
<a name="l02929"></a>02929 <span class="preprocessor"></span>
<a name="l02930"></a>02930     logicbrick_conversionlist-&gt;<a class="code" href="../../d7/d9c/classCValue.html#ad20cd92d44698a94dd8137fca86d85e3">Release</a>();
<a name="l02931"></a>02931     
<a name="l02932"></a>02932     <span class="comment">// Calculate the scene btree -</span>
<a name="l02933"></a>02933     <span class="comment">// too slow - commented out.</span>
<a name="l02934"></a>02934     <span class="comment">//kxscene-&gt;SetNodeTree(tf.MakeTree());</span>
<a name="l02935"></a>02935 
<a name="l02936"></a>02936     <span class="comment">// instantiate dupli group, we will loop trough the object</span>
<a name="l02937"></a>02937     <span class="comment">// that are in active layers. Note that duplicating group</span>
<a name="l02938"></a>02938     <span class="comment">// has the effect of adding objects at the end of objectlist.</span>
<a name="l02939"></a>02939     <span class="comment">// Only loop through the first part of the list.</span>
<a name="l02940"></a>02940     <span class="keywordtype">int</span> objcount = objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#abdbc617f2a8ab49346008d4ac857f9b4">GetCount</a>();
<a name="l02941"></a>02941     <span class="keywordflow">for</span> (i=0;i&lt;objcount;i++)
<a name="l02942"></a>02942     {
<a name="l02943"></a>02943         <a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>* gameobj = (<a class="code" href="../../d1/d73/classKX__GameObject.html">KX_GameObject</a>*) objectlist-&gt;<a class="code" href="../../d6/de7/classCListValue.html#aa388a5dfd4110408735fc6926c7464b4">GetValue</a>(i);
<a name="l02944"></a>02944         <span class="keywordflow">if</span> (gameobj-&gt;<a class="code" href="../../d1/d73/classKX__GameObject.html#a264ac7c60a972b2afe766e1e847135f8">IsDupliGroup</a>())
<a name="l02945"></a>02945         {
<a name="l02946"></a>02946             kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#aa96b9ae252e6d4b8bc0b22b4e3200199">DupliGroupRecurse</a>(gameobj, 0);
<a name="l02947"></a>02947         }
<a name="l02948"></a>02948     }
<a name="l02949"></a>02949 
<a name="l02950"></a>02950     <a class="code" href="../../dc/d6b/classKX__Camera.html">KX_Camera</a> *activecam = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a8127f5823a26b8f1c87db68908088826">GetActiveCamera</a>();
<a name="l02951"></a>02951     <a class="code" href="../../d6/dc4/MT__Scalar_8h.html#a71b06cc1a8da1da228878ebfd84cd2a9">MT_Scalar</a> <a class="code" href="../../d1/d22/stdosl_8h.html#a4d04eb0874bac8d51beb2f1d36fe6107">distance</a> = (activecam)? activecam-&gt;<a class="code" href="../../dc/d6b/classKX__Camera.html#a2ef3c6679c3915fd6673812f0bcabdf6">GetCameraFar</a>() - activecam-&gt;<a class="code" href="../../dc/d6b/classKX__Camera.html#aa3714035978a31d4300732f61e48755b">GetCameraNear</a>(): 100.0f;
<a name="l02952"></a>02952     <a class="code" href="../../df/d04/classRAS__BucketManager.html">RAS_BucketManager</a> *bucketmanager = kxscene-&gt;<a class="code" href="../../d2/da3/classKX__Scene.html#a9e031e8bf9bb35c1216efe1048d8102b">GetBucketManager</a>();
<a name="l02953"></a>02953     bucketmanager-&gt;<a class="code" href="../../df/d04/classRAS__BucketManager.html#a29be20087eca17be01a396bdbbbd1b50">OptimizeBuckets</a>(distance);
<a name="l02954"></a>02954 }
<a name="l02955"></a>02955 
<a name="l02956"></a><a class="code" href="../../da/d98/BL__BlenderDataConversion_8h.html#ae2b32182320ed60b35a763383403fb91">02956</a> <a class="code" href="../../d9/d20/classSCA__IInputDevice.html#a9847f783d8ad8c37c5246593ab9ea6aa">SCA_IInputDevice::KX_EnumInputs</a> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#ae2b32182320ed60b35a763383403fb91">ConvertKeyCode</a>(<span class="keywordtype">int</span> key_code)
<a name="l02957"></a>02957 {
<a name="l02958"></a>02958     <span class="keywordflow">return</span> <a class="code" href="../../d6/df2/BL__BlenderDataConversion_8cpp.html#a3dfe7fa19ac92c26f3f1e1d532a1f9a7">gReverseKeyTranslateTable</a>[key_code];
<a name="l02959"></a>02959 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:02 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
