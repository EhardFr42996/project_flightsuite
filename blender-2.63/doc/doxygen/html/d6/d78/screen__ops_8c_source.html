<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Blender: screen_ops.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blender.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blender&#160;<span id="projectnumber">V2.6x</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">screen_ops.c</div>  </div>
</div>
<div class="contents">
<a href="../../d6/d78/screen__ops_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * ***** BEGIN GPL LICENSE BLOCK *****</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment"> * modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment"> * as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment"> * of the License, or (at your option) any later version. </span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment"> * along with this program; if not, write to the Free Software Foundation,</span>
<a name="l00016"></a>00016 <span class="comment"> * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * The Original Code is Copyright (C) 2008 Blender Foundation.</span>
<a name="l00019"></a>00019 <span class="comment"> * All rights reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * ***** END GPL LICENSE BLOCK *****</span>
<a name="l00023"></a>00023 <span class="comment"> */</span>
<a name="l00024"></a>00024 
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd0/MEM__guardedalloc_8h.html" title="Read Guarded memory(de)allocation.">MEM_guardedalloc.h</a>&quot;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4b/BLI__math_8h.html">BLI_math.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../de/df4/BLI__blenlib_8h.html">BLI_blenlib.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d11/BLI__dlrbTree_8h.html">BLI_dlrbTree.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7d/BLI__utildefines_8h.html">BLI_utildefines.h</a>&quot;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d93/DNA__armature__types_8h.html">DNA_armature_types.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2f/DNA__lattice__types_8h.html">DNA_lattice_types.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd9/DNA__object__types_8h.html" title="Object is a sort of wrapper for general info.">DNA_object_types.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d88/DNA__curve__types_8h.html">DNA_curve_types.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/db3/DNA__scene__types_8h.html">DNA_scene_types.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d40/DNA__meta__types_8h.html">DNA_meta_types.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d96/DNA__mesh__types_8h.html">DNA_mesh_types.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/de4/DNA__userdef__types_8h.html">DNA_userdef_types.h</a>&quot;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d01/BKE__context_8h.html">BKE_context.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d5e/BKE__customdata_8h.html" title="CustomData interface, see also DNA_customdata_types.h.">BKE_customdata.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/BKE__global_8h.html">BKE_global.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d9a/BKE__main_8h.html">BKE_main.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d7f/BKE__mesh_8h.html">BKE_mesh.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../df/dac/BKE__object_8h.html" title="General operations, lookup, etc. for blender objects.">BKE_object.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d40/BKE__report_8h.html">BKE_report.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d53/BKE__scene_8h.html">BKE_scene.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/da3/BKE__screen_8h.html">BKE_screen.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html">BKE_tessmesh.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/db1/BKE__sound_8h.html">BKE_sound.h</a>&quot;</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/WM__api_8h.html">WM_api.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddc/WM__types_8h.html">WM_types.h</a>&quot;</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/df1/ED__util_8h.html">ED_util.h</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d53/ED__image_8h.html">ED_image.h</a>&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d12/ED__screen_8h.html">ED_screen.h</a>&quot;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d7a/ED__object_8h.html">ED_object.h</a>&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d98/ED__armature_8h.html">ED_armature.h</a>&quot;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d85/ED__screen__types_8h.html">ED_screen_types.h</a>&quot;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/df9/ED__keyframes__draw_8h.html">ED_keyframes_draw.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d6a/ED__view3d_8h.html">ED_view3d.h</a>&quot;</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="../../de/ddf/RNA__access_8h.html">RNA_access.h</a>&quot;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/RNA__define_8h.html">RNA_define.h</a>&quot;</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1e/UI__interface_8h.html">UI_interface.h</a>&quot;</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d96/UI__resources_8h.html">UI_resources.h</a>&quot;</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d6b/wm__window_8h.html">wm_window.h</a>&quot;</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/de3/screen__intern_8h.html">screen_intern.h</a>&quot;</span>  <span class="comment">/* own module include */</span>
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3777e41f316fcd855d7c869d14869def">00083</a> <span class="preprocessor">#define KM_MODAL_CANCEL     1</span>
<a name="l00084"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1a9ee4a520928902e3a1d441305c699a">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define KM_MODAL_APPLY      2</span>
<a name="l00085"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aaa0c0c8c1b1c41ed211744018dcb8521">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define KM_MODAL_STEP10     3</span>
<a name="l00086"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ace9d233d9ac6f851d53692b3287a4c00">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define KM_MODAL_STEP10_OFF 4</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span>
<a name="l00088"></a>00088 <span class="comment">/* ************** Exported Poll tests ********************** */</span>
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ae1ca6030fb9650d6fce803e8199654d6">00090</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ad26d7d88648e865cde6cca20f026ac66">ED_operator_regionactive</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00093"></a>00093     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00094"></a>00094     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00095"></a>00095     <span class="keywordflow">return</span> 1;
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a658db962276116148f81520bddd2d97b">00098</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00101"></a>00101     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00102"></a>00102     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00103"></a>00103     <span class="keywordflow">return</span> 1;
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab324acd9319af67055e0a745a994df35">00106</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00109"></a>00109     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00110"></a>00110     <span class="keywordflow">return</span> 1;
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="comment">/* XXX added this to prevent anim state to change during renders */</span>
<a name="l00114"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3fcd41f2e293effecc1ee455dcb51cb9">00114</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a3fcd41f2e293effecc1ee455dcb51cb9">ED_operator_screenactive_norender</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00115"></a>00115 {
<a name="l00116"></a>00116     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.rendering) <span class="keywordflow">return</span> 0;
<a name="l00117"></a>00117     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00118"></a>00118     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00119"></a>00119     <span class="keywordflow">return</span> 1;
<a name="l00120"></a>00120 }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 
<a name="l00123"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a0c97e7b74b5212491f28a93ce7d47ab0">00123</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a0c97e7b74b5212491f28a93ce7d47ab0">screen_active_editable</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00124"></a>00124 {
<a name="l00125"></a>00125     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>(C)) {
<a name="l00126"></a>00126         <span class="comment">/* no full window splitting allowed */</span>
<a name="l00127"></a>00127         <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)-&gt;full != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab5f98947e6f48dad2b0184d7d97bc365">SCREENNORMAL</a>)
<a name="l00128"></a>00128             <span class="keywordflow">return</span> 0;
<a name="l00129"></a>00129         <span class="keywordflow">return</span> 1;
<a name="l00130"></a>00130     }
<a name="l00131"></a>00131     <span class="keywordflow">return</span> 0;
<a name="l00132"></a>00132 }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="comment">/* when mouse is over area-edge */</span>
<a name="l00135"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a11cee66772af4a41ff548b6532ca2a98">00135</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ae5cdecea23f3f367638265513ceaea20">ED_operator_screen_mainwinactive</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00138"></a>00138     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00139"></a>00139     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)-&gt;subwinactive!=<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)-&gt;mainwin) <span class="keywordflow">return</span> 0;
<a name="l00140"></a>00140     <span class="keywordflow">return</span> 1;
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a9aa754e8a551117e0c32992d336f8a21">00143</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ac89d9d0a801fbd0ea575600395b5caca">ED_operator_scene_editable</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00144"></a>00144 {
<a name="l00145"></a>00145     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00146"></a>00146     <span class="keywordflow">if</span> (scene &amp;&amp; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00147"></a>00147         <span class="keywordflow">return</span> 1;
<a name="l00148"></a>00148     <span class="keywordflow">return</span> 0;
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a2886af0c7dd5d4d4ea6bda678d505edb">00151</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a2ce8daf031af36b0bf1b76701ef0648a">ED_operator_objectmode</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l00154"></a>00154     <a class="code" href="../../de/de7/structObject.html">Object</a> *obact= <a class="code" href="../../df/d01/BKE__context_8h.html#a86fd97bb1e59c64106c001ab29db25c7">CTX_data_active_object</a>(C);
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     <span class="keywordflow">if</span> (scene==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a68db741bd7a79e16f765bba66cf276b1">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>)
<a name="l00157"></a>00157         <span class="keywordflow">return</span> 0;
<a name="l00158"></a>00158     <span class="keywordflow">if</span> ( <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C) )
<a name="l00159"></a>00159         <span class="keywordflow">return</span> 0;
<a name="l00160"></a>00160     
<a name="l00161"></a>00161     <span class="comment">/* add a check for ob-&gt;mode too? */</span>
<a name="l00162"></a>00162     <span class="keywordflow">if</span> (obact &amp;&amp; obact-&gt;<a class="code" href="../../de/de7/structObject.html#a4f90725f5876b309d325c84ae4f5c51b">mode</a>)
<a name="l00163"></a>00163         <span class="keywordflow">return</span> 0;
<a name="l00164"></a>00164     
<a name="l00165"></a>00165     <span class="keywordflow">return</span> 1;
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 
<a name="l00169"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">00169</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">int</span> <a class="code" href="../../d8/dfd/structAZone.html#a396c201c32f6002fb549726586b8b480">type</a>)
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>(C)) {
<a name="l00172"></a>00172         <a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *sl= (<a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *)<a class="code" href="../../df/d01/BKE__context_8h.html#ac2755ddf45c6787c6429d5af9b04d809">CTX_wm_space_data</a>(C);
<a name="l00173"></a>00173         <span class="keywordflow">return</span> sl &amp;&amp; (sl-&gt;<a class="code" href="../../d4/d63/structSpaceLink.html#a842775af6c8ee1e2b4fd1fa4ab77a633">spacetype</a> == <a class="code" href="../../d8/dfd/structAZone.html#a396c201c32f6002fb549726586b8b480">type</a>);
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175     <span class="keywordflow">return</span> 0;
<a name="l00176"></a>00176 }
<a name="l00177"></a>00177 
<a name="l00178"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a5f0af0bfdfa88175598837681285aca5">00178</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a77a2371bebf89db17c2e83075447972b">ED_operator_view3d_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>);
<a name="l00181"></a>00181 }
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a04794cfd506b29169b0bf4ced26eeaa2">00183</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ad3e4c76483a77957597951a50918f556">ED_operator_region_view3d_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00184"></a>00184 {
<a name="l00185"></a>00185     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#af03543cb8e3fa2c39bb777962a6eae13">CTX_wm_region_view3d</a>(C))
<a name="l00186"></a>00186         <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <a class="code" href="../../df/d01/BKE__context_8h.html#adb80273514fd122e9b437f8849ced258">CTX_wm_operator_poll_msg_set</a>(C, <span class="stringliteral">&quot;expected a view3d region&quot;</span>);
<a name="l00189"></a>00189     <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;   
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 <span class="comment">/* generic for any view2d which uses anim_ops */</span>
<a name="l00193"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a62cf087bf964aa4b97dbc3d22b0ec1b0">00193</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a958a5ee635a3183a010dd0af6e54413d">ED_operator_animview_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>(C)) {
<a name="l00196"></a>00196         <a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *sl= (<a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *)<a class="code" href="../../df/d01/BKE__context_8h.html#ac2755ddf45c6787c6429d5af9b04d809">CTX_wm_space_data</a>(C);
<a name="l00197"></a>00197         <span class="keywordflow">if</span> (sl &amp;&amp; (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a94fe4335845faafd0b969e89a13d8c76">ELEM5</a>(sl-&gt;<a class="code" href="../../d4/d63/structSpaceLink.html#a842775af6c8ee1e2b4fd1fa4ab77a633">spacetype</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caa78bb4ba1705225aa14af78400406414">SPACE_SEQ</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca154950ac39aa053ba159ffbe6768eb68">SPACE_ACTION</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca7b7ea2d973db8086363e148983d6adc0">SPACE_NLA</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca67184420c844bcef0dd50660142cede6">SPACE_IPO</a>, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca51011faadfd7d38d3d7a810c600e9458">SPACE_TIME</a>)))
<a name="l00198"></a>00198             <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00199"></a>00199     }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     <a class="code" href="../../df/d01/BKE__context_8h.html#adb80273514fd122e9b437f8849ced258">CTX_wm_operator_poll_msg_set</a>(C, <span class="stringliteral">&quot;expected an timeline/animation area to be active&quot;</span>);
<a name="l00202"></a>00202     <span class="keywordflow">return</span> 0;
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ac74781c94c98692ceb2e4b8aaeb6a379">00205</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a1b507b26fef9742ef4a912f484c21396">ED_operator_timeline_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca51011faadfd7d38d3d7a810c600e9458">SPACE_TIME</a>);
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aaf08c5a48c080b4ef7d76889e2613988">00210</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a6756625742fb20959a919e64c3fa4ce2">ED_operator_outliner_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca1806179a239521ed61051b9e46b71818">SPACE_OUTLINER</a>);
<a name="l00213"></a>00213 }
<a name="l00214"></a>00214 
<a name="l00215"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#abd4caed3ff1a95c8e5cb55e97ae7e408">00215</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a46eebffd66131c0eeae84b59e1d8f258">ED_operator_outliner_active_no_editobject</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00216"></a>00216 {
<a name="l00217"></a>00217     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca1806179a239521ed61051b9e46b71818">SPACE_OUTLINER</a>)) {
<a name="l00218"></a>00218         <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../da/d7a/ED__object_8h.html#a0a87646a151e018a119ed266356bb24b">ED_object_active_context</a>(C);
<a name="l00219"></a>00219         <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00220"></a>00220         <span class="keywordflow">if</span> (ob &amp;&amp; ob == obedit)
<a name="l00221"></a>00221             <span class="keywordflow">return</span> 0;
<a name="l00222"></a>00222         <span class="keywordflow">else</span>
<a name="l00223"></a>00223             <span class="keywordflow">return</span> 1;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225     <span class="keywordflow">return</span> 0;
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ae94dfed9922b1ba2772cbcaccac45cf3">00228</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a6e677ab1d226b60a2de23e23484050bc">ED_operator_file_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca5f4c324d2af06c247780942931169c7c">SPACE_FILE</a>);
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#af2ef4fa643400ea1b27debda22435b94">00233</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#af407f5bc39655cc6560c07edb70795c9">ED_operator_action_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca154950ac39aa053ba159ffbe6768eb68">SPACE_ACTION</a>);
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00238"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a16cbce49dda9ac2f3a24137f4dd13150">00238</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a378e3971fce2da171a8239297e72eb38">ED_operator_buttons_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caa2a34290401af40dd7a52dd4041cc9da">SPACE_BUTS</a>);
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a6b27e0614da4f74b112d97417aafd3b8">00243</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a61bdc064a7b37ed5f93fc50f3eba7ff4">ED_operator_node_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00244"></a>00244 {
<a name="l00245"></a>00245     <a class="code" href="../../db/dc9/structSpaceNode.html">SpaceNode</a> *snode= <a class="code" href="../../df/d01/BKE__context_8h.html#a2bdc7246ca49eb0f285a56d01ea63b39">CTX_wm_space_node</a>(C);
<a name="l00246"></a>00246     
<a name="l00247"></a>00247     <span class="keywordflow">if</span> (snode &amp;&amp; snode-&gt;<a class="code" href="../../db/dc9/structSpaceNode.html#a89849109b4ca177aa13a5d230cecc8c6">edittree</a>)
<a name="l00248"></a>00248         <span class="keywordflow">return</span> 1;
<a name="l00249"></a>00249     
<a name="l00250"></a>00250     <span class="keywordflow">return</span> 0;
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">// XXX rename</span>
<a name="l00254"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1f7c0bdcb7489f1f27d831f61e3f72ba">00254</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a783714e9d0dbf420f5aff1fa36ced7f3">ED_operator_graphedit_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00255"></a>00255 {
<a name="l00256"></a>00256     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca67184420c844bcef0dd50660142cede6">SPACE_IPO</a>);
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00259"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a8db9423c62665c39f9e0114a7ad9d845">00259</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a528ce5b774a979d8ae36d5f35751d4b4">ED_operator_sequencer_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caa78bb4ba1705225aa14af78400406414">SPACE_SEQ</a>);
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00264"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a8ba34519197e4af3eb041717af371dbb">00264</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#adc7d651484c059ebc663549bb389767a">ED_operator_image_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752cab0433b569331024d6cf6123194fc10a2">SPACE_IMAGE</a>);
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a5ecb7b8f84e47aa6bdffad999212ab1e">00269</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a5ef52597df2373ca8e4e332cc9291c60">ED_operator_nla_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca7b7ea2d973db8086363e148983d6adc0">SPACE_NLA</a>);
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a87b6d8a6cdac2708f0a4b7c740430905">00274</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a27ad9a3de643333dd5187cb8206e4866">ED_operator_logic_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca09ebd82af4cc18122664889b59473cad">SPACE_LOGIC</a>);
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a2ef32a9c9f3f39f0741e7e0ce952774c">00279</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a83c76980dbef67c4e10a38d4657eb245">ED_operator_info_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752cafbebfeeb0fd0f7c61564dec31fe64450">SPACE_INFO</a>);
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 
<a name="l00285"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a9447799b192542b2507dcf187da8ab0e">00285</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a88af0ab1c7b2865a24d841678620accd">ED_operator_console_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00286"></a>00286 {
<a name="l00287"></a>00287     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a98f6c6a9b8174157a95fcb7be35e2778">ed_spacetype_test</a>(C, <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca1618fa49f6b8e3582db7b40d4e520817">SPACE_CONSOLE</a>);
<a name="l00288"></a>00288 }
<a name="l00289"></a>00289 
<a name="l00290"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a2ac7188c13ffe35bc45114189689d79f">00290</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#af7439040f8d9d1e3e34dffceefd26cc8">ED_operator_object_active</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00291"></a>00291 {
<a name="l00292"></a>00292     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../da/d7a/ED__object_8h.html#a0a87646a151e018a119ed266356bb24b">ED_object_active_context</a>(C);
<a name="l00293"></a>00293     <span class="keywordflow">return</span> ((ob != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>));
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a2a4767cbe0f93dfc3288203d5cfadd3c">00296</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#adf69a13ccdb50f050485340e86a00d34">ED_operator_object_active_editable</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00297"></a>00297 {
<a name="l00298"></a>00298     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../da/d7a/ED__object_8h.html#a0a87646a151e018a119ed266356bb24b">ED_object_active_context</a>(C);
<a name="l00299"></a>00299     <span class="keywordflow">return</span> ((ob != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) &amp;&amp; !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>));
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a2bf59337a9dc322881b00c28b2ca0601">00302</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a0c8cc4d65ba61303788f29dbb6f45065">ED_operator_object_active_editable_mesh</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../da/d7a/ED__object_8h.html#a0a87646a151e018a119ed266356bb24b">ED_object_active_context</a>(C);
<a name="l00305"></a>00305     <span class="keywordflow">return</span> ((ob != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) &amp;&amp; !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a> &amp;&amp; !(((<a class="code" href="../../d8/d7e/structID.html">ID</a> *)ob-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;lib));
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#adaabcb79a1f4f1e386417d5f7b273f41">00308</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a725f6acb460f678a57e1e637070b495c">ED_operator_object_active_editable_font</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob = <a class="code" href="../../da/d7a/ED__object_8h.html#a0a87646a151e018a119ed266356bb24b">ED_object_active_context</a>(C);
<a name="l00311"></a>00311     <span class="keywordflow">return</span> ((ob != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#a879e9a4b2068335bf9b33dab896e439b">id</a>.<a class="code" href="../../d8/d7e/structID.html#a56d730e86e0fc566622c5f5ea2a7de9f">lib</a>) &amp;&amp; !(ob-&gt;<a class="code" href="../../de/de7/structObject.html#afc7a8aca0c2cf33c6323883e313362b0">restrictflag</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a405802c89add02dcf80f5fbcce040b09">OB_RESTRICT_VIEW</a>) &amp;&amp; ob-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a1a94162b6fc469957966a01d41ff71d6">OB_FONT</a>);
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3d7658b878eea323f29335d7aee3af69">00314</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00317"></a>00317     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>)
<a name="l00318"></a>00318         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00319"></a>00319     <span class="keywordflow">return</span> 0;
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a08aeb6b22a957236061bbec27b4469da">00322</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a1c12c45b3e8ba8060cdeea963881947b">ED_operator_editmesh_view3d</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324     <span class="keywordflow">return</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>(C) &amp;&amp; <a class="code" href="../../d1/d12/ED__screen_8h.html#a77a2371bebf89db17c2e83075447972b">ED_operator_view3d_active</a>(C);
<a name="l00325"></a>00325 }
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ad8f72e73c6f08539ccdba4685126a3ad">00327</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a9945ce52504bab38fbc27ecfc4a44cbd">ED_operator_editmesh_region_view3d</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00328"></a>00328 {
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d12/ED__screen_8h.html#a2de006c5087f64f081d2d4115bde380f">ED_operator_editmesh</a>(C) &amp;&amp; <a class="code" href="../../df/d01/BKE__context_8h.html#af03543cb8e3fa2c39bb777962a6eae13">CTX_wm_region_view3d</a>(C))
<a name="l00330"></a>00330         <span class="keywordflow">return</span> 1;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <a class="code" href="../../df/d01/BKE__context_8h.html#adb80273514fd122e9b437f8849ced258">CTX_wm_operator_poll_msg_set</a>(C, <span class="stringliteral">&quot;expected a view3d region &amp; editmesh&quot;</span>);
<a name="l00333"></a>00333     <span class="keywordflow">return</span> 0;
<a name="l00334"></a>00334 }
<a name="l00335"></a>00335 
<a name="l00336"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a79b693eee09b4adbaf934052e3c63428">00336</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a38bfeb4c47a5c36662577cb7508473c1">ED_operator_editarmature</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00337"></a>00337 {
<a name="l00338"></a>00338     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00339"></a>00339     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a17c162dffb7fd4f0acb11d051374609b">OB_ARMATURE</a>)
<a name="l00340"></a>00340         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != ((<a class="code" href="../../d9/d9f/structbArmature.html">bArmature</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;edbo;
<a name="l00341"></a>00341     <span class="keywordflow">return</span> 0;
<a name="l00342"></a>00342 }
<a name="l00343"></a>00343 
<a name="l00344"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab7249afdac423e265cd39ac0dfc4331a">00344</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a58cfd064018383fbdd69f7d409248fbb">ED_operator_posemode</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346     <a class="code" href="../../de/de7/structObject.html">Object</a> *obact= <a class="code" href="../../df/d01/BKE__context_8h.html#a86fd97bb1e59c64106c001ab29db25c7">CTX_data_active_object</a>(C);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     <span class="keywordflow">if</span> (obact &amp;&amp; !(obact-&gt;<a class="code" href="../../de/de7/structObject.html#a4f90725f5876b309d325c84ae4f5c51b">mode</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a36fb08f71e0c90da2a0f21518ef0d550a5aed90bff10a0fd5ad47c9ee79ae4580">OB_MODE_EDIT</a>)) {
<a name="l00349"></a>00349         <a class="code" href="../../de/de7/structObject.html">Object</a> *obpose;
<a name="l00350"></a>00350         <span class="keywordflow">if</span> ((obpose= <a class="code" href="../../df/dac/BKE__object_8h.html#a7c81fbe77e3bc5283e2746857d88c94c">object_pose_armature_get</a>(obact))) {
<a name="l00351"></a>00351             <span class="keywordflow">if</span> ((obact == obpose) || (obact-&gt;<a class="code" href="../../de/de7/structObject.html#a4f90725f5876b309d325c84ae4f5c51b">mode</a> &amp; <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a36fb08f71e0c90da2a0f21518ef0d550a6ab1cede4f6911c8042ca67d0c53b780">OB_MODE_WEIGHT_PAINT</a>)) {
<a name="l00352"></a>00352                 <span class="keywordflow">return</span> 1;
<a name="l00353"></a>00353             }
<a name="l00354"></a>00354         }
<a name="l00355"></a>00355     }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     <span class="keywordflow">return</span> 0;
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 <span class="comment">/* wrapper for ED_space_image_show_uvedit */</span>
<a name="l00361"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a8da230c99a26922438567eb20e5f72f3">00361</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a93d6c73a0c87af45aaa6d41e2b3cba34">ED_operator_uvedit</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00362"></a>00362 {
<a name="l00363"></a>00363     <a class="code" href="../../db/d0f/structSpaceImage.html">SpaceImage</a> *sima= <a class="code" href="../../df/d01/BKE__context_8h.html#ae04ae450dc98cc5d253c49530f5a2dd6">CTX_wm_space_image</a>(C);
<a name="l00364"></a>00364     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00365"></a>00365     <span class="keywordflow">return</span> <a class="code" href="../../de/d53/ED__image_8h.html#aee525c3a7616c34c0c52b485113b60db">ED_space_image_show_uvedit</a>(sima, obedit);
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 
<a name="l00368"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1f65b9c85b0da08f682b85729f42fae5">00368</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ad3a7453660a3411394c666022f899c16">ED_operator_uvmap</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00369"></a>00369 {
<a name="l00370"></a>00370     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit = <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00371"></a>00371     <a class="code" href="../../d5/de5/structBMEditMesh.html">BMEditMesh</a> *em = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00372"></a>00372     
<a name="l00373"></a>00373     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a> == <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a8359f8b129e965da60eca2cbcec21bfc">OB_MESH</a>) {
<a name="l00374"></a>00374         em = <a class="code" href="../../d6/dc7/BKE__tessmesh_8h.html#a4d9806c4d2c9d7777ae1619839d6baed" title="Return the BMEditMesh for a given object.">BMEdit_FromObject</a>(obedit);
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376     
<a name="l00377"></a>00377     <span class="keywordflow">if</span> (em &amp;&amp; (em-&gt;<a class="code" href="../../d5/de5/structBMEditMesh.html#a5b91780fbab0c3a8834609b21acde933">bm</a>-&gt;<a class="code" href="../../d7/d18/structBMesh.html#ae4e0288302780574590bab5f8ff43fa4">totface</a>)) {
<a name="l00378"></a>00378         <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380     
<a name="l00381"></a>00381     <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00384"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a68e9a0de6ea440d55f22e9ba63ce5b73">00384</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ac2c4e21e03626439912647631d1d034f">ED_operator_editsurfcurve</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00385"></a>00385 {
<a name="l00386"></a>00386     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00387"></a>00387     <span class="keywordflow">if</span> (obedit &amp;&amp; <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a0b02ecc2161884c6587b77fd39150632">ELEM</a>(obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a885d669104f0c596dabb147f9371ffc3">OB_CURVE</a>, <a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ae247d3ec6e691b7752d8a90065428ecb">OB_SURF</a>))
<a name="l00388"></a>00388         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != ((<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editnurb;
<a name="l00389"></a>00389     <span class="keywordflow">return</span> 0;
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aed607f10d0e20cafd348e537449afc39">00392</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a33075b32cbf326623c280ef23d67ed65">ED_operator_editsurfcurve_region_view3d</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00393"></a>00393 {
<a name="l00394"></a>00394     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d12/ED__screen_8h.html#ac2c4e21e03626439912647631d1d034f">ED_operator_editsurfcurve</a>(C) &amp;&amp; <a class="code" href="../../df/d01/BKE__context_8h.html#af03543cb8e3fa2c39bb777962a6eae13">CTX_wm_region_view3d</a>(C))
<a name="l00395"></a>00395         <span class="keywordflow">return</span> 1;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     <a class="code" href="../../df/d01/BKE__context_8h.html#adb80273514fd122e9b437f8849ced258">CTX_wm_operator_poll_msg_set</a>(C, <span class="stringliteral">&quot;expected a view3d region &amp; editcurve&quot;</span>);
<a name="l00398"></a>00398     <span class="keywordflow">return</span> 0;
<a name="l00399"></a>00399 }
<a name="l00400"></a>00400 
<a name="l00401"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a50d17db44365d20ea8a4cc6db466cec6">00401</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a443591620f4deea4cac8a4098f66d2f7">ED_operator_editcurve</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00402"></a>00402 {
<a name="l00403"></a>00403     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00404"></a>00404     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a885d669104f0c596dabb147f9371ffc3">OB_CURVE</a>)
<a name="l00405"></a>00405         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != ((<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editnurb;
<a name="l00406"></a>00406     <span class="keywordflow">return</span> 0;
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 
<a name="l00409"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3210c7b871b0c04d40793ed546fd1041">00409</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a2a8924b558a11ea56f0541284534292b">ED_operator_editcurve_3d</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00410"></a>00410 {
<a name="l00411"></a>00411     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00412"></a>00412     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a885d669104f0c596dabb147f9371ffc3">OB_CURVE</a>) {
<a name="l00413"></a>00413         <a class="code" href="../../da/d10/structCurve.html">Curve</a> *cu= (<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415         return (cu-&gt;<a class="code" href="../../da/d10/structCurve.html#abd5b5dcd85b78434895b347aea37d841">flag</a>&amp;<a class="code" href="../../d6/d88/DNA__curve__types_8h.html#ae2e952bfa23ce6735422c9e7bae27dac">CU_3D</a>) &amp;&amp; (<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != cu-&gt;<a class="code" href="../../da/d10/structCurve.html#ab8319d0774eb0b2880dc03db155a87dc">editnurb</a>);
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417     <span class="keywordflow">return</span> 0;
<a name="l00418"></a>00418 }
<a name="l00419"></a>00419 
<a name="l00420"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#afc1a26d29e4e0f928d64c47c3354c754">00420</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ac37a158e5a982429de39cdc24503a94d">ED_operator_editsurf</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00421"></a>00421 {
<a name="l00422"></a>00422     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00423"></a>00423     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#ae247d3ec6e691b7752d8a90065428ecb">OB_SURF</a>)
<a name="l00424"></a>00424         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != ((<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editnurb;
<a name="l00425"></a>00425     <span class="keywordflow">return</span> 0;
<a name="l00426"></a>00426 }
<a name="l00427"></a>00427 
<a name="l00428"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab2bf2df7cea189d71e738615ddeec29c">00428</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#acb8918b73f3b1c3668e9ce822453f64d">ED_operator_editfont</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00429"></a>00429 {
<a name="l00430"></a>00430     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00431"></a>00431     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a1a94162b6fc469957966a01d41ff71d6">OB_FONT</a>)
<a name="l00432"></a>00432         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != ((<a class="code" href="../../da/d10/structCurve.html">Curve</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editfont;
<a name="l00433"></a>00433     <span class="keywordflow">return</span> 0;
<a name="l00434"></a>00434 }
<a name="l00435"></a>00435 
<a name="l00436"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a8035cfce528bc3e9d7a9de355fb8e6c7">00436</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#abb793d24391dd7cd05043699a535ea32">ED_operator_editlattice</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a648672abc238f500c884f10b9416cb27">OB_LATTICE</a>)
<a name="l00440"></a>00440         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != ((<a class="code" href="../../dd/d40/structLattice.html">Lattice</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editlatt;
<a name="l00441"></a>00441     <span class="keywordflow">return</span> 0;
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00444"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1b0daeefa55576fe413ee18fda06e994">00444</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#ae5285ab25189df2c5877ea007c9d387e">ED_operator_editmball</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446     <a class="code" href="../../de/de7/structObject.html">Object</a> *obedit= <a class="code" href="../../df/d01/BKE__context_8h.html#a323e283348470c038f3dd98de298a76b">CTX_data_edit_object</a>(C);
<a name="l00447"></a>00447     <span class="keywordflow">if</span> (obedit &amp;&amp; obedit-&gt;<a class="code" href="../../de/de7/structObject.html#a8137cf4265bcaaf2fc7c91a9ccd8e4f4">type</a>==<a class="code" href="../../d9/dd9/DNA__object__types_8h.html#a046d883c32490b5c5ca4c5e7b6504e35">OB_MBALL</a>)
<a name="l00448"></a>00448         <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != ((<a class="code" href="../../d3/d6c/structMetaBall.html">MetaBall</a> *)obedit-&gt;<a class="code" href="../../de/de7/structObject.html#af121d9ecf1402708a17302a8a615cbfe">data</a>)-&gt;editelems;
<a name="l00449"></a>00449     <span class="keywordflow">return</span> 0;
<a name="l00450"></a>00450 }
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 <span class="comment">/* *************************** action zone operator ************************** */</span>
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="comment">/* operator state vars used:  </span>
<a name="l00455"></a>00455 <span class="comment"> * none</span>
<a name="l00456"></a>00456 <span class="comment"> * </span>
<a name="l00457"></a>00457 <span class="comment"> * functions:</span>
<a name="l00458"></a>00458 <span class="comment"> * </span>
<a name="l00459"></a>00459 <span class="comment"> * apply() set actionzone event</span>
<a name="l00460"></a>00460 <span class="comment"> * </span>
<a name="l00461"></a>00461 <span class="comment"> * exit()   free customdata</span>
<a name="l00462"></a>00462 <span class="comment"> * </span>
<a name="l00463"></a>00463 <span class="comment"> * callbacks:</span>
<a name="l00464"></a>00464 <span class="comment"> * </span>
<a name="l00465"></a>00465 <span class="comment"> * exec()   never used</span>
<a name="l00466"></a>00466 <span class="comment"> * </span>
<a name="l00467"></a>00467 <span class="comment"> * invoke() check if in zone  </span>
<a name="l00468"></a>00468 <span class="comment"> * add customdata, put mouseco and area in it</span>
<a name="l00469"></a>00469 <span class="comment"> * add modal handler</span>
<a name="l00470"></a>00470 <span class="comment"> * </span>
<a name="l00471"></a>00471 <span class="comment"> * modal()  accept modal events while doing it</span>
<a name="l00472"></a>00472 <span class="comment"> * call apply() with gesture info, active window, nonactive window</span>
<a name="l00473"></a>00473 <span class="comment"> * call exit() and remove handler when LMB confirm</span>
<a name="l00474"></a>00474 <span class="comment"> */</span>
<a name="l00475"></a>00475 
<a name="l00476"></a><a class="code" href="../../d1/dd4/structsActionzoneData.html">00476</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> {
<a name="l00477"></a><a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">00477</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>, *<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>;
<a name="l00478"></a><a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">00478</a>     <a class="code" href="../../d8/dfd/structAZone.html">AZone</a> *<a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">az</a>;
<a name="l00479"></a><a class="code" href="../../d1/dd4/structsActionzoneData.html#aab976fc282248e19f5032970a548db0f">00479</a>     <span class="keywordtype">int</span> <a class="code" href="../../d1/dd4/structsActionzoneData.html#aad696b2529a5ca8e4d00ff21be9db378">x</a>, <a class="code" href="../../d1/dd4/structsActionzoneData.html#aab976fc282248e19f5032970a548db0f">y</a>, <a class="code" href="../../d1/dd4/structsActionzoneData.html#a14ab0826bafc1f2423438b9c3e07eec5">gesture_dir</a>, <a class="code" href="../../d1/dd4/structsActionzoneData.html#a98658addbd425cde75bedc9172cc1611">modifier</a>;
<a name="l00480"></a>00480 } <a class="code" href="../../d6/d78/screen__ops_8c.html#a32cf9e3d2cde7fb891e0d54e4934bc2a">sActionzoneData</a>;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="comment">/* used by other operators too */</span>
<a name="l00483"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">00483</a> <span class="keyword">static</span> <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">screen_areahascursor</a>(<a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *scr, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)
<a name="l00484"></a>00484 {
<a name="l00485"></a>00485     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00486"></a>00486     sa= scr-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l00487"></a>00487     <span class="keywordflow">while</span> (sa) {
<a name="l00488"></a>00488         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d44/BLI__rect_8h.html#a1242dd13fb888a0146765107474fffb4">BLI_in_rcti</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>, x, y)) <span class="keywordflow">break</span>;
<a name="l00489"></a>00489         sa= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>;
<a name="l00490"></a>00490     }
<a name="l00491"></a>00491     
<a name="l00492"></a>00492     <span class="keywordflow">return</span> sa;
<a name="l00493"></a>00493 }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 <span class="comment">/* quick poll to save operators to be created and handled */</span>
<a name="l00496"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a5281cfde7ccb0bf39d5d8940c894adbd">00496</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a5281cfde7ccb0bf39d5d8940c894adbd">actionzone_area_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win= <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C);
<a name="l00499"></a>00499     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00500"></a>00500     
<a name="l00501"></a>00501     <span class="keywordflow">if</span> (sa &amp;&amp; win) {
<a name="l00502"></a>00502         <a class="code" href="../../d8/dfd/structAZone.html">AZone</a> *az;
<a name="l00503"></a>00503         <span class="keywordtype">int</span> x= win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a1c950f3f8bc3e99973abac8e510d0835">eventstate</a>-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>;
<a name="l00504"></a>00504         <span class="keywordtype">int</span> y= win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a1c950f3f8bc3e99973abac8e510d0835">eventstate</a>-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>;
<a name="l00505"></a>00505         
<a name="l00506"></a>00506         <span class="keywordflow">for</span> (az= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a2abe64269b37637b8c7e75ac81ba9e4e">actionzones</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; az; az= az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a7fb39ae1324b7cd179fd443809aaf904">next</a>)
<a name="l00507"></a>00507             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d44/BLI__rect_8h.html#a1242dd13fb888a0146765107474fffb4">BLI_in_rcti</a>(&amp;az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a52af977af3f3c4b6491a0715f81c372c">rect</a>, x, y))
<a name="l00508"></a>00508                 <span class="keywordflow">return</span> 1;
<a name="l00509"></a>00509     }   
<a name="l00510"></a>00510     <span class="keywordflow">return</span> 0;
<a name="l00511"></a>00511 }
<a name="l00512"></a>00512 
<a name="l00513"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#af68a2fc3a831104b4f36dbf2cdef8c29">00513</a> <a class="code" href="../../d8/dfd/structAZone.html">AZone</a> *<a class="code" href="../../d7/de3/screen__intern_8h.html#a1f9f9763e4f272830d0291eea2b367ef">is_in_area_actionzone</a>(<a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)
<a name="l00514"></a>00514 {
<a name="l00515"></a>00515     <a class="code" href="../../d8/dfd/structAZone.html">AZone</a> *az= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00516"></a>00516     
<a name="l00517"></a>00517     <span class="keywordflow">for</span> (az= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a2abe64269b37637b8c7e75ac81ba9e4e">actionzones</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; az; az= az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a7fb39ae1324b7cd179fd443809aaf904">next</a>) {
<a name="l00518"></a>00518         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d44/BLI__rect_8h.html#a1242dd13fb888a0146765107474fffb4">BLI_in_rcti</a>(&amp;az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a52af977af3f3c4b6491a0715f81c372c">rect</a>, x, y)) {
<a name="l00519"></a>00519             <span class="keywordflow">if</span> (az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a396c201c32f6002fb549726586b8b480">type</a> == <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a045bd71c179c59e786eb4e3cd384e423">AZONE_AREA</a>) {
<a name="l00520"></a>00520                 <span class="comment">/* no triangle intersect but a hotspot circle based on corner */</span>
<a name="l00521"></a>00521                 <span class="keywordtype">int</span> radius= (x-az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a9f70cdef25bc186aeeb1767ee71efbaf">x1</a>)*(x-az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a9f70cdef25bc186aeeb1767ee71efbaf">x1</a>) + (y-az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#ad5104ff0a91b2becd68e8b74d624f31e">y1</a>)*(y-az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#ad5104ff0a91b2becd68e8b74d624f31e">y1</a>);
<a name="l00522"></a>00522                 
<a name="l00523"></a>00523                 <span class="keywordflow">if</span> (radius &lt;= <a class="code" href="../../d7/de3/screen__intern_8h.html#ab29158f60e9d20f2cf8ce2c1a34e2f9b">AZONESPOT</a>*<a class="code" href="../../d7/de3/screen__intern_8h.html#ab29158f60e9d20f2cf8ce2c1a34e2f9b">AZONESPOT</a>)
<a name="l00524"></a>00524                     <span class="keywordflow">break</span>;
<a name="l00525"></a>00525             }
<a name="l00526"></a>00526             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a396c201c32f6002fb549726586b8b480">type</a> == <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a7a79069a208a479cdd52f066db18a775">AZONE_REGION</a>) {
<a name="l00527"></a>00527                 <span class="keywordflow">break</span>;
<a name="l00528"></a>00528             }
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531     
<a name="l00532"></a>00532     <span class="keywordflow">return</span> az;
<a name="l00533"></a>00533 }
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 
<a name="l00536"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">00536</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(<a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00537"></a>00537 {
<a name="l00538"></a>00538     <span class="keywordflow">if</span> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>)
<a name="l00539"></a>00539         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>);
<a name="l00540"></a>00540     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00541"></a>00541 }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">/* send EVT_ACTIONZONE event */</span>
<a name="l00544"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a497b9ad819eb88823459c7ce04259663">00544</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a497b9ad819eb88823459c7ce04259663">actionzone_apply</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <span class="keywordtype">int</span> type)
<a name="l00545"></a>00545 {
<a name="l00546"></a>00546     <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> event;
<a name="l00547"></a>00547     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win= <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C);
<a name="l00548"></a>00548     <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00549"></a>00549     
<a name="l00550"></a>00550     sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a98658addbd425cde75bedc9172cc1611">modifier</a>= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;modifier&quot;</span>);
<a name="l00551"></a>00551     
<a name="l00552"></a>00552     <span class="keyword">event</span>= *(win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a1c950f3f8bc3e99973abac8e510d0835">eventstate</a>);  <span class="comment">/* XXX huh huh? make api call */</span>
<a name="l00553"></a>00553     <span class="keywordflow">if</span> (type==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#a045bd71c179c59e786eb4e3cd384e423">AZONE_AREA</a>)
<a name="l00554"></a>00554         <span class="keyword">event</span>.type= <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>;
<a name="l00555"></a>00555     <span class="keywordflow">else</span>
<a name="l00556"></a>00556         <span class="keyword">event</span>.type= <a class="code" href="../../d1/d40/wm__event__types_8h.html#a8f52029c9e633df20722c29f39c4efde">EVT_ACTIONZONE_REGION</a>;
<a name="l00557"></a>00557     <span class="keyword">event</span>.customdata= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00558"></a>00558     <span class="keyword">event</span>.customdatafree= <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00559"></a>00559     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00560"></a>00560     
<a name="l00561"></a>00561     <a class="code" href="../../df/db0/wm__event__system_8c.html#abfe9bdb8f6493c4a571052e7270eca37">wm_event_add</a>(win, &amp;event);
<a name="l00562"></a>00562 }
<a name="l00563"></a>00563 
<a name="l00564"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ae9a8a24d3c1542161dc5baa0eaba654e">00564</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ae9a8a24d3c1542161dc5baa0eaba654e">actionzone_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00565"></a>00565 {
<a name="l00566"></a>00566     <a class="code" href="../../d8/dfd/structAZone.html">AZone</a> *az= <a class="code" href="../../d7/de3/screen__intern_8h.html#a1f9f9763e4f272830d0291eea2b367ef">is_in_area_actionzone</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C), event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l00567"></a>00567     <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad;
<a name="l00568"></a>00568     
<a name="l00569"></a>00569     <span class="comment">/* quick escape */</span>
<a name="l00570"></a>00570     <span class="keywordflow">if</span> (az==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00571"></a>00571         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l00572"></a>00572     
<a name="l00573"></a>00573     <span class="comment">/* ok we do the actionzone */</span>
<a name="l00574"></a>00574     sad= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a>), <span class="stringliteral">&quot;sActionzoneData&quot;</span>);
<a name="l00575"></a>00575     sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00576"></a>00576     sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">az</a>= az;
<a name="l00577"></a>00577     sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aad696b2529a5ca8e4d00ff21be9db378">x</a>= <span class="keyword">event</span>-&gt;x; sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aab976fc282248e19f5032970a548db0f">y</a>= <span class="keyword">event</span>-&gt;y;
<a name="l00578"></a>00578     
<a name="l00579"></a>00579     <span class="comment">/* region azone directly reacts on mouse clicks */</span>
<a name="l00580"></a>00580     <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">az</a>-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a396c201c32f6002fb549726586b8b480">type</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#a7a79069a208a479cdd52f066db18a775">AZONE_REGION</a>) {
<a name="l00581"></a>00581         <a class="code" href="../../d6/d78/screen__ops_8c.html#a497b9ad819eb88823459c7ce04259663">actionzone_apply</a>(C, op, <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a7a79069a208a479cdd52f066db18a775">AZONE_REGION</a>);
<a name="l00582"></a>00582         <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(op);
<a name="l00583"></a>00583         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00584"></a>00584     }
<a name="l00585"></a>00585     <span class="keywordflow">else</span> {
<a name="l00586"></a>00586         <span class="comment">/* add modal handler */</span>
<a name="l00587"></a>00587         <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l00588"></a>00588         
<a name="l00589"></a>00589         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591 }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 
<a name="l00594"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#abe0078e6746d870c7fa27d0de682564a">00594</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#abe0078e6746d870c7fa27d0de682564a">actionzone_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00595"></a>00595 {
<a name="l00596"></a>00596     <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00597"></a>00597     <span class="keywordtype">int</span> deltax, deltay;
<a name="l00598"></a>00598     <span class="keywordtype">int</span> mindelta= sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">az</a>-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a396c201c32f6002fb549726586b8b480">type</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#a7a79069a208a479cdd52f066db18a775">AZONE_REGION</a>?1:12;
<a name="l00599"></a>00599     
<a name="l00600"></a>00600     <span class="keywordflow">switch</span>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>) {
<a name="l00601"></a>00601         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#aa58b8b831d49bfef312f9ae99d742aae">MOUSEMOVE</a>:
<a name="l00602"></a>00602             <span class="comment">/* calculate gesture direction */</span>
<a name="l00603"></a>00603             deltax= (<span class="keyword">event</span>-&gt;x - sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aad696b2529a5ca8e4d00ff21be9db378">x</a>);
<a name="l00604"></a>00604             deltay= (<span class="keyword">event</span>-&gt;y - sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aab976fc282248e19f5032970a548db0f">y</a>);
<a name="l00605"></a>00605             
<a name="l00606"></a>00606             <span class="keywordflow">if</span> (deltay &gt; <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(deltax))
<a name="l00607"></a>00607                 sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a14ab0826bafc1f2423438b9c3e07eec5">gesture_dir</a>= <span class="charliteral">&#39;n&#39;</span>;
<a name="l00608"></a>00608             <span class="keywordflow">else</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (deltax &gt; <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(deltay))
<a name="l00609"></a>00609                 sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a14ab0826bafc1f2423438b9c3e07eec5">gesture_dir</a>= <span class="charliteral">&#39;e&#39;</span>;
<a name="l00610"></a>00610             <span class="keywordflow">else</span> <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (deltay &lt; -<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(deltax))
<a name="l00611"></a>00611                 sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a14ab0826bafc1f2423438b9c3e07eec5">gesture_dir</a>= <span class="charliteral">&#39;s&#39;</span>;
<a name="l00612"></a>00612             <span class="keywordflow">else</span>
<a name="l00613"></a>00613                 sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a14ab0826bafc1f2423438b9c3e07eec5">gesture_dir</a>= <span class="charliteral">&#39;w&#39;</span>;
<a name="l00614"></a>00614             
<a name="l00615"></a>00615             <span class="comment">/* gesture is large enough? */</span>
<a name="l00616"></a>00616             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(deltax) &gt; mindelta || <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(deltay) &gt; mindelta) {
<a name="l00617"></a>00617                 
<a name="l00618"></a>00618                 <span class="comment">/* second area, for join */</span>
<a name="l00619"></a>00619                 sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>= <a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">screen_areahascursor</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l00620"></a>00620                 <span class="comment">/* apply sends event */</span>
<a name="l00621"></a>00621                 <a class="code" href="../../d6/d78/screen__ops_8c.html#a497b9ad819eb88823459c7ce04259663">actionzone_apply</a>(C, op, sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">az</a>-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a396c201c32f6002fb549726586b8b480">type</a>);
<a name="l00622"></a>00622                 <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(op);
<a name="l00623"></a>00623                 
<a name="l00624"></a>00624                 <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00625"></a>00625             }
<a name="l00626"></a>00626             <span class="keywordflow">break</span>;
<a name="l00627"></a>00627         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>:
<a name="l00628"></a>00628             <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(op);
<a name="l00629"></a>00629             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00630"></a>00630         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>:             
<a name="l00631"></a>00631             <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(op);
<a name="l00632"></a>00632             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00633"></a>00633             
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635     
<a name="l00636"></a>00636     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a34a4701fae2df016b5070a0a31eacede">00639</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a34a4701fae2df016b5070a0a31eacede">actionzone_cancel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>), <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00640"></a>00640 {
<a name="l00641"></a>00641     <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(op);
<a name="l00642"></a>00642 
<a name="l00643"></a>00643     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00644"></a>00644 }
<a name="l00645"></a>00645 
<a name="l00646"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a45c3bdd48644c2c1e2a23d3e7563121b">00646</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a45c3bdd48644c2c1e2a23d3e7563121b">SCREEN_OT_actionzone</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00647"></a>00647 {
<a name="l00648"></a>00648     <span class="comment">/* identifiers */</span>
<a name="l00649"></a>00649     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Handle area action zones&quot;</span>;
<a name="l00650"></a>00650     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Handle area action zones for mouse actions/gestures&quot;</span>;
<a name="l00651"></a>00651     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_actionzone&quot;</span>;
<a name="l00652"></a>00652     
<a name="l00653"></a>00653     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ae9a8a24d3c1542161dc5baa0eaba654e">actionzone_invoke</a>;
<a name="l00654"></a>00654     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#abe0078e6746d870c7fa27d0de682564a">actionzone_modal</a>;
<a name="l00655"></a>00655     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a5281cfde7ccb0bf39d5d8940c894adbd">actionzone_area_poll</a>;
<a name="l00656"></a>00656     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a34a4701fae2df016b5070a0a31eacede">actionzone_cancel</a>;
<a name="l00657"></a>00657     
<a name="l00658"></a>00658     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a2458c730dbcabf67cc8917d8de127bab">OPTYPE_BLOCKING</a>;
<a name="l00659"></a>00659     
<a name="l00660"></a>00660     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;modifier&quot;</span>, 0, 0, 2, <span class="stringliteral">&quot;Modifier&quot;</span>, <span class="stringliteral">&quot;Modifier state&quot;</span>, 0, 2);
<a name="l00661"></a>00661 }
<a name="l00662"></a>00662 
<a name="l00663"></a>00663 <span class="comment">/* ************** swap area operator *********************************** */</span>
<a name="l00664"></a>00664 
<a name="l00665"></a>00665 <span class="comment">/* operator state vars used:  </span>
<a name="l00666"></a>00666 <span class="comment"> * sa1      start area</span>
<a name="l00667"></a>00667 <span class="comment"> * sa2      area to swap with</span>
<a name="l00668"></a>00668 <span class="comment"> * </span>
<a name="l00669"></a>00669 <span class="comment"> * functions:</span>
<a name="l00670"></a>00670 <span class="comment"> * </span>
<a name="l00671"></a>00671 <span class="comment"> * init()   set custom data for operator, based on actionzone event custom data</span>
<a name="l00672"></a>00672 <span class="comment"> * </span>
<a name="l00673"></a>00673 <span class="comment"> * cancel() cancel the operator</span>
<a name="l00674"></a>00674 <span class="comment"> * </span>
<a name="l00675"></a>00675 <span class="comment"> * exit()   cleanup, send notifier</span>
<a name="l00676"></a>00676 <span class="comment"> * </span>
<a name="l00677"></a>00677 <span class="comment"> * callbacks:</span>
<a name="l00678"></a>00678 <span class="comment"> * </span>
<a name="l00679"></a>00679 <span class="comment"> * invoke() gets called on shift+lmb drag in actionzone</span>
<a name="l00680"></a>00680 <span class="comment"> * call init(), add handler</span>
<a name="l00681"></a>00681 <span class="comment"> * </span>
<a name="l00682"></a>00682 <span class="comment"> * modal()  accept modal events while doing it</span>
<a name="l00683"></a>00683 <span class="comment"> */</span>
<a name="l00684"></a>00684 
<a name="l00685"></a><a class="code" href="../../df/de0/structsAreaSwapData.html">00685</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../df/de0/structsAreaSwapData.html">sAreaSwapData</a> {
<a name="l00686"></a><a class="code" href="../../df/de0/structsAreaSwapData.html#aa1855fa73c2c175b5ab21fed148b7306">00686</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../df/de0/structsAreaSwapData.html#a12fd08782a02e7c9227004d18787295f">sa1</a>, *<a class="code" href="../../df/de0/structsAreaSwapData.html#aa1855fa73c2c175b5ab21fed148b7306">sa2</a>;
<a name="l00687"></a>00687 } <a class="code" href="../../d6/d78/screen__ops_8c.html#af484c6bc9f3ec68c15b70cc3add00277">sAreaSwapData</a>;
<a name="l00688"></a>00688 
<a name="l00689"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1fa61addd30c30b758d55323fc63a29c">00689</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a1fa61addd30c30b758d55323fc63a29c">area_swap_init</a>(<a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00690"></a>00690 {
<a name="l00691"></a>00691     <a class="code" href="../../df/de0/structsAreaSwapData.html">sAreaSwapData</a> *sd= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00692"></a>00692     <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= <span class="keyword">event</span>-&gt;customdata;
<a name="l00693"></a>00693     
<a name="l00694"></a>00694     <span class="keywordflow">if</span> (sad==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00695"></a>00695         <span class="keywordflow">return</span> 0;
<a name="l00696"></a>00696     
<a name="l00697"></a>00697     sd= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../df/de0/structsAreaSwapData.html">sAreaSwapData</a>), <span class="stringliteral">&quot;sAreaSwapData&quot;</span>);
<a name="l00698"></a>00698     sd-&gt;<a class="code" href="../../df/de0/structsAreaSwapData.html#a12fd08782a02e7c9227004d18787295f">sa1</a>= sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>;
<a name="l00699"></a>00699     sd-&gt;<a class="code" href="../../df/de0/structsAreaSwapData.html#aa1855fa73c2c175b5ab21fed148b7306">sa2</a>= sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>;
<a name="l00700"></a>00700     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= sd;
<a name="l00701"></a>00701     
<a name="l00702"></a>00702     <span class="keywordflow">return</span> 1;
<a name="l00703"></a>00703 }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 
<a name="l00706"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aa8000b0884cd70b19742ed878c1595ca">00706</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aa8000b0884cd70b19742ed878c1595ca">area_swap_exit</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00707"></a>00707 {
<a name="l00708"></a>00708     <a class="code" href="../../de/d3c/wm__cursors_8c.html#ab8500ccfbffb6b57f4e0645e0f9a4759">WM_cursor_restore</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C));
<a name="l00709"></a>00709     <span class="keywordflow">if</span> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>)
<a name="l00710"></a>00710         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>);
<a name="l00711"></a>00711     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00712"></a>00712 }
<a name="l00713"></a>00713 
<a name="l00714"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a37990ea00a76fad1bd73350777c77ab5">00714</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a37990ea00a76fad1bd73350777c77ab5">area_swap_cancel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00715"></a>00715 {
<a name="l00716"></a>00716     <a class="code" href="../../d6/d78/screen__ops_8c.html#aa8000b0884cd70b19742ed878c1595ca">area_swap_exit</a>(C, op);
<a name="l00717"></a>00717     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00720"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a73f92eac80ab26e1d7acba4031f65100">00720</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a73f92eac80ab26e1d7acba4031f65100">area_swap_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00721"></a>00721 {
<a name="l00722"></a>00722     
<a name="l00723"></a>00723     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#a1fa61addd30c30b758d55323fc63a29c">area_swap_init</a>(op, event))
<a name="l00724"></a>00724         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l00725"></a>00725     
<a name="l00726"></a>00726     <span class="comment">/* add modal handler */</span>
<a name="l00727"></a>00727     <a class="code" href="../../de/d3c/wm__cursors_8c.html#a04d16b0d6c38bc563f9d78f47f1ba7ed">WM_cursor_modal</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C), <a class="code" href="../../db/da6/wm__cursors_8h.html#a737c1bdca78a4eec48fa026fcca3dd9baa73aa488758b4ffcaef79e5d686175f7">BC_SWAPAREA_CURSOR</a>);
<a name="l00728"></a>00728     <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l00729"></a>00729     
<a name="l00730"></a>00730     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l00731"></a>00731     
<a name="l00732"></a>00732 }
<a name="l00733"></a>00733 
<a name="l00734"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#add6e51a37d0113b9006e2f191acbcdfe">00734</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#add6e51a37d0113b9006e2f191acbcdfe">area_swap_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00735"></a>00735 {
<a name="l00736"></a>00736     <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00737"></a>00737     
<a name="l00738"></a>00738     <span class="keywordflow">switch</span>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>) {
<a name="l00739"></a>00739         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#aa58b8b831d49bfef312f9ae99d742aae">MOUSEMOVE</a>:
<a name="l00740"></a>00740             <span class="comment">/* second area, for join */</span>
<a name="l00741"></a>00741             sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>= <a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">screen_areahascursor</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l00742"></a>00742             <span class="keywordflow">break</span>;
<a name="l00743"></a>00743         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>: <span class="comment">/* release LMB */</span>
<a name="l00744"></a>00744             <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a>==<a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>) {
<a name="l00745"></a>00745                 <span class="keywordflow">if</span> (!sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a> == sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>) {
<a name="l00746"></a>00746                     
<a name="l00747"></a>00747                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a37990ea00a76fad1bd73350777c77ab5">area_swap_cancel</a>(C, op);
<a name="l00748"></a>00748                 }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>);
<a name="l00751"></a>00751                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>);
<a name="l00752"></a>00752 
<a name="l00753"></a>00753                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ae180c63de8b366a7816ed54a131e2d53">ED_area_swapspace</a>(C, sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>, sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>);
<a name="l00754"></a>00754                 
<a name="l00755"></a>00755                 <a class="code" href="../../d6/d78/screen__ops_8c.html#aa8000b0884cd70b19742ed878c1595ca">area_swap_exit</a>(C, op);
<a name="l00756"></a>00756                 
<a name="l00757"></a>00757                 <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00758"></a>00758                 
<a name="l00759"></a>00759                 <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00760"></a>00760             }
<a name="l00761"></a>00761             <span class="keywordflow">break</span>;
<a name="l00762"></a>00762             
<a name="l00763"></a>00763         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>:
<a name="l00764"></a>00764             <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a37990ea00a76fad1bd73350777c77ab5">area_swap_cancel</a>(C, op);
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l00767"></a>00767 }
<a name="l00768"></a>00768 
<a name="l00769"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aa7faf0606a0f3d793bd846c51f1d95c6">00769</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aa7faf0606a0f3d793bd846c51f1d95c6">SCREEN_OT_area_swap</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00770"></a>00770 {
<a name="l00771"></a>00771     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Swap areas&quot;</span>;
<a name="l00772"></a>00772     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Swap selected areas screen positions&quot;</span>;
<a name="l00773"></a>00773     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_area_swap&quot;</span>;
<a name="l00774"></a>00774     
<a name="l00775"></a>00775     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a73f92eac80ab26e1d7acba4031f65100">area_swap_invoke</a>;
<a name="l00776"></a>00776     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#add6e51a37d0113b9006e2f191acbcdfe">area_swap_modal</a>;
<a name="l00777"></a>00777     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>;
<a name="l00778"></a>00778     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a37990ea00a76fad1bd73350777c77ab5">area_swap_cancel</a>;
<a name="l00779"></a>00779     
<a name="l00780"></a>00780     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a2458c730dbcabf67cc8917d8de127bab">OPTYPE_BLOCKING</a>;
<a name="l00781"></a>00781 }
<a name="l00782"></a>00782 
<a name="l00783"></a>00783 <span class="comment">/* *********** Duplicate area as new window operator ****************** */</span>
<a name="l00784"></a>00784 
<a name="l00785"></a>00785 <span class="comment">/* operator callback */</span>
<a name="l00786"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a4fa0235b1b48c596d46430568c1c2b59">00786</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a4fa0235b1b48c596d46430568c1c2b59">area_dupli_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l00787"></a>00787 {
<a name="l00788"></a>00788     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *newwin, *win;
<a name="l00789"></a>00789     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *newsc, *sc;
<a name="l00790"></a>00790     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l00791"></a>00791     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> rect;
<a name="l00792"></a>00792     
<a name="l00793"></a>00793     win= <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C);
<a name="l00794"></a>00794     sc= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l00795"></a>00795     sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l00796"></a>00796     
<a name="l00797"></a>00797     <span class="comment">/* XXX hrmf! */</span>
<a name="l00798"></a>00798     <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>==<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>) {
<a name="l00799"></a>00799         <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= <span class="keyword">event</span>-&gt;customdata;
<a name="l00800"></a>00800         
<a name="l00801"></a>00801         <span class="keywordflow">if</span> (sad==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00802"></a>00802             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l00803"></a>00803         
<a name="l00804"></a>00804         sa= sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>;
<a name="l00805"></a>00805     }
<a name="l00806"></a>00806     
<a name="l00807"></a>00807     <span class="comment">/*  poll() checks area context, but we don&#39;t accept full-area windows */</span>
<a name="l00808"></a>00808     <span class="keywordflow">if</span> (sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#afe2ef870210be87541acaac1ce677776">full</a> != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab5f98947e6f48dad2b0184d7d97bc365">SCREENNORMAL</a>) {
<a name="l00809"></a>00809         <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>==<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>)
<a name="l00810"></a>00810             <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(op);
<a name="l00811"></a>00811         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l00812"></a>00812     }
<a name="l00813"></a>00813     
<a name="l00814"></a>00814     <span class="comment">/* adds window to WM */</span>
<a name="l00815"></a>00815     rect= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>;
<a name="l00816"></a>00816     <a class="code" href="../../d5/d44/BLI__rect_8h.html#a17840fabe97064de133e44216f7cc9c3">BLI_translate_rcti</a>(&amp;rect, win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a226ce379ebcc0b691d3278c6d20e313b">posx</a>, win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#ae754b68a91f58a8541c1226b760ac9bb">posy</a>);
<a name="l00817"></a>00817     newwin= <a class="code" href="../../d7/d6e/wm__window_8c.html#a885d955105fff6afd5374556977f46c3">WM_window_open</a>(C, &amp;rect);
<a name="l00818"></a>00818     
<a name="l00819"></a>00819     <span class="comment">/* allocs new screen and adds to newly created window, using window size */</span>
<a name="l00820"></a>00820     newsc= <a class="code" href="../../d1/d12/ED__screen_8h.html#a9379b3ffb23e6992684baeba61ab2e76">ED_screen_add</a>(newwin, <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C), sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ac661d280cae6952ebc9f9c95279cf6f2">id</a>.<a class="code" href="../../d8/d7e/structID.html#ad43a3d119e40a8479518fd876781e692">name</a>+2);
<a name="l00821"></a>00821     newwin-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a5ec98a9e430fdc21a8d0f0b8dcc6ed05">screen</a>= newsc;
<a name="l00822"></a>00822     
<a name="l00823"></a>00823     <span class="comment">/* copy area to new screen */</span>
<a name="l00824"></a>00824     <a class="code" href="../../d1/d0d/area_8c.html#a36df79b09edb01547719640dd5796dcb">area_copy_data</a>((<a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *)newsc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>, sa, 0);
<a name="l00825"></a>00825 
<a name="l00826"></a>00826     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>((<a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *)newsc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>);
<a name="l00827"></a>00827 
<a name="l00828"></a>00828     <span class="comment">/* screen, areas init */</span>
<a name="l00829"></a>00829     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00830"></a>00830     
<a name="l00831"></a>00831     <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>==<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>)
<a name="l00832"></a>00832         <a class="code" href="../../d6/d78/screen__ops_8c.html#a131da7a187d78b2e26ae3dbc4c4b26ad">actionzone_exit</a>(op);
<a name="l00833"></a>00833     
<a name="l00834"></a>00834     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#abca82fd028ff20bdefb0e7198384f1f7">00837</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#abca82fd028ff20bdefb0e7198384f1f7">SCREEN_OT_area_dupli</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l00838"></a>00838 {
<a name="l00839"></a>00839     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Duplicate Area into New Window&quot;</span>;
<a name="l00840"></a>00840     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Duplicate selected area into new window&quot;</span>;
<a name="l00841"></a>00841     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_area_dupli&quot;</span>;
<a name="l00842"></a>00842     
<a name="l00843"></a>00843     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a4fa0235b1b48c596d46430568c1c2b59">area_dupli_invoke</a>;
<a name="l00844"></a>00844     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>;
<a name="l00845"></a>00845 }
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 
<a name="l00848"></a>00848 <span class="comment">/* ************** move area edge operator *********************************** */</span>
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <span class="comment">/* operator state vars used:  </span>
<a name="l00851"></a>00851 <span class="comment"> * x, y             mouse coord near edge</span>
<a name="l00852"></a>00852 <span class="comment"> * delta            movement of edge</span>
<a name="l00853"></a>00853 <span class="comment"> * </span>
<a name="l00854"></a>00854 <span class="comment"> * functions:</span>
<a name="l00855"></a>00855 <span class="comment"> * </span>
<a name="l00856"></a>00856 <span class="comment"> * init()   set default property values, find edge based on mouse coords, test</span>
<a name="l00857"></a>00857 <span class="comment"> * if the edge can be moved, select edges, calculate min and max movement</span>
<a name="l00858"></a>00858 <span class="comment"> * </span>
<a name="l00859"></a>00859 <span class="comment"> * apply()  apply delta on selection</span>
<a name="l00860"></a>00860 <span class="comment"> * </span>
<a name="l00861"></a>00861 <span class="comment"> * exit()   cleanup, send notifier</span>
<a name="l00862"></a>00862 <span class="comment"> * </span>
<a name="l00863"></a>00863 <span class="comment"> * cancel() cancel moving</span>
<a name="l00864"></a>00864 <span class="comment"> * </span>
<a name="l00865"></a>00865 <span class="comment"> * callbacks:</span>
<a name="l00866"></a>00866 <span class="comment"> * </span>
<a name="l00867"></a>00867 <span class="comment"> * exec()   execute without any user interaction, based on properties</span>
<a name="l00868"></a>00868 <span class="comment"> * call init(), apply(), exit()</span>
<a name="l00869"></a>00869 <span class="comment"> * </span>
<a name="l00870"></a>00870 <span class="comment"> * invoke() gets called on mouse click near edge</span>
<a name="l00871"></a>00871 <span class="comment"> * call init(), add handler</span>
<a name="l00872"></a>00872 <span class="comment"> * </span>
<a name="l00873"></a>00873 <span class="comment"> * modal()  accept modal events while doing it</span>
<a name="l00874"></a>00874 <span class="comment"> * call apply() with delta motion</span>
<a name="l00875"></a>00875 <span class="comment"> * call exit() and remove handler</span>
<a name="l00876"></a>00876 <span class="comment"> */</span>
<a name="l00877"></a>00877 
<a name="l00878"></a><a class="code" href="../../df/d11/structsAreaMoveData.html">00878</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../df/d11/structsAreaMoveData.html">sAreaMoveData</a> {
<a name="l00879"></a><a class="code" href="../../df/d11/structsAreaMoveData.html#af2091828a462787bfdad0ba4d04f05bc">00879</a>     <span class="keywordtype">int</span> <a class="code" href="../../df/d11/structsAreaMoveData.html#a7d54a38b2c06635b226304f3a945bbda">bigger</a>, <a class="code" href="../../df/d11/structsAreaMoveData.html#af7ce3231b2ddf3ae9c7faecb3e64ff2d">smaller</a>, <a class="code" href="../../df/d11/structsAreaMoveData.html#a1b6c1b2628d24fc3a04f1da49af1ac43">origval</a>, <a class="code" href="../../df/d11/structsAreaMoveData.html#af2091828a462787bfdad0ba4d04f05bc">step</a>;
<a name="l00880"></a><a class="code" href="../../df/d11/structsAreaMoveData.html#ae9c3cc4c334b147ab215f17933181578">00880</a>     <span class="keywordtype">char</span> <a class="code" href="../../df/d11/structsAreaMoveData.html#ae9c3cc4c334b147ab215f17933181578">dir</a>;
<a name="l00881"></a>00881 } <a class="code" href="../../d6/d78/screen__ops_8c.html#a7f5a921dc31a88eeabf18c7acd8f745e">sAreaMoveData</a>;
<a name="l00882"></a>00882 
<a name="l00883"></a>00883 <span class="comment">/* helper call to move area-edge, sets limits */</span>
<a name="l00884"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#af78e45068427f3480d5ef377c96b6521">00884</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#af78e45068427f3480d5ef377c96b6521">area_move_set_limits</a>(<a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> *bigger, <span class="keywordtype">int</span> *smaller)
<a name="l00885"></a>00885 {
<a name="l00886"></a>00886     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l00887"></a>00887     <span class="keywordtype">int</span> areaminy= <a class="code" href="../../d1/d12/ED__screen_8h.html#a691baf7c6b3655f45442d77ad5b283c2">ED_area_headersize</a>()+1;
<a name="l00888"></a>00888     
<a name="l00889"></a>00889     <span class="comment">/* we check all areas and test for free space with MINSIZE */</span>
<a name="l00890"></a>00890     *bigger= *smaller= 100000;
<a name="l00891"></a>00891     
<a name="l00892"></a>00892     <span class="keywordflow">for</span> (sa= sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l00893"></a>00893         <span class="keywordflow">if</span> (dir==<span class="charliteral">&#39;h&#39;</span>) {
<a name="l00894"></a>00894             <span class="keywordtype">int</span> y1= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a> - sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>-areaminy;
<a name="l00895"></a>00895             
<a name="l00896"></a>00896             <span class="comment">/* if top or down edge selected, test height */</span>
<a name="l00897"></a>00897             <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>)
<a name="l00898"></a>00898                 *bigger= <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(*bigger, y1);
<a name="l00899"></a>00899             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>)
<a name="l00900"></a>00900                 *smaller= <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(*smaller, y1);
<a name="l00901"></a>00901         }
<a name="l00902"></a>00902         <span class="keywordflow">else</span> {
<a name="l00903"></a>00903             <span class="keywordtype">int</span> x1= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a> - sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>-<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a6369333dbdbed753708c61054c88a1d0">AREAMINX</a>;
<a name="l00904"></a>00904             
<a name="l00905"></a>00905             <span class="comment">/* if left or right edge selected, test width */</span>
<a name="l00906"></a>00906             <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>)
<a name="l00907"></a>00907                 *bigger= <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(*bigger, x1);
<a name="l00908"></a>00908             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>)
<a name="l00909"></a>00909                 *smaller= <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#af5febfb026bad0c08e7a9f7ab7c2b8f0">MIN2</a>(*smaller, x1);
<a name="l00910"></a>00910         }
<a name="l00911"></a>00911     }
<a name="l00912"></a>00912 }
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 <span class="comment">/* validate selection inside screen, set variables OK */</span>
<a name="l00915"></a>00915 <span class="comment">/* return 0: init failed */</span>
<a name="l00916"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aba134a4887ee2ab173bf6d95069e88b9">00916</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aba134a4887ee2ab173bf6d95069e88b9">area_move_init</a> (<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00917"></a>00917 {
<a name="l00918"></a>00918     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l00919"></a>00919     <a class="code" href="../../dd/d31/structScrEdge.html">ScrEdge</a> *actedge;
<a name="l00920"></a>00920     <a class="code" href="../../df/d11/structsAreaMoveData.html">sAreaMoveData</a> *md;
<a name="l00921"></a>00921     <span class="keywordtype">int</span> x, y;
<a name="l00922"></a>00922     
<a name="l00923"></a>00923     <span class="comment">/* required properties */</span>
<a name="l00924"></a>00924     x= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;x&quot;</span>);
<a name="l00925"></a>00925     y= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;y&quot;</span>);
<a name="l00926"></a>00926     
<a name="l00927"></a>00927     <span class="comment">/* setup */</span>
<a name="l00928"></a>00928     actedge= <a class="code" href="../../da/dbc/screen__edit_8c.html#ad462a6663b9be9ed4230edfd68e81cb5">screen_find_active_scredge</a>(sc, x, y);
<a name="l00929"></a>00929     <span class="keywordflow">if</span> (actedge==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l00930"></a>00930     
<a name="l00931"></a>00931     md= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../df/d11/structsAreaMoveData.html">sAreaMoveData</a>), <span class="stringliteral">&quot;sAreaMoveData&quot;</span>);
<a name="l00932"></a>00932     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= md;
<a name="l00933"></a>00933     
<a name="l00934"></a>00934     md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#ae9c3cc4c334b147ab215f17933181578">dir</a>= <a class="code" href="../../da/dbc/screen__edit_8c.html#a7a9ae203ae84d9436052de27bfdbbc68">scredge_is_horizontal</a>(actedge)?<span class="charliteral">&#39;h&#39;</span>:<span class="charliteral">&#39;v&#39;</span>;
<a name="l00935"></a>00935     <span class="keywordflow">if</span> (md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#ae9c3cc4c334b147ab215f17933181578">dir</a>==<span class="charliteral">&#39;h&#39;</span>) md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#a1b6c1b2628d24fc3a04f1da49af1ac43">origval</a>= actedge-&gt;<a class="code" href="../../dd/d31/structScrEdge.html#a6c6a3d9a4ee7853b108d144ae1cb3180">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>;
<a name="l00936"></a>00936     <span class="keywordflow">else</span> md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#a1b6c1b2628d24fc3a04f1da49af1ac43">origval</a>= actedge-&gt;<a class="code" href="../../dd/d31/structScrEdge.html#a6c6a3d9a4ee7853b108d144ae1cb3180">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>;
<a name="l00937"></a>00937     
<a name="l00938"></a>00938     <a class="code" href="../../da/dbc/screen__edit_8c.html#a25b52c0c71667d00a9334225af230c51">select_connected_scredge</a>(sc, actedge);
<a name="l00939"></a>00939     <span class="comment">/* now all vertices with &#39;flag==1&#39; are the ones that can be moved. */</span>
<a name="l00940"></a>00940     
<a name="l00941"></a>00941     <a class="code" href="../../d6/d78/screen__ops_8c.html#af78e45068427f3480d5ef377c96b6521">area_move_set_limits</a>(sc, md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#ae9c3cc4c334b147ab215f17933181578">dir</a>, &amp;md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#a7d54a38b2c06635b226304f3a945bbda">bigger</a>, &amp;md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#af7ce3231b2ddf3ae9c7faecb3e64ff2d">smaller</a>);
<a name="l00942"></a>00942     
<a name="l00943"></a>00943     <span class="keywordflow">return</span> 1;
<a name="l00944"></a>00944 }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946 <span class="comment">/* moves selected screen edge amount of delta, used by split &amp; move */</span>
<a name="l00947"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a19a0f7c8d917285d3564190e2fbbc5c0">00947</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a19a0f7c8d917285d3564190e2fbbc5c0">area_move_apply_do</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <span class="keywordtype">int</span> origval, <span class="keywordtype">int</span> delta, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> bigger, <span class="keywordtype">int</span> smaller)
<a name="l00948"></a>00948 {
<a name="l00949"></a>00949     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win= <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C);
<a name="l00950"></a>00950     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l00951"></a>00951     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *v1;
<a name="l00952"></a>00952     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l00953"></a>00953     <span class="keywordtype">int</span> areaminy= <a class="code" href="../../d1/d12/ED__screen_8h.html#a691baf7c6b3655f45442d77ad5b283c2">ED_area_headersize</a>()+1;
<a name="l00954"></a>00954     
<a name="l00955"></a>00955     delta= <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a49a86f7d81f477961529de3add6d68ab">CLAMPIS</a>(delta, -smaller, bigger);
<a name="l00956"></a>00956     
<a name="l00957"></a>00957     <span class="keywordflow">for</span> (v1= sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#a7b16bb3f5dea1f6159af5be6ea599474">vertbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; v1; v1= v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a5926b403c5e00af979b2825ee76353eb">next</a>) {
<a name="l00958"></a>00958         <span class="keywordflow">if</span> (v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>) {
<a name="l00959"></a>00959             <span class="comment">/* that way a nice AREAGRID  */</span>
<a name="l00960"></a>00960             <span class="keywordflow">if</span> ((dir==<span class="charliteral">&#39;v&#39;</span>) &amp;&amp; v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>&gt;0 &amp;&amp; v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>&lt;win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#af8071bd36051fb5f5e0acd68e22523d0">sizex</a>-1) {
<a name="l00961"></a>00961                 v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>= origval + delta;
<a name="l00962"></a>00962                 <span class="keywordflow">if</span> (delta != bigger &amp;&amp; delta != -smaller) v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>-= (v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a> % <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af267f1a6298055ff8e414c5cb85208f8">AREAGRID</a>);
<a name="l00963"></a>00963             }
<a name="l00964"></a>00964             <span class="keywordflow">if</span> ((dir==<span class="charliteral">&#39;h&#39;</span>) &amp;&amp; v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>&gt;0 &amp;&amp; v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>&lt;win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a2284e3d27468a900b10ca04a97ef6975">sizey</a>-1) {
<a name="l00965"></a>00965                 v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>= origval + delta;
<a name="l00966"></a>00966                 
<a name="l00967"></a>00967                 v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>+= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af267f1a6298055ff8e414c5cb85208f8">AREAGRID</a>-1;
<a name="l00968"></a>00968                 v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>-= (v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a> % <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af267f1a6298055ff8e414c5cb85208f8">AREAGRID</a>);
<a name="l00969"></a>00969                 
<a name="l00970"></a>00970                 <span class="comment">/* prevent too small top header */</span>
<a name="l00971"></a>00971                 <span class="keywordflow">if</span> (v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a> &gt; win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a2284e3d27468a900b10ca04a97ef6975">sizey</a>-areaminy)
<a name="l00972"></a>00972                     v1-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>= win-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a2284e3d27468a900b10ca04a97ef6975">sizey</a>-areaminy;
<a name="l00973"></a>00973             }
<a name="l00974"></a>00974         }
<a name="l00975"></a>00975     }
<a name="l00976"></a>00976 
<a name="l00977"></a>00977     <span class="keywordflow">for</span> (sa= sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l00978"></a>00978         <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> || sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> || sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> || sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>)
<a name="l00979"></a>00979             <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l00980"></a>00980     }
<a name="l00981"></a>00981 
<a name="l00982"></a>00982     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); <span class="comment">/* redraw everything */</span>
<a name="l00983"></a>00983 }
<a name="l00984"></a>00984 
<a name="l00985"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a68cb5fa9bb43c8632ff4f071f014594d">00985</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a68cb5fa9bb43c8632ff4f071f014594d">area_move_apply</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00986"></a>00986 {
<a name="l00987"></a>00987     <a class="code" href="../../df/d11/structsAreaMoveData.html">sAreaMoveData</a> *md= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l00988"></a>00988     <span class="keywordtype">int</span> delta;
<a name="l00989"></a>00989     
<a name="l00990"></a>00990     delta= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;delta&quot;</span>);
<a name="l00991"></a>00991     <a class="code" href="../../d6/d78/screen__ops_8c.html#a19a0f7c8d917285d3564190e2fbbc5c0">area_move_apply_do</a>(C, md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#a1b6c1b2628d24fc3a04f1da49af1ac43">origval</a>, delta, md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#ae9c3cc4c334b147ab215f17933181578">dir</a>, md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#a7d54a38b2c06635b226304f3a945bbda">bigger</a>, md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#af7ce3231b2ddf3ae9c7faecb3e64ff2d">smaller</a>);
<a name="l00992"></a>00992 }
<a name="l00993"></a>00993 
<a name="l00994"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a37a12db1328dce158535084bca6b2fd0">00994</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a37a12db1328dce158535084bca6b2fd0">area_move_exit</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l00995"></a>00995 {
<a name="l00996"></a>00996     <span class="keywordflow">if</span> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>)
<a name="l00997"></a>00997         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>);
<a name="l00998"></a>00998     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00999"></a>00999     
<a name="l01000"></a>01000     <span class="comment">/* this makes sure aligned edges will result in aligned grabbing */</span>
<a name="l01001"></a>01001     <a class="code" href="../../da/dbc/screen__edit_8c.html#a5833bc9adacacd496ee1ce122eeb3802">removedouble_scrverts</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C));
<a name="l01002"></a>01002     <a class="code" href="../../da/dbc/screen__edit_8c.html#a69ed104f9640180b1041bf20343a276c">removedouble_scredges</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C));
<a name="l01003"></a>01003 }
<a name="l01004"></a>01004 
<a name="l01005"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab4ee0837be7051e5982036e4beaa20c9">01005</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab4ee0837be7051e5982036e4beaa20c9">area_move_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01006"></a>01006 {
<a name="l01007"></a>01007     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#aba134a4887ee2ab173bf6d95069e88b9">area_move_init</a>(C, op))
<a name="l01008"></a>01008         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01009"></a>01009     
<a name="l01010"></a>01010     <a class="code" href="../../d6/d78/screen__ops_8c.html#a68cb5fa9bb43c8632ff4f071f014594d">area_move_apply</a>(C, op);
<a name="l01011"></a>01011     <a class="code" href="../../d6/d78/screen__ops_8c.html#a37a12db1328dce158535084bca6b2fd0">area_move_exit</a>(C, op);
<a name="l01012"></a>01012     
<a name="l01013"></a>01013     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01014"></a>01014 }
<a name="l01015"></a>01015 
<a name="l01016"></a>01016 <span class="comment">/* interaction callback */</span>
<a name="l01017"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a5fb774ef7b9ef59c9fdb9c7a49ca38b6">01017</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a5fb774ef7b9ef59c9fdb9c7a49ca38b6">area_move_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01018"></a>01018 {
<a name="l01019"></a>01019     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;x&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>);
<a name="l01020"></a>01020     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;y&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l01021"></a>01021     
<a name="l01022"></a>01022     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#aba134a4887ee2ab173bf6d95069e88b9">area_move_init</a>(C, op)) 
<a name="l01023"></a>01023         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l01024"></a>01024     
<a name="l01025"></a>01025     <span class="comment">/* add temp handler */</span>
<a name="l01026"></a>01026     <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l01027"></a>01027     
<a name="l01028"></a>01028     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l01029"></a>01029 }
<a name="l01030"></a>01030 
<a name="l01031"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3ad2b7b5ca1cb48b24db1f48e1b819cf">01031</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a3ad2b7b5ca1cb48b24db1f48e1b819cf">area_move_cancel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01032"></a>01032 {
<a name="l01033"></a>01033     
<a name="l01034"></a>01034     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;delta&quot;</span>, 0);
<a name="l01035"></a>01035     <a class="code" href="../../d6/d78/screen__ops_8c.html#a68cb5fa9bb43c8632ff4f071f014594d">area_move_apply</a>(C, op);
<a name="l01036"></a>01036     <a class="code" href="../../d6/d78/screen__ops_8c.html#a37a12db1328dce158535084bca6b2fd0">area_move_exit</a>(C, op);
<a name="l01037"></a>01037     
<a name="l01038"></a>01038     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01039"></a>01039 }
<a name="l01040"></a>01040 
<a name="l01041"></a>01041 <span class="comment">/* modal callback for while moving edges */</span>
<a name="l01042"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ae53030008a805c6e28e0c8a1e9be405a">01042</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ae53030008a805c6e28e0c8a1e9be405a">area_move_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01043"></a>01043 {
<a name="l01044"></a>01044     <a class="code" href="../../df/d11/structsAreaMoveData.html">sAreaMoveData</a> *md= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l01045"></a>01045     <span class="keywordtype">int</span> delta, x, y;
<a name="l01046"></a>01046     
<a name="l01047"></a>01047     <span class="comment">/* execute the events */</span>
<a name="l01048"></a>01048     <span class="keywordflow">switch</span>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>) {
<a name="l01049"></a>01049         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#aa58b8b831d49bfef312f9ae99d742aae">MOUSEMOVE</a>:
<a name="l01050"></a>01050             
<a name="l01051"></a>01051             x= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;x&quot;</span>);
<a name="l01052"></a>01052             y= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;y&quot;</span>);
<a name="l01053"></a>01053             
<a name="l01054"></a>01054             delta= (md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#ae9c3cc4c334b147ab215f17933181578">dir</a> == <span class="charliteral">&#39;v&#39;</span>)? event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a> - x: event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a> - y;
<a name="l01055"></a>01055             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#af2091828a462787bfdad0ba4d04f05bc">step</a>) delta= delta - (delta % md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#af2091828a462787bfdad0ba4d04f05bc">step</a>);
<a name="l01056"></a>01056             <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;delta&quot;</span>, delta);
<a name="l01057"></a>01057             
<a name="l01058"></a>01058             <a class="code" href="../../d6/d78/screen__ops_8c.html#a68cb5fa9bb43c8632ff4f071f014594d">area_move_apply</a>(C, op);
<a name="l01059"></a>01059             <span class="keywordflow">break</span>;
<a name="l01060"></a>01060             
<a name="l01061"></a>01061         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a5ec351ea2051b0b75965a8ad0a7b4a6c">EVT_MODAL_MAP</a>:
<a name="l01062"></a>01062             
<a name="l01063"></a>01063             <span class="keywordflow">switch</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a>) {
<a name="l01064"></a>01064                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a1a9ee4a520928902e3a1d441305c699a">KM_MODAL_APPLY</a>:
<a name="l01065"></a>01065                     <a class="code" href="../../d6/d78/screen__ops_8c.html#a37a12db1328dce158535084bca6b2fd0">area_move_exit</a>(C, op);
<a name="l01066"></a>01066                     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01067"></a>01067                     
<a name="l01068"></a>01068                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a3777e41f316fcd855d7c869d14869def">KM_MODAL_CANCEL</a>:
<a name="l01069"></a>01069                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a3ad2b7b5ca1cb48b24db1f48e1b819cf">area_move_cancel</a>(C, op);
<a name="l01070"></a>01070                     
<a name="l01071"></a>01071                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aaa0c0c8c1b1c41ed211744018dcb8521">KM_MODAL_STEP10</a>:
<a name="l01072"></a>01072                     md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#af2091828a462787bfdad0ba4d04f05bc">step</a>= 10;
<a name="l01073"></a>01073                     <span class="keywordflow">break</span>;
<a name="l01074"></a>01074                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ace9d233d9ac6f851d53692b3287a4c00">KM_MODAL_STEP10_OFF</a>:
<a name="l01075"></a>01075                     md-&gt;<a class="code" href="../../df/d11/structsAreaMoveData.html#af2091828a462787bfdad0ba4d04f05bc">step</a>= 0;
<a name="l01076"></a>01076                     <span class="keywordflow">break</span>;
<a name="l01077"></a>01077             }
<a name="l01078"></a>01078     }
<a name="l01079"></a>01079     
<a name="l01080"></a>01080     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l01081"></a>01081 }
<a name="l01082"></a>01082 
<a name="l01083"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ad6e833a2ca4e8dd6d0a4eff008d80672">01083</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ad6e833a2ca4e8dd6d0a4eff008d80672">SCREEN_OT_area_move</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01084"></a>01084 {
<a name="l01085"></a>01085     <span class="comment">/* identifiers */</span>
<a name="l01086"></a>01086     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Move area edges&quot;</span>;
<a name="l01087"></a>01087     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Move selected area edges&quot;</span>;
<a name="l01088"></a>01088     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_area_move&quot;</span>;
<a name="l01089"></a>01089     
<a name="l01090"></a>01090     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ab4ee0837be7051e5982036e4beaa20c9">area_move_exec</a>;
<a name="l01091"></a>01091     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a5fb774ef7b9ef59c9fdb9c7a49ca38b6">area_move_invoke</a>;
<a name="l01092"></a>01092     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3ad2b7b5ca1cb48b24db1f48e1b819cf">area_move_cancel</a>;
<a name="l01093"></a>01093     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ae53030008a805c6e28e0c8a1e9be405a">area_move_modal</a>;
<a name="l01094"></a>01094     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#ae5cdecea23f3f367638265513ceaea20">ED_operator_screen_mainwinactive</a>; <span class="comment">/* when mouse is over area-edge */</span>
<a name="l01095"></a>01095     
<a name="l01096"></a>01096     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a2458c730dbcabf67cc8917d8de127bab">OPTYPE_BLOCKING</a>;
<a name="l01097"></a>01097     
<a name="l01098"></a>01098     <span class="comment">/* rna */</span>
<a name="l01099"></a>01099     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;x&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l01100"></a>01100     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;y&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l01101"></a>01101     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;delta&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Delta&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l01102"></a>01102 }
<a name="l01103"></a>01103 
<a name="l01104"></a>01104 <span class="comment">/* ************** split area operator *********************************** */</span>
<a name="l01105"></a>01105 
<a name="l01106"></a>01106 <span class="comment">/* </span>
<a name="l01107"></a>01107 <span class="comment"> * operator state vars:  </span>
<a name="l01108"></a>01108 <span class="comment"> * fac              spit point</span>
<a name="l01109"></a>01109 <span class="comment"> * dir              direction &#39;v&#39; or &#39;h&#39;</span>
<a name="l01110"></a>01110 <span class="comment"> * </span>
<a name="l01111"></a>01111 <span class="comment"> * operator customdata:</span>
<a name="l01112"></a>01112 <span class="comment"> * area             pointer to (active) area</span>
<a name="l01113"></a>01113 <span class="comment"> * x, y         last used mouse pos</span>
<a name="l01114"></a>01114 <span class="comment"> * (more, see below)</span>
<a name="l01115"></a>01115 <span class="comment"> * </span>
<a name="l01116"></a>01116 <span class="comment"> * functions:</span>
<a name="l01117"></a>01117 <span class="comment"> * </span>
<a name="l01118"></a>01118 <span class="comment"> * init()   set default property values, find area based on context</span>
<a name="l01119"></a>01119 <span class="comment"> * </span>
<a name="l01120"></a>01120 <span class="comment"> * apply()  split area based on state vars</span>
<a name="l01121"></a>01121 <span class="comment"> * </span>
<a name="l01122"></a>01122 <span class="comment"> * exit()   cleanup, send notifier</span>
<a name="l01123"></a>01123 <span class="comment"> * </span>
<a name="l01124"></a>01124 <span class="comment"> * cancel() remove duplicated area</span>
<a name="l01125"></a>01125 <span class="comment"> * </span>
<a name="l01126"></a>01126 <span class="comment"> * callbacks:</span>
<a name="l01127"></a>01127 <span class="comment"> * </span>
<a name="l01128"></a>01128 <span class="comment"> * exec()   execute without any user interaction, based on state vars</span>
<a name="l01129"></a>01129 <span class="comment"> * call init(), apply(), exit()</span>
<a name="l01130"></a>01130 <span class="comment"> * </span>
<a name="l01131"></a>01131 <span class="comment"> * invoke() gets called on mouse click in action-widget</span>
<a name="l01132"></a>01132 <span class="comment"> * call init(), add modal handler</span>
<a name="l01133"></a>01133 <span class="comment"> * call apply() with initial motion</span>
<a name="l01134"></a>01134 <span class="comment"> * </span>
<a name="l01135"></a>01135 <span class="comment"> * modal()  accept modal events while doing it</span>
<a name="l01136"></a>01136 <span class="comment"> * call move-areas code with delta motion</span>
<a name="l01137"></a>01137 <span class="comment"> * call exit() or cancel() and remove handler</span>
<a name="l01138"></a>01138 <span class="comment"> */</span>
<a name="l01139"></a>01139 
<a name="l01140"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ae8132c9884d378c18e8ff7706982cc94">01140</a> <span class="preprocessor">#define SPLIT_STARTED   1</span>
<a name="l01141"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#af1407c433a6bc4e6e19cd456820aef47">01141</a> <span class="preprocessor"></span><span class="preprocessor">#define SPLIT_PROGRESS  2</span>
<a name="l01142"></a>01142 <span class="preprocessor"></span>
<a name="l01143"></a><a class="code" href="../../df/d77/structsAreaSplitData.html">01143</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> {
<a name="l01144"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#a3dae8adfa02c3faebf2996d934b40808">01144</a>     <span class="keywordtype">int</span> <a class="code" href="../../df/d77/structsAreaSplitData.html#ad36ff74f10e6019e325f4da41bf87d9b">x</a>, <a class="code" href="../../df/d77/structsAreaSplitData.html#a3dae8adfa02c3faebf2996d934b40808">y</a>;   <span class="comment">/* last used mouse position */</span>
<a name="l01145"></a>01145     
<a name="l01146"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#aa9cc1e70552f94cbec567bf65b9f9882">01146</a>     <span class="keywordtype">int</span> <a class="code" href="../../df/d77/structsAreaSplitData.html#aa9cc1e70552f94cbec567bf65b9f9882">origval</a>;            <span class="comment">/* for move areas */</span>
<a name="l01147"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#a7a4b51a888ee34aa4692f3fab2b7de2b">01147</a>     <span class="keywordtype">int</span> <a class="code" href="../../df/d77/structsAreaSplitData.html#a23e65b434fbe20484c53e236e739aa81">bigger</a>, <a class="code" href="../../df/d77/structsAreaSplitData.html#a7a4b51a888ee34aa4692f3fab2b7de2b">smaller</a>;    <span class="comment">/* constraints for moving new edge */</span>
<a name="l01148"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#a7f096646ebf469d71f330d0c799a01cb">01148</a>     <span class="keywordtype">int</span> <a class="code" href="../../df/d77/structsAreaSplitData.html#a7f096646ebf469d71f330d0c799a01cb">delta</a>;              <span class="comment">/* delta move edge */</span>
<a name="l01149"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#a5b452584aeaa79b79086d3536d2ed54b">01149</a>     <span class="keywordtype">int</span> <a class="code" href="../../df/d77/structsAreaSplitData.html#ac5fec3e5c05d07ea425e05ad0aa66961">origmin</a>, <a class="code" href="../../df/d77/structsAreaSplitData.html#a5b452584aeaa79b79086d3536d2ed54b">origsize</a>;  <span class="comment">/* to calculate fac, for property storage */</span>
<a name="l01150"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#acc2f99b08e4235fe4ba312223b3a0b0b">01150</a>     <span class="keywordtype">int</span> <a class="code" href="../../df/d77/structsAreaSplitData.html#acc2f99b08e4235fe4ba312223b3a0b0b">previewmode</a>;        <span class="comment">/* draw previewline, then split */</span>
<a name="l01151"></a>01151     
<a name="l01152"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#a7bebb94940745290eee75f5e643e1494">01152</a>     <a class="code" href="../../dd/d31/structScrEdge.html">ScrEdge</a> *<a class="code" href="../../df/d77/structsAreaSplitData.html#a7bebb94940745290eee75f5e643e1494">nedge</a>;         <span class="comment">/* new edge */</span>
<a name="l01153"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">01153</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>;         <span class="comment">/* start area */</span>
<a name="l01154"></a><a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">01154</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>;         <span class="comment">/* new area */</span>
<a name="l01155"></a>01155     
<a name="l01156"></a>01156 } <a class="code" href="../../d6/d78/screen__ops_8c.html#aa5e58aca95bd2580c1ad91a6adbf25cd">sAreaSplitData</a>;
<a name="l01157"></a>01157 
<a name="l01158"></a>01158 <span class="comment">/* generic init, menu case, doesn&#39;t need active area */</span>
<a name="l01159"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab5eb55f47cb07d618f444d1a97a9cf2c">01159</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab5eb55f47cb07d618f444d1a97a9cf2c">area_split_menu_init</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01160"></a>01160 {
<a name="l01161"></a>01161     <a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *sd;
<a name="l01162"></a>01162     
<a name="l01163"></a>01163     <span class="comment">/* custom data */</span>
<a name="l01164"></a>01164     sd= (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a>*)<a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span> (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a>), <span class="stringliteral">&quot;op_area_split&quot;</span>);
<a name="l01165"></a>01165     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= sd;
<a name="l01166"></a>01166     
<a name="l01167"></a>01167     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l01168"></a>01168     
<a name="l01169"></a>01169     <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>) {
<a name="l01170"></a>01170         <span class="keywordtype">int</span> dir= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l01171"></a>01171 
<a name="l01172"></a>01172         <span class="keywordflow">if</span> (dir==<span class="charliteral">&#39;h&#39;</span>)
<a name="l01173"></a>01173             sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#afa06c830c3f2a2a38bead57d723b452d">AREA_FLAG_DRAWSPLIT_H</a>;
<a name="l01174"></a>01174         <span class="keywordflow">else</span>
<a name="l01175"></a>01175             sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a082cb2233dcf7742d434336f19aceecb">AREA_FLAG_DRAWSPLIT_V</a>;
<a name="l01176"></a>01176     }
<a name="l01177"></a>01177     <span class="keywordflow">return</span> 1;
<a name="l01178"></a>01178 }
<a name="l01179"></a>01179 
<a name="l01180"></a>01180 <span class="comment">/* generic init, no UI stuff here, assumes active area */</span>
<a name="l01181"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a158e773f7719c0da2866698842a9f071">01181</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a158e773f7719c0da2866698842a9f071">area_split_init</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01182"></a>01182 {
<a name="l01183"></a>01183     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l01184"></a>01184     <a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *sd;
<a name="l01185"></a>01185     <span class="keywordtype">int</span> areaminy= <a class="code" href="../../d1/d12/ED__screen_8h.html#a691baf7c6b3655f45442d77ad5b283c2">ED_area_headersize</a>()+1;
<a name="l01186"></a>01186     <span class="keywordtype">int</span> dir;
<a name="l01187"></a>01187     
<a name="l01188"></a>01188     <span class="comment">/* required context */</span>
<a name="l01189"></a>01189     <span class="keywordflow">if</span> (sa==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> 0;
<a name="l01190"></a>01190     
<a name="l01191"></a>01191     <span class="comment">/* required properties */</span>
<a name="l01192"></a>01192     dir= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l01193"></a>01193     
<a name="l01194"></a>01194     <span class="comment">/* minimal size */</span>
<a name="l01195"></a>01195     <span class="keywordflow">if</span> (dir==<span class="charliteral">&#39;v&#39;</span> &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a8875e00cdc1e130b8267c63b9cc0558e">winx</a> &lt; 2*<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a6369333dbdbed753708c61054c88a1d0">AREAMINX</a>) <span class="keywordflow">return</span> 0;
<a name="l01196"></a>01196     <span class="keywordflow">if</span> (dir==<span class="charliteral">&#39;h&#39;</span> &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9bf030bfae8e6e6ff63acd63f0d499df">winy</a> &lt; 2*areaminy) <span class="keywordflow">return</span> 0;
<a name="l01197"></a>01197     
<a name="l01198"></a>01198     <span class="comment">/* custom data */</span>
<a name="l01199"></a>01199     sd= (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a>*)<a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span> (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a>), <span class="stringliteral">&quot;op_area_split&quot;</span>);
<a name="l01200"></a>01200     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= sd;
<a name="l01201"></a>01201     
<a name="l01202"></a>01202     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>= sa;
<a name="l01203"></a>01203     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a5b452584aeaa79b79086d3536d2ed54b">origsize</a>= dir==<span class="charliteral">&#39;v&#39;</span> ? sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a8875e00cdc1e130b8267c63b9cc0558e">winx</a>:sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9bf030bfae8e6e6ff63acd63f0d499df">winy</a>;
<a name="l01204"></a>01204     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#ac5fec3e5c05d07ea425e05ad0aa66961">origmin</a> = dir==<span class="charliteral">&#39;v&#39;</span> ? sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>:sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>;
<a name="l01205"></a>01205     
<a name="l01206"></a>01206     <span class="keywordflow">return</span> 1;
<a name="l01207"></a>01207 }
<a name="l01208"></a>01208 
<a name="l01209"></a>01209 <span class="comment">/* with sa as center, sb is located at: 0=W, 1=N, 2=E, 3=S */</span>
<a name="l01210"></a>01210 <span class="comment">/* used with split operator */</span>
<a name="l01211"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a602c9078e1026fbd4d1a1c626c5a10cd">01211</a> <span class="keyword">static</span> <a class="code" href="../../dd/d31/structScrEdge.html">ScrEdge</a> *<a class="code" href="../../d6/d78/screen__ops_8c.html#a602c9078e1026fbd4d1a1c626c5a10cd">area_findsharededge</a>(<a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen, <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa, <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sb)
<a name="l01212"></a>01212 {
<a name="l01213"></a>01213     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sav1= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>;
<a name="l01214"></a>01214     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sav2= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>;
<a name="l01215"></a>01215     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sav3= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>;
<a name="l01216"></a>01216     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sav4= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>;
<a name="l01217"></a>01217     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sbv1= sb-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>;
<a name="l01218"></a>01218     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sbv2= sb-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>;
<a name="l01219"></a>01219     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sbv3= sb-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>;
<a name="l01220"></a>01220     <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sbv4= sb-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>;
<a name="l01221"></a>01221     
<a name="l01222"></a>01222     <span class="keywordflow">if</span> (sav1==sbv4 &amp;&amp; sav2==sbv3) { <span class="comment">/* sa to right of sb = W */</span>
<a name="l01223"></a>01223         <span class="keywordflow">return</span> <a class="code" href="../../da/dbc/screen__edit_8c.html#af04be364808a61aef8ec5c37a4ac899f">screen_findedge</a>(screen, sav1, sav2);
<a name="l01224"></a>01224     }
<a name="l01225"></a>01225     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sav2==sbv1 &amp;&amp; sav3==sbv4) { <span class="comment">/* sa to bottom of sb = N */</span>
<a name="l01226"></a>01226         <span class="keywordflow">return</span> <a class="code" href="../../da/dbc/screen__edit_8c.html#af04be364808a61aef8ec5c37a4ac899f">screen_findedge</a>(screen, sav2, sav3);
<a name="l01227"></a>01227     }
<a name="l01228"></a>01228     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sav3==sbv2 &amp;&amp; sav4==sbv1) { <span class="comment">/* sa to left of sb = E */</span>
<a name="l01229"></a>01229         <span class="keywordflow">return</span> <a class="code" href="../../da/dbc/screen__edit_8c.html#af04be364808a61aef8ec5c37a4ac899f">screen_findedge</a>(screen, sav3, sav4);
<a name="l01230"></a>01230     }
<a name="l01231"></a>01231     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sav1==sbv2 &amp;&amp; sav4==sbv3) { <span class="comment">/* sa on top of sb = S*/</span>
<a name="l01232"></a>01232         <span class="keywordflow">return</span> <a class="code" href="../../da/dbc/screen__edit_8c.html#af04be364808a61aef8ec5c37a4ac899f">screen_findedge</a>(screen, sav1, sav4);
<a name="l01233"></a>01233     }
<a name="l01234"></a>01234     
<a name="l01235"></a>01235     <span class="keywordflow">return</span> <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01236"></a>01236 }
<a name="l01237"></a>01237 
<a name="l01238"></a>01238 
<a name="l01239"></a>01239 <span class="comment">/* do the split, return success */</span>
<a name="l01240"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a5724ab3396ac02ee4ebb2f35f1a1d670">01240</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a5724ab3396ac02ee4ebb2f35f1a1d670">area_split_apply</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01241"></a>01241 {
<a name="l01242"></a>01242     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l01243"></a>01243     <a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *sd= (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l01244"></a>01244     <span class="keywordtype">float</span> fac;
<a name="l01245"></a>01245     <span class="keywordtype">int</span> dir;
<a name="l01246"></a>01246     
<a name="l01247"></a>01247     fac= <a class="code" href="../../d3/d10/rna__access_8c.html#a99bfb3295a4df6fef29f16924fd24c79">RNA_float_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;factor&quot;</span>);
<a name="l01248"></a>01248     dir= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l01249"></a>01249     
<a name="l01250"></a>01250     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>= <a class="code" href="../../da/dbc/screen__edit_8c.html#afa19ca1db492f3b27cdb09e59faee9d4">area_split</a>(sc, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>, dir, fac, 0); <span class="comment">/* 0 = no merge */</span>
<a name="l01251"></a>01251     
<a name="l01252"></a>01252     <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>) {
<a name="l01253"></a>01253         <a class="code" href="../../d0/db3/structScrVert.html">ScrVert</a> *sv;
<a name="l01254"></a>01254         
<a name="l01255"></a>01255         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7bebb94940745290eee75f5e643e1494">nedge</a>= <a class="code" href="../../d6/d78/screen__ops_8c.html#a602c9078e1026fbd4d1a1c626c5a10cd">area_findsharededge</a>(sc, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>);
<a name="l01256"></a>01256         
<a name="l01257"></a>01257         <span class="comment">/* select newly created edge, prepare for moving edge */</span>
<a name="l01258"></a>01258         <span class="keywordflow">for</span> (sv= sc-&gt;<a class="code" href="../../de/de7/structbScreen.html#a7b16bb3f5dea1f6159af5be6ea599474">vertbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sv; sv= sv-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a5926b403c5e00af979b2825ee76353eb">next</a>)
<a name="l01259"></a>01259             sv-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a> = 0;
<a name="l01260"></a>01260         
<a name="l01261"></a>01261         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7bebb94940745290eee75f5e643e1494">nedge</a>-&gt;<a class="code" href="../../dd/d31/structScrEdge.html#a6c6a3d9a4ee7853b108d144ae1cb3180">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>= 1;
<a name="l01262"></a>01262         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7bebb94940745290eee75f5e643e1494">nedge</a>-&gt;<a class="code" href="../../dd/d31/structScrEdge.html#a8f323750ba31785ea5c9d8633ae8060b">v2</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#a6c44cfb866bff3ce87a9342db96dd691">flag</a>= 1;
<a name="l01263"></a>01263         
<a name="l01264"></a>01264         <span class="keywordflow">if</span> (dir==<span class="charliteral">&#39;h&#39;</span>) sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aa9cc1e70552f94cbec567bf65b9f9882">origval</a>= sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7bebb94940745290eee75f5e643e1494">nedge</a>-&gt;<a class="code" href="../../dd/d31/structScrEdge.html#a6c6a3d9a4ee7853b108d144ae1cb3180">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>;
<a name="l01265"></a>01265         <span class="keywordflow">else</span> sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aa9cc1e70552f94cbec567bf65b9f9882">origval</a>= sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7bebb94940745290eee75f5e643e1494">nedge</a>-&gt;<a class="code" href="../../dd/d31/structScrEdge.html#a6c6a3d9a4ee7853b108d144ae1cb3180">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>;
<a name="l01266"></a>01266 
<a name="l01267"></a>01267         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>);
<a name="l01268"></a>01268         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>);
<a name="l01269"></a>01269 
<a name="l01270"></a>01270         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01271"></a>01271         
<a name="l01272"></a>01272         <span class="keywordflow">return</span> 1;
<a name="l01273"></a>01273     }       
<a name="l01274"></a>01274     
<a name="l01275"></a>01275     <span class="keywordflow">return</span> 0;
<a name="l01276"></a>01276 }
<a name="l01277"></a>01277 
<a name="l01278"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aa61a8adae4184ed11114aaeb90078109">01278</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aa61a8adae4184ed11114aaeb90078109">area_split_exit</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01279"></a>01279 {
<a name="l01280"></a>01280     <span class="keywordflow">if</span> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>) {
<a name="l01281"></a>01281         <a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *sd= (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l01282"></a>01282         <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>) <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>);
<a name="l01283"></a>01283         <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>) <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>);
<a name="l01284"></a>01284 
<a name="l01285"></a>01285         <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>)
<a name="l01286"></a>01286             sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~(<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#afa06c830c3f2a2a38bead57d723b452d">AREA_FLAG_DRAWSPLIT_H</a>|<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a082cb2233dcf7742d434336f19aceecb">AREA_FLAG_DRAWSPLIT_V</a>);
<a name="l01287"></a>01287         
<a name="l01288"></a>01288         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>);
<a name="l01289"></a>01289         op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01290"></a>01290     }
<a name="l01291"></a>01291     
<a name="l01292"></a>01292     <a class="code" href="../../de/d3c/wm__cursors_8c.html#ab8500ccfbffb6b57f4e0645e0f9a4759">WM_cursor_restore</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C));
<a name="l01293"></a>01293     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01294"></a>01294     
<a name="l01295"></a>01295     <span class="comment">/* this makes sure aligned edges will result in aligned grabbing */</span>
<a name="l01296"></a>01296     <a class="code" href="../../da/dbc/screen__edit_8c.html#a5833bc9adacacd496ee1ce122eeb3802">removedouble_scrverts</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C));
<a name="l01297"></a>01297     <a class="code" href="../../da/dbc/screen__edit_8c.html#a69ed104f9640180b1041bf20343a276c">removedouble_scredges</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C));
<a name="l01298"></a>01298 }
<a name="l01299"></a>01299 
<a name="l01300"></a>01300 
<a name="l01301"></a>01301 <span class="comment">/* UI callback, adds new handler */</span>
<a name="l01302"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ac9d340ecc160b24e6952afbc71eb5bf2">01302</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ac9d340ecc160b24e6952afbc71eb5bf2">area_split_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01303"></a>01303 {
<a name="l01304"></a>01304     <a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *sd;
<a name="l01305"></a>01305     <span class="keywordtype">int</span> dir;
<a name="l01306"></a>01306     
<a name="l01307"></a>01307     <span class="comment">/* no full window splitting allowed */</span>
<a name="l01308"></a>01308     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)-&gt;full != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab5f98947e6f48dad2b0184d7d97bc365">SCREENNORMAL</a>)
<a name="l01309"></a>01309         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01310"></a>01310     
<a name="l01311"></a>01311     <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>==<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>) {
<a name="l01312"></a>01312         <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= <span class="keyword">event</span>-&gt;customdata;
<a name="l01313"></a>01313         
<a name="l01314"></a>01314         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a98658addbd425cde75bedc9172cc1611">modifier</a>&gt;0) {
<a name="l01315"></a>01315             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l01316"></a>01316         }
<a name="l01317"></a>01317         
<a name="l01318"></a>01318         <span class="comment">/* verify *sad itself */</span>
<a name="l01319"></a>01319         <span class="keywordflow">if</span> (sad==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">az</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01320"></a>01320             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l01321"></a>01321         
<a name="l01322"></a>01322         <span class="comment">/* is this our *sad? if areas not equal it should be passed on */</span>
<a name="l01323"></a>01323         <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C)!=sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>!=sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>)
<a name="l01324"></a>01324             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l01325"></a>01325         
<a name="l01326"></a>01326         <span class="comment">/* prepare operator state vars */</span>
<a name="l01327"></a>01327         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a14ab0826bafc1f2423438b9c3e07eec5">gesture_dir</a>==<span class="charliteral">&#39;n&#39;</span> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a14ab0826bafc1f2423438b9c3e07eec5">gesture_dir</a>==<span class="charliteral">&#39;s&#39;</span>) {
<a name="l01328"></a>01328             dir= <span class="charliteral">&#39;h&#39;</span>;
<a name="l01329"></a>01329             <a class="code" href="../../d3/d10/rna__access_8c.html#aa36f2cf0133a312c322490ba0bff9b72">RNA_float_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;factor&quot;</span>, ((<span class="keywordtype">float</span>)(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a> - sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a369c28c4e23e9098f547465d1d12f38b">x</a>)) / (<span class="keywordtype">float</span>)sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a8875e00cdc1e130b8267c63b9cc0558e">winx</a>);
<a name="l01330"></a>01330         }
<a name="l01331"></a>01331         <span class="keywordflow">else</span> {
<a name="l01332"></a>01332             dir= <span class="charliteral">&#39;v&#39;</span>;
<a name="l01333"></a>01333             <a class="code" href="../../d3/d10/rna__access_8c.html#aa36f2cf0133a312c322490ba0bff9b72">RNA_float_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;factor&quot;</span>, ((<span class="keywordtype">float</span>)(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a> - sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>-&gt;<a class="code" href="../../d0/db3/structScrVert.html#afaa6127eeea899ba620074a3b9cb39cc">vec</a>.<a class="code" href="../../d4/d60/structvec2s.html#a1a1b582dc847b158b77979f59849aaec">y</a>)) / (<span class="keywordtype">float</span>)sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9bf030bfae8e6e6ff63acd63f0d499df">winy</a>);
<a name="l01334"></a>01334         }
<a name="l01335"></a>01335         <a class="code" href="../../d3/d10/rna__access_8c.html#ad70d450cec9fe951de69b8c9128b8cc4">RNA_enum_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>, dir);
<a name="l01336"></a>01336         
<a name="l01337"></a>01337         <span class="comment">/* general init, also non-UI case, adds customdata, sets area and defaults */</span>
<a name="l01338"></a>01338         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#a158e773f7719c0da2866698842a9f071">area_split_init</a>(C, op))
<a name="l01339"></a>01339             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l01340"></a>01340         
<a name="l01341"></a>01341     }
<a name="l01342"></a>01342     <span class="keywordflow">else</span> {
<a name="l01343"></a>01343         <a class="code" href="../../dd/d31/structScrEdge.html">ScrEdge</a> *actedge;
<a name="l01344"></a>01344         <span class="keywordtype">int</span> x, y;
<a name="l01345"></a>01345         
<a name="l01346"></a>01346         <span class="comment">/* retrieve initial mouse coord, so we can find the active edge */</span>
<a name="l01347"></a>01347         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a6134701e8798d50496b725c9cb1b6868">RNA_struct_property_is_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;mouse_x&quot;</span>))
<a name="l01348"></a>01348             x= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;mouse_x&quot;</span>);
<a name="l01349"></a>01349         <span class="keywordflow">else</span>
<a name="l01350"></a>01350             x= <span class="keyword">event</span>-&gt;x;
<a name="l01351"></a>01351         
<a name="l01352"></a>01352         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a6134701e8798d50496b725c9cb1b6868">RNA_struct_property_is_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;mouse_y&quot;</span>))
<a name="l01353"></a>01353             y= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;mouse_y&quot;</span>);
<a name="l01354"></a>01354         <span class="keywordflow">else</span>
<a name="l01355"></a>01355             y= <span class="keyword">event</span>-&gt;x;
<a name="l01356"></a>01356         
<a name="l01357"></a>01357         actedge= <a class="code" href="../../da/dbc/screen__edit_8c.html#ad462a6663b9be9ed4230edfd68e81cb5">screen_find_active_scredge</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), x, y);
<a name="l01358"></a>01358         <span class="keywordflow">if</span> (actedge==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) 
<a name="l01359"></a>01359             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01360"></a>01360         
<a name="l01361"></a>01361         dir= <a class="code" href="../../da/dbc/screen__edit_8c.html#a7a9ae203ae84d9436052de27bfdbbc68">scredge_is_horizontal</a>(actedge)?<span class="charliteral">&#39;v&#39;</span>:<span class="charliteral">&#39;h&#39;</span>;
<a name="l01362"></a>01362         
<a name="l01363"></a>01363         <a class="code" href="../../d3/d10/rna__access_8c.html#ad70d450cec9fe951de69b8c9128b8cc4">RNA_enum_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>, dir);
<a name="l01364"></a>01364         
<a name="l01365"></a>01365         <span class="comment">/* special case, adds customdata, sets defaults */</span>
<a name="l01366"></a>01366         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#ab5eb55f47cb07d618f444d1a97a9cf2c">area_split_menu_init</a>(C, op))
<a name="l01367"></a>01367             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01368"></a>01368         
<a name="l01369"></a>01369     }
<a name="l01370"></a>01370     
<a name="l01371"></a>01371     sd= (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l01372"></a>01372     
<a name="l01373"></a>01373     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#ad36ff74f10e6019e325f4da41bf87d9b">x</a>= event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>;
<a name="l01374"></a>01374     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a3dae8adfa02c3faebf2996d934b40808">y</a>= event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>;
<a name="l01375"></a>01375     
<a name="l01376"></a>01376     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>==<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>) {
<a name="l01377"></a>01377         
<a name="l01378"></a>01378         <span class="comment">/* do the split */</span>
<a name="l01379"></a>01379         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d78/screen__ops_8c.html#a5724ab3396ac02ee4ebb2f35f1a1d670">area_split_apply</a>(C, op)) {
<a name="l01380"></a>01380             <a class="code" href="../../d6/d78/screen__ops_8c.html#af78e45068427f3480d5ef377c96b6521">area_move_set_limits</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), dir, &amp;sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a23e65b434fbe20484c53e236e739aa81">bigger</a>, &amp;sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7a4b51a888ee34aa4692f3fab2b7de2b">smaller</a>);
<a name="l01381"></a>01381             
<a name="l01382"></a>01382             <span class="comment">/* add temp handler for edge move or cancel */</span>
<a name="l01383"></a>01383             <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l01384"></a>01384             
<a name="l01385"></a>01385             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l01386"></a>01386         }
<a name="l01387"></a>01387     }
<a name="l01388"></a>01388     <span class="keywordflow">else</span> {
<a name="l01389"></a>01389         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#acc2f99b08e4235fe4ba312223b3a0b0b">previewmode</a>= 1;
<a name="l01390"></a>01390         <span class="comment">/* add temp handler for edge move or cancel */</span>
<a name="l01391"></a>01391         <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l01392"></a>01392         
<a name="l01393"></a>01393         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l01394"></a>01394         
<a name="l01395"></a>01395     }
<a name="l01396"></a>01396     
<a name="l01397"></a>01397     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l01398"></a>01398 }
<a name="l01399"></a>01399 
<a name="l01400"></a>01400 <span class="comment">/* function to be called outside UI context, or for redo */</span>
<a name="l01401"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a0d9dfefa0f6d1433217ea9ca970ac7cd">01401</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a0d9dfefa0f6d1433217ea9ca970ac7cd">area_split_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01402"></a>01402 {
<a name="l01403"></a>01403     
<a name="l01404"></a>01404     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#a158e773f7719c0da2866698842a9f071">area_split_init</a>(C, op))
<a name="l01405"></a>01405         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01406"></a>01406     
<a name="l01407"></a>01407     <a class="code" href="../../d6/d78/screen__ops_8c.html#a5724ab3396ac02ee4ebb2f35f1a1d670">area_split_apply</a>(C, op);
<a name="l01408"></a>01408     <a class="code" href="../../d6/d78/screen__ops_8c.html#aa61a8adae4184ed11114aaeb90078109">area_split_exit</a>(C, op);
<a name="l01409"></a>01409     
<a name="l01410"></a>01410     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01411"></a>01411 }
<a name="l01412"></a>01412 
<a name="l01413"></a>01413 
<a name="l01414"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab3872c89070908b2bde00a6fcc43abf1">01414</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab3872c89070908b2bde00a6fcc43abf1">area_split_cancel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01415"></a>01415 {
<a name="l01416"></a>01416     <a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *sd= (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l01417"></a>01417     
<a name="l01418"></a>01418     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#acc2f99b08e4235fe4ba312223b3a0b0b">previewmode</a>) {
<a name="l01419"></a>01419     }
<a name="l01420"></a>01420     <span class="keywordflow">else</span> {
<a name="l01421"></a>01421         <span class="keywordflow">if</span> (<a class="code" href="../../da/dbc/screen__edit_8c.html#a73586812301934ae7613e653c116b065">screen_area_join</a>(C, <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>)) {
<a name="l01422"></a>01422             <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C) == sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a>) {
<a name="l01423"></a>01423                 <a class="code" href="../../df/d01/BKE__context_8h.html#af38e3db529bba2578831bbe57940570b">CTX_wm_area_set</a>(C, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01424"></a>01424                 <a class="code" href="../../df/d01/BKE__context_8h.html#a2406677d500d1744af5e9e56c210590b">CTX_wm_region_set</a>(C, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01425"></a>01425             }
<a name="l01426"></a>01426             sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a948775413c123da345c1076e72180997">narea</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01427"></a>01427         }
<a name="l01428"></a>01428     }
<a name="l01429"></a>01429     <a class="code" href="../../d6/d78/screen__ops_8c.html#aa61a8adae4184ed11114aaeb90078109">area_split_exit</a>(C, op);
<a name="l01430"></a>01430     
<a name="l01431"></a>01431     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01432"></a>01432 }
<a name="l01433"></a>01433 
<a name="l01434"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a713427f4d593e0c80caf599716133c16">01434</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a713427f4d593e0c80caf599716133c16">area_split_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01435"></a>01435 {
<a name="l01436"></a>01436     <a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *sd= (<a class="code" href="../../df/d77/structsAreaSplitData.html">sAreaSplitData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l01437"></a>01437     <span class="keywordtype">float</span> fac;
<a name="l01438"></a>01438     <span class="keywordtype">int</span> dir;
<a name="l01439"></a>01439     
<a name="l01440"></a>01440     <span class="comment">/* execute the events */</span>
<a name="l01441"></a>01441     <span class="keywordflow">switch</span>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>) {
<a name="l01442"></a>01442         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#aa58b8b831d49bfef312f9ae99d742aae">MOUSEMOVE</a>:
<a name="l01443"></a>01443             dir= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l01444"></a>01444             
<a name="l01445"></a>01445             sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7f096646ebf469d71f330d0c799a01cb">delta</a>= (dir == <span class="charliteral">&#39;v&#39;</span>)? event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a> - sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aa9cc1e70552f94cbec567bf65b9f9882">origval</a>: event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a> - sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aa9cc1e70552f94cbec567bf65b9f9882">origval</a>;
<a name="l01446"></a>01446             <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#acc2f99b08e4235fe4ba312223b3a0b0b">previewmode</a>==0) 
<a name="l01447"></a>01447                 <a class="code" href="../../d6/d78/screen__ops_8c.html#a19a0f7c8d917285d3564190e2fbbc5c0">area_move_apply_do</a>(C, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aa9cc1e70552f94cbec567bf65b9f9882">origval</a>, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7f096646ebf469d71f330d0c799a01cb">delta</a>, dir, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a23e65b434fbe20484c53e236e739aa81">bigger</a>, sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a7a4b51a888ee34aa4692f3fab2b7de2b">smaller</a>);
<a name="l01448"></a>01448             <span class="keywordflow">else</span> {
<a name="l01449"></a>01449                 <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>) {
<a name="l01450"></a>01450                     sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~(<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#afa06c830c3f2a2a38bead57d723b452d">AREA_FLAG_DRAWSPLIT_H</a>|<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a082cb2233dcf7742d434336f19aceecb">AREA_FLAG_DRAWSPLIT_V</a>);
<a name="l01451"></a>01451                     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>);
<a name="l01452"></a>01452                 }
<a name="l01453"></a>01453                 sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>= <a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">screen_areahascursor</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);  <span class="comment">/* area context not set */</span>
<a name="l01454"></a>01454                 
<a name="l01455"></a>01455                 <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>) {
<a name="l01456"></a>01456                     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>);
<a name="l01457"></a>01457                     <span class="keywordflow">if</span> (dir==<span class="charliteral">&#39;v&#39;</span>) {
<a name="l01458"></a>01458                         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a5b452584aeaa79b79086d3536d2ed54b">origsize</a>= sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a8875e00cdc1e130b8267c63b9cc0558e">winx</a>;
<a name="l01459"></a>01459                         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#ac5fec3e5c05d07ea425e05ad0aa66961">origmin</a>= sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>;
<a name="l01460"></a>01460                         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a082cb2233dcf7742d434336f19aceecb">AREA_FLAG_DRAWSPLIT_V</a>;
<a name="l01461"></a>01461                     }
<a name="l01462"></a>01462                     <span class="keywordflow">else</span> {
<a name="l01463"></a>01463                         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a5b452584aeaa79b79086d3536d2ed54b">origsize</a>= sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9bf030bfae8e6e6ff63acd63f0d499df">winy</a>;
<a name="l01464"></a>01464                         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#ac5fec3e5c05d07ea425e05ad0aa66961">origmin</a>= sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>;
<a name="l01465"></a>01465                         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#afa06c830c3f2a2a38bead57d723b452d">AREA_FLAG_DRAWSPLIT_H</a>;
<a name="l01466"></a>01466                     }
<a name="l01467"></a>01467                 }
<a name="l01468"></a>01468                 
<a name="l01469"></a>01469                 <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a5ec98a9e430fdc21a8d0f0b8dcc6ed05">screen</a>-&gt;<a class="code" href="../../de/de7/structbScreen.html#af42ea7fb025800a97c3a1fe3e5f24c5e">do_draw</a>= 1;
<a name="l01470"></a>01470 
<a name="l01471"></a>01471             }
<a name="l01472"></a>01472             
<a name="l01473"></a>01473             fac= (dir == <span class="charliteral">&#39;v&#39;</span>) ? event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>-sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#ac5fec3e5c05d07ea425e05ad0aa66961">origmin</a> : event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>-sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#ac5fec3e5c05d07ea425e05ad0aa66961">origmin</a>;
<a name="l01474"></a>01474             <a class="code" href="../../d3/d10/rna__access_8c.html#aa36f2cf0133a312c322490ba0bff9b72">RNA_float_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;factor&quot;</span>, fac / (<span class="keywordtype">float</span>)sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#a5b452584aeaa79b79086d3536d2ed54b">origsize</a>);
<a name="l01475"></a>01475             
<a name="l01476"></a>01476             <span class="keywordflow">break</span>;
<a name="l01477"></a>01477             
<a name="l01478"></a>01478         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>:
<a name="l01479"></a>01479             <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#acc2f99b08e4235fe4ba312223b3a0b0b">previewmode</a>) {
<a name="l01480"></a>01480                 <a class="code" href="../../d6/d78/screen__ops_8c.html#a5724ab3396ac02ee4ebb2f35f1a1d670">area_split_apply</a>(C, op);
<a name="l01481"></a>01481                 <a class="code" href="../../d6/d78/screen__ops_8c.html#aa61a8adae4184ed11114aaeb90078109">area_split_exit</a>(C, op);
<a name="l01482"></a>01482                 <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01483"></a>01483             }
<a name="l01484"></a>01484             <span class="keywordflow">else</span> {
<a name="l01485"></a>01485                 <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a>==<a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>) { <span class="comment">/* mouse up */</span>
<a name="l01486"></a>01486                     <a class="code" href="../../d6/d78/screen__ops_8c.html#aa61a8adae4184ed11114aaeb90078109">area_split_exit</a>(C, op);
<a name="l01487"></a>01487                     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01488"></a>01488                 }
<a name="l01489"></a>01489             }
<a name="l01490"></a>01490             <span class="keywordflow">break</span>;
<a name="l01491"></a>01491             
<a name="l01492"></a>01492         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a64d06d50176bcded7e70cd4ebbce0e12">MIDDLEMOUSE</a>:
<a name="l01493"></a>01493         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#a67d5864c4d46748f0c7ee7a4fc30561d">TABKEY</a>:
<a name="l01494"></a>01494             <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#acc2f99b08e4235fe4ba312223b3a0b0b">previewmode</a>==0) {
<a name="l01495"></a>01495             }
<a name="l01496"></a>01496             <span class="keywordflow">else</span> {
<a name="l01497"></a>01497                 dir = <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l01498"></a>01498                 
<a name="l01499"></a>01499                 <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a>==<a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>) {
<a name="l01500"></a>01500                     <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>) {
<a name="l01501"></a>01501                         sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~(<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#afa06c830c3f2a2a38bead57d723b452d">AREA_FLAG_DRAWSPLIT_H</a>|<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a082cb2233dcf7742d434336f19aceecb">AREA_FLAG_DRAWSPLIT_V</a>);
<a name="l01502"></a>01502                         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>);
<a name="l01503"></a>01503                         
<a name="l01504"></a>01504                         <span class="keywordflow">if</span> (dir==<span class="charliteral">&#39;v&#39;</span>) {
<a name="l01505"></a>01505                             <a class="code" href="../../d3/d10/rna__access_8c.html#ad70d450cec9fe951de69b8c9128b8cc4">RNA_enum_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>, <span class="charliteral">&#39;h&#39;</span>);
<a name="l01506"></a>01506                             sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#afa06c830c3f2a2a38bead57d723b452d">AREA_FLAG_DRAWSPLIT_H</a>;
<a name="l01507"></a>01507                             
<a name="l01508"></a>01508                             <a class="code" href="../../de/d3c/wm__cursors_8c.html#a30f5564490ef777f782dbce942054565">WM_cursor_set</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C),<a class="code" href="../../db/da6/wm__cursors_8h.html#aeb8d583a31cccbb8cf9b452a8e298063a8cd32081a24846ec46ec8217f2a1304a">CURSOR_X_MOVE</a>);
<a name="l01509"></a>01509                         }
<a name="l01510"></a>01510                         <span class="keywordflow">else</span> {
<a name="l01511"></a>01511                             <a class="code" href="../../d3/d10/rna__access_8c.html#ad70d450cec9fe951de69b8c9128b8cc4">RNA_enum_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;direction&quot;</span>, <span class="charliteral">&#39;v&#39;</span>);
<a name="l01512"></a>01512                             sd-&gt;<a class="code" href="../../df/d77/structsAreaSplitData.html#aea53a1b820441a7c45d7bcabd526ef27">sarea</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a082cb2233dcf7742d434336f19aceecb">AREA_FLAG_DRAWSPLIT_V</a>;
<a name="l01513"></a>01513                             
<a name="l01514"></a>01514                             <a class="code" href="../../de/d3c/wm__cursors_8c.html#a30f5564490ef777f782dbce942054565">WM_cursor_set</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C),<a class="code" href="../../db/da6/wm__cursors_8h.html#aeb8d583a31cccbb8cf9b452a8e298063a633ba0f5cebabd00b352c40505d6061d">CURSOR_Y_MOVE</a>);
<a name="l01515"></a>01515                         }
<a name="l01516"></a>01516                     }
<a name="l01517"></a>01517                 }
<a name="l01518"></a>01518             }
<a name="l01519"></a>01519             
<a name="l01520"></a>01520             <span class="keywordflow">break</span>;
<a name="l01521"></a>01521             
<a name="l01522"></a>01522         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#adc87b609a6285a24e23172a90734044c">RIGHTMOUSE</a>: <span class="comment">/* cancel operation */</span>
<a name="l01523"></a>01523         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>:
<a name="l01524"></a>01524             <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab3872c89070908b2bde00a6fcc43abf1">area_split_cancel</a>(C, op);
<a name="l01525"></a>01525     }
<a name="l01526"></a>01526     
<a name="l01527"></a>01527     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l01528"></a>01528 }
<a name="l01529"></a>01529 
<a name="l01530"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a47188fde82c53cb950e7590ffd19e48c">01530</a> <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> <a class="code" href="../../d6/d78/screen__ops_8c.html#a47188fde82c53cb950e7590ffd19e48c">prop_direction_items</a>[] = {
<a name="l01531"></a>01531 {<span class="charliteral">&#39;h&#39;</span>, <span class="stringliteral">&quot;HORIZONTAL&quot;</span>, 0, <span class="stringliteral">&quot;Horizontal&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01532"></a>01532 {<span class="charliteral">&#39;v&#39;</span>, <span class="stringliteral">&quot;VERTICAL&quot;</span>, 0, <span class="stringliteral">&quot;Vertical&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l01533"></a>01533 {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l01534"></a>01534 
<a name="l01535"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aacb25639d0e2ea11ec55594b321c3b88">01535</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aacb25639d0e2ea11ec55594b321c3b88">SCREEN_OT_area_split</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01536"></a>01536 {
<a name="l01537"></a>01537     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Split area&quot;</span>;
<a name="l01538"></a>01538     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Split selected area into new windows&quot;</span>;
<a name="l01539"></a>01539     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_area_split&quot;</span>;
<a name="l01540"></a>01540     
<a name="l01541"></a>01541     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a0d9dfefa0f6d1433217ea9ca970ac7cd">area_split_exec</a>;
<a name="l01542"></a>01542     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ac9d340ecc160b24e6952afbc71eb5bf2">area_split_invoke</a>;
<a name="l01543"></a>01543     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a713427f4d593e0c80caf599716133c16">area_split_modal</a>;
<a name="l01544"></a>01544     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ab3872c89070908b2bde00a6fcc43abf1">area_split_cancel</a>;
<a name="l01545"></a>01545     
<a name="l01546"></a>01546     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a0c97e7b74b5212491f28a93ce7d47ab0">screen_active_editable</a>;
<a name="l01547"></a>01547     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a2458c730dbcabf67cc8917d8de127bab">OPTYPE_BLOCKING</a>;
<a name="l01548"></a>01548     
<a name="l01549"></a>01549     <span class="comment">/* rna */</span>
<a name="l01550"></a>01550     <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;direction&quot;</span>, prop_direction_items, <span class="charliteral">&#39;h&#39;</span>, <span class="stringliteral">&quot;Direction&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01551"></a>01551     <a class="code" href="../../dc/d7e/rna__define_8c.html#a040f4b08fc87a45a90e2291382e27f75">RNA_def_float</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;factor&quot;</span>, 0.5f, 0.0, 1.0, <span class="stringliteral">&quot;Factor&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0.0, 1.0);
<a name="l01552"></a>01552     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mouse_x&quot;</span>, -100, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Mouse X&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l01553"></a>01553     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;mouse_y&quot;</span>, -100, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Mouse Y&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l01554"></a>01554 }
<a name="l01555"></a>01555 
<a name="l01556"></a>01556 
<a name="l01557"></a>01557 
<a name="l01558"></a>01558 <span class="comment">/* ************** scale region edge operator *********************************** */</span>
<a name="l01559"></a>01559 
<a name="l01560"></a><a class="code" href="../../d6/dba/structRegionMoveData.html">01560</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/dba/structRegionMoveData.html">RegionMoveData</a> {
<a name="l01561"></a><a class="code" href="../../d6/dba/structRegionMoveData.html#a920c0431969b38840b2bc98f9d09a886">01561</a>     <a class="code" href="../../d8/dfd/structAZone.html">AZone</a> *<a class="code" href="../../d6/dba/structRegionMoveData.html#a920c0431969b38840b2bc98f9d09a886">az</a>;
<a name="l01562"></a><a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">01562</a>     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>;
<a name="l01563"></a><a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">01563</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">sa</a>;
<a name="l01564"></a><a class="code" href="../../d6/dba/structRegionMoveData.html#a8775fc38d86b01d3c390ff36b511bb48">01564</a>     <span class="keywordtype">int</span> <a class="code" href="../../d6/dba/structRegionMoveData.html#a2dd51a4aaf9430dde06129f465ccd646">bigger</a>, <a class="code" href="../../d6/dba/structRegionMoveData.html#a8775fc38d86b01d3c390ff36b511bb48">smaller</a>, <a class="code" href="../../d6/dba/structRegionMoveData.html#a01b496b15b81dae694c4577e5be58c60">origval</a>;
<a name="l01565"></a><a class="code" href="../../d6/dba/structRegionMoveData.html#a4ea3c9f7bead5f75670ea1550c6f5822">01565</a>     <span class="keywordtype">int</span> <a class="code" href="../../d6/dba/structRegionMoveData.html#ace59a413e0481c00dd1505074551aaa9">origx</a>, <a class="code" href="../../d6/dba/structRegionMoveData.html#a4ea3c9f7bead5f75670ea1550c6f5822">origy</a>;
<a name="l01566"></a><a class="code" href="../../d6/dba/structRegionMoveData.html#a386b94b1feafe280095dc8f641a5805f">01566</a>     <span class="keywordtype">int</span> <a class="code" href="../../d6/dba/structRegionMoveData.html#a386b94b1feafe280095dc8f641a5805f">maxsize</a>;
<a name="l01567"></a><a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">01567</a>     <a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050">AZEdge</a> <a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>;
<a name="l01568"></a>01568     
<a name="l01569"></a>01569 } <a class="code" href="../../d6/d78/screen__ops_8c.html#a6645131f978a6325860b623044db6bfa">RegionMoveData</a>;
<a name="l01570"></a>01570 
<a name="l01571"></a>01571 
<a name="l01572"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a50320bcaee5a8ab236a191153d0d22de">01572</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a50320bcaee5a8ab236a191153d0d22de">area_max_regionsize</a>(<a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa, <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *scalear, <a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050">AZEdge</a> edge)
<a name="l01573"></a>01573 {
<a name="l01574"></a>01574     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar;
<a name="l01575"></a>01575     <span class="keywordtype">int</span> dist;
<a name="l01576"></a>01576     
<a name="l01577"></a>01577     <span class="keywordflow">if</span> (edge==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a7bbe94b2d8cf2a57e13a5687b1a697bb">AE_RIGHT_TO_TOPLEFT</a> || edge==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a61e988fbac4e5a0b6f160b766cf89c8c">AE_LEFT_TO_TOPRIGHT</a>) {
<a name="l01578"></a>01578         dist = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> - sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a>;
<a name="l01579"></a>01579     }
<a name="l01580"></a>01580     <span class="keywordflow">else</span> {  <span class="comment">/* AE_BOTTOM_TO_TOPLEFT, AE_TOP_TO_BOTTOMRIGHT */</span>
<a name="l01581"></a>01581         dist = sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> - sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab57b1af3f75bfc9e306271da17d157ff">totrct</a>.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a>;
<a name="l01582"></a>01582     }
<a name="l01583"></a>01583     
<a name="l01584"></a>01584     <span class="comment">/* subtractwidth of regions on opposite side </span>
<a name="l01585"></a>01585 <span class="comment">     * prevents dragging regions into other opposite regions */</span>
<a name="l01586"></a>01586     <span class="keywordflow">for</span> (ar=sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar=ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>) {
<a name="l01587"></a>01587         <span class="keywordflow">if</span> (ar == scalear)
<a name="l01588"></a>01588             <span class="keywordflow">continue</span>;
<a name="l01589"></a>01589         
<a name="l01590"></a>01590         <span class="keywordflow">if</span> (scalear-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a>)
<a name="l01591"></a>01591             dist -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a908d20a23657ef143d2de1496be69f42">winy</a>;
<a name="l01592"></a>01592         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scalear-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a>)
<a name="l01593"></a>01593             dist -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a908d20a23657ef143d2de1496be69f42">winy</a>;
<a name="l01594"></a>01594         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scalear-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a>)
<a name="l01595"></a>01595             dist -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a32e37003215c0dc7f77e12e4fc9db3f4">winx</a>;
<a name="l01596"></a>01596         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scalear-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>)
<a name="l01597"></a>01597             dist -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a32e37003215c0dc7f77e12e4fc9db3f4">winx</a>;
<a name="l01598"></a>01598         
<a name="l01599"></a>01599         <span class="comment">/* case of regions in regions, like operator properties panel */</span>
<a name="l01600"></a>01600         <span class="comment">/* these can sit on top of other regions such as headers, so account for this */</span>
<a name="l01601"></a>01601         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (edge == <a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a841115d7bd473274829817833fdb1771">AE_BOTTOM_TO_TOPLEFT</a> &amp;&amp; scalear-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>)
<a name="l01602"></a>01602             dist -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a908d20a23657ef143d2de1496be69f42">winy</a>;
<a name="l01603"></a>01603         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (edge == <a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050af8729f1ae2f8b64afc9f26110f5d3820">AE_TOP_TO_BOTTOMRIGHT</a> &amp;&amp; scalear-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a> &amp;&amp; ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>)
<a name="l01604"></a>01604             dist -= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a908d20a23657ef143d2de1496be69f42">winy</a>;
<a name="l01605"></a>01605     }
<a name="l01606"></a>01606 
<a name="l01607"></a>01607     <span class="keywordflow">return</span> dist;
<a name="l01608"></a>01608 }
<a name="l01609"></a>01609 
<a name="l01610"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#abcad200f0a12bcf32283987d93b6675b">01610</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#abcad200f0a12bcf32283987d93b6675b">region_scale_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01611"></a>01611 {
<a name="l01612"></a>01612     <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= <span class="keyword">event</span>-&gt;customdata;
<a name="l01613"></a>01613     <a class="code" href="../../d8/dfd/structAZone.html">AZone</a> *az;
<a name="l01614"></a>01614     
<a name="l01615"></a>01615     <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>!=<a class="code" href="../../d1/d40/wm__event__types_8h.html#a8f52029c9e633df20722c29f39c4efde">EVT_ACTIONZONE_REGION</a>) {
<a name="l01616"></a>01616         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Can only scale region size from an action zone&quot;</span>);   
<a name="l01617"></a>01617         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01618"></a>01618     }
<a name="l01619"></a>01619     
<a name="l01620"></a>01620     az = sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#ac2e2b2f4d5e184220f5e11cfc69f5f3d">az</a>;
<a name="l01621"></a>01621     
<a name="l01622"></a>01622     <span class="keywordflow">if</span> (az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#abcf6186b7c50b07c17df695cc776cad5">ar</a>) {
<a name="l01623"></a>01623         <a class="code" href="../../d6/dba/structRegionMoveData.html">RegionMoveData</a> *rmd= <a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d6/dba/structRegionMoveData.html">RegionMoveData</a>), <span class="stringliteral">&quot;RegionMoveData&quot;</span>);
<a name="l01624"></a>01624         <span class="keywordtype">int</span> maxsize;
<a name="l01625"></a>01625         
<a name="l01626"></a>01626         op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= rmd;
<a name="l01627"></a>01627         
<a name="l01628"></a>01628         rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a920c0431969b38840b2bc98f9d09a886">az</a> = az;
<a name="l01629"></a>01629         rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>= az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#abcf6186b7c50b07c17df695cc776cad5">ar</a>;
<a name="l01630"></a>01630         rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">sa</a> = sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>;
<a name="l01631"></a>01631         rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>= az-&gt;<a class="code" href="../../d8/dfd/structAZone.html#a83c515d0109cfbe4c397c49115ecdb56">edge</a>;
<a name="l01632"></a>01632         rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#ace59a413e0481c00dd1505074551aaa9">origx</a>= <span class="keyword">event</span>-&gt;x;
<a name="l01633"></a>01633         rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a4ea3c9f7bead5f75670ea1550c6f5822">origy</a>= <span class="keyword">event</span>-&gt;y;
<a name="l01634"></a>01634         rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a386b94b1feafe280095dc8f641a5805f">maxsize</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a50320bcaee5a8ab236a191153d0d22de">area_max_regionsize</a>(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">sa</a>, rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>, rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>);
<a name="l01635"></a>01635         
<a name="l01636"></a>01636         <span class="comment">/* if not set we do now, otherwise it uses type */</span>
<a name="l01637"></a>01637         <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a>==0) 
<a name="l01638"></a>01638             rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#ae957cd551d82034b24008cfb99bbc4c7">type</a>-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a42adc2547994df726d3dc8bce9028601">prefsizex</a>;
<a name="l01639"></a>01639         <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>==0) 
<a name="l01640"></a>01640             rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#ae957cd551d82034b24008cfb99bbc4c7">type</a>-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a731e71cf273e50acc629de70427ff2bd">prefsizey</a>;
<a name="l01641"></a>01641         
<a name="l01642"></a>01642         <span class="comment">/* now copy to regionmovedata */</span>
<a name="l01643"></a>01643         <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a61e988fbac4e5a0b6f160b766cf89c8c">AE_LEFT_TO_TOPRIGHT</a> || rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a7bbe94b2d8cf2a57e13a5687b1a697bb">AE_RIGHT_TO_TOPLEFT</a>) {
<a name="l01644"></a>01644             rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a01b496b15b81dae694c4577e5be58c60">origval</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a>;
<a name="l01645"></a>01645         }
<a name="l01646"></a>01646         <span class="keywordflow">else</span> {
<a name="l01647"></a>01647             rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a01b496b15b81dae694c4577e5be58c60">origval</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>;
<a name="l01648"></a>01648         }
<a name="l01649"></a>01649         
<a name="l01650"></a>01650         <span class="comment">/* limit headers to standard height for now */</span>
<a name="l01651"></a>01651         <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>)
<a name="l01652"></a>01652             maxsize = rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#ae957cd551d82034b24008cfb99bbc4c7">type</a>-&gt;<a class="code" href="../../d7/da9/structARegionType.html#a731e71cf273e50acc629de70427ff2bd">prefsizey</a>;
<a name="l01653"></a>01653         <span class="keywordflow">else</span>
<a name="l01654"></a>01654             maxsize = 1000;
<a name="l01655"></a>01655         
<a name="l01656"></a>01656         <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a386b94b1feafe280095dc8f641a5805f">maxsize</a>, 0, maxsize);
<a name="l01657"></a>01657         
<a name="l01658"></a>01658         <span class="comment">/* add temp handler */</span>
<a name="l01659"></a>01659         <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l01660"></a>01660         
<a name="l01661"></a>01661         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l01662"></a>01662     }
<a name="l01663"></a>01663     
<a name="l01664"></a>01664     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01665"></a>01665 }
<a name="l01666"></a>01666 
<a name="l01667"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a9dd059ac34dda2c786cc255ec67696cf">01667</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a9dd059ac34dda2c786cc255ec67696cf">region_scale_get_maxsize</a>(<a class="code" href="../../d6/dba/structRegionMoveData.html">RegionMoveData</a> *rmd)
<a name="l01668"></a>01668 {
<a name="l01669"></a>01669     <span class="keywordtype">int</span> maxsize= 0;
<a name="l01670"></a>01670 
<a name="l01671"></a>01671     <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a61e988fbac4e5a0b6f160b766cf89c8c">AE_LEFT_TO_TOPRIGHT</a> || rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a7bbe94b2d8cf2a57e13a5687b1a697bb">AE_RIGHT_TO_TOPLEFT</a>) {
<a name="l01672"></a>01672         <span class="keywordflow">return</span> rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">sa</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a8875e00cdc1e130b8267c63b9cc0558e">winx</a> - <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>;
<a name="l01673"></a>01673     }
<a name="l01674"></a>01674 
<a name="l01675"></a>01675     <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2aef41b39373a2eb1b6497f25ce95c05e3">RGN_TYPE_TOOL_PROPS</a>) {
<a name="l01676"></a>01676         <span class="comment">/* this calculation seems overly verbose</span>
<a name="l01677"></a>01677 <span class="comment">         * can someone explain why this method is necessary? - campbell */</span>
<a name="l01678"></a>01678         maxsize = rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a386b94b1feafe280095dc8f641a5805f">maxsize</a> - ((rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">sa</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ab35681127748c4f7d1fd6f351f69b413">headertype</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a1612ae5b6ebef20615cf857993debc9d">HEADERTOP</a>)?<a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>*2:<a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>) - (UI_UNIT_Y/4);
<a name="l01679"></a>01679     }
<a name="l01680"></a>01680 
<a name="l01681"></a>01681     <span class="keywordflow">return</span> maxsize;
<a name="l01682"></a>01682 }
<a name="l01683"></a>01683 
<a name="l01684"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a2d696cb5bdef23415d82d6226b88ed11">01684</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a2d696cb5bdef23415d82d6226b88ed11">region_scale_validate_size</a>(<a class="code" href="../../d6/dba/structRegionMoveData.html">RegionMoveData</a> *rmd)
<a name="l01685"></a>01685 {
<a name="l01686"></a>01686     <span class="keywordflow">if</span> ((rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>)==0) {
<a name="l01687"></a>01687         <span class="keywordtype">short</span> *<a class="code" href="../../d8/d40/btDbvt_8cpp.html#a0dbff19ad8155e43555569d371ad95a1">size</a>, maxsize= -1;
<a name="l01688"></a>01688 
<a name="l01689"></a>01689 
<a name="l01690"></a>01690         <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a61e988fbac4e5a0b6f160b766cf89c8c">AE_LEFT_TO_TOPRIGHT</a> || rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a7bbe94b2d8cf2a57e13a5687b1a697bb">AE_RIGHT_TO_TOPLEFT</a>)
<a name="l01691"></a>01691             size= &amp;rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a>;
<a name="l01692"></a>01692         <span class="keywordflow">else</span>
<a name="l01693"></a>01693             size= &amp;rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>;
<a name="l01694"></a>01694 
<a name="l01695"></a>01695         maxsize= <a class="code" href="../../d6/d78/screen__ops_8c.html#a9dd059ac34dda2c786cc255ec67696cf">region_scale_get_maxsize</a>(rmd);
<a name="l01696"></a>01696 
<a name="l01697"></a>01697         <span class="keywordflow">if</span> (*size &gt; maxsize &amp;&amp; maxsize &gt; 0)
<a name="l01698"></a>01698             *size= maxsize;
<a name="l01699"></a>01699     }
<a name="l01700"></a>01700 }
<a name="l01701"></a>01701 
<a name="l01702"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a564b30c736b5a6d07661027e27b2a2fb">01702</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a564b30c736b5a6d07661027e27b2a2fb">region_scale_toggle_hidden</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d6/dba/structRegionMoveData.html">RegionMoveData</a> *rmd)
<a name="l01703"></a>01703 {
<a name="l01704"></a>01704     <a class="code" href="../../d1/d12/ED__screen_8h.html#a51b56d6a91ecd2fd3aac98659c8db1b6">ED_region_toggle_hidden</a>(C, rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>);
<a name="l01705"></a>01705     <a class="code" href="../../d6/d78/screen__ops_8c.html#a2d696cb5bdef23415d82d6226b88ed11">region_scale_validate_size</a>(rmd);
<a name="l01706"></a>01706 }
<a name="l01707"></a>01707 
<a name="l01708"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a41cf34ef8b51444f164e1572ee248da1">01708</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a41cf34ef8b51444f164e1572ee248da1">region_scale_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l01709"></a>01709 {
<a name="l01710"></a>01710     <a class="code" href="../../d6/dba/structRegionMoveData.html">RegionMoveData</a> *rmd= op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l01711"></a>01711     <span class="keywordtype">int</span> delta;
<a name="l01712"></a>01712     
<a name="l01713"></a>01713     <span class="comment">/* execute the events */</span>
<a name="l01714"></a>01714     <span class="keywordflow">switch</span>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>) {
<a name="l01715"></a>01715         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#aa58b8b831d49bfef312f9ae99d742aae">MOUSEMOVE</a>:
<a name="l01716"></a>01716             
<a name="l01717"></a>01717             <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a61e988fbac4e5a0b6f160b766cf89c8c">AE_LEFT_TO_TOPRIGHT</a> || rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a7bbe94b2d8cf2a57e13a5687b1a697bb">AE_RIGHT_TO_TOPLEFT</a>) {
<a name="l01718"></a>01718                 delta= <span class="keyword">event</span>-&gt;x - rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#ace59a413e0481c00dd1505074551aaa9">origx</a>;
<a name="l01719"></a>01719                 <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a61e988fbac4e5a0b6f160b766cf89c8c">AE_LEFT_TO_TOPRIGHT</a>) delta= -delta;
<a name="l01720"></a>01720                 
<a name="l01721"></a>01721                 rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a01b496b15b81dae694c4577e5be58c60">origval</a> + delta;
<a name="l01722"></a>01722                 <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a>, 0, rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a386b94b1feafe280095dc8f641a5805f">maxsize</a>);
<a name="l01723"></a>01723                 
<a name="l01724"></a>01724                 <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a> &lt; <a class="code" href="../../d8/d1e/UI__interface_8h.html#ad9963844aa21423f54e23c6746f5bd07">UI_UNIT_X</a>) {
<a name="l01725"></a>01725                     rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a8caddae8aaa04144c6ad80721ec6213b">sizex</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a01b496b15b81dae694c4577e5be58c60">origval</a>;
<a name="l01726"></a>01726                     <span class="keywordflow">if</span> (!(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>))
<a name="l01727"></a>01727                         <a class="code" href="../../d6/d78/screen__ops_8c.html#a564b30c736b5a6d07661027e27b2a2fb">region_scale_toggle_hidden</a>(C, rmd);
<a name="l01728"></a>01728                 }
<a name="l01729"></a>01729                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>)
<a name="l01730"></a>01730                     <a class="code" href="../../d6/d78/screen__ops_8c.html#a564b30c736b5a6d07661027e27b2a2fb">region_scale_toggle_hidden</a>(C, rmd);
<a name="l01731"></a>01731             }
<a name="l01732"></a>01732             <span class="keywordflow">else</span> {
<a name="l01733"></a>01733                 <span class="keywordtype">int</span> maxsize= <a class="code" href="../../d6/d78/screen__ops_8c.html#a9dd059ac34dda2c786cc255ec67696cf">region_scale_get_maxsize</a>(rmd);
<a name="l01734"></a>01734                 delta= <span class="keyword">event</span>-&gt;y - rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a4ea3c9f7bead5f75670ea1550c6f5822">origy</a>;
<a name="l01735"></a>01735                 <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a1beb65c478b15010c491d167e90654b8">edge</a>==<a class="code" href="../../d1/d85/ED__screen__types_8h.html#aeb426c1bfa45224413b4160410a53050a841115d7bd473274829817833fdb1771">AE_BOTTOM_TO_TOPLEFT</a>) delta= -delta;
<a name="l01736"></a>01736                 
<a name="l01737"></a>01737                 rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a01b496b15b81dae694c4577e5be58c60">origval</a> + delta;
<a name="l01738"></a>01738                 <a class="code" href="../../dd/d46/IMAGE_8h.html#a7abc68f3eacc2822738f41c9f08feca6">CLAMP</a>(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>, 0, rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a386b94b1feafe280095dc8f641a5805f">maxsize</a>);
<a name="l01739"></a>01739 
<a name="l01740"></a>01740                 <span class="comment">/* note, &#39;UI_UNIT_Y/4&#39; means you need to drag the header almost</span>
<a name="l01741"></a>01741 <span class="comment">                 * all the way down for it to become hidden, this is done</span>
<a name="l01742"></a>01742 <span class="comment">                 * otherwise its too easy to do this by accident */</span>
<a name="l01743"></a>01743                 <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a> &lt; <a class="code" href="../../d8/d1e/UI__interface_8h.html#a07a4d52f535e8a85b1550584847132d8">UI_UNIT_Y</a>/4) {
<a name="l01744"></a>01744                     rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>= rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a01b496b15b81dae694c4577e5be58c60">origval</a>;
<a name="l01745"></a>01745                     <span class="keywordflow">if</span> (!(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>))
<a name="l01746"></a>01746                         <a class="code" href="../../d6/d78/screen__ops_8c.html#a564b30c736b5a6d07661027e27b2a2fb">region_scale_toggle_hidden</a>(C, rmd);
<a name="l01747"></a>01747                 }
<a name="l01748"></a>01748                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxsize &gt; 0 &amp;&amp; (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a> &gt; maxsize)) 
<a name="l01749"></a>01749                     rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a31a64e96feb835dca1c02129971b1f0e">sizey</a>= maxsize;
<a name="l01750"></a>01750                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>)
<a name="l01751"></a>01751                     <a class="code" href="../../d6/d78/screen__ops_8c.html#a564b30c736b5a6d07661027e27b2a2fb">region_scale_toggle_hidden</a>(C, rmd);
<a name="l01752"></a>01752             }
<a name="l01753"></a>01753             <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">sa</a>);
<a name="l01754"></a>01754             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01755"></a>01755             
<a name="l01756"></a>01756             <span class="keywordflow">break</span>;
<a name="l01757"></a>01757             
<a name="l01758"></a>01758         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>:
<a name="l01759"></a>01759             <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a>==<a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>) {
<a name="l01760"></a>01760                 
<a name="l01761"></a>01761                 <span class="keywordflow">if</span> (<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a> - rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#ace59a413e0481c00dd1505074551aaa9">origx</a>) &lt; 2 &amp;&amp; <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#ae2f08dc603ae93c402abd918ba4e23e1">ABS</a>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a> - rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#a4ea3c9f7bead5f75670ea1550c6f5822">origy</a>) &lt; 2) {
<a name="l01762"></a>01762                     <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a45948a913af510c6e98f8d448ac360eb">RGN_FLAG_HIDDEN</a>) {
<a name="l01763"></a>01763                         <a class="code" href="../../d6/d78/screen__ops_8c.html#a564b30c736b5a6d07661027e27b2a2fb">region_scale_toggle_hidden</a>(C, rmd);
<a name="l01764"></a>01764                     }
<a name="l01765"></a>01765                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aed7dcbe7bc40328fcf39f7bcfd866f34">ar</a>-&gt;<a class="code" href="../../da/d23/structARegion.html#a6f2584ecbfa3cdef91e6e2f740975ceb">flag</a> &amp; <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab28514a6a5c38149e23f262d2545e6d0">RGN_FLAG_TOO_SMALL</a>) {
<a name="l01766"></a>01766                         <a class="code" href="../../d6/d78/screen__ops_8c.html#a2d696cb5bdef23415d82d6226b88ed11">region_scale_validate_size</a>(rmd);
<a name="l01767"></a>01767                     }
<a name="l01768"></a>01768 
<a name="l01769"></a>01769                     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(rmd-&gt;<a class="code" href="../../d6/dba/structRegionMoveData.html#aadc429617f66d2a620ba0ce3c2eb0ba3">sa</a>);
<a name="l01770"></a>01770                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01771"></a>01771                 }
<a name="l01772"></a>01772                 <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>);
<a name="l01773"></a>01773                 op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01774"></a>01774                 
<a name="l01775"></a>01775                 <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01776"></a>01776             }
<a name="l01777"></a>01777             <span class="keywordflow">break</span>;
<a name="l01778"></a>01778             
<a name="l01779"></a>01779         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>:
<a name="l01780"></a>01780             ;
<a name="l01781"></a>01781     }
<a name="l01782"></a>01782     
<a name="l01783"></a>01783     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l01784"></a>01784 }
<a name="l01785"></a>01785 
<a name="l01786"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a322d66ddc5a7a5f0d0c9d2249517e71f">01786</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a322d66ddc5a7a5f0d0c9d2249517e71f">region_scale_cancel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>), <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01787"></a>01787 {
<a name="l01788"></a>01788     <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>);
<a name="l01789"></a>01789     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01790"></a>01790 
<a name="l01791"></a>01791     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01792"></a>01792 }
<a name="l01793"></a>01793 
<a name="l01794"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a19eaca03e59bac10fcee40a426d8f060">01794</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a19eaca03e59bac10fcee40a426d8f060">SCREEN_OT_region_scale</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01795"></a>01795 {
<a name="l01796"></a>01796     <span class="comment">/* identifiers */</span>
<a name="l01797"></a>01797     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Scale Region Size&quot;</span>;
<a name="l01798"></a>01798     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Scale selected area&quot;</span>;
<a name="l01799"></a>01799     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_region_scale&quot;</span>;
<a name="l01800"></a>01800     
<a name="l01801"></a>01801     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#abcad200f0a12bcf32283987d93b6675b">region_scale_invoke</a>;
<a name="l01802"></a>01802     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a41cf34ef8b51444f164e1572ee248da1">region_scale_modal</a>;
<a name="l01803"></a>01803     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a322d66ddc5a7a5f0d0c9d2249517e71f">region_scale_cancel</a>;
<a name="l01804"></a>01804     
<a name="l01805"></a>01805     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>;
<a name="l01806"></a>01806     
<a name="l01807"></a>01807     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a2458c730dbcabf67cc8917d8de127bab">OPTYPE_BLOCKING</a>;
<a name="l01808"></a>01808 }
<a name="l01809"></a>01809 
<a name="l01810"></a>01810 
<a name="l01811"></a>01811 <span class="comment">/* ************** frame change operator ***************************** */</span>
<a name="l01812"></a>01812 
<a name="l01813"></a>01813 <span class="comment">/* function to be called outside UI context, or for redo */</span>
<a name="l01814"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aa7fc4600782f0291304c460540e30ea3">01814</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aa7fc4600782f0291304c460540e30ea3">frame_offset_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01815"></a>01815 {
<a name="l01816"></a>01816     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l01817"></a>01817     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01818"></a>01818     <span class="keywordtype">int</span> delta;
<a name="l01819"></a>01819     
<a name="l01820"></a>01820     delta = <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;delta&quot;</span>);
<a name="l01821"></a>01821 
<a name="l01822"></a>01822     <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a> += delta;
<a name="l01823"></a>01823     <a class="code" href="../../d7/de4/DNA__userdef__types_8h.html#a1184b2145b33a73fcc3dc764f3a2fddb">FRAMENUMBER_MIN_CLAMP</a>(<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>);
<a name="l01824"></a>01824     <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a082349bb8880b731aee02266c5814a97">SUBFRA</a> = 0.f;
<a name="l01825"></a>01825     
<a name="l01826"></a>01826     <a class="code" href="../../d2/db1/BKE__sound_8h.html#aaf31981e9beb2936a88aa3a70f5b4839">sound_seek_scene</a>(bmain, scene);
<a name="l01827"></a>01827 
<a name="l01828"></a>01828     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>, <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C));
<a name="l01829"></a>01829     
<a name="l01830"></a>01830     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01831"></a>01831 }
<a name="l01832"></a>01832 
<a name="l01833"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a87f49b7a703c958875441ca1fbd74c55">01833</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a87f49b7a703c958875441ca1fbd74c55">SCREEN_OT_frame_offset</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01834"></a>01834 {
<a name="l01835"></a>01835     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Frame Offset&quot;</span>;
<a name="l01836"></a>01836     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_frame_offset&quot;</span>;
<a name="l01837"></a>01837     
<a name="l01838"></a>01838     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#aa7fc4600782f0291304c460540e30ea3">frame_offset_exec</a>;
<a name="l01839"></a>01839     
<a name="l01840"></a>01840     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3fcd41f2e293effecc1ee455dcb51cb9">ED_operator_screenactive_norender</a>;
<a name="l01841"></a>01841     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l01842"></a>01842     
<a name="l01843"></a>01843     <span class="comment">/* rna */</span>
<a name="l01844"></a>01844     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;delta&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Delta&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l01845"></a>01845 }
<a name="l01846"></a>01846 
<a name="l01847"></a>01847 
<a name="l01848"></a>01848 <span class="comment">/* function to be called outside UI context, or for redo */</span>
<a name="l01849"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a0b614c77398870387d745125e0f79721">01849</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a0b614c77398870387d745125e0f79721">frame_jump_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01850"></a>01850 {
<a name="l01851"></a>01851     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l01852"></a>01852     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01853"></a>01853     <a class="code" href="../../d9/d33/structwmTimer.html">wmTimer</a> *animtimer= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C)-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>;
<a name="l01854"></a>01854 
<a name="l01855"></a>01855     <span class="comment">/* Don&#39;t change CFRA directly if animtimer is running as this can cause</span>
<a name="l01856"></a>01856 <span class="comment">     * first/last frame not to be actually shown (bad since for example physics</span>
<a name="l01857"></a>01857 <span class="comment">     * simulations aren&#39;t reset properly).</span>
<a name="l01858"></a>01858 <span class="comment">     */</span>
<a name="l01859"></a>01859     <span class="keywordflow">if</span> (animtimer) {
<a name="l01860"></a>01860         <a class="code" href="../../d3/d73/structScreenAnimData.html">ScreenAnimData</a> *sad = animtimer-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#a7e5850b6474f3948cb59cbd188ce68a6">customdata</a>;
<a name="l01861"></a>01861         
<a name="l01862"></a>01862         sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> |= <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdae53dcea0ab5c13ee75b3817ced6078a9">ANIMPLAY_FLAG_USE_NEXT_FRAME</a>;
<a name="l01863"></a>01863         
<a name="l01864"></a>01864         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;end&quot;</span>))
<a name="l01865"></a>01865             sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#a0361b7dd3ea8ab30e5760a55ce82b298">nextfra</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afd077e3f9ae593b4d1bac88ea876e047">PEFRA</a>;
<a name="l01866"></a>01866         <span class="keywordflow">else</span>
<a name="l01867"></a>01867             sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#a0361b7dd3ea8ab30e5760a55ce82b298">nextfra</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a46f444644a762bb20f43197274c1b3f2">PSFRA</a>;
<a name="l01868"></a>01868     }
<a name="l01869"></a>01869     <span class="keywordflow">else</span> {
<a name="l01870"></a>01870         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;end&quot;</span>))
<a name="l01871"></a>01871             <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#afd077e3f9ae593b4d1bac88ea876e047">PEFRA</a>;
<a name="l01872"></a>01872         <span class="keywordflow">else</span>
<a name="l01873"></a>01873             <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>= <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a46f444644a762bb20f43197274c1b3f2">PSFRA</a>;
<a name="l01874"></a>01874         
<a name="l01875"></a>01875         <a class="code" href="../../d2/db1/BKE__sound_8h.html#aaf31981e9beb2936a88aa3a70f5b4839">sound_seek_scene</a>(bmain, scene);
<a name="l01876"></a>01876 
<a name="l01877"></a>01877         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>, scene);
<a name="l01878"></a>01878     }
<a name="l01879"></a>01879     
<a name="l01880"></a>01880     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01881"></a>01881 }
<a name="l01882"></a>01882 
<a name="l01883"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a623f48a74b5e20ff586dfc2585783c33">01883</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a623f48a74b5e20ff586dfc2585783c33">SCREEN_OT_frame_jump</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01884"></a>01884 {
<a name="l01885"></a>01885     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Jump to Endpoint&quot;</span>;
<a name="l01886"></a>01886     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Jump to first/last frame in frame range&quot;</span>;
<a name="l01887"></a>01887     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_frame_jump&quot;</span>;
<a name="l01888"></a>01888     
<a name="l01889"></a>01889     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a0b614c77398870387d745125e0f79721">frame_jump_exec</a>;
<a name="l01890"></a>01890     
<a name="l01891"></a>01891     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3fcd41f2e293effecc1ee455dcb51cb9">ED_operator_screenactive_norender</a>;
<a name="l01892"></a>01892     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01893"></a>01893     
<a name="l01894"></a>01894     <span class="comment">/* rna */</span>
<a name="l01895"></a>01895     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;end&quot;</span>, 0, <span class="stringliteral">&quot;Last Frame&quot;</span>, <span class="stringliteral">&quot;Jump to the last frame of the frame range&quot;</span>);
<a name="l01896"></a>01896 }
<a name="l01897"></a>01897 
<a name="l01898"></a>01898 
<a name="l01899"></a>01899 <span class="comment">/* ************** jump to keyframe operator ***************************** */</span>
<a name="l01900"></a>01900 
<a name="l01901"></a>01901 <span class="comment">/* function to be called outside UI context, or for redo */</span>
<a name="l01902"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#af7d7a347c9bf57ea6b512d346a1253d2">01902</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#af7d7a347c9bf57ea6b512d346a1253d2">keyframe_jump_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01903"></a>01903 {
<a name="l01904"></a>01904     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l01905"></a>01905     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l01906"></a>01906     <a class="code" href="../../de/de7/structObject.html">Object</a> *ob= <a class="code" href="../../df/d01/BKE__context_8h.html#a86fd97bb1e59c64106c001ab29db25c7">CTX_data_active_object</a>(C);
<a name="l01907"></a>01907     <a class="code" href="../../df/de9/structbDopeSheet.html">bDopeSheet</a> ads= {<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>};
<a name="l01908"></a>01908     <a class="code" href="../../d1/d5d/structDLRBT__Tree.html">DLRBT_Tree</a> keys;
<a name="l01909"></a>01909     <a class="code" href="../../dc/d1c/structActKeyColumn.html">ActKeyColumn</a> *ak;
<a name="l01910"></a>01910     <span class="keywordtype">float</span> cfra;
<a name="l01911"></a>01911     <span class="keywordtype">short</span> <a class="code" href="../../d3/d41/mathutils__noise_8c.html#ac68daf2bcc2adb77f62b5dd17eb769b7">next</a>= <a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;next&quot;</span>);
<a name="l01912"></a>01912     <span class="keywordtype">short</span> done = 0;
<a name="l01913"></a>01913     
<a name="l01914"></a>01914     <span class="comment">/* sanity checks */</span>
<a name="l01915"></a>01915     <span class="keywordflow">if</span> (scene == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01916"></a>01916         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01917"></a>01917 
<a name="l01918"></a>01918     cfra= (float)(<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>);
<a name="l01919"></a>01919 
<a name="l01920"></a>01920     <span class="comment">/* init binarytree-list for getting keyframes */</span>
<a name="l01921"></a>01921     <a class="code" href="../../de/d11/BLI__dlrbTree_8h.html#a252f6abeef3b6e861da84630cbdbb02b">BLI_dlrbTree_init</a>(&amp;keys);
<a name="l01922"></a>01922     
<a name="l01923"></a>01923     <span class="comment">/* populate tree with keyframe nodes */</span>
<a name="l01924"></a>01924     <a class="code" href="../../d4/d5f/keyframes__draw_8c.html#a509a1ed892203dd7b0b72823d7b98437">scene_to_keylist</a>(&amp;ads, scene, &amp;keys, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01925"></a>01925 
<a name="l01926"></a>01926     <span class="keywordflow">if</span> (ob)
<a name="l01927"></a>01927         <a class="code" href="../../d4/d5f/keyframes__draw_8c.html#a2d5365a1339cbef0ec6cbe39a14ab37c">ob_to_keylist</a>(&amp;ads, ob, &amp;keys, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01928"></a>01928     
<a name="l01929"></a>01929     <span class="comment">/* build linked-list for searching */</span>
<a name="l01930"></a>01930     <a class="code" href="../../de/d11/BLI__dlrbTree_8h.html#a90a980516f029c7f9ddb3d854cc37bb7">BLI_dlrbTree_linkedlist_sync</a>(&amp;keys);
<a name="l01931"></a>01931     
<a name="l01932"></a>01932     <span class="comment">/* find matching keyframe in the right direction */</span>
<a name="l01933"></a>01933     <span class="keywordflow">do</span> {
<a name="l01934"></a>01934         <span class="keywordflow">if</span> (next)
<a name="l01935"></a>01935             ak= (<a class="code" href="../../dc/d1c/structActKeyColumn.html">ActKeyColumn</a> *)<a class="code" href="../../de/d11/BLI__dlrbTree_8h.html#af832876ce373e013985f231c264a2437">BLI_dlrbTree_search_next</a>(&amp;keys, <a class="code" href="../../d4/d5f/keyframes__draw_8c.html#a8c8eb077f4beaf1835776f05ca3a307f">compare_ak_cfraPtr</a>, &amp;cfra);
<a name="l01936"></a>01936         <span class="keywordflow">else</span>
<a name="l01937"></a>01937             ak= (<a class="code" href="../../dc/d1c/structActKeyColumn.html">ActKeyColumn</a> *)<a class="code" href="../../de/d11/BLI__dlrbTree_8h.html#afff10808c3fc68c746cff8553b087f19">BLI_dlrbTree_search_prev</a>(&amp;keys, <a class="code" href="../../d4/d5f/keyframes__draw_8c.html#a8c8eb077f4beaf1835776f05ca3a307f">compare_ak_cfraPtr</a>, &amp;cfra);
<a name="l01938"></a>01938         
<a name="l01939"></a>01939         <span class="keywordflow">if</span> (ak) {
<a name="l01940"></a>01940             <span class="keywordflow">if</span> (<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a> != (<span class="keywordtype">int</span>)ak-&gt;<a class="code" href="../../dc/d1c/structActKeyColumn.html#a9f7f4be8fe9ff797a55d90d0db3661e0">cfra</a>) {
<a name="l01941"></a>01941                 <span class="comment">/* this changes the frame, so set the frame and we&#39;re done */</span>
<a name="l01942"></a>01942                 <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a3619c6f2d3bfb9dbb64eeb250fd5fdcb">CFRA</a>= (int)ak-&gt;<a class="code" href="../../dc/d1c/structActKeyColumn.html#a9f7f4be8fe9ff797a55d90d0db3661e0">cfra</a>;
<a name="l01943"></a>01943                 done = 1;
<a name="l01944"></a>01944             }
<a name="l01945"></a>01945             <span class="keywordflow">else</span> {
<a name="l01946"></a>01946                 <span class="comment">/* make this the new starting point for the search */</span>
<a name="l01947"></a>01947                 cfra = ak-&gt;<a class="code" href="../../dc/d1c/structActKeyColumn.html#a9f7f4be8fe9ff797a55d90d0db3661e0">cfra</a>;
<a name="l01948"></a>01948             }
<a name="l01949"></a>01949         }
<a name="l01950"></a>01950     } <span class="keywordflow">while</span> ((ak != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (done == 0));
<a name="l01951"></a>01951     
<a name="l01952"></a>01952     <span class="comment">/* any success? */</span>
<a name="l01953"></a>01953     <span class="keywordflow">if</span> (done == 0)
<a name="l01954"></a>01954         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a1c418509aad2eb64fd806b8a99d29f7d">RPT_INFO</a>, <span class="stringliteral">&quot;No more keyframes to jump to in this direction&quot;</span>);
<a name="l01955"></a>01955     
<a name="l01956"></a>01956     <span class="comment">/* free temp stuff */</span>
<a name="l01957"></a>01957     <a class="code" href="../../de/d11/BLI__dlrbTree_8h.html#af6bec977f19ccbbea32e1aec6ed00341">BLI_dlrbTree_free</a>(&amp;keys);
<a name="l01958"></a>01958     
<a name="l01959"></a>01959     <a class="code" href="../../d2/db1/BKE__sound_8h.html#aaf31981e9beb2936a88aa3a70f5b4839">sound_seek_scene</a>(bmain, scene);
<a name="l01960"></a>01960 
<a name="l01961"></a>01961     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>, scene);
<a name="l01962"></a>01962     
<a name="l01963"></a>01963     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l01964"></a>01964 }
<a name="l01965"></a>01965 
<a name="l01966"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a59f89f13f32a948b5f5e8ed363066339">01966</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a59f89f13f32a948b5f5e8ed363066339">SCREEN_OT_keyframe_jump</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l01967"></a>01967 {
<a name="l01968"></a>01968     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Jump to Keyframe&quot;</span>;
<a name="l01969"></a>01969     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Jump to previous/next keyframe&quot;</span>;
<a name="l01970"></a>01970     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_keyframe_jump&quot;</span>;
<a name="l01971"></a>01971     
<a name="l01972"></a>01972     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#af7d7a347c9bf57ea6b512d346a1253d2">keyframe_jump_exec</a>;
<a name="l01973"></a>01973     
<a name="l01974"></a>01974     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3fcd41f2e293effecc1ee455dcb51cb9">ED_operator_screenactive_norender</a>;
<a name="l01975"></a>01975     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l01976"></a>01976     
<a name="l01977"></a>01977     <span class="comment">/* rna */</span>
<a name="l01978"></a>01978     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;next&quot;</span>, 1, <span class="stringliteral">&quot;Next Keyframe&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01979"></a>01979 }
<a name="l01980"></a>01980 
<a name="l01981"></a>01981 <span class="comment">/* ************** switch screen operator ***************************** */</span>
<a name="l01982"></a>01982 
<a name="l01983"></a>01983 
<a name="l01984"></a>01984 <span class="comment">/* function to be called outside UI context, or for redo */</span>
<a name="l01985"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#af9298799e3c7fdabc75688274fc21afb">01985</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#af9298799e3c7fdabc75688274fc21afb">screen_set_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l01986"></a>01986 {
<a name="l01987"></a>01987     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l01988"></a>01988     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen_prev= screen;
<a name="l01989"></a>01989     
<a name="l01990"></a>01990     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l01991"></a>01991     <span class="keywordtype">int</span> tot= <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aa3b37105a0793ac30946a6d220ee97d7">BLI_countlist</a>(&amp;<a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C)-&gt;screen);
<a name="l01992"></a>01992     <span class="keywordtype">int</span> delta= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;delta&quot;</span>);
<a name="l01993"></a>01993     
<a name="l01994"></a>01994     <span class="comment">/* temp screens are for userpref or render display */</span>
<a name="l01995"></a>01995     <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae4c1fae9fb86f1ad80ae280be436cb75">temp</a>)
<a name="l01996"></a>01996         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l01997"></a>01997     
<a name="l01998"></a>01998     <span class="keywordflow">if</span> (delta==1) {
<a name="l01999"></a>01999         <span class="keywordflow">while</span> (tot--) {
<a name="l02000"></a>02000             screen= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ac661d280cae6952ebc9f9c95279cf6f2">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>;
<a name="l02001"></a>02001             <span class="keywordflow">if</span> (screen==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) screen= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C)-&gt;<a class="code" href="../../d0/dc0/structMain.html#a3ab31640766afea3c151a816eb70e691">screen</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l02002"></a>02002             <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#a022929944b7229e3652332ef1fcf30ab">winid</a>==0 &amp;&amp; screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#afe2ef870210be87541acaac1ce677776">full</a>==0 &amp;&amp; screen != screen_prev)
<a name="l02003"></a>02003                 <span class="keywordflow">break</span>;
<a name="l02004"></a>02004         }
<a name="l02005"></a>02005     }
<a name="l02006"></a>02006     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (delta== -1) {
<a name="l02007"></a>02007         <span class="keywordflow">while</span> (tot--) {
<a name="l02008"></a>02008             screen= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ac661d280cae6952ebc9f9c95279cf6f2">id</a>.<a class="code" href="../../d8/d7e/structID.html#a9a2218bf385c8094a8ad82b78e80aebe">prev</a>;
<a name="l02009"></a>02009             <span class="keywordflow">if</span> (screen==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) screen= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C)-&gt;<a class="code" href="../../d0/dc0/structMain.html#a3ab31640766afea3c151a816eb70e691">screen</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l02010"></a>02010             <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#a022929944b7229e3652332ef1fcf30ab">winid</a>==0 &amp;&amp; screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#afe2ef870210be87541acaac1ce677776">full</a>==0 &amp;&amp; screen != screen_prev)
<a name="l02011"></a>02011                 <span class="keywordflow">break</span>;
<a name="l02012"></a>02012         }
<a name="l02013"></a>02013     }
<a name="l02014"></a>02014     <span class="keywordflow">else</span> {
<a name="l02015"></a>02015         screen= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02016"></a>02016     }
<a name="l02017"></a>02017     
<a name="l02018"></a>02018     <span class="keywordflow">if</span> (screen &amp;&amp; screen_prev != screen) {
<a name="l02019"></a>02019         <span class="comment">/* return to previous state before switching screens */</span>
<a name="l02020"></a>02020         <span class="keywordflow">if</span> (sa &amp;&amp; sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a62b30afc9f5a2f501be12a0917cebe35">full</a>) {
<a name="l02021"></a>02021             <a class="code" href="../../d1/d12/ED__screen_8h.html#aa9ce9ca868cc6327957c5d0b542100f8">ED_screen_full_restore</a>(C, sa); <span class="comment">/* may free &#39;screen_prev&#39; */</span>
<a name="l02022"></a>02022         }
<a name="l02023"></a>02023         
<a name="l02024"></a>02024         <a class="code" href="../../d1/d12/ED__screen_8h.html#a5055a39580a193e017808b6f51a0c8a3">ED_screen_set</a>(C, screen);
<a name="l02025"></a>02025         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02026"></a>02026     }
<a name="l02027"></a>02027     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02028"></a>02028 }
<a name="l02029"></a>02029 
<a name="l02030"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#abe98b823491723b088811cad75c09721">02030</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#abe98b823491723b088811cad75c09721">SCREEN_OT_screen_set</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02031"></a>02031 {
<a name="l02032"></a>02032     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Set Screen&quot;</span>;
<a name="l02033"></a>02033     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Cycle through available screens&quot;</span>;
<a name="l02034"></a>02034     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_screen_set&quot;</span>;
<a name="l02035"></a>02035     
<a name="l02036"></a>02036     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#af9298799e3c7fdabc75688274fc21afb">screen_set_exec</a>;
<a name="l02037"></a>02037     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>;
<a name="l02038"></a>02038     
<a name="l02039"></a>02039     <span class="comment">/* rna */</span>
<a name="l02040"></a>02040     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;delta&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Delta&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l02041"></a>02041 }
<a name="l02042"></a>02042 
<a name="l02043"></a>02043 <span class="comment">/* ************** screen full-area operator ***************************** */</span>
<a name="l02044"></a>02044 
<a name="l02045"></a>02045 
<a name="l02046"></a>02046 <span class="comment">/* function to be called outside UI context, or for redo */</span>
<a name="l02047"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a67586d5e73f19d46c173b29eb280555d">02047</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a67586d5e73f19d46c173b29eb280555d">screen_full_area_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../d7/d0d/node__texture__proc_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02048"></a>02048 {
<a name="l02049"></a>02049     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen = <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l02050"></a>02050     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02051"></a>02051     
<a name="l02052"></a>02052     <span class="comment">/* search current screen for &#39;fullscreen&#39; areas */</span>
<a name="l02053"></a>02053     <span class="comment">/* prevents restoring info header, when mouse is over it */</span>
<a name="l02054"></a>02054     <span class="keywordflow">for</span> (sa=screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa=sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l02055"></a>02055         <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a62b30afc9f5a2f501be12a0917cebe35">full</a>) <span class="keywordflow">break</span>;
<a name="l02056"></a>02056     }
<a name="l02057"></a>02057     
<a name="l02058"></a>02058     <span class="keywordflow">if</span> (sa==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02059"></a>02059     
<a name="l02060"></a>02060     <a class="code" href="../../d1/d12/ED__screen_8h.html#a7b2bf23245370fe77c68ea31ddb3b509">ED_screen_full_toggle</a>(C, <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C), sa);
<a name="l02061"></a>02061     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02062"></a>02062 }
<a name="l02063"></a>02063 
<a name="l02064"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a8370ea3c5ea82f94f6605e0b43c587fb">02064</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a8370ea3c5ea82f94f6605e0b43c587fb">SCREEN_OT_screen_full_area</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02065"></a>02065 {
<a name="l02066"></a>02066     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Toggle Full Screen&quot;</span>;
<a name="l02067"></a>02067     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Toggle display selected area as fullscreen&quot;</span>;
<a name="l02068"></a>02068     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_screen_full_area&quot;</span>;
<a name="l02069"></a>02069     
<a name="l02070"></a>02070     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a67586d5e73f19d46c173b29eb280555d">screen_full_area_exec</a>;
<a name="l02071"></a>02071     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>;
<a name="l02072"></a>02072     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l02073"></a>02073     
<a name="l02074"></a>02074 }
<a name="l02075"></a>02075 
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 
<a name="l02078"></a>02078 <span class="comment">/* ************** join area operator ********************************************** */</span>
<a name="l02079"></a>02079 
<a name="l02080"></a>02080 <span class="comment">/* operator state vars used:  </span>
<a name="l02081"></a>02081 <span class="comment"> * x1, y1     mouse coord in first area, which will disappear</span>
<a name="l02082"></a>02082 <span class="comment"> * x2, y2     mouse coord in 2nd area, which will become joined</span>
<a name="l02083"></a>02083 <span class="comment"> * </span>
<a name="l02084"></a>02084 <span class="comment"> * functions:</span>
<a name="l02085"></a>02085 <span class="comment"> * </span>
<a name="l02086"></a>02086 <span class="comment"> * init()   find edge based on state vars </span>
<a name="l02087"></a>02087 <span class="comment"> * test if the edge divides two areas, </span>
<a name="l02088"></a>02088 <span class="comment"> * store active and nonactive area,</span>
<a name="l02089"></a>02089 <span class="comment"> * </span>
<a name="l02090"></a>02090 <span class="comment"> * apply()  do the actual join</span>
<a name="l02091"></a>02091 <span class="comment"> * </span>
<a name="l02092"></a>02092 <span class="comment"> * exit()   cleanup, send notifier</span>
<a name="l02093"></a>02093 <span class="comment"> * </span>
<a name="l02094"></a>02094 <span class="comment"> * callbacks:</span>
<a name="l02095"></a>02095 <span class="comment"> * </span>
<a name="l02096"></a>02096 <span class="comment"> * exec()   calls init, apply, exit </span>
<a name="l02097"></a>02097 <span class="comment"> * </span>
<a name="l02098"></a>02098 <span class="comment"> * invoke() sets mouse coords in x,y</span>
<a name="l02099"></a>02099 <span class="comment"> * call init()</span>
<a name="l02100"></a>02100 <span class="comment"> * add modal handler</span>
<a name="l02101"></a>02101 <span class="comment"> * </span>
<a name="l02102"></a>02102 <span class="comment"> * modal()  accept modal events while doing it</span>
<a name="l02103"></a>02103 <span class="comment"> * call apply() with active window and nonactive window</span>
<a name="l02104"></a>02104 <span class="comment"> * call exit() and remove handler when LMB confirm</span>
<a name="l02105"></a>02105 <span class="comment"> */</span>
<a name="l02106"></a>02106 
<a name="l02107"></a><a class="code" href="../../dd/db2/structsAreaJoinData.html">02107</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a>
<a name="l02108"></a>02108 {
<a name="l02109"></a><a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">02109</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>;   <span class="comment">/* first area to be considered */</span>
<a name="l02110"></a><a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">02110</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>;   <span class="comment">/* second area to be considered */</span>
<a name="l02111"></a><a class="code" href="../../dd/db2/structsAreaJoinData.html#afffe7b2dd070a69e9fd5f468bec2fd68">02111</a>     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *<a class="code" href="../../dd/db2/structsAreaJoinData.html#afffe7b2dd070a69e9fd5f468bec2fd68">scr</a>;   <span class="comment">/* designed for removal */</span>
<a name="l02112"></a>02112 
<a name="l02113"></a>02113 } <a class="code" href="../../d6/d78/screen__ops_8c.html#ab66ffe7c5f80b487eaaaf399fd77fc6b">sAreaJoinData</a>;
<a name="l02114"></a>02114 
<a name="l02115"></a>02115 
<a name="l02116"></a>02116 <span class="comment">/* validate selection inside screen, set variables OK */</span>
<a name="l02117"></a>02117 <span class="comment">/* return 0: init failed */</span>
<a name="l02118"></a>02118 <span class="comment">/* XXX todo: find edge based on (x,y) and set other area? */</span>
<a name="l02119"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a66f7110e175ba9e4ec148710fa34354f">02119</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a66f7110e175ba9e4ec148710fa34354f">area_join_init</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02120"></a>02120 {
<a name="l02121"></a>02121     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa1, *sa2;
<a name="l02122"></a>02122     <a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a>* jd= <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02123"></a>02123     <span class="keywordtype">int</span> x1, y1;
<a name="l02124"></a>02124     <span class="keywordtype">int</span> x2, y2;
<a name="l02125"></a>02125     <span class="keywordtype">int</span> shared= 0;
<a name="l02126"></a>02126     
<a name="l02127"></a>02127     <span class="comment">/* required properties, make negative to get return 0 if not set by caller */</span>
<a name="l02128"></a>02128     x1= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;min_x&quot;</span>);
<a name="l02129"></a>02129     y1= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;min_y&quot;</span>);
<a name="l02130"></a>02130     x2= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;max_x&quot;</span>);
<a name="l02131"></a>02131     y2= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;max_y&quot;</span>);
<a name="l02132"></a>02132     
<a name="l02133"></a>02133     sa1 = <a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">screen_areahascursor</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), x1, y1);
<a name="l02134"></a>02134     sa2 = <a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">screen_areahascursor</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), x2, y2);
<a name="l02135"></a>02135     <span class="keywordflow">if</span> (sa1==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sa2==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sa1==sa2)
<a name="l02136"></a>02136         <span class="keywordflow">return</span> 0;
<a name="l02137"></a>02137     
<a name="l02138"></a>02138     <span class="comment">/* do areas share an edge? */</span>
<a name="l02139"></a>02139     <span class="keywordflow">if</span> (sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>) shared++; 
<a name="l02140"></a>02140     <span class="keywordflow">if</span> (sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>) shared++; 
<a name="l02141"></a>02141     <span class="keywordflow">if</span> (sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>) shared++; 
<a name="l02142"></a>02142     <span class="keywordflow">if</span> (sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a7effddf3fdd03c3528a5fa1386eb50e3">v1</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a06f4362dc9cfb0ce0c1a67f9d5c262c1">v2</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3c3020f6595c3466da40728d750554d2">v3</a> || sa1-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>==sa2-&gt;<a class="code" href="../../d4/d95/structScrArea.html#ac44f8d5f533f74f1612ab99953596d8a">v4</a>) shared++; 
<a name="l02143"></a>02143     <span class="keywordflow">if</span> (shared!=2) {
<a name="l02144"></a>02144         printf(<span class="stringliteral">&quot;areas don&#39;t share edge\n&quot;</span>);
<a name="l02145"></a>02145         <span class="keywordflow">return</span> 0;
<a name="l02146"></a>02146     }
<a name="l02147"></a>02147     
<a name="l02148"></a>02148     jd = (<a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a>*)<a class="code" href="../../da/d2b/mallocn_8c.html#ab1235f6c94203e95da6076dbeb355894">MEM_callocN</a>(<span class="keyword">sizeof</span> (<a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a>), <span class="stringliteral">&quot;op_area_join&quot;</span>);
<a name="l02149"></a>02149     
<a name="l02150"></a>02150     jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a> = sa1;
<a name="l02151"></a>02151     jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a3f1eabd0fa9d89c5a6dac55bc9acb487">AREA_FLAG_DRAWJOINFROM</a>;
<a name="l02152"></a>02152     jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a> = sa2;
<a name="l02153"></a>02153     jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02154"></a>02154     
<a name="l02155"></a>02155     op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>= jd;
<a name="l02156"></a>02156     
<a name="l02157"></a>02157     <span class="keywordflow">return</span> 1;
<a name="l02158"></a>02158 }
<a name="l02159"></a>02159 
<a name="l02160"></a>02160 <span class="comment">/* apply the join of the areas (space types) */</span>
<a name="l02161"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ae4ebf4e87b10811d034b708e683f0575">02161</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ae4ebf4e87b10811d034b708e683f0575">area_join_apply</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02162"></a>02162 {
<a name="l02163"></a>02163     <a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a> *jd = (<a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l02164"></a>02164     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (!jd) <span class="keywordflow">return</span> 0;
<a name="l02165"></a>02165     
<a name="l02166"></a>02166     <span class="keywordflow">if</span> (!<a class="code" href="../../da/dbc/screen__edit_8c.html#a73586812301934ae7613e653c116b065">screen_area_join</a>(C, <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>, jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>)) {
<a name="l02167"></a>02167         <span class="keywordflow">return</span> 0;
<a name="l02168"></a>02168     }
<a name="l02169"></a>02169     <span class="keywordflow">if</span> (<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C) == jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) {
<a name="l02170"></a>02170         <a class="code" href="../../df/d01/BKE__context_8h.html#af38e3db529bba2578831bbe57940570b">CTX_wm_area_set</a>(C, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02171"></a>02171         <a class="code" href="../../df/d01/BKE__context_8h.html#a2406677d500d1744af5e9e56c210590b">CTX_wm_region_set</a>(C, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02172"></a>02172     }
<a name="l02173"></a>02173     
<a name="l02174"></a>02174     <span class="keywordflow">return</span> 1;
<a name="l02175"></a>02175 }
<a name="l02176"></a>02176 
<a name="l02177"></a>02177 <span class="comment">/* finish operation */</span>
<a name="l02178"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aed3ac8f17b3fa090eb5e028d76f087eb">02178</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aed3ac8f17b3fa090eb5e028d76f087eb">area_join_exit</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02179"></a>02179 {
<a name="l02180"></a>02180     <span class="keywordflow">if</span> (op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>) {
<a name="l02181"></a>02181         <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>);
<a name="l02182"></a>02182         op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02183"></a>02183     }
<a name="l02184"></a>02184     
<a name="l02185"></a>02185     <span class="comment">/* this makes sure aligned edges will result in aligned grabbing */</span>
<a name="l02186"></a>02186     <a class="code" href="../../da/dbc/screen__edit_8c.html#a69ed104f9640180b1041bf20343a276c">removedouble_scredges</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C));
<a name="l02187"></a>02187     <a class="code" href="../../da/dbc/screen__edit_8c.html#a4293968842b469ffb441259ed141f43a">removenotused_scredges</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C));
<a name="l02188"></a>02188     <a class="code" href="../../da/dbc/screen__edit_8c.html#a7acdd21fe72ae8da2be0b425df2d29e5">removenotused_scrverts</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C));
<a name="l02189"></a>02189 }
<a name="l02190"></a>02190 
<a name="l02191"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a73cbdb0df1b58f4fe5ee5f65d762f4ea">02191</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a73cbdb0df1b58f4fe5ee5f65d762f4ea">area_join_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02192"></a>02192 {
<a name="l02193"></a>02193     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#a66f7110e175ba9e4ec148710fa34354f">area_join_init</a>(C, op)) 
<a name="l02194"></a>02194         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02195"></a>02195     
<a name="l02196"></a>02196     <a class="code" href="../../d6/d78/screen__ops_8c.html#ae4ebf4e87b10811d034b708e683f0575">area_join_apply</a>(C, op);
<a name="l02197"></a>02197     <a class="code" href="../../d6/d78/screen__ops_8c.html#aed3ac8f17b3fa090eb5e028d76f087eb">area_join_exit</a>(C, op);
<a name="l02198"></a>02198     
<a name="l02199"></a>02199     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02200"></a>02200 }
<a name="l02201"></a>02201 
<a name="l02202"></a>02202 <span class="comment">/* interaction callback */</span>
<a name="l02203"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#af73582677e4b83256b8fd57a0c4965aa">02203</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#af73582677e4b83256b8fd57a0c4965aa">area_join_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l02204"></a>02204 {
<a name="l02205"></a>02205     
<a name="l02206"></a>02206     <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>==<a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>) {
<a name="l02207"></a>02207         <a class="code" href="../../d1/dd4/structsActionzoneData.html">sActionzoneData</a> *sad= <span class="keyword">event</span>-&gt;customdata;
<a name="l02208"></a>02208         
<a name="l02209"></a>02209         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a98658addbd425cde75bedc9172cc1611">modifier</a>&gt;0) {
<a name="l02210"></a>02210             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l02211"></a>02211         }
<a name="l02212"></a>02212         
<a name="l02213"></a>02213         <span class="comment">/* verify *sad itself */</span>
<a name="l02214"></a>02214         <span class="keywordflow">if</span> (sad==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02215"></a>02215             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l02216"></a>02216         
<a name="l02217"></a>02217         <span class="comment">/* is this our *sad? if areas equal it should be passed on */</span>
<a name="l02218"></a>02218         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#a1a9604a9275b99b0ce63e116a1c32002">sa1</a>==sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aae30079cb65c6f8d2e83df472e01c6b7">sa2</a>)
<a name="l02219"></a>02219             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l02220"></a>02220         
<a name="l02221"></a>02221         <span class="comment">/* prepare operator state vars */</span>
<a name="l02222"></a>02222         <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;min_x&quot;</span>, sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aad696b2529a5ca8e4d00ff21be9db378">x</a>);
<a name="l02223"></a>02223         <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;min_y&quot;</span>, sad-&gt;<a class="code" href="../../d1/dd4/structsActionzoneData.html#aab976fc282248e19f5032970a548db0f">y</a>);
<a name="l02224"></a>02224         <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;max_x&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>);
<a name="l02225"></a>02225         <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;max_y&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l02226"></a>02226     }
<a name="l02227"></a>02227     
<a name="l02228"></a>02228     
<a name="l02229"></a>02229     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d78/screen__ops_8c.html#a66f7110e175ba9e4ec148710fa34354f">area_join_init</a>(C, op)) 
<a name="l02230"></a>02230         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l02231"></a>02231     
<a name="l02232"></a>02232     <span class="comment">/* add temp handler */</span>
<a name="l02233"></a>02233     <a class="code" href="../../df/db0/wm__event__system_8c.html#ab89ad80681bbec4a06930903ea043251">WM_event_add_modal_handler</a>(C, op);
<a name="l02234"></a>02234     
<a name="l02235"></a>02235     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l02236"></a>02236 }
<a name="l02237"></a>02237 
<a name="l02238"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ac3ecfca6eb480df758c18665e4212281">02238</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ac3ecfca6eb480df758c18665e4212281">area_join_cancel</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02239"></a>02239 {
<a name="l02240"></a>02240     <a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a> *jd = (<a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l02241"></a>02241     
<a name="l02242"></a>02242     <a class="code" href="../../dd/db6/paraloopend_8h.html#a65986f23fef03474a87b62a14beafe42">if</a> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>) {
<a name="l02243"></a>02243         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a3f1eabd0fa9d89c5a6dac55bc9acb487">AREA_FLAG_DRAWJOINFROM</a>;
<a name="l02244"></a>02244         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02245"></a>02245     }
<a name="l02246"></a>02246     <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) {
<a name="l02247"></a>02247         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a3f1eabd0fa9d89c5a6dac55bc9acb487">AREA_FLAG_DRAWJOINFROM</a>;
<a name="l02248"></a>02248         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02249"></a>02249     }
<a name="l02250"></a>02250     
<a name="l02251"></a>02251     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a0dce5c73d06bfc518c4c6b2189df325d">NC_WINDOW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02252"></a>02252     
<a name="l02253"></a>02253     <a class="code" href="../../d6/d78/screen__ops_8c.html#aed3ac8f17b3fa090eb5e028d76f087eb">area_join_exit</a>(C, op);
<a name="l02254"></a>02254     
<a name="l02255"></a>02255     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02256"></a>02256 }
<a name="l02257"></a>02257 
<a name="l02258"></a>02258 <span class="comment">/* modal callback while selecting area (space) that will be removed */</span>
<a name="l02259"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a757b841a924c2a7fdfa1bf06384ab8f6">02259</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a757b841a924c2a7fdfa1bf06384ab8f6">area_join_modal</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l02260"></a>02260 {
<a name="l02261"></a>02261     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l02262"></a>02262     <a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a> *jd = (<a class="code" href="../../dd/db2/structsAreaJoinData.html">sAreaJoinData</a> *)op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a5202237a336c7d3a03fc25f4c87b26d1">customdata</a>;
<a name="l02263"></a>02263     
<a name="l02264"></a>02264     <span class="comment">/* execute the events */</span>
<a name="l02265"></a>02265     <span class="keywordflow">switch</span>(event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aeddd07f29c499fe2e38964ae993296ff">type</a>) {
<a name="l02266"></a>02266             
<a name="l02267"></a>02267         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#aa58b8b831d49bfef312f9ae99d742aae">MOUSEMOVE</a>: 
<a name="l02268"></a>02268         {
<a name="l02269"></a>02269             <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa = <a class="code" href="../../d6/d78/screen__ops_8c.html#a6f859cb194d8aaa7105360b0943e75cb">screen_areahascursor</a>(sc, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l02270"></a>02270             <span class="keywordtype">int</span> dir;
<a name="l02271"></a>02271             
<a name="l02272"></a>02272             <span class="keywordflow">if</span> (sa) {                   
<a name="l02273"></a>02273                 <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a> != sa) {
<a name="l02274"></a>02274                     dir = <a class="code" href="../../da/dbc/screen__edit_8c.html#a2e6e5e036f3379ab09724b8fabd7f12a">area_getorientation</a>(jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>, sa);
<a name="l02275"></a>02275                     <span class="keywordflow">if</span> (dir &gt;= 0) {
<a name="l02276"></a>02276                         <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02277"></a>02277                         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a> = sa;
<a name="l02278"></a>02278                         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02279"></a>02279                     } 
<a name="l02280"></a>02280                     <span class="keywordflow">else</span> {
<a name="l02281"></a>02281                         <span class="comment">/* we are not bordering on the previously selected area </span>
<a name="l02282"></a>02282 <span class="comment">                         * we check if area has common border with the one marked for removal</span>
<a name="l02283"></a>02283 <span class="comment">                         * in this case we can swap areas.</span>
<a name="l02284"></a>02284 <span class="comment">                         */</span>
<a name="l02285"></a>02285                         dir = <a class="code" href="../../da/dbc/screen__edit_8c.html#a2e6e5e036f3379ab09724b8fabd7f12a">area_getorientation</a>(sa, jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>);
<a name="l02286"></a>02286                         <span class="keywordflow">if</span> (dir &gt;= 0) {
<a name="l02287"></a>02287                             <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a3f1eabd0fa9d89c5a6dac55bc9acb487">AREA_FLAG_DRAWJOINFROM</a>;
<a name="l02288"></a>02288                             <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02289"></a>02289                             jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a> = jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>;
<a name="l02290"></a>02290                             jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a> = sa;
<a name="l02291"></a>02291                             <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a3f1eabd0fa9d89c5a6dac55bc9acb487">AREA_FLAG_DRAWJOINFROM</a>;
<a name="l02292"></a>02292                             <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02293"></a>02293                         } 
<a name="l02294"></a>02294                         <span class="keywordflow">else</span> {
<a name="l02295"></a>02295                             <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02296"></a>02296                             jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a> = <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02297"></a>02297                         }
<a name="l02298"></a>02298                     }
<a name="l02299"></a>02299                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a0dce5c73d06bfc518c4c6b2189df325d">NC_WINDOW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02300"></a>02300                 } 
<a name="l02301"></a>02301                 <span class="keywordflow">else</span> {
<a name="l02302"></a>02302                     <span class="comment">/* we are back in the area previously selected for keeping </span>
<a name="l02303"></a>02303 <span class="comment">                     * we swap the areas if possible to allow user to choose */</span>
<a name="l02304"></a>02304                     <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a> != <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l02305"></a>02305                         <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a3f1eabd0fa9d89c5a6dac55bc9acb487">AREA_FLAG_DRAWJOINFROM</a>;
<a name="l02306"></a>02306                         <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02307"></a>02307                         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a> = jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>;
<a name="l02308"></a>02308                         jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a> = sa;
<a name="l02309"></a>02309                         <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a3f1eabd0fa9d89c5a6dac55bc9acb487">AREA_FLAG_DRAWJOINFROM</a>;
<a name="l02310"></a>02310                         <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02311"></a>02311                         dir = <a class="code" href="../../da/dbc/screen__edit_8c.html#a2e6e5e036f3379ab09724b8fabd7f12a">area_getorientation</a>(jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>, jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>);
<a name="l02312"></a>02312                         <span class="keywordflow">if</span> (dir &lt; 0) {
<a name="l02313"></a>02313                             printf(<span class="stringliteral">&quot;oops, didn&#39;t expect that!\n&quot;</span>);
<a name="l02314"></a>02314                         }
<a name="l02315"></a>02315                     } 
<a name="l02316"></a>02316                     <span class="keywordflow">else</span> {
<a name="l02317"></a>02317                         dir = <a class="code" href="../../da/dbc/screen__edit_8c.html#a2e6e5e036f3379ab09724b8fabd7f12a">area_getorientation</a>(jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>, sa);
<a name="l02318"></a>02318                         <span class="keywordflow">if</span> (dir &gt;= 0) {
<a name="l02319"></a>02319                             <span class="keywordflow">if</span> (jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>) jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> &amp;= ~<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02320"></a>02320                             jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a> = sa;
<a name="l02321"></a>02321                             jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a95330fccbc8eb82dc12aefadd1afd8db">flag</a> |= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#ab96f18610053bcc66118620d92ad7ca9">AREA_FLAG_DRAWJOINTO</a>;
<a name="l02322"></a>02322                         }
<a name="l02323"></a>02323                     }
<a name="l02324"></a>02324                     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a0dce5c73d06bfc518c4c6b2189df325d">NC_WINDOW</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02325"></a>02325                 }
<a name="l02326"></a>02326             }
<a name="l02327"></a>02327         }
<a name="l02328"></a>02328             <span class="keywordflow">break</span>;
<a name="l02329"></a>02329         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>:
<a name="l02330"></a>02330             <span class="keywordflow">if</span> (event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a4ce6386082cecfa0645ced2216d04172">val</a>==<a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>) {
<a name="l02331"></a>02331                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#a11af758906c6fc78b78a05889065cd4e">sa1</a>);
<a name="l02332"></a>02332                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(jd-&gt;<a class="code" href="../../dd/db2/structsAreaJoinData.html#af82957ef20771bb4ad6a2a193a9737ac">sa2</a>);
<a name="l02333"></a>02333 
<a name="l02334"></a>02334                 <a class="code" href="../../d6/d78/screen__ops_8c.html#ae4ebf4e87b10811d034b708e683f0575">area_join_apply</a>(C, op);
<a name="l02335"></a>02335                 <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02336"></a>02336                 <a class="code" href="../../d6/d78/screen__ops_8c.html#aed3ac8f17b3fa090eb5e028d76f087eb">area_join_exit</a>(C, op);
<a name="l02337"></a>02337                 <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02338"></a>02338             }
<a name="l02339"></a>02339             <span class="keywordflow">break</span>;
<a name="l02340"></a>02340             
<a name="l02341"></a>02341         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#adc87b609a6285a24e23172a90734044c">RIGHTMOUSE</a>:
<a name="l02342"></a>02342         <span class="keywordflow">case</span> <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>:
<a name="l02343"></a>02343             <span class="keywordflow">return</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ac3ecfca6eb480df758c18665e4212281">area_join_cancel</a>(C, op);
<a name="l02344"></a>02344     }
<a name="l02345"></a>02345     
<a name="l02346"></a>02346     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a3ae275907ae986c695e88547409d19bb">OPERATOR_RUNNING_MODAL</a>;
<a name="l02347"></a>02347 }
<a name="l02348"></a>02348 
<a name="l02349"></a>02349 <span class="comment">/* Operator for joining two areas (space types) */</span>
<a name="l02350"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#afdaa2459552181b330df337e39f2d0c9">02350</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#afdaa2459552181b330df337e39f2d0c9">SCREEN_OT_area_join</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02351"></a>02351 {
<a name="l02352"></a>02352     <span class="comment">/* identifiers */</span>
<a name="l02353"></a>02353     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Join area&quot;</span>;
<a name="l02354"></a>02354     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Join selected areas into new window&quot;</span>;
<a name="l02355"></a>02355     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_area_join&quot;</span>;
<a name="l02356"></a>02356     
<a name="l02357"></a>02357     <span class="comment">/* api callbacks */</span>
<a name="l02358"></a>02358     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a73cbdb0df1b58f4fe5ee5f65d762f4ea">area_join_exec</a>;
<a name="l02359"></a>02359     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#af73582677e4b83256b8fd57a0c4965aa">area_join_invoke</a>;
<a name="l02360"></a>02360     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a757b841a924c2a7fdfa1bf06384ab8f6">area_join_modal</a>;
<a name="l02361"></a>02361     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a0c97e7b74b5212491f28a93ce7d47ab0">screen_active_editable</a>;
<a name="l02362"></a>02362     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ac3ecfca6eb480df758c18665e4212281">area_join_cancel</a>;
<a name="l02363"></a>02363     
<a name="l02364"></a>02364     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#a2458c730dbcabf67cc8917d8de127bab">OPTYPE_BLOCKING</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#abb286d579ea90395859610519b7ea240">OPTYPE_INTERNAL</a>;
<a name="l02365"></a>02365     
<a name="l02366"></a>02366     <span class="comment">/* rna */</span>
<a name="l02367"></a>02367     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;min_x&quot;</span>, -100, INT_MIN, INT_MAX, <span class="stringliteral">&quot;X 1&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l02368"></a>02368     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;min_y&quot;</span>, -100, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Y 1&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l02369"></a>02369     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;max_x&quot;</span>, -100, INT_MIN, INT_MAX, <span class="stringliteral">&quot;X 2&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l02370"></a>02370     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;max_y&quot;</span>, -100, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Y 2&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l02371"></a>02371 }
<a name="l02372"></a>02372 
<a name="l02373"></a>02373 <span class="comment">/* ******************************* */</span>
<a name="l02374"></a>02374 
<a name="l02375"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a5c44c97185c6e47bc73bd61ee54bb202">02375</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a5c44c97185c6e47bc73bd61ee54bb202">screen_area_options_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l02376"></a>02376 {
<a name="l02377"></a>02377     <a class="code" href="../../d9/d4b/structuiPopupMenu.html">uiPopupMenu</a> *pup;
<a name="l02378"></a>02378     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout;
<a name="l02379"></a>02379     <a class="code" href="../../dd/d80/structPointerRNA.html">PointerRNA</a> ptr1, ptr2;
<a name="l02380"></a>02380     <a class="code" href="../../dd/d31/structScrEdge.html">ScrEdge</a> *actedge= <a class="code" href="../../da/dbc/screen__edit_8c.html#ad462a6663b9be9ed4230edfd68e81cb5">screen_find_active_scredge</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l02381"></a>02381     
<a name="l02382"></a>02382     <span class="keywordflow">if</span> (actedge==<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02383"></a>02383     
<a name="l02384"></a>02384     pup= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a402c012d9cde0ff0f0808c25c4213d43">uiPupMenuBegin</a>(C, op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a75c88e62b43b663e9a0cf6cfbede007c">type</a>-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a>, ICON_NONE);
<a name="l02385"></a>02385     layout= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8c1b07b81987cdc2168a7417f9104cca">uiPupMenuLayout</a>(pup);
<a name="l02386"></a>02386     
<a name="l02387"></a>02387     <a class="code" href="../../d6/dae/wm__operators_8c.html#ad61b3bbf58d8c110a878750c1b4731a6">WM_operator_properties_create</a>(&amp;ptr1, <span class="stringliteral">&quot;SCREEN_OT_area_join&quot;</span>);
<a name="l02388"></a>02388     
<a name="l02389"></a>02389     <span class="comment">/* mouse cursor on edge, &#39;4&#39; can fail on wide edges... */</span>
<a name="l02390"></a>02390     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(&amp;ptr1, <span class="stringliteral">&quot;min_x&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>+4);
<a name="l02391"></a>02391     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(&amp;ptr1, <span class="stringliteral">&quot;min_y&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>+4);
<a name="l02392"></a>02392     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(&amp;ptr1, <span class="stringliteral">&quot;max_x&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>-4);
<a name="l02393"></a>02393     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(&amp;ptr1, <span class="stringliteral">&quot;max_y&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>-4);
<a name="l02394"></a>02394     
<a name="l02395"></a>02395     <a class="code" href="../../d6/dae/wm__operators_8c.html#ad61b3bbf58d8c110a878750c1b4731a6">WM_operator_properties_create</a>(&amp;ptr2, <span class="stringliteral">&quot;SCREEN_OT_area_split&quot;</span>);
<a name="l02396"></a>02396     
<a name="l02397"></a>02397     <span class="comment">/* store initial mouse cursor position */</span>
<a name="l02398"></a>02398     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(&amp;ptr2, <span class="stringliteral">&quot;mouse_x&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#aa6d806b03b666c8e88f6178303145cb1">x</a>);
<a name="l02399"></a>02399     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(&amp;ptr2, <span class="stringliteral">&quot;mouse_y&quot;</span>, event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#a1f9bfd9ad3dda5768a94bad7a3c3fc1e">y</a>);
<a name="l02400"></a>02400     
<a name="l02401"></a>02401     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5d68133c9ae9e90048616177881a9e57">uiItemFullO</a>(layout, <span class="stringliteral">&quot;SCREEN_OT_area_split&quot;</span>, <span class="stringliteral">&quot;Split Area&quot;</span>, ICON_NONE, ptr2.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ab5a7f40e5e55a912d974ab5224a0fa15">WM_OP_INVOKE_DEFAULT</a>, 0);
<a name="l02402"></a>02402     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5d68133c9ae9e90048616177881a9e57">uiItemFullO</a>(layout, <span class="stringliteral">&quot;SCREEN_OT_area_join&quot;</span>, <span class="stringliteral">&quot;Join Area&quot;</span>, ICON_NONE, ptr1.<a class="code" href="../../dd/d80/structPointerRNA.html#a18702e1d8f8c1a63389b3a322536e0e6">data</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ab5a7f40e5e55a912d974ab5224a0fa15">WM_OP_INVOKE_DEFAULT</a>, 0);
<a name="l02403"></a>02403     
<a name="l02404"></a>02404     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3ab0b4d9de253d473a16d4f329d8b50f">uiPupMenuEnd</a>(C, pup);
<a name="l02405"></a>02405     
<a name="l02406"></a>02406     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02407"></a>02407 }
<a name="l02408"></a>02408 
<a name="l02409"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a080917f97e5a60c1d8d3dfb093fdf7f1">02409</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a080917f97e5a60c1d8d3dfb093fdf7f1">SCREEN_OT_area_options</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02410"></a>02410 {
<a name="l02411"></a>02411     <span class="comment">/* identifiers */</span>
<a name="l02412"></a>02412     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Area Options&quot;</span>;
<a name="l02413"></a>02413     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Operations for splitting and merging&quot;</span>;
<a name="l02414"></a>02414     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_area_options&quot;</span>;
<a name="l02415"></a>02415     
<a name="l02416"></a>02416     <span class="comment">/* api callbacks */</span>
<a name="l02417"></a>02417     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a5c44c97185c6e47bc73bd61ee54bb202">screen_area_options_invoke</a>;
<a name="l02418"></a>02418     
<a name="l02419"></a>02419     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#ae5cdecea23f3f367638265513ceaea20">ED_operator_screen_mainwinactive</a>;
<a name="l02420"></a>02420 }
<a name="l02421"></a>02421 
<a name="l02422"></a>02422 
<a name="l02423"></a>02423 <span class="comment">/* ******************************* */</span>
<a name="l02424"></a>02424 
<a name="l02425"></a>02425 
<a name="l02426"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a6fd10cb2f8e9cea1199136690baf07b2">02426</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a6fd10cb2f8e9cea1199136690baf07b2">spacedata_cleanup</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02427"></a>02427 {
<a name="l02428"></a>02428     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l02429"></a>02429     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen;
<a name="l02430"></a>02430     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l02431"></a>02431     <span class="keywordtype">int</span> tot= 0;
<a name="l02432"></a>02432     
<a name="l02433"></a>02433     <span class="keywordflow">for</span> (screen= bmain-&gt;<a class="code" href="../../d0/dc0/structMain.html#a3ab31640766afea3c151a816eb70e691">screen</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; screen; screen= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ac661d280cae6952ebc9f9c95279cf6f2">id</a>.<a class="code" href="../../d8/d7e/structID.html#acaa676f1c6169b19d5c23a4f6ea5186c">next</a>) {
<a name="l02434"></a>02434         <span class="keywordflow">for</span> (sa= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l02435"></a>02435             <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a> != sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>) {
<a name="l02436"></a>02436                 <a class="code" href="../../d4/d63/structSpaceLink.html">SpaceLink</a> *sl= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>;
<a name="l02437"></a>02437 
<a name="l02438"></a>02438                 <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>, sl);
<a name="l02439"></a>02439                 tot+= <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aa3b37105a0793ac30946a6d220ee97d7">BLI_countlist</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>);
<a name="l02440"></a>02440                 <a class="code" href="../../d7/da3/BKE__screen_8h.html#a51af5de02fb94fb5e523f63e42c27efb">BKE_spacedata_freelist</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>);
<a name="l02441"></a>02441                 <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a3e912d89fe2993ce473b0718900723d4">spacedata</a>, sl);
<a name="l02442"></a>02442             }
<a name="l02443"></a>02443         }
<a name="l02444"></a>02444     }
<a name="l02445"></a>02445     <a class="code" href="../../d2/d40/BKE__report_8h.html#af25c247b3b620d13cef87ec2bed1698e">BKE_reportf</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a1c418509aad2eb64fd806b8a99d29f7d">RPT_INFO</a>, <span class="stringliteral">&quot;Removed amount of editors: %d&quot;</span>, tot);
<a name="l02446"></a>02446     
<a name="l02447"></a>02447     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02448"></a>02448 }
<a name="l02449"></a>02449 
<a name="l02450"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab138ec020aa935eb2ca1209ff8c6b490">02450</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab138ec020aa935eb2ca1209ff8c6b490">SCREEN_OT_spacedata_cleanup</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02451"></a>02451 {
<a name="l02452"></a>02452     <span class="comment">/* identifiers */</span>
<a name="l02453"></a>02453     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Clean-up space-data&quot;</span>;
<a name="l02454"></a>02454     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Remove unused settings for invisible editors&quot;</span>;
<a name="l02455"></a>02455     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_spacedata_cleanup&quot;</span>;
<a name="l02456"></a>02456     
<a name="l02457"></a>02457     <span class="comment">/* api callbacks */</span>
<a name="l02458"></a>02458     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a6fd10cb2f8e9cea1199136690baf07b2">spacedata_cleanup</a>;
<a name="l02459"></a>02459     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a1a80edec1422a70bda2ca37ed283a876">WM_operator_winactive</a>;
<a name="l02460"></a>02460     
<a name="l02461"></a>02461 }
<a name="l02462"></a>02462 
<a name="l02463"></a>02463 <span class="comment">/* ************** repeat last operator ***************************** */</span>
<a name="l02464"></a>02464 
<a name="l02465"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab407361d4d77958cb6359081b759ae67">02465</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab407361d4d77958cb6359081b759ae67">repeat_last_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02466"></a>02466 {
<a name="l02467"></a>02467     <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *lastop= <a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C)-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a290c1fd1d01aa2a23c949397af70c4ac">operators</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>;
<a name="l02468"></a>02468     
<a name="l02469"></a>02469     <span class="keywordflow">if</span> (lastop)
<a name="l02470"></a>02470         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6728b0ddf1a1f8de8db21dd705d4c8a4">WM_operator_repeat</a>(C, lastop);
<a name="l02471"></a>02471     
<a name="l02472"></a>02472     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02473"></a>02473 }
<a name="l02474"></a>02474 
<a name="l02475"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#acc3f855dbfca3524533ddba3f8640e47">02475</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#acc3f855dbfca3524533ddba3f8640e47">SCREEN_OT_repeat_last</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02476"></a>02476 {
<a name="l02477"></a>02477     <span class="comment">/* identifiers */</span>
<a name="l02478"></a>02478     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Repeat Last&quot;</span>;
<a name="l02479"></a>02479     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Repeat last action&quot;</span>;
<a name="l02480"></a>02480     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_repeat_last&quot;</span>;
<a name="l02481"></a>02481     
<a name="l02482"></a>02482     <span class="comment">/* api callbacks */</span>
<a name="l02483"></a>02483     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ab407361d4d77958cb6359081b759ae67">repeat_last_exec</a>;
<a name="l02484"></a>02484     
<a name="l02485"></a>02485     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>;
<a name="l02486"></a>02486     
<a name="l02487"></a>02487 }
<a name="l02488"></a>02488 
<a name="l02489"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ae0b6a0ca4dc889c36cdfb791a21e1bf0">02489</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ae0b6a0ca4dc889c36cdfb791a21e1bf0">repeat_history_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l02490"></a>02490 {
<a name="l02491"></a>02491     <a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *wm= <a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C);
<a name="l02492"></a>02492     <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *lastop;
<a name="l02493"></a>02493     <a class="code" href="../../d9/d4b/structuiPopupMenu.html">uiPopupMenu</a> *pup;
<a name="l02494"></a>02494     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout;
<a name="l02495"></a>02495     <span class="keywordtype">int</span> items, <a class="code" href="../../dd/db6/paraloopend_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;
<a name="l02496"></a>02496     
<a name="l02497"></a>02497     items= <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#aa3b37105a0793ac30946a6d220ee97d7">BLI_countlist</a>(&amp;wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a290c1fd1d01aa2a23c949397af70c4ac">operators</a>);
<a name="l02498"></a>02498     <span class="keywordflow">if</span> (items==0)
<a name="l02499"></a>02499         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02500"></a>02500     
<a name="l02501"></a>02501     pup= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a402c012d9cde0ff0f0808c25c4213d43">uiPupMenuBegin</a>(C, op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a75c88e62b43b663e9a0cf6cfbede007c">type</a>-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a>, ICON_NONE);
<a name="l02502"></a>02502     layout= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8c1b07b81987cdc2168a7417f9104cca">uiPupMenuLayout</a>(pup);
<a name="l02503"></a>02503     
<a name="l02504"></a>02504     <span class="keywordflow">for</span> (i=items-1, lastop= wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a290c1fd1d01aa2a23c949397af70c4ac">operators</a>.<a class="code" href="../../d6/d85/structListBase.html#a46f89850aad8cd09b34b5bdc3aa8f91a">last</a>; lastop; lastop= lastop-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a74026bf2ec03c3297bc39c0c542cab5e">prev</a>, i--)
<a name="l02505"></a>02505         <a class="code" href="../../d8/d1e/UI__interface_8h.html#a35664160afd4e3af9147461f1e13be9c">uiItemIntO</a>(layout, lastop-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a75c88e62b43b663e9a0cf6cfbede007c">type</a>-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a>, ICON_NONE, op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a75c88e62b43b663e9a0cf6cfbede007c">type</a>-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a>, <span class="stringliteral">&quot;index&quot;</span>, i);
<a name="l02506"></a>02506     
<a name="l02507"></a>02507     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3ab0b4d9de253d473a16d4f329d8b50f">uiPupMenuEnd</a>(C, pup);
<a name="l02508"></a>02508     
<a name="l02509"></a>02509     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02510"></a>02510 }
<a name="l02511"></a>02511 
<a name="l02512"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a8d0dd3ff507a083451bb8f8d7816f946">02512</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a8d0dd3ff507a083451bb8f8d7816f946">repeat_history_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02513"></a>02513 {
<a name="l02514"></a>02514     <a class="code" href="../../d4/dc3/structwmWindowManager.html">wmWindowManager</a> *wm= <a class="code" href="../../df/d01/BKE__context_8h.html#a5dcb9150a17a8907a3da33993063637e">CTX_wm_manager</a>(C);
<a name="l02515"></a>02515     
<a name="l02516"></a>02516     op= <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a09f13df59d10774f0bcf69a054f9d865">BLI_findlink</a>(&amp;wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a290c1fd1d01aa2a23c949397af70c4ac">operators</a>, <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;index&quot;</span>));
<a name="l02517"></a>02517     <span class="keywordflow">if</span> (op) {
<a name="l02518"></a>02518         <span class="comment">/* let&#39;s put it as last operator in list */</span>
<a name="l02519"></a>02519         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(&amp;wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a290c1fd1d01aa2a23c949397af70c4ac">operators</a>, op);
<a name="l02520"></a>02520         <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;wm-&gt;<a class="code" href="../../d4/dc3/structwmWindowManager.html#a290c1fd1d01aa2a23c949397af70c4ac">operators</a>, op);
<a name="l02521"></a>02521         
<a name="l02522"></a>02522         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6728b0ddf1a1f8de8db21dd705d4c8a4">WM_operator_repeat</a>(C, op);
<a name="l02523"></a>02523     }
<a name="l02524"></a>02524     
<a name="l02525"></a>02525     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02526"></a>02526 }
<a name="l02527"></a>02527 
<a name="l02528"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab21e01850c2f3518917e308da2b17964">02528</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab21e01850c2f3518917e308da2b17964">SCREEN_OT_repeat_history</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02529"></a>02529 {
<a name="l02530"></a>02530     <span class="comment">/* identifiers */</span>
<a name="l02531"></a>02531     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Repeat History&quot;</span>;
<a name="l02532"></a>02532     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Display menu for previous actions performed&quot;</span>;
<a name="l02533"></a>02533     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_repeat_history&quot;</span>;
<a name="l02534"></a>02534     
<a name="l02535"></a>02535     <span class="comment">/* api callbacks */</span>
<a name="l02536"></a>02536     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#ae0b6a0ca4dc889c36cdfb791a21e1bf0">repeat_history_invoke</a>;
<a name="l02537"></a>02537     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a8d0dd3ff507a083451bb8f8d7816f946">repeat_history_exec</a>;
<a name="l02538"></a>02538     
<a name="l02539"></a>02539     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>;
<a name="l02540"></a>02540     
<a name="l02541"></a>02541     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;index&quot;</span>, 0, 0, INT_MAX, <span class="stringliteral">&quot;Index&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0, 1000);
<a name="l02542"></a>02542 }
<a name="l02543"></a>02543 
<a name="l02544"></a>02544 <span class="comment">/* ********************** redo operator ***************************** */</span>
<a name="l02545"></a>02545 
<a name="l02546"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a509dc2a81fe75cf43be9c35c0cab85da">02546</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a509dc2a81fe75cf43be9c35c0cab85da">redo_last_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op), <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l02547"></a>02547 {
<a name="l02548"></a>02548     <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *lastop= <a class="code" href="../../d6/dae/wm__operators_8c.html#af70820ab5d6997a102ba80e740eea68f">WM_operator_last_redo</a>(C);
<a name="l02549"></a>02549     
<a name="l02550"></a>02550     <span class="keywordflow">if</span> (lastop)
<a name="l02551"></a>02551         <a class="code" href="../../d6/dae/wm__operators_8c.html#a242e53d8d8fca43111a3283913d896cc">WM_operator_redo_popup</a>(C, lastop);
<a name="l02552"></a>02552     
<a name="l02553"></a>02553     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02554"></a>02554 }
<a name="l02555"></a>02555 
<a name="l02556"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a6583c16b1eb02f8590c9dc5e5ddeeccd">02556</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a6583c16b1eb02f8590c9dc5e5ddeeccd">SCREEN_OT_redo_last</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02557"></a>02557 {
<a name="l02558"></a>02558     <span class="comment">/* identifiers */</span>
<a name="l02559"></a>02559     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Redo Last&quot;</span>;
<a name="l02560"></a>02560     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Display menu for last action performed&quot;</span>;
<a name="l02561"></a>02561     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_redo_last&quot;</span>;
<a name="l02562"></a>02562     
<a name="l02563"></a>02563     <span class="comment">/* api callbacks */</span>
<a name="l02564"></a>02564     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a509dc2a81fe75cf43be9c35c0cab85da">redo_last_invoke</a>;
<a name="l02565"></a>02565     
<a name="l02566"></a>02566     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>;
<a name="l02567"></a>02567 }
<a name="l02568"></a>02568 
<a name="l02569"></a>02569 <span class="comment">/* ************** region four-split operator ***************************** */</span>
<a name="l02570"></a>02570 
<a name="l02571"></a>02571 <span class="comment">/* insert a region in the area region list */</span>
<a name="l02572"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a9f58717708f410557fcd0e1c0c9d9787">02572</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a9f58717708f410557fcd0e1c0c9d9787">region_quadview_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l02573"></a>02573 {
<a name="l02574"></a>02574     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l02575"></a>02575     
<a name="l02576"></a>02576     <span class="comment">/* some rules... */</span>
<a name="l02577"></a>02577     <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a>!=<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>)
<a name="l02578"></a>02578         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Only window region can be 4-splitted&quot;</span>);
<a name="l02579"></a>02579     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a4c5f51cbc9eda9eea22e41a0f8a0d801">RGN_ALIGN_QSPLIT</a>) {
<a name="l02580"></a>02580         <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02581"></a>02581         <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *arn;
<a name="l02582"></a>02582         
<a name="l02583"></a>02583         <span class="comment">/* keep current region */</span>
<a name="l02584"></a>02584         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= 0;
<a name="l02585"></a>02585         
<a name="l02586"></a>02586         <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a>==<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>) {
<a name="l02587"></a>02587             <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l02588"></a>02588             rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2f24be354ab2bdec931764dda203ca3c">viewlock</a>= 0;
<a name="l02589"></a>02589             rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a077da32c8352d8b7abb4b19919a14cf8">rflag</a> &amp;= ~<a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a5abc2fd47b1dba7a3d7836a57f6af9a9">RV3D_CLIPPING</a>;
<a name="l02590"></a>02590         }
<a name="l02591"></a>02591         
<a name="l02592"></a>02592         <span class="keywordflow">for</span> (ar= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar= arn) {
<a name="l02593"></a>02593             arn= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>;
<a name="l02594"></a>02594             <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a4c5f51cbc9eda9eea22e41a0f8a0d801">RGN_ALIGN_QSPLIT</a>) {
<a name="l02595"></a>02595                 <a class="code" href="../../d1/d12/ED__screen_8h.html#a58fb8b740e06bf69c7031d262e4e0ad7">ED_region_exit</a>(C, ar);
<a name="l02596"></a>02596                 <a class="code" href="../../d7/da3/BKE__screen_8h.html#acb926d438975e5a30f778c32ce39dbfe">BKE_area_region_free</a>(sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a41fdde87680287b354eca377ae99ed1e">type</a>, ar);
<a name="l02597"></a>02597                 <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a1ff36f7c9cfb643553d599b91f08abea">BLI_remlink</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>, ar);
<a name="l02598"></a>02598                 <a class="code" href="../../da/d2b/mallocn_8c.html#aebca1f40b6b3b5815677a99dc56670d9">MEM_freeN</a>(ar);
<a name="l02599"></a>02599             }
<a name="l02600"></a>02600         }
<a name="l02601"></a>02601         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l02602"></a>02602         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02603"></a>02603     }
<a name="l02604"></a>02604     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>)
<a name="l02605"></a>02605         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;Only last region can be 4-splitted&quot;</span>);
<a name="l02606"></a>02606     <span class="keywordflow">else</span> {
<a name="l02607"></a>02607         <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02608"></a>02608         <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *newar;
<a name="l02609"></a>02609         <span class="keywordtype">int</span> count;
<a name="l02610"></a>02610         
<a name="l02611"></a>02611         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a4c5f51cbc9eda9eea22e41a0f8a0d801">RGN_ALIGN_QSPLIT</a>;
<a name="l02612"></a>02612         
<a name="l02613"></a>02613         <span class="keywordflow">for</span> (count=0; count&lt;3; count++) {
<a name="l02614"></a>02614             newar= <a class="code" href="../../d7/da3/BKE__screen_8h.html#a206953b5a19edf9d09defaf51c2f19b0">BKE_area_region_copy</a>(sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a41fdde87680287b354eca377ae99ed1e">type</a>, ar);
<a name="l02615"></a>02615             <a class="code" href="../../d1/d3e/BLI__listbase_8h.html#a28b9955d900264adc216d246f4057f05">BLI_addtail</a>(&amp;sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>, newar);
<a name="l02616"></a>02616         }
<a name="l02617"></a>02617         
<a name="l02618"></a>02618         <span class="comment">/* lock views and set them */</span>
<a name="l02619"></a>02619         <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a>==<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>) {
<a name="l02620"></a>02620             <span class="comment">/* run ED_view3d_lock() so the correct &#39;rv3d-&gt;viewquat&#39; is set,</span>
<a name="l02621"></a>02621 <span class="comment">             * otherwise when restoring rv3d-&gt;localvd the &#39;viewquat&#39; won&#39;t</span>
<a name="l02622"></a>02622 <span class="comment">             * match the &#39;view&#39;, set on entering localview See: [#26315],</span>
<a name="l02623"></a>02623 <span class="comment">             *</span>
<a name="l02624"></a>02624 <span class="comment">             * We could avoid manipulating rv3d-&gt;localvd here if exiting</span>
<a name="l02625"></a>02625 <span class="comment">             * localview with a 4-split would assign these view locks */</span>
<a name="l02626"></a>02626             <a class="code" href="../../d9/d00/structRegionView3D.html">RegionView3D</a> *rv3d;
<a name="l02627"></a>02627             
<a name="l02628"></a>02628             rv3d= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l02629"></a>02629             rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2f24be354ab2bdec931764dda203ca3c">viewlock</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a440490fbb1bd93b56d293e192829503e">RV3D_LOCKED</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#aed9a26ef0efa80c319cb14716ec229f6">RV3D_VIEW_FRONT</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#af086af25ae5c28a12be8eb6f7687c6dd">RV3D_ORTHO</a>;
<a name="l02630"></a>02630             <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad6320fd8a46f39544594235023fc40c9">ED_view3d_lock</a>(rv3d);
<a name="l02631"></a>02631             <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>) { rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>; <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ad474b870b380ee0c83901e9199506078">copy_qt_qt</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>);}
<a name="l02632"></a>02632             
<a name="l02633"></a>02633             ar= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>;
<a name="l02634"></a>02634             rv3d= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l02635"></a>02635             rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2f24be354ab2bdec931764dda203ca3c">viewlock</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a440490fbb1bd93b56d293e192829503e">RV3D_LOCKED</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#ac5acba0a848d6772d09d715df8c0da68">RV3D_VIEW_TOP</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#af086af25ae5c28a12be8eb6f7687c6dd">RV3D_ORTHO</a>;
<a name="l02636"></a>02636             <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad6320fd8a46f39544594235023fc40c9">ED_view3d_lock</a>(rv3d);
<a name="l02637"></a>02637             <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>) { rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>; <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ad474b870b380ee0c83901e9199506078">copy_qt_qt</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>);}
<a name="l02638"></a>02638             
<a name="l02639"></a>02639             ar= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>;
<a name="l02640"></a>02640             rv3d= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l02641"></a>02641             rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a2f24be354ab2bdec931764dda203ca3c">viewlock</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a440490fbb1bd93b56d293e192829503e">RV3D_LOCKED</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#ab17ef620b0bbd3984797f7b2ce8ae0e8">RV3D_VIEW_RIGHT</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#af086af25ae5c28a12be8eb6f7687c6dd">RV3D_ORTHO</a>;
<a name="l02642"></a>02642             <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad6320fd8a46f39544594235023fc40c9">ED_view3d_lock</a>(rv3d);
<a name="l02643"></a>02643             <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>) { rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>; <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ad474b870b380ee0c83901e9199506078">copy_qt_qt</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>);}
<a name="l02644"></a>02644             
<a name="l02645"></a>02645             ar= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>;
<a name="l02646"></a>02646             rv3d= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a1b743d806cf5169fd929df96d1133ba4">regiondata</a>;
<a name="l02647"></a>02647             rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a08aad6d7a43a0eb6a69a4cc148bae306">RV3D_VIEW_CAMERA</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>= <a class="code" href="../../d4/d06/DNA__view3d__types_8h.html#a4c869f8f07a58e54e43d35474bbe4757">RV3D_CAMOB</a>;
<a name="l02648"></a>02648             <a class="code" href="../../d8/d6a/ED__view3d_8h.html#ad6320fd8a46f39544594235023fc40c9">ED_view3d_lock</a>(rv3d);
<a name="l02649"></a>02649             <span class="keywordflow">if</span> (rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>) {rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#ae1cde58bc1011bac27095a74be8a32a9">view</a>; rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a> = rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a8f435c152f17185773a21cd8b7067ebb">persp</a>; <a class="code" href="../../d4/d90/BLI__math__rotation_8h.html#ad474b870b380ee0c83901e9199506078">copy_qt_qt</a>(rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#aa55a6df5b8a0501c16cfdbcc794d627d">localvd</a>-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>, rv3d-&gt;<a class="code" href="../../d9/d00/structRegionView3D.html#a5b66d29020ddf25dfef66674677e84ff">viewquat</a>);}
<a name="l02650"></a>02650         }
<a name="l02651"></a>02651         <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(sa);
<a name="l02652"></a>02652         <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02653"></a>02653     }
<a name="l02654"></a>02654     
<a name="l02655"></a>02655     
<a name="l02656"></a>02656     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02657"></a>02657 }
<a name="l02658"></a>02658 
<a name="l02659"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#abe95a3b27a6daae02041a2bf9b415bb7">02659</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#abe95a3b27a6daae02041a2bf9b415bb7">SCREEN_OT_region_quadview</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02660"></a>02660 {
<a name="l02661"></a>02661     <span class="comment">/* identifiers */</span>
<a name="l02662"></a>02662     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Toggle Quad View&quot;</span>;
<a name="l02663"></a>02663     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Split selected area into camera, front, right &amp; top views&quot;</span>;
<a name="l02664"></a>02664     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_region_quadview&quot;</span>;
<a name="l02665"></a>02665     
<a name="l02666"></a>02666     <span class="comment">/* api callbacks */</span>
<a name="l02667"></a>02667     <span class="comment">//  ot-&gt;invoke = WM_operator_confirm;</span>
<a name="l02668"></a>02668     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a9f58717708f410557fcd0e1c0c9d9787">region_quadview_exec</a>;
<a name="l02669"></a>02669     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#ad3e4c76483a77957597951a50918f556">ED_operator_region_view3d_active</a>;
<a name="l02670"></a>02670     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l02671"></a>02671 }
<a name="l02672"></a>02672 
<a name="l02673"></a>02673 
<a name="l02674"></a>02674 
<a name="l02675"></a>02675 <span class="comment">/* ************** region flip operator ***************************** */</span>
<a name="l02676"></a>02676 
<a name="l02677"></a>02677 <span class="comment">/* flip a region alignment */</span>
<a name="l02678"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a00dfd5fc45261c306471648fdedb4ef3">02678</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a00dfd5fc45261c306471648fdedb4ef3">region_flip_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02679"></a>02679 {
<a name="l02680"></a>02680     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l02681"></a>02681     
<a name="l02682"></a>02682     <span class="keywordflow">if</span> (!ar)
<a name="l02683"></a>02683         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02684"></a>02684     
<a name="l02685"></a>02685     <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a>)
<a name="l02686"></a>02686         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a>;
<a name="l02687"></a>02687     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a>)
<a name="l02688"></a>02688         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a>;
<a name="l02689"></a>02689     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>)
<a name="l02690"></a>02690         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a>;
<a name="l02691"></a>02691     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a>)
<a name="l02692"></a>02692         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>;
<a name="l02693"></a>02693 
<a name="l02694"></a>02694     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l02695"></a>02695     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02696"></a>02696     
<a name="l02697"></a>02697     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02698"></a>02698 }
<a name="l02699"></a>02699 
<a name="l02700"></a>02700 
<a name="l02701"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aea782c07d3642d748018dfbdd4ac8dac">02701</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aea782c07d3642d748018dfbdd4ac8dac">SCREEN_OT_region_flip</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02702"></a>02702 {
<a name="l02703"></a>02703     <span class="comment">/* identifiers */</span>
<a name="l02704"></a>02704     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Flip Region&quot;</span>;
<a name="l02705"></a>02705     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_region_flip&quot;</span>;
<a name="l02706"></a>02706     
<a name="l02707"></a>02707     <span class="comment">/* api callbacks */</span>
<a name="l02708"></a>02708     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a00dfd5fc45261c306471648fdedb4ef3">region_flip_exec</a>;
<a name="l02709"></a>02709     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>;
<a name="l02710"></a>02710     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l02711"></a>02711 }
<a name="l02712"></a>02712 
<a name="l02713"></a>02713 <span class="comment">/* ************** header flip operator ***************************** */</span>
<a name="l02714"></a>02714 
<a name="l02715"></a>02715 <span class="comment">/* flip a header region alignment */</span>
<a name="l02716"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a6335efbaf3a0765bb89dcfe0025aa223">02716</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a6335efbaf3a0765bb89dcfe0025aa223">header_flip_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l02717"></a>02717 {
<a name="l02718"></a>02718     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l02719"></a>02719     
<a name="l02720"></a>02720     <span class="comment">/* find the header region </span>
<a name="l02721"></a>02721 <span class="comment">     *  - try context first, but upon failing, search all regions in area...</span>
<a name="l02722"></a>02722 <span class="comment">     */</span>
<a name="l02723"></a>02723     <span class="keywordflow">if</span> ((ar == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a> != <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>)) {
<a name="l02724"></a>02724         <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02725"></a>02725         ar= <a class="code" href="../../d7/da3/BKE__screen_8h.html#a5094bc7dbca089e838bcd5fc9bcb52a7">BKE_area_find_region_type</a>(sa, <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>);
<a name="l02726"></a>02726 
<a name="l02727"></a>02727         <span class="comment">/* don&#39;t do anything if no region */</span>
<a name="l02728"></a>02728         <span class="keywordflow">if</span> (ar == <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l02729"></a>02729             <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02730"></a>02730     }   
<a name="l02731"></a>02731     
<a name="l02732"></a>02732     <span class="comment">/* copied from SCREEN_OT_region_flip */</span>
<a name="l02733"></a>02733     <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a>)
<a name="l02734"></a>02734         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a>;
<a name="l02735"></a>02735     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a898395503574ba73c18b3dbbd96fd107">RGN_ALIGN_BOTTOM</a>)
<a name="l02736"></a>02736         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a>;
<a name="l02737"></a>02737     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>)
<a name="l02738"></a>02738         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a>;
<a name="l02739"></a>02739     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a26c26121325540375f6fb076bee0fb59">RGN_ALIGN_RIGHT</a>)
<a name="l02740"></a>02740         ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a>= <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#af406a205a9600f7ffa7e100511c9643a">RGN_ALIGN_LEFT</a>;
<a name="l02741"></a>02741 
<a name="l02742"></a>02742     <a class="code" href="../../d1/d12/ED__screen_8h.html#a0982c011d985308b08320d5f9604418b">ED_area_tag_redraw</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C));
<a name="l02743"></a>02743 
<a name="l02744"></a>02744     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a73680e84dba31202967ab486f0b306ea">NA_EDITED</a>, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02745"></a>02745     
<a name="l02746"></a>02746     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l02747"></a>02747 }
<a name="l02748"></a>02748 
<a name="l02749"></a>02749 
<a name="l02750"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a47b7fa2c85649b5e52490b7d29e61589">02750</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a47b7fa2c85649b5e52490b7d29e61589">SCREEN_OT_header_flip</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02751"></a>02751 {
<a name="l02752"></a>02752     <span class="comment">/* identifiers */</span>
<a name="l02753"></a>02753     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Flip Header Region&quot;</span>;
<a name="l02754"></a>02754     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_header_flip&quot;</span>;
<a name="l02755"></a>02755     
<a name="l02756"></a>02756     <span class="comment">/* api callbacks */</span>
<a name="l02757"></a>02757     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a6335efbaf3a0765bb89dcfe0025aa223">header_flip_exec</a>;
<a name="l02758"></a>02758     
<a name="l02759"></a>02759     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>;
<a name="l02760"></a>02760     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = 0;
<a name="l02761"></a>02761 }
<a name="l02762"></a>02762 
<a name="l02763"></a>02763 <span class="comment">/* ************** header tools operator ***************************** */</span>
<a name="l02764"></a>02764 
<a name="l02765"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a0fc09bdc2c80f6df4c7a1d223e58ea9d">02765</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a0fc09bdc2c80f6df4c7a1d223e58ea9d">header_toolbox_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op), <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l02766"></a>02766 {
<a name="l02767"></a>02767     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa= <a class="code" href="../../df/d01/BKE__context_8h.html#a0aa169ee48010fe8d739201a37e7b66f">CTX_wm_area</a>(C);
<a name="l02768"></a>02768     <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l02769"></a>02769     <a class="code" href="../../d9/d4b/structuiPopupMenu.html">uiPopupMenu</a> *pup;
<a name="l02770"></a>02770     <a class="code" href="../../d4/d94/structuiLayout.html">uiLayout</a> *layout;
<a name="l02771"></a>02771     
<a name="l02772"></a>02772     pup= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a402c012d9cde0ff0f0808c25c4213d43">uiPupMenuBegin</a>(C, <span class="stringliteral">&quot;Header&quot;</span>, ICON_NONE);
<a name="l02773"></a>02773     layout= <a class="code" href="../../d8/d1e/UI__interface_8h.html#a8c1b07b81987cdc2168a7417f9104cca">uiPupMenuLayout</a>(pup);
<a name="l02774"></a>02774     
<a name="l02775"></a>02775     <span class="comment">// XXX SCREEN_OT_region_flip doesn&#39;t work - gets wrong context for active region, so added custom operator</span>
<a name="l02776"></a>02776     <span class="keywordflow">if</span> (ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a8c70a85ae4e6eee036ee6f58f246876d">alignment</a> == <a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a96755a55dd96367084937e6448c578c9">RGN_ALIGN_TOP</a>)
<a name="l02777"></a>02777         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(layout, <span class="stringliteral">&quot;Flip to Bottom&quot;</span>, ICON_NONE, <span class="stringliteral">&quot;SCREEN_OT_header_flip&quot;</span>);
<a name="l02778"></a>02778     <span class="keywordflow">else</span>
<a name="l02779"></a>02779         <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(layout, <span class="stringliteral">&quot;Flip to Top&quot;</span>, ICON_NONE, <span class="stringliteral">&quot;SCREEN_OT_header_flip&quot;</span>);
<a name="l02780"></a>02780     
<a name="l02781"></a>02781     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a5e3bb0f5147561627b0f3f92789476bd">uiItemS</a>(layout);
<a name="l02782"></a>02782     
<a name="l02783"></a>02783     <span class="comment">/* file browser should be fullscreen all the time, but other regions can be maximised/restored... */</span>
<a name="l02784"></a>02784     <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a> != <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca5f4c324d2af06c247780942931169c7c">SPACE_FILE</a>) {
<a name="l02785"></a>02785         <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a62b30afc9f5a2f501be12a0917cebe35">full</a>) 
<a name="l02786"></a>02786             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(layout, <span class="stringliteral">&quot;Tile Area&quot;</span>, ICON_NONE, <span class="stringliteral">&quot;SCREEN_OT_screen_full_area&quot;</span>);
<a name="l02787"></a>02787         <span class="keywordflow">else</span>
<a name="l02788"></a>02788             <a class="code" href="../../d8/d1e/UI__interface_8h.html#aa730a1dee89b370a0e66e9e79503f15d">uiItemO</a>(layout, <span class="stringliteral">&quot;Maximize Area&quot;</span>, ICON_NONE, <span class="stringliteral">&quot;SCREEN_OT_screen_full_area&quot;</span>);
<a name="l02789"></a>02789     }
<a name="l02790"></a>02790     
<a name="l02791"></a>02791     <a class="code" href="../../d8/d1e/UI__interface_8h.html#a3ab0b4d9de253d473a16d4f329d8b50f">uiPupMenuEnd</a>(C, pup);
<a name="l02792"></a>02792     
<a name="l02793"></a>02793     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l02794"></a>02794 }
<a name="l02795"></a>02795 
<a name="l02796"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a4b80f7cedbe919b2011c29591a6a22b5">02796</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a4b80f7cedbe919b2011c29591a6a22b5">SCREEN_OT_header_toolbox</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l02797"></a>02797 {
<a name="l02798"></a>02798     <span class="comment">/* identifiers */</span>
<a name="l02799"></a>02799     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Header Toolbox&quot;</span>;
<a name="l02800"></a>02800     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Display header region toolbox&quot;</span>;
<a name="l02801"></a>02801     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_header_toolbox&quot;</span>;
<a name="l02802"></a>02802     
<a name="l02803"></a>02803     <span class="comment">/* api callbacks */</span>
<a name="l02804"></a>02804     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a0fc09bdc2c80f6df4c7a1d223e58ea9d">header_toolbox_invoke</a>;
<a name="l02805"></a>02805 }
<a name="l02806"></a>02806 
<a name="l02807"></a>02807 <span class="comment">/* ****************** anim player, with timer ***************** */</span>
<a name="l02808"></a>02808 
<a name="l02809"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ac87baa31eb3119fff205a07eae385f0a">02809</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ac87baa31eb3119fff205a07eae385f0a">match_area_with_refresh</a>(<span class="keywordtype">int</span> spacetype, <span class="keywordtype">int</span> refresh)
<a name="l02810"></a>02810 {
<a name="l02811"></a>02811     <span class="keywordflow">switch</span> (spacetype) {
<a name="l02812"></a>02812         <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca51011faadfd7d38d3d7a810c600e9458">SPACE_TIME</a>:
<a name="l02813"></a>02813             <span class="keywordflow">if</span> (refresh &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca51011faadfd7d38d3d7a810c600e9458">SPACE_TIME</a>)
<a name="l02814"></a>02814                 <span class="keywordflow">return</span> 1;
<a name="l02815"></a>02815             <span class="keywordflow">break</span>;
<a name="l02816"></a>02816     }
<a name="l02817"></a>02817     
<a name="l02818"></a>02818     <span class="keywordflow">return</span> 0;
<a name="l02819"></a>02819 }
<a name="l02820"></a>02820 
<a name="l02821"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a2d8d6bca1d39e81f3ca6d976f096a33c">02821</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a2d8d6bca1d39e81f3ca6d976f096a33c">match_region_with_redraws</a>(<span class="keywordtype">int</span> spacetype, <span class="keywordtype">int</span> regiontype, <span class="keywordtype">int</span> redraws)
<a name="l02822"></a>02822 {
<a name="l02823"></a>02823     <span class="keywordflow">if</span> (regiontype==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a3d4303928de6d095b8db2a0637930a63">RGN_TYPE_WINDOW</a>) {
<a name="l02824"></a>02824         
<a name="l02825"></a>02825         <span class="keywordflow">switch</span> (spacetype) {
<a name="l02826"></a>02826             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caf4af925b582bb7d7590235f90a38c8a9">SPACE_VIEW3D</a>:
<a name="l02827"></a>02827                 <span class="keywordflow">if</span> (redraws &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a51e924d3814926d33e77fd7d911c8f3f">TIME_ALL_3D_WIN</a>)
<a name="l02828"></a>02828                     <span class="keywordflow">return</span> 1;
<a name="l02829"></a>02829                 <span class="keywordflow">break</span>;
<a name="l02830"></a>02830             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca67184420c844bcef0dd50660142cede6">SPACE_IPO</a>:
<a name="l02831"></a>02831             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca154950ac39aa053ba159ffbe6768eb68">SPACE_ACTION</a>:
<a name="l02832"></a>02832             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca7b7ea2d973db8086363e148983d6adc0">SPACE_NLA</a>:
<a name="l02833"></a>02833                 <span class="keywordflow">if</span> (redraws &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a6ef6dfba4f1fd8a63ff156505056e953">TIME_ALL_ANIM_WIN</a>)
<a name="l02834"></a>02834                     <span class="keywordflow">return</span> 1;
<a name="l02835"></a>02835                 <span class="keywordflow">break</span>;
<a name="l02836"></a>02836             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca51011faadfd7d38d3d7a810c600e9458">SPACE_TIME</a>:
<a name="l02837"></a>02837                 <span class="comment">/* if only 1 window or 3d windows, we do timeline too */</span>
<a name="l02838"></a>02838                 <span class="keywordflow">if</span> (redraws &amp; (TIME_ALL_ANIM_WIN|<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a62d4edf6fee7fe4f7cd0f1a160fdbefb">TIME_REGION</a>|TIME_ALL_3D_WIN))
<a name="l02839"></a>02839                     <span class="keywordflow">return</span> 1;
<a name="l02840"></a>02840                 <span class="keywordflow">break</span>;
<a name="l02841"></a>02841             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caa2a34290401af40dd7a52dd4041cc9da">SPACE_BUTS</a>:
<a name="l02842"></a>02842                 <span class="keywordflow">if</span> (redraws &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a782c6f51bac9637c963ac2634ef67a64">TIME_ALL_BUTS_WIN</a>)
<a name="l02843"></a>02843                     <span class="keywordflow">return</span> 1;
<a name="l02844"></a>02844                 <span class="keywordflow">break</span>;
<a name="l02845"></a>02845             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caa78bb4ba1705225aa14af78400406414">SPACE_SEQ</a>:
<a name="l02846"></a>02846                 <span class="keywordflow">if</span> (redraws &amp; (<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a4d0af43c016a330c6fea36f0bfbce93b">TIME_SEQ</a>|TIME_ALL_ANIM_WIN))
<a name="l02847"></a>02847                     <span class="keywordflow">return</span> 1;
<a name="l02848"></a>02848                 <span class="keywordflow">break</span>;
<a name="l02849"></a>02849             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca2ef41082c072d92dbf2d57e20442751d">SPACE_NODE</a>:
<a name="l02850"></a>02850                 <span class="keywordflow">if</span> (redraws &amp; (<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a2b4ad40ff2adb47f2dd51daf5c206772">TIME_NODES</a>))
<a name="l02851"></a>02851                     <span class="keywordflow">return</span> 1;
<a name="l02852"></a>02852                 <span class="keywordflow">break</span>;
<a name="l02853"></a>02853             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752cab0433b569331024d6cf6123194fc10a2">SPACE_IMAGE</a>:
<a name="l02854"></a>02854                 <span class="keywordflow">if</span> (redraws &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#ad4c18eb03c29a1545ae7ff1668f6c253">TIME_ALL_IMAGE_WIN</a>)
<a name="l02855"></a>02855                     <span class="keywordflow">return</span> 1;
<a name="l02856"></a>02856                 <span class="keywordflow">break</span>;
<a name="l02857"></a>02857             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca02bf62758ff66d33c28826738012179d">SPACE_CLIP</a>:
<a name="l02858"></a>02858                 <span class="keywordflow">if</span> (redraws &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a0ac58de1a5e7d792dc05f4b5a090ae4a">TIME_CLIPS</a>)
<a name="l02859"></a>02859                     <span class="keywordflow">return</span> 1;
<a name="l02860"></a>02860                 <span class="keywordflow">break</span>;
<a name="l02861"></a>02861                 
<a name="l02862"></a>02862         }
<a name="l02863"></a>02863     }
<a name="l02864"></a>02864     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (regiontype==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a1324ee7084207af80aad66c626841e8c">RGN_TYPE_UI</a>) {
<a name="l02865"></a>02865         <span class="keywordflow">if</span> (spacetype==<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca02bf62758ff66d33c28826738012179d">SPACE_CLIP</a>) {
<a name="l02866"></a>02866             <span class="comment">/* Track Preview button is on Properties Editor in SpaceClip,</span>
<a name="l02867"></a>02867 <span class="comment">             * and it&#39;s very common case when users want it be refreshing</span>
<a name="l02868"></a>02868 <span class="comment">             * during playback, so asking people to enable special option</span>
<a name="l02869"></a>02869 <span class="comment">             * for this is a bit tricky, so add exception here for refreshing</span>
<a name="l02870"></a>02870 <span class="comment">             * Properties Editor for SpaceClip always */</span>
<a name="l02871"></a>02871             <span class="keywordflow">return</span> 1;
<a name="l02872"></a>02872         }
<a name="l02873"></a>02873 
<a name="l02874"></a>02874         <span class="keywordflow">if</span> (redraws &amp; <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a782c6f51bac9637c963ac2634ef67a64">TIME_ALL_BUTS_WIN</a>)
<a name="l02875"></a>02875             <span class="keywordflow">return</span> 1;
<a name="l02876"></a>02876     }
<a name="l02877"></a>02877     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (regiontype==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2ab7e0b51ce129a8b256dc705a06c4c4e8">RGN_TYPE_HEADER</a>) {
<a name="l02878"></a>02878         <span class="keywordflow">if</span> (spacetype==<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca51011faadfd7d38d3d7a810c600e9458">SPACE_TIME</a>)
<a name="l02879"></a>02879             <span class="keywordflow">return</span> 1;
<a name="l02880"></a>02880     }
<a name="l02881"></a>02881     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (regiontype==<a class="code" href="../../d4/da4/DNA__screen__types_8h.html#a425be5f49e9c31d8d13d53190a3e7bc2a9c229d954ba6692b9ea76f4a444a6ad5">RGN_TYPE_PREVIEW</a>) {
<a name="l02882"></a>02882         <span class="keywordflow">switch</span> (spacetype) {
<a name="l02883"></a>02883             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752caa78bb4ba1705225aa14af78400406414">SPACE_SEQ</a>:
<a name="l02884"></a>02884                 <span class="keywordflow">if</span> (redraws &amp; (<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a4d0af43c016a330c6fea36f0bfbce93b">TIME_SEQ</a>|<a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a6ef6dfba4f1fd8a63ff156505056e953">TIME_ALL_ANIM_WIN</a>))
<a name="l02885"></a>02885                     <span class="keywordflow">return</span> 1;
<a name="l02886"></a>02886                 <span class="keywordflow">break</span>;
<a name="l02887"></a>02887             <span class="keywordflow">case</span> <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca02bf62758ff66d33c28826738012179d">SPACE_CLIP</a>:
<a name="l02888"></a>02888                 <span class="keywordflow">return</span> 1;
<a name="l02889"></a>02889         }
<a name="l02890"></a>02890     }
<a name="l02891"></a>02891     <span class="keywordflow">return</span> 0;
<a name="l02892"></a>02892 }
<a name="l02893"></a>02893 
<a name="l02894"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a93b1b15292b49364cb3336ada6551ab3">02894</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a93b1b15292b49364cb3336ada6551ab3">screen_animation_step</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op), <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l02895"></a>02895 {
<a name="l02896"></a>02896     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l02897"></a>02897 
<a name="l02898"></a>02898     <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a> &amp;&amp; screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>==event-&gt;<a class="code" href="../../d5/d6c/structwmEvent.html#afe8f2bc4e7e67063e0e2a92b08056c17">customdata</a>) {
<a name="l02899"></a>02899         <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l02900"></a>02900         <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l02901"></a>02901         <a class="code" href="../../d9/d33/structwmTimer.html">wmTimer</a> *wt= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>;
<a name="l02902"></a>02902         <a class="code" href="../../d3/d73/structScreenAnimData.html">ScreenAnimData</a> *sad= wt-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#a7e5850b6474f3948cb59cbd188ce68a6">customdata</a>;
<a name="l02903"></a>02903         <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa;
<a name="l02904"></a>02904         <span class="keywordtype">int</span> sync;
<a name="l02905"></a>02905         <span class="keywordtype">float</span> time;
<a name="l02906"></a>02906         
<a name="l02907"></a>02907         <span class="comment">/* sync, don&#39;t sync, or follow scene setting */</span>
<a name="l02908"></a>02908         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdaaa0253682d68ad738ccb9f26d44a8c41">ANIMPLAY_FLAG_SYNC</a>) sync= 1;
<a name="l02909"></a>02909         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda89bb89be8598ee09886b3e68a0ae3276">ANIMPLAY_FLAG_NO_SYNC</a>) sync= 0;
<a name="l02910"></a>02910         <span class="keywordflow">else</span> sync= (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#a60b2a18bedc706447c394de96c276eac">flag</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ad9eb923d098b14b75efc6336d348a8c0">SCE_FRAME_DROP</a>);
<a name="l02911"></a>02911         
<a name="l02912"></a>02912         <span class="keywordflow">if</span> ((scene-&gt;<a class="code" href="../../d9/d27/structScene.html#af91931f1ea3f417f2d9ffba420e7290c">audio</a>.<a class="code" href="../../df/de3/structAudioData.html#ae05139635d439bbf654f7f8be40a9eb1">flag</a> &amp; <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#a8d215e1defbf5794beb5258ad31bd0c7">AUDIO_SYNC</a>) &amp;&amp;
<a name="l02913"></a>02913             (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdaa00169184290913b6d0aaba541540659">ANIMPLAY_FLAG_REVERSE</a>) == <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> &amp;&amp;
<a name="l02914"></a>02914             finite(time = <a class="code" href="../../d2/db1/BKE__sound_8h.html#a4aede8d7c7c9a37ce7eea52979406581">sound_sync_scene</a>(scene)))
<a name="l02915"></a>02915         {
<a name="l02916"></a>02916             scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> = (double)time * <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac92ca5ab87034a348decad7ee8d4bd1b">FPS</a> + 0.5;
<a name="l02917"></a>02917         }
<a name="l02918"></a>02918         <span class="keywordflow">else</span> {
<a name="l02919"></a>02919             <span class="keywordflow">if</span> (sync) {
<a name="l02920"></a>02920                 <span class="keywordtype">int</span> <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a> = floor((wt-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#afccd0baaa4b4d59df1529233fba5aa20">duration</a> - sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#a555ed527919c536f23f47e5a2963cfe0">last_duration</a>) * <a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac92ca5ab87034a348decad7ee8d4bd1b">FPS</a>);
<a name="l02921"></a>02921                 <span class="comment">/* skip frames */</span>
<a name="l02922"></a>02922                 <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdaa00169184290913b6d0aaba541540659">ANIMPLAY_FLAG_REVERSE</a>)
<a name="l02923"></a>02923                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> -= <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>;
<a name="l02924"></a>02924                 <span class="keywordflow">else</span>
<a name="l02925"></a>02925                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> += <a class="code" href="../../d1/d22/stdosl_8h.html#a8bd9f841cf6ee6c256028a8a544fec3b">step</a>;
<a name="l02926"></a>02926             }
<a name="l02927"></a>02927             <span class="keywordflow">else</span> {
<a name="l02928"></a>02928                 <span class="comment">/* one frame +/- */</span>
<a name="l02929"></a>02929                 <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdaa00169184290913b6d0aaba541540659">ANIMPLAY_FLAG_REVERSE</a>)
<a name="l02930"></a>02930                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>--;
<a name="l02931"></a>02931                 <span class="keywordflow">else</span>
<a name="l02932"></a>02932                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>++;
<a name="l02933"></a>02933             }
<a name="l02934"></a>02934         }
<a name="l02935"></a>02935         
<a name="l02936"></a>02936         sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#a555ed527919c536f23f47e5a2963cfe0">last_duration</a> = wt-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#afccd0baaa4b4d59df1529233fba5aa20">duration</a>;
<a name="l02937"></a>02937 
<a name="l02938"></a>02938         <span class="comment">/* reset &#39;jumped&#39; flag before checking if we need to jump... */</span>
<a name="l02939"></a>02939         sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp;= ~<a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda3f38ee8ac10a6efc592c08a67db80c6a">ANIMPLAY_FLAG_JUMPED</a>;
<a name="l02940"></a>02940         
<a name="l02941"></a>02941         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdaa00169184290913b6d0aaba541540659">ANIMPLAY_FLAG_REVERSE</a>) {
<a name="l02942"></a>02942             <span class="comment">/* jump back to end? */</span>
<a name="l02943"></a>02943             <span class="keywordflow">if</span> (<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#af72a23d842a89879f64a610daf4076a4">PRVRANGEON</a>) {
<a name="l02944"></a>02944                 <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> &lt; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a019c2dff23be11d91575d9ac1002ef60">psfra</a>) {
<a name="l02945"></a>02945                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaee474473e40650735fd619f1b357aa3">pefra</a>;
<a name="l02946"></a>02946                     sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> |= <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda3f38ee8ac10a6efc592c08a67db80c6a">ANIMPLAY_FLAG_JUMPED</a>;
<a name="l02947"></a>02947                 }
<a name="l02948"></a>02948             }
<a name="l02949"></a>02949             <span class="keywordflow">else</span> {
<a name="l02950"></a>02950                 <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> &lt; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a97f52582406befb3dba13b121d886526">sfra</a>) {
<a name="l02951"></a>02951                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#af94766d58b62a533f851ce3f42ce026c">efra</a>;
<a name="l02952"></a>02952                     sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> |= <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda3f38ee8ac10a6efc592c08a67db80c6a">ANIMPLAY_FLAG_JUMPED</a>;
<a name="l02953"></a>02953                 }
<a name="l02954"></a>02954             }
<a name="l02955"></a>02955         }
<a name="l02956"></a>02956         <span class="keywordflow">else</span> {
<a name="l02957"></a>02957             <span class="comment">/* jump back to start? */</span>
<a name="l02958"></a>02958             <span class="keywordflow">if</span> (<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#af72a23d842a89879f64a610daf4076a4">PRVRANGEON</a>) {
<a name="l02959"></a>02959                 <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> &gt; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#aaee474473e40650735fd619f1b357aa3">pefra</a>) {
<a name="l02960"></a>02960                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a019c2dff23be11d91575d9ac1002ef60">psfra</a>;
<a name="l02961"></a>02961                     sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> |= <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda3f38ee8ac10a6efc592c08a67db80c6a">ANIMPLAY_FLAG_JUMPED</a>;
<a name="l02962"></a>02962                 }
<a name="l02963"></a>02963             }
<a name="l02964"></a>02964             <span class="keywordflow">else</span> {
<a name="l02965"></a>02965                 <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> &gt; scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#af94766d58b62a533f851ce3f42ce026c">efra</a>) {
<a name="l02966"></a>02966                     scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>= scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#a97f52582406befb3dba13b121d886526">sfra</a>;
<a name="l02967"></a>02967                     sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> |= <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda3f38ee8ac10a6efc592c08a67db80c6a">ANIMPLAY_FLAG_JUMPED</a>;
<a name="l02968"></a>02968                 }
<a name="l02969"></a>02969             }
<a name="l02970"></a>02970         }
<a name="l02971"></a>02971 
<a name="l02972"></a>02972         <span class="comment">/* next frame overriden by user action (pressed jump to first/last frame) */</span>
<a name="l02973"></a>02973         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdae53dcea0ab5c13ee75b3817ced6078a9">ANIMPLAY_FLAG_USE_NEXT_FRAME</a>) {
<a name="l02974"></a>02974             scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a> = sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#a0361b7dd3ea8ab30e5760a55ce82b298">nextfra</a>;
<a name="l02975"></a>02975             sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp;= ~<a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbdae53dcea0ab5c13ee75b3817ced6078a9">ANIMPLAY_FLAG_USE_NEXT_FRAME</a>;
<a name="l02976"></a>02976             sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> |= <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda3f38ee8ac10a6efc592c08a67db80c6a">ANIMPLAY_FLAG_JUMPED</a>;
<a name="l02977"></a>02977         }
<a name="l02978"></a>02978         
<a name="l02979"></a>02979         <span class="keywordflow">if</span> (sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aab5a57eacb4ece43e1f6ebd58f08d026">flag</a> &amp; <a class="code" href="../../d1/d85/ED__screen__types_8h.html#a3babbf89cae9b856a12864a41506efbda3f38ee8ac10a6efc592c08a67db80c6a">ANIMPLAY_FLAG_JUMPED</a>)
<a name="l02980"></a>02980             <a class="code" href="../../d2/db1/BKE__sound_8h.html#aaf31981e9beb2936a88aa3a70f5b4839">sound_seek_scene</a>(bmain, scene);
<a name="l02981"></a>02981         
<a name="l02982"></a>02982         <span class="comment">/* since we follow drawflags, we can&#39;t send notifier but tag regions ourselves */</span>
<a name="l02983"></a>02983         <a class="code" href="../../d1/d12/ED__screen_8h.html#a064a1225eaf305ae55dc93b0d35fbf82">ED_update_for_newframe</a>(<a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C), scene, screen, 1);
<a name="l02984"></a>02984         
<a name="l02985"></a>02985         <span class="keywordflow">for</span> (sa= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l02986"></a>02986             <a class="code" href="../../da/d23/structARegion.html">ARegion</a> *ar;
<a name="l02987"></a>02987             <span class="keywordflow">for</span> (ar= sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a9f3cbd74b3cf2a0660a2db120e956cbf">regionbase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; ar; ar= ar-&gt;<a class="code" href="../../da/d23/structARegion.html#a7193c0e912cca4010db0f244f2dec0d0">next</a>) {
<a name="l02988"></a>02988                 <span class="keywordflow">if</span> (ar==sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#a693e97f3eefe734198557966e80ff0c3">ar</a>)
<a name="l02989"></a>02989                     <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l02990"></a>02990                 <span class="keywordflow">else</span>
<a name="l02991"></a>02991                     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d78/screen__ops_8c.html#a2d8d6bca1d39e81f3ca6d976f096a33c">match_region_with_redraws</a>(sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a>, ar-&gt;<a class="code" href="../../da/d23/structARegion.html#ad430a35493ef271e772179ccb7abb767">regiontype</a>, sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#aa0d6267fbd4d67d9a5fe3d28798bb87e">redraws</a>))
<a name="l02992"></a>02992                         <a class="code" href="../../d1/d12/ED__screen_8h.html#ac6cfac9a218d316df5b76e7fe0f89967">ED_region_tag_redraw</a>(ar);
<a name="l02993"></a>02993             }
<a name="l02994"></a>02994             
<a name="l02995"></a>02995             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d78/screen__ops_8c.html#ac87baa31eb3119fff205a07eae385f0a">match_area_with_refresh</a>(sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a124203529b9ea4c84ca8f8ae4efff3e3">spacetype</a>, sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#ad45fc3cadfdfcb8feac97ee7498ae3ed">refresh</a>))
<a name="l02996"></a>02996                 <a class="code" href="../../d1/d12/ED__screen_8h.html#ae9072acfc70f13e6379261f68f49c691">ED_area_tag_refresh</a>(sa);
<a name="l02997"></a>02997         }
<a name="l02998"></a>02998         
<a name="l02999"></a>02999         <span class="comment">/* update frame rate info too </span>
<a name="l03000"></a>03000 <span class="comment">         * NOTE: this may not be accurate enough, since we might need this after modifiers/etc. </span>
<a name="l03001"></a>03001 <span class="comment">         * have been calculated instead of just before updates have been done?</span>
<a name="l03002"></a>03002 <span class="comment">         */</span>
<a name="l03003"></a>03003         <a class="code" href="../../d1/d12/ED__screen_8h.html#a7456da2520f53f4f13c606b725722d0d">ED_refresh_viewport_fps</a>(C);
<a name="l03004"></a>03004         
<a name="l03005"></a>03005         <span class="comment">/* recalculate the timestep for the timer now that we&#39;ve finished calculating this,</span>
<a name="l03006"></a>03006 <span class="comment">         * since the frames-per-second value may have been changed</span>
<a name="l03007"></a>03007 <span class="comment">         */</span>
<a name="l03008"></a>03008         <span class="comment">// TODO: this may make evaluation a bit slower if the value doesn&#39;t change... any way to avoid this?</span>
<a name="l03009"></a>03009         wt-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#a0ae23d40ac2b2a3bf2c9e9b7a3f5f0d0">timestep</a>= (1.0/<a class="code" href="../../d4/db3/DNA__scene__types_8h.html#ac92ca5ab87034a348decad7ee8d4bd1b">FPS</a>);
<a name="l03010"></a>03010         
<a name="l03011"></a>03011         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03012"></a>03012     }
<a name="l03013"></a>03013     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l03014"></a>03014 }
<a name="l03015"></a>03015 
<a name="l03016"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a716db45c72039afb0d694cc21157f59a">03016</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a716db45c72039afb0d694cc21157f59a">SCREEN_OT_animation_step</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03017"></a>03017 {
<a name="l03018"></a>03018     <span class="comment">/* identifiers */</span>
<a name="l03019"></a>03019     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Animation Step&quot;</span>;
<a name="l03020"></a>03020     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Step through animation by position&quot;</span>;
<a name="l03021"></a>03021     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_animation_step&quot;</span>;
<a name="l03022"></a>03022     
<a name="l03023"></a>03023     <span class="comment">/* api callbacks */</span>
<a name="l03024"></a>03024     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a93b1b15292b49364cb3336ada6551ab3">screen_animation_step</a>;
<a name="l03025"></a>03025     
<a name="l03026"></a>03026     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3fcd41f2e293effecc1ee455dcb51cb9">ED_operator_screenactive_norender</a>;
<a name="l03027"></a>03027     
<a name="l03028"></a>03028 }
<a name="l03029"></a>03029 
<a name="l03030"></a>03030 <span class="comment">/* ****************** anim player, starts or ends timer ***************** */</span>
<a name="l03031"></a>03031 
<a name="l03032"></a>03032 <span class="comment">/* toggle operator */</span>
<a name="l03033"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a53800a57f15f011e5068f966fc95d409">03033</a> <span class="keywordtype">int</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a7286a9603fb0eced0d7a074cd18f20e4">ED_screen_animation_play</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <span class="keywordtype">int</span> sync, <span class="keywordtype">int</span> mode)
<a name="l03034"></a>03034 {
<a name="l03035"></a>03035     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l03036"></a>03036     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene = <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03037"></a>03037 
<a name="l03038"></a>03038     <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>) {
<a name="l03039"></a>03039         <span class="comment">/* stop playback now */</span>
<a name="l03040"></a>03040         <a class="code" href="../../d1/d12/ED__screen_8h.html#a1ab95db1d243febac8044dcc7a1cc342">ED_screen_animation_timer</a>(C, 0, 0, 0, 0);
<a name="l03041"></a>03041         <a class="code" href="../../d2/db1/BKE__sound_8h.html#afca551c057bc1252e58a1308751e1442">sound_stop_scene</a>(scene);
<a name="l03042"></a>03042     }
<a name="l03043"></a>03043     <span class="keywordflow">else</span> {
<a name="l03044"></a>03044         <span class="keywordtype">int</span> refresh= <a class="code" href="../../d8/d5d/DNA__space__types_8h.html#a5efefa44b296976f2147b8acbed1752ca51011faadfd7d38d3d7a810c600e9458">SPACE_TIME</a>; <span class="comment">/* these settings are currently only available from a menu in the TimeLine */</span>
<a name="l03045"></a>03045         
<a name="l03046"></a>03046         <span class="keywordflow">if</span> (mode == 1) <span class="comment">// XXX only play audio forwards!?</span>
<a name="l03047"></a>03047             <a class="code" href="../../d2/db1/BKE__sound_8h.html#a177a4005c98e51bf8ea245a1e5dec352">sound_play_scene</a>(scene);
<a name="l03048"></a>03048         
<a name="l03049"></a>03049         <a class="code" href="../../d1/d12/ED__screen_8h.html#a1ab95db1d243febac8044dcc7a1cc342">ED_screen_animation_timer</a>(C, screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#afe1a5457dd4e28f0ead11527da733c5d">redraws_flag</a>, refresh, sync, mode);
<a name="l03050"></a>03050         
<a name="l03051"></a>03051         <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>) {
<a name="l03052"></a>03052             <a class="code" href="../../d9/d33/structwmTimer.html">wmTimer</a> *wt= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>;
<a name="l03053"></a>03053             <a class="code" href="../../d3/d73/structScreenAnimData.html">ScreenAnimData</a> *sad= wt-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#a7e5850b6474f3948cb59cbd188ce68a6">customdata</a>;
<a name="l03054"></a>03054             
<a name="l03055"></a>03055             sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#a693e97f3eefe734198557966e80ff0c3">ar</a>= <a class="code" href="../../df/d01/BKE__context_8h.html#acfdde96de6c66805749111818756b92f">CTX_wm_region</a>(C);
<a name="l03056"></a>03056         }
<a name="l03057"></a>03057     }
<a name="l03058"></a>03058 
<a name="l03059"></a>03059     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03060"></a>03060 }
<a name="l03061"></a>03061 
<a name="l03062"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3f6c8d727df70b902c0649fb24fad816">03062</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a3f6c8d727df70b902c0649fb24fad816">screen_animation_play_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03063"></a>03063 {
<a name="l03064"></a>03064     <span class="keywordtype">int</span> mode= (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;reverse&quot;</span>)) ? -1 : 1;
<a name="l03065"></a>03065     <span class="keywordtype">int</span> sync= -1;
<a name="l03066"></a>03066     
<a name="l03067"></a>03067     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a6134701e8798d50496b725c9cb1b6868">RNA_struct_property_is_set</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;sync&quot;</span>))
<a name="l03068"></a>03068         sync= (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;sync&quot;</span>));
<a name="l03069"></a>03069     
<a name="l03070"></a>03070     <span class="keywordflow">return</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a7286a9603fb0eced0d7a074cd18f20e4">ED_screen_animation_play</a>(C, sync, mode);
<a name="l03071"></a>03071 }
<a name="l03072"></a>03072 
<a name="l03073"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a32dfd6fcab43a2ab5e7d4456f781f5d0">03073</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a32dfd6fcab43a2ab5e7d4456f781f5d0">SCREEN_OT_animation_play</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03074"></a>03074 {
<a name="l03075"></a>03075     <a class="code" href="../../d0/de5/structPropertyRNA.html">PropertyRNA</a> *prop;
<a name="l03076"></a>03076 
<a name="l03077"></a>03077     <span class="comment">/* identifiers */</span>
<a name="l03078"></a>03078     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Play Animation&quot;</span>;
<a name="l03079"></a>03079     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Play animation&quot;</span>;
<a name="l03080"></a>03080     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>;
<a name="l03081"></a>03081     
<a name="l03082"></a>03082     <span class="comment">/* api callbacks */</span>
<a name="l03083"></a>03083     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3f6c8d727df70b902c0649fb24fad816">screen_animation_play_exec</a>;
<a name="l03084"></a>03084     
<a name="l03085"></a>03085     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3fcd41f2e293effecc1ee455dcb51cb9">ED_operator_screenactive_norender</a>;
<a name="l03086"></a>03086     
<a name="l03087"></a>03087     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;reverse&quot;</span>, 0, <span class="stringliteral">&quot;Play in Reverse&quot;</span>, <span class="stringliteral">&quot;Animation is played backwards&quot;</span>);
<a name="l03088"></a>03088     <a class="code" href="../../dc/d7e/rna__define_8c.html#a97e75cad8daa0d94523c8df118947191">RNA_def_property_flag</a>(prop, <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ac49bd36c069e337f7ee269c672ef1332">PROP_SKIP_SAVE</a>);
<a name="l03089"></a>03089     prop = <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;sync&quot;</span>, 0, <span class="stringliteral">&quot;Sync&quot;</span>, <span class="stringliteral">&quot;Drop frames to maintain framerate&quot;</span>);
<a name="l03090"></a>03090     <a class="code" href="../../dc/d7e/rna__define_8c.html#a97e75cad8daa0d94523c8df118947191">RNA_def_property_flag</a>(prop, <a class="code" href="../../de/d7e/RNA__types_8h.html#ae770cf51782953d602fb7ec23d3f2411ac49bd36c069e337f7ee269c672ef1332">PROP_SKIP_SAVE</a>);
<a name="l03091"></a>03091 }
<a name="l03092"></a>03092 
<a name="l03093"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a26aeea9dc451a46af1d4501922252b62">03093</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a26aeea9dc451a46af1d4501922252b62">screen_animation_cancel_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03094"></a>03094 {
<a name="l03095"></a>03095     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l03096"></a>03096 
<a name="l03097"></a>03097     <span class="keywordflow">if</span> (screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>) {
<a name="l03098"></a>03098         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d10/rna__access_8c.html#a3a81efded6e2e77b384a5d7db179d4b9">RNA_boolean_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;restore_frame&quot;</span>)) {
<a name="l03099"></a>03099             <a class="code" href="../../d3/d73/structScreenAnimData.html">ScreenAnimData</a> *sad= screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#aceeb55809d2fb599d429d03df9c60b99">animtimer</a>-&gt;<a class="code" href="../../d9/d33/structwmTimer.html#a7e5850b6474f3948cb59cbd188ce68a6">customdata</a>;
<a name="l03100"></a>03100             <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03101"></a>03101 
<a name="l03102"></a>03102             <span class="comment">/* reset current frame before stopping, and just send a notifier to deal with the rest</span>
<a name="l03103"></a>03103 <span class="comment">             * (since playback still needs to be stopped)</span>
<a name="l03104"></a>03104 <span class="comment">             */</span>
<a name="l03105"></a>03105             scene-&gt;<a class="code" href="../../d9/d27/structScene.html#aa182df8e0e4fae140d73ddde81ae7385">r</a>.<a class="code" href="../../d3/d27/structRenderData.html#ad385a7555d5d36145f4ea1b27b0ceca8">cfra</a>= sad-&gt;<a class="code" href="../../d3/d73/structScreenAnimData.html#ad221cdd82cb471b99b7abf9eb06abc31">sfra</a>;
<a name="l03106"></a>03106 
<a name="l03107"></a>03107             <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a93a7b7f4bba572e9176db2aa580d7aa9">ND_FRAME</a>, scene);
<a name="l03108"></a>03108         }
<a name="l03109"></a>03109 
<a name="l03110"></a>03110         <span class="comment">/* call the other &quot;toggling&quot; operator to clean up now */</span>
<a name="l03111"></a>03111         <a class="code" href="../../d1/d12/ED__screen_8h.html#a7286a9603fb0eced0d7a074cd18f20e4">ED_screen_animation_play</a>(C, 0, 0);
<a name="l03112"></a>03112     }
<a name="l03113"></a>03113 
<a name="l03114"></a>03114     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ac593ccb5bdf99609d37aac1dc5b03eee">OPERATOR_PASS_THROUGH</a>;
<a name="l03115"></a>03115 }
<a name="l03116"></a>03116 
<a name="l03117"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab5c8655670a4eb49e70c43c3cad1ea99">03117</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab5c8655670a4eb49e70c43c3cad1ea99">SCREEN_OT_animation_cancel</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03118"></a>03118 {
<a name="l03119"></a>03119     <span class="comment">/* identifiers */</span>
<a name="l03120"></a>03120     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Cancel Animation&quot;</span>;
<a name="l03121"></a>03121     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Cancel animation, returning to the original frame&quot;</span>;
<a name="l03122"></a>03122     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_animation_cancel&quot;</span>;
<a name="l03123"></a>03123     
<a name="l03124"></a>03124     <span class="comment">/* api callbacks */</span>
<a name="l03125"></a>03125     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a26aeea9dc451a46af1d4501922252b62">screen_animation_cancel_exec</a>;
<a name="l03126"></a>03126     
<a name="l03127"></a>03127     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>;
<a name="l03128"></a>03128 
<a name="l03129"></a>03129     <a class="code" href="../../dc/d7e/rna__define_8c.html#a6025d606b895666e4099441c3dae79fe">RNA_def_boolean</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;restore_frame&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="stringliteral">&quot;Restore Frame&quot;</span>, <span class="stringliteral">&quot;Restore the frame when animation was initialized&quot;</span>);
<a name="l03130"></a>03130 }
<a name="l03131"></a>03131 
<a name="l03132"></a>03132 <span class="comment">/* ************** border select operator (template) ***************************** */</span>
<a name="l03133"></a>03133 
<a name="l03134"></a>03134 <span class="comment">/* operator state vars used: (added by default WM callbacks)   </span>
<a name="l03135"></a>03135 <span class="comment"> * xmin, ymin     </span>
<a name="l03136"></a>03136 <span class="comment"> * xmax, ymax     </span>
<a name="l03137"></a>03137 <span class="comment"> * </span>
<a name="l03138"></a>03138 <span class="comment"> * customdata: the wmGesture pointer</span>
<a name="l03139"></a>03139 <span class="comment"> * </span>
<a name="l03140"></a>03140 <span class="comment"> * callbacks:</span>
<a name="l03141"></a>03141 <span class="comment"> * </span>
<a name="l03142"></a>03142 <span class="comment"> * exec()   has to be filled in by user</span>
<a name="l03143"></a>03143 <span class="comment"> * </span>
<a name="l03144"></a>03144 <span class="comment"> * invoke() default WM function</span>
<a name="l03145"></a>03145 <span class="comment"> * adds modal handler</span>
<a name="l03146"></a>03146 <span class="comment"> * </span>
<a name="l03147"></a>03147 <span class="comment"> * modal()  default WM function </span>
<a name="l03148"></a>03148 <span class="comment"> * accept modal events while doing it, calls exec(), handles ESC and border drawing</span>
<a name="l03149"></a>03149 <span class="comment"> * </span>
<a name="l03150"></a>03150 <span class="comment"> * poll()   has to be filled in by user for context</span>
<a name="l03151"></a>03151 <span class="comment"> */</span>
<a name="l03152"></a>03152 <span class="preprocessor">#if 0</span>
<a name="l03153"></a>03153 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">int</span> border_select_do(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03154"></a>03154 {
<a name="l03155"></a>03155     <span class="keywordtype">int</span> event_type= <a class="code" href="../../d3/d10/rna__access_8c.html#a852d694fd9e9dbdc92b6a6608e3a73ef">RNA_int_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;event_type&quot;</span>);
<a name="l03156"></a>03156     
<a name="l03157"></a>03157     <span class="keywordflow">if</span> (event_type==<a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>)
<a name="l03158"></a>03158         printf(<span class="stringliteral">&quot;border select do select\n&quot;</span>);
<a name="l03159"></a>03159     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event_type==<a class="code" href="../../d1/d40/wm__event__types_8h.html#adc87b609a6285a24e23172a90734044c">RIGHTMOUSE</a>)
<a name="l03160"></a>03160         printf(<span class="stringliteral">&quot;border select deselect\n&quot;</span>);
<a name="l03161"></a>03161     <span class="keywordflow">else</span> 
<a name="l03162"></a>03162         printf(<span class="stringliteral">&quot;border select do something\n&quot;</span>);
<a name="l03163"></a>03163     
<a name="l03164"></a>03164     <span class="keywordflow">return</span> 1;
<a name="l03165"></a>03165 }
<a name="l03166"></a>03166 
<a name="l03167"></a>03167 <span class="keyword">static</span> <span class="keywordtype">void</span> SCREEN_OT_border_select(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03168"></a>03168 {
<a name="l03169"></a>03169     <span class="comment">/* identifiers */</span>
<a name="l03170"></a>03170     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Border select&quot;</span>;
<a name="l03171"></a>03171     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_border_select&quot;</span>;
<a name="l03172"></a>03172     
<a name="l03173"></a>03173     <span class="comment">/* api callbacks */</span>
<a name="l03174"></a>03174     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = border_select_do;
<a name="l03175"></a>03175     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a8d45022b7baa1add659b6798c15601b1">WM_border_select_invoke</a>;
<a name="l03176"></a>03176     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a721a4a53a8435e444ec3460f327bca3b">modal</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#ab6bb53ebc07c5ca59c0a1a687124de2b">WM_border_select_modal</a>;
<a name="l03177"></a>03177     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ac3d8df4a62e774a42cf67a761f260c1d">cancel</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a30c4cae4bcb919d6519d9a1b5b77cdb0">WM_border_select_cancel</a>;
<a name="l03178"></a>03178     
<a name="l03179"></a>03179     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#aa713266e21e982ecee61e7d2c43a3154">ED_operator_areaactive</a>;
<a name="l03180"></a>03180     
<a name="l03181"></a>03181     <span class="comment">/* rna */</span>
<a name="l03182"></a>03182     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;event_type&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Event Type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l03183"></a>03183     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;xmin&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;X Min&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l03184"></a>03184     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;xmax&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;X Max&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l03185"></a>03185     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;ymin&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Y Min&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l03186"></a>03186     <a class="code" href="../../dc/d7e/rna__define_8c.html#ad9b0c75a6330ff1837409c5d1767af62">RNA_def_int</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;ymax&quot;</span>, 0, INT_MIN, INT_MAX, <span class="stringliteral">&quot;Y Max&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, INT_MIN, INT_MAX);
<a name="l03187"></a>03187     
<a name="l03188"></a>03188 }
<a name="l03189"></a>03189 <span class="preprocessor">#endif</span>
<a name="l03190"></a>03190 <span class="preprocessor"></span>
<a name="l03191"></a>03191 <span class="comment">/* *********************** generic fullscreen &#39;back&#39; button *************** */</span>
<a name="l03192"></a>03192 
<a name="l03193"></a>03193 
<a name="l03194"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#adb68183b94650f90220a05056cd0d332">03194</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#adb68183b94650f90220a05056cd0d332">fullscreen_back_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03195"></a>03195 {
<a name="l03196"></a>03196     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *screen = <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l03197"></a>03197     <a class="code" href="../../d4/d95/structScrArea.html">ScrArea</a> *sa=<a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l03198"></a>03198     
<a name="l03199"></a>03199     <span class="comment">/* search current screen for &#39;fullscreen&#39; areas */</span>
<a name="l03200"></a>03200     <span class="keywordflow">for</span> (sa=screen-&gt;<a class="code" href="../../de/de7/structbScreen.html#ae2f4a800c4c58fe953d91fe8136a0d0f">areabase</a>.<a class="code" href="../../d6/d85/structListBase.html#ae4bd6a74f7798ff2cc2a83d3cfce60cf">first</a>; sa; sa=sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a884b59339f5c0d55408f8727bfc799b7">next</a>) {
<a name="l03201"></a>03201         <span class="keywordflow">if</span> (sa-&gt;<a class="code" href="../../d4/d95/structScrArea.html#a62b30afc9f5a2f501be12a0917cebe35">full</a>) <span class="keywordflow">break</span>;
<a name="l03202"></a>03202     }
<a name="l03203"></a>03203     <span class="keywordflow">if</span> (!sa) {
<a name="l03204"></a>03204         <a class="code" href="../../d2/d40/BKE__report_8h.html#a704625c22b5bb0148eea14635968537a">BKE_report</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#a07dcf0c512e769205201c34c254f4049">reports</a>, <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#ae4f179a72db5cca021a37ec4c6fe4c68a77427e7d5e1c0e3f2fbe37425794e319">RPT_ERROR</a>, <span class="stringliteral">&quot;No fullscreen areas were found&quot;</span>);
<a name="l03205"></a>03205         <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a1f73d37a649632bed12f1ee51e2af55b">OPERATOR_CANCELLED</a>;
<a name="l03206"></a>03206     }
<a name="l03207"></a>03207     
<a name="l03208"></a>03208     <a class="code" href="../../d1/d12/ED__screen_8h.html#aa9ce9ca868cc6327957c5d0b542100f8">ED_screen_full_restore</a>(C, sa);
<a name="l03209"></a>03209     
<a name="l03210"></a>03210     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03211"></a>03211 }
<a name="l03212"></a>03212 
<a name="l03213"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a043be9bb4ef9e2adfab2ca7f611b6a42">03213</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a043be9bb4ef9e2adfab2ca7f611b6a42">SCREEN_OT_back_to_previous</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03214"></a>03214 {
<a name="l03215"></a>03215     <span class="comment">/* identifiers */</span>
<a name="l03216"></a>03216     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Back to Previous Screen&quot;</span>;
<a name="l03217"></a>03217     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Revert back to the original screen layout, before fullscreen area overlay&quot;</span>;
<a name="l03218"></a>03218     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_back_to_previous&quot;</span>;
<a name="l03219"></a>03219     
<a name="l03220"></a>03220     <span class="comment">/* api callbacks */</span>
<a name="l03221"></a>03221     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#adb68183b94650f90220a05056cd0d332">fullscreen_back_exec</a>;
<a name="l03222"></a>03222     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>;
<a name="l03223"></a>03223 }
<a name="l03224"></a>03224 
<a name="l03225"></a>03225 <span class="comment">/* *********** show user pref window ****** */</span>
<a name="l03226"></a>03226 
<a name="l03227"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aeee4b54ff032fd13edcbf40a50f93d88">03227</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aeee4b54ff032fd13edcbf40a50f93d88">userpref_show_invoke</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op), <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *event)
<a name="l03228"></a>03228 {
<a name="l03229"></a>03229     <a class="code" href="../../d0/d28/structrcti.html">rcti</a> rect;
<a name="l03230"></a>03230     <span class="keywordtype">int</span> sizex, sizey;
<a name="l03231"></a>03231     
<a name="l03232"></a>03232     sizex= 800;
<a name="l03233"></a>03233     sizey= 480;
<a name="l03234"></a>03234     
<a name="l03235"></a>03235     <span class="comment">/* some magic to calculate postition */</span>
<a name="l03236"></a>03236     rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> = <span class="keyword">event</span>-&gt;x + <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#a226ce379ebcc0b691d3278c6d20e313b">posx</a> - sizex/2;
<a name="l03237"></a>03237     rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> = <span class="keyword">event</span>-&gt;y + <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C)-&gt;<a class="code" href="../../dc/da4/structwmWindow.html#ae754b68a91f58a8541c1226b760ac9bb">posy</a> - sizey/2;
<a name="l03238"></a>03238     rect.<a class="code" href="../../d0/d28/structrcti.html#aed85b3972f94e2946a2bfcb60e036986">xmax</a> = rect.<a class="code" href="../../d0/d28/structrcti.html#acdf13419de6bc3f4944a981589bc3a03">xmin</a> + sizex;
<a name="l03239"></a>03239     rect.<a class="code" href="../../d0/d28/structrcti.html#a5e0cd2b56e95eba87777402106f57a9a">ymax</a> = rect.<a class="code" href="../../d0/d28/structrcti.html#a1d1838135b30932a8ce557885d924518">ymin</a> + sizey;
<a name="l03240"></a>03240     
<a name="l03241"></a>03241     <span class="comment">/* changes context! */</span>
<a name="l03242"></a>03242     <a class="code" href="../../d7/d6e/wm__window_8c.html#a889e541c2f993d4f3cfeea0485efcfd4">WM_window_open_temp</a>(C, &amp;rect, <a class="code" href="../../d4/d7f/WM__api_8h.html#ab42359d0aab9115b33be2c86d536e02f">WM_WINDOW_USERPREFS</a>);
<a name="l03243"></a>03243     
<a name="l03244"></a>03244     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03245"></a>03245 }
<a name="l03246"></a>03246 
<a name="l03247"></a>03247 
<a name="l03248"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1afe1fc293d324892369047fcfafe88f">03248</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a1afe1fc293d324892369047fcfafe88f">SCREEN_OT_userpref_show</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03249"></a>03249 {
<a name="l03250"></a>03250     <span class="comment">/* identifiers */</span>
<a name="l03251"></a>03251     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Show/Hide User Preferences&quot;</span>;
<a name="l03252"></a>03252     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Show/hide user preferences&quot;</span>;
<a name="l03253"></a>03253     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_userpref_show&quot;</span>;
<a name="l03254"></a>03254     
<a name="l03255"></a>03255     <span class="comment">/* api callbacks */</span>
<a name="l03256"></a>03256     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#aeee4b54ff032fd13edcbf40a50f93d88">userpref_show_invoke</a>;
<a name="l03257"></a>03257     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d1/d12/ED__screen_8h.html#a6be3d7611082ea5665ee122fad49a193">ED_operator_screenactive</a>;
<a name="l03258"></a>03258 }
<a name="l03259"></a>03259 
<a name="l03260"></a>03260 <span class="comment">/********************* new screen operator *********************/</span>
<a name="l03261"></a>03261 
<a name="l03262"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3d3787a144d993c17b14a803eceb2202">03262</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a3d3787a144d993c17b14a803eceb2202">screen_new_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l03263"></a>03263 {
<a name="l03264"></a>03264     <a class="code" href="../../dc/da4/structwmWindow.html">wmWindow</a> *win= <a class="code" href="../../df/d01/BKE__context_8h.html#af86d2cf919d95eaefc99c2c3e553057e">CTX_wm_window</a>(C);
<a name="l03265"></a>03265     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l03266"></a>03266     
<a name="l03267"></a>03267     sc= <a class="code" href="../../d1/d12/ED__screen_8h.html#a606f34557f83e1d3c9eeda016a3d624b">ED_screen_duplicate</a>(win, sc);
<a name="l03268"></a>03268     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a024a1d387080576fe2eb4b5cfd30efd8">ND_SCREENBROWSE</a>, sc);
<a name="l03269"></a>03269     
<a name="l03270"></a>03270     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03271"></a>03271 }
<a name="l03272"></a>03272 
<a name="l03273"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab524045dfc51881f905b8fad472efabe">03273</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab524045dfc51881f905b8fad472efabe">SCREEN_OT_new</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03274"></a>03274 {
<a name="l03275"></a>03275     <span class="comment">/* identifiers */</span>
<a name="l03276"></a>03276     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;New Screen&quot;</span>;
<a name="l03277"></a>03277     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Add a new screen&quot;</span>;
<a name="l03278"></a>03278     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_new&quot;</span>;
<a name="l03279"></a>03279     
<a name="l03280"></a>03280     <span class="comment">/* api callbacks */</span>
<a name="l03281"></a>03281     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a3d3787a144d993c17b14a803eceb2202">screen_new_exec</a>;
<a name="l03282"></a>03282     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aecedd63f8c02cb14ac8e91014550c7d9">poll</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a1a80edec1422a70bda2ca37ed283a876">WM_operator_winactive</a>;
<a name="l03283"></a>03283     
<a name="l03284"></a>03284     <span class="comment">/* flags */</span>
<a name="l03285"></a>03285     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03286"></a>03286 }
<a name="l03287"></a>03287 
<a name="l03288"></a>03288 <span class="comment">/********************* delete screen operator *********************/</span>
<a name="l03289"></a>03289 
<a name="l03290"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a088e952ac5bc6d41bff91c46b78eebc0">03290</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a088e952ac5bc6d41bff91c46b78eebc0">screen_delete_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l03291"></a>03291 {
<a name="l03292"></a>03292     <a class="code" href="../../de/de7/structbScreen.html">bScreen</a> *sc= <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C);
<a name="l03293"></a>03293     
<a name="l03294"></a>03294     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a4d138b3b2f069a9db1d8cc28c7ed071d">NC_SCREEN</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a9a73baf3e1573cc377e6368cae4b8fd5">ND_SCREENDELETE</a>, sc);
<a name="l03295"></a>03295     
<a name="l03296"></a>03296     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03297"></a>03297 }
<a name="l03298"></a>03298 
<a name="l03299"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a7963eec42977eda4239a25ee18e89416">03299</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a7963eec42977eda4239a25ee18e89416">SCREEN_OT_delete</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03300"></a>03300 {
<a name="l03301"></a>03301     <span class="comment">/* identifiers */</span>
<a name="l03302"></a>03302     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Delete Screen&quot;</span>; <span class="comment">//was scene</span>
<a name="l03303"></a>03303     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Delete active screen&quot;</span>;
<a name="l03304"></a>03304     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCREEN_OT_delete&quot;</span>;
<a name="l03305"></a>03305     
<a name="l03306"></a>03306     <span class="comment">/* api callbacks */</span>
<a name="l03307"></a>03307     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a088e952ac5bc6d41bff91c46b78eebc0">screen_delete_exec</a>;
<a name="l03308"></a>03308     
<a name="l03309"></a>03309     <span class="comment">/* flags */</span>
<a name="l03310"></a>03310     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03311"></a>03311 }
<a name="l03312"></a>03312 
<a name="l03313"></a>03313 <span class="comment">/********************* new scene operator *********************/</span>
<a name="l03314"></a>03314 
<a name="l03315"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a86ef2b6db6285bc92ef572d875e9ed3e">03315</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a86ef2b6db6285bc92ef572d875e9ed3e">scene_new_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *op)
<a name="l03316"></a>03316 {
<a name="l03317"></a>03317     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *newscene, *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03318"></a>03318     <a class="code" href="../../d0/dc0/structMain.html">Main</a> *bmain= <a class="code" href="../../df/d01/BKE__context_8h.html#ae849d2f7c2427ac6b75ee0c5ffcead6c">CTX_data_main</a>(C);
<a name="l03319"></a>03319     <span class="keywordtype">int</span> type= <a class="code" href="../../d3/d10/rna__access_8c.html#adf28976d740b269f80b747eb62fea6ce">RNA_enum_get</a>(op-&gt;<a class="code" href="../../d3/d19/structwmOperator.html#ab29f54bc949a386e57fa0211637bbbbe">ptr</a>, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l03320"></a>03320 
<a name="l03321"></a>03321     <span class="keywordflow">if</span> (type == <a class="code" href="../../d8/d53/BKE__scene_8h.html#a011e2ab413bb148cfd6236cec0c9e7c7">SCE_COPY_NEW</a>) {
<a name="l03322"></a>03322         newscene= <a class="code" href="../../d8/d53/BKE__scene_8h.html#a69a66e7b13f7dc7041a82436563ee915">add_scene</a>(<span class="stringliteral">&quot;Scene&quot;</span>);
<a name="l03323"></a>03323     }
<a name="l03324"></a>03324     <span class="keywordflow">else</span> { <span class="comment">/* different kinds of copying */</span>
<a name="l03325"></a>03325         newscene= <a class="code" href="../../d8/d53/BKE__scene_8h.html#af6fbc79d98fd75a7920e6794840ce32f">copy_scene</a>(scene, type);
<a name="l03326"></a>03326 
<a name="l03327"></a>03327         <span class="comment">/* these can&#39;t be handled in blenkernel curently, so do them here */</span>
<a name="l03328"></a>03328         <span class="keywordflow">if</span> (type == <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1cca55ee1e2f86963fd0d2ac9c7099e">SCE_COPY_LINK_DATA</a>) {
<a name="l03329"></a>03329             <a class="code" href="../../da/d7a/ED__object_8h.html#ac2b6b57c7292f4aeec3c2cfa52b10b02">ED_object_single_users</a>(bmain, newscene, 0);
<a name="l03330"></a>03330         }
<a name="l03331"></a>03331         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1c346b660cd6575ec15790ad0e0680b">SCE_COPY_FULL</a>) {
<a name="l03332"></a>03332             <a class="code" href="../../da/d7a/ED__object_8h.html#ac2b6b57c7292f4aeec3c2cfa52b10b02">ED_object_single_users</a>(bmain, newscene, 1);
<a name="l03333"></a>03333         }
<a name="l03334"></a>03334     }
<a name="l03335"></a>03335     
<a name="l03336"></a>03336     <a class="code" href="../../d1/d12/ED__screen_8h.html#a9f5966663a764f73d1c95182c9ded365">ED_screen_set_scene</a>(C, <a class="code" href="../../df/d01/BKE__context_8h.html#aa054e49f38f3c9becfebc4013ecf457f">CTX_wm_screen</a>(C), newscene);
<a name="l03337"></a>03337     
<a name="l03338"></a>03338     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#adbad88666cced8c066e003a43131c648">ND_SCENEBROWSE</a>, newscene);
<a name="l03339"></a>03339     
<a name="l03340"></a>03340     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03341"></a>03341 }
<a name="l03342"></a>03342 
<a name="l03343"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3601f9c7410aebb4f19a8b9d0bddf6af">03343</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a3601f9c7410aebb4f19a8b9d0bddf6af">SCENE_OT_new</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03344"></a>03344 {
<a name="l03345"></a>03345     <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> type_items[]= {
<a name="l03346"></a>03346         {<a class="code" href="../../d8/d53/BKE__scene_8h.html#a011e2ab413bb148cfd6236cec0c9e7c7">SCE_COPY_NEW</a>, <span class="stringliteral">&quot;NEW&quot;</span>, 0, <span class="stringliteral">&quot;New&quot;</span>, <span class="stringliteral">&quot;Add new scene&quot;</span>},
<a name="l03347"></a>03347         {<a class="code" href="../../d8/d53/BKE__scene_8h.html#a2cfcb4fed1ae82822294c92a020c1482">SCE_COPY_EMPTY</a>, <span class="stringliteral">&quot;EMPTY&quot;</span>, 0, <span class="stringliteral">&quot;Copy Settings&quot;</span>, <span class="stringliteral">&quot;Make a copy without any objects&quot;</span>},
<a name="l03348"></a>03348         {<a class="code" href="../../d8/d53/BKE__scene_8h.html#abfe0fb164f770ec5d762c1e47ec61f64">SCE_COPY_LINK_OB</a>, <span class="stringliteral">&quot;LINK_OBJECTS&quot;</span>, 0, <span class="stringliteral">&quot;Link Objects&quot;</span>, <span class="stringliteral">&quot;Link to the objects from the current scene&quot;</span>},
<a name="l03349"></a>03349         {<a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1cca55ee1e2f86963fd0d2ac9c7099e">SCE_COPY_LINK_DATA</a>, <span class="stringliteral">&quot;LINK_OBJECT_DATA&quot;</span>, 0, <span class="stringliteral">&quot;Link Object Data&quot;</span>, <span class="stringliteral">&quot;Copy objects linked to data from the current scene&quot;</span>},
<a name="l03350"></a>03350         {<a class="code" href="../../d8/d53/BKE__scene_8h.html#ac1c346b660cd6575ec15790ad0e0680b">SCE_COPY_FULL</a>, <span class="stringliteral">&quot;FULL_COPY&quot;</span>, 0, <span class="stringliteral">&quot;Full Copy&quot;</span>, <span class="stringliteral">&quot;Make a full copy of the current scene&quot;</span>},
<a name="l03351"></a>03351         {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l03352"></a>03352     
<a name="l03353"></a>03353     <span class="comment">/* identifiers */</span>
<a name="l03354"></a>03354     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;New Scene&quot;</span>;
<a name="l03355"></a>03355     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Add new scene by type&quot;</span>;
<a name="l03356"></a>03356     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCENE_OT_new&quot;</span>;
<a name="l03357"></a>03357     
<a name="l03358"></a>03358     <span class="comment">/* api callbacks */</span>
<a name="l03359"></a>03359     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a86ef2b6db6285bc92ef572d875e9ed3e">scene_new_exec</a>;
<a name="l03360"></a>03360     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a712df4059514069aeb44df0248922812">invoke</a> = <a class="code" href="../../d6/dae/wm__operators_8c.html#a926375c583166540cfa96299e433e071">WM_menu_invoke</a>;
<a name="l03361"></a>03361     
<a name="l03362"></a>03362     <span class="comment">/* flags */</span>
<a name="l03363"></a>03363     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03364"></a>03364     
<a name="l03365"></a>03365     <span class="comment">/* properties */</span>
<a name="l03366"></a>03366     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#ad2ecde05b67ff7682699554ee5a0bfc9">prop</a> = <a class="code" href="../../dc/d7e/rna__define_8c.html#af2ad58c3924113813903fe1b6a2bd5ac">RNA_def_enum</a>(ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a7f4c35af5aa349f0e4a90a1f0710ddc6">srna</a>, <span class="stringliteral">&quot;type&quot;</span>, type_items, 0, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l03367"></a>03367 }
<a name="l03368"></a>03368 
<a name="l03369"></a>03369 <span class="comment">/********************* delete scene operator *********************/</span>
<a name="l03370"></a>03370 
<a name="l03371"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1fdebb5ecc6e8c5c55ec8765e1b9ddb4">03371</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a1fdebb5ecc6e8c5c55ec8765e1b9ddb4">scene_delete_exec</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *C, <a class="code" href="../../d3/d19/structwmOperator.html">wmOperator</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(op))
<a name="l03372"></a>03372 {
<a name="l03373"></a>03373     <a class="code" href="../../d9/d27/structScene.html">Scene</a> *scene= <a class="code" href="../../df/d01/BKE__context_8h.html#a0bcac8ad3452a040293c01084665a258">CTX_data_scene</a>(C);
<a name="l03374"></a>03374 
<a name="l03375"></a>03375     <a class="code" href="../../d1/d12/ED__screen_8h.html#ab2b7a6b7f58f815090eaeb5e22ddc673">ED_screen_delete_scene</a>(C, scene);
<a name="l03376"></a>03376 
<a name="l03377"></a>03377     <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc8/util__md5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>.debug &amp; <a class="code" href="../../d1/d8c/BKE__global_8h.html#a726ca809ffd3d67ab4b8476646f26635a1207ca157c84a6be5a8a36c691c4aa72">G_DEBUG</a>)
<a name="l03378"></a>03378         printf(<span class="stringliteral">&quot;scene delete %p\n&quot;</span>, scene);
<a name="l03379"></a>03379 
<a name="l03380"></a>03380     <a class="code" href="../../df/db0/wm__event__system_8c.html#a6a6bfb771c3639a4f1038d56a3fa0217">WM_event_add_notifier</a>(C, <a class="code" href="../../d4/ddc/WM__types_8h.html#a61261a6b5ea948eee6d42c7e7ee18166">NC_SCENE</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a9e971b3c86d560d28a06ea074e04fa84">NA_REMOVED</a>, scene);
<a name="l03381"></a>03381 
<a name="l03382"></a>03382     <span class="keywordflow">return</span> <a class="code" href="../../de/dc1/DNA__windowmanager__types_8h.html#a818d2533e88d91a930488ab021d18474">OPERATOR_FINISHED</a>;
<a name="l03383"></a>03383 }
<a name="l03384"></a>03384 
<a name="l03385"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#ab0a4b6e1d67d3f39aed367f0ae8e4092">03385</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#ab0a4b6e1d67d3f39aed367f0ae8e4092">SCENE_OT_delete</a>(<a class="code" href="../../de/d5e/structwmOperatorType.html">wmOperatorType</a> *ot)
<a name="l03386"></a>03386 {
<a name="l03387"></a>03387     <span class="comment">/* identifiers */</span>
<a name="l03388"></a>03388     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a04a27d629d618d3991e1825683ecbd99">name</a> = <span class="stringliteral">&quot;Delete Scene&quot;</span>;
<a name="l03389"></a>03389     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#aa66ab7b95cf41f92a6da53c53e873db4">description</a> = <span class="stringliteral">&quot;Delete active scene&quot;</span>;
<a name="l03390"></a>03390     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a46882f447e704ec2b65bf69bf826a306">idname</a> = <span class="stringliteral">&quot;SCENE_OT_delete&quot;</span>;
<a name="l03391"></a>03391     
<a name="l03392"></a>03392     <span class="comment">/* api callbacks */</span>
<a name="l03393"></a>03393     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#acf19aee20badd3857d211524b081a939">exec</a> = <a class="code" href="../../d6/d78/screen__ops_8c.html#a1fdebb5ecc6e8c5c55ec8765e1b9ddb4">scene_delete_exec</a>;
<a name="l03394"></a>03394     
<a name="l03395"></a>03395     <span class="comment">/* flags */</span>
<a name="l03396"></a>03396     ot-&gt;<a class="code" href="../../de/d5e/structwmOperatorType.html#a0f07ac6290f51c0a39e25940bf8c9d78">flag</a> = <a class="code" href="../../d4/ddc/WM__types_8h.html#adb7cbb6b0205d00b470cbd1f158bb489">OPTYPE_REGISTER</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a0884b8bbb246819cf52a01174d687370">OPTYPE_UNDO</a>;
<a name="l03397"></a>03397 }
<a name="l03398"></a>03398 
<a name="l03399"></a>03399 <span class="comment">/* ****************  Assigning operatortypes to global list, adding handlers **************** */</span>
<a name="l03400"></a>03400 
<a name="l03401"></a>03401 
<a name="l03402"></a>03402 <span class="comment">/* called in spacetypes.c */</span>
<a name="l03403"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a1f7410875624a5dd53dfe42f9114aaf5">03403</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a1f7410875624a5dd53dfe42f9114aaf5">ED_operatortypes_screen</a>(<span class="keywordtype">void</span>)
<a name="l03404"></a>03404 {
<a name="l03405"></a>03405     <span class="comment">/* generic UI stuff */</span>
<a name="l03406"></a>03406     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a45c3bdd48644c2c1e2a23d3e7563121b">SCREEN_OT_actionzone</a>);
<a name="l03407"></a>03407     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#acc3f855dbfca3524533ddba3f8640e47">SCREEN_OT_repeat_last</a>);
<a name="l03408"></a>03408     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#ab21e01850c2f3518917e308da2b17964">SCREEN_OT_repeat_history</a>);
<a name="l03409"></a>03409     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a6583c16b1eb02f8590c9dc5e5ddeeccd">SCREEN_OT_redo_last</a>);
<a name="l03410"></a>03410     
<a name="l03411"></a>03411     <span class="comment">/* screen tools */</span>
<a name="l03412"></a>03412     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#ad6e833a2ca4e8dd6d0a4eff008d80672">SCREEN_OT_area_move</a>);
<a name="l03413"></a>03413     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#aacb25639d0e2ea11ec55594b321c3b88">SCREEN_OT_area_split</a>);
<a name="l03414"></a>03414     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#afdaa2459552181b330df337e39f2d0c9">SCREEN_OT_area_join</a>);
<a name="l03415"></a>03415     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a080917f97e5a60c1d8d3dfb093fdf7f1">SCREEN_OT_area_options</a>);
<a name="l03416"></a>03416     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#abca82fd028ff20bdefb0e7198384f1f7">SCREEN_OT_area_dupli</a>);
<a name="l03417"></a>03417     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#aa7faf0606a0f3d793bd846c51f1d95c6">SCREEN_OT_area_swap</a>);
<a name="l03418"></a>03418     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#abe95a3b27a6daae02041a2bf9b415bb7">SCREEN_OT_region_quadview</a>);
<a name="l03419"></a>03419     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a19eaca03e59bac10fcee40a426d8f060">SCREEN_OT_region_scale</a>);
<a name="l03420"></a>03420     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#aea782c07d3642d748018dfbdd4ac8dac">SCREEN_OT_region_flip</a>);
<a name="l03421"></a>03421     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a47b7fa2c85649b5e52490b7d29e61589">SCREEN_OT_header_flip</a>);
<a name="l03422"></a>03422     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a4b80f7cedbe919b2011c29591a6a22b5">SCREEN_OT_header_toolbox</a>);
<a name="l03423"></a>03423     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#abe98b823491723b088811cad75c09721">SCREEN_OT_screen_set</a>);
<a name="l03424"></a>03424     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a8370ea3c5ea82f94f6605e0b43c587fb">SCREEN_OT_screen_full_area</a>);
<a name="l03425"></a>03425     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a043be9bb4ef9e2adfab2ca7f611b6a42">SCREEN_OT_back_to_previous</a>);
<a name="l03426"></a>03426     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#ab138ec020aa935eb2ca1209ff8c6b490">SCREEN_OT_spacedata_cleanup</a>);
<a name="l03427"></a>03427     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d7/de3/screen__intern_8h.html#aec838fad3ea29bb6b7db121c99b8e095">SCREEN_OT_screenshot</a>);
<a name="l03428"></a>03428     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d7/de3/screen__intern_8h.html#a388293fa07755b0fd32ff7c030d15a3a">SCREEN_OT_screencast</a>);
<a name="l03429"></a>03429     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a1afe1fc293d324892369047fcfafe88f">SCREEN_OT_userpref_show</a>);
<a name="l03430"></a>03430     
<a name="l03431"></a>03431     <span class="comment">/*frame changes*/</span>
<a name="l03432"></a>03432     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a87f49b7a703c958875441ca1fbd74c55">SCREEN_OT_frame_offset</a>);
<a name="l03433"></a>03433     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a623f48a74b5e20ff586dfc2585783c33">SCREEN_OT_frame_jump</a>);
<a name="l03434"></a>03434     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a59f89f13f32a948b5f5e8ed363066339">SCREEN_OT_keyframe_jump</a>);
<a name="l03435"></a>03435     
<a name="l03436"></a>03436     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a716db45c72039afb0d694cc21157f59a">SCREEN_OT_animation_step</a>);
<a name="l03437"></a>03437     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a32dfd6fcab43a2ab5e7d4456f781f5d0">SCREEN_OT_animation_play</a>);
<a name="l03438"></a>03438     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#ab5c8655670a4eb49e70c43c3cad1ea99">SCREEN_OT_animation_cancel</a>);
<a name="l03439"></a>03439     
<a name="l03440"></a>03440     <span class="comment">/* new/delete */</span>
<a name="l03441"></a>03441     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#ab524045dfc51881f905b8fad472efabe">SCREEN_OT_new</a>);
<a name="l03442"></a>03442     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a7963eec42977eda4239a25ee18e89416">SCREEN_OT_delete</a>);
<a name="l03443"></a>03443     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#a3601f9c7410aebb4f19a8b9d0bddf6af">SCENE_OT_new</a>);
<a name="l03444"></a>03444     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/d78/screen__ops_8c.html#ab0a4b6e1d67d3f39aed367f0ae8e4092">SCENE_OT_delete</a>);
<a name="l03445"></a>03445     
<a name="l03446"></a>03446     <span class="comment">/* tools shared by more space types */</span>
<a name="l03447"></a>03447     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/df1/ED__util_8h.html#a124241bcd4ca01f3f68a25bd7b4fd84a">ED_OT_undo</a>);
<a name="l03448"></a>03448     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/df1/ED__util_8h.html#aaeac3944238ac9be75ff1a1d19b62ba6">ED_OT_undo_push</a>);
<a name="l03449"></a>03449     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/df1/ED__util_8h.html#a62e37f6accea2dce57adba56f0f3cb6b">ED_OT_redo</a>); 
<a name="l03450"></a>03450     <a class="code" href="../../d6/dae/wm__operators_8c.html#a7c407ff2261b21c85afff3b689e279c0">WM_operatortype_append</a>(<a class="code" href="../../d6/df1/ED__util_8h.html#a093ccf0f912cc0632df041026264d77e">ED_OT_undo_history</a>);
<a name="l03451"></a>03451     
<a name="l03452"></a>03452 }
<a name="l03453"></a>03453 
<a name="l03454"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a17aebc50b4b331d668fe7274c55cfdd9">03454</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#a17aebc50b4b331d668fe7274c55cfdd9">keymap_modal_set</a>(<a class="code" href="../../d3/df7/structwmKeyConfig.html">wmKeyConfig</a> *keyconf)
<a name="l03455"></a>03455 {
<a name="l03456"></a>03456     <span class="keyword">static</span> <a class="code" href="../../d1/d8a/structEnumPropertyItem.html">EnumPropertyItem</a> modal_items[] = {
<a name="l03457"></a>03457         {<a class="code" href="../../d6/d78/screen__ops_8c.html#a3777e41f316fcd855d7c869d14869def">KM_MODAL_CANCEL</a>, <span class="stringliteral">&quot;CANCEL&quot;</span>, 0, <span class="stringliteral">&quot;Cancel&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03458"></a>03458         {<a class="code" href="../../d6/d78/screen__ops_8c.html#a1a9ee4a520928902e3a1d441305c699a">KM_MODAL_APPLY</a>, <span class="stringliteral">&quot;APPLY&quot;</span>, 0, <span class="stringliteral">&quot;Apply&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03459"></a>03459         {<a class="code" href="../../d6/d78/screen__ops_8c.html#aaa0c0c8c1b1c41ed211744018dcb8521">KM_MODAL_STEP10</a>, <span class="stringliteral">&quot;STEP10&quot;</span>, 0, <span class="stringliteral">&quot;Steps on&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03460"></a>03460         {<a class="code" href="../../d6/d78/screen__ops_8c.html#ace9d233d9ac6f851d53692b3287a4c00">KM_MODAL_STEP10_OFF</a>, <span class="stringliteral">&quot;STEP10_OFF&quot;</span>, 0, <span class="stringliteral">&quot;Steps off&quot;</span>, <span class="stringliteral">&quot;&quot;</span>},
<a name="l03461"></a>03461         {0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../df/dac/source_2blender_2blenpluginapi_2util_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, NULL}};
<a name="l03462"></a>03462     <a class="code" href="../../d3/d90/structwmKeyMap.html">wmKeyMap</a> *keymap;
<a name="l03463"></a>03463     
<a name="l03464"></a>03464     <span class="comment">/* Standard Modal keymap ------------------------------------------------ */</span>
<a name="l03465"></a>03465     keymap= <a class="code" href="../../d7/d78/wm__keymap_8c.html#aba987a8051ff9224f3793af46ad80ef0">WM_modalkeymap_add</a>(keyconf, <span class="stringliteral">&quot;Standard Modal Map&quot;</span>, modal_items);
<a name="l03466"></a>03466     
<a name="l03467"></a>03467     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a2f9326009327f701d94d0056c11848d7">WM_modalkeymap_add_item</a>(keymap, <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>,    <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, 0, <a class="code" href="../../d6/d78/screen__ops_8c.html#a3777e41f316fcd855d7c869d14869def">KM_MODAL_CANCEL</a>);
<a name="l03468"></a>03468     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a2f9326009327f701d94d0056c11848d7">WM_modalkeymap_add_item</a>(keymap, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, 0, <a class="code" href="../../d6/d78/screen__ops_8c.html#a1a9ee4a520928902e3a1d441305c699a">KM_MODAL_APPLY</a>);
<a name="l03469"></a>03469     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a2f9326009327f701d94d0056c11848d7">WM_modalkeymap_add_item</a>(keymap, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a6c861c5ebabe8fe076ed84a2aaa7a1a0">RETKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, 0, <a class="code" href="../../d6/d78/screen__ops_8c.html#a1a9ee4a520928902e3a1d441305c699a">KM_MODAL_APPLY</a>);
<a name="l03470"></a>03470     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a2f9326009327f701d94d0056c11848d7">WM_modalkeymap_add_item</a>(keymap, <a class="code" href="../../d1/d40/wm__event__types_8h.html#aafdc675e684c8485e8e27c7f2bafcbef">PADENTER</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, 0, <a class="code" href="../../d6/d78/screen__ops_8c.html#a1a9ee4a520928902e3a1d441305c699a">KM_MODAL_APPLY</a>);
<a name="l03471"></a>03471     
<a name="l03472"></a>03472     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a2f9326009327f701d94d0056c11848d7">WM_modalkeymap_add_item</a>(keymap, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ad025960542c5698bad7efc649c641897">LEFTCTRLKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, 0, <a class="code" href="../../d6/d78/screen__ops_8c.html#aaa0c0c8c1b1c41ed211744018dcb8521">KM_MODAL_STEP10</a>);
<a name="l03473"></a>03473     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a2f9326009327f701d94d0056c11848d7">WM_modalkeymap_add_item</a>(keymap, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ad025960542c5698bad7efc649c641897">LEFTCTRLKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afe9c69ca34c3a8d6c0b38daf64ab24b6">KM_RELEASE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, 0, <a class="code" href="../../d6/d78/screen__ops_8c.html#ace9d233d9ac6f851d53692b3287a4c00">KM_MODAL_STEP10_OFF</a>);
<a name="l03474"></a>03474     
<a name="l03475"></a>03475     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a52b3b3b2eb2b660abd0cb8d58acb232b">WM_modalkeymap_assign</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_area_move&quot;</span>);
<a name="l03476"></a>03476     
<a name="l03477"></a>03477 }
<a name="l03478"></a>03478 
<a name="l03479"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#aa695895e4d68b7f57c9d6556c913539e">03479</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#aa695895e4d68b7f57c9d6556c913539e">open_file_drop_poll</a>(<a class="code" href="../../d5/df1/structbContext.html">bContext</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(C), <a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../d5/d6c/structwmEvent.html">wmEvent</a> *<a class="code" href="../../da/d7d/BLI__utildefines_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(event))
<a name="l03480"></a>03480 {
<a name="l03481"></a>03481     <span class="keywordflow">if</span> (drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#aefc7fd61eecff37c03bab3cd263d2ba6">type</a>==<a class="code" href="../../d4/ddc/WM__types_8h.html#a2905a35599b97e9022a7af7d86e9aa06">WM_DRAG_PATH</a>) {
<a name="l03482"></a>03482         <span class="keywordflow">if</span> (drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a60291b8942feebbb1666a63f70be72be">icon</a>==ICON_FILE_BLEND)
<a name="l03483"></a>03483             <span class="keywordflow">return</span> 1;
<a name="l03484"></a>03484     }
<a name="l03485"></a>03485     <span class="keywordflow">return</span> 0;
<a name="l03486"></a>03486 }
<a name="l03487"></a>03487 
<a name="l03488"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#afefbfb3c73941eabd808f7d40b5ef7fa">03488</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d78/screen__ops_8c.html#afefbfb3c73941eabd808f7d40b5ef7fa">open_file_drop_copy</a>(<a class="code" href="../../d2/d7a/structwmDrag.html">wmDrag</a> *drag, <a class="code" href="../../da/d4b/structwmDropBox.html">wmDropBox</a> *drop)
<a name="l03489"></a>03489 {
<a name="l03490"></a>03490     <span class="comment">/* copy drag path to properties */</span>
<a name="l03491"></a>03491     <a class="code" href="../../d3/d10/rna__access_8c.html#a229b9421e0a1d2e5fd079ec933a2d6f5">RNA_string_set</a>(drop-&gt;<a class="code" href="../../da/d4b/structwmDropBox.html#afd695008bb8938a900a6d971f803f17e">ptr</a>, <span class="stringliteral">&quot;filepath&quot;</span>, drag-&gt;<a class="code" href="../../d2/d7a/structwmDrag.html#a3e19d880c2c368fa0674ed69b46a9b36">path</a>);
<a name="l03492"></a>03492     drop-&gt;<a class="code" href="../../da/d4b/structwmDropBox.html#a03734083277cfc111aed2b3a211d603a">opcontext</a>= <a class="code" href="../../d4/ddc/WM__types_8h.html#a871a83db4e53fc6c6872b5ac7cc94f39ad2fa38d3cd3b0844e4a1b33bbf5f918c">WM_OP_EXEC_DEFAULT</a>;
<a name="l03493"></a>03493 }
<a name="l03494"></a>03494 
<a name="l03495"></a>03495 
<a name="l03496"></a>03496 <span class="comment">/* called in spacetypes.c */</span>
<a name="l03497"></a><a class="code" href="../../d6/d78/screen__ops_8c.html#a3dc751b987e3f0b00554b795cd642a01">03497</a> <span class="keywordtype">void</span> <a class="code" href="../../d1/d12/ED__screen_8h.html#a87d7fc66540e1942cbf4c81a908d6247">ED_keymap_screen</a>(<a class="code" href="../../d3/df7/structwmKeyConfig.html">wmKeyConfig</a> *keyconf)
<a name="l03498"></a>03498 {
<a name="l03499"></a>03499     <a class="code" href="../../d6/d85/structListBase.html">ListBase</a> *lb;
<a name="l03500"></a>03500     <a class="code" href="../../d3/d90/structwmKeyMap.html">wmKeyMap</a> *keymap;
<a name="l03501"></a>03501     <a class="code" href="../../d1/d5e/structwmKeyMapItem.html">wmKeyMapItem</a> *kmi;
<a name="l03502"></a>03502     
<a name="l03503"></a>03503     <span class="comment">/* Screen Editing ------------------------------------------------ */</span>
<a name="l03504"></a>03504     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(keyconf, <span class="stringliteral">&quot;Screen Editing&quot;</span>, 0, 0);
<a name="l03505"></a>03505     
<a name="l03506"></a>03506     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_actionzone&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0)-&gt;ptr, <span class="stringliteral">&quot;modifier&quot;</span>, 0);
<a name="l03507"></a>03507     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_actionzone&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;modifier&quot;</span>, 1);
<a name="l03508"></a>03508     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_actionzone&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;modifier&quot;</span>, 2);
<a name="l03509"></a>03509     
<a name="l03510"></a>03510     <span class="comment">/* screen tools */</span>
<a name="l03511"></a>03511     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_area_split&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>, 0, 0, 0);
<a name="l03512"></a>03512     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_area_join&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>, 0, 0, 0);
<a name="l03513"></a>03513     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_area_dupli&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>, 0, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0);
<a name="l03514"></a>03514     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_area_swap&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab95f28e28c96a2cd2d8b807ed65aa899">EVT_ACTIONZONE_AREA</a>, 0, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03515"></a>03515     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_region_scale&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a8f52029c9e633df20722c29f39c4efde">EVT_ACTIONZONE_REGION</a>, 0, 0, 0);
<a name="l03516"></a>03516     <span class="comment">/* area move after action zones */</span>
<a name="l03517"></a>03517     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_area_move&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae726b291aecab43654d1ac45b9e4d57d">LEFTMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03518"></a>03518     
<a name="l03519"></a>03519     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_area_options&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#adc87b609a6285a24e23172a90734044c">RIGHTMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03520"></a>03520     
<a name="l03521"></a>03521     
<a name="l03522"></a>03522     <span class="comment">/* Header Editing ------------------------------------------------ */</span>
<a name="l03523"></a>03523     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(keyconf, <span class="stringliteral">&quot;Header&quot;</span>, 0, 0);
<a name="l03524"></a>03524     
<a name="l03525"></a>03525     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_header_toolbox&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#adc87b609a6285a24e23172a90734044c">RIGHTMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03526"></a>03526     
<a name="l03527"></a>03527     <span class="comment">/* Screen General ------------------------------------------------ */</span>
<a name="l03528"></a>03528     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(keyconf, <span class="stringliteral">&quot;Screen&quot;</span>, 0, 0);
<a name="l03529"></a>03529     
<a name="l03530"></a>03530     <span class="comment">/* standard timers */</span>
<a name="l03531"></a>03531     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_step&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#af1b746ba5ab7d0ab657156ebda0f290c">TIMER0</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a3d6df9a8fc4231a9444e40c95043109f">KM_ANY</a>, 0);
<a name="l03532"></a>03532     
<a name="l03533"></a>03533     
<a name="l03534"></a>03534     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_screen_set&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a00226d1726c5da69413ce5e368332f0f">RIGHTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, 1);
<a name="l03535"></a>03535     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_screen_set&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a10c4c00065059a135492a87a229162af">LEFTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, -1);
<a name="l03536"></a>03536     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_screen_full_area&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#afc161d5211a7975b71b2d478f936ad85">UPARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03537"></a>03537     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_screen_full_area&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab85e7d9e3424f69f61d277f3aa68bff8">DOWNARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03538"></a>03538     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_screen_full_area&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a59b43db62ffa0d14bb076092d862d2cd">SPACEKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0);
<a name="l03539"></a>03539     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_screenshot&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a42a44c57b02d9dffa9e9e9a21d54b4cb">F3KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03540"></a>03540     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_screencast&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a42a44c57b02d9dffa9e9e9a21d54b4cb">F3KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0);
<a name="l03541"></a>03541     
<a name="l03542"></a>03542     <span class="comment">/* tests */</span>
<a name="l03543"></a>03543     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_region_quadview&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a4a864432ec0fec9609cedc8ee4c83f8d">QKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0);
<a name="l03544"></a>03544     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_repeat_history&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a42a44c57b02d9dffa9e9e9a21d54b4cb">F3KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03545"></a>03545     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_repeat_last&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a9fb42765696ec2a77dff4bc1267864c3">RKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0);
<a name="l03546"></a>03546     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_region_flip&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#aceea0c28ae73c0fb6b8215f174fa8aef">F5KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03547"></a>03547     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_redo_last&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a8df42a39d3542b2b25411f61cb73a3f2">F6KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03548"></a>03548     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a16c46a8e837f14b24c6f38f491e98f5f">WM_keymap_verify_item</a>(keymap, <span class="stringliteral">&quot;SCRIPT_OT_reload&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a0ff4a866a52dd2ab9c8d008622cb8921">F8KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03549"></a>03549     
<a name="l03550"></a>03550     <span class="comment">/* files */</span>
<a name="l03551"></a>03551     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;FILE_OT_execute&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a6c861c5ebabe8fe076ed84a2aaa7a1a0">RETKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03552"></a>03552     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;FILE_OT_execute&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#aafdc675e684c8485e8e27c7f2bafcbef">PADENTER</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03553"></a>03553     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;FILE_OT_cancel&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03554"></a>03554     
<a name="l03555"></a>03555     <span class="comment">/* undo */</span>
<a name="l03556"></a>03556 <span class="preprocessor">#ifdef __APPLE__</span>
<a name="l03557"></a>03557 <span class="preprocessor"></span>    <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;ED_OT_undo&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a5387e52eccf782cebe3b5eb2ca7655e1">ZKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afabd9010bd0eeba9b334c5f4d190d4de">KM_OSKEY</a>, 0);
<a name="l03558"></a>03558     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;ED_OT_redo&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a5387e52eccf782cebe3b5eb2ca7655e1">ZKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afabd9010bd0eeba9b334c5f4d190d4de">KM_OSKEY</a>, 0);
<a name="l03559"></a>03559     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;ED_OT_undo_history&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a5387e52eccf782cebe3b5eb2ca7655e1">ZKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afabd9010bd0eeba9b334c5f4d190d4de">KM_OSKEY</a>, 0);
<a name="l03560"></a>03560 <span class="preprocessor">#endif</span>
<a name="l03561"></a>03561 <span class="preprocessor"></span>    <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;ED_OT_undo&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a5387e52eccf782cebe3b5eb2ca7655e1">ZKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03562"></a>03562     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;ED_OT_redo&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a5387e52eccf782cebe3b5eb2ca7655e1">ZKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03563"></a>03563     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;ED_OT_undo_history&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a5387e52eccf782cebe3b5eb2ca7655e1">ZKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03564"></a>03564     
<a name="l03565"></a>03565     
<a name="l03566"></a>03566     <span class="comment">/* render */</span>
<a name="l03567"></a>03567     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;RENDER_OT_render&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a1ee33b3bc4eec09116f29d4a2ca269d8">F12KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03568"></a>03568     kmi = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;RENDER_OT_render&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a1ee33b3bc4eec09116f29d4a2ca269d8">F12KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03569"></a>03569     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;animation&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03570"></a>03570     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;RENDER_OT_view_cancel&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03571"></a>03571     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;RENDER_OT_view_show&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#adb9995de4225686857d1623600a0b65b">F11KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03572"></a>03572     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;RENDER_OT_play_rendered_anim&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#adb9995de4225686857d1623600a0b65b">F11KEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>, 0);
<a name="l03573"></a>03573     
<a name="l03574"></a>03574     <span class="comment">/* user prefs */</span>
<a name="l03575"></a>03575 <span class="preprocessor">#ifdef __APPLE__</span>
<a name="l03576"></a>03576 <span class="preprocessor"></span>    <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_userpref_show&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#adf608dfdafc6ae0e69128d9d207f33ed">COMMAKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afabd9010bd0eeba9b334c5f4d190d4de">KM_OSKEY</a>, 0);
<a name="l03577"></a>03577 <span class="preprocessor">#endif</span>
<a name="l03578"></a>03578 <span class="preprocessor"></span>    <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_userpref_show&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a7d136ae22613ef0df2eef2eaec226fda">UKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0);
<a name="l03579"></a>03579     
<a name="l03580"></a>03580     
<a name="l03581"></a>03581     <span class="comment">/* Anim Playback ------------------------------------------------ */</span>
<a name="l03582"></a>03582     keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(keyconf, <span class="stringliteral">&quot;Frames&quot;</span>, 0, 0);
<a name="l03583"></a>03583     
<a name="l03584"></a>03584     <span class="comment">/* frame offsets */</span>
<a name="l03585"></a>03585     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_offset&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#afc161d5211a7975b71b2d478f936ad85">UPARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, 10);
<a name="l03586"></a>03586     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_offset&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab85e7d9e3424f69f61d277f3aa68bff8">DOWNARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, -10);
<a name="l03587"></a>03587     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_offset&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a10c4c00065059a135492a87a229162af">LEFTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, -1);
<a name="l03588"></a>03588     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_offset&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a00226d1726c5da69413ce5e368332f0f">RIGHTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, 1);
<a name="l03589"></a>03589     
<a name="l03590"></a>03590     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_offset&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a2ffb32901b9678d9b738e618330f60c0">WHEELDOWNMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, 1);
<a name="l03591"></a>03591     <a class="code" href="../../d3/d10/rna__access_8c.html#a55040b7e90ed07022f7a82575f3b3e1d">RNA_int_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_offset&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae58fa49252a1cf05799ab21592491a30">WHEELUPMOUSE</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;delta&quot;</span>, -1);
<a name="l03592"></a>03592     
<a name="l03593"></a>03593     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#afc161d5211a7975b71b2d478f936ad85">UPARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;end&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03594"></a>03594     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab85e7d9e3424f69f61d277f3aa68bff8">DOWNARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#ab1edce62abb6c90ee2059ba76da20b50">KM_CTRL</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;end&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03595"></a>03595     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a00226d1726c5da69413ce5e368332f0f">RIGHTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;end&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03596"></a>03596     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_frame_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a10c4c00065059a135492a87a229162af">LEFTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;end&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03597"></a>03597     
<a name="l03598"></a>03598     kmi = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_keyframe_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#afc161d5211a7975b71b2d478f936ad85">UPARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03599"></a>03599     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;next&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03600"></a>03600 
<a name="l03601"></a>03601     kmi = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_keyframe_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab85e7d9e3424f69f61d277f3aa68bff8">DOWNARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03602"></a>03602     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;next&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03603"></a>03603     
<a name="l03604"></a>03604     kmi = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_keyframe_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab6bf801ccdec8498bc8a5e5c92591302">MEDIALAST</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03605"></a>03605     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;next&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03606"></a>03606 
<a name="l03607"></a>03607     kmi = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_keyframe_jump&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#abfa429ef1f1ed7b926703d38294a02e5">MEDIAFIRST</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03608"></a>03608     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;next&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03609"></a>03609     
<a name="l03610"></a>03610     <span class="comment">/* play (forward and backwards) */</span>
<a name="l03611"></a>03611     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a746a67a50a93dd2cac52c218ef94a218">AKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0);
<a name="l03612"></a>03612     <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(<a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a746a67a50a93dd2cac52c218ef94a218">AKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>|<a class="code" href="../../d4/ddc/WM__types_8h.html#a32a2f28ef75077bda99b29dfed8c991e">KM_SHIFT</a>, 0)-&gt;ptr, <span class="stringliteral">&quot;reverse&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03613"></a>03613     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_cancel&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#abe3de76b73fb856d283d4da41ad109e8">ESCKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03614"></a>03614     
<a name="l03615"></a>03615     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a0360fd83f8cff7f601dd6bba88938af7">MEDIAPLAY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03616"></a>03616     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_cancel&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ae4c1df7226da6c750b209441a1b7a1ff">MEDIASTOP</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, 0, 0);
<a name="l03617"></a>03617     
<a name="l03618"></a>03618     <span class="comment">/* Alternative keys for animation and sequencer playing */</span>
<a name="l03619"></a>03619 <span class="preprocessor">#if 0 // XXX: disabled for restoring later... bad implementation</span>
<a name="l03620"></a>03620 <span class="preprocessor"></span>    keymap = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a92bcf8f3f041915f81ad660495dc30cd">WM_keymap_find</a>(keyconf, <span class="stringliteral">&quot;Frames&quot;</span>, 0, 0);
<a name="l03621"></a>03621     kmi = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a00226d1726c5da69413ce5e368332f0f">RIGHTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0);
<a name="l03622"></a>03622         <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;cycle_speed&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03623"></a>03623     
<a name="l03624"></a>03624     kmi = <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#a10c4c00065059a135492a87a229162af">LEFTARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0);
<a name="l03625"></a>03625         <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;reverse&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03626"></a>03626         <a class="code" href="../../d3/d10/rna__access_8c.html#a1741c6fd78b5d828bb7b83517e2766db">RNA_boolean_set</a>(kmi-&gt;<a class="code" href="../../d1/d5e/structwmKeyMapItem.html#a17c86417e0dedf1a101de028ec6a2bd6">ptr</a>, <span class="stringliteral">&quot;cycle_speed&quot;</span>, <a class="code" href="../../da/d7d/BLI__utildefines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03627"></a>03627     
<a name="l03628"></a>03628     <a class="code" href="../../d7/d78/wm__keymap_8c.html#a610ba5bdb1d1ba39b5e5cb469b9fba09">WM_keymap_add_item</a>(keymap, <span class="stringliteral">&quot;SCREEN_OT_animation_play&quot;</span>, <a class="code" href="../../d1/d40/wm__event__types_8h.html#ab85e7d9e3424f69f61d277f3aa68bff8">DOWNARROWKEY</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#a8cc410005d9d1dacfe81cdffb6388d09">KM_PRESS</a>, <a class="code" href="../../d4/ddc/WM__types_8h.html#afa066cdfa1a8af7a98e45c83860b4abe">KM_ALT</a>, 0);
<a name="l03629"></a>03629 <span class="preprocessor">#endif</span>
<a name="l03630"></a>03630 <span class="preprocessor"></span>
<a name="l03631"></a>03631     <span class="comment">/* dropbox for entire window */</span>
<a name="l03632"></a>03632     lb= <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a9bdfefde719d427581820fde9975e46c">WM_dropboxmap_find</a>(<span class="stringliteral">&quot;Window&quot;</span>, 0, 0);
<a name="l03633"></a>03633     <a class="code" href="../../db/df3/wm__dragdrop_8c.html#a492e2c77ff7b14b50d31764e9c6616eb">WM_dropbox_add</a>(lb, <span class="stringliteral">&quot;WM_OT_open_mainfile&quot;</span>, <a class="code" href="../../d6/d78/screen__ops_8c.html#aa695895e4d68b7f57c9d6556c913539e">open_file_drop_poll</a>, <a class="code" href="../../d6/d78/screen__ops_8c.html#afefbfb3c73941eabd808f7d40b5ef7fa">open_file_drop_copy</a>);
<a name="l03634"></a>03634     
<a name="l03635"></a>03635     <a class="code" href="../../d6/d78/screen__ops_8c.html#a17aebc50b4b331d668fe7274c55cfdd9">keymap_modal_set</a>(keyconf);
<a name="l03636"></a>03636 }
<a name="l03637"></a>03637 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 13 2012 11:54:53 for Blender by&#160;
<a href="http://www.doxygen.org/index.html"> 
doxygen</a> 1.7.4 </small></address> 
</body>
</html>
